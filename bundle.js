/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={8203:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,a=s(e),o=a[0],l=a[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,o,l)),c=0,h=l>0?o-4:o;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[c++]=255&t),1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,a=[],o=16383,s=0,u=r-i;s<u;s+=o)a.push(l(e,s,s+o>u?u:s+o));return 1===i?(t=e[r-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),a.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)n[o]=a[o],r[a.charCodeAt(o)]=o;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,r){for(var i,a,o=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},1880:(e,t,n)=>{"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:String(t)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var c=n(8203),h=n(1988),d="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Sn=m,t.ZK=50;var f=2147483647;function p(e){if(e>f)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,m.prototype),t}function m(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return y(e)}return v(e,t,n)}function v(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!m.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|_(e,t),r=p(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ne(e,Uint8Array)){var t=new Uint8Array(e);return x(t.buffer,t.byteOffset,t.byteLength)}return b(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+u(e));if(ne(e,ArrayBuffer)||e&&ne(e.buffer,ArrayBuffer))return x(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(ne(e,SharedArrayBuffer)||e&&ne(e.buffer,SharedArrayBuffer)))return x(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return m.from(r,t,n);var i=function(e){if(m.isBuffer(e)){var t=0|w(e.length),n=p(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||re(e.length)?p(0):b(e):"Buffer"===e.type&&Array.isArray(e.data)?b(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return m.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+u(e))}function g(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function y(e){return g(e),p(e<0?0:0|w(e))}function b(e){for(var t=e.length<0?0:0|w(e.length),n=p(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function x(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,m.prototype),r}function w(e){if(e>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return 0|e}function _(e,t){if(m.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ne(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+u(e));var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ee(e).length;default:if(i)return r?-1:$(e).length;t=(""+t).toLowerCase(),i=!0}}function E(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return B(this,t,n);case"utf8":case"utf-8":return I(this,t,n);case"ascii":return D(this,t,n);case"latin1":case"binary":return N(this,t,n);case"base64":return L(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function T(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function S(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),re(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=m.from(t,r)),m.isBuffer(t))return 0===t.length?-1:M(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):M(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function M(e,t,n,r,i){var a,o=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var c=-1;for(a=n;a<s;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(n+l>s&&(n=s-l),a=n;a>=0;a--){for(var h=!0,d=0;d<l;d++)if(u(e,a+d)!==u(t,d)){h=!1;break}if(h)return a}return-1}function A(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a,o=t.length;for(r>o/2&&(r=o/2),a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(re(s))return a;e[n+a]=s}return a}function k(e,t,n,r){return te($(t,e.length-n),e,n,r)}function P(e,t,n,r){return te(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function R(e,t,n,r){return te(ee(t),e,n,r)}function C(e,t,n,r){return te(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function L(e,t,n){return 0===t&&n===e.length?c.fromByteArray(e):c.fromByteArray(e.slice(t,n))}function I(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=n){var l=void 0,u=void 0,c=void 0,h=void 0;switch(s){case 1:a<128&&(o=a);break;case 2:128==(192&(l=e[i+1]))&&(h=(31&a)<<6|63&l)>127&&(o=h);break;case 3:l=e[i+1],u=e[i+2],128==(192&l)&&128==(192&u)&&(h=(15&a)<<12|(63&l)<<6|63&u)>2047&&(h<55296||h>57343)&&(o=h);break;case 4:l=e[i+1],u=e[i+2],c=e[i+3],128==(192&l)&&128==(192&u)&&128==(192&c)&&(h=(15&a)<<18|(63&l)<<12|(63&u)<<6|63&c)>65535&&h<1114112&&(o=h)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=O));return n}(r)}m.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),m.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(m.prototype,"parent",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.buffer}}),Object.defineProperty(m.prototype,"offset",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.byteOffset}}),m.poolSize=8192,m.from=function(e,t,n){return v(e,t,n)},Object.setPrototypeOf(m.prototype,Uint8Array.prototype),Object.setPrototypeOf(m,Uint8Array),m.alloc=function(e,t,n){return function(e,t,n){return g(e),e<=0?p(e):void 0!==t?"string"==typeof n?p(e).fill(t,n):p(e).fill(t):p(e)}(e,t,n)},m.allocUnsafe=function(e){return y(e)},m.allocUnsafeSlow=function(e){return y(e)},m.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==m.prototype},m.compare=function(e,t){if(ne(e,Uint8Array)&&(e=m.from(e,e.offset,e.byteLength)),ne(t,Uint8Array)&&(t=m.from(t,t.offset,t.byteLength)),!m.isBuffer(e)||!m.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},m.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return m.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=m.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(ne(a,Uint8Array))i+a.length>r.length?(m.isBuffer(a)||(a=m.from(a)),a.copy(r,i)):Uint8Array.prototype.set.call(r,a,i);else{if(!m.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i)}i+=a.length}return r},m.byteLength=_,m.prototype._isBuffer=!0,m.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)T(this,t,t+1);return this},m.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)T(this,t,t+3),T(this,t+1,t+2);return this},m.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)T(this,t,t+7),T(this,t+1,t+6),T(this,t+2,t+5),T(this,t+3,t+4);return this},m.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):E.apply(this,arguments)},m.prototype.toLocaleString=m.prototype.toString,m.prototype.equals=function(e){if(!m.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===m.compare(this,e)},m.prototype.inspect=function(){var e="",n=t.ZK;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},d&&(m.prototype[d]=m.prototype.inspect),m.prototype.compare=function(e,t,n,r,i){if(ne(e,Uint8Array)&&(e=m.from(e,e.offset,e.byteLength)),!m.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+u(e));if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(r,i),c=e.slice(t,n),h=0;h<s;++h)if(l[h]!==c[h]){a=l[h],o=c[h];break}return a<o?-1:o<a?1:0},m.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},m.prototype.indexOf=function(e,t,n){return S(this,e,t,n,!0)},m.prototype.lastIndexOf=function(e,t,n){return S(this,e,t,n,!1)},m.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return A(this,e,t,n);case"utf8":case"utf-8":return k(this,e,t,n);case"ascii":case"latin1":case"binary":return P(this,e,t,n);case"base64":return R(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function D(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function N(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function B(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=ie[e[a]];return i}function U(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length-1;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function z(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function F(e,t,n,r,i,a){if(!m.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function H(e,t,n,r,i){K(t,r,i,e,n,7);var a=Number(t&BigInt(4294967295));e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function j(e,t,n,r,i){K(t,r,i,e,n,7);var a=Number(t&BigInt(4294967295));e[n+7]=a,a>>=8,e[n+6]=a,a>>=8,e[n+5]=a,a>>=8,e[n+4]=a;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function G(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function V(e,t,n,r,i){return t=+t,n>>>=0,i||G(e,0,n,4),h.write(e,t,n,r,23,4),n+4}function W(e,t,n,r,i){return t=+t,n>>>=0,i||G(e,0,n,8),h.write(e,t,n,r,52,8),n+8}m.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,m.prototype),r},m.prototype.readUintLE=m.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||z(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},m.prototype.readUintBE=m.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||z(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},m.prototype.readUint8=m.prototype.readUInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),this[e]},m.prototype.readUint16LE=m.prototype.readUInt16LE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]|this[e+1]<<8},m.prototype.readUint16BE=m.prototype.readUInt16BE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]<<8|this[e+1]},m.prototype.readUint32LE=m.prototype.readUInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},m.prototype.readUint32BE=m.prototype.readUInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},m.prototype.readBigUInt64LE=ae((function(e){J(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);var r=t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24),i=this[++e]+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+n*Math.pow(2,24);return BigInt(r)+(BigInt(i)<<BigInt(32))})),m.prototype.readBigUInt64BE=ae((function(e){J(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);var r=t*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e],i=this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),m.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||z(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},m.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||z(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},m.prototype.readInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},m.prototype.readInt16LE=function(e,t){e>>>=0,t||z(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},m.prototype.readInt16BE=function(e,t){e>>>=0,t||z(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},m.prototype.readInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},m.prototype.readInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},m.prototype.readBigInt64LE=ae((function(e){J(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);var r=this[e+4]+this[e+5]*Math.pow(2,8)+this[e+6]*Math.pow(2,16)+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24))})),m.prototype.readBigInt64BE=ae((function(e){J(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);var r=(t<<24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+n)})),m.prototype.readFloatLE=function(e,t){return e>>>=0,t||z(e,4,this.length),h.read(this,e,!0,23,4)},m.prototype.readFloatBE=function(e,t){return e>>>=0,t||z(e,4,this.length),h.read(this,e,!1,23,4)},m.prototype.readDoubleLE=function(e,t){return e>>>=0,t||z(e,8,this.length),h.read(this,e,!0,52,8)},m.prototype.readDoubleBE=function(e,t){return e>>>=0,t||z(e,8,this.length),h.read(this,e,!1,52,8)},m.prototype.writeUintLE=m.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||F(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},m.prototype.writeUintBE=m.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||F(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},m.prototype.writeUint8=m.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,255,0),this[t]=255&e,t+1},m.prototype.writeUint16LE=m.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},m.prototype.writeUint16BE=m.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},m.prototype.writeUint32LE=m.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},m.prototype.writeUint32BE=m.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},m.prototype.writeBigUInt64LE=ae((function(e){return H(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),m.prototype.writeBigUInt64BE=ae((function(e){return j(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),m.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},m.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},m.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},m.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},m.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},m.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},m.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},m.prototype.writeBigInt64LE=ae((function(e){return H(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),m.prototype.writeBigInt64BE=ae((function(e){return j(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),m.prototype.writeFloatLE=function(e,t,n){return V(this,e,t,!0,n)},m.prototype.writeFloatBE=function(e,t,n){return V(this,e,t,!1,n)},m.prototype.writeDoubleLE=function(e,t,n){return W(this,e,t,!0,n)},m.prototype.writeDoubleBE=function(e,t,n){return W(this,e,t,!1,n)},m.prototype.copy=function(e,t,n,r){if(!m.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},m.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!m.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=m.isBuffer(e)?e:m.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var q={};function X(e,t,n){q[e]=function(n){function i(){var n,r,l,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r=this,l=o(l=i),n=function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}(r,a()?Reflect.construct(l,c||[],o(r).constructor):l.apply(r,c)),Object.defineProperty(s(n),"message",{value:t.apply(s(n),arguments),writable:!0,configurable:!0}),n.name="".concat(n.name," [").concat(e,"]"),n.stack,delete n.name,n}var c,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(i,n),c=i,(h=[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}])&&r(c.prototype,h),Object.defineProperty(c,"prototype",{writable:!1}),i}(n)}function Y(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function K(e,t,n,r,i,a){if(e>n||e<t){var o,s="bigint"==typeof t?"n":"";throw o=a>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(a+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(a+1)-1).concat(s,") and < 2 ** ")+"".concat(8*(a+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(n).concat(s),new q.ERR_OUT_OF_RANGE("value",o,e)}!function(e,t,n){J(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||Z(t,e.length-(n+1))}(r,i,a)}function J(e,t){if("number"!=typeof e)throw new q.ERR_INVALID_ARG_TYPE(t,"number",e)}function Z(e,t,n){if(Math.floor(e)!==e)throw J(e,n),new q.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new q.ERR_BUFFER_OUT_OF_BOUNDS;throw new q.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}X("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),X("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(u(t))}),TypeError),X("ERR_OUT_OF_RANGE",(function(e,t,n){var r='The value of "'.concat(e,'" is out of range.'),i=n;return Number.isInteger(n)&&Math.abs(n)>Math.pow(2,32)?i=Y(String(n)):"bigint"==typeof n&&(i=String(n),(n>Math.pow(BigInt(2),BigInt(32))||n<-Math.pow(BigInt(2),BigInt(32)))&&(i=Y(i)),i+="n"),r+" It must be ".concat(t,". Received ").concat(i)}),RangeError);var Q=/[^+/0-9A-Za-z-_]/g;function $(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function ee(e){return c.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function te(e,t,n,r){var i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function ne(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function re(e){return e!=e}var ie=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}();function ae(e){return"undefined"==typeof BigInt?oe:e}function oe(){throw new Error("BigInt not supported")}},6964:function(e,t){var n="undefined"!=typeof self?self:this,r=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in e,o="ArrayBuffer"in e;if(o)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():o&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,n,r=f(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=p(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=u(e),t=c(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d.prototype.delete=function(e){delete this.map[u(e)]},d.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},d.prototype.set=function(e,t){this.map[u(e)]=c(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},r&&(d.prototype[Symbol.iterator]=d.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n,r,i=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),y.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function x(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];w.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function E(e,n){return new Promise((function(r,a){var o=new b(e,n);if(o.signal&&o.signal.aborted)return a(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function l(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;r(new w(i,n))},s.onerror=function(){a(new TypeError("Network request failed"))},s.ontimeout=function(){a(new TypeError("Network request failed"))},s.onabort=function(){a(new t.DOMException("Aborted","AbortError"))},s.open(o.method,o.url,!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),o.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",l),s.onreadystatechange=function(){4===s.readyState&&o.signal.removeEventListener("abort",l)}),s.send(void 0===o._bodyInit?null:o._bodyInit)}))}E.polyfill=!0,e.fetch||(e.fetch=E,e.Headers=d,e.Request=b,e.Response=w),t.Headers=d,t.Request=b,t.Response=w,t.fetch=E,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},3880:e=>{"use strict";var t={single_source_shortest_paths:function(e,n,r){var i={},a={};a[n]=0;var o,s,l,u,c,h,d,f=t.PriorityQueue.make();for(f.push(n,0);!f.empty();)for(l in s=(o=f.pop()).value,u=o.cost,c=e[s]||{})c.hasOwnProperty(l)&&(h=u+c[l],d=a[l],(void 0===a[l]||d>h)&&(a[l]=h,f.push(l,h),i[l]=s));if(void 0!==r&&void 0===a[r]){var p=["Could not find a path from ",n," to ",r,"."].join("");throw new Error(p)}return i},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],r=t;r;)n.push(r),e[r],r=e[r];return n.reverse(),n},find_path:function(e,n,r){var i=t.single_source_shortest_paths(e,n,r);return t.extract_shortest_path_from_predecessor_list(i,r)},PriorityQueue:{make:function(e){var n,r=t.PriorityQueue,i={};for(n in e=e||{},r)r.hasOwnProperty(n)&&(i[n]=r[n]);return i.queue=[],i.sorter=e.sorter||r.default_sorter,i},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var n={value:e,cost:t};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},7540:e=>{"use strict";e.exports=function(e){for(var t=[],n=e.length,r=0;r<n;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319&&n>r+1){var a=e.charCodeAt(r+1);a>=56320&&a<=57343&&(i=1024*(i-55296)+a-56320+65536,r+=1)}i<128?t.push(i):i<2048?(t.push(i>>6|192),t.push(63&i|128)):i<55296||i>=57344&&i<65536?(t.push(i>>12|224),t.push(i>>6&63|128),t.push(63&i|128)):i>=65536&&i<=1114111?(t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(63&i|128)):t.push(239,191,189)}return new Uint8Array(t).buffer}},6884:e=>{"use strict";e.exports=function(e){var t=e.uri,n=e.name,r=e.type;this.uri=t,this.name=n,this.type=r}},9652:(e,t,n)=>{"use strict";var r=n(3140);e.exports=function e(t,n,i){var a;void 0===n&&(n=""),void 0===i&&(i=r);var o=new Map;function s(e,t){var n=o.get(t);n?n.push.apply(n,e):o.set(t,e)}if(i(t))a=null,s([n],t);else{var l=n?n+".":"";if("undefined"!=typeof FileList&&t instanceof FileList)a=Array.prototype.map.call(t,(function(e,t){return s([""+l+t],e),null}));else if(Array.isArray(t))a=t.map((function(t,n){var r=e(t,""+l+n,i);return r.files.forEach(s),r.clone}));else if(t&&t.constructor===Object)for(var u in a={},t){var c=e(t[u],""+l+u,i);c.files.forEach(s),a[u]=c.clone}else a=t}return{clone:a,files:o}}},5732:(e,t,n)=>{"use strict";t.ReactNativeFile=n(6884),t.extractFiles=n(9652),t.isExtractableFile=n(3140)},3140:(e,t,n)=>{"use strict";var r=n(6884);e.exports=function(e){return"undefined"!=typeof File&&e instanceof File||"undefined"!=typeof Blob&&e instanceof Blob||e instanceof r}},3640:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}e.exports="object"==("undefined"==typeof self?"undefined":t(self))?self.FormData:window.FormData},5044:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(5732),o=i(n(3640)),s=function(e){return a.isExtractableFile(e)||null!==e&&"object"===r(e)&&"function"==typeof e.pipe};t.default=function(e,t,n){var r=a.extractFiles({query:e,variables:t,operationName:n},"",s),i=r.clone,l=r.files;if(0===l.size){if(!Array.isArray(e))return JSON.stringify(i);if(void 0!==t&&!Array.isArray(t))throw new Error("Cannot create request body with given variable type, array expected");var u=e.reduce((function(e,n,r){return e.push({query:n,variables:t?t[r]:void 0}),e}),[]);return JSON.stringify(u)}var c=new("undefined"==typeof FormData?o.default:FormData);c.append("operations",JSON.stringify(i));var h={},d=0;return l.forEach((function(e){h[++d]=e})),c.append("map",JSON.stringify(h)),d=0,l.forEach((function(e,t){c.append(""+ ++d,t)})),c}},4780:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},u=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.gql=t.batchRequests=t.request=t.rawRequest=t.GraphQLClient=t.ClientError=void 0;var h=o(n(6964)),d=h,f=n(5937),p=c(n(5044)),m=n(3796);Object.defineProperty(t,"ClientError",{enumerable:!0,get:function(){return m.ClientError}});var v=function(e){var t={};return e&&("undefined"!=typeof Headers&&e instanceof Headers||e instanceof d.Headers?t=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}(e):Array.isArray(e)?e.forEach((function(e){var n=e[0],r=e[1];t[n]=r})):t=e),t},g=function(e){return e.replace(/([\s,]|#[^\n\r]+)+/g," ").trim()},y=function(e){var t=e.url,n=e.query,i=e.variables,a=e.operationName,o=e.headers,u=e.fetch,c=e.fetchOptions;return s(void 0,void 0,void 0,(function(){var e;return l(this,(function(s){switch(s.label){case 0:return e=p.default(n,i,a),[4,u(t,r({method:"POST",headers:r(r({},"string"==typeof e?{"Content-Type":"application/json"}:{}),o),body:e},c))];case 1:return[2,s.sent()]}}))}))},b=function(e){var t=e.url,n=e.query,i=e.variables,a=e.operationName,o=e.headers,u=e.fetch,c=e.fetchOptions;return s(void 0,void 0,void 0,(function(){var e;return l(this,(function(s){switch(s.label){case 0:return e=function(e){var t=e.query,n=e.variables,r=e.operationName;if(!Array.isArray(t)){var i=["query="+encodeURIComponent(g(t))];return n&&i.push("variables="+encodeURIComponent(JSON.stringify(n))),r&&i.push("operationName="+encodeURIComponent(r)),i.join("&")}if(void 0!==n&&!Array.isArray(n))throw new Error("Cannot create query with given variable type, array expected");var a=t.reduce((function(e,t,r){return e.push({query:g(t),variables:n?JSON.stringify(n[r]):void 0}),e}),[]);return"query="+encodeURIComponent(JSON.stringify(a))}({query:n,variables:i,operationName:a}),[4,u(t+"?"+e,r({method:"GET",headers:o},c))];case 1:return[2,s.sent()]}}))}))},x=function(){function e(e,t){this.url=e,this.options=t||{}}return e.prototype.rawRequest=function(e,t,n){var i=this.options,a=i.headers,o=i.fetch,s=void 0===o?h.default:o,l=i.method,c=void 0===l?"POST":l,d=u(i,["headers","fetch","method"]);return w({url:this.url,query:e,variables:t,headers:r(r({},v(a)),v(n)),operationName:void 0,fetch:s,method:c,fetchOptions:d})},e.prototype.request=function(e,t,n){return s(this,void 0,void 0,(function(){var i,a,o,s,c,d,f,p,m,g,y;return l(this,(function(l){switch(l.label){case 0:return i=this.options,a=i.headers,o=i.fetch,s=void 0===o?h.default:o,c=i.method,d=void 0===c?"POST":c,f=u(i,["headers","fetch","method"]),p=this.url,m=T(e),g=m.query,y=m.operationName,[4,w({url:p,query:g,variables:t,headers:r(r({},v(a)),v(n)),operationName:y,fetch:s,method:d,fetchOptions:f})];case 1:return[2,l.sent().data]}}))}))},e.prototype.batchRequests=function(e,t){return s(this,void 0,void 0,(function(){var n,i,a,o,s,c,d,f,p,m;return l(this,(function(l){switch(l.label){case 0:return n=this.options,i=n.headers,a=n.fetch,o=void 0===a?h.default:a,s=n.method,c=void 0===s?"POST":s,d=u(n,["headers","fetch","method"]),f=this.url,p=e.map((function(e){return T(e.document).query})),m=e.map((function(e){return e.variables})),[4,w({url:f,query:p,variables:m,headers:r(r({},v(i)),v(t)),operationName:void 0,fetch:o,method:c,fetchOptions:d})];case 1:return[2,l.sent().data]}}))}))},e.prototype.setHeaders=function(e){return this.options.headers=e,this},e.prototype.setHeader=function(e,t){var n,r=this.options.headers;return r?r[e]=t:this.options.headers=((n={})[e]=t,n),this},e.prototype.setEndpoint=function(e){return this.url=e,this},e}();function w(e){var t=e.url,n=e.query,i=e.variables,a=e.headers,o=e.operationName,u=e.fetch,c=e.method,h=void 0===c?"POST":c,d=e.fetchOptions;return s(this,void 0,void 0,(function(){var e,s,c,f,p,v,g,x;return l(this,(function(l){switch(l.label){case 0:return e="POST"===h.toUpperCase()?y:b,s=Array.isArray(n),[4,e({url:t,query:n,variables:i,operationName:o,headers:a,fetch:u,fetchOptions:d})];case 1:return[4,E(c=l.sent())];case 2:if(f=l.sent(),p=s&&Array.isArray(f)?!f.some((function(e){return!e.data})):!!f.data,c.ok&&!f.errors&&p)return v=c.headers,g=c.status,[2,r(r({},s?{data:f}:f),{headers:v,status:g})];throw x="string"==typeof f?{error:f}:f,new m.ClientError(r(r({},x),{status:c.status,headers:c.headers}),{query:n,variables:i})}}))}))}function _(e,t,n,r){return s(this,void 0,void 0,(function(){return l(this,(function(i){return[2,new x(e).request(t,n,r)]}))}))}function E(e){var t=e.headers.get("Content-Type");return t&&t.startsWith("application/json")?e.json():e.text()}function T(e){var t;if("string"==typeof e)return{query:e};var n=void 0,r=e.definitions.filter((function(e){return"OperationDefinition"===e.kind}));return 1===r.length&&(n=null===(t=r[0].name)||void 0===t?void 0:t.value),{query:f.print(e),operationName:n}}t.GraphQLClient=x,t.rawRequest=function(e,t,n,r){return s(this,void 0,void 0,(function(){return l(this,(function(i){return[2,new x(e).rawRequest(t,n,r)]}))}))},t.request=_,t.batchRequests=function(e,t,n){return s(this,void 0,void 0,(function(){return l(this,(function(r){return[2,new x(e).batchRequests(t,n)]}))}))},t.default=_,t.gql=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.reduce((function(e,n,r){return""+e+n+(r in t?t[r]:"")}),"")}},3796:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ClientError=void 0;var i=function(e){function t(n,r){var i=this,a=t.extractMessage(n)+": "+JSON.stringify({response:n,request:r});return i=e.call(this,a)||this,Object.setPrototypeOf(i,t.prototype),i.response=n,i.request=r,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,t),i}return r(t,e),t.extractMessage=function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: "+e.status+")"}},t}(Error);t.ClientError=i},3848:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.devAssert=function(e,t){if(!Boolean(e))throw new Error(t)}},4688:(e,t)=>{"use strict";function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.inspect=function(e){return s(e,[])};var a=10,o=2;function s(e,t){switch(i(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return function(e,t){if(null===e)return"null";if(t.includes(e))return"[Circular]";var i,l=[].concat(function(e){if(Array.isArray(e))return r(e)}(i=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||n(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[e]);if(function(e){return"function"==typeof e.toJSON}(e)){var u=e.toJSON();if(u!==e)return"string"==typeof u?u:s(u,l)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>o)return"[Array]";for(var n=Math.min(a,e.length),r=e.length-n,i=[],l=0;l<n;++l)i.push(s(e[l],t));return 1===r?i.push("... 1 more item"):r>1&&i.push("... ".concat(r," more items")),"["+i.join(", ")+"]"}(e,l);return function(e,t){var r=Object.entries(e);if(0===r.length)return"{}";if(t.length>o)return"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var n=e.constructor.name;if("string"==typeof n&&""!==n)return n}return t}(e)+"]";var i=r.map((function(e){var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2);return r[0]+": "+s(r[1],t)}));return"{ "+i.join(", ")+" }"}(e,l)}(e,t);default:return String(e)}}},3356:(e,t)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:String(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Token=t.QueryDocumentKeys=t.OperationTypeNode=t.Location=void 0,t.isNode=function(e){var t=null==e?void 0:e.kind;return"string"==typeof t&&h.has(t)};var s=function(e){function t(e,n,i){r(this,t),this.start=e.start,this.end=n.end,this.startToken=e,this.endToken=n,this.source=i}return a(t,[{key:Symbol.toStringTag,get:function(){return"Location"}},{key:"toJSON",value:function(){return{start:this.start,end:this.end}}}]),t}();t.Location=s;var l=function(e){function t(e,n,i,a,o,s){r(this,t),this.kind=e,this.start=n,this.end=i,this.line=a,this.column=o,this.value=s,this.prev=null,this.next=null}return a(t,[{key:Symbol.toStringTag,get:function(){return"Token"}},{key:"toJSON",value:function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}]),t}();t.Token=l;var u={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};t.QueryDocumentKeys=u;var c,h=new Set(Object.keys(u));t.OperationTypeNode=c,function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(c||(t.OperationTypeNode=c={}))},9029:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dedentBlockStringLines=function(e){for(var t,n=Number.MAX_SAFE_INTEGER,r=null,a=-1,o=0;o<e.length;++o){var s,l=e[o],u=i(l);u!==l.length&&(r=null!==(s=r)&&void 0!==s?s:o,a=o,0!==o&&u<n&&(n=u))}return e.map((function(e,t){return 0===t?e:e.slice(n)})).slice(null!==(t=r)&&void 0!==t?t:0,a+1)},t.isPrintableAsBlockString=function(e){if(""===e)return!0;for(var t=!0,n=!1,r=!0,i=!1,a=0;a<e.length;++a)switch(e.codePointAt(a)){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 11:case 12:case 14:case 15:case 13:return!1;case 10:if(t&&!i)return!1;i=!0,t=!0,n=!1;break;case 9:case 32:n||(n=t);break;default:r&&(r=n),t=!1}return!t&&(!r||!i)},t.printBlockString=function(e,t){var n=e.replace(/"""/g,'\\"""'),i=n.split(/\r\n|[\n\r]/g),a=1===i.length,o=i.length>1&&i.slice(1).every((function(e){return 0===e.length||(0,r.isWhiteSpace)(e.charCodeAt(0))})),s=n.endsWith('\\"""'),l=e.endsWith('"')&&!s,u=e.endsWith("\\"),c=l||u,h=!(null!=t&&t.minimize)&&(!a||e.length>70||c||o||s),d="",f=a&&(0,r.isWhiteSpace)(e.charCodeAt(0));return(h&&!f||o)&&(d+="\n"),d+=n,(h||c)&&(d+="\n"),'"""'+d+'"""'};var r=n(6176);function i(e){for(var t=0;t<e.length&&(0,r.isWhiteSpace)(e.charCodeAt(t));)++t;return t}},6176:(e,t)=>{"use strict";function n(e){return e>=48&&e<=57}function r(e){return e>=97&&e<=122||e>=65&&e<=90}Object.defineProperty(t,"__esModule",{value:!0}),t.isDigit=n,t.isLetter=r,t.isNameContinue=function(e){return r(e)||n(e)||95===e},t.isNameStart=function(e){return r(e)||95===e},t.isWhiteSpace=function(e){return 9===e||32===e}},7164:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Kind=void 0,t.Kind=n,function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(n||(t.Kind=n={}))},7339:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printString=function(e){return'"'.concat(e.replace(n,r),'"')};var n=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function r(e){return i[e.charCodeAt(0)]}var i=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"]},5937:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.print=function(e){return(0,r.visit)(e,o)};var r=n(8536),i=n(9029),a=n(7339),o={Name:{leave:function(e){return e.value}},Variable:{leave:function(e){return"$"+e.name}},Document:{leave:function(e){return s(e.definitions,"\n\n")}},OperationDefinition:{leave:function(e){var t=u("(",s(e.variableDefinitions,", "),")"),n=s([e.operation,s([e.name,t]),s(e.directives," ")]," ");return("query"===n?"":n+" ")+e.selectionSet}},VariableDefinition:{leave:function(e){var t=e.variable,n=e.type,r=e.defaultValue,i=e.directives;return t+": "+n+u(" = ",r)+u(" ",s(i," "))}},SelectionSet:{leave:function(e){return l(e.selections)}},Field:{leave:function(e){var t=e.alias,n=e.name,r=e.arguments,i=e.directives,a=e.selectionSet,o=u("",t,": ")+n,l=o+u("(",s(r,", "),")");return l.length>80&&(l=o+u("(\n",c(s(r,"\n")),"\n)")),s([l,s(i," "),a]," ")}},Argument:{leave:function(e){return e.name+": "+e.value}},FragmentSpread:{leave:function(e){return"..."+e.name+u(" ",s(e.directives," "))}},InlineFragment:{leave:function(e){var t=e.typeCondition,n=e.directives,r=e.selectionSet;return s(["...",u("on ",t),s(n," "),r]," ")}},FragmentDefinition:{leave:function(e){var t=e.name,n=e.typeCondition,r=e.variableDefinitions,i=e.directives,a=e.selectionSet;return"fragment ".concat(t).concat(u("(",s(r,", "),")")," ")+"on ".concat(n," ").concat(u("",s(i," ")," "))+a}},IntValue:{leave:function(e){return e.value}},FloatValue:{leave:function(e){return e.value}},StringValue:{leave:function(e){var t=e.value;return e.block?(0,i.printBlockString)(t):(0,a.printString)(t)}},BooleanValue:{leave:function(e){return e.value?"true":"false"}},NullValue:{leave:function(){return"null"}},EnumValue:{leave:function(e){return e.value}},ListValue:{leave:function(e){return"["+s(e.values,", ")+"]"}},ObjectValue:{leave:function(e){return"{"+s(e.fields,", ")+"}"}},ObjectField:{leave:function(e){return e.name+": "+e.value}},Directive:{leave:function(e){return"@"+e.name+u("(",s(e.arguments,", "),")")}},NamedType:{leave:function(e){return e.name}},ListType:{leave:function(e){return"["+e.type+"]"}},NonNullType:{leave:function(e){return e.type+"!"}},SchemaDefinition:{leave:function(e){var t=e.description,n=e.directives,r=e.operationTypes;return u("",t,"\n")+s(["schema",s(n," "),l(r)]," ")}},OperationTypeDefinition:{leave:function(e){return e.operation+": "+e.type}},ScalarTypeDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.directives;return u("",t,"\n")+s(["scalar",n,s(r," ")]," ")}},ObjectTypeDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.interfaces,i=e.directives,a=e.fields;return u("",t,"\n")+s(["type",n,u("implements ",s(r," & ")),s(i," "),l(a)]," ")}},FieldDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.arguments,i=e.type,a=e.directives;return u("",t,"\n")+n+(h(r)?u("(\n",c(s(r,"\n")),"\n)"):u("(",s(r,", "),")"))+": "+i+u(" ",s(a," "))}},InputValueDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.type,i=e.defaultValue,a=e.directives;return u("",t,"\n")+s([n+": "+r,u("= ",i),s(a," ")]," ")}},InterfaceTypeDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.interfaces,i=e.directives,a=e.fields;return u("",t,"\n")+s(["interface",n,u("implements ",s(r," & ")),s(i," "),l(a)]," ")}},UnionTypeDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.directives,i=e.types;return u("",t,"\n")+s(["union",n,s(r," "),u("= ",s(i," | "))]," ")}},EnumTypeDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.directives,i=e.values;return u("",t,"\n")+s(["enum",n,s(r," "),l(i)]," ")}},EnumValueDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.directives;return u("",t,"\n")+s([n,s(r," ")]," ")}},InputObjectTypeDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.directives,i=e.fields;return u("",t,"\n")+s(["input",n,s(r," "),l(i)]," ")}},DirectiveDefinition:{leave:function(e){var t=e.description,n=e.name,r=e.arguments,i=e.repeatable,a=e.locations;return u("",t,"\n")+"directive @"+n+(h(r)?u("(\n",c(s(r,"\n")),"\n)"):u("(",s(r,", "),")"))+(i?" repeatable":"")+" on "+s(a," | ")}},SchemaExtension:{leave:function(e){var t=e.directives,n=e.operationTypes;return s(["extend schema",s(t," "),l(n)]," ")}},ScalarTypeExtension:{leave:function(e){return s(["extend scalar",e.name,s(e.directives," ")]," ")}},ObjectTypeExtension:{leave:function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return s(["extend type",t,u("implements ",s(n," & ")),s(r," "),l(i)]," ")}},InterfaceTypeExtension:{leave:function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return s(["extend interface",t,u("implements ",s(n," & ")),s(r," "),l(i)]," ")}},UnionTypeExtension:{leave:function(e){var t=e.name,n=e.directives,r=e.types;return s(["extend union",t,s(n," "),u("= ",s(r," | "))]," ")}},EnumTypeExtension:{leave:function(e){var t=e.name,n=e.directives,r=e.values;return s(["extend enum",t,s(n," "),l(r)]," ")}},InputObjectTypeExtension:{leave:function(e){var t=e.name,n=e.directives,r=e.fields;return s(["extend input",t,s(n," "),l(r)]," ")}}};function s(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!==(t=null==e?void 0:e.filter((function(e){return e})).join(n))&&void 0!==t?t:""}function l(e){return u("{\n",c(s(e,"\n")),"\n}")}function u(e,t){return null!=t&&""!==t?e+t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:""):""}function c(e){return u("  ",e.replace(/\n/g,"\n  "))}function h(e){var t;return null!==(t=null==e?void 0:e.some((function(e){return e.includes("\n")})))&&void 0!==t&&t}},8536:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.BREAK=void 0,t.getEnterLeaveForKind=f,t.getVisitFn=function(e,t,n){var r=f(e,t),i=r.enter,a=r.leave;return n?a:i},t.visit=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.QueryDocumentKeys,r=new Map,o=0,s=Object.values(h.Kind);o<s.length;o++){var p=s[o];r.set(p,f(t,p))}var m=void 0,v=Array.isArray(e),g=[e],y=-1,b=[],x=void 0,w=void 0,_=void 0,E=[],T=[],S=e;do{var M=++y===g.length,A=M&&0!==b.length;if(M){if(w=0===T.length?void 0:E[E.length-1],x=_,_=T.pop(),A)if(v){x=x.slice();var k,P=0,R=a(b);try{for(R.s();!(k=R.n()).done;){var C=i(k.value,2),L=C[0],I=C[1],O=L-P;null===I?(x.splice(O,1),P++):x[O]=I}}catch(e){R.e(e)}finally{R.f()}}else{x=Object.defineProperties({},Object.getOwnPropertyDescriptors(x));var D,N=a(b);try{for(N.s();!(D=N.n()).done;){var B=i(D.value,2),U=B[0],z=B[1];x[U]=z}}catch(e){N.e(e)}finally{N.f()}}y=m.index,g=m.keys,b=m.edits,v=m.inArray,m=m.prev}else{if(w=_?v?y:g[y]:void 0,null==(x=_?_[w]:S))continue;_&&E.push(w)}var F,H=void 0;if(!Array.isArray(x)){var j,G;(0,c.isNode)(x)||(0,u.devAssert)(!1,"Invalid AST Node: ".concat((0,l.inspect)(x),"."));var V=M?null===(j=r.get(x.kind))||void 0===j?void 0:j.leave:null===(G=r.get(x.kind))||void 0===G?void 0:G.enter;if((H=null==V?void 0:V.call(t,x,w,_,E,T))===d)break;if(!1===H){if(!M){E.pop();continue}}else if(void 0!==H&&(b.push([w,H]),!M)){if(!(0,c.isNode)(H)){E.pop();continue}x=H}}void 0===H&&A&&b.push([w,x]),M?E.pop():(m={inArray:v,index:y,keys:g,edits:b,prev:m},g=(v=Array.isArray(x))?x:null!==(F=n[x.kind])&&void 0!==F?F:[],y=-1,b=[],_&&T.push(_),_=x)}while(void 0!==m);return 0!==b.length&&(S=b[b.length-1][1]),S},t.visitInParallel=function(e){for(var t=new Array(e.length).fill(null),n=Object.create(null),r=function(){for(var r=a[i],o=!1,s=new Array(e.length).fill(void 0),l=new Array(e.length).fill(void 0),u=0;u<e.length;++u){var c=f(e[u],r),h=c.enter,p=c.leave;o||(o=null!=h||null!=p),s[u]=h,l[u]=p}if(!o)return 1;var m={enter:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var a=r[0],o=0;o<e.length;o++)if(null===t[o]){var l,u=null===(l=s[o])||void 0===l?void 0:l.apply(e[o],r);if(!1===u)t[o]=a;else if(u===d)t[o]=d;else if(void 0!==u)return u}},leave:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var a=r[0],o=0;o<e.length;o++)if(null===t[o]){var s,u=null===(s=l[o])||void 0===s?void 0:s.apply(e[o],r);if(u===d)t[o]=d;else if(void 0!==u&&!1!==u)return u}else t[o]===a&&(t[o]=null)}};n[r]=m},i=0,a=Object.values(h.Kind);i<a.length;i++)r();return n};var l=n(4688),u=n(3848),c=n(3356),h=n(7164),d=Object.freeze({});function f(e,t){var n=e[t];return"object"===r(n)?n:"function"==typeof n?{enter:n,leave:void 0}:{enter:e.enter,leave:e.leave}}t.BREAK=d},1988:(e,t)=>{t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-c)-1,f>>=-c,c+=s;c>0;a=256*a+e[t+h],h+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+h],h+=d,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=u}return(f?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,h=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(t*l-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+f]=255&s,f+=p,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m}},5280:(e,t,n)=>{var r=n(5704),i=n(9904),a=n(4364),o=n(9616);function s(e,t,n,a,o){var s=[].slice.call(arguments,1),l=s.length,u="function"==typeof s[l-1];if(!u&&!r())throw new Error("Callback required as last argument");if(!u){if(l<1)throw new Error("Too few arguments provided");return 1===l?(n=t,t=a=void 0):2!==l||t.getContext||(a=n,n=t,t=void 0),new Promise((function(r,o){try{var s=i.create(n,a);r(e(s,t,a))}catch(e){o(e)}}))}if(l<2)throw new Error("Too few arguments provided");2===l?(o=n,n=t,t=a=void 0):3===l&&(t.getContext&&void 0===o?(o=a,a=void 0):(o=a,a=n,n=t,t=void 0));try{var c=i.create(n,a);o(null,e(c,t,a))}catch(e){o(e)}}t.create=i.create,t.toCanvas=s.bind(null,a.render),t.toDataURL=s.bind(null,a.renderToDataURL),t.toString=s.bind(null,(function(e,t,n){return o.render(e,n)}))},5704:e=>{e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},9504:(e,t,n)=>{var r=n(2624).getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];for(var t=Math.floor(e/7)+2,n=r(e),i=145===n?26:2*Math.ceil((n-13)/(2*t-2)),a=[n-7],o=1;o<t-1;o++)a[o]=a[o-1]-i;return a.push(6),a.reverse()},t.getPositions=function(e){for(var n=[],r=t.getRowColCoords(e),i=r.length,a=0;a<i;a++)for(var o=0;o<i;o++)0===a&&0===o||0===a&&o===i-1||a===i-1&&0===o||n.push([r[a],r[o]]);return n}},8e3:(e,t,n)=>{var r=n(8596),i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(e){this.mode=r.ALPHANUMERIC,this.data=e}a.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){var t;for(t=0;t+2<=this.data.length;t+=2){var n=45*i.indexOf(this.data[t]);n+=i.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(i.indexOf(this.data[t]),6)},e.exports=a},5868:e=>{function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},6320:e=>{function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,n,r){var i=e*this.size+t;this.data[i]=n,r&&(this.reservedBit[i]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},9660:(e,t,n)=>{var r=n(7540),i=n(8596);function a(e){this.mode=i.BYTE,"string"==typeof e&&(e=r(e)),this.data=new Uint8Array(e)}a.getBitsLength=function(e){return 8*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){for(var t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)},e.exports=a},7800:(e,t,n)=>{var r=n(3728),i=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case r.L:return i[4*(e-1)+0];case r.M:return i[4*(e-1)+1];case r.Q:return i[4*(e-1)+2];case r.H:return i[4*(e-1)+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case r.L:return a[4*(e-1)+0];case r.M:return a[4*(e-1)+1];case r.Q:return a[4*(e-1)+2];case r.H:return a[4*(e-1)+3];default:return}}},3728:(e,t)=>{t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(e){return n}}},9116:(e,t,n)=>{var r=n(2624).getSymbolSize;t.getPositions=function(e){var t=r(e);return[[0,0],[t-7,0],[0,t-7]]}},9844:(e,t,n)=>{var r=n(2624),i=r.getBCHDigit(1335);t.getEncodedBits=function(e,t){for(var n=e.bit<<3|t,a=n<<10;r.getBCHDigit(a)-i>=0;)a^=1335<<r.getBCHDigit(a)-i;return 21522^(n<<10|a)}},3988:(e,t)=>{var n=new Uint8Array(512),r=new Uint8Array(256);!function(){for(var e=1,t=0;t<255;t++)n[t]=e,r[e]=t,256&(e<<=1)&&(e^=285);for(var i=255;i<512;i++)n[i]=n[i-255]}(),t.log=function(e){if(e<1)throw new Error("log("+e+")");return r[e]},t.exp=function(e){return n[e]},t.mul=function(e,t){return 0===e||0===t?0:n[r[e]+r[t]]}},408:(e,t,n)=>{var r=n(8596),i=n(2624);function a(e){this.mode=r.KANJI,this.data=e}a.getBitsLength=function(e){return 13*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){var t;for(t=0;t<this.data.length;t++){var n=i.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),e.put(n,13)}},e.exports=a},9515:(e,t)=>{t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function n(e,n,r){switch(e){case t.Patterns.PATTERN000:return(n+r)%2==0;case t.Patterns.PATTERN001:return n%2==0;case t.Patterns.PATTERN010:return r%3==0;case t.Patterns.PATTERN011:return(n+r)%3==0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case t.Patterns.PATTERN101:return n*r%2+n*r%3==0;case t.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case t.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){for(var t=e.size,n=0,r=0,i=0,a=null,o=null,s=0;s<t;s++){r=i=0,a=o=null;for(var l=0;l<t;l++){var u=e.get(s,l);u===a?r++:(r>=5&&(n+=r-5+3),a=u,r=1),(u=e.get(l,s))===o?i++:(i>=5&&(n+=i-5+3),o=u,i=1)}r>=5&&(n+=r-5+3),i>=5&&(n+=i-5+3)}return n},t.getPenaltyN2=function(e){for(var t=e.size,n=0,r=0;r<t-1;r++)for(var i=0;i<t-1;i++){var a=e.get(r,i)+e.get(r,i+1)+e.get(r+1,i)+e.get(r+1,i+1);4!==a&&0!==a||n++}return 3*n},t.getPenaltyN3=function(e){for(var t=e.size,n=0,r=0,i=0,a=0;a<t;a++){r=i=0;for(var o=0;o<t;o++)r=r<<1&2047|e.get(a,o),o>=10&&(1488===r||93===r)&&n++,i=i<<1&2047|e.get(o,a),o>=10&&(1488===i||93===i)&&n++}return 40*n},t.getPenaltyN4=function(e){for(var t=0,n=e.data.length,r=0;r<n;r++)t+=e.data[r];return 10*Math.abs(Math.ceil(100*t/n/5)-10)},t.applyMask=function(e,t){for(var r=t.size,i=0;i<r;i++)for(var a=0;a<r;a++)t.isReserved(a,i)||t.xor(a,i,n(e,a,i))},t.getBestMask=function(e,n){for(var r=Object.keys(t.Patterns).length,i=0,a=1/0,o=0;o<r;o++){n(o),t.applyMask(o,e);var s=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(o,e),s<a&&(a=s,i=o)}return i}},8596:(e,t,n)=>{var r=n(2664),i=n(8540);t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!r.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return i.testNumeric(e)?t.NUMERIC:i.testAlphanumeric(e)?t.ALPHANUMERIC:i.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(e){return n}}},3932:(e,t,n)=>{var r=n(8596);function i(e){this.mode=r.NUMERIC,this.data=e.toString()}i.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){var t,n,r;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),r=parseInt(n,10),e.put(r,10);var i=this.data.length-t;i>0&&(n=this.data.substr(t),r=parseInt(n,10),e.put(r,3*i+1))},e.exports=i},8560:(e,t,n)=>{var r=n(3988);t.mul=function(e,t){for(var n=new Uint8Array(e.length+t.length-1),i=0;i<e.length;i++)for(var a=0;a<t.length;a++)n[i+a]^=r.mul(e[i],t[a]);return n},t.mod=function(e,t){for(var n=new Uint8Array(e);n.length-t.length>=0;){for(var i=n[0],a=0;a<t.length;a++)n[a]^=r.mul(t[a],i);for(var o=0;o<n.length&&0===n[o];)o++;n=n.slice(o)}return n},t.generateECPolynomial=function(e){for(var n=new Uint8Array([1]),i=0;i<e;i++)n=t.mul(n,new Uint8Array([1,r.exp(i)]));return n}},9904:(e,t,n)=>{var r=n(2624),i=n(3728),a=n(5868),o=n(6320),s=n(9504),l=n(9116),u=n(9515),c=n(7800),h=n(6435),d=n(6504),f=n(9844),p=n(8596),m=n(4968);function v(e,t,n){var r,i,a=e.size,o=f.getEncodedBits(t,n);for(r=0;r<15;r++)i=1==(o>>r&1),r<6?e.set(r,8,i,!0):r<8?e.set(r+1,8,i,!0):e.set(a-15+r,8,i,!0),r<8?e.set(8,a-r-1,i,!0):r<9?e.set(8,15-r-1+1,i,!0):e.set(8,15-r-1,i,!0);e.set(a-8,8,1,!0)}function g(e,t,n,i){var f;if(Array.isArray(e))f=m.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");var g=t;if(!g){var y=m.rawSplit(e);g=d.getBestVersionForData(y,n)}f=m.fromString(e,g||40)}var b=d.getBestVersionForData(f,n);if(!b)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<b)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+b+".\n")}else t=b;var x=function(e,t,n){var i=new a;n.forEach((function(t){i.put(t.mode.bit,4),i.put(t.getLength(),p.getCharCountIndicator(t.mode,e)),t.write(i)}));var o=8*(r.getSymbolTotalCodewords(e)-c.getTotalCodewordsCount(e,t));for(i.getLengthInBits()+4<=o&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(0);for(var s=(o-i.getLengthInBits())/8,l=0;l<s;l++)i.put(l%2?17:236,8);return function(e,t,n){for(var i=r.getSymbolTotalCodewords(t),a=i-c.getTotalCodewordsCount(t,n),o=c.getBlocksCount(t,n),s=o-i%o,l=Math.floor(i/o),u=Math.floor(a/o),d=u+1,f=l-u,p=new h(f),m=0,v=new Array(o),g=new Array(o),y=0,b=new Uint8Array(e.buffer),x=0;x<o;x++){var w=x<s?u:d;v[x]=b.slice(m,m+w),g[x]=p.encode(v[x]),m+=w,y=Math.max(y,w)}var _,E,T=new Uint8Array(i),S=0;for(_=0;_<y;_++)for(E=0;E<o;E++)_<v[E].length&&(T[S++]=v[E][_]);for(_=0;_<f;_++)for(E=0;E<o;E++)T[S++]=g[E][_];return T}(i,e,t)}(t,n,f),w=r.getSymbolSize(t),_=new o(w);return function(e,t){for(var n=e.size,r=l.getPositions(t),i=0;i<r.length;i++)for(var a=r[i][0],o=r[i][1],s=-1;s<=7;s++)if(!(a+s<=-1||n<=a+s))for(var u=-1;u<=7;u++)o+u<=-1||n<=o+u||(s>=0&&s<=6&&(0===u||6===u)||u>=0&&u<=6&&(0===s||6===s)||s>=2&&s<=4&&u>=2&&u<=4?e.set(a+s,o+u,!0,!0):e.set(a+s,o+u,!1,!0))}(_,t),function(e){for(var t=e.size,n=8;n<t-8;n++){var r=n%2==0;e.set(n,6,r,!0),e.set(6,n,r,!0)}}(_),function(e,t){for(var n=s.getPositions(t),r=0;r<n.length;r++)for(var i=n[r][0],a=n[r][1],o=-2;o<=2;o++)for(var l=-2;l<=2;l++)-2===o||2===o||-2===l||2===l||0===o&&0===l?e.set(i+o,a+l,!0,!0):e.set(i+o,a+l,!1,!0)}(_,t),v(_,n,0),t>=7&&function(e,t){for(var n,r,i,a=e.size,o=d.getEncodedBits(t),s=0;s<18;s++)n=Math.floor(s/3),r=s%3+a-8-3,i=1==(o>>s&1),e.set(n,r,i,!0),e.set(r,n,i,!0)}(_,t),function(e,t){for(var n=e.size,r=-1,i=n-1,a=7,o=0,s=n-1;s>0;s-=2)for(6===s&&s--;;){for(var l=0;l<2;l++)if(!e.isReserved(i,s-l)){var u=!1;o<t.length&&(u=1==(t[o]>>>a&1)),e.set(i,s-l,u),-1==--a&&(o++,a=7)}if((i+=r)<0||n<=i){i-=r,r=-r;break}}}(_,x),isNaN(i)&&(i=u.getBestMask(_,v.bind(null,_,n))),u.applyMask(i,_),v(_,n,i),{modules:_,version:t,errorCorrectionLevel:n,maskPattern:i,segments:f}}t.create=function(e,t){if(void 0===e||""===e)throw new Error("No input text");var n,a,o=i.M;return void 0!==t&&(o=i.from(t.errorCorrectionLevel,i.M),n=d.from(t.version),a=u.from(t.maskPattern),t.toSJISFunc&&r.setToSJISFunction(t.toSJISFunc)),g(e,n,o,a)}},6435:(e,t,n)=>{var r=n(8560);function i(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}i.prototype.initialize=function(e){this.degree=e,this.genPoly=r.generateECPolynomial(this.degree)},i.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");var t=new Uint8Array(e.length+this.degree);t.set(e);var n=r.mod(t,this.genPoly),i=this.degree-n.length;if(i>0){var a=new Uint8Array(this.degree);return a.set(n,i),a}return n},e.exports=i},8540:(e,t)=>{var n="[0-9]+",r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",i="(?:(?![A-Z0-9 $%*+\\-./:]|"+(r=r.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";t.KANJI=new RegExp(r,"g"),t.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=new RegExp(i,"g"),t.NUMERIC=new RegExp(n,"g"),t.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");var a=new RegExp("^"+r+"$"),o=new RegExp("^"+n+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return a.test(e)},t.testNumeric=function(e){return o.test(e)},t.testAlphanumeric=function(e){return s.test(e)}},4968:(e,t,n)=>{var r=n(8596),i=n(3932),a=n(8e3),o=n(9660),s=n(408),l=n(8540),u=n(2624),c=n(3880);function h(e){return unescape(encodeURIComponent(e)).length}function d(e,t,n){for(var r,i=[];null!==(r=e.exec(n));)i.push({data:r[0],index:r.index,mode:t,length:r[0].length});return i}function f(e){var t,n,i=d(l.NUMERIC,r.NUMERIC,e),a=d(l.ALPHANUMERIC,r.ALPHANUMERIC,e);return u.isKanjiModeEnabled()?(t=d(l.BYTE,r.BYTE,e),n=d(l.KANJI,r.KANJI,e)):(t=d(l.BYTE_KANJI,r.BYTE,e),n=[]),i.concat(a,t,n).sort((function(e,t){return e.index-t.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function p(e,t){switch(t){case r.NUMERIC:return i.getBitsLength(e);case r.ALPHANUMERIC:return a.getBitsLength(e);case r.KANJI:return s.getBitsLength(e);case r.BYTE:return o.getBitsLength(e)}}function m(e,t){var n,l=r.getBestModeForData(e);if((n=r.from(t,l))!==r.BYTE&&n.bit<l.bit)throw new Error('"'+e+'" cannot be encoded with mode '+r.toString(n)+".\n Suggested mode is: "+r.toString(l));switch(n!==r.KANJI||u.isKanjiModeEnabled()||(n=r.BYTE),n){case r.NUMERIC:return new i(e);case r.ALPHANUMERIC:return new a(e);case r.KANJI:return new s(e);case r.BYTE:return new o(e)}}t.fromArray=function(e){return e.reduce((function(e,t){return"string"==typeof t?e.push(m(t,null)):t.data&&e.push(m(t.data,t.mode)),e}),[])},t.fromString=function(e,n){for(var i=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];switch(i.mode){case r.NUMERIC:t.push([i,{data:i.data,mode:r.ALPHANUMERIC,length:i.length},{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.ALPHANUMERIC:t.push([i,{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.KANJI:t.push([i,{data:i.data,mode:r.BYTE,length:h(i.data)}]);break;case r.BYTE:t.push([{data:i.data,mode:r.BYTE,length:h(i.data)}])}}return t}(f(e,u.isKanjiModeEnabled())),a=function(e,t){for(var n={},i={start:{}},a=["start"],o=0;o<e.length;o++){for(var s=e[o],l=[],u=0;u<s.length;u++){var c=s[u],h=""+o+u;l.push(h),n[h]={node:c,lastCount:0},i[h]={};for(var d=0;d<a.length;d++){var f=a[d];n[f]&&n[f].node.mode===c.mode?(i[f][h]=p(n[f].lastCount+c.length,c.mode)-p(n[f].lastCount,c.mode),n[f].lastCount+=c.length):(n[f]&&(n[f].lastCount=c.length),i[f][h]=p(c.length,c.mode)+4+r.getCharCountIndicator(c.mode,t))}}a=l}for(var m=0;m<a.length;m++)i[a[m]].end=0;return{map:i,table:n}}(i,n),o=c.find_path(a.map,"start","end"),s=[],l=1;l<o.length-1;l++)s.push(a.table[o[l]].node);return t.fromArray(s.reduce((function(e,t){var n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)}),[]))},t.rawSplit=function(e){return t.fromArray(f(e,u.isKanjiModeEnabled()))}},2624:(e,t)=>{var n,r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return r[e]},t.getBCHDigit=function(e){for(var t=0;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');n=e},t.isKanjiModeEnabled=function(){return void 0!==n},t.toSJIS=function(e){return n(e)}},2664:(e,t)=>{t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},6504:(e,t,n)=>{var r=n(2624),i=n(7800),a=n(3728),o=n(8596),s=n(2664),l=r.getBCHDigit(7973);function u(e,t){return o.getCharCountIndicator(e,t)+4}function c(e,t){var n=0;return e.forEach((function(e){var r=u(e.mode,t);n+=r+e.getBitsLength()})),n}t.from=function(e,t){return s.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,n){if(!s.isValid(e))throw new Error("Invalid QR Code version");void 0===n&&(n=o.BYTE);var a=8*(r.getSymbolTotalCodewords(e)-i.getTotalCodewordsCount(e,t));if(n===o.MIXED)return a;var l=a-u(n,e);switch(n){case o.NUMERIC:return Math.floor(l/10*3);case o.ALPHANUMERIC:return Math.floor(l/11*2);case o.KANJI:return Math.floor(l/13);case o.BYTE:default:return Math.floor(l/8)}},t.getBestVersionForData=function(e,n){var r,i=a.from(n,a.M);if(Array.isArray(e)){if(e.length>1)return function(e,n){for(var r=1;r<=40;r++)if(c(e,r)<=t.getCapacity(r,n,o.MIXED))return r}(e,i);if(0===e.length)return 1;r=e[0]}else r=e;return function(e,n,r){for(var i=1;i<=40;i++)if(n<=t.getCapacity(i,r,e))return i}(r.mode,r.getLength(),i)},t.getEncodedBits=function(e){if(!s.isValid(e)||e<7)throw new Error("Invalid QR Code version");for(var t=e<<12;r.getBCHDigit(t)-l>=0;)t^=7973<<r.getBCHDigit(t)-l;return e<<12|t}},4364:(e,t,n)=>{var r=n(2336);t.render=function(e,t,n){var i=n,a=t;void 0!==i||t&&t.getContext||(i=t,t=void 0),t||(a=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),i=r.getOptions(i);var o=r.getImageWidth(e.modules.size,i),s=a.getContext("2d"),l=s.createImageData(o,o);return r.qrToImageData(l.data,e,i),function(e,t,n){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=n,t.width=n,t.style.height=n+"px",t.style.width=n+"px"}(s,a,o),s.putImageData(l,0,0),a},t.renderToDataURL=function(e,n,r){var i=r;void 0!==i||n&&n.getContext||(i=n,n=void 0),i||(i={});var a=t.render(e,n,i),o=i.type||"image/png",s=i.rendererOpts||{};return a.toDataURL(o,s.quality)}},9616:(e,t,n)=>{var r=n(2336);function i(e,t){var n=e.a/255,r=t+'="'+e.hex+'"';return n<1?r+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function a(e,t,n){var r=e+t;return void 0!==n&&(r+=" "+n),r}t.render=function(e,t,n){var o=r.getOptions(t),s=e.modules.size,l=e.modules.data,u=s+2*o.margin,c=o.color.light.a?"<path "+i(o.color.light,"fill")+' d="M0 0h'+u+"v"+u+'H0z"/>':"",h="<path "+i(o.color.dark,"stroke")+' d="'+function(e,t,n){for(var r="",i=0,o=!1,s=0,l=0;l<e.length;l++){var u=Math.floor(l%t),c=Math.floor(l/t);u||o||(o=!0),e[l]?(s++,l>0&&u>0&&e[l-1]||(r+=o?a("M",u+n,.5+c+n):a("m",i,0),i=0,o=!1),u+1<t&&e[l+1]||(r+=a("h",s),s=0)):i++}return r}(l,s,o.margin)+'"/>',d='viewBox="0 0 '+u+" "+u+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+d+' shape-rendering="crispEdges">'+c+h+"</svg>\n";return"function"==typeof n&&n(null,f),f}},2336:(e,t)=>{function n(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");var t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map((function(e){return[e,e]})))),6===t.length&&t.push("F","F");var n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});var t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:r,scale:r?4:i,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,n){var r=t.getScale(e,n);return Math.floor((e+2*n.margin)*r)},t.qrToImageData=function(e,n,r){for(var i=n.modules.size,a=n.modules.data,o=t.getScale(i,r),s=Math.floor((i+2*r.margin)*o),l=r.margin*o,u=[r.color.light,r.color.dark],c=0;c<s;c++)for(var h=0;h<s;h++){var d=4*(c*s+h),f=r.color.light;c>=l&&h>=l&&c<s-l&&h<s-l&&(f=u[a[Math.floor((c-l)/o)*i+Math.floor((h-l)/o)]?1:0]),e[d++]=f.r,e[d++]=f.g,e[d++]=f.b,e[d]=f.a}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.u=e=>e+".bundle.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!e;)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,(()=>{"use strict";var e={};n.r(e),n.d(e,{ACESFilmicToneMapping:()=>wi,AddEquation:()=>Fr,AddOperation:()=>vi,AdditiveAnimationBlendMode:()=>to,AdditiveBlending:()=>Nr,AgXToneMapping:()=>Ei,AlphaFormat:()=>na,AlwaysCompare:()=>Vo,AlwaysDepth:()=>si,AlwaysStencilFunc:()=>No,AmbientLight:()=>Sg,AnimationAction:()=>py,AnimationClip:()=>Yv,AnimationLoader:()=>ig,AnimationMixer:()=>vy,AnimationObjectGroup:()=>fy,AnimationUtils:()=>Dv,ArcCurve:()=>em,ArrayCamera:()=>sf,ArrowHelper:()=>sb,AttachedBindMode:()=>Ti,Audio:()=>Zg,AudioAnalyser:()=>ry,AudioContext:()=>Ug,AudioListener:()=>Jg,AudioLoader:()=>zg,AxesHelper:()=>lb,BackSide:()=>Cr,BasicDepthPacking:()=>so,BasicShadowMap:()=>Mr,BatchedMesh:()=>Ap,Bone:()=>Zf,BooleanKeyframeTrack:()=>Hv,Box2:()=>ky,Box3:()=>tl,Box3Helper:()=>ib,BoxGeometry:()=>dc,BoxHelper:()=>rb,BufferAttribute:()=>ku,BufferGeometry:()=>qu,BufferGeometryLoader:()=>Lg,ByteType:()=>qi,Cache:()=>Jv,Camera:()=>yc,CameraHelper:()=>Qy,CanvasTexture:()=>Zp,CapsuleGeometry:()=>wm,CatmullRomCurve3:()=>om,CineonToneMapping:()=>xi,CircleGeometry:()=>_m,ClampToEdgeWrapping:()=>Ii,Clock:()=>Vg,Color:()=>vu,ColorKeyframeTrack:()=>jv,ColorManagement:()=>Os,CompressedArrayTexture:()=>Kp,CompressedCubeTexture:()=>Jp,CompressedTexture:()=>Yp,CompressedTextureLoader:()=>ag,ConeGeometry:()=>Tm,ConstantAlphaFactor:()=>ii,ConstantColorFactor:()=>ni,CubeCamera:()=>wc,CubeReflectionMapping:()=>Ai,CubeRefractionMapping:()=>ki,CubeTexture:()=>_c,CubeTextureLoader:()=>sg,CubeUVReflectionMapping:()=>Ci,CubicBezierCurve:()=>cm,CubicBezierCurve3:()=>hm,CubicInterpolant:()=>Bv,CullFaceBack:()=>Er,CullFaceFront:()=>Tr,CullFaceFrontBack:()=>Sr,CullFaceNone:()=>_r,Curve:()=>Qp,CurvePath:()=>ym,CustomBlending:()=>zr,CustomToneMapping:()=>_i,CylinderGeometry:()=>Em,Cylindrical:()=>My,Data3DTexture:()=>Ys,DataArrayTexture:()=>qs,DataTexture:()=>Qf,DataTextureLoader:()=>lg,DataUtils:()=>Su,DecrementStencilOp:()=>So,DecrementWrapStencilOp:()=>Ao,DefaultLoadingManager:()=>Qv,DepthFormat:()=>oa,DepthStencilFormat:()=>sa,DepthTexture:()=>mh,DetachedBindMode:()=>Si,DirectionalLight:()=>Tg,DirectionalLightHelper:()=>Ky,DiscreteInterpolant:()=>zv,DisplayP3ColorSpace:()=>mo,DodecahedronGeometry:()=>Mm,DoubleSide:()=>Lr,DstAlphaFactor:()=>Zr,DstColorFactor:()=>$r,DynamicCopyUsage:()=>Qo,DynamicDrawUsage:()=>qo,DynamicReadUsage:()=>Ko,EdgesGeometry:()=>Cm,EllipseCurve:()=>$p,EqualCompare:()=>zo,EqualDepth:()=>ci,EqualStencilFunc:()=>Co,EquirectangularReflectionMapping:()=>Pi,EquirectangularRefractionMapping:()=>Ri,Euler:()=>Ul,EventDispatcher:()=>as,ExtrudeGeometry:()=>ov,FileLoader:()=>rg,Float16BufferAttribute:()=>Nu,Float32BufferAttribute:()=>Bu,Float64BufferAttribute:()=>Uu,FloatType:()=>Zi,Fog:()=>yf,FogExp2:()=>gf,FramebufferTexture:()=>Xp,FrontSide:()=>Rr,Frustum:()=>Rc,GLBufferAttribute:()=>wy,GLSL1:()=>es,GLSL3:()=>ts,GreaterCompare:()=>Ho,GreaterDepth:()=>di,GreaterEqualCompare:()=>Go,GreaterEqualDepth:()=>hi,GreaterEqualStencilFunc:()=>Do,GreaterStencilFunc:()=>Io,GridHelper:()=>Vy,Group:()=>lf,HalfFloatType:()=>Qi,HemisphereLight:()=>hg,HemisphereLightHelper:()=>Gy,IcosahedronGeometry:()=>lv,ImageBitmapLoader:()=>Bg,ImageLoader:()=>og,ImageUtils:()=>Bs,IncrementStencilOp:()=>To,IncrementWrapStencilOp:()=>Mo,InstancedBufferAttribute:()=>np,InstancedBufferGeometry:()=>Cg,InstancedInterleavedBuffer:()=>xy,InstancedMesh:()=>cp,Int16BufferAttribute:()=>Lu,Int32BufferAttribute:()=>Ou,Int8BufferAttribute:()=>Pu,IntType:()=>Ki,InterleavedBuffer:()=>xf,InterleavedBufferAttribute:()=>_f,Interpolant:()=>Nv,InterpolateDiscrete:()=>Ya,InterpolateLinear:()=>Ka,InterpolateSmooth:()=>Ja,InvertStencilOp:()=>ko,KeepStencilOp:()=>_o,KeyframeTrack:()=>Fv,LOD:()=>Ff,LatheGeometry:()=>xm,Layers:()=>zl,LessCompare:()=>Uo,LessDepth:()=>li,LessEqualCompare:()=>Fo,LessEqualDepth:()=>ui,LessEqualStencilFunc:()=>Lo,LessStencilFunc:()=>Ro,Light:()=>cg,LightProbe:()=>kg,Line:()=>Op,Line3:()=>Cy,LineBasicMaterial:()=>kp,LineCurve:()=>dm,LineCurve3:()=>fm,LineDashedMaterial:()=>Pv,LineLoop:()=>Up,LineSegments:()=>Bp,LinearDisplayP3ColorSpace:()=>vo,LinearEncoding:()=>ao,LinearFilter:()=>Fi,LinearInterpolant:()=>Uv,LinearMipMapLinearFilter:()=>Vi,LinearMipMapNearestFilter:()=>ji,LinearMipmapLinearFilter:()=>Gi,LinearMipmapNearestFilter:()=>Hi,LinearSRGBColorSpace:()=>po,LinearToneMapping:()=>yi,LinearTransfer:()=>go,Loader:()=>$v,LoaderUtils:()=>Rg,LoadingManager:()=>Zv,LoopOnce:()=>Wa,LoopPingPong:()=>Xa,LoopRepeat:()=>qa,LuminanceAlphaFormat:()=>aa,LuminanceFormat:()=>ia,MOUSE:()=>xr,Material:()=>bu,MaterialLoader:()=>Pg,MathUtils:()=>ys,Matrix3:()=>xs,Matrix4:()=>kl,MaxEquation:()=>Vr,Mesh:()=>cc,MeshBasicMaterial:()=>xu,MeshDepthMaterial:()=>ef,MeshDistanceMaterial:()=>tf,MeshLambertMaterial:()=>Av,MeshMatcapMaterial:()=>kv,MeshNormalMaterial:()=>Mv,MeshPhongMaterial:()=>Tv,MeshPhysicalMaterial:()=>Ev,MeshStandardMaterial:()=>_v,MeshToonMaterial:()=>Sv,MinEquation:()=>Gr,MirroredRepeatWrapping:()=>Oi,MixOperation:()=>mi,MultiplyBlending:()=>Ur,MultiplyOperation:()=>pi,NearestFilter:()=>Di,NearestMipMapLinearFilter:()=>zi,NearestMipMapNearestFilter:()=>Bi,NearestMipmapLinearFilter:()=>Ui,NearestMipmapNearestFilter:()=>Ni,NeverCompare:()=>Bo,NeverDepth:()=>oi,NeverStencilFunc:()=>Po,NoBlending:()=>Or,NoColorSpace:()=>ho,NoToneMapping:()=>gi,NormalAnimationBlendMode:()=>eo,NormalBlending:()=>Dr,NotEqualCompare:()=>jo,NotEqualDepth:()=>fi,NotEqualStencilFunc:()=>Oo,NumberKeyframeTrack:()=>Gv,Object3D:()=>$l,ObjectLoader:()=>Ig,ObjectSpaceNormalMap:()=>co,OctahedronGeometry:()=>uv,OneFactor:()=>qr,OneMinusConstantAlphaFactor:()=>ai,OneMinusConstantColorFactor:()=>ri,OneMinusDstAlphaFactor:()=>Qr,OneMinusDstColorFactor:()=>ei,OneMinusSrcAlphaFactor:()=>Jr,OneMinusSrcColorFactor:()=>Yr,OrthographicCamera:()=>Vc,P3Primaries:()=>xo,PCFShadowMap:()=>Ar,PCFSoftShadowMap:()=>kr,PMREMGenerator:()=>th,Path:()=>bm,PerspectiveCamera:()=>bc,Plane:()=>Ac,PlaneGeometry:()=>Ic,PlaneHelper:()=>ab,PointLight:()=>_g,PointLightHelper:()=>zy,Points:()=>Vp,PointsMaterial:()=>zp,PolarGridHelper:()=>Wy,PolyhedronGeometry:()=>Sm,PositionalAudio:()=>ny,PropertyBinding:()=>dy,PropertyMixer:()=>iy,QuadraticBezierCurve:()=>pm,QuadraticBezierCurve3:()=>mm,Quaternion:()=>Zs,QuaternionKeyframeTrack:()=>Wv,QuaternionLinearInterpolant:()=>Vv,RED_GREEN_RGTC2_Format:()=>Ga,RED_RGTC1_Format:()=>Ha,REVISION:()=>br,RGBADepthPacking:()=>lo,RGBAFormat:()=>ra,RGBAIntegerFormat:()=>da,RGBA_ASTC_10x10_Format:()=>Da,RGBA_ASTC_10x5_Format:()=>La,RGBA_ASTC_10x6_Format:()=>Ia,RGBA_ASTC_10x8_Format:()=>Oa,RGBA_ASTC_12x10_Format:()=>Na,RGBA_ASTC_12x12_Format:()=>Ba,RGBA_ASTC_4x4_Format:()=>Ta,RGBA_ASTC_5x4_Format:()=>Sa,RGBA_ASTC_5x5_Format:()=>Ma,RGBA_ASTC_6x5_Format:()=>Aa,RGBA_ASTC_6x6_Format:()=>ka,RGBA_ASTC_8x5_Format:()=>Pa,RGBA_ASTC_8x6_Format:()=>Ra,RGBA_ASTC_8x8_Format:()=>Ca,RGBA_BPTC_Format:()=>Ua,RGBA_ETC2_EAC_Format:()=>Ea,RGBA_PVRTC_2BPPV1_Format:()=>xa,RGBA_PVRTC_4BPPV1_Format:()=>ba,RGBA_S3TC_DXT1_Format:()=>pa,RGBA_S3TC_DXT3_Format:()=>ma,RGBA_S3TC_DXT5_Format:()=>va,RGB_BPTC_SIGNED_Format:()=>za,RGB_BPTC_UNSIGNED_Format:()=>Fa,RGB_ETC1_Format:()=>wa,RGB_ETC2_Format:()=>_a,RGB_PVRTC_2BPPV1_Format:()=>ya,RGB_PVRTC_4BPPV1_Format:()=>ga,RGB_S3TC_DXT1_Format:()=>fa,RGFormat:()=>ca,RGIntegerFormat:()=>ha,RawShaderMaterial:()=>wv,Ray:()=>Al,Raycaster:()=>_y,Rec709Primaries:()=>bo,RectAreaLight:()=>Mg,RedFormat:()=>la,RedIntegerFormat:()=>ua,ReinhardToneMapping:()=>bi,RenderTarget:()=>Vs,RepeatWrapping:()=>Li,ReplaceStencilOp:()=>Eo,ReverseSubtractEquation:()=>jr,RingGeometry:()=>cv,SIGNED_RED_GREEN_RGTC2_Format:()=>Va,SIGNED_RED_RGTC1_Format:()=>ja,SRGBColorSpace:()=>fo,SRGBTransfer:()=>yo,Scene:()=>bf,ShaderChunk:()=>Oc,ShaderLib:()=>Nc,ShaderMaterial:()=>gc,ShadowMaterial:()=>xv,Shape:()=>Lm,ShapeGeometry:()=>hv,ShapePath:()=>ub,ShapeUtils:()=>rv,ShortType:()=>Xi,Skeleton:()=>tp,SkeletonHelper:()=>By,SkinnedMesh:()=>Jf,Source:()=>zs,Sphere:()=>bl,SphereGeometry:()=>dv,Spherical:()=>Sy,SphericalHarmonics3:()=>Ag,SplineCurve:()=>vm,SpotLight:()=>gg,SpotLightHelper:()=>Iy,Sprite:()=>Nf,SpriteMaterial:()=>Ef,SrcAlphaFactor:()=>Kr,SrcAlphaSaturateFactor:()=>ti,SrcColorFactor:()=>Xr,StaticCopyUsage:()=>Zo,StaticDrawUsage:()=>Wo,StaticReadUsage:()=>Yo,StereoCamera:()=>Gg,StreamCopyUsage:()=>$o,StreamDrawUsage:()=>Xo,StreamReadUsage:()=>Jo,StringKeyframeTrack:()=>qv,SubtractEquation:()=>Hr,SubtractiveBlending:()=>Br,TOUCH:()=>wr,TangentSpaceNormalMap:()=>uo,TetrahedronGeometry:()=>fv,Texture:()=>js,TextureLoader:()=>ug,TorusGeometry:()=>pv,TorusKnotGeometry:()=>mv,Triangle:()=>hu,TriangleFanDrawMode:()=>io,TriangleStripDrawMode:()=>ro,TrianglesDrawMode:()=>no,TubeGeometry:()=>vv,TwoPassDoubleSide:()=>Ir,UVMapping:()=>Mi,Uint16BufferAttribute:()=>Iu,Uint32BufferAttribute:()=>Du,Uint8BufferAttribute:()=>Ru,Uint8ClampedBufferAttribute:()=>Cu,Uniform:()=>gy,UniformsGroup:()=>by,UniformsLib:()=>Dc,UniformsUtils:()=>vc,UnsignedByteType:()=>Wi,UnsignedInt248Type:()=>ta,UnsignedIntType:()=>Ji,UnsignedShort4444Type:()=>$i,UnsignedShort5551Type:()=>ea,UnsignedShortType:()=>Yi,VSMShadowMap:()=>Pr,Vector2:()=>bs,Vector3:()=>Qs,Vector4:()=>Gs,VectorKeyframeTrack:()=>Xv,VideoTexture:()=>qp,WebGL1Renderer:()=>mf,WebGL3DRenderTarget:()=>Ks,WebGLArrayRenderTarget:()=>Xs,WebGLCoordinateSystem:()=>rs,WebGLCubeRenderTarget:()=>Ec,WebGLMultipleRenderTargets:()=>Js,WebGLRenderTarget:()=>Ws,WebGLRenderer:()=>pf,WebGLUtils:()=>of,WebGPUCoordinateSystem:()=>is,WireframeGeometry:()=>gv,WrapAroundEnding:()=>$a,ZeroCurvatureEnding:()=>Za,ZeroFactor:()=>Wr,ZeroSlopeEnding:()=>Qa,ZeroStencilOp:()=>wo,_SRGBAFormat:()=>ns,createCanvasElement:()=>Ms,sRGBEncoding:()=>oo});var t={};n.r(t),n.d(t,{Decoder:()=>jC,Encoder:()=>FC,PacketType:()=>BC,protocol:()=>zC});var r={"Total ANAVER.SE":{dbut:0,fin:0,dure:"NA"},"Code Barre":{dbut:0,fin:0,dure:"NA"},Identit:{dbut:0,fin:0,dure:"NA"},"Liste des Jetons Natifs":{dbut:0,fin:0,dure:"NA"},"Choix alatoire":{dbut:0,fin:0,dure:"NA"},"Tlchargement premier espace":{dbut:0,fin:0,dure:"NA"},"Cration Monde":{dbut:0,fin:0,dure:"NA"},"Galleries Natives":{dbut:0,fin:0,dure:"NA"}};function i(){}function a(e){return null==e?i:function(){return this.querySelector(e)}}function o(){return[]}function s(e){return null==e?o:function(){return this.querySelectorAll(e)}}function l(e){return function(){return this.matches(e)}}function u(e){return function(t){return t.matches(e)}}window.horlogesLog=function(){for(var e in console.log("%cTableau de bord des horloges","font-weight:bold;text-decoration:underline;"),console.log("Toutes les dures sont en millisecondes."),r)r[e].fin>0?r[e].dure=r[e].fin-r[e].dbut:r[e].dure="NA";console.table(r)};var c=Array.prototype.find;function h(){return this.firstElementChild}var d=Array.prototype.filter;function f(){return Array.from(this.children)}function p(e){return new Array(e.length)}function m(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(e,t,n,r,i,a){for(var o,s=0,l=t.length,u=a.length;s<u;++s)(o=t[s])?(o.__data__=a[s],r[s]=o):n[s]=new m(e,a[s]);for(;s<l;++s)(o=t[s])&&(i[s]=o)}function y(e,t,n,r,i,a,o){var s,l,u,c=new Map,h=t.length,d=a.length,f=new Array(h);for(s=0;s<h;++s)(l=t[s])&&(f[s]=u=o.call(l,l.__data__,s,t)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<d;++s)u=o.call(e,a[s],s,a)+"",(l=c.get(u))?(r[s]=l,l.__data__=a[s],c.delete(u)):n[s]=new m(e,a[s]);for(s=0;s<h;++s)(l=t[s])&&c.get(f[s])===l&&(i[s]=l)}function b(e){return e.__data__}function x(e){return"object"===v(e)&&"length"in e?e:Array.from(e)}function w(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}m.prototype={constructor:m,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var E="http://www.w3.org/1999/xhtml";const T={svg:"http://www.w3.org/2000/svg",xhtml:E,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function S(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),T.hasOwnProperty(t)?{space:T[t],local:e}:e}function M(e){return function(){this.removeAttribute(e)}}function A(e){return function(){this.removeAttributeNS(e.space,e.local)}}function k(e,t){return function(){this.setAttribute(e,t)}}function P(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function R(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function C(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function L(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function I(e){return function(){this.style.removeProperty(e)}}function O(e,t,n){return function(){this.style.setProperty(e,t,n)}}function D(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function N(e,t){return e.style.getPropertyValue(t)||L(e).getComputedStyle(e,null).getPropertyValue(t)}function B(e){return function(){delete this[e]}}function U(e,t){return function(){this[e]=t}}function z(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function F(e){return e.trim().split(/^|\s+/)}function H(e){return e.classList||new j(e)}function j(e){this._node=e,this._names=F(e.getAttribute("class")||"")}function G(e,t){for(var n=H(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function V(e,t){for(var n=H(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function W(e){return function(){G(this,e)}}function q(e){return function(){V(this,e)}}function X(e,t){return function(){(t.apply(this,arguments)?G:V)(this,e)}}function Y(){this.textContent=""}function K(e){return function(){this.textContent=e}}function J(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Z(){this.innerHTML=""}function Q(e){return function(){this.innerHTML=e}}function $(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ee(){this.nextSibling&&this.parentNode.appendChild(this)}function te(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ne(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===E&&t.documentElement.namespaceURI===E?t.createElement(e):t.createElementNS(n,e)}}function re(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ie(e){var t=S(e);return(t.local?re:ne)(t)}function ae(){return null}function oe(){var e=this.parentNode;e&&e.removeChild(this)}function se(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function le(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ue(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function ce(e,t,n){return function(){var r,i=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=t);this.addEventListener(e.type,a,n),r={type:e.type,name:e.name,value:t,listener:a,options:n},i?i.push(r):this.__on=[r]}}function he(e,t,n){var r=L(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function de(e,t){return function(){return he(this,e,t)}}function fe(e,t){return function(){return he(this,e,t.apply(this,arguments))}}function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function me(){me=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),s=new R(r||[]);return i(o,"_invoke",{value:M(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var x={};u(x,o,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(C([])));_&&_!==n&&r.call(_,o)&&(x=_);var E=b.prototype=g.prototype=Object.create(x);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,a,o,s){var l=h(e[i],e,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==pe(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function M(t,n,r){var i=d;return function(a,o){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=A(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(t,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function A(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=h(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(pe(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new S(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(E),u(E,l,"Generator"),u(E,o,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}j.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ve=me().mark(ge);function ge(){var e,t,n,r,i,a,o;return me().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=this._groups,t=0,n=e.length;case 1:if(!(t<n)){s.next=13;break}r=e[t],i=0,a=r.length;case 3:if(!(i<a)){s.next=10;break}if(!(o=r[i])){s.next=7;break}return s.next=7,o;case 7:++i,s.next=3;break;case 10:++t,s.next=1;break;case 13:case"end":return s.stop()}}),ve,this)}function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}var be=[null];function xe(e,t){this._groups=e,this._parents=t}function we(){return new xe([[document.documentElement]],be)}xe.prototype=we.prototype=function(e,t,n){return t=function(e){var t=function(e,t){if("object"!=ye(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ye(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({constructor:xe,select:function(e){"function"!=typeof e&&(e=a(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s,l=t[i],u=l.length,c=r[i]=new Array(u),h=0;h<u;++h)(o=l[h])&&(s=e.call(o,o.__data__,h,l))&&("__data__"in o&&(s.__data__=o.__data__),c[h]=s);return new xe(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}(e):s(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o,l=t[a],u=l.length,c=0;c<u;++c)(o=l[c])&&(r.push(e.call(o,o.__data__,c,l)),i.push(o));return new xe(r,i)},selectChild:function(e){return this.select(null==e?h:function(e){return function(){return c.call(this.children,e)}}("function"==typeof e?e:u(e)))},selectChildren:function(e){return this.selectAll(null==e?f:function(e){return function(){return d.call(this.children,e)}}("function"==typeof e?e:u(e)))},filter:function(e){"function"!=typeof e&&(e=l(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,u=r[i]=[],c=0;c<s;++c)(a=o[c])&&e.call(a,a.__data__,c,o)&&u.push(a);return new xe(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,b);var n=t?y:g,r=this._parents,i=this._groups;"function"!=typeof e&&(e=function(e){return function(){return e}}(e));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],h=i[u],d=h.length,f=x(e.call(c,c&&c.__data__,u,r)),p=f.length,m=s[u]=new Array(p),v=o[u]=new Array(p);n(c,h,m,v,l[u]=new Array(d),f,t);for(var w,_,E=0,T=0;E<p;++E)if(w=m[E]){for(E>=T&&(T=E+1);!(_=v[T])&&++T<p;);w._next=_||null}}return(o=new xe(o,r))._enter=s,o._exit=l,o},enter:function(){return new xe(this._enter||this._groups.map(p),this._parents)},exit:function(){return new xe(this._exit||this._groups.map(p),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,a=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var u,c=n[l],h=r[l],d=c.length,f=s[l]=new Array(d),p=0;p<d;++p)(u=c[p]||h[p])&&(f[p]=u);for(;l<i;++l)s[l]=n[l];return new xe(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=w);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],l=s.length,u=i[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(t)}return new xe(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var e,t=0,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this);try{for(n.s();!(e=n.n()).done;)e.value,++t}catch(e){n.e(e)}finally{n.f()}return t},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,a=t[n],o=0,s=a.length;o<s;++o)(i=a[o])&&e.call(i,i.__data__,o,a);return this},attr:function(e,t){var n=S(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?A:M:"function"==typeof t?n.local?C:R:n.local?P:k)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?I:"function"==typeof t?D:O)(e,t,null==n?"":n)):N(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?B:"function"==typeof t?z:U)(e,t)):this.node()[e]},classed:function(e,t){var n=F(e+"");if(arguments.length<2){for(var r=H(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?X:t?W:q)(n,t))},text:function(e){return arguments.length?this.each(null==e?Y:("function"==typeof e?J:K)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Z:("function"==typeof e?$:Q)(e)):this.node().innerHTML},raise:function(){return this.each(ee)},lower:function(){return this.each(te)},append:function(e){var t="function"==typeof e?e:ie(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:ie(e),r=null==t?ae:"function"==typeof t?t:a(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(oe)},clone:function(e){return this.select(e?le:se)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,a=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}(e+""),o=a.length;if(!(arguments.length<2)){for(s=t?ce:ue,r=0;r<o;++r)this.each(s(a[r],t,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?fe:de)(e,t))}},Symbol.iterator,ge);const _e=we;var Ee={value:function(){}};function Te(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new Se(r)}function Se(e){this._=e}function Me(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function Ae(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Ee,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Se.prototype=Te.prototype={constructor:Se,on:function(e,t){var n,r,i=this._,a=(r=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=a[o]).type)i[n]=Ae(i[n],e.name,t);else if(null==t)for(n in i)i[n]=Ae(i[n],e.name,null);return this}for(;++o<s;)if((n=(e=a[o]).type)&&(n=Me(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Se(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,n=(r=this._[e]).length;a<n;++a)r[a].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};const ke=Te;function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}var Re,Ce,Le=0,Ie=0,Oe=0,De=1e3,Ne=0,Be=0,Ue=0,ze="object"===("undefined"==typeof performance?"undefined":Pe(performance))&&performance.now?performance:Date,Fe="object"===("undefined"==typeof window?"undefined":Pe(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function He(){return Be||(Fe(je),Be=ze.now()+Ue)}function je(){Be=0}function Ge(){this._call=this._time=this._next=null}function Ve(e,t,n){var r=new Ge;return r.restart(e,t,n),r}function We(){Be=(Ne=ze.now())+Ue,Le=Ie=0;try{!function(){He(),++Le;for(var e,t=Re;t;)(e=Be-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Le}()}finally{Le=0,function(){for(var e,t,n=Re,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Re=t);Ce=e,Xe(r)}(),Be=0}}function qe(){var e=ze.now(),t=e-Ne;t>De&&(Ue-=t,Ne=e)}function Xe(e){Le||(Ie&&(Ie=clearTimeout(Ie)),e-Be>24?(e<1/0&&(Ie=setTimeout(We,e-ze.now()-Ue)),Oe&&(Oe=clearInterval(Oe))):(Oe||(Ne=ze.now(),Oe=setInterval(qe,De)),Le=1,Fe(We)))}function Ye(e,t,n){var r=new Ge;return t=null==t?0:+t,r.restart((function(n){r.stop(),e(n+t)}),t,n),r}Ge.prototype=Ve.prototype={constructor:Ge,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?He():+n)+(null==t?0:+t),this._next||Ce===this||(Ce?Ce._next=this:Re=this,Ce=this),this._call=e,this._time=n,Xe()},stop:function(){this._call&&(this._call=null,this._time=1/0,Xe())}};var Ke=ke("start","end","cancel","interrupt"),Je=[],Ze=0,Qe=3;function $e(e,t,n,r,i,a){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function a(l){var u,c,h,d;if(1!==n.state)return s();for(u in i)if((d=i[u]).name===n.name){if(d.state===Qe)return Ye(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[u]):+u<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete i[u])}if(Ye((function(){n.state===Qe&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=Qe,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(d=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function o(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=Ve((function(e){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=e&&a(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:i,on:Ke,tween:Je,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Ze})}function et(e,t){var n=nt(e,t);if(n.state>Ze)throw new Error("too late; already scheduled");return n}function tt(e,t){var n=nt(e,t);if(n.state>Qe)throw new Error("too late; already running");return n}function nt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function rt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var it,at=180/Math.PI,ot={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function st(e,t,n,r,i,a){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*at,skewX:Math.atan(l)*at,scaleX:o,scaleY:s}}function lt(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(a,o){var s=[],l=[];return a=e(a),o=e(o),function(e,r,i,a,o,s){if(e!==i||r!==a){var l=o.push("translate(",null,t,null,n);s.push({i:l-4,x:rt(e,i)},{i:l-2,x:rt(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:rt(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(a.rotate,o.rotate,s,l),function(e,t,n,a){e!==t?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:rt(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(a.skewX,o.skewX,s,l),function(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:rt(e,n)},{i:s-2,x:rt(t,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var ut=lt((function(e){var t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ot:st(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),ct=lt((function(e){return null==e?ot:(it||(it=document.createElementNS("http://www.w3.org/2000/svg","g")),it.setAttribute("transform",e),(e=it.transform.baseVal.consolidate())?st((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):ot)}),", ",")",")");function ht(e,t){var n,r;return function(){var i=tt(this,e),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}i.tween=r}}function dt(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=tt(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function ft(e,t,n){var r=e._id;return e.each((function(){var e=tt(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return nt(e,r).value[t]}}function pt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function mt(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function vt(){return vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vt.apply(this,arguments)}function gt(){}var yt=.7,bt=1/yt,xt="\\s*([+-]?\\d+)\\s*",wt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_t="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Et=/^#([0-9a-f]{3,8})$/,Tt=new RegExp("^rgb\\(".concat(xt,",").concat(xt,",").concat(xt,"\\)$")),St=new RegExp("^rgb\\(".concat(_t,",").concat(_t,",").concat(_t,"\\)$")),Mt=new RegExp("^rgba\\(".concat(xt,",").concat(xt,",").concat(xt,",").concat(wt,"\\)$")),At=new RegExp("^rgba\\(".concat(_t,",").concat(_t,",").concat(_t,",").concat(wt,"\\)$")),kt=new RegExp("^hsl\\(".concat(wt,",").concat(_t,",").concat(_t,"\\)$")),Pt=new RegExp("^hsla\\(".concat(wt,",").concat(_t,",").concat(_t,",").concat(wt,"\\)$")),Rt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ct(){return this.rgb().formatHex()}function Lt(){return this.rgb().formatRgb()}function It(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Et.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Ot(t):3===n?new Bt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Dt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Dt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Tt.exec(e))?new Bt(t[1],t[2],t[3],1):(t=St.exec(e))?new Bt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Mt.exec(e))?Dt(t[1],t[2],t[3],t[4]):(t=At.exec(e))?Dt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=kt.exec(e))?Gt(t[1],t[2]/100,t[3]/100,1):(t=Pt.exec(e))?Gt(t[1],t[2]/100,t[3]/100,t[4]):Rt.hasOwnProperty(e)?Ot(Rt[e]):"transparent"===e?new Bt(NaN,NaN,NaN,0):null}function Ot(e){return new Bt(e>>16&255,e>>8&255,255&e,1)}function Dt(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bt(e,t,n,r)}function Nt(e,t,n,r){return 1===arguments.length?((i=e)instanceof gt||(i=It(i)),i?new Bt((i=i.rgb()).r,i.g,i.b,i.opacity):new Bt):new Bt(e,t,n,null==r?1:r);var i}function Bt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Ut(){return"#".concat(jt(this.r)).concat(jt(this.g)).concat(jt(this.b))}function zt(){var e=Ft(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Ht(this.r),", ").concat(Ht(this.g),", ").concat(Ht(this.b)).concat(1===e?")":", ".concat(e,")"))}function Ft(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ht(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function jt(e){return((e=Ht(e))<16?"0":"")+e.toString(16)}function Gt(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Wt(e,t,n,r)}function Vt(e){if(e instanceof Wt)return new Wt(e.h,e.s,e.l,e.opacity);if(e instanceof gt||(e=It(e)),!e)return new Wt;if(e instanceof Wt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Wt(o,s,l,e.opacity)}function Wt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function qt(e){return(e=(e||0)%360)<0?e+360:e}function Xt(e){return Math.max(0,Math.min(1,e||0))}function Yt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Kt(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}pt(gt,It,{copy:function(e){return vt(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Ct,formatHex:Ct,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Vt(this).formatHsl()},formatRgb:Lt,toString:Lt}),pt(Bt,Nt,mt(gt,{brighter:function(e){return e=null==e?bt:Math.pow(bt,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?yt:Math.pow(yt,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new Bt(Ht(this.r),Ht(this.g),Ht(this.b),Ft(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ut,formatHex:Ut,formatHex8:function(){return"#".concat(jt(this.r)).concat(jt(this.g)).concat(jt(this.b)).concat(jt(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:zt,toString:zt})),pt(Wt,(function(e,t,n,r){return 1===arguments.length?Vt(e):new Wt(e,t,n,null==r?1:r)}),mt(gt,{brighter:function(e){return e=null==e?bt:Math.pow(bt,e),new Wt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?yt:Math.pow(yt,e),new Wt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Bt(Yt(e>=240?e-240:e+120,i,r),Yt(e,i,r),Yt(e<120?e+240:e-120,i,r),this.opacity)},clamp:function(){return new Wt(qt(this.h),Xt(this.s),Xt(this.l),Ft(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=Ft(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(qt(this.h),", ").concat(100*Xt(this.s),"%, ").concat(100*Xt(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Jt=function(e){return function(){return e}};function Zt(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Jt(isNaN(e)?t:e)}const Qt=function e(t){var n=function(e){return 1==(e=+e)?Zt:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Jt(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=Nt(e)).r,(t=Nt(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=Zt(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function $t(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Nt(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}$t((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return Kt((n-r/t)*t,o,i,a,s)}})),$t((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Kt((n-r/t)*t,i,a,o,s)}}));var en=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tn=new RegExp(en.source,"g");function nn(e,t){var n,r,i,a=en.lastIndex=tn.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=en.exec(e))&&(r=tn.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:rt(n,r)})),a=tn.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function rn(e,t){var n;return("number"==typeof t?rt:t instanceof It?Qt:(n=It(t))?(t=n,Qt):nn)(e,t)}function an(e){return function(){this.removeAttribute(e)}}function on(e){return function(){this.removeAttributeNS(e.space,e.local)}}function sn(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttribute(e);return o===a?null:o===r?i:i=t(r=o,n)}}function ln(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===r?i:i=t(r=o,n)}}function un(e,t,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(e))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,l));this.removeAttribute(e)}}function cn(e,t,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,l));this.removeAttributeNS(e.space,e.local)}}function hn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,i)),n}return i._value=t,i}function dn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,i)),n}return i._value=t,i}function fn(e,t){return function(){et(this,e).delay=+t.apply(this,arguments)}}function pn(e,t){return t=+t,function(){et(this,e).delay=t}}function mn(e,t){return function(){tt(this,e).duration=+t.apply(this,arguments)}}function vn(e,t){return t=+t,function(){tt(this,e).duration=t}}var gn=_e.prototype.constructor;function yn(e){return function(){this.style.removeProperty(e)}}function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}var xn=0;function wn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function _n(){return++xn}var En=_e.prototype;wn.prototype=function(e){return _e().transition(e)}.prototype=function(e,t,n){return t=function(e){var t=function(e,t){if("object"!=bn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=bn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==bn(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({constructor:wn,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=a(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var l,u,c=r[s],h=c.length,d=o[s]=new Array(h),f=0;f<h;++f)(l=c[f])&&(u=e.call(l,l.__data__,f,c))&&("__data__"in l&&(u.__data__=l.__data__),d[f]=u,$e(d[f],t,n,f,d,nt(l,n)));return new wn(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=s(e));for(var r=this._groups,i=r.length,a=[],o=[],l=0;l<i;++l)for(var u,c=r[l],h=c.length,d=0;d<h;++d)if(u=c[d]){for(var f,p=e.call(u,u.__data__,d,c),m=nt(u,n),v=0,g=p.length;v<g;++v)(f=p[v])&&$e(f,t,n,v,p,m);a.push(p),o.push(u)}return new wn(a,o,t,n)},selectChild:En.selectChild,selectChildren:En.selectChildren,filter:function(e){"function"!=typeof e&&(e=l(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,u=r[i]=[],c=0;c<s;++c)(a=o[c])&&e.call(a,a.__data__,c,o)&&u.push(a);return new wn(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,u=t[s],c=n[s],h=u.length,d=o[s]=new Array(h),f=0;f<h;++f)(l=u[f]||c[f])&&(d[f]=l);for(;s<r;++s)o[s]=t[s];return new wn(o,this._parents,this._name,this._id)},selection:function(){return new gn(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=_n(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=nt(o,t);$e(o,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new wn(r,this._parents,e,n)},call:En.call,nodes:En.nodes,node:En.node,size:En.size,empty:En.empty,each:En.each,on:function(e,t){var n=this._id;return arguments.length<2?nt(this.node(),n).on.on(e):this.each(function(e,t,n){var r,i,a=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?et:tt;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}(n,e,t))},attr:function(e,t){var n=S(e),r="transform"===n?ct:rn;return this.attrTween(e,"function"==typeof t?(n.local?cn:un)(n,r,ft(this,"attr."+e,t)):null==t?(n.local?on:an)(n):(n.local?ln:sn)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=S(e);return this.tween(n,(r.local?hn:dn)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?ut:rn;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var a=N(this,e),o=(this.style.removeProperty(e),N(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}(e,r)).on("end.style."+e,yn(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,a;return function(){var o=N(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=N(this,e)),o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s))}}(e,r,ft(this,"style."+e,t))).each(function(e,t){var n,r,i,a,o="style."+t,s="end."+o;return function(){var l=tt(this,e),u=l.on,c=null==l.value[o]?a||(a=yn(t)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,a=n+"";return function(){var o=N(this,e);return o===a?null:o===r?i:i=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,a,n)),r}return a._value=t,a}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(ft(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=nt(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===e)return r.value;return null}return this.each((null==t?ht:dt)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?fn:pn)(t,e)):nt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?mn:vn)(t,e)):nt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){tt(this,e).ease=t}}(t,e)):nt(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;tt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0==--i&&a()}};n.each((function(){var n=tt(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t})),0===i&&a()}))}},Symbol.iterator,En[Symbol.iterator]);var Tn={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Sn(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}function Mn(e){return{type:e}}function An(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}_e.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,a=e.__transition,o=!0;if(a){for(i in t=null==t?null:t+"",a)(n=a[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete e.__transition}}(this,e)}))},_e.prototype.transition=function(e){var t,n;e instanceof wn?(t=e._id,e=e._name):(t=_n(),(n=Tn).time=He(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)(o=s[u])&&$e(o,e,t,u,s,n||Sn(o,t));return new wn(r,this._parents,e,t)},Math.abs,Math.max,Math.min,["w","e"].map(Mn),["n","s"].map(Mn),["n","w","e","s","nw","ne","sw","se"].map(Mn);var kn,Pn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Rn(e){if(!(t=Pn.exec(e)))throw new Error("invalid format: "+e);var t;return new Cn({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Cn(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ln(e,t){var n=An(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Rn.prototype=Cn.prototype,Cn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const In={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Ln(100*e,t)},r:Ln,s:function(e,t){var n=An(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(kn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+An(e,Math.max(0,t+a-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function On(e){return e}var Dn,Nn,Bn=Array.prototype.map,Un=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function zn(e){return Dn=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?On:(t=Bn.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?On:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Bn.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Rn(e)).fill,n=e.align,h=e.sign,d=e.symbol,f=e.zero,p=e.width,m=e.comma,v=e.precision,g=e.trim,y=e.type;"n"===y?(m=!0,y="g"):In[y]||(void 0===v&&(v=12),g=!0,y="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?a:/[%p]/.test(y)?l:"",w=In[y],_=/[defgprs%]/.test(y);function E(e){var i,a,l,d=b,E=x;if("c"===y)E=w(e)+E,e="";else{var T=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:w(Math.abs(e),v),g&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),T&&0==+e&&"+"!==h&&(T=!1),d=(T?"("===h?h:u:"-"===h||"("===h?"":h)+d,E=("s"===y?Un[8+kn/3]:"")+E+(T&&"("===h?")":""),_)for(i=-1,a=e.length;++i<a;)if(48>(l=e.charCodeAt(i))||l>57){E=(46===l?o+e.slice(i+1):e.slice(i))+E,e=e.slice(0,i);break}}m&&!f&&(e=r(e,1/0));var S=d.length+e.length+E.length,M=S<p?new Array(p-S+1).join(t):"";switch(m&&f&&(e=r(M+e,M.length?p-E.length:1/0),M=""),n){case"<":e=d+e+E+M;break;case"=":e=d+M+e+E;break;case"^":e=M.slice(0,S=M.length>>1)+d+e+E+M.slice(S);break;default:e=M+d+e+E}return s(e)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),E.toString=function(){return e+""},E}return{format:h,formatPrefix:function(e,t){var n=h(((e=Rn(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(function(e){return(e=An(Math.abs(e)))?e[1]:NaN}(t)/3))),i=Math.pow(10,-r),a=Un[8+r/3];return function(e){return n(i*e)+a}}}}(e),Nn=Dn.format,Dn.formatPrefix,Dn}function Fn(e){return"string"==typeof e?new xe([[document.querySelector(e)]],[document.documentElement]):new xe([[e]],be)}function Hn(e){return Fn(ie(e).call(document.documentElement))}function jn(e,t,n){this.k=e,this.x=t,this.y=n}zn({thousands:",",grouping:[3],currency:["$",""]}),jn.prototype={constructor:jn,scale:function(e){return 1===e?this:new jn(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new jn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new jn(1,0,0),jn.prototype;var Gn=(new Date).getHours(),Vn=new URLSearchParams(window.location.search);Vn.has("nightMode")&&(Gn="night"===Vn.get("nightMode")?23:8);for(var Wn=[],qn=Gn<=6||Gn>=20?"screen":"multiply",Xn=0;Xn<25;Xn++)Wn.push(parseInt(4*Math.random()));function Yn(e){var t="function"==typeof Map?new Map:void 0;return Yn=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(sr())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&hr(i,n.prototype),i}(e,arguments,lr(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),hr(n,e)},Yn(e)}function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){dr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zn(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function Qn(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){Zn(a,r,i,o,s,"next",e)}function s(e){Zn(a,r,i,o,s,"throw",e)}o(void 0)}))}}function $n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=rr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||rr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tr(){return tr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lr(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},tr.apply(this,arguments)}function nr(e){return function(e){if(Array.isArray(e))return ir(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||rr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rr(e,t){if(e){if("string"==typeof e)return ir(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ir(e,t):void 0}}function ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ar(){return ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ar.apply(this,arguments)}function or(e,t,n){return t=lr(t),function(e,t){if(t&&("object"===pr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ur(e)}(e,sr()?Reflect.construct(t,n||[],lr(e).constructor):t.apply(e,n))}function sr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(sr=function(){return!!e})()}function lr(e){return lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lr(e)}function ur(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hr(e,t)}function hr(e,t){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hr(e,t)}function dr(e,t,n){return(t=yr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fr(){fr=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),s=new R(r||[]);return i(o,"_invoke",{value:M(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var x={};u(x,o,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(C([])));_&&_!==n&&r.call(_,o)&&(x=_);var E=b.prototype=g.prototype=Object.create(x);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,a,o,s){var l=h(e[i],e,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==pr(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function M(t,n,r){var i=d;return function(a,o){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=A(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(t,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function A(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=h(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(pr(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new S(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(E),u(E,l,"Generator"),u(E,o,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function pr(e){return pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pr(e)}function mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yr(r.key),r)}}function gr(e,t,n){return t&&vr(e.prototype,t),n&&vr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yr(e){var t=function(e,t){if("object"!=pr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=pr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pr(t)?t:String(t)}var br="160",xr={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},wr={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},_r=0,Er=1,Tr=2,Sr=3,Mr=0,Ar=1,kr=2,Pr=3,Rr=0,Cr=1,Lr=2,Ir=2,Or=0,Dr=1,Nr=2,Br=3,Ur=4,zr=5,Fr=100,Hr=101,jr=102,Gr=103,Vr=104,Wr=200,qr=201,Xr=202,Yr=203,Kr=204,Jr=205,Zr=206,Qr=207,$r=208,ei=209,ti=210,ni=211,ri=212,ii=213,ai=214,oi=0,si=1,li=2,ui=3,ci=4,hi=5,di=6,fi=7,pi=0,mi=1,vi=2,gi=0,yi=1,bi=2,xi=3,wi=4,_i=5,Ei=6,Ti="attached",Si="detached",Mi=300,Ai=301,ki=302,Pi=303,Ri=304,Ci=306,Li=1e3,Ii=1001,Oi=1002,Di=1003,Ni=1004,Bi=1004,Ui=1005,zi=1005,Fi=1006,Hi=1007,ji=1007,Gi=1008,Vi=1008,Wi=1009,qi=1010,Xi=1011,Yi=1012,Ki=1013,Ji=1014,Zi=1015,Qi=1016,$i=1017,ea=1018,ta=1020,na=1021,ra=1023,ia=1024,aa=1025,oa=1026,sa=1027,la=1028,ua=1029,ca=1030,ha=1031,da=1033,fa=33776,pa=33777,ma=33778,va=33779,ga=35840,ya=35841,ba=35842,xa=35843,wa=36196,_a=37492,Ea=37496,Ta=37808,Sa=37809,Ma=37810,Aa=37811,ka=37812,Pa=37813,Ra=37814,Ca=37815,La=37816,Ia=37817,Oa=37818,Da=37819,Na=37820,Ba=37821,Ua=36492,za=36494,Fa=36495,Ha=36283,ja=36284,Ga=36285,Va=36286,Wa=2200,qa=2201,Xa=2202,Ya=2300,Ka=2301,Ja=2302,Za=2400,Qa=2401,$a=2402,eo=2500,to=2501,no=0,ro=1,io=2,ao=3e3,oo=3001,so=3200,lo=3201,uo=0,co=1,ho="",fo="srgb",po="srgb-linear",mo="display-p3",vo="display-p3-linear",go="linear",yo="srgb",bo="rec709",xo="p3",wo=0,_o=7680,Eo=7681,To=7682,So=7683,Mo=34055,Ao=34056,ko=5386,Po=512,Ro=513,Co=514,Lo=515,Io=516,Oo=517,Do=518,No=519,Bo=512,Uo=513,zo=514,Fo=515,Ho=516,jo=517,Go=518,Vo=519,Wo=35044,qo=35048,Xo=35040,Yo=35045,Ko=35049,Jo=35041,Zo=35046,Qo=35050,$o=35042,es="100",ts="300 es",ns=1035,rs=2e3,is=2001,as=function(){function e(){mr(this,e)}return gr(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}}]),e}(),os=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],ss=1234567,ls=Math.PI/180,us=180/Math.PI;function cs(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(os[255&e]+os[e>>8&255]+os[e>>16&255]+os[e>>24&255]+"-"+os[255&t]+os[t>>8&255]+"-"+os[t>>16&15|64]+os[t>>24&255]+"-"+os[63&n|128]+os[n>>8&255]+"-"+os[n>>16&255]+os[n>>24&255]+os[255&r]+os[r>>8&255]+os[r>>16&255]+os[r>>24&255]).toLowerCase()}function hs(e,t,n){return Math.max(t,Math.min(n,e))}function ds(e,t){return(e%t+t)%t}function fs(e,t,n){return(1-n)*e+n*t}function ps(e){return 0==(e&e-1)&&0!==e}function ms(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function vs(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function gs(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var ys={DEG2RAD:ls,RAD2DEG:us,generateUUID:cs,clamp:hs,euclideanModulo:ds,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:fs,damp:function(e,t,n,r){return fs(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(ds(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(ss=e);var t=ss+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*ls},radToDeg:function(e){return e*us},isPowerOfTwo:ps,ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:ms,setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((t+r)/2),c=o((t+r)/2),h=a((t-r)/2),d=o((t-r)/2),f=a((r-t)/2),p=o((r-t)/2);switch(i){case"XYX":e.set(s*c,l*h,l*d,s*u);break;case"YZY":e.set(l*d,s*c,l*h,s*u);break;case"ZXZ":e.set(l*h,l*d,s*c,s*u);break;case"XZX":e.set(s*c,l*p,l*f,s*u);break;case"YXY":e.set(l*f,s*c,l*p,s*u);break;case"ZYZ":e.set(l*p,l*f,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:gs,denormalize:vs},bs=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;mr(this,t),t.prototype.isVector2=!0,this.x=e,this.y=n}return gr(t,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){return Math.atan2(-this.y,-this.x)+Math.PI}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(hs(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:Symbol.iterator,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:case"end":return e.stop()}}),e,this)}))}]),t}(),xs=function(){function e(t,n,r,i,a,o,s,l,u){mr(this,e),e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,n,r,i,a,o,s,l,u)}return gr(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l){var u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],v=r[6],g=r[1],y=r[4],b=r[7],x=r[2],w=r[5],_=r[8];return i[0]=a*p+o*g+s*x,i[3]=a*m+o*y+s*w,i[6]=a*v+o*b+s*_,i[1]=l*p+u*g+c*x,i[4]=l*m+u*y+c*w,i[7]=l*v+u*b+c*_,i[2]=h*p+d*g+f*x,i[5]=h*m+d*y+f*w,i[8]=h*v+d*b+f*_,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*a*u-t*o*l-n*i*u+n*o*s+r*i*l-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=u*a-o*l,h=o*s-u*i,d=l*i-a*s,f=t*c+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var p=1/f;return e[0]=c*p,e[1]=(r*l-u*n)*p,e[2]=(o*n-r*a)*p,e[3]=h*p,e[4]=(u*t-r*s)*p,e[5]=(r*i-o*t)*p,e[6]=d*p,e[7]=(n*s-l*t)*p,e[8]=(a*t-n*i)*p,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){return this.premultiply(ws.makeScale(e,t)),this}},{key:"rotate",value:function(e){return this.premultiply(ws.makeRotation(-e)),this}},{key:"translate",value:function(e,t){return this.premultiply(ws.makeTranslation(e,t)),this}},{key:"makeTranslation",value:function(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}},{key:"makeRotation",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}},{key:"makeScale",value:function(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}(),ws=new xs;function _s(e){for(var t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var Es={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ts(e,t){return new Es[e](t)}function Ss(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Ms(){var e=Ss("canvas");return e.style.display="block",e}var As={};function ks(e){e in As||(As[e]=!0,console.warn(e))}var Ps,Rs=(new xs).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Cs=(new xs).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ls=dr(dr(dr(dr({},po,{transfer:go,primaries:bo,toReference:function(e){return e},fromReference:function(e){return e}}),fo,{transfer:yo,primaries:bo,toReference:function(e){return e.convertSRGBToLinear()},fromReference:function(e){return e.convertLinearToSRGB()}}),vo,{transfer:go,primaries:xo,toReference:function(e){return e.applyMatrix3(Cs)},fromReference:function(e){return e.applyMatrix3(Rs)}}),mo,{transfer:yo,primaries:xo,toReference:function(e){return e.convertSRGBToLinear().applyMatrix3(Cs)},fromReference:function(e){return e.applyMatrix3(Rs).convertLinearToSRGB()}}),Is=new Set([po,vo]),Os={enabled:!0,_workingColorSpace:po,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!Is.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;var r=Ls[t].toReference;return(0,Ls[n].fromReference)(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return Ls[e].primaries},getTransfer:function(e){return e===ho?go:Ls[e].transfer}};function Ds(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ns(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var Bs=function(){function e(){mr(this,e)}return gr(e,null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ps&&(Ps=Ss("canvas")),Ps.width=e.width,Ps.height=e.height;var n=Ps.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ps}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}},{key:"sRGBToLinear",value:function(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var t=Ss("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);for(var r=n.getImageData(0,0,e.width,e.height),i=r.data,a=0;a<i.length;a++)i[a]=255*Ds(i[a]/255);return n.putImageData(r,0,0),t}if(e.data){for(var o=e.data.slice(0),s=0;s<o.length;s++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[s]=Math.floor(255*Ds(o[s]/255)):o[s]=Ds(o[s]);return{data:o,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}]),e}(),Us=0,zs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;mr(this,e),this.isSource=!0,Object.defineProperty(this,"id",{value:Us++}),this.uuid=cs(),this.data=t,this.version=0}return gr(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];var n={uuid:this.uuid,url:""},r=this.data;if(null!==r){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(Fs(r[a].image)):i.push(Fs(r[a]))}else i=Fs(r);n.url=i}return t||(e.images[this.uuid]=n),n}}]),e}();function Fs(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?Bs.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Hs=0,js=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.DEFAULT_IMAGE,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.DEFAULT_MAPPING,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ii,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ii,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fi,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Gi,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ra,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Wi,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:t.DEFAULT_ANISOTROPY,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:ho;return mr(this,t),(e=or(this,t)).isTexture=!0,Object.defineProperty(ur(e),"id",{value:Hs++}),e.uuid=cs(),e.name="",e.source=new zs(n),e.mipmaps=[],e.mapping=r,e.channel=0,e.wrapS=i,e.wrapT=a,e.magFilter=o,e.minFilter=s,e.anisotropy=c,e.format=l,e.internalFormat=null,e.type=u,e.offset=new bs(0,0),e.repeat=new bs(1,1),e.center=new bs(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new xs,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,"string"==typeof h?e.colorSpace=h:(ks("THREE.Texture: Property .encoding has been replaced by .colorSpace."),e.colorSpace=h===oo?fo:ho),e.userData={},e.version=0,e.onUpdate=null,e.isRenderTargetTexture=!1,e.needsPMREMUpdate=!1,e}return cr(t,e),gr(t,[{key:"image",get:function(){return this.source.data},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.source.data=e}},{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==Mi)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Li:e.x=e.x-Math.floor(e.x);break;case Ii:e.x=e.x<0?0:1;break;case Oi:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Li:e.y=e.y-Math.floor(e.y);break;case Ii:e.y=e.y<0?0:1;break;case Oi:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}},{key:"encoding",get:function(){return ks("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===fo?oo:ao},set:function(e){ks("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===oo?fo:ho}}]),t}(as);js.DEFAULT_IMAGE=null,js.DEFAULT_MAPPING=Mi,js.DEFAULT_ANISOTROPY=1;var Gs=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;mr(this,t),t.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}return gr(t,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,l=s[0],u=s[4],c=s[8],h=s[1],d=s[5],f=s[9],p=s[2],m=s[6],v=s[10];if(Math.abs(u-h)<a&&Math.abs(c-p)<a&&Math.abs(f-m)<a){if(Math.abs(u+h)<o&&Math.abs(c+p)<o&&Math.abs(f+m)<o&&Math.abs(l+d+v-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var g=(l+1)/2,y=(d+1)/2,b=(v+1)/2,x=(u+h)/4,w=(c+p)/4,_=(f+m)/4;return g>y&&g>b?g<a?(n=0,r=.707106781,i=.707106781):(r=x/(n=Math.sqrt(g)),i=w/n):y>b?y<a?(n=.707106781,r=0,i=.707106781):(n=x/(r=Math.sqrt(y)),i=_/r):b<a?(n=.707106781,r=.707106781,i=0):(n=w/(i=Math.sqrt(b)),r=_/i),this.set(n,r,i,t),this}var E=Math.sqrt((m-f)*(m-f)+(c-p)*(c-p)+(h-u)*(h-u));return Math.abs(E)<.001&&(E=1),this.x=(m-f)/E,this.y=(c-p)/E,this.z=(h-u)/E,this.w=Math.acos((l+d+v-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:Symbol.iterator,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:return e.next=8,this.w;case 8:case"end":return e.stop()}}),e,this)}))}]),t}(),Vs=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};mr(this,t),(e=or(this,t)).isRenderTarget=!0,e.width=n,e.height=r,e.depth=1,e.scissor=new Gs(0,0,n,r),e.scissorTest=!1,e.viewport=new Gs(0,0,n,r);var a={width:n,height:r,depth:1};return void 0!==i.encoding&&(ks("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===oo?fo:ho),i=ar({generateMipmaps:!1,internalFormat:null,minFilter:Fi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),e.texture=new js(a,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),e.texture.isRenderTargetTexture=!0,e.texture.flipY=!1,e.texture.generateMipmaps=i.generateMipmaps,e.texture.internalFormat=i.internalFormat,e.depthBuffer=i.depthBuffer,e.stencilBuffer=i.stencilBuffer,e.depthTexture=i.depthTexture,e.samples=i.samples,e}return cr(t,e),gr(t,[{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;var t=ar({},e.texture.image);return this.texture.source=new zs(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),t}(as),Ws=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return mr(this,t),(e=or(this,t,[n,r,i])).isWebGLRenderTarget=!0,e}return cr(t,e),gr(t)}(Vs),qs=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return mr(this,t),(e=or(this,t,[null])).isDataArrayTexture=!0,e.image={data:n,width:r,height:i,depth:a},e.magFilter=Di,e.minFilter=Di,e.wrapR=Ii,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return cr(t,e),gr(t)}(js),Xs=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return mr(this,t),(e=or(this,t,[n,r,a])).isWebGLArrayRenderTarget=!0,e.depth=i,e.texture=new qs(null,n,r,i),e.texture.isRenderTargetTexture=!0,e}return cr(t,e),gr(t)}(Ws),Ys=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return mr(this,t),(e=or(this,t,[null])).isData3DTexture=!0,e.image={data:n,width:r,height:i,depth:a},e.magFilter=Di,e.minFilter=Di,e.wrapR=Ii,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return cr(t,e),gr(t)}(js),Ks=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return mr(this,t),(e=or(this,t,[n,r,a])).isWebGL3DRenderTarget=!0,e.depth=i,e.texture=new Ys(null,n,r,i),e.texture.isRenderTargetTexture=!0,e}return cr(t,e),gr(t)}(Ws),Js=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};mr(this,t),(e=or(this,t,[n,r,a])).isWebGLMultipleRenderTargets=!0;var o=e.texture;e.texture=[];for(var s=0;s<i;s++)e.texture[s]=o.clone(),e.texture[s].isRenderTargetTexture=!0;return e}return cr(t,e),gr(t,[{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(var r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"copy",value:function(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(var t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}]),t}(Ws),Zs=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;mr(this,t),this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}return gr(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(r/2),c=o(i/2),h=s(n/2),d=s(r/2),f=s(i/2);switch(a){case"XYZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"YXZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"ZXY":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"ZYX":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"YZX":this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f;break;case"XZY":this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],u=t[6],c=t[10],h=n+o+c;if(h>0){var d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(u-s)*d,this._y=(i-l)*d,this._z=(a-r)*d}else if(n>o&&n>c){var f=2*Math.sqrt(1+n-o-c);this._w=(u-s)/f,this._x=.25*f,this._y=(r+a)/f,this._z=(i+l)/f}else if(o>c){var p=2*Math.sqrt(1+o-n-c);this._w=(i-l)/p,this._x=(r+a)/p,this._y=.25*p,this._z=(s+u)/p}else{var m=2*Math.sqrt(1+c-n-o);this._w=(a-r)/m,this._x=(i+l)/m,this._y=(s+u)/m,this._z=.25*m}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(hs(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e){return this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+a*o+r*l-i*s,this._y=r*u+a*s+i*o-n*l,this._z=i*u+a*l+n*s-r*o,this._w=a*u-n*o-r*s-i*l,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*n+t*this._x,this._y=l*r+t*this._y,this._z=l*i+t*this._z,this.normalize(),this}var u=Math.sqrt(s),c=Math.atan2(u,o),h=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=i*h+this._z*d,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){return this.copy(e).slerp(t,n)}},{key:"random",value:function(){var e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._w;case 8:case"end":return e.stop()}}),e,this)}))}],[{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[a+0],d=i[a+1],f=i[a+2],p=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=l,e[t+2]=u,void(e[t+3]=c);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(c!==p||s!==h||l!==d||u!==f){var m=1-o,v=s*h+l*d+u*f+c*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,v*g);m=Math.sin(m*x)/b,o=Math.sin(o*x)/b}var w=o*g;if(s=s*m+h*w,l=l*m+d*w,u=u*m+f*w,c=c*m+p*w,m===1-o){var _=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=_,l*=_,u*=_,c*=_}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],l=n[r+2],u=n[r+3],c=i[a],h=i[a+1],d=i[a+2],f=i[a+3];return e[t]=o*f+u*c+s*d-l*h,e[t+1]=s*f+u*h+l*c-o*d,e[t+2]=l*f+u*d+o*h-s*c,e[t+3]=u*f-o*c-s*h-l*d,e}}]),t}(),Qs=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;mr(this,t),t.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}return gr(t,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return this.applyQuaternion(el.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(el.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=2*(a*r-o*n),u=2*(o*t-i*r),c=2*(i*n-a*t);return this.x=t+s*l+a*c-o*u,this.y=n+s*u+o*l-i*c,this.z=r+s*c+i*u-a*l,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e){return this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return $s.copy(this).projectOnVector(e),this.sub($s)}},{key:"reflect",value:function(e){return this.sub($s.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(hs(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"setFromEuler",value:function(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}},{key:"setFromColor",value:function(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-Math.pow(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}},{key:Symbol.iterator,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(),$s=new Qs,el=new Zs,tl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs(-1/0,-1/0,-1/0);mr(this,e),this.isBox3=!0,this.min=t,this.max=n}return gr(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t+=3)this.expandByPoint(rl.fromArray(e,t));return this}},{key:"setFromBufferAttribute",value:function(e){this.makeEmpty();for(var t=0,n=e.count;t<n;t++)this.expandByPoint(rl.fromBufferAttribute(e,t));return this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=rl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);var n=e.geometry;if(void 0!==n){var r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(var i=0,a=r.count;i<a;i++)!0===e.isMesh?e.getVertexPosition(i,rl):rl.fromBufferAttribute(r,i),rl.applyMatrix4(e.matrixWorld),this.expandByPoint(rl);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),il.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),il.copy(n.boundingBox)),il.applyMatrix4(e.matrixWorld),this.union(il)}for(var o=e.children,s=0,l=o.length;s<l;s++)this.expandByObject(o[s],t);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,rl),rl.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(hl),dl.subVectors(this.max,hl),al.subVectors(e.a,hl),ol.subVectors(e.b,hl),sl.subVectors(e.c,hl),ll.subVectors(ol,al),ul.subVectors(sl,ol),cl.subVectors(al,sl);var t=[0,-ll.z,ll.y,0,-ul.z,ul.y,0,-cl.z,cl.y,ll.z,0,-ll.x,ul.z,0,-ul.x,cl.z,0,-cl.x,-ll.y,ll.x,0,-ul.y,ul.x,0,-cl.y,cl.x,0];return!!ml(t,al,ol,sl,dl)&&!!ml(t=[1,0,0,0,1,0,0,0,1],al,ol,sl,dl)&&(fl.crossVectors(ll,ul),ml(t=[fl.x,fl.y,fl.z],al,ol,sl,dl))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return this.clampPoint(e,rl).distanceTo(e)}},{key:"getBoundingSphere",value:function(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(rl).length()),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(nl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),nl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),nl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),nl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),nl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),nl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),nl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),nl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(nl)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),nl=[new Qs,new Qs,new Qs,new Qs,new Qs,new Qs,new Qs,new Qs],rl=new Qs,il=new tl,al=new Qs,ol=new Qs,sl=new Qs,ll=new Qs,ul=new Qs,cl=new Qs,hl=new Qs,dl=new Qs,fl=new Qs,pl=new Qs;function ml(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){pl.fromArray(e,a);var s=i.x*Math.abs(pl.x)+i.y*Math.abs(pl.y)+i.z*Math.abs(pl.z),l=t.dot(pl),u=n.dot(pl),c=r.dot(pl);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}var vl=new tl,gl=new Qs,yl=new Qs,bl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;mr(this,e),this.isSphere=!0,this.center=t,this.radius=n}return gr(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):vl.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;gl.subVectors(e,this.center);var t=gl.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(gl,r/n),this.radius+=r}return this}},{key:"union",value:function(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(yl.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(gl.copy(e.center).add(yl)),this.expandByPoint(gl.copy(e.center).sub(yl))),this)}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),xl=new Qs,wl=new Qs,_l=new Qs,El=new Qs,Tl=new Qs,Sl=new Qs,Ml=new Qs,Al=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs(0,0,-1);mr(this,e),this.origin=t,this.direction=n}return gr(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,xl)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=xl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(xl.copy(this.origin).addScaledVector(this.direction,t),xl.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){wl.copy(e).add(t).multiplyScalar(.5),_l.copy(t).sub(e).normalize(),El.copy(this.origin).sub(wl);var i,a,o,s,l=.5*e.distanceTo(t),u=-this.direction.dot(_l),c=El.dot(this.direction),h=-El.dot(_l),d=El.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(a=u*c-h,s=l*f,(i=u*h-c)>=0)if(a>=-s)if(a<=s){var p=1/f;o=(i*=p)*(i+u*(a*=p)+2*c)+a*(u*i+a+2*h)+d}else a=l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a=-l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a<=-s?o=-(i=Math.max(0,-(-u*l+c)))*i+(a=i>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d:a<=s?(i=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):o=-(i=Math.max(0,-(u*l+c)))*i+(a=i>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d;else a=u>0?-l:l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,i),r&&r.copy(wl).addScaledVector(_l,a),o}},{key:"intersectSphere",value:function(e,t){xl.subVectors(e.center,this.origin);var n=xl.dot(this.direction),r=xl.dot(xl)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,xl)}},{key:"intersectTriangle",value:function(e,t,n,r,i){Tl.subVectors(t,e),Sl.subVectors(n,e),Ml.crossVectors(Tl,Sl);var a,o=this.direction.dot(Ml);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}El.subVectors(this.origin,e);var s=a*this.direction.dot(Sl.crossVectors(El,Sl));if(s<0)return null;var l=a*this.direction.dot(Tl.cross(El));if(l<0)return null;if(s+l>o)return null;var u=-a*El.dot(Ml);return u<0?null:this.at(u/o,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),kl=function(){function e(t,n,r,i,a,o,s,l,u,c,h,d,f,p,m,v){mr(this,e),e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,n,r,i,a,o,s,l,u,c,h,d,f,p,m,v)}return gr(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l,u,c,h,d,f,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/Pl.setFromMatrixColumn(e,0).length(),i=1/Pl.setFromMatrixColumn(e,1).length(),a=1/Pl.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=a*u,d=a*c,f=o*u,p=o*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=d+f*l,t[5]=h-p*l,t[9]=-o*s,t[2]=p-h*l,t[6]=f+d*l,t[10]=a*s}else if("YXZ"===e.order){var m=s*u,v=s*c,g=l*u,y=l*c;t[0]=m+y*o,t[4]=g*o-v,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-o,t[2]=v*o-g,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){var b=s*u,x=s*c,w=l*u,_=l*c;t[0]=b-_*o,t[4]=-a*c,t[8]=w+x*o,t[1]=x+w*o,t[5]=a*u,t[9]=_-b*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var E=a*u,T=a*c,S=o*u,M=o*c;t[0]=s*u,t[4]=S*l-T,t[8]=E*l+M,t[1]=s*c,t[5]=M*l+E,t[9]=T*l-S,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var A=a*s,k=a*l,P=o*s,R=o*l;t[0]=s*u,t[4]=R-A*c,t[8]=P*c+k,t[1]=c,t[5]=a*u,t[9]=-o*u,t[2]=-l*u,t[6]=k*c+P,t[10]=A-R*c}else if("XZY"===e.order){var C=a*s,L=a*l,I=o*s,O=o*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=C*c+O,t[5]=a*u,t[9]=L*c-I,t[2]=I*c-L,t[6]=o*u,t[10]=O*c+C}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(Cl,e,Ll)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return Dl.subVectors(e,t),0===Dl.lengthSq()&&(Dl.z=1),Dl.normalize(),Il.crossVectors(n,Dl),0===Il.lengthSq()&&(1===Math.abs(n.z)?Dl.x+=1e-4:Dl.z+=1e-4,Dl.normalize(),Il.crossVectors(n,Dl)),Il.normalize(),Ol.crossVectors(Dl,Il),r[0]=Il.x,r[4]=Ol.x,r[8]=Dl.x,r[1]=Il.y,r[5]=Ol.y,r[9]=Dl.y,r[2]=Il.z,r[6]=Ol.z,r[10]=Dl.z,this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],v=n[14],g=n[3],y=n[7],b=n[11],x=n[15],w=r[0],_=r[4],E=r[8],T=r[12],S=r[1],M=r[5],A=r[9],k=r[13],P=r[2],R=r[6],C=r[10],L=r[14],I=r[3],O=r[7],D=r[11],N=r[15];return i[0]=a*w+o*S+s*P+l*I,i[4]=a*_+o*M+s*R+l*O,i[8]=a*E+o*A+s*C+l*D,i[12]=a*T+o*k+s*L+l*N,i[1]=u*w+c*S+h*P+d*I,i[5]=u*_+c*M+h*R+d*O,i[9]=u*E+c*A+h*C+d*D,i[13]=u*T+c*k+h*L+d*N,i[2]=f*w+p*S+m*P+v*I,i[6]=f*_+p*M+m*R+v*O,i[10]=f*E+p*A+m*C+v*D,i[14]=f*T+p*k+m*L+v*N,i[3]=g*w+y*S+b*P+x*I,i[7]=g*_+y*M+b*R+x*O,i[11]=g*E+y*A+b*C+x*D,i[15]=g*T+y*k+b*L+x*N,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+i*s*c-r*l*c-i*o*h+n*l*h+r*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+i*a*h-r*a*d+r*l*u-i*s*u)+e[11]*(+t*l*c-t*o*d-i*a*c+n*a*d+i*o*u-n*l*u)+e[15]*(-r*o*u-t*s*c+t*o*h+r*a*c-n*a*h+n*s*u)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],v=e[15],g=c*m*l-p*h*l+p*s*d-o*m*d-c*s*v+o*h*v,y=f*h*l-u*m*l-f*s*d+a*m*d+u*s*v-a*h*v,b=u*p*l-f*c*l+f*o*d-a*p*d-u*o*v+a*c*v,x=f*c*s-u*p*s-f*o*h+a*p*h+u*o*m-a*c*m,w=t*g+n*y+r*b+i*x;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var _=1/w;return e[0]=g*_,e[1]=(p*h*i-c*m*i-p*r*d+n*m*d+c*r*v-n*h*v)*_,e[2]=(o*m*i-p*s*i+p*r*l-n*m*l-o*r*v+n*s*v)*_,e[3]=(c*s*i-o*h*i-c*r*l+n*h*l+o*r*d-n*s*d)*_,e[4]=y*_,e[5]=(u*m*i-f*h*i+f*r*d-t*m*d-u*r*v+t*h*v)*_,e[6]=(f*s*i-a*m*i-f*r*l+t*m*l+a*r*v-t*s*v)*_,e[7]=(a*h*i-u*s*i+u*r*l-t*h*l-a*r*d+t*s*d)*_,e[8]=b*_,e[9]=(f*c*i-u*p*i-f*n*d+t*p*d+u*n*v-t*c*v)*_,e[10]=(a*p*i-f*o*i+f*n*l-t*p*l-a*n*v+t*o*v)*_,e[11]=(u*o*i-a*c*i-u*n*l+t*c*l+a*n*d-t*o*d)*_,e[12]=x*_,e[13]=(u*p*r-f*c*r+f*n*h-t*p*h-u*n*m+t*c*m)*_,e[14]=(f*o*r-a*p*r-f*n*s+t*p*s+a*n*m-t*o*m)*_,e[15]=(a*c*r-u*o*r+u*n*s-t*c*s-a*n*h+t*o*h)*_,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,l=i*a,u=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,u*o+n,u*s-r*a,0,l*s-r*o,u*s+r*a,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,u=a+a,c=o+o,h=i*l,d=i*u,f=i*c,p=a*u,m=a*c,v=o*c,g=s*l,y=s*u,b=s*c,x=n.x,w=n.y,_=n.z;return r[0]=(1-(p+v))*x,r[1]=(d+b)*x,r[2]=(f-y)*x,r[3]=0,r[4]=(d-b)*w,r[5]=(1-(h+v))*w,r[6]=(m+g)*w,r[7]=0,r[8]=(f+y)*_,r[9]=(m-g)*_,r[10]=(1-(h+p))*_,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=Pl.set(r[0],r[1],r[2]).length(),a=Pl.set(r[4],r[5],r[6]).length(),o=Pl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Rl.copy(this);var s=1/i,l=1/a,u=1/o;return Rl.elements[0]*=s,Rl.elements[1]*=s,Rl.elements[2]*=s,Rl.elements[4]*=l,Rl.elements[5]*=l,Rl.elements[6]*=l,Rl.elements[8]*=u,Rl.elements[9]*=u,Rl.elements[10]*=u,t.setFromRotationMatrix(Rl),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a){var o,s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:rs,u=this.elements,c=2*i/(t-e),h=2*i/(n-r),d=(t+e)/(t-e),f=(n+r)/(n-r);if(l===rs)o=-(a+i)/(a-i),s=-2*a*i/(a-i);else{if(l!==is)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);o=-a/(a-i),s=-a*i/(a-i)}return u[0]=c,u[4]=0,u[8]=d,u[12]=0,u[1]=0,u[5]=h,u[9]=f,u[13]=0,u[2]=0,u[6]=0,u[10]=o,u[14]=s,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a){var o,s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:rs,u=this.elements,c=1/(t-e),h=1/(n-r),d=1/(a-i),f=(t+e)*c,p=(n+r)*h;if(l===rs)o=(a+i)*d,s=-2*d;else{if(l!==is)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);o=i*d,s=-1*d}return u[0]=2*c,u[4]=0,u[8]=0,u[12]=-f,u[1]=0,u[5]=2*h,u[9]=0,u[13]=-p,u[2]=0,u[6]=0,u[10]=s,u[14]=-o,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}(),Pl=new Qs,Rl=new kl,Cl=new Qs(0,0,0),Ll=new Qs(1,1,1),Il=new Qs,Ol=new Qs,Dl=new Qs,Nl=new kl,Bl=new Zs,Ul=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.DEFAULT_ORDER;mr(this,t),this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}return gr(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],l=r[5],u=r[9],c=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(hs(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-hs(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(hs(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-hs(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(hs(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-hs(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return Nl.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Nl,t,n)}},{key:"setFromVector3",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return Bl.setFromEuler(this),this.setFromQuaternion(Bl,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._order;case 8:case"end":return e.stop()}}),e,this)}))}]),t}();Ul.DEFAULT_ORDER="XYZ";var zl=function(){function e(){mr(this,e),this.mask=1}return gr(e,[{key:"set",value:function(e){this.mask=(1<<e|0)>>>0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!=(this.mask&e.mask)}},{key:"isEnabled",value:function(e){return 0!=(this.mask&(1<<e|0))}}]),e}(),Fl=0,Hl=new Qs,jl=new Zs,Gl=new kl,Vl=new Qs,Wl=new Qs,ql=new Qs,Xl=new Zs,Yl=new Qs(1,0,0),Kl=new Qs(0,1,0),Jl=new Qs(0,0,1),Zl={type:"added"},Ql={type:"removed"},$l=function(e){function t(){var e;mr(this,t),(e=or(this,t)).isObject3D=!0,Object.defineProperty(ur(e),"id",{value:Fl++}),e.uuid=cs(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=t.DEFAULT_UP.clone();var n=new Qs,r=new Ul,i=new Zs,a=new Qs(1,1,1);return r._onChange((function(){i.setFromEuler(r,!1)})),i._onChange((function(){r.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(ur(e),{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new kl},normalMatrix:{value:new xs}}),e.matrix=new kl,e.matrixWorld=new kl,e.matrixAutoUpdate=t.DEFAULT_MATRIX_AUTO_UPDATE,e.matrixWorldAutoUpdate=t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,e.matrixWorldNeedsUpdate=!1,e.layers=new zl,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return cr(t,e),gr(t,[{key:"onBeforeShadow",value:function(){}},{key:"onAfterShadow",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return jl.setFromAxisAngle(e,t),this.quaternion.multiply(jl),this}},{key:"rotateOnWorldAxis",value:function(e,t){return jl.setFromAxisAngle(e,t),this.quaternion.premultiply(jl),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(Yl,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(Kl,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(Jl,e)}},{key:"translateOnAxis",value:function(e,t){return Hl.copy(e).applyQuaternion(this.quaternion),this.position.add(Hl.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(Yl,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(Kl,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(Jl,e)}},{key:"localToWorld",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Gl.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?Vl.copy(e):Vl.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),Wl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gl.lookAt(Wl,Vl,this.up):Gl.lookAt(Vl,Wl,this.up),this.quaternion.setFromRotationMatrix(Gl),r&&(Gl.extractRotation(r.matrixWorld),jl.setFromRotationMatrix(Gl),this.quaternion.premultiply(jl.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Zl)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Ql)),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){return this.remove.apply(this,nr(this.children))}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),Gl.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Gl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Gl),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getObjectsByProperty",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wl,e,ql),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wl,Xl,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++){var i=t[n];!0!==i.matrixWorldAutoUpdate&&!0!==e||i.updateMatrixWorld(e)}}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++){var o=r[i];!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!1,!0)}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map((function(e){return{boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];i(e.shapes,u)}else i(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],h=0,d=this.material.length;h<d;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var f=0;f<this.children.length;f++)r.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var m=this.animations[p];r.animations.push(i(e.animations,m))}}if(t){var v=T(e.geometries),g=T(e.materials),y=T(e.textures),b=T(e.images),x=T(e.shapes),w=T(e.skeletons),_=T(e.animations),E=T(e.nodes);v.length>0&&(n.geometries=v),g.length>0&&(n.materials=g),y.length>0&&(n.textures=y),b.length>0&&(n.images=b),x.length>0&&(n.shapes=x),w.length>0&&(n.skeletons=w),_.length>0&&(n.animations=_),E.length>0&&(n.nodes=E)}return n.object=r,n;function T(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),t}(as);$l.DEFAULT_UP=new Qs(0,1,0),$l.DEFAULT_MATRIX_AUTO_UPDATE=!0,$l.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var eu=new Qs,tu=new Qs,nu=new Qs,ru=new Qs,iu=new Qs,au=new Qs,ou=new Qs,su=new Qs,lu=new Qs,uu=new Qs,cu=!1,hu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Qs;mr(this,e),this.a=t,this.b=n,this.c=r}return gr(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"setFromAttributeAndIndices",value:function(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return eu.subVectors(this.c,this.b),tu.subVectors(this.a,this.b),.5*eu.cross(tu).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,a){return!1===cu&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),cu=!0),e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}},{key:"getInterpolation",value:function(t,n,r,i,a){return e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,i=this.a,a=this.b,o=this.c;iu.subVectors(a,i),au.subVectors(o,i),su.subVectors(e,i);var s=iu.dot(su),l=au.dot(su);if(s<=0&&l<=0)return t.copy(i);lu.subVectors(e,a);var u=iu.dot(lu),c=au.dot(lu);if(u>=0&&c<=u)return t.copy(a);var h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector(iu,n);uu.subVectors(e,o);var d=iu.dot(uu),f=au.dot(uu);if(f>=0&&d<=f)return t.copy(o);var p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return r=l/(l-f),t.copy(i).addScaledVector(au,r);var m=u*f-d*c;if(m<=0&&c-u>=0&&d-f>=0)return ou.subVectors(o,a),r=(c-u)/(c-u+(d-f)),t.copy(a).addScaledVector(ou,r);var v=1/(m+p+h);return n=p*v,r=h*v,t.copy(i).addScaledVector(iu,n).addScaledVector(au,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),eu.subVectors(e,t),r.cross(eu);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){eu.subVectors(r,t),tu.subVectors(n,t),nu.subVectors(e,t);var a=eu.dot(eu),o=eu.dot(tu),s=eu.dot(nu),l=tu.dot(tu),u=tu.dot(nu),c=a*l-o*o;if(0===c)return i.set(0,0,0),null;var h=1/c,d=(l*s-o*u)*h,f=(a*u-o*s)*h;return i.set(1-d-f,f,d)}},{key:"containsPoint",value:function(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,ru)&&ru.x>=0&&ru.y>=0&&ru.x+ru.y<=1}},{key:"getUV",value:function(e,t,n,r,i,a,o,s){return!1===cu&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),cu=!0),this.getInterpolation(e,t,n,r,i,a,o,s)}},{key:"getInterpolation",value:function(e,t,n,r,i,a,o,s){return null===this.getBarycoord(e,t,n,r,ru)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,ru.x),s.addScaledVector(a,ru.y),s.addScaledVector(o,ru.z),s)}},{key:"isFrontFacing",value:function(e,t,n,r){return eu.subVectors(n,t),tu.subVectors(e,t),eu.cross(tu).dot(r)<0}}]),e}(),du={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fu={h:0,s:0,l:0},pu={h:0,s:0,l:0};function mu(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}var vu=function(e){function t(e,n,r){return mr(this,t),this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}return gr(t,[{key:"set",value:function(e,t,n){if(void 0===t&&void 0===n){var r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,n);return this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fo;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Os.toWorkingColorSpace(this,t),this}},{key:"setRGB",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Os.workingColorSpace;return this.r=e,this.g=t,this.b=n,Os.toWorkingColorSpace(this,r),this}},{key:"setHSL",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Os.workingColorSpace;if(e=ds(e,1),t=hs(t,0,1),n=hs(n,0,1),0===t)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=mu(a,i,e+1/3),this.g=mu(a,i,e),this.b=mu(a,i,e-1/3)}return Os.toWorkingColorSpace(this,r),this}},{key:"setStyle",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fo;function r(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){var i,a=t[1],o=t[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){var s=t[1],l=s.length;if(3===l)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(6===l)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}},{key:"setColorName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fo,n=du[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copySRGBToLinear",value:function(e){return this.r=Ds(e.r),this.g=Ds(e.g),this.b=Ds(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=Ns(e.r),this.g=Ns(e.g),this.b=Ns(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fo;return Os.fromWorkingColorSpace(gu.copy(this),e),65536*Math.round(hs(255*gu.r,0,255))+256*Math.round(hs(255*gu.g,0,255))+Math.round(hs(255*gu.b,0,255))}},{key:"getHexString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fo;return("000000"+this.getHex(e).toString(16)).slice(-6)}},{key:"getHSL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Os.workingColorSpace;Os.fromWorkingColorSpace(gu.copy(this),t);var n,r,i=gu.r,a=gu.g,o=gu.b,s=Math.max(i,a,o),l=Math.min(i,a,o),u=(l+s)/2;if(l===s)n=0,r=0;else{var c=s-l;switch(r=u<=.5?c/(s+l):c/(2-s-l),s){case i:n=(a-o)/c+(a<o?6:0);break;case a:n=(o-i)/c+2;break;case o:n=(i-a)/c+4}n/=6}return e.h=n,e.s=r,e.l=u,e}},{key:"getRGB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Os.workingColorSpace;return Os.fromWorkingColorSpace(gu.copy(this),t),e.r=gu.r,e.g=gu.g,e.b=gu.b,e}},{key:"getStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fo;Os.fromWorkingColorSpace(gu.copy(this),e);var t=gu.r,n=gu.g,r=gu.b;return e!==fo?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(fu),this.setHSL(fu.h+e,fu.s+t,fu.l+n)}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(fu),e.getHSL(pu);var n=fs(fu.h,pu.h,t),r=fs(fu.s,pu.s,t),i=fs(fu.l,pu.l,t);return this.setHSL(n,r,i),this}},{key:"setFromVector3",value:function(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}},{key:"applyMatrix3",value:function(e){var t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:Symbol.iterator,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.r;case 2:return e.next=4,this.g;case 4:return e.next=6,this.b;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(),gu=new vu;vu.NAMES=du;var yu=0,bu=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isMaterial=!0,Object.defineProperty(ur(e),"id",{value:yu++}),e.uuid=cs(),e.name="",e.type="Material",e.blending=Dr,e.side=Rr,e.vertexColors=!1,e.opacity=1,e.transparent=!1,e.alphaHash=!1,e.blendSrc=Kr,e.blendDst=Jr,e.blendEquation=Fr,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.blendColor=new vu(0,0,0),e.blendAlpha=0,e.depthFunc=ui,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=No,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=_o,e.stencilZFail=_o,e.stencilZPass=_o,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.forceSinglePass=!1,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e._alphaTest=0,e}return cr(t,e),gr(t,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}},{key:"onBuild",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}else console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."))}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Dr&&(n.blending=this.blending),this.side!==Rr&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==Kr&&(n.blendSrc=this.blendSrc),this.blendDst!==Jr&&(n.blendDst=this.blendDst),this.blendEquation!==Fr&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==ui&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==No&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==_o&&(n.stencilFail=this.stencilFail),this.stencilZFail!==_o&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==_o&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),t}(as),xu=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshBasicMaterial=!0,n.type="MeshBasicMaterial",n.color=new vu(16777215),n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=pi,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}]),t}(bu),wu=_u();function _u(){for(var e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512),a=0;a<256;++a){var o=a-127;o<-27?(r[a]=0,r[256|a]=32768,i[a]=24,i[256|a]=24):o<-14?(r[a]=1024>>-o-14,r[256|a]=1024>>-o-14|32768,i[a]=-o-1,i[256|a]=-o-1):o<=15?(r[a]=o+15<<10,r[256|a]=o+15<<10|32768,i[a]=13,i[256|a]=13):o<128?(r[a]=31744,r[256|a]=64512,i[a]=24,i[256|a]=24):(r[a]=31744,r[256|a]=64512,i[a]=13,i[256|a]=13)}for(var s=new Uint32Array(2048),l=new Uint32Array(64),u=new Uint32Array(64),c=1;c<1024;++c){for(var h=c<<13,d=0;0==(8388608&h);)h<<=1,d-=8388608;h&=-8388609,d+=947912704,s[c]=h|d}for(var f=1024;f<2048;++f)s[f]=939524096+(f-1024<<13);for(var p=1;p<31;++p)l[p]=p<<23;l[31]=1199570944,l[32]=2147483648;for(var m=33;m<63;++m)l[m]=2147483648+(m-32<<23);l[63]=3347054592;for(var v=1;v<64;++v)32!==v&&(u[v]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:l,offsetTable:u}}function Eu(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=hs(e,-65504,65504),wu.floatView[0]=e;var t=wu.uint32View[0],n=t>>23&511;return wu.baseTable[n]+((8388607&t)>>wu.shiftTable[n])}function Tu(e){var t=e>>10;return wu.uint32View[0]=wu.mantissaTable[wu.offsetTable[t]+(1023&e)]+wu.exponentTable[t],wu.floatView[0]}var Su={toHalfFloat:Eu,fromHalfFloat:Tu},Mu=new Qs,Au=new bs,ku=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(mr(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=r,this.usage=Wo,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Zi,this.version=0}return gr(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"updateRange",get:function(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"addUpdateRange",value:function(e,t){this.updateRanges.push({start:e,count:t})}},{key:"clearUpdateRanges",value:function(){this.updateRanges.length=0}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)Au.fromBufferAttribute(this,t),Au.applyMatrix3(e),this.setXY(t,Au.x,Au.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)Mu.fromBufferAttribute(this,r),Mu.applyMatrix3(e),this.setXYZ(r,Mu.x,Mu.y,Mu.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)Mu.fromBufferAttribute(this,t),Mu.applyMatrix4(e),this.setXYZ(t,Mu.x,Mu.y,Mu.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)Mu.fromBufferAttribute(this,t),Mu.applyNormalMatrix(e),this.setXYZ(t,Mu.x,Mu.y,Mu.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)Mu.fromBufferAttribute(this,t),Mu.transformDirection(e),this.setXYZ(t,Mu.x,Mu.y,Mu.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getComponent",value:function(e,t){var n=this.array[e*this.itemSize+t];return this.normalized&&(n=vs(n,this.array)),n}},{key:"setComponent",value:function(e,t,n){return this.normalized&&(n=gs(n,this.array)),this.array[e*this.itemSize+t]=n,this}},{key:"getX",value:function(e){var t=this.array[e*this.itemSize];return this.normalized&&(t=vs(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){var t=this.array[e*this.itemSize+1];return this.normalized&&(t=vs(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){var t=this.array[e*this.itemSize+2];return this.normalized&&(t=vs(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){var t=this.array[e*this.itemSize+3];return this.normalized&&(t=vs(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array),r=gs(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array),r=gs(r,this.array),i=gs(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Wo&&(e.usage=this.usage),e}}]),e}(),Pu=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Int8Array(e),n,r])}return cr(t,e),gr(t)}(ku),Ru=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Uint8Array(e),n,r])}return cr(t,e),gr(t)}(ku),Cu=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Uint8ClampedArray(e),n,r])}return cr(t,e),gr(t)}(ku),Lu=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Int16Array(e),n,r])}return cr(t,e),gr(t)}(ku),Iu=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Uint16Array(e),n,r])}return cr(t,e),gr(t)}(ku),Ou=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Int32Array(e),n,r])}return cr(t,e),gr(t)}(ku),Du=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Uint32Array(e),n,r])}return cr(t,e),gr(t)}(ku),Nu=function(e){function t(e,n,r){var i;return mr(this,t),(i=or(this,t,[new Uint16Array(e),n,r])).isFloat16BufferAttribute=!0,i}return cr(t,e),gr(t,[{key:"getX",value:function(e){var t=Tu(this.array[e*this.itemSize]);return this.normalized&&(t=vs(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize]=Eu(t),this}},{key:"getY",value:function(e){var t=Tu(this.array[e*this.itemSize+1]);return this.normalized&&(t=vs(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize+1]=Eu(t),this}},{key:"getZ",value:function(e){var t=Tu(this.array[e*this.itemSize+2]);return this.normalized&&(t=vs(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize+2]=Eu(t),this}},{key:"getW",value:function(e){var t=Tu(this.array[e*this.itemSize+3]);return this.normalized&&(t=vs(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.array[e*this.itemSize+3]=Eu(t),this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array)),this.array[e+0]=Eu(t),this.array[e+1]=Eu(n),this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array),r=gs(r,this.array)),this.array[e+0]=Eu(t),this.array[e+1]=Eu(n),this.array[e+2]=Eu(r),this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array),r=gs(r,this.array),i=gs(i,this.array)),this.array[e+0]=Eu(t),this.array[e+1]=Eu(n),this.array[e+2]=Eu(r),this.array[e+3]=Eu(i),this}}]),t}(ku),Bu=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Float32Array(e),n,r])}return cr(t,e),gr(t)}(ku),Uu=function(e){function t(e,n,r){return mr(this,t),or(this,t,[new Float64Array(e),n,r])}return cr(t,e),gr(t)}(ku),zu=0,Fu=new kl,Hu=new $l,ju=new Qs,Gu=new tl,Vu=new tl,Wu=new Qs,qu=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isBufferGeometry=!0,Object.defineProperty(ur(e),"id",{value:zu++}),e.uuid=cs(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return cr(t,e),gr(t,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(_s(e)?Du:Iu)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new xs).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return Fu.makeRotationFromQuaternion(e),this.applyMatrix4(Fu),this}},{key:"rotateX",value:function(e){return Fu.makeRotationX(e),this.applyMatrix4(Fu),this}},{key:"rotateY",value:function(e){return Fu.makeRotationY(e),this.applyMatrix4(Fu),this}},{key:"rotateZ",value:function(e){return Fu.makeRotationZ(e),this.applyMatrix4(Fu),this}},{key:"translate",value:function(e,t,n){return Fu.makeTranslation(e,t,n),this.applyMatrix4(Fu),this}},{key:"scale",value:function(e,t,n){return Fu.makeScale(e,t,n),this.applyMatrix4(Fu),this}},{key:"lookAt",value:function(e){return Hu.lookAt(e),Hu.updateMatrix(),this.applyMatrix4(Hu.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ju).negate(),this.translate(ju.x,ju.y,ju.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Bu(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new tl);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Qs(-1/0,-1/0,-1/0),new Qs(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];Gu.setFromBufferAttribute(i),this.morphTargetsRelative?(Wu.addVectors(this.boundingBox.min,Gu.min),this.boundingBox.expandByPoint(Wu),Wu.addVectors(this.boundingBox.max,Gu.max),this.boundingBox.expandByPoint(Wu)):(this.boundingBox.expandByPoint(Gu.min),this.boundingBox.expandByPoint(Gu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new bl);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Qs,1/0);if(e){var n=this.boundingSphere.center;if(Gu.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];Vu.setFromBufferAttribute(a),this.morphTargetsRelative?(Wu.addVectors(Gu.min,Vu.min),Gu.expandByPoint(Wu),Wu.addVectors(Gu.max,Vu.max),Gu.expandByPoint(Wu)):(Gu.expandByPoint(Vu.min),Gu.expandByPoint(Vu.max))}Gu.getCenter(n);for(var o=0,s=0,l=e.count;s<l;s++)Wu.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(Wu));if(t)for(var u=0,c=t.length;u<c;u++)for(var h=t[u],d=this.morphTargetsRelative,f=0,p=h.count;f<p;f++)Wu.fromBufferAttribute(h,f),d&&(ju.fromBufferAttribute(e,f),Wu.add(ju)),o=Math.max(o,n.distanceToSquared(Wu));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ku(new Float32Array(4*o),4));for(var s=this.getAttribute("tangent").array,l=[],u=[],c=0;c<o;c++)l[c]=new Qs,u[c]=new Qs;var h=new Qs,d=new Qs,f=new Qs,p=new bs,m=new bs,v=new bs,g=new Qs,y=new Qs,b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(var x=0,w=b.length;x<w;++x)for(var _=b[x],E=_.start,T=E,S=E+_.count;T<S;T+=3)N(n[T+0],n[T+1],n[T+2]);for(var M=new Qs,A=new Qs,k=new Qs,P=new Qs,R=0,C=b.length;R<C;++R)for(var L=b[R],I=L.start,O=I,D=I+L.count;O<D;O+=3)B(n[O+0]),B(n[O+1]),B(n[O+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function N(e,t,n){h.fromArray(r,3*e),d.fromArray(r,3*t),f.fromArray(r,3*n),p.fromArray(a,2*e),m.fromArray(a,2*t),v.fromArray(a,2*n),d.sub(h),f.sub(h),m.sub(p),v.sub(p);var i=1/(m.x*v.y-v.x*m.y);isFinite(i)&&(g.copy(d).multiplyScalar(v.y).addScaledVector(f,-m.y).multiplyScalar(i),y.copy(f).multiplyScalar(m.x).addScaledVector(d,-v.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[n].add(g),u[e].add(y),u[t].add(y),u[n].add(y))}function B(e){k.fromArray(i,3*e),P.copy(k);var t=l[e];M.copy(t),M.sub(k.multiplyScalar(k.dot(t))).normalize(),A.crossVectors(P,t);var n=A.dot(u[e])<0?-1:1;s[4*e]=M.x,s[4*e+1]=M.y,s[4*e+2]=M.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new ku(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new Qs,o=new Qs,s=new Qs,l=new Qs,u=new Qs,c=new Qs,h=new Qs,d=new Qs;if(e)for(var f=0,p=e.count;f<p;f+=3){var m=e.getX(f+0),v=e.getX(f+1),g=e.getX(f+2);a.fromBufferAttribute(t,m),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,g),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),l.fromBufferAttribute(n,m),u.fromBufferAttribute(n,v),c.fromBufferAttribute(n,g),l.add(h),u.add(h),c.add(h),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(g,c.x,c.y,c.z)}else for(var y=0,b=t.count;y<b;y+=3)a.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),n.setXYZ(y+0,h.x,h.y,h.z),n.setXYZ(y+1,h.x,h.y,h.z),n.setXYZ(y+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Wu.fromBufferAttribute(e,t),Wu.normalize(),e.setXYZ(t,Wu.x,Wu.y,Wu.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,l=0,u=t.length;l<u;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new ku(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var n=new t,r=this.index.array,i=this.attributes;for(var a in i){var o=e(i[a],r);n.setAttribute(a,o)}var s=this.morphAttributes;for(var l in s){for(var u=[],c=s[l],h=0,d=c.length;h<d;h++){var f=e(c[h],r);u.push(f)}n.morphAttributes[l]=u}n.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,m=0,v=p.length;m<v;m++){var g=p[m];n.addGroup(g.start,g.count,g.materialIndex)}return n}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a];e.data.attributes[a]=o.toJSON(e.data)}var s={},l=!1;for(var u in this.morphAttributes){for(var c=this.morphAttributes[u],h=[],d=0,f=c.length;d<f;d++){var p=c[d];h.push(p.toJSON(e.data))}h.length>0&&(s[u]=h,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var m=this.groups;m.length>0&&(e.data.groups=JSON.parse(JSON.stringify(m)));var v=this.boundingSphere;return null!==v&&(e.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var l=[],u=o[s],c=0,h=u.length;c<h;c++)l.push(u[c].clone(t));this.morphAttributes[s]=l}this.morphTargetsRelative=e.morphTargetsRelative;for(var d=e.groups,f=0,p=d.length;f<p;f++){var m=d[f];this.addGroup(m.start,m.count,m.materialIndex)}var v=e.boundingBox;null!==v&&(this.boundingBox=v.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),t}(as),Xu=new kl,Yu=new Al,Ku=new bl,Ju=new Qs,Zu=new Qs,Qu=new Qs,$u=new Qs,ec=new Qs,tc=new Qs,nc=new bs,rc=new bs,ic=new bs,ac=new Qs,oc=new Qs,sc=new Qs,lc=new Qs,uc=new Qs,cc=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qu,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xu;return mr(this,t),(e=or(this,t)).isMesh=!0,e.type="Mesh",e.geometry=n,e.material=r,e.updateMorphTargets(),e}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=ar({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}},{key:"getVertexPosition",value:function(e,t){var n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);var o=this.morphTargetInfluences;if(i&&o){tc.set(0,0,0);for(var s=0,l=i.length;s<l;s++){var u=o[s],c=i[s];0!==u&&(ec.fromBufferAttribute(c,e),a?tc.addScaledVector(ec,u):tc.addScaledVector(ec.sub(t),u))}t.add(tc)}return t}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Ku.copy(n.boundingSphere),Ku.applyMatrix4(i),Yu.copy(e.ray).recast(e.near),!1===Ku.containsPoint(Yu.origin)){if(null===Yu.intersectSphere(Ku,Ju))return;if(Yu.origin.distanceToSquared(Ju)>Math.pow(e.far-e.near,2))return}Xu.copy(i).invert(),Yu.copy(e.ray).applyMatrix4(Xu),null!==n.boundingBox&&!1===Yu.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,Yu)}}},{key:"_computeIntersections",value:function(e,t,n){var r,i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,l=i.attributes.uv,u=i.attributes.uv1,c=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==o)if(Array.isArray(a))for(var f=0,p=h.length;f<p;f++)for(var m=h[f],v=a[m.materialIndex],g=Math.max(m.start,d.start),y=Math.min(o.count,Math.min(m.start+m.count,d.start+d.count));g<y;g+=3)(r=hc(this,v,e,n,l,u,c,o.getX(g),o.getX(g+1),o.getX(g+2)))&&(r.faceIndex=Math.floor(g/3),r.face.materialIndex=m.materialIndex,t.push(r));else for(var b=Math.max(0,d.start),x=Math.min(o.count,d.start+d.count);b<x;b+=3)(r=hc(this,a,e,n,l,u,c,o.getX(b),o.getX(b+1),o.getX(b+2)))&&(r.faceIndex=Math.floor(b/3),t.push(r));else if(void 0!==s)if(Array.isArray(a))for(var w=0,_=h.length;w<_;w++)for(var E=h[w],T=a[E.materialIndex],S=Math.max(E.start,d.start),M=Math.min(s.count,Math.min(E.start+E.count,d.start+d.count));S<M;S+=3)(r=hc(this,T,e,n,l,u,c,S,S+1,S+2))&&(r.faceIndex=Math.floor(S/3),r.face.materialIndex=E.materialIndex,t.push(r));else for(var A=Math.max(0,d.start),k=Math.min(s.count,d.start+d.count);A<k;A+=3)(r=hc(this,a,e,n,l,u,c,A,A+1,A+2))&&(r.faceIndex=Math.floor(A/3),t.push(r))}}]),t}($l);function hc(e,t,n,r,i,a,o,s,l,u){e.getVertexPosition(s,Zu),e.getVertexPosition(l,Qu),e.getVertexPosition(u,$u);var c=function(e,t,n,r,i,a,o,s){if(null===(t.side===Cr?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side===Rr,s)))return null;uc.copy(s),uc.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(uc);return l<n.near||l>n.far?null:{distance:l,point:uc.clone(),object:e}}(e,t,n,r,Zu,Qu,$u,lc);if(c){i&&(nc.fromBufferAttribute(i,s),rc.fromBufferAttribute(i,l),ic.fromBufferAttribute(i,u),c.uv=hu.getInterpolation(lc,Zu,Qu,$u,nc,rc,ic,new bs)),a&&(nc.fromBufferAttribute(a,s),rc.fromBufferAttribute(a,l),ic.fromBufferAttribute(a,u),c.uv1=hu.getInterpolation(lc,Zu,Qu,$u,nc,rc,ic,new bs),c.uv2=c.uv1),o&&(ac.fromBufferAttribute(o,s),oc.fromBufferAttribute(o,l),sc.fromBufferAttribute(o,u),c.normal=hu.getInterpolation(lc,Zu,Qu,$u,ac,oc,sc,new Qs),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));var h={a:s,b:l,c:u,normal:new Qs,materialIndex:0};hu.getNormal(Zu,Qu,$u,h.normal),c.face=h}return c}var dc=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;mr(this,t),(e=or(this,t)).type="BoxGeometry",e.parameters={width:n,height:r,depth:i,widthSegments:a,heightSegments:o,depthSegments:s};var l=ur(e);a=Math.floor(a),o=Math.floor(o),s=Math.floor(s);var u=[],c=[],h=[],d=[],f=0,p=0;function m(e,t,n,r,i,a,o,s,m,v,g){for(var y=a/m,b=o/v,x=a/2,w=o/2,_=s/2,E=m+1,T=v+1,S=0,M=0,A=new Qs,k=0;k<T;k++)for(var P=k*b-w,R=0;R<E;R++){var C=R*y-x;A[e]=C*r,A[t]=P*i,A[n]=_,c.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=s>0?1:-1,h.push(A.x,A.y,A.z),d.push(R/m),d.push(1-k/v),S+=1}for(var L=0;L<v;L++)for(var I=0;I<m;I++){var O=f+I+E*L,D=f+I+E*(L+1),N=f+(I+1)+E*(L+1),B=f+(I+1)+E*L;u.push(O,D,B),u.push(D,N,B),M+=6}l.addGroup(p,M,g),p+=M,f+=S}return m("z","y","x",-1,-1,i,r,n,s,o,0),m("z","y","x",1,-1,i,r,-n,s,o,1),m("x","z","y",1,1,n,i,r,a,s,2),m("x","z","y",1,-1,n,i,-r,a,s,3),m("x","y","z",1,-1,n,r,i,a,o,4),m("x","y","z",-1,-1,n,r,-i,a,o,5),e.setIndex(u),e.setAttribute("position",new Bu(c,3)),e.setAttribute("normal",new Bu(h,3)),e.setAttribute("uv",new Bu(d,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}]),t}(qu);function fc(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function pc(e){for(var t={},n=0;n<e.length;n++){var r=fc(e[n]);for(var i in r)t[i]=r[i]}return t}function mc(e){return null===e.getRenderTarget()?e.outputColorSpace:Os.workingColorSpace}var vc={clone:fc,merge:pc},gc=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isShaderMaterial=!0,n.type="ShaderMaterial",n.defines={},n.uniforms={},n.uniformsGroups=[],n.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",n.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",n.linewidth=1,n.wireframe=!1,n.wireframeLinewidth=1,n.fog=!1,n.lights=!1,n.clipping=!1,n.forceSinglePass=!0,n.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},n.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},n.index0AttributeName=void 0,n.uniformsNeedUpdate=!1,n.glslVersion=null,void 0!==e&&n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=fc(e.uniforms),this.uniformsGroups=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=ar({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=ar({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);for(var r in n.glslVersion=this.glslVersion,n.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?n.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?n.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?n.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?n.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?n.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?n.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?n.uniforms[r]={type:"m4",value:i.toArray()}:n.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(n.extensions=a),n}}]),t}(bu),yc=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isCamera=!0,e.type="Camera",e.matrixWorldInverse=new kl,e.projectionMatrix=new kl,e.projectionMatrixInverse=new kl,e.coordinateSystem=rs,e}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}},{key:"getWorldDirection",value:function(e){return tr(lr(t.prototype),"getWorldDirection",this).call(this,e).negate()}},{key:"updateMatrixWorld",value:function(e){tr(lr(t.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,n){tr(lr(t.prototype),"updateWorldMatrix",this).call(this,e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}($l),bc=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return mr(this,t),(e=or(this,t)).isPerspectiveCamera=!0,e.type="PerspectiveCamera",e.fov=n,e.zoom=1,e.near=i,e.far=a,e.focus=10,e.aspect=r,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:ar({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*us*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*ls*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*us*Math.atan(Math.tan(.5*ls*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*ls*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,null!==this.view&&(n.object.view=ar({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}]),t}(yc),xc=-90,wc=function(e){function t(e,n,r){var i;mr(this,t),(i=or(this,t)).type="CubeCamera",i.renderTarget=r,i.coordinateSystem=null,i.activeMipmapLevel=0;var a=new bc(xc,1,e,n);a.layers=i.layers,i.add(a);var o=new bc(xc,1,e,n);o.layers=i.layers,i.add(o);var s=new bc(xc,1,e,n);s.layers=i.layers,i.add(s);var l=new bc(xc,1,e,n);l.layers=i.layers,i.add(l);var u=new bc(xc,1,e,n);u.layers=i.layers,i.add(u);var c=new bc(xc,1,e,n);return c.layers=i.layers,i.add(c),i}return cr(t,e),gr(t,[{key:"updateCoordinateSystem",value:function(){var e,t=this.coordinateSystem,n=this.children.concat(),r=er(n,6),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=$n(n);try{for(c.s();!(e=c.n()).done;){var h=e.value;this.remove(h)}}catch(e){c.e(e)}finally{c.f()}if(t===rs)i.up.set(0,1,0),i.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else{if(t!==is)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);i.up.set(0,-1,0),i.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1)}var d,f=$n(n);try{for(f.s();!(d=f.n()).done;){var p=d.value;this.add(p),p.updateMatrixWorld()}}catch(e){f.e(e)}finally{f.f()}}},{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=this.activeMipmapLevel;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());var i=er(this.children,6),a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],c=i[5],h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;var m=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,a),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,u),n.texture.generateMipmaps=m,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(h,d,f),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}]),t}($l),_c=function(e){function t(e,n,r,i,a,o,s,l,u,c){var h;return mr(this,t),(h=or(this,t,[e=void 0!==e?e:[],n=void 0!==n?n:Ai,r,i,a,o,s,l,u,c])).isCubeTexture=!0,h.flipY=!1,h}return cr(t,e),gr(t,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),t}(js),Ec=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};mr(this,t),(e=or(this,t,[n,n,r])).isWebGLCubeRenderTarget=!0;var i={width:n,height:n,depth:1},a=[i,i,i,i,i,i];return void 0!==r.encoding&&(ks("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===oo?fo:ho),e.texture=new _c(a,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),e.texture.isRenderTargetTexture=!0,e.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,e.texture.minFilter=void 0!==r.minFilter?r.minFilter:Fi,e}return cr(t,e),gr(t,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n=new dc(5,5,5),r=new gc({name:"CubemapFromEquirect",uniforms:fc({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:Cr,blending:Or});r.uniforms.tEquirect.value=t;var i=new cc(n,r),a=t.minFilter;return t.minFilter===Gi&&(t.minFilter=Fi),new wc(1,10,this).update(e,i),t.minFilter=a,i.geometry.dispose(),i.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),t}(Ws),Tc=new Qs,Sc=new Qs,Mc=new xs,Ac=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;mr(this,e),this.isPlane=!0,this.normal=t,this.constant=n}return gr(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=Tc.subVectors(n,t).cross(Sc.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}},{key:"intersectLine",value:function(e,t){var n=e.delta(Tc),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||Mc.getNormalMatrix(e),r=this.coplanarPoint(Tc).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),kc=new bl,Pc=new Qs,Rc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ac,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ac,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ac,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ac,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Ac,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Ac;mr(this,e),this.planes=[t,n,r,i,a,o]}return gr(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rs,n=this.planes,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],h=r[7],d=r[8],f=r[9],p=r[10],m=r[11],v=r[12],g=r[13],y=r[14],b=r[15];if(n[0].setComponents(s-i,h-l,m-d,b-v).normalize(),n[1].setComponents(s+i,h+l,m+d,b+v).normalize(),n[2].setComponents(s+a,h+u,m+f,b+g).normalize(),n[3].setComponents(s-a,h-u,m-f,b-g).normalize(),n[4].setComponents(s-o,h-c,m-p,b-y).normalize(),t===rs)n[5].setComponents(s+o,h+c,m+p,b+y).normalize();else{if(t!==is)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,c,p,y).normalize()}return this}},{key:"intersectsObject",value:function(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),kc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{var t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),kc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(kc)}},{key:"intersectsSprite",value:function(e){return kc.center.set(0,0,0),kc.radius=.7071067811865476,kc.applyMatrix4(e.matrixWorld),this.intersectsSphere(kc)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Pc.x=r.normal.x>0?e.max.x:e.min.x,Pc.y=r.normal.y>0?e.max.y:e.min.y,Pc.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Pc)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function Cc(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Lc(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var a=r.get(t);(!a||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);if(void 0===o)r.set(t,function(t,r){var i,a=t.array,o=t.usage,s=a.byteLength,l=e.createBuffer();if(e.bindBuffer(r,l),e.bufferData(r,a,o),t.onUploadCallback(),a instanceof Float32Array)i=e.FLOAT;else if(a instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");i=e.HALF_FLOAT}else i=e.UNSIGNED_SHORT;else if(a instanceof Int16Array)i=e.SHORT;else if(a instanceof Uint32Array)i=e.UNSIGNED_INT;else if(a instanceof Int32Array)i=e.INT;else if(a instanceof Int8Array)i=e.BYTE;else if(a instanceof Uint8Array)i=e.UNSIGNED_BYTE;else{if(!(a instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+a);i=e.UNSIGNED_BYTE}return{buffer:l,type:i,bytesPerElement:a.BYTES_PER_ELEMENT,version:t.version,size:s}}(t,i));else if(o.version<t.version){if(o.size!==t.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,r,i){var a=r.array,o=r._updateRange,s=r.updateRanges;if(e.bindBuffer(i,t),-1===o.count&&0===s.length&&e.bufferSubData(i,0,a),0!==s.length){for(var l=0,u=s.length;l<u;l++){var c=s[l];n?e.bufferSubData(i,c.start*a.BYTES_PER_ELEMENT,a,c.start,c.count):e.bufferSubData(i,c.start*a.BYTES_PER_ELEMENT,a.subarray(c.start,c.start+c.count))}r.clearUpdateRanges()}-1!==o.count&&(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1),r.onUploadCallback()}(o.buffer,t,i),o.version=t.version}}}}}var Ic=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;mr(this,t),(e=or(this,t)).type="PlaneGeometry",e.parameters={width:n,height:r,widthSegments:i,heightSegments:a};for(var o=n/2,s=r/2,l=Math.floor(i),u=Math.floor(a),c=l+1,h=u+1,d=n/l,f=r/u,p=[],m=[],v=[],g=[],y=0;y<h;y++)for(var b=y*f-s,x=0;x<c;x++){var w=x*d-o;m.push(w,-b,0),v.push(0,0,1),g.push(x/l),g.push(1-y/u)}for(var _=0;_<u;_++)for(var E=0;E<l;E++){var T=E+c*_,S=E+c*(_+1),M=E+1+c*(_+1),A=E+1+c*_;p.push(T,S,A),p.push(S,M,A)}return e.setIndex(p),e.setAttribute("position",new Bu(m,3)),e.setAttribute("normal",new Bu(v,3)),e.setAttribute("uv",new Bu(g,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.width,e.height,e.widthSegments,e.heightSegments)}}]),t}(qu),Oc={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor *= toneMappingExposure;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\treturn color;\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Dc={common:{diffuse:{value:new vu(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new xs},alphaMap:{value:null},alphaMapTransform:{value:new xs},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new xs}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new xs}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new xs}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new xs},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new xs},normalScale:{value:new bs(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new xs},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new xs}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new xs}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new xs}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new vu(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new vu(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new xs},alphaTest:{value:0},uvTransform:{value:new xs}},sprite:{diffuse:{value:new vu(16777215)},opacity:{value:1},center:{value:new bs(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new xs},alphaMap:{value:null},alphaMapTransform:{value:new xs},alphaTest:{value:0}}},Nc={basic:{uniforms:pc([Dc.common,Dc.specularmap,Dc.envmap,Dc.aomap,Dc.lightmap,Dc.fog]),vertexShader:Oc.meshbasic_vert,fragmentShader:Oc.meshbasic_frag},lambert:{uniforms:pc([Dc.common,Dc.specularmap,Dc.envmap,Dc.aomap,Dc.lightmap,Dc.emissivemap,Dc.bumpmap,Dc.normalmap,Dc.displacementmap,Dc.fog,Dc.lights,{emissive:{value:new vu(0)}}]),vertexShader:Oc.meshlambert_vert,fragmentShader:Oc.meshlambert_frag},phong:{uniforms:pc([Dc.common,Dc.specularmap,Dc.envmap,Dc.aomap,Dc.lightmap,Dc.emissivemap,Dc.bumpmap,Dc.normalmap,Dc.displacementmap,Dc.fog,Dc.lights,{emissive:{value:new vu(0)},specular:{value:new vu(1118481)},shininess:{value:30}}]),vertexShader:Oc.meshphong_vert,fragmentShader:Oc.meshphong_frag},standard:{uniforms:pc([Dc.common,Dc.envmap,Dc.aomap,Dc.lightmap,Dc.emissivemap,Dc.bumpmap,Dc.normalmap,Dc.displacementmap,Dc.roughnessmap,Dc.metalnessmap,Dc.fog,Dc.lights,{emissive:{value:new vu(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Oc.meshphysical_vert,fragmentShader:Oc.meshphysical_frag},toon:{uniforms:pc([Dc.common,Dc.aomap,Dc.lightmap,Dc.emissivemap,Dc.bumpmap,Dc.normalmap,Dc.displacementmap,Dc.gradientmap,Dc.fog,Dc.lights,{emissive:{value:new vu(0)}}]),vertexShader:Oc.meshtoon_vert,fragmentShader:Oc.meshtoon_frag},matcap:{uniforms:pc([Dc.common,Dc.bumpmap,Dc.normalmap,Dc.displacementmap,Dc.fog,{matcap:{value:null}}]),vertexShader:Oc.meshmatcap_vert,fragmentShader:Oc.meshmatcap_frag},points:{uniforms:pc([Dc.points,Dc.fog]),vertexShader:Oc.points_vert,fragmentShader:Oc.points_frag},dashed:{uniforms:pc([Dc.common,Dc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Oc.linedashed_vert,fragmentShader:Oc.linedashed_frag},depth:{uniforms:pc([Dc.common,Dc.displacementmap]),vertexShader:Oc.depth_vert,fragmentShader:Oc.depth_frag},normal:{uniforms:pc([Dc.common,Dc.bumpmap,Dc.normalmap,Dc.displacementmap,{opacity:{value:1}}]),vertexShader:Oc.meshnormal_vert,fragmentShader:Oc.meshnormal_frag},sprite:{uniforms:pc([Dc.sprite,Dc.fog]),vertexShader:Oc.sprite_vert,fragmentShader:Oc.sprite_frag},background:{uniforms:{uvTransform:{value:new xs},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Oc.background_vert,fragmentShader:Oc.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Oc.backgroundCube_vert,fragmentShader:Oc.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Oc.cube_vert,fragmentShader:Oc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Oc.equirect_vert,fragmentShader:Oc.equirect_frag},distanceRGBA:{uniforms:pc([Dc.common,Dc.displacementmap,{referencePosition:{value:new Qs},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Oc.distanceRGBA_vert,fragmentShader:Oc.distanceRGBA_frag},shadow:{uniforms:pc([Dc.lights,Dc.fog,{color:{value:new vu(0)},opacity:{value:1}}]),vertexShader:Oc.shadow_vert,fragmentShader:Oc.shadow_frag}};Nc.physical={uniforms:pc([Nc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new xs},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new xs},clearcoatNormalScale:{value:new bs(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new xs},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new xs},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new xs},sheen:{value:0},sheenColor:{value:new vu(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new xs},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new xs},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new xs},transmissionSamplerSize:{value:new bs},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new xs},attenuationDistance:{value:0},attenuationColor:{value:new vu(0)},specularColor:{value:new vu(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new xs},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new xs},anisotropyVector:{value:new bs},anisotropyMap:{value:null},anisotropyMapTransform:{value:new xs}}]),vertexShader:Oc.meshphysical_vert,fragmentShader:Oc.meshphysical_frag};var Bc={r:0,b:0,g:0};function Uc(e,t,n,r,i,a,o){var s,l,u=new vu(0),c=!0===a?0:1,h=null,d=0,f=null;function p(t,n){t.getRGB(Bc,mc(e)),r.buffers.color.setClear(Bc.r,Bc.g,Bc.b,n,o)}return{getClearColor:function(){return u},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;u.set(e),p(u,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){p(u,c=e)},render:function(a,m){var v=!1,g=!0===m.isScene?m.background:null;g&&g.isTexture&&(g=(m.backgroundBlurriness>0?n:t).get(g)),null===g?p(u,c):g&&g.isColor&&(p(g,1),v=!0);var y=e.xr.getEnvironmentBlendMode();"additive"===y?r.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===y&&r.buffers.color.setClear(0,0,0,0,o),(e.autoClear||v)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.mapping===Ci)?(void 0===l&&((l=new cc(new dc(1,1,1),new gc({name:"BackgroundCubeMaterial",uniforms:fc(Nc.backgroundCube.uniforms),vertexShader:Nc.backgroundCube.vertexShader,fragmentShader:Nc.backgroundCube.fragmentShader,side:Cr,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=Os.getTransfer(g.colorSpace)!==yo,h===g&&d===g.version&&f===e.toneMapping||(l.material.needsUpdate=!0,h=g,d=g.version,f=e.toneMapping),l.layers.enableAll(),a.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===s&&((s=new cc(new Ic(2,2),new gc({name:"BackgroundMaterial",uniforms:fc(Nc.background.uniforms),vertexShader:Nc.background.vertexShader,fragmentShader:Nc.background.fragmentShader,side:Rr,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(s)),s.material.uniforms.t2D.value=g,s.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,s.material.toneMapped=Os.getTransfer(g.colorSpace)!==yo,!0===g.matrixAutoUpdate&&g.updateMatrix(),s.material.uniforms.uvTransform.value.copy(g.matrix),h===g&&d===g.version&&f===e.toneMapping||(s.material.needsUpdate=!0,h=g,d=g.version,f=e.toneMapping),s.layers.enableAll(),a.unshift(s,s.geometry,s.material,0,0,null))}}}function zc(e,t,n,r){var i=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},l=f(null),u=l,c=!1;function h(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function f(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){for(var e=u.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function m(e){v(e,0)}function v(n,i){var a=u.newAttributes,o=u.enabledAttributes,s=u.attributeDivisors;a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function g(){for(var t=u.newAttributes,n=u.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,r,i,a,o,s){!0===s?e.vertexAttribIPointer(t,n,r,a,o):e.vertexAttribPointer(t,n,r,i,a,o)}function b(){x(),c=!0,u!==l&&h((u=l).object)}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,d,b,x){var w=!1;if(o){var _=function(t,n,i){var o=!0===i.wireframe,l=s[t.id];void 0===l&&(l={},s[t.id]=l);var u=l[n.id];void 0===u&&(u={},l[n.id]=u);var c=u[o];return void 0===c&&(c=f(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),u[o]=c),c}(b,d,l);u!==_&&h((u=_).object),w=function(e,t,n,r){var i=u.attributes,a=t.attributes,o=0,s=n.getAttributes();for(var l in s)if(s[l].location>=0){var c=i[l],h=a[l];if(void 0===h&&("instanceMatrix"===l&&e.instanceMatrix&&(h=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(h=e.instanceColor)),void 0===c)return!0;if(c.attribute!==h)return!0;if(h&&c.data!==h.data)return!0;o++}return u.attributesNum!==o||u.index!==r}(i,b,d,x),w&&function(e,t,n,r){var i={},a=t.attributes,o=0,s=n.getAttributes();for(var l in s)if(s[l].location>=0){var c=a[l];void 0===c&&("instanceMatrix"===l&&e.instanceMatrix&&(c=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(c=e.instanceColor));var h={};h.attribute=c,c&&c.data&&(h.data=c.data),i[l]=h,o++}u.attributes=i,u.attributesNum=o,u.index=r}(i,b,d,x)}else{var E=!0===l.wireframe;u.geometry===b.id&&u.program===d.id&&u.wireframe===E||(u.geometry=b.id,u.program=d.id,u.wireframe=E,w=!0)}null!==x&&n.update(x,e.ELEMENT_ARRAY_BUFFER),(w||c)&&(c=!1,function(i,a,o,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==t.get("ANGLE_instanced_arrays")){p();var l=s.attributes,u=o.getAttributes(),c=a.defaultAttributeValues;for(var h in u){var d=u[h];if(d.location>=0){var f=l[h];if(void 0===f&&("instanceMatrix"===h&&i.instanceMatrix&&(f=i.instanceMatrix),"instanceColor"===h&&i.instanceColor&&(f=i.instanceColor)),void 0!==f){var b=f.normalized,x=f.itemSize,w=n.get(f);if(void 0===w)continue;var _=w.buffer,E=w.type,T=w.bytesPerElement,S=!0===r.isWebGL2&&(E===e.INT||E===e.UNSIGNED_INT||f.gpuType===Ki);if(f.isInterleavedBufferAttribute){var M=f.data,A=M.stride,k=f.offset;if(M.isInstancedInterleavedBuffer){for(var P=0;P<d.locationSize;P++)v(d.location+P,M.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=M.meshPerAttribute*M.count)}else for(var R=0;R<d.locationSize;R++)m(d.location+R);e.bindBuffer(e.ARRAY_BUFFER,_);for(var C=0;C<d.locationSize;C++)y(d.location+C,x/d.locationSize,E,b,A*T,(k+x/d.locationSize*C)*T,S)}else{if(f.isInstancedBufferAttribute){for(var L=0;L<d.locationSize;L++)v(d.location+L,f.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=f.meshPerAttribute*f.count)}else for(var I=0;I<d.locationSize;I++)m(d.location+I);e.bindBuffer(e.ARRAY_BUFFER,_);for(var O=0;O<d.locationSize;O++)y(d.location+O,x/d.locationSize,E,b,x*T,x/d.locationSize*O*T,S)}}else if(void 0!==c){var D=c[h];if(void 0!==D)switch(D.length){case 2:e.vertexAttrib2fv(d.location,D);break;case 3:e.vertexAttrib3fv(d.location,D);break;case 4:e.vertexAttrib4fv(d.location,D);break;default:e.vertexAttrib1fv(d.location,D)}}}}g()}}(i,l,d,b),null!==x&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(x).buffer))},reset:b,resetDefaultState:x,dispose:function(){for(var e in b(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)d(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:g}}function Fc(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var l,u;if(a)l=e,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](i,r,o,s),n.update(o,i,s)}},this.renderMultiDraw=function(e,r,a){if(0!==a){var o=t.get("WEBGL_multi_draw");if(null===o)for(var s=0;s<a;s++)this.render(e[s],r[s]);else{o.multiDrawArraysWEBGL(i,e,0,r,0,a);for(var l=0,u=0;u<a;u++)l+=r[u];n.update(l,i,1)}}}}function Hc(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=a||t.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),v=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=h>0,b=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:a?e.getParameter(e.MAX_SAMPLES):0}}function jc(e){var t=this,n=null,r=0,i=!1,a=!1,o=new Ac,s=new xs,l={value:null,needsUpdate:!1};function u(e,n,r,i){var a=null!==e?e.length:0,u=null;if(0!==a){if(u=l.value,!0!==i||null===u){var c=r+4*a,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,f=r;d!==a;++d,f+=4)o.copy(e[d]).applyMatrix4(h,s),o.normal.toArray(u,f),u[f+3]=o.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){var n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=u(e,t,0)},this.setState=function(o,s,c){var h=o.clippingPlanes,d=o.clipIntersection,f=o.clipShadows,p=e.get(o);if(!i||null===h||0===h.length||a&&!f)a?u(null):(l.value!==n&&(l.value=n,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0);else{var m=a?0:r,v=4*m,g=p.clippingState||null;l.value=g,g=u(h,s,v,c);for(var y=0;y!==v;++y)g[y]=n[y];p.clippingState=g,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=m}}}function Gc(e){var t=new WeakMap;function n(e,t){return t===Pi?e.mapping=Ai:t===Ri&&(e.mapping=ki),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var a=i.mapping;if(a===Pi||a===Ri){if(t.has(i))return n(t.get(i).texture,i.mapping);var o=i.image;if(o&&o.height>0){var s=new Ec(o.height/2);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}var Vc=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return mr(this,t),(e=or(this,t)).isOrthographicCamera=!0,e.type="OrthographicCamera",e.zoom=1,e.view=null,e.left=n,e.right=r,e.top=i,e.bottom=a,e.near=o,e.far=s,e.updateProjectionMatrix(),e}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:ar({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,null!==this.view&&(n.object.view=ar({},this.view)),n}}]),t}(yc),Wc=[.125,.215,.35,.446,.526,.582],qc=20,Xc=new Vc,Yc=new vu,Kc=null,Jc=0,Zc=0,Qc=(1+Math.sqrt(5))/2,$c=1/Qc,eh=[new Qs(1,1,1),new Qs(-1,1,1),new Qs(1,1,-1),new Qs(-1,1,-1),new Qs(0,Qc,$c),new Qs(0,Qc,-$c),new Qs($c,0,Qc),new Qs(-$c,0,Qc),new Qs(Qc,$c,0),new Qs(-Qc,$c,0)],th=function(){function e(t){mr(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}return gr(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Kc=this._renderer.getRenderTarget(),Jc=this._renderer.getActiveCubeFace(),Zc=this._renderer.getActiveMipmapLevel(),this._setSize(256);var i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"fromCubemap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"compileCubemapShader",value:function(){null===this._cubemapMaterial&&(this._cubemapMaterial=ah(),this._compileMaterial(this._cubemapMaterial))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectMaterial&&(this._equirectMaterial=ih(),this._compileMaterial(this._equirectMaterial))}},{key:"dispose",value:function(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}},{key:"_setSize",value:function(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}},{key:"_dispose",value:function(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(var e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}},{key:"_cleanup",value:function(e){this._renderer.setRenderTarget(Kc,Jc,Zc),e.scissorTest=!1,rh(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e,t){e.mapping===Ai||e.mapping===ki?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Kc=this._renderer.getRenderTarget(),Jc=this._renderer.getActiveCubeFace(),Zc=this._renderer.getActiveMipmapLevel();var n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}},{key:"_allocateTargets",value:function(){var e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Fi,minFilter:Fi,generateMipmaps:!1,type:Qi,format:ra,colorSpace:po,depthBuffer:!1},r=nh(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=nh(e,t,n);var i=this._lodMax,a=function(e){for(var t=[],n=[],r=[],i=e,a=e-4+1+Wc.length,o=0;o<a;o++){var s=Math.pow(2,i);n.push(s);var l=1/s;o>e-4?l=Wc[o-e+4-1]:0===o&&(l=0),r.push(l);for(var u=1/(s-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],f=new Float32Array(108),p=new Float32Array(72),m=new Float32Array(36),v=0;v<6;v++){var g=v%3*2/3-1,y=v>2?0:-1,b=[g,y,0,g+2/3,y,0,g+2/3,y+1,0,g,y,0,g+2/3,y+1,0,g,y+1,0];f.set(b,18*v),p.set(d,12*v);var x=[v,v,v,v,v,v];m.set(x,6*v)}var w=new qu;w.setAttribute("position",new ku(f,3)),w.setAttribute("uv",new ku(p,2)),w.setAttribute("faceIndex",new ku(m,1)),t.push(w),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(i);this._sizeLods=a.sizeLods,this._lodPlanes=a.lodPlanes,this._sigmas=a.sigmas,this._blurMaterial=function(e,t,n){var r=new Float32Array(qc),i=new Qs(0,1,0);return new gc({name:"SphericalGaussianBlur",defines:{n:qc,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Or,depthTest:!1,depthWrite:!1})}(i,e,t)}return r}},{key:"_compileMaterial",value:function(e){var t=new cc(this._lodPlanes[0],e);this._renderer.compile(t,Xc)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new bc(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,u=s.toneMapping;s.getClearColor(Yc),s.toneMapping=gi,s.autoClear=!1;var c=new xu({name:"PMREM.Background",side:Cr,depthWrite:!1,depthTest:!1}),h=new cc(new dc,c),d=!1,f=e.background;f?f.isColor&&(c.color.copy(f),e.background=null,d=!0):(c.color.copy(Yc),d=!0);for(var p=0;p<6;p++){var m=p%3;0===m?(i.up.set(0,a[p],0),i.lookAt(o[p],0,0)):1===m?(i.up.set(0,0,a[p]),i.lookAt(0,o[p],0)):(i.up.set(0,a[p],0),i.lookAt(0,0,o[p]));var v=this._cubeSize;rh(r,m*v,p>2?v:0,v,v),s.setRenderTarget(r),d&&s.render(h,i),s.render(e,i)}h.geometry.dispose(),h.material.dispose(),s.toneMapping=u,s.autoClear=l,e.background=f}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=e.mapping===Ai||e.mapping===ki;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=ah()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=ih());var i=r?this._cubemapMaterial:this._equirectMaterial,a=new cc(this._lodPlanes[0],i);i.uniforms.envMap.value=e;var o=this._cubeSize;rh(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,Xc)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<this._lodPlanes.length;r++){var i=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=eh[(r-1)%eh.length];this._blur(e,r-1,r,i,a)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new cc(this._lodPlanes[r],l),c=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):qc;p>qc&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(qc));for(var m=[],v=0,g=0;g<qc;++g){var y=g/f,b=Math.exp(-y*y/2);m.push(b),0===g?v+=b:g<p&&(v+=2*b)}for(var x=0;x<m.length;x++)m[x]=m[x]/v;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=m,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o);var w=this._lodMax;c.dTheta.value=d,c.mipInt.value=w-n;var _=this._sizeLods[r];rh(t,3*_*(r>w-4?r-w+4:0),4*(this._cubeSize-_),3*_,2*_),s.setRenderTarget(t),s.render(u,Xc)}}]),e}();function nh(e,t,n){var r=new Ws(e,t,n);return r.texture.mapping=Ci,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function rh(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function ih(){return new gc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Or,depthTest:!1,depthWrite:!1})}function ah(){return new gc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Or,depthTest:!1,depthWrite:!1})}function oh(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var a=i.mapping,o=a===Pi||a===Ri,s=a===Ai||a===ki;if(o||s){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;var l=t.get(i);return null===n&&(n=new th(e)),l=o?n.fromEquirectangular(i,l):n.fromCubemap(i,l),t.set(i,l),l.texture}if(t.has(i))return t.get(i).texture;var u=i.image;if(o&&u&&u.height>0||s&&u&&function(e){for(var t=0,n=0;n<6;n++)void 0!==e[n]&&t++;return 6===t}(u)){null===n&&(n=new th(e));var c=o?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,c),i.addEventListener("dispose",r),c.texture}return null}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function sh(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?(n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance")):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function lh(e,t,n,r){var i={},a=new WeakMap;function o(e){var s=e.target;for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);for(var u in s.morphAttributes)for(var c=s.morphAttributes[u],h=0,d=c.length;h<d;h++)t.remove(c[h]);s.removeEventListener("dispose",o),delete i[s.id];var f=a.get(s);f&&(t.remove(f),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var l=0,u=s.length;l<u;l+=3){var c=s[l+0],h=s[l+1],d=s[l+2];n.push(c,h,h,d,d,c)}}else{if(void 0===i)return;var f=i.array;o=i.version;for(var p=0,m=f.length/3-1;p<m;p+=3){var v=p+0,g=p+1,y=p+2;n.push(v,g,g,y,y,v)}}var b=new(_s(n)?Du:Iu)(n,1);b.version=o;var x=a.get(e);x&&t.remove(x),a.set(e,b)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(n){var r=n.attributes;for(var i in r)t.update(r[i],e.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],l=0,u=s.length;l<u;l++)t.update(s[l],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function uh(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,l,u){if(0!==u){var c,h;if(s)c=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](i,l,a,r*o,u),n.update(l,i,u)}},this.renderMultiDraw=function(e,r,s){if(0!==s){var l=t.get("WEBGL_multi_draw");if(null===l)for(var u=0;u<s;u++)this.render(e[u]/o,r[u]);else{l.multiDrawElementsWEBGL(i,r,0,a,e,0,s);for(var c=0,h=0;h<s;h++)c+=r[h];n.update(c,i,1)}}}}function ch(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function hh(e,t){return e[0]-t[0]}function dh(e,t){return Math.abs(t[1])-Math.abs(e[1])}function fh(e,t,n){for(var r={},i=new Float32Array(8),a=new WeakMap,o=new Gs,s=[],l=0;l<8;l++)s[l]=[l,0];return{update:function(l,u,c){var h=l.morphTargetInfluences;if(!0===t.isWebGL2){var d=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,f=void 0!==d?d.length:0,p=a.get(u);if(void 0===p||p.count!==f){void 0!==p&&p.texture.dispose();var m=void 0!==u.morphAttributes.position,v=void 0!==u.morphAttributes.normal,g=void 0!==u.morphAttributes.color,y=u.morphAttributes.position||[],b=u.morphAttributes.normal||[],x=u.morphAttributes.color||[],w=0;!0===m&&(w=1),!0===v&&(w=2),!0===g&&(w=3);var _=u.attributes.position.count*w,E=1;_>t.maxTextureSize&&(E=Math.ceil(_/t.maxTextureSize),_=t.maxTextureSize);var T=new Float32Array(_*E*4*f),S=new qs(T,_,E,f);S.type=Zi,S.needsUpdate=!0;for(var M=4*w,A=0;A<f;A++)for(var k=y[A],P=b[A],R=x[A],C=_*E*4*A,L=0;L<k.count;L++){var I=L*M;!0===m&&(o.fromBufferAttribute(k,L),T[C+I+0]=o.x,T[C+I+1]=o.y,T[C+I+2]=o.z,T[C+I+3]=0),!0===v&&(o.fromBufferAttribute(P,L),T[C+I+4]=o.x,T[C+I+5]=o.y,T[C+I+6]=o.z,T[C+I+7]=0),!0===g&&(o.fromBufferAttribute(R,L),T[C+I+8]=o.x,T[C+I+9]=o.y,T[C+I+10]=o.z,T[C+I+11]=4===R.itemSize?o.w:1)}p={count:f,texture:S,size:new bs(_,E)},a.set(u,p),u.addEventListener("dispose",(function e(){S.dispose(),a.delete(u),u.removeEventListener("dispose",e)}))}for(var O=0,D=0;D<h.length;D++)O+=h[D];var N=u.morphTargetsRelative?1:1-O;c.getUniforms().setValue(e,"morphTargetBaseInfluence",N),c.getUniforms().setValue(e,"morphTargetInfluences",h),c.getUniforms().setValue(e,"morphTargetsTexture",p.texture,n),c.getUniforms().setValue(e,"morphTargetsTextureSize",p.size)}else{var B=void 0===h?0:h.length,U=r[u.id];if(void 0===U||U.length!==B){U=[];for(var z=0;z<B;z++)U[z]=[z,0];r[u.id]=U}for(var F=0;F<B;F++){var H=U[F];H[0]=F,H[1]=h[F]}U.sort(dh);for(var j=0;j<8;j++)j<B&&U[j][1]?(s[j][0]=U[j][0],s[j][1]=U[j][1]):(s[j][0]=Number.MAX_SAFE_INTEGER,s[j][1]=0);s.sort(hh);for(var G=u.morphAttributes.position,V=u.morphAttributes.normal,W=0,q=0;q<8;q++){var X=s[q],Y=X[0],K=X[1];Y!==Number.MAX_SAFE_INTEGER&&K?(G&&u.getAttribute("morphTarget"+q)!==G[Y]&&u.setAttribute("morphTarget"+q,G[Y]),V&&u.getAttribute("morphNormal"+q)!==V[Y]&&u.setAttribute("morphNormal"+q,V[Y]),i[q]=K,W+=K):(G&&!0===u.hasAttribute("morphTarget"+q)&&u.deleteAttribute("morphTarget"+q),V&&!0===u.hasAttribute("morphNormal"+q)&&u.deleteAttribute("morphNormal"+q),i[q]=0)}var J=u.morphTargetsRelative?1:1-W;c.getUniforms().setValue(e,"morphTargetBaseInfluence",J),c.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function ph(e,t,n,r){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){var s=r.render.frame,l=o.geometry,u=t.get(o,l);if(i.get(u)!==s&&(t.update(u),i.set(u,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){var c=o.skeleton;i.get(c)!==s&&(c.update(),i.set(c,s))}return u},dispose:function(){i=new WeakMap}}}var mh=function(e){function t(e,n,r,i,a,o,s,l,u,c){var h;if(mr(this,t),(c=void 0!==c?c:oa)!==oa&&c!==sa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===r&&c===oa&&(r=Ji),void 0===r&&c===sa&&(r=ta),(h=or(this,t,[null,i,a,o,s,l,c,r,u])).isDepthTexture=!0,h.image={width:e,height:n},h.magFilter=void 0!==s?s:Di,h.minFilter=void 0!==l?l:Di,h.flipY=!1,h.generateMipmaps=!1,h.compareFunction=null,h}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.compareFunction=e.compareFunction,this}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return null!==this.compareFunction&&(n.compareFunction=this.compareFunction),n}}]),t}(js),vh=new js,gh=new mh(1,1);gh.compareFunction=Fo;var yh=new qs,bh=new Ys,xh=new _c,wh=[],_h=[],Eh=new Float32Array(16),Th=new Float32Array(9),Sh=new Float32Array(4);function Mh(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=wh[i];if(void 0===a&&(a=new Float32Array(i),wh[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function Ah(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function kh(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Ph(e,t){var n=_h[t];void 0===n&&(n=new Int32Array(t),_h[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Rh(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Ch(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ah(n,t))return;e.uniform2fv(this.addr,t),kh(n,t)}}function Lh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ah(n,t))return;e.uniform3fv(this.addr,t),kh(n,t)}}function Ih(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ah(n,t))return;e.uniform4fv(this.addr,t),kh(n,t)}}function Oh(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ah(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),kh(n,t)}else{if(Ah(n,r))return;Sh.set(r),e.uniformMatrix2fv(this.addr,!1,Sh),kh(n,r)}}function Dh(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ah(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),kh(n,t)}else{if(Ah(n,r))return;Th.set(r),e.uniformMatrix3fv(this.addr,!1,Th),kh(n,r)}}function Nh(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ah(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),kh(n,t)}else{if(Ah(n,r))return;Eh.set(r),e.uniformMatrix4fv(this.addr,!1,Eh),kh(n,r)}}function Bh(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Uh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ah(n,t))return;e.uniform2iv(this.addr,t),kh(n,t)}}function zh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Ah(n,t))return;e.uniform3iv(this.addr,t),kh(n,t)}}function Fh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ah(n,t))return;e.uniform4iv(this.addr,t),kh(n,t)}}function Hh(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function jh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ah(n,t))return;e.uniform2uiv(this.addr,t),kh(n,t)}}function Gh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Ah(n,t))return;e.uniform3uiv(this.addr,t),kh(n,t)}}function Vh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ah(n,t))return;e.uniform4uiv(this.addr,t),kh(n,t)}}function Wh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i);var a=this.type===e.SAMPLER_2D_SHADOW?gh:vh;n.setTexture2D(t||a,i)}function qh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||bh,i)}function Xh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||xh,i)}function Yh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||yh,i)}function Kh(e,t){e.uniform1fv(this.addr,t)}function Jh(e,t){var n=Mh(t,this.size,2);e.uniform2fv(this.addr,n)}function Zh(e,t){var n=Mh(t,this.size,3);e.uniform3fv(this.addr,n)}function Qh(e,t){var n=Mh(t,this.size,4);e.uniform4fv(this.addr,n)}function $h(e,t){var n=Mh(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function ed(e,t){var n=Mh(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function td(e,t){var n=Mh(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function nd(e,t){e.uniform1iv(this.addr,t)}function rd(e,t){e.uniform2iv(this.addr,t)}function ad(e,t){e.uniform3iv(this.addr,t)}function od(e,t){e.uniform4iv(this.addr,t)}function sd(e,t){e.uniform1uiv(this.addr,t)}function ld(e,t){e.uniform2uiv(this.addr,t)}function ud(e,t){e.uniform3uiv(this.addr,t)}function cd(e,t){e.uniform4uiv(this.addr,t)}function hd(e,t,n){var r=this.cache,i=t.length,a=Ph(n,i);Ah(r,a)||(e.uniform1iv(this.addr,a),kh(r,a));for(var o=0;o!==i;++o)n.setTexture2D(t[o]||vh,a[o])}function dd(e,t,n){var r=this.cache,i=t.length,a=Ph(n,i);Ah(r,a)||(e.uniform1iv(this.addr,a),kh(r,a));for(var o=0;o!==i;++o)n.setTexture3D(t[o]||bh,a[o])}function fd(e,t,n){var r=this.cache,i=t.length,a=Ph(n,i);Ah(r,a)||(e.uniform1iv(this.addr,a),kh(r,a));for(var o=0;o!==i;++o)n.setTextureCube(t[o]||xh,a[o])}function pd(e,t,n){var r=this.cache,i=t.length,a=Ph(n,i);Ah(r,a)||(e.uniform1iv(this.addr,a),kh(r,a));for(var o=0;o!==i;++o)n.setTexture2DArray(t[o]||yh,a[o])}var md=gr((function e(t,n,r){mr(this,e),this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.setValue=function(e){switch(e){case 5126:return Rh;case 35664:return Ch;case 35665:return Lh;case 35666:return Ih;case 35674:return Oh;case 35675:return Dh;case 35676:return Nh;case 5124:case 35670:return Bh;case 35667:case 35671:return Uh;case 35668:case 35672:return zh;case 35669:case 35673:return Fh;case 5125:return Hh;case 36294:return jh;case 36295:return Gh;case 36296:return Vh;case 35678:case 36198:case 36298:case 36306:case 35682:return Wh;case 35679:case 36299:case 36307:return qh;case 35680:case 36300:case 36308:case 36293:return Xh;case 36289:case 36303:case 36311:case 36292:return Yh}}(n.type)})),vd=gr((function e(t,n,r){mr(this,e),this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=function(e){switch(e){case 5126:return Kh;case 35664:return Jh;case 35665:return Zh;case 35666:return Qh;case 35674:return $h;case 35675:return ed;case 35676:return td;case 5124:case 35670:return nd;case 35667:case 35671:return rd;case 35668:case 35672:return ad;case 35669:case 35673:return od;case 5125:return sd;case 36294:return ld;case 36295:return ud;case 36296:return cd;case 35678:case 36198:case 36298:case 36306:case 35682:return hd;case 35679:case 36299:case 36307:return dd;case 35680:case 36300:case 36308:case 36293:return fd;case 36289:case 36303:case 36311:case 36292:return pd}}(n.type)})),gd=function(){function e(t){mr(this,e),this.id=t,this.seq=[],this.map={}}return gr(e,[{key:"setValue",value:function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}}}]),e}(),yd=/(\w+)(\])?(\[|\.)?/g;function bd(e,t){e.seq.push(t),e.map[t.id]=t}function xd(e,t,n){var r=e.name,i=r.length;for(yd.lastIndex=0;;){var a=yd.exec(r),o=yd.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===i){bd(n,void 0===u?new md(s,e,t):new vd(s,e,t));break}var c=n.map[s];void 0===c&&bd(n,c=new gd(s)),n=c}}var wd=function(){function e(t,n){mr(this,e),this.seq=[],this.map={};for(var r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var a=t.getActiveUniform(n,i);xd(a,t.getUniformLocation(n,a.name),this)}}return gr(e,[{key:"setValue",value:function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)}},{key:"setOptional",value:function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)}}],[{key:"upload",value:function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}}},{key:"seqWithValue",value:function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n}}]),e}();function _d(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}var Ed=37297,Td=0;function Sd(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";var a=/ERROR: 0:(\d+)/.exec(i);if(a){var o=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){for(var n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length),o=i;o<a;o++){var s=o+1;r.push("".concat(s===t?">":" "," ").concat(s,": ").concat(n[o]))}return r.join("\n")}(e.getShaderSource(t),o)}return i}function Md(e,t){var n;switch(t){case yi:n="Linear";break;case bi:n="Reinhard";break;case xi:n="OptimizedCineon";break;case wi:n="ACESFilmic";break;case Ei:n="AgX";break;case _i:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ad(e){return""!==e}function kd(e,t){var n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Pd(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Rd=/^[ \t]*#include +<([\w\d./]+)>/gm;function Cd(e){return e.replace(Rd,Id)}var Ld=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Id(e,t){var n=Oc[t];if(void 0===n){var r=Ld.get(t);if(void 0===r)throw new Error("Can not resolve #include <"+t+">");n=Oc[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,r)}return Cd(n)}var Od=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Dd(e){return e.replace(Od,Nd)}function Nd(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Bd(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ud(e,t,n,r){var i,a,o,s,l,u=e.getContext(),c=n.defines,h=n.vertexShader,d=n.fragmentShader,f=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Ar?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===kr?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Pr&&(t="SHADOWMAP_TYPE_VSM"),t}(n),p=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Ai:case ki:t="ENVMAP_TYPE_CUBE";break;case Ci:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),m=function(e){var t="ENVMAP_MODE_REFLECTION";return e.envMap&&e.envMapMode===ki&&(t="ENVMAP_MODE_REFRACTION"),t}(n),v=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case pi:t="ENVMAP_BLENDING_MULTIPLY";break;case mi:t="ENVMAP_BLENDING_MIX";break;case vi:t="ENVMAP_BLENDING_ADD"}return t}(n),g=function(e){var t=e.envMapCubeUVHeight;if(null===t)return null;var n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),y=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ad).join("\n")}(n),b=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(Ad).join("\n")}(n),x=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(c),w=u.createProgram(),_=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x].filter(Ad).join("\n")).length>0&&(i+="\n"),(a=[y,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x].filter(Ad).join("\n")).length>0&&(a+="\n")):(i=[Bd(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ad).join("\n"),a=[y,Bd(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.envMap?"#define "+m:"",n.envMap?"#define "+v:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==gi?"#define TONE_MAPPING":"",n.toneMapping!==gi?Oc.tonemapping_pars_fragment:"",n.toneMapping!==gi?Md("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Oc.colorspace_pars_fragment,(o="linearToOutputTexel",s=n.outputColorSpace,l=function(e){var t,n=Os.getPrimaries(Os.workingColorSpace),r=Os.getPrimaries(e);switch(n===r?t="":n===xo&&r===bo?t="LinearDisplayP3ToLinearSRGB":n===bo&&r===xo&&(t="LinearSRGBToLinearDisplayP3"),e){case po:case vo:return[t,"LinearTransferOETF"];case fo:case mo:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),[t,"LinearTransferOETF"]}}(s),"vec4 ".concat(o,"( vec4 value ) { return ").concat(l[0],"( ").concat(l[1],"( value ) ); }")),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ad).join("\n")),h=Pd(h=kd(h=Cd(h),n),n),d=Pd(d=kd(d=Cd(d),n),n),h=Dd(h),d=Dd(d),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(_="#version 300 es\n",i=[b,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,a=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===ts?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===ts?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);var E,T,S=_+i+h,M=_+a+d,A=_d(u,u.VERTEX_SHADER,S),k=_d(u,u.FRAGMENT_SHADER,M);function P(t){if(e.debug.checkShaderErrors){var n=u.getProgramInfoLog(w).trim(),r=u.getShaderInfoLog(A).trim(),o=u.getShaderInfoLog(k).trim(),s=!0,l=!0;if(!1===u.getProgramParameter(w,u.LINK_STATUS))if(s=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(u,w,A,k);else{var c=Sd(u,A,"vertex"),h=Sd(u,k,"fragment");console.error("THREE.WebGLProgram: Shader Error "+u.getError()+" - VALIDATE_STATUS "+u.getProgramParameter(w,u.VALIDATE_STATUS)+"\n\nProgram Info Log: "+n+"\n"+c+"\n"+h)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==r&&""!==o||(l=!1);l&&(t.diagnostics={runnable:s,programLog:n,vertexShader:{log:r,prefix:i},fragmentShader:{log:o,prefix:a}})}u.deleteShader(A),u.deleteShader(k),E=new wd(u,w),T=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=e.getActiveAttrib(t,i),o=a.name,s=1;a.type===e.FLOAT_MAT2&&(s=2),a.type===e.FLOAT_MAT3&&(s=3),a.type===e.FLOAT_MAT4&&(s=4),n[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(u,w)}u.attachShader(w,A),u.attachShader(w,k),void 0!==n.index0AttributeName?u.bindAttribLocation(w,0,n.index0AttributeName):!0===n.morphTargets&&u.bindAttribLocation(w,0,"position"),u.linkProgram(w),this.getUniforms=function(){return void 0===E&&P(this),E},this.getAttributes=function(){return void 0===T&&P(this),T};var R=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===R&&(R=u.getProgramParameter(w,Ed)),R},this.destroy=function(){r.releaseStatesOfProgram(this),u.deleteProgram(w),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Td++,this.cacheKey=t,this.usedTimes=1,this.program=w,this.vertexShader=A,this.fragmentShader=k,this}var zd=0,Fd=function(){function e(){mr(this,e),this.shaderCache=new Map,this.materialCache=new Map}return gr(e,[{key:"update",value:function(e){var t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}},{key:"remove",value:function(e){var t,n=$n(this.materialCache.get(e));try{for(n.s();!(t=n.n()).done;){var r=t.value;r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code)}}catch(e){n.e(e)}finally{n.f()}return this.materialCache.delete(e),this}},{key:"getVertexShaderID",value:function(e){return this._getShaderStage(e.vertexShader).id}},{key:"getFragmentShaderID",value:function(e){return this._getShaderStage(e.fragmentShader).id}},{key:"dispose",value:function(){this.shaderCache.clear(),this.materialCache.clear()}},{key:"_getShaderCacheForMaterial",value:function(e){var t=this.materialCache,n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}},{key:"_getShaderStage",value:function(e){var t=this.shaderCache,n=t.get(e);return void 0===n&&(n=new Hd(e),t.set(e,n)),n}}]),e}(),Hd=gr((function e(t){mr(this,e),this.id=zd++,this.code=t,this.usedTimes=0}));function jd(e,t,n,r,i,a,o){var s=new zl,l=new Fd,u=[],c=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.vertexTextures,f=i.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return 0===e?"uv":"uv".concat(e)}return{getParameters:function(a,s,u,v,g){var y=v.fog,b=g.geometry,x=a.isMeshStandardMaterial?v.environment:null,w=(a.isMeshStandardMaterial?n:t).get(a.envMap||x),_=w&&w.mapping===Ci?w.image.height:null,E=p[a.type];null!==a.precision&&(f=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",f,"instead.");var T,S,M,A,k=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,P=void 0!==k?k.length:0,R=0;if(void 0!==b.morphAttributes.position&&(R=1),void 0!==b.morphAttributes.normal&&(R=2),void 0!==b.morphAttributes.color&&(R=3),E){var C=Nc[E];T=C.vertexShader,S=C.fragmentShader}else T=a.vertexShader,S=a.fragmentShader,l.update(a),M=l.getVertexShaderID(a),A=l.getFragmentShaderID(a);var L=e.getRenderTarget(),I=!0===g.isInstancedMesh,O=!0===g.isBatchedMesh,D=!!a.map,N=!!a.matcap,B=!!w,U=!!a.aoMap,z=!!a.lightMap,F=!!a.bumpMap,H=!!a.normalMap,j=!!a.displacementMap,G=!!a.emissiveMap,V=!!a.metalnessMap,W=!!a.roughnessMap,q=a.anisotropy>0,X=a.clearcoat>0,Y=a.iridescence>0,K=a.sheen>0,J=a.transmission>0,Z=q&&!!a.anisotropyMap,Q=X&&!!a.clearcoatMap,$=X&&!!a.clearcoatNormalMap,ee=X&&!!a.clearcoatRoughnessMap,te=Y&&!!a.iridescenceMap,ne=Y&&!!a.iridescenceThicknessMap,re=K&&!!a.sheenColorMap,ie=K&&!!a.sheenRoughnessMap,ae=!!a.specularMap,oe=!!a.specularColorMap,se=!!a.specularIntensityMap,le=J&&!!a.transmissionMap,ue=J&&!!a.thicknessMap,ce=!!a.gradientMap,he=!!a.alphaMap,de=a.alphaTest>0,fe=!!a.alphaHash,pe=!!a.extensions,me=!!b.attributes.uv1,ve=!!b.attributes.uv2,ge=!!b.attributes.uv3,ye=gi;return a.toneMapped&&(null!==L&&!0!==L.isXRRenderTarget||(ye=e.toneMapping)),{isWebGL2:c,shaderID:E,shaderType:a.type,shaderName:a.name,vertexShader:T,fragmentShader:S,defines:a.defines,customVertexShaderID:M,customFragmentShaderID:A,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:f,batching:O,instancing:I,instancingColor:I&&null!==g.instanceColor,supportsVertexTextures:d,outputColorSpace:null===L?e.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:po,map:D,matcap:N,envMap:B,envMapMode:B&&w.mapping,envMapCubeUVHeight:_,aoMap:U,lightMap:z,bumpMap:F,normalMap:H,displacementMap:d&&j,emissiveMap:G,normalMapObjectSpace:H&&a.normalMapType===co,normalMapTangentSpace:H&&a.normalMapType===uo,metalnessMap:V,roughnessMap:W,anisotropy:q,anisotropyMap:Z,clearcoat:X,clearcoatMap:Q,clearcoatNormalMap:$,clearcoatRoughnessMap:ee,iridescence:Y,iridescenceMap:te,iridescenceThicknessMap:ne,sheen:K,sheenColorMap:re,sheenRoughnessMap:ie,specularMap:ae,specularColorMap:oe,specularIntensityMap:se,transmission:J,transmissionMap:le,thicknessMap:ue,gradientMap:ce,opaque:!1===a.transparent&&a.blending===Dr,alphaMap:he,alphaTest:de,alphaHash:fe,combine:a.combine,mapUv:D&&m(a.map.channel),aoMapUv:U&&m(a.aoMap.channel),lightMapUv:z&&m(a.lightMap.channel),bumpMapUv:F&&m(a.bumpMap.channel),normalMapUv:H&&m(a.normalMap.channel),displacementMapUv:j&&m(a.displacementMap.channel),emissiveMapUv:G&&m(a.emissiveMap.channel),metalnessMapUv:V&&m(a.metalnessMap.channel),roughnessMapUv:W&&m(a.roughnessMap.channel),anisotropyMapUv:Z&&m(a.anisotropyMap.channel),clearcoatMapUv:Q&&m(a.clearcoatMap.channel),clearcoatNormalMapUv:$&&m(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ee&&m(a.clearcoatRoughnessMap.channel),iridescenceMapUv:te&&m(a.iridescenceMap.channel),iridescenceThicknessMapUv:ne&&m(a.iridescenceThicknessMap.channel),sheenColorMapUv:re&&m(a.sheenColorMap.channel),sheenRoughnessMapUv:ie&&m(a.sheenRoughnessMap.channel),specularMapUv:ae&&m(a.specularMap.channel),specularColorMapUv:oe&&m(a.specularColorMap.channel),specularIntensityMapUv:se&&m(a.specularIntensityMap.channel),transmissionMapUv:le&&m(a.transmissionMap.channel),thicknessMapUv:ue&&m(a.thicknessMap.channel),alphaMapUv:he&&m(a.alphaMap.channel),vertexTangents:!!b.attributes.tangent&&(H||q),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,vertexUv1s:me,vertexUv2s:ve,vertexUv3s:ge,pointsUvs:!0===g.isPoints&&!!b.attributes.uv&&(D||he),fog:!!y,useFog:!0===a.fog,fogExp2:y&&y.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:P,morphTextureStride:R,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numLightProbes:s.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:ye,useLegacyLights:e._useLegacyLights,decodeVideoTexture:D&&!0===a.map.isVideoTexture&&Os.getTransfer(a.map.colorSpace)===yo,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===Lr,flipSided:a.side===Cr,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:pe&&!0===a.extensions.derivatives,extensionFragDepth:pe&&!0===a.extensions.fragDepth,extensionDrawBuffers:pe&&!0===a.extensions.drawBuffers,extensionShaderTextureLOD:pe&&!0===a.extensions.shaderTextureLOD,extensionClipCullDistance:pe&&a.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){s.disableAll(),t.isWebGL2&&s.enable(0),t.supportsVertexTextures&&s.enable(1),t.instancing&&s.enable(2),t.instancingColor&&s.enable(3),t.matcap&&s.enable(4),t.envMap&&s.enable(5),t.normalMapObjectSpace&&s.enable(6),t.normalMapTangentSpace&&s.enable(7),t.clearcoat&&s.enable(8),t.iridescence&&s.enable(9),t.alphaTest&&s.enable(10),t.vertexColors&&s.enable(11),t.vertexAlphas&&s.enable(12),t.vertexUv1s&&s.enable(13),t.vertexUv2s&&s.enable(14),t.vertexUv3s&&s.enable(15),t.vertexTangents&&s.enable(16),t.anisotropy&&s.enable(17),t.alphaHash&&s.enable(18),t.batching&&s.enable(19),e.push(s.mask),s.disableAll(),t.fog&&s.enable(0),t.useFog&&s.enable(1),t.flatShading&&s.enable(2),t.logarithmicDepthBuffer&&s.enable(3),t.skinning&&s.enable(4),t.morphTargets&&s.enable(5),t.morphNormals&&s.enable(6),t.morphColors&&s.enable(7),t.premultipliedAlpha&&s.enable(8),t.shadowMapEnabled&&s.enable(9),t.useLegacyLights&&s.enable(10),t.doubleSided&&s.enable(11),t.flipSided&&s.enable(12),t.useDepthPacking&&s.enable(13),t.dithering&&s.enable(14),t.transmission&&s.enable(15),t.sheen&&s.enable(16),t.opaque&&s.enable(17),t.pointsUvs&&s.enable(18),t.decodeVideoTexture&&s.enable(19),e.push(s.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=p[e.type];if(n){var r=Nc[n];t=vc.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,o=u.length;i<o;i++){var s=u[i];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new Ud(e,n,t,a),u.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function Gd(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Vd(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Wd(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function qd(){var e=[],t=0,n=[],r=[],i=[];function a(n,r,i,a,o,s){var l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,o,s,l,u){var c=a(e,t,o,s,l,u);o.transmission>0?r.push(c):!0===o.transparent?i.push(c):n.push(c)},unshift:function(e,t,o,s,l,u){var c=a(e,t,o,s,l,u);o.transmission>0?r.unshift(c):!0===o.transparent?i.unshift(c):n.unshift(c)},finish:function(){for(var n=t,r=e.length;n<r;n++){var i=e[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Vd),r.length>1&&r.sort(t||Wd),i.length>1&&i.sort(t||Wd)}}}function Xd(){var e=new WeakMap;return{get:function(t,n){var r,i=e.get(t);return void 0===i?(r=new qd,e.set(t,[r])):n>=i.length?(r=new qd,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function Yd(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Qs,color:new vu};break;case"SpotLight":n={position:new Qs,direction:new Qs,color:new vu,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Qs,color:new vu,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Qs,skyColor:new vu,groundColor:new vu};break;case"RectAreaLight":n={color:new vu,position:new Qs,halfWidth:new Qs,halfHeight:new Qs}}return e[t.id]=n,n}}}var Kd=0;function Jd(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Zd(e,t){for(var n,r=new Yd,i=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bs};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bs,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0},o=0;o<9;o++)a.probe.push(new Qs);var s=new Qs,l=new kl,u=new kl;return{setup:function(n,o){for(var s=0,l=0,u=0,c=0;c<9;c++)a.probe[c].set(0,0,0);var h=0,d=0,f=0,p=0,m=0,v=0,g=0,y=0,b=0,x=0,w=0;n.sort(Jd);for(var _=!0===o?Math.PI:1,E=0,T=n.length;E<T;E++){var S=n[E],M=S.color,A=S.intensity,k=S.distance,P=S.shadow&&S.shadow.map?S.shadow.map.texture:null;if(S.isAmbientLight)s+=M.r*A*_,l+=M.g*A*_,u+=M.b*A*_;else if(S.isLightProbe){for(var R=0;R<9;R++)a.probe[R].addScaledVector(S.sh.coefficients[R],A);w++}else if(S.isDirectionalLight){var C=r.get(S);if(C.color.copy(S.color).multiplyScalar(S.intensity*_),S.castShadow){var L=S.shadow,I=i.get(S);I.shadowBias=L.bias,I.shadowNormalBias=L.normalBias,I.shadowRadius=L.radius,I.shadowMapSize=L.mapSize,a.directionalShadow[h]=I,a.directionalShadowMap[h]=P,a.directionalShadowMatrix[h]=S.shadow.matrix,v++}a.directional[h]=C,h++}else if(S.isSpotLight){var O=r.get(S);O.position.setFromMatrixPosition(S.matrixWorld),O.color.copy(M).multiplyScalar(A*_),O.distance=k,O.coneCos=Math.cos(S.angle),O.penumbraCos=Math.cos(S.angle*(1-S.penumbra)),O.decay=S.decay,a.spot[f]=O;var D=S.shadow;if(S.map&&(a.spotLightMap[b]=S.map,b++,D.updateMatrices(S),S.castShadow&&x++),a.spotLightMatrix[f]=D.matrix,S.castShadow){var N=i.get(S);N.shadowBias=D.bias,N.shadowNormalBias=D.normalBias,N.shadowRadius=D.radius,N.shadowMapSize=D.mapSize,a.spotShadow[f]=N,a.spotShadowMap[f]=P,y++}f++}else if(S.isRectAreaLight){var B=r.get(S);B.color.copy(M).multiplyScalar(A),B.halfWidth.set(.5*S.width,0,0),B.halfHeight.set(0,.5*S.height,0),a.rectArea[p]=B,p++}else if(S.isPointLight){var U=r.get(S);if(U.color.copy(S.color).multiplyScalar(S.intensity*_),U.distance=S.distance,U.decay=S.decay,S.castShadow){var z=S.shadow,F=i.get(S);F.shadowBias=z.bias,F.shadowNormalBias=z.normalBias,F.shadowRadius=z.radius,F.shadowMapSize=z.mapSize,F.shadowCameraNear=z.camera.near,F.shadowCameraFar=z.camera.far,a.pointShadow[d]=F,a.pointShadowMap[d]=P,a.pointShadowMatrix[d]=S.shadow.matrix,g++}a.point[d]=U,d++}else if(S.isHemisphereLight){var H=r.get(S);H.skyColor.copy(S.color).multiplyScalar(A*_),H.groundColor.copy(S.groundColor).multiplyScalar(A*_),a.hemi[m]=H,m++}}p>0&&(t.isWebGL2?!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=Dc.LTC_FLOAT_1,a.rectAreaLTC2=Dc.LTC_FLOAT_2):(a.rectAreaLTC1=Dc.LTC_HALF_1,a.rectAreaLTC2=Dc.LTC_HALF_2):!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=Dc.LTC_FLOAT_1,a.rectAreaLTC2=Dc.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=Dc.LTC_HALF_1,a.rectAreaLTC2=Dc.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=s,a.ambient[1]=l,a.ambient[2]=u;var j=a.hash;j.directionalLength===h&&j.pointLength===d&&j.spotLength===f&&j.rectAreaLength===p&&j.hemiLength===m&&j.numDirectionalShadows===v&&j.numPointShadows===g&&j.numSpotShadows===y&&j.numSpotMaps===b&&j.numLightProbes===w||(a.directional.length=h,a.spot.length=f,a.rectArea.length=p,a.point.length=d,a.hemi.length=m,a.directionalShadow.length=v,a.directionalShadowMap.length=v,a.pointShadow.length=g,a.pointShadowMap.length=g,a.spotShadow.length=y,a.spotShadowMap.length=y,a.directionalShadowMatrix.length=v,a.pointShadowMatrix.length=g,a.spotLightMatrix.length=y+b-x,a.spotLightMap.length=b,a.numSpotLightShadowsWithMaps=x,a.numLightProbes=w,j.directionalLength=h,j.pointLength=d,j.spotLength=f,j.rectAreaLength=p,j.hemiLength=m,j.numDirectionalShadows=v,j.numPointShadows=g,j.numSpotShadows=y,j.numSpotMaps=b,j.numLightProbes=w,a.version=Kd++)},setupView:function(e,t){for(var n=0,r=0,i=0,o=0,c=0,h=t.matrixWorldInverse,d=0,f=e.length;d<f;d++){var p=e[d];if(p.isDirectionalLight){var m=a.directional[n];m.direction.setFromMatrixPosition(p.matrixWorld),s.setFromMatrixPosition(p.target.matrixWorld),m.direction.sub(s),m.direction.transformDirection(h),n++}else if(p.isSpotLight){var v=a.spot[i];v.position.setFromMatrixPosition(p.matrixWorld),v.position.applyMatrix4(h),v.direction.setFromMatrixPosition(p.matrixWorld),s.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(s),v.direction.transformDirection(h),i++}else if(p.isRectAreaLight){var g=a.rectArea[o];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(h),u.identity(),l.copy(p.matrixWorld),l.premultiply(h),u.extractRotation(l),g.halfWidth.set(.5*p.width,0,0),g.halfHeight.set(0,.5*p.height,0),g.halfWidth.applyMatrix4(u),g.halfHeight.applyMatrix4(u),o++}else if(p.isPointLight){var y=a.point[r];y.position.setFromMatrixPosition(p.matrixWorld),y.position.applyMatrix4(h),r++}else if(p.isHemisphereLight){var b=a.hemi[c];b.direction.setFromMatrixPosition(p.matrixWorld),b.direction.transformDirection(h),c++}}},state:a}}function Qd(e,t){var n=new Zd(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function $d(e,t){var n=new WeakMap;return{get:function(r){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=n.get(r);return void 0===o?(i=new Qd(e,t),n.set(r,[i])):a>=o.length?(i=new Qd(e,t),o.push(i)):i=o[a],i},dispose:function(){n=new WeakMap}}}var ef=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshDepthMaterial=!0,n.type="MeshDepthMaterial",n.depthPacking=so,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLinewidth=1,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),t}(bu),tf=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshDistanceMaterial=!0,n.type="MeshDistanceMaterial",n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),t}(bu);function nf(e,t,n){var r=new Rc,i=new bs,a=new bs,o=new Gs,s=new ef({depthPacking:lo}),l=new tf,u={},c=n.maxTextureSize,h=dr(dr(dr({},Rr,Cr),Cr,Rr),Lr,Lr),d=new gc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new bs},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;var p=new qu;p.setAttribute("position",new ku(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new cc(p,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ar;var g=this.type;function y(n,r){var a=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Ws(i.x,i.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,d,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,f,m,null)}function b(t,n,r,i){var a=null,o=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===r.isPointLight?l:s,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){var c=a.uuid,d=n.uuid,f=u[c];void 0===f&&(f={},u[c]=f);var p=f[d];void 0===p&&(p=a.clone(),f[d]=p,n.addEventListener("dispose",w)),a=p}return a.visible=n.visible,a.wireframe=n.wireframe,a.side=i===Pr?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],a.alphaMap=n.alphaMap,a.alphaTest=n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial&&(e.properties.get(a).light=r),a}function x(n,i,a,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===Pr)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=t.update(n),u=n.material;if(Array.isArray(u))for(var c=l.groups,h=0,d=c.length;h<d;h++){var f=c[h],p=u[f.materialIndex];if(p&&p.visible){var m=b(n,p,o,s);n.onBeforeShadow(e,n,i,a,l,m,f),e.renderBufferDirect(a,null,l,m,n,f),n.onAfterShadow(e,n,i,a,l,m,f)}}else if(u.visible){var v=b(n,u,o,s);n.onBeforeShadow(e,n,i,a,l,v,null),e.renderBufferDirect(a,null,l,v,n,null),n.onAfterShadow(e,n,i,a,l,v,null)}}for(var g=n.children,y=0,w=g.length;y<w;y++)x(g[y],i,a,o,s)}}function w(e){var t=e.target;for(var n in t.removeEventListener("dispose",w),u){var r=u[n],i=e.target.uuid;i in r&&(r[i].dispose(),delete r[i])}}this.render=function(t,n,s){if(!1!==v.enabled&&(!1!==v.autoUpdate||!1!==v.needsUpdate)&&0!==t.length){var l=e.getRenderTarget(),u=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(Or),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=g!==Pr&&this.type===Pr,p=g===Pr&&this.type!==Pr,m=0,b=t.length;m<b;m++){var w=t[m],_=w.shadow;if(void 0!==_){if(!1!==_.autoUpdate||!1!==_.needsUpdate){i.copy(_.mapSize);var E=_.getFrameExtents();if(i.multiply(E),a.copy(_.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/E.x),i.x=a.x*E.x,_.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/E.y),i.y=a.y*E.y,_.mapSize.y=a.y)),null===_.map||!0===f||!0===p){var T=this.type!==Pr?{minFilter:Di,magFilter:Di}:{};null!==_.map&&_.map.dispose(),_.map=new Ws(i.x,i.y,T),_.map.texture.name=w.name+".shadowMap",_.camera.updateProjectionMatrix()}e.setRenderTarget(_.map),e.clear();for(var S=_.getViewportCount(),M=0;M<S;M++){var A=_.getViewport(M);o.set(a.x*A.x,a.y*A.y,a.x*A.z,a.y*A.w),d.viewport(o),_.updateMatrices(w,M),r=_.getFrustum(),x(n,s,_.camera,w,this.type)}!0!==_.isPointLightShadow&&this.type===Pr&&y(_,s),_.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",w,"has no shadow.")}g=this.type,v.needsUpdate=!1,e.setRenderTarget(l,u,h)}}}function rf(e,t,n){var r,i=n.isWebGL2,a=new function(){var t=!1,n=new Gs,r=null,i=new Gs(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(t){t?G(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){switch(t){case oi:e.depthFunc(e.NEVER);break;case si:e.depthFunc(e.ALWAYS);break;case li:e.depthFunc(e.LESS);break;case ui:e.depthFunc(e.LEQUAL);break;case ci:e.depthFunc(e.EQUAL);break;case hi:e.depthFunc(e.GEQUAL);break;case di:e.depthFunc(e.GREATER);break;case fi:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},s=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(n){t||(n?G(e.STENCIL_TEST):V(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null}}},l=new WeakMap,u=new WeakMap,c={},h={},d=new WeakMap,f=[],p=null,m=!1,v=null,g=null,y=null,b=null,x=null,w=null,_=null,E=new vu(0,0,0),T=0,S=!1,M=null,A=null,k=null,P=null,R=null,C=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),L=!1,I=0,O=e.getParameter(e.VERSION);-1!==O.indexOf("WebGL")?(I=parseFloat(/^WebGL (\d)/.exec(O)[1]),L=I>=1):-1!==O.indexOf("OpenGL ES")&&(I=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),L=I>=2);var D=null,N={},B=e.getParameter(e.SCISSOR_BOX),U=e.getParameter(e.VIEWPORT),z=(new Gs).fromArray(B),F=(new Gs).fromArray(U);function H(t,n,r,a){var o=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var l=0;l<r;l++)!i||t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY?e.texImage2D(n+l,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage3D(n,0,e.RGBA,1,1,a,0,e.RGBA,e.UNSIGNED_BYTE,o);return s}var j={};function G(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function V(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}j[e.TEXTURE_2D]=H(e.TEXTURE_2D,e.TEXTURE_2D,1),j[e.TEXTURE_CUBE_MAP]=H(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(j[e.TEXTURE_2D_ARRAY]=H(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),j[e.TEXTURE_3D]=H(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),o.setClear(1),s.setClear(0),G(e.DEPTH_TEST),o.setFunc(ui),K(!1),J(Er),G(e.CULL_FACE),Y(Or);var W=dr(dr(dr({},Fr,e.FUNC_ADD),Hr,e.FUNC_SUBTRACT),jr,e.FUNC_REVERSE_SUBTRACT);if(i)W[Gr]=e.MIN,W[Vr]=e.MAX;else{var q=t.get("EXT_blend_minmax");null!==q&&(W[Gr]=q.MIN_EXT,W[Vr]=q.MAX_EXT)}var X=(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(r={},Wr,e.ZERO),qr,e.ONE),Xr,e.SRC_COLOR),Kr,e.SRC_ALPHA),ti,e.SRC_ALPHA_SATURATE),$r,e.DST_COLOR),Zr,e.DST_ALPHA),Yr,e.ONE_MINUS_SRC_COLOR),Jr,e.ONE_MINUS_SRC_ALPHA),ei,e.ONE_MINUS_DST_COLOR),dr(dr(dr(dr(dr(r,Qr,e.ONE_MINUS_DST_ALPHA),ni,e.CONSTANT_COLOR),ri,e.ONE_MINUS_CONSTANT_COLOR),ii,e.CONSTANT_ALPHA),ai,e.ONE_MINUS_CONSTANT_ALPHA));function Y(t,n,r,i,a,o,s,l,u,c){if(t!==Or){if(!1===m&&(G(e.BLEND),m=!0),t===zr)a=a||n,o=o||r,s=s||i,n===g&&a===x||(e.blendEquationSeparate(W[n],W[a]),g=n,x=a),r===y&&i===b&&o===w&&s===_||(e.blendFuncSeparate(X[r],X[i],X[o],X[s]),y=r,b=i,w=o,_=s),!1!==l.equals(E)&&u===T||(e.blendColor(l.r,l.g,l.b,u),E.copy(l),T=u),v=t,S=!1;else if(t!==v||c!==S){if(g===Fr&&x===Fr||(e.blendEquation(e.FUNC_ADD),g=Fr,x=Fr),c)switch(t){case Dr:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Nr:e.blendFunc(e.ONE,e.ONE);break;case Br:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Ur:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case Dr:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Nr:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case Br:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Ur:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}y=null,b=null,w=null,_=null,E.set(0,0,0),T=0,v=t,S=c}}else!0===m&&(V(e.BLEND),m=!1)}function K(t){M!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),M=t)}function J(t){t!==_r?(G(e.CULL_FACE),t!==A&&(t===Er?e.cullFace(e.BACK):t===Tr?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),A=t}function Z(t,n,r){t?(G(e.POLYGON_OFFSET_FILL),P===n&&R===r||(e.polygonOffset(n,r),P=n,R=r)):V(e.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:o,stencil:s},enable:G,disable:V,bindFramebuffer:function(t,n){return h[t]!==n&&(e.bindFramebuffer(t,n),h[t]=n,i&&(t===e.DRAW_FRAMEBUFFER&&(h[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(h[e.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(r,i){var a=f,o=!1;if(r)if(void 0===(a=d.get(i))&&(a=[],d.set(i,a)),r.isWebGLMultipleRenderTargets){var s=r.texture;if(a.length!==s.length||a[0]!==e.COLOR_ATTACHMENT0){for(var l=0,u=s.length;l<u;l++)a[l]=e.COLOR_ATTACHMENT0+l;a.length=s.length,o=!0}}else a[0]!==e.COLOR_ATTACHMENT0&&(a[0]=e.COLOR_ATTACHMENT0,o=!0);else a[0]!==e.BACK&&(a[0]=e.BACK,o=!0);o&&(n.isWebGL2?e.drawBuffers(a):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:Y,setMaterial:function(t,n){t.side===Lr?V(e.CULL_FACE):G(e.CULL_FACE);var r=t.side===Cr;n&&(r=!r),K(r),t.blending===Dr&&!1===t.transparent?Y(Or):Y(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),a.setMask(t.colorWrite);var i=t.stencilWrite;s.setTest(i),i&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Z(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?G(e.SAMPLE_ALPHA_TO_COVERAGE):V(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:K,setCullFace:J,setLineWidth:function(t){t!==k&&(L&&e.lineWidth(t),k=t)},setPolygonOffset:Z,setScissorTest:function(t){t?G(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+C-1),D!==t&&(e.activeTexture(t),D=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===D?e.TEXTURE0+C-1:D);var i=N[r];void 0===i&&(i={type:void 0,texture:void 0},N[r]=i),i.type===t&&i.texture===n||(D!==r&&(e.activeTexture(r),D=r),e.bindTexture(t,n||j[t]),i.type=t,i.texture=n)},unbindTexture:function(){var t=N[D];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,n){var r=u.get(n);void 0===r&&(r=new WeakMap,u.set(n,r));var i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){var r=u.get(n).get(t);l.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),l.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===z.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),z.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===i&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},D=null,N={},h={},d=new WeakMap,f=[],p=null,m=!1,v=null,g=null,y=null,b=null,x=null,w=null,_=null,E=new vu(0,0,0),T=0,S=!1,M=null,A=null,k=null,P=null,R=null,z.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),a.reset(),o.reset(),s.reset()}}}function af(e,t,n,r,i,a,o){var s,l=i.isWebGL2,u=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),h=new WeakMap,d=new WeakMap,f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function p(e,t){return f?new OffscreenCanvas(e,t):Ss("canvas")}function m(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?ms:Math.floor,o=a(i*e.width),l=a(i*e.height);void 0===s&&(s=p(o,l));var u=n?p(o,l):s;return u.width=o,u.height=l,u.getContext("2d").drawImage(e,0,0,o,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+l+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return ps(e.width)&&ps(e.height)}function g(e,t){return e.generateMipmaps&&t&&e.minFilter!==Di&&e.minFilter!==Fi}function y(t){e.generateMipmap(t)}function b(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===l)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var s=r;if(r===e.RED&&(i===e.FLOAT&&(s=e.R32F),i===e.HALF_FLOAT&&(s=e.R16F),i===e.UNSIGNED_BYTE&&(s=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.R8UI),i===e.UNSIGNED_SHORT&&(s=e.R16UI),i===e.UNSIGNED_INT&&(s=e.R32UI),i===e.BYTE&&(s=e.R8I),i===e.SHORT&&(s=e.R16I),i===e.INT&&(s=e.R32I)),r===e.RG&&(i===e.FLOAT&&(s=e.RG32F),i===e.HALF_FLOAT&&(s=e.RG16F),i===e.UNSIGNED_BYTE&&(s=e.RG8)),r===e.RGBA){var u=o?go:Os.getTransfer(a);i===e.FLOAT&&(s=e.RGBA32F),i===e.HALF_FLOAT&&(s=e.RGBA16F),i===e.UNSIGNED_BYTE&&(s=u===yo?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)}return s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||t.get("EXT_color_buffer_float"),s}function x(e,t,n){return!0===g(e,n)||e.isFramebufferTexture&&e.minFilter!==Di&&e.minFilter!==Fi?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function w(t){return t===Di||t===Ni||t===Ui?e.NEAREST:e.LINEAR}function _(e){var t=e.target;t.removeEventListener("dispose",_),function(e){var t=r.get(e);if(void 0!==t.__webglInit){var n=e.source,i=d.get(n);if(i){var a=i[t.__cacheKey];a.usedTimes--,0===a.usedTimes&&T(e),0===Object.keys(i).length&&d.delete(n)}r.remove(e)}}(t),t.isVideoTexture&&h.delete(t)}function E(t){var n=t.target;n.removeEventListener("dispose",E),function(t){var n=t.texture,i=r.get(t),a=r.get(n);if(void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),o.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var s=0;s<6;s++){if(Array.isArray(i.__webglFramebuffer[s]))for(var l=0;l<i.__webglFramebuffer[s].length;l++)e.deleteFramebuffer(i.__webglFramebuffer[s][l]);else e.deleteFramebuffer(i.__webglFramebuffer[s]);i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[s])}else{if(Array.isArray(i.__webglFramebuffer))for(var u=0;u<i.__webglFramebuffer.length;u++)e.deleteFramebuffer(i.__webglFramebuffer[u]);else e.deleteFramebuffer(i.__webglFramebuffer);if(i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(var c=0;c<i.__webglColorRenderbuffer.length;c++)i.__webglColorRenderbuffer[c]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[c]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(var h=0,d=n.length;h<d;h++){var f=r.get(n[h]);f.__webglTexture&&(e.deleteTexture(f.__webglTexture),o.memory.textures--),r.remove(n[h])}r.remove(n),r.remove(t)}(n)}function T(t){var n=r.get(t);e.deleteTexture(n.__webglTexture);var i=t.source;delete d.get(i)[n.__cacheKey],o.memory.textures--}var S=0;function M(t,i){var a=r.get(t);if(t.isVideoTexture&&function(e){var t=o.render.frame;h.get(e)!==t&&(h.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){var s=t.image;if(null===s)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==s.complete)return void L(a,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}var A=dr(dr(dr({},Li,e.REPEAT),Ii,e.CLAMP_TO_EDGE),Oi,e.MIRRORED_REPEAT),k=dr(dr(dr(dr(dr(dr({},Di,e.NEAREST),Ni,e.NEAREST_MIPMAP_NEAREST),Ui,e.NEAREST_MIPMAP_LINEAR),Fi,e.LINEAR),Hi,e.LINEAR_MIPMAP_NEAREST),Gi,e.LINEAR_MIPMAP_LINEAR),P=dr(dr(dr(dr(dr(dr(dr(dr({},Bo,e.NEVER),Vo,e.ALWAYS),Uo,e.LESS),Fo,e.LEQUAL),zo,e.EQUAL),Go,e.GEQUAL),Ho,e.GREATER),jo,e.NOTEQUAL);function R(n,a,o){if(o?(e.texParameteri(n,e.TEXTURE_WRAP_S,A[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,A[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,A[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,k[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,k[a.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),a.wrapS===Ii&&a.wrapT===Ii||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,w(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,w(a.minFilter)),a.minFilter!==Di&&a.minFilter!==Fi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,P[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(a.magFilter===Di)return;if(a.minFilter!==Ui&&a.minFilter!==Gi)return;if(a.type===Zi&&!1===t.has("OES_texture_float_linear"))return;if(!1===l&&a.type===Qi&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function C(t,n){var r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",_));var i=n.source,a=d.get(i);void 0===a&&(a={},d.set(i,a));var s=function(e){var t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(s!==t.__cacheKey){void 0===a[s]&&(a[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,r=!0),a[s].usedTimes++;var l=a[t.__cacheKey];void 0!==l&&(a[t.__cacheKey].usedTimes--,0===l.usedTimes&&T(n)),t.__cacheKey=s,t.__webglTexture=a[s].texture}return r}function L(t,o,s){var u=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(u=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(u=e.TEXTURE_3D);var c=C(t,o),h=o.source;n.bindTexture(u,t.__webglTexture,e.TEXTURE0+s);var d=r.get(h);if(h.version!==d.__version||!0===c){n.activeTexture(e.TEXTURE0+s);var f=Os.getPrimaries(Os.workingColorSpace),p=o.colorSpace===ho?null:Os.getPrimaries(o.colorSpace),w=o.colorSpace===ho||f===p?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,w);var _,E=function(e){return!l&&(e.wrapS!==Ii||e.wrapT!==Ii||e.minFilter!==Di&&e.minFilter!==Fi)}(o)&&!1===v(o.image),T=m(o.image,E,!1,i.maxTextureSize),S=v(T=U(o,T))||l,M=a.convert(o.format,o.colorSpace),A=a.convert(o.type),k=b(o.internalFormat,M,A,o.colorSpace,o.isVideoTexture);R(u,o,S);var P=o.mipmaps,L=l&&!0!==o.isVideoTexture&&k!==wa,I=void 0===d.__version||!0===c,O=x(o,T,S);if(o.isDepthTexture)k=e.DEPTH_COMPONENT,l?k=o.type===Zi?e.DEPTH_COMPONENT32F:o.type===Ji?e.DEPTH_COMPONENT24:o.type===ta?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:o.type===Zi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),o.format===oa&&k===e.DEPTH_COMPONENT&&o.type!==Yi&&o.type!==Ji&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),o.type=Ji,A=a.convert(o.type)),o.format===sa&&k===e.DEPTH_COMPONENT&&(k=e.DEPTH_STENCIL,o.type!==ta&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),o.type=ta,A=a.convert(o.type))),I&&(L?n.texStorage2D(e.TEXTURE_2D,1,k,T.width,T.height):n.texImage2D(e.TEXTURE_2D,0,k,T.width,T.height,0,M,A,null));else if(o.isDataTexture)if(P.length>0&&S){L&&I&&n.texStorage2D(e.TEXTURE_2D,O,k,P[0].width,P[0].height);for(var D=0,N=P.length;D<N;D++)_=P[D],L?n.texSubImage2D(e.TEXTURE_2D,D,0,0,_.width,_.height,M,A,_.data):n.texImage2D(e.TEXTURE_2D,D,k,_.width,_.height,0,M,A,_.data);o.generateMipmaps=!1}else L?(I&&n.texStorage2D(e.TEXTURE_2D,O,k,T.width,T.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,T.width,T.height,M,A,T.data)):n.texImage2D(e.TEXTURE_2D,0,k,T.width,T.height,0,M,A,T.data);else if(o.isCompressedTexture)if(o.isCompressedArrayTexture){L&&I&&n.texStorage3D(e.TEXTURE_2D_ARRAY,O,k,P[0].width,P[0].height,T.depth);for(var B=0,z=P.length;B<z;B++)_=P[B],o.format!==ra?null!==M?L?n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,B,0,0,0,_.width,_.height,T.depth,M,_.data,0,0):n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,B,k,_.width,_.height,T.depth,0,_.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):L?n.texSubImage3D(e.TEXTURE_2D_ARRAY,B,0,0,0,_.width,_.height,T.depth,M,A,_.data):n.texImage3D(e.TEXTURE_2D_ARRAY,B,k,_.width,_.height,T.depth,0,M,A,_.data)}else{L&&I&&n.texStorage2D(e.TEXTURE_2D,O,k,P[0].width,P[0].height);for(var F=0,H=P.length;F<H;F++)_=P[F],o.format!==ra?null!==M?L?n.compressedTexSubImage2D(e.TEXTURE_2D,F,0,0,_.width,_.height,M,_.data):n.compressedTexImage2D(e.TEXTURE_2D,F,k,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):L?n.texSubImage2D(e.TEXTURE_2D,F,0,0,_.width,_.height,M,A,_.data):n.texImage2D(e.TEXTURE_2D,F,k,_.width,_.height,0,M,A,_.data)}else if(o.isDataArrayTexture)L?(I&&n.texStorage3D(e.TEXTURE_2D_ARRAY,O,k,T.width,T.height,T.depth),n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,T.width,T.height,T.depth,M,A,T.data)):n.texImage3D(e.TEXTURE_2D_ARRAY,0,k,T.width,T.height,T.depth,0,M,A,T.data);else if(o.isData3DTexture)L?(I&&n.texStorage3D(e.TEXTURE_3D,O,k,T.width,T.height,T.depth),n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,T.width,T.height,T.depth,M,A,T.data)):n.texImage3D(e.TEXTURE_3D,0,k,T.width,T.height,T.depth,0,M,A,T.data);else if(o.isFramebufferTexture){if(I)if(L)n.texStorage2D(e.TEXTURE_2D,O,k,T.width,T.height);else for(var j=T.width,G=T.height,V=0;V<O;V++)n.texImage2D(e.TEXTURE_2D,V,k,j,G,0,M,A,null),j>>=1,G>>=1}else if(P.length>0&&S){L&&I&&n.texStorage2D(e.TEXTURE_2D,O,k,P[0].width,P[0].height);for(var W=0,q=P.length;W<q;W++)_=P[W],L?n.texSubImage2D(e.TEXTURE_2D,W,0,0,M,A,_):n.texImage2D(e.TEXTURE_2D,W,k,M,A,_);o.generateMipmaps=!1}else L?(I&&n.texStorage2D(e.TEXTURE_2D,O,k,T.width,T.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,M,A,T)):n.texImage2D(e.TEXTURE_2D,0,k,M,A,T);g(o,S)&&y(u),d.__version=h.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function I(t,i,o,s,l,c){var h=a.convert(o.format,o.colorSpace),d=a.convert(o.type),f=b(o.internalFormat,h,d,o.colorSpace);if(!r.get(i).__hasExternalTextures){var p=Math.max(1,i.width>>c),m=Math.max(1,i.height>>c);l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?n.texImage3D(l,c,f,p,m,i.depth,0,h,d,null):n.texImage2D(l,c,f,p,m,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),B(i)?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,l,r.get(o).__webglTexture,0,N(i)):(l===e.TEXTURE_2D||l>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,l,r.get(o).__webglTexture,c),n.bindFramebuffer(e.FRAMEBUFFER,null)}function O(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){var i=!0===l?e.DEPTH_COMPONENT24:e.DEPTH_COMPONENT16;if(r||B(n)){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===Zi?i=e.DEPTH_COMPONENT32F:o.type===Ji&&(i=e.DEPTH_COMPONENT24));var s=N(n);B(n)?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,s,i,n.width,n.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,s,i,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,i,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){var c=N(n);r&&!1===B(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,e.DEPTH24_STENCIL8,n.width,n.height):B(n)?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,e.DEPTH24_STENCIL8,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else for(var h=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture],d=0;d<h.length;d++){var f=h[d],p=a.convert(f.format,f.colorSpace),m=a.convert(f.type),v=b(f.internalFormat,p,m,f.colorSpace),g=N(n);r&&!1===B(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,g,v,n.width,n.height):B(n)?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,g,v,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,v,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function D(t){var i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),M(i.depthTexture,0);var a=r.get(i.depthTexture).__webglTexture,o=N(i);if(i.depthTexture.format===oa)B(i)?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(i.depthTexture.format!==sa)throw new Error("Unknown depthTexture format");B(i)?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),O(i.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),O(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function N(e){return Math.min(i.maxSamples,e.samples)}function B(e){var n=r.get(e);return l&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function U(e,n){var r=e.colorSpace,i=e.format,a=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===ns||r!==po&&r!==ho&&(Os.getTransfer(r)===yo?!1===l?!0===t.has("EXT_sRGB")&&i===ra?(e.format=ns,e.minFilter=Fi,e.generateMipmaps=!1):n=Bs.sRGBToLinear(n):i===ra&&a===Wi||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),n}this.allocateTextureUnit=function(){var e=S;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),S+=1,e},this.resetTextureUnits=function(){S=0},this.setTexture2D=M,this.setTexture2DArray=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?L(a,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?L(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,o){var s=r.get(t);t.version>0&&s.__version!==t.version?function(t,o,s){if(6===o.image.length){var u=C(t,o),c=o.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);var h=r.get(c);if(c.version!==h.__version||!0===u){n.activeTexture(e.TEXTURE0+s);var d=Os.getPrimaries(Os.workingColorSpace),f=o.colorSpace===ho?null:Os.getPrimaries(o.colorSpace),p=o.colorSpace===ho||d===f?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);for(var w=o.isCompressedTexture||o.image[0].isCompressedTexture,_=o.image[0]&&o.image[0].isDataTexture,E=[],T=0;T<6;T++)E[T]=w||_?_?o.image[T].image:o.image[T]:m(o.image[T],!1,!0,i.maxCubemapSize),E[T]=U(o,E[T]);var S,M=E[0],A=v(M)||l,k=a.convert(o.format,o.colorSpace),P=a.convert(o.type),L=b(o.internalFormat,k,P,o.colorSpace),I=l&&!0!==o.isVideoTexture,O=void 0===h.__version||!0===u,D=x(o,M,A);if(R(e.TEXTURE_CUBE_MAP,o,A),w){I&&O&&n.texStorage2D(e.TEXTURE_CUBE_MAP,D,L,M.width,M.height);for(var N=0;N<6;N++){S=E[N].mipmaps;for(var B=0;B<S.length;B++){var z=S[B];o.format!==ra?null!==k?I?n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,B,0,0,z.width,z.height,k,z.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,B,L,z.width,z.height,0,z.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):I?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,B,0,0,z.width,z.height,k,P,z.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,B,L,z.width,z.height,0,k,P,z.data)}}}else{S=o.mipmaps,I&&O&&(S.length>0&&D++,n.texStorage2D(e.TEXTURE_CUBE_MAP,D,L,E[0].width,E[0].height));for(var F=0;F<6;F++)if(_){I?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,0,0,0,E[F].width,E[F].height,k,P,E[F].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,0,L,E[F].width,E[F].height,0,k,P,E[F].data);for(var H=0;H<S.length;H++){var j=S[H].image[F].image;I?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,H+1,0,0,j.width,j.height,k,P,j.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,H+1,L,j.width,j.height,0,k,P,j.data)}}else{I?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,0,0,0,k,P,E[F]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,0,L,k,P,E[F]);for(var G=0;G<S.length;G++){var V=S[G];I?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,G+1,0,0,k,P,V.image[F]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+F,G+1,L,k,P,V.image[F])}}}g(o,A)&&y(e.TEXTURE_CUBE_MAP),h.__version=c.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}}(s,t,o):n.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+o)},this.rebindTextures=function(t,n,i){var a=r.get(t);void 0!==n&&I(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&D(t)},this.setupRenderTarget=function(t){var s=t.texture,u=r.get(t),c=r.get(s);t.addEventListener("dispose",E),!0!==t.isWebGLMultipleRenderTargets&&(void 0===c.__webglTexture&&(c.__webglTexture=e.createTexture()),c.__version=s.version,o.memory.textures++);var h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,f=v(t)||l;if(h){u.__webglFramebuffer=[];for(var p=0;p<6;p++)if(l&&s.mipmaps&&s.mipmaps.length>0){u.__webglFramebuffer[p]=[];for(var m=0;m<s.mipmaps.length;m++)u.__webglFramebuffer[p][m]=e.createFramebuffer()}else u.__webglFramebuffer[p]=e.createFramebuffer()}else{if(l&&s.mipmaps&&s.mipmaps.length>0){u.__webglFramebuffer=[];for(var x=0;x<s.mipmaps.length;x++)u.__webglFramebuffer[x]=e.createFramebuffer()}else u.__webglFramebuffer=e.createFramebuffer();if(d)if(i.drawBuffers)for(var w=t.texture,_=0,T=w.length;_<T;_++){var S=r.get(w[_]);void 0===S.__webglTexture&&(S.__webglTexture=e.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&t.samples>0&&!1===B(t)){var M=d?s:[s];u.__webglMultisampledFramebuffer=e.createFramebuffer(),u.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer);for(var A=0;A<M.length;A++){var k=M[A];u.__webglColorRenderbuffer[A]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,u.__webglColorRenderbuffer[A]);var P=a.convert(k.format,k.colorSpace),C=a.convert(k.type),L=b(k.internalFormat,P,C,k.colorSpace,!0===t.isXRRenderTarget),U=N(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,U,L,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+A,e.RENDERBUFFER,u.__webglColorRenderbuffer[A])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(u.__webglDepthRenderbuffer=e.createRenderbuffer(),O(u.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(h){n.bindTexture(e.TEXTURE_CUBE_MAP,c.__webglTexture),R(e.TEXTURE_CUBE_MAP,s,f);for(var z=0;z<6;z++)if(l&&s.mipmaps&&s.mipmaps.length>0)for(var F=0;F<s.mipmaps.length;F++)I(u.__webglFramebuffer[z][F],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+z,F);else I(u.__webglFramebuffer[z],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+z,0);g(s,f)&&y(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(d){for(var H=t.texture,j=0,G=H.length;j<G;j++){var V=H[j],W=r.get(V);n.bindTexture(e.TEXTURE_2D,W.__webglTexture),R(e.TEXTURE_2D,V,f),I(u.__webglFramebuffer,t,V,e.COLOR_ATTACHMENT0+j,e.TEXTURE_2D,0),g(V,f)&&y(e.TEXTURE_2D)}n.unbindTexture()}else{var q=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l?q=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(q,c.__webglTexture),R(q,s,f),l&&s.mipmaps&&s.mipmaps.length>0)for(var X=0;X<s.mipmaps.length;X++)I(u.__webglFramebuffer[X],t,s,e.COLOR_ATTACHMENT0,q,X);else I(u.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0,q,0);g(s,f)&&y(q),n.unbindTexture()}t.depthBuffer&&D(t)},this.updateRenderTargetMipmap=function(t){for(var i=v(t)||l,a=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture],o=0,s=a.length;o<s;o++){var u=a[o];if(g(u,i)){var c=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,h=r.get(u).__webglTexture;n.bindTexture(c,h),y(c),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(l&&t.samples>0&&!1===B(t)){var i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=t.width,o=t.height,s=e.COLOR_BUFFER_BIT,u=[],h=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,d=r.get(t),f=!0===t.isWebGLMultipleRenderTargets;if(f)for(var p=0;p<i.length;p++)n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+p,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+p,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,d.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer);for(var m=0;m<i.length;m++){u.push(e.COLOR_ATTACHMENT0+m),t.depthBuffer&&u.push(h);var v=void 0!==d.__ignoreDepthValues&&d.__ignoreDepthValues;if(!1===v&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),f&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,d.__webglColorRenderbuffer[m]),!0===v&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[h]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[h])),f){var g=r.get(i[m]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,g,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),c&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,u)}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),f)for(var y=0;y<i.length;y++){n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.RENDERBUFFER,d.__webglColorRenderbuffer[y]);var b=r.get(i[y]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.TEXTURE_2D,b,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=D,this.setupFrameBufferTexture=I,this.useMultisampledRTT=B}function of(e,t,n){var r=n.isWebGL2;return{convert:function(n){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ho,o=Os.getTransfer(a);if(n===Wi)return e.UNSIGNED_BYTE;if(n===$i)return e.UNSIGNED_SHORT_4_4_4_4;if(n===ea)return e.UNSIGNED_SHORT_5_5_5_1;if(n===qi)return e.BYTE;if(n===Xi)return e.SHORT;if(n===Yi)return e.UNSIGNED_SHORT;if(n===Ki)return e.INT;if(n===Ji)return e.UNSIGNED_INT;if(n===Zi)return e.FLOAT;if(n===Qi)return r?e.HALF_FLOAT:null!==(i=t.get("OES_texture_half_float"))?i.HALF_FLOAT_OES:null;if(n===na)return e.ALPHA;if(n===ra)return e.RGBA;if(n===ia)return e.LUMINANCE;if(n===aa)return e.LUMINANCE_ALPHA;if(n===oa)return e.DEPTH_COMPONENT;if(n===sa)return e.DEPTH_STENCIL;if(n===ns)return null!==(i=t.get("EXT_sRGB"))?i.SRGB_ALPHA_EXT:null;if(n===la)return e.RED;if(n===ua)return e.RED_INTEGER;if(n===ca)return e.RG;if(n===ha)return e.RG_INTEGER;if(n===da)return e.RGBA_INTEGER;if(n===fa||n===pa||n===ma||n===va)if(o===yo){if(null===(i=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(n===fa)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===pa)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===ma)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===va)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(i=t.get("WEBGL_compressed_texture_s3tc")))return null;if(n===fa)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===pa)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===ma)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===va)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===ga||n===ya||n===ba||n===xa){if(null===(i=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(n===ga)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===ya)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===ba)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===xa)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===wa)return null!==(i=t.get("WEBGL_compressed_texture_etc1"))?i.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===_a||n===Ea){if(null===(i=t.get("WEBGL_compressed_texture_etc")))return null;if(n===_a)return o===yo?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Ea)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===Ta||n===Sa||n===Ma||n===Aa||n===ka||n===Pa||n===Ra||n===Ca||n===La||n===Ia||n===Oa||n===Da||n===Na||n===Ba){if(null===(i=t.get("WEBGL_compressed_texture_astc")))return null;if(n===Ta)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Sa)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Ma)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Aa)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===ka)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Pa)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Ra)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Ca)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===La)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Ia)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Oa)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Da)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Na)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Ba)return o===yo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Ua||n===za||n===Fa){if(null===(i=t.get("EXT_texture_compression_bptc")))return null;if(n===Ua)return o===yo?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===za)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Fa)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===Ha||n===ja||n===Ga||n===Va){if(null===(i=t.get("EXT_texture_compression_rgtc")))return null;if(n===Ua)return i.COMPRESSED_RED_RGTC1_EXT;if(n===ja)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Ga)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Va)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===ta?r?e.UNSIGNED_INT_24_8:null!==(i=t.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:null:void 0!==e[n]?e[n]:null}}}var sf=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return mr(this,t),(e=or(this,t)).isArrayCamera=!0,e.cameras=n,e}return cr(t,e),gr(t)}(bc),lf=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isGroup=!0,e.type="Group",e}return cr(t,e),gr(t)}($l),uf={type:"move"},cf=function(){function e(){mr(this,e),this._targetRay=null,this._grip=null,this._hand=null}return gr(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new lf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new lf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Qs,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Qs),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new lf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Qs,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Qs),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"connect",value:function(e){if(e&&e.hand){var t=this._hand;if(t){var n,r=$n(e.hand.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this._getHandJoint(t,i)}}catch(e){r.e(e)}finally{r.f()}}}return this.dispatchEvent({type:"connected",data:e}),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;var u,c=$n(e.hand.values());try{for(c.s();!(u=c.n()).done;){var h=u.value,d=t.getJointPose(h,n),f=this._getHandJoint(l,h);null!==d&&(f.matrix.fromArray(d.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,f.jointRadius=d.radius),f.visible=null!==d}}catch(e){c.e(e)}finally{c.f()}var p=l.joints["index-finger-tip"],m=l.joints["thumb-tip"],v=p.position.distanceTo(m.position);l.inputState.pinching&&v>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&v<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1);null!==o&&(null===(r=t.getPose(e.targetRaySpace,n))&&null!==i&&(r=i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(uf)))}return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}},{key:"_getHandJoint",value:function(e,t){if(void 0===e.joints[t.jointName]){var n=new lf;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}]),e}(),hf=function(e){function t(e,n){var r;mr(this,t);var i=ur(r=or(this,t)),a=null,o=1,s=null,l="local-floor",u=1,c=null,h=null,d=null,f=null,p=null,m=null,v=n.getContextAttributes(),g=null,y=null,b=[],x=[],w=new bs,_=null,E=new bc;E.layers.enable(1),E.viewport=new Gs;var T=new bc;T.layers.enable(2),T.viewport=new Gs;var S=[E,T],M=new sf;M.layers.enable(1),M.layers.enable(2);var A=null,k=null;function P(e){var t=x.indexOf(e.inputSource);if(-1!==t){var n=b[t];void 0!==n&&(n.update(e.inputSource,e.frame,c||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}}function R(){a.removeEventListener("select",P),a.removeEventListener("selectstart",P),a.removeEventListener("selectend",P),a.removeEventListener("squeeze",P),a.removeEventListener("squeezestart",P),a.removeEventListener("squeezeend",P),a.removeEventListener("end",R),a.removeEventListener("inputsourceschange",C);for(var t=0;t<b.length;t++){var n=x[t];null!==n&&(x[t]=null,b[t].disconnect(n))}A=null,k=null,e.setRenderTarget(g),p=null,f=null,d=null,a=null,y=null,N.stop(),i.isPresenting=!1,e.setPixelRatio(_),e.setSize(w.width,w.height,!1),i.dispatchEvent({type:"sessionend"})}function C(e){for(var t=0;t<e.removed.length;t++){var n=e.removed[t],r=x.indexOf(n);r>=0&&(x[r]=null,b[r].disconnect(n))}for(var i=0;i<e.added.length;i++){var a=e.added[i],o=x.indexOf(a);if(-1===o){for(var s=0;s<b.length;s++){if(s>=x.length){x.push(a),o=s;break}if(null===x[s]){x[s]=a,o=s;break}}if(-1===o)break}var l=b[o];l&&l.connect(a)}}r.cameraAutoUpdate=!0,r.enabled=!1,r.isPresenting=!1,r.getController=function(e){var t=b[e];return void 0===t&&(t=new cf,b[e]=t),t.getTargetRaySpace()},r.getControllerGrip=function(e){var t=b[e];return void 0===t&&(t=new cf,b[e]=t),t.getGripSpace()},r.getHand=function(e){var t=b[e];return void 0===t&&(t=new cf,b[e]=t),t.getHandSpace()},r.setFramebufferScaleFactor=function(e){o=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},r.setReferenceSpaceType=function(e){l=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},r.getReferenceSpace=function(){return c||s},r.setReferenceSpace=function(e){c=e},r.getBaseLayer=function(){return null!==f?f:p},r.getBinding=function(){return d},r.getFrame=function(){return m},r.getSession=function(){return a},r.setSession=function(){var t=Qn(fr().mark((function t(r){var h,m,b,x,E;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(a=r)){t.next=27;break}if(g=e.getRenderTarget(),a.addEventListener("select",P),a.addEventListener("selectstart",P),a.addEventListener("selectend",P),a.addEventListener("squeeze",P),a.addEventListener("squeezestart",P),a.addEventListener("squeezeend",P),a.addEventListener("end",R),a.addEventListener("inputsourceschange",C),!0===v.xrCompatible){t.next=14;break}return t.next=14,n.makeXRCompatible();case 14:return _=e.getPixelRatio(),e.getSize(w),void 0===a.renderState.layers||!1===e.capabilities.isWebGL2?(h={antialias:void 0!==a.renderState.layers||v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o},p=new XRWebGLLayer(a,n,h),a.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),y=new Ws(p.framebufferWidth,p.framebufferHeight,{format:ra,type:Wi,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})):(m=null,b=null,x=null,v.depth&&(x=v.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,m=v.stencil?sa:oa,b=v.stencil?ta:Ji),E={colorFormat:n.RGBA8,depthFormat:x,scaleFactor:o},d=new XRWebGLBinding(a,n),f=d.createProjectionLayer(E),a.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),y=new Ws(f.textureWidth,f.textureHeight,{format:ra,type:Wi,depthTexture:new mh(f.textureWidth,f.textureHeight,b,void 0,void 0,void 0,void 0,void 0,void 0,m),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0}),e.properties.get(y).__ignoreDepthValues=f.ignoreDepthValues),y.isXRRenderTarget=!0,this.setFoveation(u),c=null,t.next=22,a.requestReferenceSpace(l);case 22:s=t.sent,N.setContext(a),N.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"});case 27:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getEnvironmentBlendMode=function(){if(null!==a)return a.environmentBlendMode};var L=new Qs,I=new Qs;function O(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}r.updateCamera=function(e){if(null!==a){M.near=T.near=E.near=e.near,M.far=T.far=E.far=e.far,A===M.near&&k===M.far||(a.updateRenderState({depthNear:M.near,depthFar:M.far}),A=M.near,k=M.far);var t=e.parent,n=M.cameras;O(M,t);for(var r=0;r<n.length;r++)O(n[r],t);2===n.length?function(e,t,n){L.setFromMatrixPosition(t.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);var r=L.distanceTo(I),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=o*c,f=o*h,p=r/(-c+h),m=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var v=o+p,g=s+p,y=d-m,b=f+(r-m),x=l*s/g*v,w=u*s/g*v;e.projectionMatrix.makePerspective(y,b,x,w,v,g),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(M,E,T):M.projectionMatrix.copy(E.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld)),e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*us*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,M,t)}},r.getCamera=function(){return M},r.getFoveation=function(){if(null!==f||null!==p)return u},r.setFoveation=function(e){u=e,null!==f&&(f.fixedFoveation=e),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=e)};var D=null,N=new Cc;return N.setAnimationLoop((function(t,n){if(h=n.getViewerPose(c||s),m=n,null!==h){var r=h.views;null!==p&&(e.setRenderTargetFramebuffer(y,p.framebuffer),e.setRenderTarget(y));var a=!1;r.length!==M.cameras.length&&(M.cameras.length=0,a=!0);for(var o=0;o<r.length;o++){var l=r[o],u=null;if(null!==p)u=p.getViewport(l);else{var v=d.getViewSubImage(f,l);u=v.viewport,0===o&&(e.setRenderTargetTextures(y,v.colorTexture,f.ignoreDepthValues?void 0:v.depthStencilTexture),e.setRenderTarget(y))}var g=S[o];void 0===g&&((g=new bc).layers.enable(o),g.viewport=new Gs,S[o]=g),g.matrix.fromArray(l.transform.matrix),g.matrix.decompose(g.position,g.quaternion,g.scale),g.projectionMatrix.fromArray(l.projectionMatrix),g.projectionMatrixInverse.copy(g.projectionMatrix).invert(),g.viewport.set(u.x,u.y,u.width,u.height),0===o&&(M.matrix.copy(g.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===a&&M.cameras.push(g)}}for(var w=0;w<b.length;w++){var _=x[w],E=b[w];null!==_&&void 0!==E&&E.update(_,n,c||s)}D&&D(t,n),n.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:n}),m=null})),r.setAnimationLoop=function(e){D=e},r.dispose=function(){},r}return cr(t,e),gr(t)}(as);function df(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(r,i){r.opacity.value=i.opacity,i.color&&r.diffuse.value.copy(i.color),i.emissive&&r.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(r.map.value=i.map,n(i.map,r.mapTransform)),i.alphaMap&&(r.alphaMap.value=i.alphaMap,n(i.alphaMap,r.alphaMapTransform)),i.bumpMap&&(r.bumpMap.value=i.bumpMap,n(i.bumpMap,r.bumpMapTransform),r.bumpScale.value=i.bumpScale,i.side===Cr&&(r.bumpScale.value*=-1)),i.normalMap&&(r.normalMap.value=i.normalMap,n(i.normalMap,r.normalMapTransform),r.normalScale.value.copy(i.normalScale),i.side===Cr&&r.normalScale.value.negate()),i.displacementMap&&(r.displacementMap.value=i.displacementMap,n(i.displacementMap,r.displacementMapTransform),r.displacementScale.value=i.displacementScale,r.displacementBias.value=i.displacementBias),i.emissiveMap&&(r.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,r.emissiveMapTransform)),i.specularMap&&(r.specularMap.value=i.specularMap,n(i.specularMap,r.specularMapTransform)),i.alphaTest>0&&(r.alphaTest.value=i.alphaTest);var a=t.get(i).envMap;if(a&&(r.envMap.value=a,r.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,r.reflectivity.value=i.reflectivity,r.ior.value=i.ior,r.refractionRatio.value=i.refractionRatio),i.lightMap){r.lightMap.value=i.lightMap;var o=!0===e._useLegacyLights?Math.PI:1;r.lightMapIntensity.value=i.lightMapIntensity*o,n(i.lightMap,r.lightMapTransform)}i.aoMap&&(r.aoMap.value=i.aoMap,r.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,r.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,mc(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,o,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,r){e.metalness.value=r.metalness,r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap,n(r.metalnessMap,e.metalnessMapTransform)),e.roughness.value=r.roughness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap,n(r.roughnessMap,e.roughnessMapTransform)),t.get(r).envMap&&(e.envMapIntensity.value=r.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform))),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===Cr&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform)),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,s)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){var r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function ff(e,t,n,r){var i={},a={},o=[],s=n.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e,t,n,r){var i=e.value,a=t+"_"+n;if(void 0===r[a])return r[a]="number"==typeof i||"boolean"==typeof i?i:i.clone(),!0;var o=r[a];if("number"==typeof i||"boolean"==typeof i){if(o!==i)return r[a]=i,!0}else if(!1===o.equals(i))return o.copy(i),!0;return!1}function u(e){var t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function c(t){var n=t.target;n.removeEventListener("dispose",c);var r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){var n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){var d=i[n.id];void 0===d&&(function(e){for(var t=e.uniforms,n=0,r=0,i=t.length;r<i;r++)for(var a=Array.isArray(t[r])?t[r]:[t[r]],o=0,s=a.length;o<s;o++)for(var l=a[o],c=Array.isArray(l.value)?l.value:[l.value],h=0,d=c.length;h<d;h++){var f=u(c[h]),p=n%16;0!==p&&16-p<f.boundary&&(n+=16-p),l.__data=new Float32Array(f.storage/Float32Array.BYTES_PER_ELEMENT),l.__offset=n,n+=f.storage}var m=n%16;m>0&&(n+=16-m),e.__size=n,e.__cache={}}(n),d=function(t){var n=function(){for(var e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;var r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",c));var f=h.program;r.updateUBOMapping(n,f);var p=t.render.frame;a[n.id]!==p&&(function(t){var n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(var o=0,s=r.length;o<s;o++)for(var c=Array.isArray(r[o])?r[o]:[r[o]],h=0,d=c.length;h<d;h++){var f=c[h];if(!0===l(f,o,h,a)){for(var p=f.__offset,m=Array.isArray(f.value)?f.value:[f.value],v=0,g=0;g<m.length;g++){var y=m[g],b=u(y);"number"==typeof y||"boolean"==typeof y?(f.__data[0]=y,e.bufferSubData(e.UNIFORM_BUFFER,p+v,f.__data)):y.isMatrix3?(f.__data[0]=y.elements[0],f.__data[1]=y.elements[1],f.__data[2]=y.elements[2],f.__data[3]=0,f.__data[4]=y.elements[3],f.__data[5]=y.elements[4],f.__data[6]=y.elements[5],f.__data[7]=0,f.__data[8]=y.elements[6],f.__data[9]=y.elements[7],f.__data[10]=y.elements[8],f.__data[11]=0):(y.toArray(f.__data,v),v+=b.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,p,f.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=p)},dispose:function(){for(var t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}var pf=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};mr(this,e);var n,r=t.canvas,i=void 0===r?Ms():r,a=t.context,o=void 0===a?null:a,s=t.depth,l=void 0===s||s,u=t.stencil,c=void 0===u||u,h=t.alpha,d=void 0!==h&&h,f=t.antialias,p=void 0!==f&&f,m=t.premultipliedAlpha,v=void 0===m||m,g=t.preserveDrawingBuffer,y=void 0!==g&&g,b=t.powerPreference,x=void 0===b?"default":b,w=t.failIfMajorPerformanceCaveat,_=void 0!==w&&w;this.isWebGLRenderer=!0,n=null!==o?o.getContextAttributes().alpha:d;var E=new Uint32Array(4),T=new Int32Array(4),S=null,M=null,A=[],k=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=fo,this._useLegacyLights=!1,this.toneMapping=gi,this.toneMappingExposure=1;var P=this,R=!1,C=0,L=0,I=null,O=-1,D=null,N=new Gs,B=new Gs,U=null,z=new vu(0),F=0,H=i.width,j=i.height,G=1,V=null,W=null,q=new Gs(0,0,H,j),X=new Gs(0,0,H,j),Y=!1,K=new Rc,J=!1,Z=!1,Q=null,$=new kl,ee=new bs,te=new Qs,ne={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function re(){return null===I?G:1}var ie,ae,oe,se,le,ue,ce,he,de,fe,pe,me,ve,ge,ye,be,xe,we,_e,Ee,Te,Se,Me,Ae,ke=o;function Pe(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=i.getContext(r,t);if(null!==a)return a}return null}try{var Re={alpha:!0,depth:l,stencil:c,antialias:p,premultipliedAlpha:v,preserveDrawingBuffer:y,powerPreference:x,failIfMajorPerformanceCaveat:_};if("setAttribute"in i&&i.setAttribute("data-engine","three.js r".concat(br)),i.addEventListener("webglcontextlost",Oe,!1),i.addEventListener("webglcontextrestored",De,!1),i.addEventListener("webglcontextcreationerror",Ne,!1),null===ke){var Ce=["webgl2","webgl","experimental-webgl"];if(!0===P.isWebGL1Renderer&&Ce.shift(),null===(ke=Pe(Ce,Re)))throw Pe(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&ke instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===ke.getShaderPrecisionFormat&&(ke.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function Le(){ie=new sh(ke),ae=new Hc(ke,ie,t),ie.init(ae),Se=new of(ke,ie,ae),oe=new rf(ke,ie,ae),se=new ch(ke),le=new Gd,ue=new af(ke,ie,oe,le,ae,Se,se),ce=new Gc(P),he=new oh(P),de=new Lc(ke,ae),Me=new zc(ke,ie,de,ae),fe=new lh(ke,de,se,Me),pe=new ph(ke,fe,de,se),_e=new fh(ke,ae,ue),be=new jc(le),me=new jd(P,ce,he,ie,ae,Me,be),ve=new df(P,le),ge=new Xd,ye=new $d(ie,ae),we=new Uc(P,ce,he,oe,pe,n,v),xe=new nf(P,pe,ae),Ae=new ff(ke,se,ae,oe),Ee=new Fc(ke,ie,se,ae),Te=new uh(ke,ie,se,ae),se.programs=me.programs,P.capabilities=ae,P.extensions=ie,P.properties=le,P.renderLists=ge,P.shadowMap=xe,P.state=oe,P.info=se}Le();var Ie=new hf(P,ke);function Oe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function De(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1;var e=se.autoReset,t=xe.enabled,n=xe.autoUpdate,r=xe.needsUpdate,i=xe.type;Le(),se.autoReset=e,xe.enabled=t,xe.autoUpdate=n,xe.needsUpdate=r,xe.type=i}function Ne(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Be(e){var t=e.target;t.removeEventListener("dispose",Be),function(e){(function(e){var t=le.get(e).programs;void 0!==t&&(t.forEach((function(e){me.releaseProgram(e)})),e.isShaderMaterial&&me.releaseShaderCache(e))})(e),le.remove(e)}(t)}function Ue(e,t,n){!0===e.transparent&&e.side===Lr&&!1===e.forceSinglePass?(e.side=Cr,e.needsUpdate=!0,Xe(e,t,n),e.side=Rr,e.needsUpdate=!0,Xe(e,t,n),e.side=Lr):Xe(e,t,n)}this.xr=Ie,this.getContext=function(){return ke},this.getContextAttributes=function(){return ke.getContextAttributes()},this.forceContextLoss=function(){var e=ie.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=ie.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return G},this.setPixelRatio=function(e){void 0!==e&&(G=e,this.setSize(H,j,!1))},this.getSize=function(e){return e.set(H,j)},this.setSize=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ie.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(H=e,j=t,i.width=Math.floor(e*G),i.height=Math.floor(t*G),!0===n&&(i.style.width=e+"px",i.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(H*G,j*G).floor()},this.setDrawingBufferSize=function(e,t,n){H=e,j=t,G=n,i.width=Math.floor(e*n),i.height=Math.floor(t*n),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(N)},this.getViewport=function(e){return e.copy(q)},this.setViewport=function(e,t,n,r){e.isVector4?q.set(e.x,e.y,e.z,e.w):q.set(e,t,n,r),oe.viewport(N.copy(q).multiplyScalar(G).floor())},this.getScissor=function(e){return e.copy(X)},this.setScissor=function(e,t,n,r){e.isVector4?X.set(e.x,e.y,e.z,e.w):X.set(e,t,n,r),oe.scissor(B.copy(X).multiplyScalar(G).floor())},this.getScissorTest=function(){return Y},this.setScissorTest=function(e){oe.setScissorTest(Y=e)},this.setOpaqueSort=function(e){V=e},this.setTransparentSort=function(e){W=e},this.getClearColor=function(e){return e.copy(we.getClearColor())},this.setClearColor=function(){we.setClearColor.apply(we,arguments)},this.getClearAlpha=function(){return we.getClearAlpha()},this.setClearAlpha=function(){we.setClearAlpha.apply(we,arguments)},this.clear=function(){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var r=!1;if(null!==I){var i=I.texture.format;r=i===da||i===ha||i===ua}if(r){var a=I.texture.type,o=a===Wi||a===Ji||a===Yi||a===ta||a===$i||a===ea,s=we.getClearColor(),l=we.getClearAlpha(),u=s.r,c=s.g,h=s.b;o?(E[0]=u,E[1]=c,E[2]=h,E[3]=l,ke.clearBufferuiv(ke.COLOR,0,E)):(T[0]=u,T[1]=c,T[2]=h,T[3]=l,ke.clearBufferiv(ke.COLOR,0,T))}else n|=ke.COLOR_BUFFER_BIT}e&&(n|=ke.DEPTH_BUFFER_BIT),t&&(n|=ke.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ke.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",Oe,!1),i.removeEventListener("webglcontextrestored",De,!1),i.removeEventListener("webglcontextcreationerror",Ne,!1),ge.dispose(),ye.dispose(),le.dispose(),ce.dispose(),he.dispose(),pe.dispose(),Me.dispose(),Ae.dispose(),me.dispose(),Ie.dispose(),Ie.removeEventListener("sessionstart",Fe),Ie.removeEventListener("sessionend",He),Q&&(Q.dispose(),Q=null),je.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=ne);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=function(e,t,n,r,i){!0!==t.isScene&&(t=ne),ue.resetTextureUnits();var a=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=null===I?P.outputColorSpace:!0===I.isXRRenderTarget?I.texture.colorSpace:po,l=(r.isMeshStandardMaterial?he:ce).get(r.envMap||o),u=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,f=!!n.morphAttributes.color,p=gi;r.toneMapped&&(null!==I&&!0!==I.isXRRenderTarget||(p=P.toneMapping));var m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,g=le.get(r),y=M.state.lights;if(!0===J&&(!0===Z||e!==D)){var b=e===D&&r.id===O;be.setState(r,e,b)}var x=!1;r.version===g.__version?g.needsLights&&g.lightsStateVersion!==y.state.version||g.outputColorSpace!==s||i.isBatchedMesh&&!1===g.batching?x=!0:i.isBatchedMesh||!0!==g.batching?i.isInstancedMesh&&!1===g.instancing?x=!0:i.isInstancedMesh||!0!==g.instancing?i.isSkinnedMesh&&!1===g.skinning?x=!0:i.isSkinnedMesh||!0!==g.skinning?i.isInstancedMesh&&!0===g.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===g.instancingColor&&null!==i.instanceColor||g.envMap!==l||!0===r.fog&&g.fog!==a?x=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===be.numPlanes&&g.numIntersection===be.numIntersection?(g.vertexAlphas!==u||g.vertexTangents!==c||g.morphTargets!==h||g.morphNormals!==d||g.morphColors!==f||g.toneMapping!==p||!0===ae.isWebGL2&&g.morphTargetsCount!==v)&&(x=!0):x=!0:x=!0:x=!0:x=!0:(x=!0,g.__version=r.version);var w=g.currentProgram;!0===x&&(w=Xe(r,t,i));var _=!1,E=!1,T=!1,S=w.getUniforms(),A=g.uniforms;if(oe.useProgram(w.program)&&(_=!0,E=!0,T=!0),r.id!==O&&(O=r.id,E=!0),_||D!==e){S.setValue(ke,"projectionMatrix",e.projectionMatrix),S.setValue(ke,"viewMatrix",e.matrixWorldInverse);var k=S.map.cameraPosition;void 0!==k&&k.setValue(ke,te.setFromMatrixPosition(e.matrixWorld)),ae.logarithmicDepthBuffer&&S.setValue(ke,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&S.setValue(ke,"isOrthographic",!0===e.isOrthographicCamera),D!==e&&(D=e,E=!0,T=!0)}if(i.isSkinnedMesh){S.setOptional(ke,i,"bindMatrix"),S.setOptional(ke,i,"bindMatrixInverse");var R=i.skeleton;R&&(ae.floatVertexTextures?(null===R.boneTexture&&R.computeBoneTexture(),S.setValue(ke,"boneTexture",R.boneTexture,ue)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}i.isBatchedMesh&&(S.setOptional(ke,i,"batchingTexture"),S.setValue(ke,"batchingTexture",i._matricesTexture,ue));var C=n.morphAttributes;if((void 0!==C.position||void 0!==C.normal||void 0!==C.color&&!0===ae.isWebGL2)&&_e.update(i,n,w),(E||g.receiveShadow!==i.receiveShadow)&&(g.receiveShadow=i.receiveShadow,S.setValue(ke,"receiveShadow",i.receiveShadow)),r.isMeshGouraudMaterial&&null!==r.envMap&&(A.envMap.value=l,A.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),E&&(S.setValue(ke,"toneMappingExposure",P.toneMappingExposure),g.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(A,T),a&&!0===r.fog&&ve.refreshFogUniforms(A,a),ve.refreshMaterialUniforms(A,r,G,j,Q),wd.upload(ke,Ye(g),A,ue)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(wd.upload(ke,Ye(g),A,ue),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&S.setValue(ke,"center",i.center),S.setValue(ke,"modelViewMatrix",i.modelViewMatrix),S.setValue(ke,"normalMatrix",i.normalMatrix),S.setValue(ke,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial)for(var L=r.uniformsGroups,N=0,B=L.length;N<B;N++)if(ae.isWebGL2){var U=L[N];Ae.update(U,w),Ae.bind(U,w)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.");return w}(e,t,n,r,i);oe.setMaterial(r,o);var l=n.index,u=1;if(!0===r.wireframe){if(void 0===(l=fe.getWireframeAttribute(n)))return;u=2}var c=n.drawRange,h=n.attributes.position,d=c.start*u,f=(c.start+c.count)*u;null!==a&&(d=Math.max(d,a.start*u),f=Math.min(f,(a.start+a.count)*u)),null!==l?(d=Math.max(d,0),f=Math.min(f,l.count)):null!=h&&(d=Math.max(d,0),f=Math.min(f,h.count));var p=f-d;if(!(p<0||p===1/0)){var m;Me.setup(i,r,s,n,l);var v=Ee;if(null!==l&&(m=de.get(l),(v=Te).setIndex(m)),i.isMesh)!0===r.wireframe?(oe.setLineWidth(r.wireframeLinewidth*re()),v.setMode(ke.LINES)):v.setMode(ke.TRIANGLES);else if(i.isLine){var g=r.linewidth;void 0===g&&(g=1),oe.setLineWidth(g*re()),i.isLineSegments?v.setMode(ke.LINES):i.isLineLoop?v.setMode(ke.LINE_LOOP):v.setMode(ke.LINE_STRIP)}else i.isPoints?v.setMode(ke.POINTS):i.isSprite&&v.setMode(ke.TRIANGLES);if(i.isBatchedMesh)v.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else if(i.isInstancedMesh)v.renderInstances(d,p,i.count);else if(n.isInstancedBufferGeometry){var y=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,b=Math.min(n.instanceCount,y);v.renderInstances(d,p,b)}else v.render(d,p)}},this.compile=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),(M=ye.get(n)).init(),k.push(M),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(M.pushLight(e),e.castShadow&&M.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(M.pushLight(e),e.castShadow&&M.pushShadow(e))})),M.setupLights(P._useLegacyLights);var r=new Set;return e.traverse((function(e){var t=e.material;if(t)if(Array.isArray(t))for(var i=0;i<t.length;i++){var a=t[i];Ue(a,n,e),r.add(a)}else Ue(t,n,e),r.add(t)})),k.pop(),M=null,r},this.compileAsync=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.compile(e,t,n);return new Promise((function(t){function n(){r.forEach((function(e){le.get(e).currentProgram.isReady()&&r.delete(e)})),0!==r.size?setTimeout(n,10):t(e)}null!==ie.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};var ze=null;function Fe(){je.stop()}function He(){je.start()}var je=new Cc;function Ge(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)M.pushLight(e),e.castShadow&&M.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||K.intersectsSprite(e)){r&&te.setFromMatrixPosition(e.matrixWorld).applyMatrix4($);var i=pe.update(e),a=e.material;a.visible&&S.push(e,i,a,n,te.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||K.intersectsObject(e))){var o=pe.update(e),s=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),te.copy(e.boundingSphere.center)):(null===o.boundingSphere&&o.computeBoundingSphere(),te.copy(o.boundingSphere.center)),te.applyMatrix4(e.matrixWorld).applyMatrix4($)),Array.isArray(s))for(var l=o.groups,u=0,c=l.length;u<c;u++){var h=l[u],d=s[h.materialIndex];d&&d.visible&&S.push(e,o,d,n,te.z,h)}else s.visible&&S.push(e,o,s,n,te.z,null)}for(var f=e.children,p=0,m=f.length;p<m;p++)Ge(f[p],t,n,r)}}function Ve(e,t,n,r){var i=e.opaque,a=e.transmissive,o=e.transparent;M.setupLightsView(n),!0===J&&be.setGlobalState(P.clippingPlanes,n),a.length>0&&function(e,t,n,r){if(null===(!0===n.isScene?n.overrideMaterial:null)){var i=ae.isWebGL2;null===Q&&(Q=new Ws(1,1,{generateMipmaps:!0,type:ie.has("EXT_color_buffer_half_float")?Qi:Wi,minFilter:Gi,samples:i?4:0})),P.getDrawingBufferSize(ee),i?Q.setSize(ee.x,ee.y):Q.setSize(ms(ee.x),ms(ee.y));var a=P.getRenderTarget();P.setRenderTarget(Q),P.getClearColor(z),(F=P.getClearAlpha())<1&&P.setClearColor(16777215,.5),P.clear();var o=P.toneMapping;P.toneMapping=gi,We(e,n,r),ue.updateMultisampleRenderTarget(Q),ue.updateRenderTargetMipmap(Q);for(var s=!1,l=0,u=t.length;l<u;l++){var c=t[l],h=c.object,d=c.geometry,f=c.material,p=c.group;if(f.side===Lr&&h.layers.test(r.layers)){var m=f.side;f.side=Cr,f.needsUpdate=!0,qe(h,n,r,d,f,p),f.side=m,f.needsUpdate=!0,s=!0}}!0===s&&(ue.updateMultisampleRenderTarget(Q),ue.updateRenderTargetMipmap(Q)),P.setRenderTarget(a),P.setClearColor(z,F),P.toneMapping=o}}(i,a,t,n),r&&oe.viewport(N.copy(r)),i.length>0&&We(i,t,n),a.length>0&&We(a,t,n),o.length>0&&We(o,t,n),oe.buffers.depth.setTest(!0),oe.buffers.depth.setMask(!0),oe.buffers.color.setMask(!0),oe.setPolygonOffset(!1)}function We(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,l=o.geometry,u=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&qe(s,t,n,l,u,c)}}function qe(e,t,n,r,i,a){e.onBeforeRender(P,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(P,t,n,r,e,a),!0===i.transparent&&i.side===Lr&&!1===i.forceSinglePass?(i.side=Cr,i.needsUpdate=!0,P.renderBufferDirect(n,t,r,i,e,a),i.side=Rr,i.needsUpdate=!0,P.renderBufferDirect(n,t,r,i,e,a),i.side=Lr):P.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(P,t,n,r,i,a)}function Xe(e,t,n){!0!==t.isScene&&(t=ne);var r=le.get(e),i=M.state.lights,a=M.state.shadowsArray,o=i.state.version,s=me.getParameters(e,i.state,a,t,n),l=me.getProgramCacheKey(s),u=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?he:ce).get(e.envMap||r.environment),void 0===u&&(e.addEventListener("dispose",Be),u=new Map,r.programs=u);var c=u.get(l);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===o)return Ke(e,s),c}else s.uniforms=me.getUniforms(e),e.onBuild(n,s,P),e.onBeforeCompile(s,P),c=me.acquireProgram(s,l),u.set(l,c),r.uniforms=s.uniforms;var h=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=be.uniform),Ke(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=c,r.uniformsList=null,c}function Ye(e){if(null===e.uniformsList){var t=e.currentProgram.getUniforms();e.uniformsList=wd.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Ke(e,t){var n=le.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}je.setAnimationLoop((function(e){ze&&ze(e)})),"undefined"!=typeof self&&je.setContext(self),this.setAnimationLoop=function(e){ze=e,Ie.setAnimationLoop(e),null===e?je.stop():je.start()},Ie.addEventListener("sessionstart",Fe),Ie.addEventListener("sessionend",He),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==R){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Ie.enabled&&!0===Ie.isPresenting&&(!0===Ie.cameraAutoUpdate&&Ie.updateCamera(t),t=Ie.getCamera()),!0===e.isScene&&e.onBeforeRender(P,e,t,I),(M=ye.get(e,k.length)).init(),k.push(M),$.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),K.setFromProjectionMatrix($),Z=this.localClippingEnabled,J=be.init(this.clippingPlanes,Z),(S=ge.get(e,A.length)).init(),A.push(S),Ge(e,t,0,P.sortObjects),S.finish(),!0===P.sortObjects&&S.sort(V,W),this.info.render.frame++,!0===J&&be.beginShadows();var n=M.state.shadowsArray;if(xe.render(n,e,t),!0===J&&be.endShadows(),!0===this.info.autoReset&&this.info.reset(),we.render(S,e),M.setupLights(P._useLegacyLights),t.isArrayCamera)for(var r=t.cameras,i=0,a=r.length;i<a;i++){var o=r[i];Ve(S,e,o,o.viewport)}else Ve(S,e,t);null!==I&&(ue.updateMultisampleRenderTarget(I),ue.updateRenderTargetMipmap(I)),!0===e.isScene&&e.onAfterRender(P,e,t),Me.resetDefaultState(),O=-1,D=null,k.pop(),M=k.length>0?k[k.length-1]:null,A.pop(),S=A.length>0?A[A.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return C},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return I},this.setRenderTargetTextures=function(e,t,n){le.get(e.texture).__webglTexture=t,le.get(e.depthTexture).__webglTexture=n;var r=le.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===ie.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){var n=le.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;I=e,C=t,L=n;var r=!0,i=null,a=!1,o=!1;if(e){var s=le.get(e);void 0!==s.__useDefaultFramebuffer?(oe.bindFramebuffer(ke.FRAMEBUFFER,null),r=!1):void 0===s.__webglFramebuffer?ue.setupRenderTarget(e):s.__hasExternalTextures&&ue.rebindTextures(e,le.get(e.texture).__webglTexture,le.get(e.depthTexture).__webglTexture);var l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);var u=le.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(u[t])?u[t][n]:u[t],a=!0):i=ae.isWebGL2&&e.samples>0&&!1===ue.useMultisampledRTT(e)?le.get(e).__webglMultisampledFramebuffer:Array.isArray(u)?u[n]:u,N.copy(e.viewport),B.copy(e.scissor),U=e.scissorTest}else N.copy(q).multiplyScalar(G).floor(),B.copy(X).multiplyScalar(G).floor(),U=Y;if(oe.bindFramebuffer(ke.FRAMEBUFFER,i)&&ae.drawBuffers&&r&&oe.drawBuffers(e,i),oe.viewport(N),oe.scissor(B),oe.setScissorTest(U),a){var c=le.get(e.texture);ke.framebufferTexture2D(ke.FRAMEBUFFER,ke.COLOR_ATTACHMENT0,ke.TEXTURE_CUBE_MAP_POSITIVE_X+t,c.__webglTexture,n)}else if(o){var h=le.get(e.texture),d=t||0;ke.framebufferTextureLayer(ke.FRAMEBUFFER,ke.COLOR_ATTACHMENT0,h.__webglTexture,n||0,d)}O=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=le.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){oe.bindFramebuffer(ke.FRAMEBUFFER,s);try{var l=e.texture,u=l.format,c=l.type;if(u!==ra&&Se.convert(u)!==ke.getParameter(ke.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var h=c===Qi&&(ie.has("EXT_color_buffer_half_float")||ae.isWebGL2&&ie.has("EXT_color_buffer_float"));if(!(c===Wi||Se.convert(c)===ke.getParameter(ke.IMPLEMENTATION_COLOR_READ_TYPE)||c===Zi&&(ae.isWebGL2||ie.has("OES_texture_float")||ie.has("WEBGL_color_buffer_float"))||h))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ke.readPixels(t,n,r,i,Se.convert(u),Se.convert(c),a)}finally{var d=null!==I?le.get(I).__webglFramebuffer:null;oe.bindFramebuffer(ke.FRAMEBUFFER,d)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r);ue.setTexture2D(t,0),ke.copyTexSubImage2D(ke.TEXTURE_2D,n,0,0,e.x,e.y,i,a),oe.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,a=t.image.height,o=Se.convert(n.format),s=Se.convert(n.type);ue.setTexture2D(n,0),ke.pixelStorei(ke.UNPACK_FLIP_Y_WEBGL,n.flipY),ke.pixelStorei(ke.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),ke.pixelStorei(ke.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?ke.texSubImage2D(ke.TEXTURE_2D,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?ke.compressedTexSubImage2D(ke.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ke.texSubImage2D(ke.TEXTURE_2D,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ke.generateMipmap(ke.TEXTURE_2D),oe.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(P.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,u=Se.convert(r.format),c=Se.convert(r.type);if(r.isData3DTexture)ue.setTexture3D(r,0),a=ke.TEXTURE_3D;else{if(!r.isDataArrayTexture&&!r.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ue.setTexture2DArray(r,0),a=ke.TEXTURE_2D_ARRAY}ke.pixelStorei(ke.UNPACK_FLIP_Y_WEBGL,r.flipY),ke.pixelStorei(ke.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),ke.pixelStorei(ke.UNPACK_ALIGNMENT,r.unpackAlignment);var h=ke.getParameter(ke.UNPACK_ROW_LENGTH),d=ke.getParameter(ke.UNPACK_IMAGE_HEIGHT),f=ke.getParameter(ke.UNPACK_SKIP_PIXELS),p=ke.getParameter(ke.UNPACK_SKIP_ROWS),m=ke.getParameter(ke.UNPACK_SKIP_IMAGES),v=n.isCompressedTexture?n.mipmaps[i]:n.image;ke.pixelStorei(ke.UNPACK_ROW_LENGTH,v.width),ke.pixelStorei(ke.UNPACK_IMAGE_HEIGHT,v.height),ke.pixelStorei(ke.UNPACK_SKIP_PIXELS,e.min.x),ke.pixelStorei(ke.UNPACK_SKIP_ROWS,e.min.y),ke.pixelStorei(ke.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isData3DTexture?ke.texSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,c,v.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ke.compressedTexSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,v.data)):ke.texSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,c,v),ke.pixelStorei(ke.UNPACK_ROW_LENGTH,h),ke.pixelStorei(ke.UNPACK_IMAGE_HEIGHT,d),ke.pixelStorei(ke.UNPACK_SKIP_PIXELS,f),ke.pixelStorei(ke.UNPACK_SKIP_ROWS,p),ke.pixelStorei(ke.UNPACK_SKIP_IMAGES,m),0===i&&r.generateMipmaps&&ke.generateMipmap(a),oe.unbindTexture()}},this.initTexture=function(e){e.isCubeTexture?ue.setTextureCube(e,0):e.isData3DTexture?ue.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ue.setTexture2DArray(e,0):ue.setTexture2D(e,0),oe.unbindTexture()},this.resetState=function(){C=0,L=0,I=null,oe.reset(),Me.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}return gr(e,[{key:"coordinateSystem",get:function(){return rs}},{key:"outputColorSpace",get:function(){return this._outputColorSpace},set:function(e){this._outputColorSpace=e;var t=this.getContext();t.drawingBufferColorSpace=e===mo?"display-p3":"srgb",t.unpackColorSpace=Os.workingColorSpace===vo?"display-p3":"srgb"}},{key:"outputEncoding",get:function(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===fo?oo:ao},set:function(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===oo?fo:po}},{key:"useLegacyLights",get:function(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights},set:function(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}]),e}(),mf=function(e){function t(){return mr(this,t),or(this,t,arguments)}return cr(t,e),gr(t)}(pf);mf.prototype.isWebGL1Renderer=!0;var vf,gf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;mr(this,e),this.isFogExp2=!0,this.name="",this.color=new vu(t),this.density=n}return gr(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}]),e}(),yf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;mr(this,e),this.isFog=!0,this.name="",this.color=new vu(t),this.near=n,this.far=r}return gr(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}]),e}(),bf=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isScene=!0,e.type="Scene",e.background=null,e.environment=null,e.fog=null,e.backgroundBlurriness=0,e.backgroundIntensity=1,e.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:ur(e)})),e}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(n.object.backgroundIntensity=this.backgroundIntensity),n}}]),t}($l),xf=function(){function e(t,n){mr(this,e),this.isInterleavedBuffer=!0,this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=Wo,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=cs()}return gr(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"updateRange",get:function(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"addUpdateRange",value:function(e,t){this.updateRanges.push({start:e,count:t})}},{key:"clearUpdateRanges",value:function(){this.updateRanges.length=0}},{key:"copy",value:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"clone",value:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cs()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"toJSON",value:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cs()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),e}(),wf=new Qs,_f=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];mr(this,e),this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=i}return gr(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.data.count;t<n;t++)wf.fromBufferAttribute(this,t),wf.applyMatrix4(e),this.setXYZ(t,wf.x,wf.y,wf.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)wf.fromBufferAttribute(this,t),wf.applyNormalMatrix(e),this.setXYZ(t,wf.x,wf.y,wf.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)wf.fromBufferAttribute(this,t),wf.transformDirection(e),this.setXYZ(t,wf.x,wf.y,wf.z);return this}},{key:"setX",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}},{key:"setY",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}},{key:"setZ",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}},{key:"setW",value:function(e,t){return this.normalized&&(t=gs(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}},{key:"getX",value:function(e){var t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=vs(t,this.array)),t}},{key:"getY",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=vs(t,this.array)),t}},{key:"getZ",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=vs(t,this.array)),t}},{key:"getW",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=vs(t,this.array)),t}},{key:"setXY",value:function(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array),r=gs(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=gs(t,this.array),n=gs(n,this.array),r=gs(r,this.array),i=gs(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}},{key:"clone",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,a=0;a<this.itemSize;a++)n.push(this.data.array[i+a]);return new ku(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),e}(),Ef=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isSpriteMaterial=!0,n.type="SpriteMaterial",n.color=new vu(16777215),n.map=null,n.alphaMap=null,n.rotation=0,n.sizeAttenuation=!0,n.transparent=!0,n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}]),t}(bu),Tf=new Qs,Sf=new Qs,Mf=new Qs,Af=new bs,kf=new bs,Pf=new kl,Rf=new Qs,Cf=new Qs,Lf=new Qs,If=new bs,Of=new bs,Df=new bs,Nf=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ef;if(mr(this,t),(e=or(this,t)).isSprite=!0,e.type="Sprite",void 0===vf){vf=new qu;var r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new xf(r,5);vf.setIndex([0,1,2,0,2,3]),vf.setAttribute("position",new _f(i,3,0,!1)),vf.setAttribute("uv",new _f(i,2,3,!1))}return e.geometry=vf,e.material=n,e.center=new bs(.5,.5),e}return cr(t,e),gr(t,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Sf.setFromMatrixScale(this.matrixWorld),Pf.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Mf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Sf.multiplyScalar(-Mf.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;Bf(Rf.set(-.5,-.5,0),Mf,a,Sf,n,r),Bf(Cf.set(.5,-.5,0),Mf,a,Sf,n,r),Bf(Lf.set(.5,.5,0),Mf,a,Sf,n,r),If.set(0,0),Of.set(1,0),Df.set(1,1);var o=e.ray.intersectTriangle(Rf,Cf,Lf,!1,Tf);if(null!==o||(Bf(Cf.set(-.5,.5,0),Mf,a,Sf,n,r),Of.set(0,1),null!==(o=e.ray.intersectTriangle(Rf,Lf,Cf,!1,Tf)))){var s=e.ray.origin.distanceTo(Tf);s<e.near||s>e.far||t.push({distance:s,point:Tf.clone(),uv:hu.getInterpolation(Tf,Rf,Cf,Lf,If,Of,Df,new bs),face:null,object:this})}}},{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),t}($l);function Bf(e,t,n,r,i,a){Af.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(kf.x=a*Af.x-i*Af.y,kf.y=i*Af.x+a*Af.y):kf.copy(Af),e.copy(t),e.x+=kf.x,e.y+=kf.y,e.applyMatrix4(Pf)}var Uf=new Qs,zf=new Qs,Ff=function(e){function t(){var e;return mr(this,t),(e=or(this,t))._currentLevel=0,e.type="LOD",Object.defineProperties(ur(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return cr(t,e),gr(t,[{key:"copy",value:function(e){tr(lr(t.prototype),"copy",this).call(this,e,!1);for(var n=e.levels,r=0,i=n.length;r<i;r++){var a=n[r];this.addLevel(a.object.clone(),a.distance,a.hysteresis)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.abs(t);var r,i=this.levels;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r;n++){var i=t[n].distance;if(t[n].object.visible&&(i-=i*t[n].hysteresis),e<i)break}return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){Uf.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Uf);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){Uf.setFromMatrixPosition(e.matrixWorld),zf.setFromMatrixPosition(this.matrixWorld);var n,r,i=Uf.distanceTo(zf)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r;n++){var a=t[n].distance;if(t[n].object.visible&&(a-=a*t[n].hysteresis),!(i>=a))break;t[n-1].object.visible=!1,t[n].object.visible=!0}for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(n.object.autoUpdate=!1),n.object.levels=[];for(var r=this.levels,i=0,a=r.length;i<a;i++){var o=r[i];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}]),t}($l),Hf=new Qs,jf=new Gs,Gf=new Gs,Vf=new Qs,Wf=new kl,qf=new Qs,Xf=new bl,Yf=new kl,Kf=new Al,Jf=function(e){function t(e,n){var r;return mr(this,t),(r=or(this,t,[e,n])).isSkinnedMesh=!0,r.type="SkinnedMesh",r.bindMode=Ti,r.bindMatrix=new kl,r.bindMatrixInverse=new kl,r.boundingBox=null,r.boundingSphere=null,r}return cr(t,e),gr(t,[{key:"computeBoundingBox",value:function(){var e=this.geometry;null===this.boundingBox&&(this.boundingBox=new tl),this.boundingBox.makeEmpty();for(var t=e.getAttribute("position"),n=0;n<t.count;n++)this.getVertexPosition(n,qf),this.boundingBox.expandByPoint(qf)}},{key:"computeBoundingSphere",value:function(){var e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new bl),this.boundingSphere.makeEmpty();for(var t=e.getAttribute("position"),n=0;n<t.count;n++)this.getVertexPosition(n,qf),this.boundingSphere.expandByPoint(qf)}},{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}},{key:"raycast",value:function(e,t){var n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),Xf.copy(this.boundingSphere),Xf.applyMatrix4(r),!1!==e.ray.intersectsSphere(Xf)&&(Yf.copy(r).invert(),Kf.copy(e.ray).applyMatrix4(Yf),null!==this.boundingBox&&!1===Kf.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,Kf)))}},{key:"getVertexPosition",value:function(e,n){return tr(lr(t.prototype),"getVertexPosition",this).call(this,e,n),this.applyBoneTransform(e,n),n}},{key:"bind",value:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var e=new Gs,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}},{key:"updateMatrixWorld",value:function(e){tr(lr(t.prototype),"updateMatrixWorld",this).call(this,e),this.bindMode===Ti?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Si?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"applyBoneTransform",value:function(e,t){var n=this.skeleton,r=this.geometry;jf.fromBufferAttribute(r.attributes.skinIndex,e),Gf.fromBufferAttribute(r.attributes.skinWeight,e),Hf.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a=Gf.getComponent(i);if(0!==a){var o=jf.getComponent(i);Wf.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Vf.copy(Hf).applyMatrix4(Wf),a)}}return t.applyMatrix4(this.bindMatrixInverse)}},{key:"boneTransform",value:function(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}]),t}(cc),Zf=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isBone=!0,e.type="Bone",e}return cr(t,e),gr(t)}($l),Qf=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Di,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Di,d=arguments.length>10?arguments[10]:void 0,f=arguments.length>11?arguments[11]:void 0;return mr(this,t),(e=or(this,t,[null,s,l,u,c,h,a,o,d,f])).isDataTexture=!0,e.image={data:n,width:r,height:i},e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return cr(t,e),gr(t)}(js),$f=new kl,ep=new kl,tp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];mr(this,e),this.uuid=cs(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}return gr(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new kl)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new kl;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:ep;$f.multiplyMatrices(o,t[i]),$f.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"computeBoneTexture",value:function(){var e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);var t=new Float32Array(e*e*4);t.set(this.boneMatrices);var n=new Qf(t,e,e,ra,Zi);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],a=t[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new Zf),this.bones.push(a),this.boneInverses.push((new kl).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var a=t[r];e.bones.push(a.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),np=function(e){function t(e,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return mr(this,t),(i=or(this,t,[e,n,r])).isInstancedBufferAttribute=!0,i.meshPerAttribute=a,i}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}]),t}(ku),rp=new kl,ip=new kl,ap=[],op=new tl,sp=new kl,lp=new cc,up=new bl,cp=function(e){function t(e,n,r){var i;mr(this,t),(i=or(this,t,[e,n])).isInstancedMesh=!0,i.instanceMatrix=new np(new Float32Array(16*r),16),i.instanceColor=null,i.count=r,i.boundingBox=null,i.boundingSphere=null;for(var a=0;a<r;a++)i.setMatrixAt(a,sp);return i}return cr(t,e),gr(t,[{key:"computeBoundingBox",value:function(){var e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new tl),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(var n=0;n<t;n++)this.getMatrixAt(n,rp),op.copy(e.boundingBox).applyMatrix4(rp),this.boundingBox.union(op)}},{key:"computeBoundingSphere",value:function(){var e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new bl),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(var n=0;n<t;n++)this.getMatrixAt(n,rp),up.copy(e.boundingSphere).applyMatrix4(rp),this.boundingSphere.union(up)}},{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}},{key:"getColorAt",value:function(e,t){t.fromArray(this.instanceColor.array,3*e)}},{key:"getMatrixAt",value:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)}},{key:"raycast",value:function(e,t){var n=this.matrixWorld,r=this.count;if(lp.geometry=this.geometry,lp.material=this.material,void 0!==lp.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),up.copy(this.boundingSphere),up.applyMatrix4(n),!1!==e.ray.intersectsSphere(up)))for(var i=0;i<r;i++){this.getMatrixAt(i,rp),ip.multiplyMatrices(n,rp),lp.matrixWorld=ip,lp.raycast(e,ap);for(var a=0,o=ap.length;a<o;a++){var s=ap[a];s.instanceId=i,s.object=this,t.push(s)}ap.length=0}}},{key:"setColorAt",value:function(e,t){null===this.instanceColor&&(this.instanceColor=new np(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}},{key:"setMatrixAt",value:function(e,t){t.toArray(this.instanceMatrix.array,16*e)}},{key:"updateMorphTargets",value:function(){}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),t}(cc);function hp(e,t){return e.z-t.z}function dp(e,t){return t.z-e.z}var fp=function(){function e(){mr(this,e),this.index=0,this.pool=[],this.list=[]}return gr(e,[{key:"push",value:function(e,t){var n=this.pool,r=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});var i=n[this.index];r.push(i),this.index++,i.start=e.start,i.count=e.count,i.z=t}},{key:"reset",value:function(){this.list.length=0,this.index=0}}]),e}(),pp="batchId",mp=new kl,vp=new kl,gp=new kl,yp=new kl,bp=new Rc,xp=new tl,wp=new bl,_p=new Qs,Ep=new fp,Tp=new cc,Sp=[];function Mp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor)for(var i=e.count,a=0;a<i;a++)for(var o=0;o<r;o++)t.setComponent(a+n,o,e.getComponent(a,o));else t.array.set(e.array,n*r);t.needsUpdate=!0}var Ap=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*n,a=arguments.length>3?arguments[3]:void 0;return mr(this,t),(r=or(this,t,[new qu,a])).isBatchedMesh=!0,r.perObjectFrustumCulled=!0,r.sortObjects=!0,r.boundingBox=null,r.boundingSphere=null,r.customSort=null,r._drawRanges=[],r._reservedRanges=[],r._visibility=[],r._active=[],r._bounds=[],r._maxGeometryCount=e,r._maxVertexCount=n,r._maxIndexCount=i,r._geometryInitialized=!1,r._geometryCount=0,r._multiDrawCounts=new Int32Array(e),r._multiDrawStarts=new Int32Array(e),r._multiDrawCount=0,r._visibilityChanged=!0,r._matricesTexture=null,r._initMatricesTexture(),r}return cr(t,e),gr(t,[{key:"maxGeometryCount",get:function(){return this._maxGeometryCount}},{key:"_initMatricesTexture",value:function(){var e=Math.sqrt(4*this._maxGeometryCount);e=4*Math.ceil(e/4),e=Math.max(e,4);var t=new Float32Array(e*e*4),n=new Qf(t,e,e,ra,Zi);this._matricesTexture=n}},{key:"_initializeGeometry",value:function(e){var t=this.geometry,n=this._maxVertexCount,r=this._maxGeometryCount,i=this._maxIndexCount;if(!1===this._geometryInitialized){for(var a in e.attributes){var o=e.getAttribute(a),s=o.array,l=o.itemSize,u=o.normalized,c=new s.constructor(n*l),h=new o.constructor(c,l,u);h.setUsage(o.usage),t.setAttribute(a,h)}if(null!==e.getIndex()){var d=n>65536?new Uint32Array(i):new Uint16Array(i);t.setIndex(new ku(d,1))}var f=r>65536?new Uint32Array(n):new Uint16Array(n);t.setAttribute(pp,new ku(f,1)),this._geometryInitialized=!0}}},{key:"_validateGeometry",value:function(e){if(e.getAttribute(pp))throw new Error('BatchedMesh: Geometry cannot use attribute "'.concat(pp,'"'));var t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('BatchedMesh: All geometries must consistently have "index".');for(var n in t.attributes)if(n!==pp){if(!e.hasAttribute(n))throw new Error('BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));var r=e.getAttribute(n),i=t.getAttribute(n);if(r.itemSize!==i.itemSize||r.normalized!==i.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}},{key:"setCustomSort",value:function(e){return this.customSort=e,this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new tl);var e=this._geometryCount,t=this.boundingBox,n=this._active;t.makeEmpty();for(var r=0;r<e;r++)!1!==n[r]&&(this.getMatrixAt(r,mp),this.getBoundingBoxAt(r,xp).applyMatrix4(mp),t.union(xp))}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new bl);var e=this._geometryCount,t=this.boundingSphere,n=this._active;t.makeEmpty();for(var r=0;r<e;r++)!1!==n[r]&&(this.getMatrixAt(r,mp),this.getBoundingSphereAt(r,wp).applyMatrix4(mp),t.union(wp))}},{key:"addGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");var r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1},i=null,a=this._reservedRanges,o=this._drawRanges,s=this._bounds;0!==this._geometryCount&&(i=a[a.length-1]),r.vertexCount=-1===t?e.getAttribute("position").count:t,r.vertexStart=null===i?0:i.vertexStart+i.vertexCount;var l=e.getIndex(),u=null!==l;if(u&&(r.indexCount=-1===n?l.count:n,r.indexStart=null===i?0:i.indexStart+i.indexCount),-1!==r.indexStart&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");var c=this._visibility,h=this._active,d=this._matricesTexture,f=this._matricesTexture.image.data;c.push(!0),h.push(!0);var p=this._geometryCount;this._geometryCount++,gp.toArray(f,16*p),d.needsUpdate=!0,a.push(r),o.push({start:u?r.indexStart:r.vertexStart,count:-1}),s.push({boxInitialized:!1,box:new tl,sphereInitialized:!1,sphere:new bl});for(var m=this.geometry.getAttribute(pp),v=0;v<r.vertexCount;v++)m.setX(r.vertexStart+v,p);return m.needsUpdate=!0,this.setGeometryAt(p,e),p}},{key:"setGeometryAt",value:function(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);var n=this.geometry,r=null!==n.getIndex(),i=n.getIndex(),a=t.getIndex(),o=this._reservedRanges[e];if(r&&a.count>o.indexCount||t.attributes.position.count>o.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");var s=o.vertexStart,l=o.vertexCount;for(var u in n.attributes)if(u!==pp){var c=t.getAttribute(u),h=n.getAttribute(u);Mp(c,h,s);for(var d=c.itemSize,f=c.count,p=l;f<p;f++)for(var m=s+f,v=0;v<d;v++)h.setComponent(m,v,0);h.needsUpdate=!0}if(r){for(var g=o.indexStart,y=0;y<a.count;y++)i.setX(g+y,s+a.getX(y));for(var b=a.count,x=o.indexCount;b<x;b++)i.setX(g+b,s);i.needsUpdate=!0}var w=this._bounds[e];null!==t.boundingBox?(w.box.copy(t.boundingBox),w.boxInitialized=!0):w.boxInitialized=!1,null!==t.boundingSphere?(w.sphere.copy(t.boundingSphere),w.sphereInitialized=!0):w.sphereInitialized=!1;var _=this._drawRanges[e],E=t.getAttribute("position");return _.count=r?a.count:E.count,this._visibilityChanged=!0,e}},{key:"deleteGeometry",value:function(e){var t=this._active;return e>=t.length||!1===t[e]||(t[e]=!1,this._visibilityChanged=!0),this}},{key:"getBoundingBoxAt",value:function(e,t){if(!1===this._active[e])return this;var n=this._bounds[e],r=n.box,i=this.geometry;if(!1===n.boxInitialized){r.makeEmpty();for(var a=i.index,o=i.attributes.position,s=this._drawRanges[e],l=s.start,u=s.start+s.count;l<u;l++){var c=l;a&&(c=a.getX(c)),r.expandByPoint(_p.fromBufferAttribute(o,c))}n.boxInitialized=!0}return t.copy(r),t}},{key:"getBoundingSphereAt",value:function(e,t){if(!1===this._active[e])return this;var n=this._bounds[e],r=n.sphere,i=this.geometry;if(!1===n.sphereInitialized){r.makeEmpty(),this.getBoundingBoxAt(e,xp),xp.getCenter(r.center);for(var a=i.index,o=i.attributes.position,s=this._drawRanges[e],l=0,u=s.start,c=s.start+s.count;u<c;u++){var h=u;a&&(h=a.getX(h)),_p.fromBufferAttribute(o,h),l=Math.max(l,r.center.distanceToSquared(_p))}r.radius=Math.sqrt(l),n.sphereInitialized=!0}return t.copy(r),t}},{key:"setMatrixAt",value:function(e,t){var n=this._active,r=this._matricesTexture,i=this._matricesTexture.image.data;return e>=this._geometryCount||!1===n[e]||(t.toArray(i,16*e),r.needsUpdate=!0),this}},{key:"getMatrixAt",value:function(e,t){var n=this._active,r=this._matricesTexture.image.data;return e>=this._geometryCount||!1===n[e]?null:t.fromArray(r,16*e)}},{key:"setVisibleAt",value:function(e,t){var n=this._visibility,r=this._active;return e>=this._geometryCount||!1===r[e]||n[e]===t||(n[e]=t,this._visibilityChanged=!0),this}},{key:"getVisibleAt",value:function(e){var t=this._visibility,n=this._active;return!(e>=this._geometryCount||!1===n[e])&&t[e]}},{key:"raycast",value:function(e,t){var n=this._visibility,r=this._active,i=this._drawRanges,a=this._geometryCount,o=this.matrixWorld,s=this.geometry;Tp.material=this.material,Tp.geometry.index=s.index,Tp.geometry.attributes=s.attributes,null===Tp.geometry.boundingBox&&(Tp.geometry.boundingBox=new tl),null===Tp.geometry.boundingSphere&&(Tp.geometry.boundingSphere=new bl);for(var l=0;l<a;l++)if(n[l]&&r[l]){var u=i[l];Tp.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(l,Tp.matrixWorld).premultiply(o),this.getBoundingBoxAt(l,Tp.geometry.boundingBox),this.getBoundingSphereAt(l,Tp.geometry.boundingSphere),Tp.raycast(e,Sp);for(var c=0,h=Sp.length;c<h;c++){var d=Sp[c];d.object=this,d.batchId=l,t.push(d)}Sp.length=0}Tp.material=null,Tp.geometry.index=null,Tp.geometry.attributes={},Tp.geometry.setDrawRange(0,1/0)}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map((function(e){return Jn({},e)})),this._reservedRanges=e._reservedRanges.map((function(e){return Jn({},e)})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map((function(e){return{boxInitialized:e.boxInitialized,box:e.box.clone(),sphereInitialized:e.sphereInitialized,sphere:e.sphere.clone()}})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}},{key:"dispose",value:function(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}},{key:"onBeforeRender",value:function(e,t,n,r,i){if(this._visibilityChanged||this.perObjectFrustumCulled||this.sortObjects){var a=r.getIndex(),o=null===a?1:a.array.BYTES_PER_ELEMENT,s=this._visibility,l=this._multiDrawStarts,u=this._multiDrawCounts,c=this._drawRanges,h=this.perObjectFrustumCulled;h&&(yp.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),bp.setFromProjectionMatrix(yp,e.isWebGPURenderer?is:rs));var d=0;if(this.sortObjects){vp.copy(this.matrixWorld).invert(),_p.setFromMatrixPosition(n.matrixWorld).applyMatrix4(vp);for(var f=0,p=s.length;f<p;f++)if(s[f]){this.getMatrixAt(f,mp),this.getBoundingSphereAt(f,wp).applyMatrix4(mp);var m=!1;if(h&&(m=!bp.intersectsSphere(wp)),!m){var v=_p.distanceTo(wp.center);Ep.push(c[f],v)}}var g=Ep.list,y=this.customSort;null===y?g.sort(i.transparent?dp:hp):y.call(this,g,n);for(var b=0,x=g.length;b<x;b++){var w=g[b];l[d]=w.start*o,u[d]=w.count,d++}Ep.reset()}else for(var _=0,E=s.length;_<E;_++)if(s[_]){var T=!1;if(h&&(this.getMatrixAt(_,mp),this.getBoundingSphereAt(_,wp).applyMatrix4(mp),T=!bp.intersectsSphere(wp)),!T){var S=c[_];l[d]=S.start*o,u[d]=S.count,d++}}this._multiDrawCount=d,this._visibilityChanged=!1}}},{key:"onBeforeShadow",value:function(e,t,n,r,i,a){this.onBeforeRender(e,null,r,i,a)}}]),t}(cc),kp=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isLineBasicMaterial=!0,n.type="LineBasicMaterial",n.color=new vu(16777215),n.map=null,n.linewidth=1,n.linecap="round",n.linejoin="round",n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}]),t}(bu),Pp=new Qs,Rp=new Qs,Cp=new kl,Lp=new Al,Ip=new bl,Op=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qu,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new kp;return mr(this,t),(e=or(this,t)).isLine=!0,e.type="Line",e.geometry=n,e.material=r,e.updateMorphTargets(),e}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)Pp.fromBufferAttribute(t,r-1),Rp.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Pp.distanceTo(Rp);e.setAttribute("lineDistance",new Bu(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ip.copy(n.boundingSphere),Ip.applyMatrix4(r),Ip.radius+=i,!1!==e.ray.intersectsSphere(Ip)){Cp.copy(r).invert(),Lp.copy(e.ray).applyMatrix4(Cp);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new Qs,u=new Qs,c=new Qs,h=new Qs,d=this.isLineSegments?2:1,f=n.index,p=n.attributes.position;if(null!==f)for(var m=Math.max(0,a.start),v=Math.min(f.count,a.start+a.count)-1;m<v;m+=d){var g=f.getX(m),y=f.getX(m+1);if(l.fromBufferAttribute(p,g),u.fromBufferAttribute(p,y),!(Lp.distanceSqToSegment(l,u,h,c)>s)){h.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(h);b<e.near||b>e.far||t.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else for(var x=Math.max(0,a.start),w=Math.min(p.count,a.start+a.count)-1;x<w;x+=d)if(l.fromBufferAttribute(p,x),u.fromBufferAttribute(p,x+1),!(Lp.distanceSqToSegment(l,u,h,c)>s)){h.applyMatrix4(this.matrixWorld);var _=e.ray.origin.distanceTo(h);_<e.near||_>e.far||t.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}]),t}($l),Dp=new Qs,Np=new Qs,Bp=function(e){function t(e,n){var r;return mr(this,t),(r=or(this,t,[e,n])).isLineSegments=!0,r.type="LineSegments",r}return cr(t,e),gr(t,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Dp.fromBufferAttribute(t,r),Np.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Dp.distanceTo(Np);e.setAttribute("lineDistance",new Bu(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}]),t}(Op),Up=function(e){function t(e,n){var r;return mr(this,t),(r=or(this,t,[e,n])).isLineLoop=!0,r.type="LineLoop",r}return cr(t,e),gr(t)}(Op),zp=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isPointsMaterial=!0,n.type="PointsMaterial",n.color=new vu(16777215),n.map=null,n.alphaMap=null,n.size=1,n.sizeAttenuation=!0,n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}]),t}(bu),Fp=new kl,Hp=new Al,jp=new bl,Gp=new Qs,Vp=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qu,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new zp;return mr(this,t),(e=or(this,t)).isPoints=!0,e.type="Points",e.geometry=n,e.material=r,e.updateMorphTargets(),e}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),jp.copy(n.boundingSphere),jp.applyMatrix4(r),jp.radius+=i,!1!==e.ray.intersectsSphere(jp)){Fp.copy(r).invert(),Hp.copy(e.ray).applyMatrix4(Fp);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=n.index,u=n.attributes.position;if(null!==l)for(var c=Math.max(0,a.start),h=Math.min(l.count,a.start+a.count);c<h;c++){var d=l.getX(c);Gp.fromBufferAttribute(u,d),Wp(Gp,d,s,r,e,t,this)}else for(var f=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);f<p;f++)Gp.fromBufferAttribute(u,f),Wp(Gp,f,s,r,e,t,this)}}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}]),t}($l);function Wp(e,t,n,r,i,a,o){var s=Hp.distanceSqToPoint(e);if(s<n){var l=new Qs;Hp.closestPointToPoint(e,l),l.applyMatrix4(r);var u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:t,face:null,object:o})}}var qp=function(e){function t(e,n,r,i,a,o,s,l,u){var c;mr(this,t),(c=or(this,t,[e,n,r,i,a,o,s,l,u])).isVideoTexture=!0,c.minFilter=void 0!==o?o:Fi,c.magFilter=void 0!==a?a:Fi,c.generateMipmaps=!1;var h=ur(c);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){h.needsUpdate=!0,e.requestVideoFrameCallback(t)})),c}return cr(t,e),gr(t,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),t}(js),Xp=function(e){function t(e,n){var r;return mr(this,t),(r=or(this,t,[{width:e,height:n}])).isFramebufferTexture=!0,r.magFilter=Di,r.minFilter=Di,r.generateMipmaps=!1,r.needsUpdate=!0,r}return cr(t,e),gr(t)}(js),Yp=function(e){function t(e,n,r,i,a,o,s,l,u,c,h,d){var f;return mr(this,t),(f=or(this,t,[null,o,s,l,u,c,i,a,h,d])).isCompressedTexture=!0,f.image={width:n,height:r},f.mipmaps=e,f.flipY=!1,f.generateMipmaps=!1,f}return cr(t,e),gr(t)}(js),Kp=function(e){function t(e,n,r,i,a,o){var s;return mr(this,t),(s=or(this,t,[e,n,r,a,o])).isCompressedArrayTexture=!0,s.image.depth=i,s.wrapR=Ii,s}return cr(t,e),gr(t)}(Yp),Jp=function(e){function t(e,n,r){var i;return mr(this,t),(i=or(this,t,[void 0,e[0].width,e[0].height,n,r,Ai])).isCompressedCubeTexture=!0,i.isCubeTexture=!0,i.image=e,i}return cr(t,e),gr(t)}(Yp),Zp=function(e){function t(e,n,r,i,a,o,s,l,u){var c;return mr(this,t),(c=or(this,t,[e,n,r,i,a,o,s,l,u])).isCanvasTexture=!0,c.needsUpdate=!0,c}return cr(t,e),gr(t)}(js),Qp=function(){function e(){mr(this,e),this.type="Curve",this.arcLengthDivisions=200}return gr(e,[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)}},{key:"getPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}},{key:"getLength",value:function(){var e=this.getLengths();return e[e.length-1]}},{key:"getLengths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(a-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(a-1)}},{key:"getTangent",value:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new bs:new Qs);return s.copy(o).sub(a).normalize(),s}},{key:"getTangentAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)}},{key:"computeFrenetFrames",value:function(e,t){for(var n=new Qs,r=[],i=[],a=[],o=new Qs,s=new kl,l=0;l<=e;l++){var u=l/e;r[l]=this.getTangentAt(u,new Qs)}i[0]=new Qs,a[0]=new Qs;var c=Number.MAX_VALUE,h=Math.abs(r[0].x),d=Math.abs(r[0].y),f=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),f<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var p=1;p<=e;p++){if(i[p]=i[p-1].clone(),a[p]=a[p-1].clone(),o.crossVectors(r[p-1],r[p]),o.length()>Number.EPSILON){o.normalize();var m=Math.acos(hs(r[p-1].dot(r[p]),-1,1));i[p].applyMatrix4(s.makeRotationAxis(o,m))}a[p].crossVectors(r[p],i[p])}if(!0===t){var v=Math.acos(hs(i[0].dot(i[e]),-1,1));v/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(v=-v);for(var g=1;g<=e;g++)i[g].applyMatrix4(s.makeRotationAxis(r[g],v*g)),a[g].crossVectors(r[g],i[g])}return{tangents:r,normals:i,binormals:a}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}},{key:"fromJSON",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}]),e}(),$p=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return mr(this,t),(e=or(this,t)).isEllipseCurve=!0,e.type="EllipseCurve",e.aX=n,e.aY=r,e.xRadius=i,e.yRadius=a,e.aStartAngle=o,e.aEndAngle=s,e.aClockwise=l,e.aRotation=u,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e,t){for(var n=t||new bs,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,d=l-this.aY;s=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(s,l)}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),t}(Qp),em=function(e){function t(e,n,r,i,a,o){var s;return mr(this,t),(s=or(this,t,[e,n,r,r,i,a,o])).isArcCurve=!0,s.type="ArcCurve",s}return cr(t,e),gr(t)}($p);function tm(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var l=(t-e)/a-(n-e)/(a+o)+(n-t)/o,u=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,l*=o,u*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}var nm=new Qs,rm=new tm,im=new tm,am=new tm,om=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return mr(this,t),(e=or(this,t)).isCatmullRomCurve3=!0,e.type="CatmullRomCurve3",e.points=n,e.closed=r,e.curveType=i,e.tension=a,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs,i=this.points,a=i.length,o=(a-(this.closed?0:1))*e,s=Math.floor(o),l=o-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/a)+1)*a:0===l&&s===a-1&&(s=a-2,l=1),this.closed||s>0?t=i[(s-1)%a]:(nm.subVectors(i[0],i[1]).add(i[0]),t=nm);var u=i[s%a],c=i[(s+1)%a];if(this.closed||s+2<a?n=i[(s+2)%a]:(nm.subVectors(i[a-1],i[a-2]).add(i[a-1]),n=nm),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,d=Math.pow(t.distanceToSquared(u),h),f=Math.pow(u.distanceToSquared(c),h),p=Math.pow(c.distanceToSquared(n),h);f<1e-4&&(f=1),d<1e-4&&(d=f),p<1e-4&&(p=f),rm.initNonuniformCatmullRom(t.x,u.x,c.x,n.x,d,f,p),im.initNonuniformCatmullRom(t.y,u.y,c.y,n.y,d,f,p),am.initNonuniformCatmullRom(t.z,u.z,c.z,n.z,d,f,p)}else"catmullrom"===this.curveType&&(rm.initCatmullRom(t.x,u.x,c.x,n.x,this.tension),im.initCatmullRom(t.y,u.y,c.y,n.y,this.tension),am.initCatmullRom(t.z,u.z,c.z,n.z,this.tension));return r.set(rm.calc(l),im.calc(l),am.calc(l)),r}},{key:"copy",value:function(e){tr(lr(t.prototype),"copy",this).call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);e.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){tr(lr(t.prototype),"fromJSON",this).call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push((new Qs).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),t}(Qp);function sm(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function lm(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function um(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}var cm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new bs,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new bs,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new bs;return mr(this,t),(e=or(this,t)).isCubicBezierCurve=!0,e.type="CubicBezierCurve",e.v0=n,e.v1=r,e.v2=i,e.v3=a,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(um(e,n.x,r.x,i.x,a.x),um(e,n.y,r.y,i.y,a.y)),t}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),t}(Qp),hm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Qs,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Qs;return mr(this,t),(e=or(this,t)).isCubicBezierCurve3=!0,e.type="CubicBezierCurve3",e.v0=n,e.v1=r,e.v2=i,e.v3=a,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(um(e,n.x,r.x,i.x,a.x),um(e,n.y,r.y,i.y,a.y),um(e,n.z,r.z,i.z,a.z)),t}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),t}(Qp),dm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new bs,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs;return mr(this,t),(e=or(this,t)).isLineCurve=!0,e.type="LineCurve",e.v1=n,e.v2=r,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs).subVectors(this.v2,this.v1).normalize()}},{key:"getTangentAt",value:function(e,t){return this.getTangent(e,t)}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),t}(Qp),fm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs;return mr(this,t),(e=or(this,t)).isLineCurve3=!0,e.type="LineCurve3",e.v1=n,e.v2=r,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs).subVectors(this.v2,this.v1).normalize()}},{key:"getTangentAt",value:function(e,t){return this.getTangent(e,t)}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),t}(Qp),pm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new bs,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new bs;return mr(this,t),(e=or(this,t)).isQuadraticBezierCurve=!0,e.type="QuadraticBezierCurve",e.v0=n,e.v1=r,e.v2=i,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs,n=this.v0,r=this.v1,i=this.v2;return t.set(lm(e,n.x,r.x,i.x),lm(e,n.y,r.y,i.y)),t}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),t}(Qp),mm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Qs;return mr(this,t),(e=or(this,t)).isQuadraticBezierCurve3=!0,e.type="QuadraticBezierCurve3",e.v0=n,e.v1=r,e.v2=i,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs,n=this.v0,r=this.v1,i=this.v2;return t.set(lm(e,n.x,r.x,i.x),lm(e,n.y,r.y,i.y),lm(e,n.z,r.z,i.z)),t}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),t}(Qp),vm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return mr(this,t),(e=or(this,t)).isSplineCurve=!0,e.type="SplineCurve",e.points=n,e}return cr(t,e),gr(t,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs,n=this.points,r=(n.length-1)*e,i=Math.floor(r),a=r-i,o=n[0===i?i:i-1],s=n[i],l=n[i>n.length-2?n.length-1:i+1],u=n[i>n.length-3?n.length-1:i+2];return t.set(sm(a,o.x,s.x,l.x,u.x),sm(a,o.y,s.y,l.y,u.y)),t}},{key:"copy",value:function(e){tr(lr(t.prototype),"copy",this).call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);e.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){tr(lr(t.prototype),"fromJSON",this).call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push((new bs).fromArray(i))}return this}}]),t}(Qp),gm=Object.freeze({__proto__:null,ArcCurve:em,CatmullRomCurve3:om,CubicBezierCurve:cm,CubicBezierCurve3:hm,EllipseCurve:$p,LineCurve:dm,LineCurve3:fm,QuadraticBezierCurve:pm,QuadraticBezierCurve3:mm,SplineCurve:vm}),ym=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return cr(t,e),gr(t,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){var n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new gm[n](t,e))}return this}},{key:"getPoint",value:function(e,t){for(var n=e*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=n){var a=r[i]-n,o=this.curves[i],s=o.getLength(),l=0===s?0:1-a/s;return o.getPointAt(l,t)}i++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a.isEllipseCurve?2*t:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];e&&e.equals(u)||(n.push(u),e=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){tr(lr(t.prototype),"copy",this).call(this,e),this.curves=[];for(var n=0,r=e.curves.length;n<r;n++){var i=e.curves[n];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var n=0,r=this.curves.length;n<r;n++){var i=this.curves[n];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){tr(lr(t.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var n=0,r=e.curves.length;n<r;n++){var i=e.curves[n];this.curves.push((new gm[i.type]).fromJSON(i))}return this}}]),t}(Qp),bm=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).type="Path",n.currentPoint=new bs,e&&n.setFromPoints(e),n}return cr(t,e),gr(t,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new dm(this.currentPoint.clone(),new bs(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var i=new pm(this.currentPoint.clone(),new bs(e,t),new bs(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){var o=new cm(this.currentPoint.clone(),new bs(e,t),new bs(n,r),new bs(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new vm(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}},{key:"absarc",value:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}},{key:"ellipse",value:function(e,t,n,r,i,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,r,i,a,o,s),this}},{key:"absellipse",value:function(e,t,n,r,i,a,o,s){var l=new $p(e,t,n,r,i,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);return this.currentPoint.copy(c),this}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return tr(lr(t.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),t}(ym),xm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new bs(0,-.5),new bs(.5,0),new bs(0,.5)],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;mr(this,t),(e=or(this,t)).type="LatheGeometry",e.parameters={points:n,segments:r,phiStart:i,phiLength:a},r=Math.floor(r),a=hs(a,0,2*Math.PI);for(var o=[],s=[],l=[],u=[],c=[],h=1/r,d=new Qs,f=new bs,p=new Qs,m=new Qs,v=new Qs,g=0,y=0,b=0;b<=n.length-1;b++)switch(b){case 0:g=n[b+1].x-n[b].x,y=n[b+1].y-n[b].y,p.x=1*y,p.y=-g,p.z=0*y,v.copy(p),p.normalize(),u.push(p.x,p.y,p.z);break;case n.length-1:u.push(v.x,v.y,v.z);break;default:g=n[b+1].x-n[b].x,y=n[b+1].y-n[b].y,p.x=1*y,p.y=-g,p.z=0*y,m.copy(p),p.x+=v.x,p.y+=v.y,p.z+=v.z,p.normalize(),u.push(p.x,p.y,p.z),v.copy(m)}for(var x=0;x<=r;x++)for(var w=i+x*h*a,_=Math.sin(w),E=Math.cos(w),T=0;T<=n.length-1;T++){d.x=n[T].x*_,d.y=n[T].y,d.z=n[T].x*E,s.push(d.x,d.y,d.z),f.x=x/r,f.y=T/(n.length-1),l.push(f.x,f.y);var S=u[3*T+0]*_,M=u[3*T+1],A=u[3*T+0]*E;c.push(S,M,A)}for(var k=0;k<r;k++)for(var P=0;P<n.length-1;P++){var R=P+k*n.length,C=R,L=R+n.length,I=R+n.length+1,O=R+1;o.push(C,L,O),o.push(I,O,L)}return e.setIndex(o),e.setAttribute("position",new Bu(s,3)),e.setAttribute("uv",new Bu(l,2)),e.setAttribute("normal",new Bu(c,3)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.points,e.segments,e.phiStart,e.phiLength)}}]),t}(qu),wm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;mr(this,t);var o=new bm;return o.absarc(0,-r/2,n,1.5*Math.PI,0),o.absarc(0,r/2,n,0,.5*Math.PI),(e=or(this,t,[o.getPoints(i),a])).type="CapsuleGeometry",e.parameters={radius:n,length:r,capSegments:i,radialSegments:a},e}return cr(t,e),gr(t,null,[{key:"fromJSON",value:function(e){return new t(e.radius,e.length,e.capSegments,e.radialSegments)}}]),t}(xm),_m=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;mr(this,t),(e=or(this,t)).type="CircleGeometry",e.parameters={radius:n,segments:r,thetaStart:i,thetaLength:a},r=Math.max(3,r);var o=[],s=[],l=[],u=[],c=new Qs,h=new bs;s.push(0,0,0),l.push(0,0,1),u.push(.5,.5);for(var d=0,f=3;d<=r;d++,f+=3){var p=i+d/r*a;c.x=n*Math.cos(p),c.y=n*Math.sin(p),s.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(s[f]/n+1)/2,h.y=(s[f+1]/n+1)/2,u.push(h.x,h.y)}for(var m=1;m<=r;m++)o.push(m,m+1,0);return e.setIndex(o),e.setAttribute("position",new Bu(s,3)),e.setAttribute("normal",new Bu(l,3)),e.setAttribute("uv",new Bu(u,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.radius,e.segments,e.thetaStart,e.thetaLength)}}]),t}(qu),Em=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;mr(this,t),(e=or(this,t)).type="CylinderGeometry",e.parameters={radiusTop:n,radiusBottom:r,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:u};var c=ur(e);a=Math.floor(a),o=Math.floor(o);var h=[],d=[],f=[],p=[],m=0,v=[],g=i/2,y=0;function b(e){for(var t=m,i=new bs,o=new Qs,s=0,v=!0===e?n:r,b=!0===e?1:-1,x=1;x<=a;x++)d.push(0,g*b,0),f.push(0,b,0),p.push(.5,.5),m++;for(var w=m,_=0;_<=a;_++){var E=_/a*u+l,T=Math.cos(E),S=Math.sin(E);o.x=v*S,o.y=g*b,o.z=v*T,d.push(o.x,o.y,o.z),f.push(0,b,0),i.x=.5*T+.5,i.y=.5*S*b+.5,p.push(i.x,i.y),m++}for(var M=0;M<a;M++){var A=t+M,k=w+M;!0===e?h.push(k,k+1,A):h.push(k+1,k,A),s+=3}c.addGroup(y,s,!0===e?1:2),y+=s}return function(){for(var e=new Qs,t=new Qs,s=0,b=(r-n)/i,x=0;x<=o;x++){for(var w=[],_=x/o,E=_*(r-n)+n,T=0;T<=a;T++){var S=T/a,M=S*u+l,A=Math.sin(M),k=Math.cos(M);t.x=E*A,t.y=-_*i+g,t.z=E*k,d.push(t.x,t.y,t.z),e.set(A,b,k).normalize(),f.push(e.x,e.y,e.z),p.push(S,1-_),w.push(m++)}v.push(w)}for(var P=0;P<a;P++)for(var R=0;R<o;R++){var C=v[R][P],L=v[R+1][P],I=v[R+1][P+1],O=v[R][P+1];h.push(C,L,O),h.push(L,I,O),s+=6}c.addGroup(y,s,0),y+=s}(),!1===s&&(n>0&&b(!0),r>0&&b(!1)),e.setIndex(h),e.setAttribute("position",new Bu(d,3)),e.setAttribute("normal",new Bu(f,3)),e.setAttribute("uv",new Bu(p,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),t}(qu),Tm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return mr(this,t),(e=or(this,t,[0,n,r,i,a,o,s,l])).type="ConeGeometry",e.parameters={radius:n,height:r,radialSegments:i,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l},e}return cr(t,e),gr(t,null,[{key:"fromJSON",value:function(e){return new t(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),t}(Em),Sm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;mr(this,t),(e=or(this,t)).type="PolyhedronGeometry",e.parameters={vertices:n,indices:r,radius:i,detail:a};var o=[],s=[];function l(e,t,n,r){for(var i=r+1,a=[],o=0;o<=i;o++){a[o]=[];for(var s=e.clone().lerp(n,o/i),l=t.clone().lerp(n,o/i),c=i-o,h=0;h<=c;h++)a[o][h]=0===h&&o===i?s:s.clone().lerp(l,h/c)}for(var d=0;d<i;d++)for(var f=0;f<2*(i-d)-1;f++){var p=Math.floor(f/2);f%2==0?(u(a[d][p+1]),u(a[d+1][p]),u(a[d][p])):(u(a[d][p+1]),u(a[d+1][p+1]),u(a[d+1][p]))}}function u(e){o.push(e.x,e.y,e.z)}function c(e,t){var r=3*e;t.x=n[r+0],t.y=n[r+1],t.z=n[r+2]}function h(e,t,n,r){r<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=r/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}return function(e){for(var t=new Qs,n=new Qs,i=new Qs,a=0;a<r.length;a+=3)c(r[a+0],t),c(r[a+1],n),c(r[a+2],i),l(t,n,i,e)}(a),function(e){for(var t=new Qs,n=0;n<o.length;n+=3)t.x=o[n+0],t.y=o[n+1],t.z=o[n+2],t.normalize().multiplyScalar(e),o[n+0]=t.x,o[n+1]=t.y,o[n+2]=t.z}(i),function(){for(var e=new Qs,t=0;t<o.length;t+=3){e.x=o[t+0],e.y=o[t+1],e.z=o[t+2];var n=d(e)/2/Math.PI+.5,r=(i=e,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);s.push(n,1-r)}var i;(function(){for(var e=new Qs,t=new Qs,n=new Qs,r=new Qs,i=new bs,a=new bs,l=new bs,u=0,c=0;u<o.length;u+=9,c+=6){e.set(o[u+0],o[u+1],o[u+2]),t.set(o[u+3],o[u+4],o[u+5]),n.set(o[u+6],o[u+7],o[u+8]),i.set(s[c+0],s[c+1]),a.set(s[c+2],s[c+3]),l.set(s[c+4],s[c+5]),r.copy(e).add(t).add(n).divideScalar(3);var f=d(r);h(i,c+0,e,f),h(a,c+2,t,f),h(l,c+4,n,f)}})(),function(){for(var e=0;e<s.length;e+=6){var t=s[e+0],n=s[e+2],r=s[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),r<.2&&(s[e+4]+=1))}}()}(),e.setAttribute("position",new Bu(o,3)),e.setAttribute("normal",new Bu(o.slice(),3)),e.setAttribute("uv",new Bu(s,2)),0===a?e.computeVertexNormals():e.normalizeNormals(),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.vertices,e.indices,e.radius,e.details)}}]),t}(qu),Mm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;mr(this,t);var i=(1+Math.sqrt(5))/2,a=1/i;return(e=or(this,t,[[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-i,0,-a,i,0,a,-i,0,a,i,-a,-i,0,-a,i,0,a,-i,0,a,i,0,-i,0,-a,i,0,-a,-i,0,a,i,0,a],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],n,r])).type="DodecahedronGeometry",e.parameters={radius:n,detail:r},e}return cr(t,e),gr(t,null,[{key:"fromJSON",value:function(e){return new t(e.radius,e.detail)}}]),t}(Sm),Am=new Qs,km=new Qs,Pm=new Qs,Rm=new hu,Cm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(mr(this,t),(e=or(this,t)).type="EdgesGeometry",e.parameters={geometry:n,thresholdAngle:r},null!==n){for(var i=Math.pow(10,4),a=Math.cos(ls*r),o=n.getIndex(),s=n.getAttribute("position"),l=o?o.count:s.count,u=[0,0,0],c=["a","b","c"],h=new Array(3),d={},f=[],p=0;p<l;p+=3){o?(u[0]=o.getX(p),u[1]=o.getX(p+1),u[2]=o.getX(p+2)):(u[0]=p,u[1]=p+1,u[2]=p+2);var m=Rm.a,v=Rm.b,g=Rm.c;if(m.fromBufferAttribute(s,u[0]),v.fromBufferAttribute(s,u[1]),g.fromBufferAttribute(s,u[2]),Rm.getNormal(Pm),h[0]="".concat(Math.round(m.x*i),",").concat(Math.round(m.y*i),",").concat(Math.round(m.z*i)),h[1]="".concat(Math.round(v.x*i),",").concat(Math.round(v.y*i),",").concat(Math.round(v.z*i)),h[2]="".concat(Math.round(g.x*i),",").concat(Math.round(g.y*i),",").concat(Math.round(g.z*i)),h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(var y=0;y<3;y++){var b=(y+1)%3,x=h[y],w=h[b],_=Rm[c[y]],E=Rm[c[b]],T="".concat(x,"_").concat(w),S="".concat(w,"_").concat(x);S in d&&d[S]?(Pm.dot(d[S].normal)<=a&&(f.push(_.x,_.y,_.z),f.push(E.x,E.y,E.z)),d[S]=null):T in d||(d[T]={index0:u[y],index1:u[b],normal:Pm.clone()})}}for(var M in d)if(d[M]){var A=d[M],k=A.index0,P=A.index1;Am.fromBufferAttribute(s,k),km.fromBufferAttribute(s,P),f.push(Am.x,Am.y,Am.z),f.push(km.x,km.y,km.z)}e.setAttribute("position",new Bu(f,3))}return e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}]),t}(qu),Lm=function(e){function t(e){var n;return mr(this,t),(n=or(this,t,[e])).uuid=cs(),n.type="Shape",n.holes=[],n}return cr(t,e),gr(t,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){tr(lr(t.prototype),"copy",this).call(this,e),this.holes=[];for(var n=0,r=e.holes.length;n<r;n++){var i=e.holes[n];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var n=0,r=this.holes.length;n<r;n++){var i=this.holes[n];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){tr(lr(t.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var n=0,r=e.holes.length;n<r;n++){var i=e.holes[n];this.holes.push((new bm).fromJSON(i))}return this}}]),t}(bm);function Im(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=ev(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=ev(a,e[a],e[a+1],o);return o&&Ym(o,o.next)&&(tv(o),o=o.next),o}function Om(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Ym(r,r.next)&&0!==Xm(r.prev,r,r.next))r=r.next;else{if(tv(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Dm(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{0===i.z&&(i.z=Gm(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,l,u=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,u*=2}while(o>1)}(i)}(e,r,i,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?Bm(e,r,i,a):Nm(e))t.push(s.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),tv(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?Dm(e=Um(Om(e),t,n),t,n,r,i,a,2):2===o&&zm(e,t,n,r,i,a):Dm(Om(e),t,n,r,i,a,1);break}}}function Nm(e){var t=e.prev,n=e,r=e.next;if(Xm(t,n,r)>=0)return!1;for(var i=t.x,a=n.x,o=r.x,s=t.y,l=n.y,u=r.y,c=i<a?i<o?i:o:a<o?a:o,h=s<l?s<u?s:u:l<u?l:u,d=i>a?i>o?i:o:a>o?a:o,f=s>l?s>u?s:u:l>u?l:u,p=r.next;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=h&&p.y<=f&&Wm(i,s,a,l,o,u,p.x,p.y)&&Xm(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Bm(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Xm(i,a,o)>=0)return!1;for(var s=i.x,l=a.x,u=o.x,c=i.y,h=a.y,d=o.y,f=s<l?s<u?s:u:l<u?l:u,p=c<h?c<d?c:d:h<d?h:d,m=s>l?s>u?s:u:l>u?l:u,v=c>h?c>d?c:d:h>d?h:d,g=Gm(f,p,t,n,r),y=Gm(m,v,t,n,r),b=e.prevZ,x=e.nextZ;b&&b.z>=g&&x&&x.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=v&&b!==i&&b!==o&&Wm(s,c,l,h,u,d,b.x,b.y)&&Xm(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==i&&x!==o&&Wm(s,c,l,h,u,d,x.x,x.y)&&Xm(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;b&&b.z>=g;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=v&&b!==i&&b!==o&&Wm(s,c,l,h,u,d,b.x,b.y)&&Xm(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==i&&x!==o&&Wm(s,c,l,h,u,d,x.x,x.y)&&Xm(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Um(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!Ym(i,a)&&Km(i,r,r.next,a)&&Qm(i,a)&&Qm(a,i)&&(t.push(i.i/n|0),t.push(r.i/n|0),t.push(a.i/n|0),tv(r),tv(r.next),r=e=a),r=r.next}while(r!==e);return Om(r)}function zm(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&qm(o,s)){var l=$m(o,s);return o=Om(o,o.next),l=Om(l,l.next),Dm(o,t,n,r,i,a,0),void Dm(l,t,n,r,i,a,0)}s=s.next}o=o.next}while(o!==e)}function Fm(e,t){return e.x-t.x}function Hm(e,t){var n=function(e,t){var n,r=t,i=-1/0,a=e.x,o=e.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>i&&(i=s,n=r.x<r.next.x?r:r.next,s===a))return n}r=r.next}while(r!==t);if(!n)return null;var l,u=n,c=n.x,h=n.y,d=1/0;r=n;do{a>=r.x&&r.x>=c&&a!==r.x&&Wm(o<h?a:i,o,c,h,o<h?i:a,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(a-r.x),Qm(r,e)&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&jm(n,r)))&&(n=r,d=l)),r=r.next}while(r!==u);return n}(e,t);if(!n)return t;var r=$m(n,e);return Om(r,r.next),Om(n,n.next)}function jm(e,t){return Xm(e.prev,e,t.prev)<0&&Xm(t.next,e,e.next)<0}function Gm(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Vm(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Wm(e,t,n,r,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(r-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function qm(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Km(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Qm(e,t)&&Qm(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Xm(e.prev,e,t.prev)||Xm(e,t.prev,t))||Ym(e,t)&&Xm(e.prev,e,e.next)>0&&Xm(t.prev,t,t.next)>0)}function Xm(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Ym(e,t){return e.x===t.x&&e.y===t.y}function Km(e,t,n,r){var i=Zm(Xm(e,t,n)),a=Zm(Xm(e,t,r)),o=Zm(Xm(n,r,e)),s=Zm(Xm(n,r,t));return i!==a&&o!==s||!(0!==i||!Jm(e,n,t))||!(0!==a||!Jm(e,r,t))||!(0!==o||!Jm(n,e,r))||!(0!==s||!Jm(n,t,r))}function Jm(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Zm(e){return e>0?1:e<0?-1:0}function Qm(e,t){return Xm(e.prev,e,e.next)<0?Xm(e,t,e.next)>=0&&Xm(e,e.prev,t)>=0:Xm(e,t,e.prev)<0||Xm(e,e.next,t)<0}function $m(e,t){var n=new nv(e.i,e.x,e.y),r=new nv(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function ev(e,t,n,r){var i=new nv(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function tv(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function nv(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}var rv=function(){function e(){mr(this,e)}return gr(e,null,[{key:"area",value:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"triangulateShape",value:function(e,t){var n=[],r=[],i=[];iv(e),av(n,e);var a=e.length;t.forEach(iv);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,av(n,t[o]);for(var s=function(e,t){var n,r,i,a,o,s,l,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,c=t&&t.length,h=c?t[0]*u:e.length,d=Im(e,0,h,u,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=function(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=Im(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(Vm(o));for(s.sort(Fm),i=0;i<s.length;i++)n=Hm(s[i],n);return n}(e,t,d,u)),e.length>80*u){n=i=e[0],r=a=e[1];for(var p=u;p<h;p+=u)(o=e[p])<n&&(n=o),(s=e[p+1])<r&&(r=s),o>i&&(i=o),s>a&&(a=s);l=0!==(l=Math.max(i-n,a-r))?32767/l:0}return Dm(d,f,u,n,r,l,0),f}(n,r),l=0;l<s.length;l+=3)i.push(s.slice(l,l+3));return i}}]),e}();function iv(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function av(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var ov=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lm([new bs(.5,.5),new bs(-.5,.5),new bs(-.5,-.5),new bs(.5,-.5)]),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};mr(this,t),(e=or(this,t)).type="ExtrudeGeometry",e.parameters={shapes:n,options:r},n=Array.isArray(n)?n:[n];for(var i=ur(e),a=[],o=[],s=0,l=n.length;s<l;s++)u(n[s]);function u(e){var t,n,s,l,u,c=[],h=void 0!==r.curveSegments?r.curveSegments:12,d=void 0!==r.steps?r.steps:1,f=void 0!==r.depth?r.depth:1,p=void 0===r.bevelEnabled||r.bevelEnabled,m=void 0!==r.bevelThickness?r.bevelThickness:.2,v=void 0!==r.bevelSize?r.bevelSize:m-.1,g=void 0!==r.bevelOffset?r.bevelOffset:0,y=void 0!==r.bevelSegments?r.bevelSegments:3,b=r.extrudePath,x=void 0!==r.UVGenerator?r.UVGenerator:sv,w=!1;b&&(t=b.getSpacedPoints(d),w=!0,p=!1,n=b.computeFrenetFrames(d,!1),s=new Qs,l=new Qs,u=new Qs),p||(y=0,m=0,v=0,g=0);var _=e.extractPoints(h),E=_.shape,T=_.holes;if(!rv.isClockWise(E)){E=E.reverse();for(var S=0,M=T.length;S<M;S++){var A=T[S];rv.isClockWise(A)&&(T[S]=A.reverse())}}for(var k=rv.triangulateShape(E,T),P=E,R=0,C=T.length;R<C;R++){var L=T[R];E=E.concat(L)}function I(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}var O=E.length,D=k.length;function N(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),f=Math.sqrt(l*l+u*u),p=t.x-s/d,m=t.y+o/d,v=((n.x-u/f-p)*u-(n.y+l/f-m)*l)/(o*u-s*l),g=(r=p+o*v-e.x)*r+(i=m+s*v-e.y)*i;if(g<=2)return new bs(r,i);a=Math.sqrt(g/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new bs(r/a,i/a)}for(var B=[],U=0,z=P.length,F=z-1,H=U+1;U<z;U++,F++,H++)F===z&&(F=0),H===z&&(H=0),B[U]=N(P[U],P[F],P[H]);for(var j,G=[],V=B.concat(),W=0,q=T.length;W<q;W++){var X=T[W];j=[];for(var Y=0,K=X.length,J=K-1,Z=Y+1;Y<K;Y++,J++,Z++)J===K&&(J=0),Z===K&&(Z=0),j[Y]=N(X[Y],X[J],X[Z]);G.push(j),V=V.concat(j)}for(var Q=0;Q<y;Q++){for(var $=Q/y,ee=m*Math.cos($*Math.PI/2),te=v*Math.sin($*Math.PI/2)+g,ne=0,re=P.length;ne<re;ne++){var ie=I(P[ne],B[ne],te);Ce(ie.x,ie.y,-ee)}for(var ae=0,oe=T.length;ae<oe;ae++){var se=T[ae];j=G[ae];for(var le=0,ue=se.length;le<ue;le++){var ce=I(se[le],j[le],te);Ce(ce.x,ce.y,-ee)}}}for(var he=v+g,de=0;de<O;de++){var fe=p?I(E[de],V[de],he):E[de];w?(l.copy(n.normals[0]).multiplyScalar(fe.x),s.copy(n.binormals[0]).multiplyScalar(fe.y),u.copy(t[0]).add(l).add(s),Ce(u.x,u.y,u.z)):Ce(fe.x,fe.y,0)}for(var pe=1;pe<=d;pe++)for(var me=0;me<O;me++){var ve=p?I(E[me],V[me],he):E[me];w?(l.copy(n.normals[pe]).multiplyScalar(ve.x),s.copy(n.binormals[pe]).multiplyScalar(ve.y),u.copy(t[pe]).add(l).add(s),Ce(u.x,u.y,u.z)):Ce(ve.x,ve.y,f/d*pe)}for(var ge=y-1;ge>=0;ge--){for(var ye=ge/y,be=m*Math.cos(ye*Math.PI/2),xe=v*Math.sin(ye*Math.PI/2)+g,we=0,_e=P.length;we<_e;we++){var Ee=I(P[we],B[we],xe);Ce(Ee.x,Ee.y,f+be)}for(var Te=0,Se=T.length;Te<Se;Te++){var Me=T[Te];j=G[Te];for(var Ae=0,ke=Me.length;Ae<ke;Ae++){var Pe=I(Me[Ae],j[Ae],xe);w?Ce(Pe.x,Pe.y+t[d-1].y,t[d-1].x+be):Ce(Pe.x,Pe.y,f+be)}}}function Re(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var a=0,o=d+2*y;a<o;a++){var s=O*a,l=O*(a+1);Ie(t+r+s,t+i+s,t+i+l,t+r+l)}}}function Ce(e,t,n){c.push(e),c.push(t),c.push(n)}function Le(e,t,n){Oe(e),Oe(t),Oe(n);var r=a.length/3,o=x.generateTopUV(i,a,r-3,r-2,r-1);De(o[0]),De(o[1]),De(o[2])}function Ie(e,t,n,r){Oe(e),Oe(t),Oe(r),Oe(t),Oe(n),Oe(r);var o=a.length/3,s=x.generateSideWallUV(i,a,o-6,o-3,o-2,o-1);De(s[0]),De(s[1]),De(s[3]),De(s[1]),De(s[2]),De(s[3])}function Oe(e){a.push(c[3*e+0]),a.push(c[3*e+1]),a.push(c[3*e+2])}function De(e){o.push(e.x),o.push(e.y)}!function(){var e=a.length/3;if(p){for(var t=0,n=O*t,r=0;r<D;r++){var o=k[r];Le(o[2]+n,o[1]+n,o[0]+n)}n=O*(t=d+2*y);for(var s=0;s<D;s++){var l=k[s];Le(l[0]+n,l[1]+n,l[2]+n)}}else{for(var u=0;u<D;u++){var c=k[u];Le(c[2],c[1],c[0])}for(var h=0;h<D;h++){var f=k[h];Le(f[0]+O*d,f[1]+O*d,f[2]+O*d)}}i.addGroup(e,a.length/3-e,0)}(),function(){var e=a.length/3,t=0;Re(P,t),t+=P.length;for(var n=0,r=T.length;n<r;n++){var o=T[n];Re(o,t),t+=o.length}i.addGroup(e,a.length/3-e,1)}()}return e.setAttribute("position",new Bu(a,3)),e.setAttribute("uv",new Bu(o,2)),e.computeVertexNormals(),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return n.options=ar({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)}}],[{key:"fromJSON",value:function(e,n){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=n[e.shapes[i]];r.push(o)}var s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new gm[s.type]).fromJSON(s)),new t(r,e.options)}}]),t}(qu),sv={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],l=t[3*r+1],u=t[3*i],c=t[3*i+1];return[new bs(a,o),new bs(s,l),new bs(u,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*r],c=t[3*r+1],h=t[3*r+2],d=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*a],v=t[3*a+1],g=t[3*a+2];return Math.abs(s-c)<Math.abs(o-u)?[new bs(o,1-l),new bs(u,1-h),new bs(d,1-p),new bs(m,1-g)]:[new bs(s,1-l),new bs(c,1-h),new bs(f,1-p),new bs(v,1-g)]}},lv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;mr(this,t);var i=(1+Math.sqrt(5))/2;return(e=or(this,t,[[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],n,r])).type="IcosahedronGeometry",e.parameters={radius:n,detail:r},e}return cr(t,e),gr(t,null,[{key:"fromJSON",value:function(e){return new t(e.radius,e.detail)}}]),t}(Sm),uv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return mr(this,t),(e=or(this,t,[[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],n,r])).type="OctahedronGeometry",e.parameters={radius:n,detail:r},e}return cr(t,e),gr(t,null,[{key:"fromJSON",value:function(e){return new t(e.radius,e.detail)}}]),t}(Sm),cv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;mr(this,t),(e=or(this,t)).type="RingGeometry",e.parameters={innerRadius:n,outerRadius:r,thetaSegments:i,phiSegments:a,thetaStart:o,thetaLength:s},i=Math.max(3,i);for(var l=[],u=[],c=[],h=[],d=n,f=(r-n)/(a=Math.max(1,a)),p=new Qs,m=new bs,v=0;v<=a;v++){for(var g=0;g<=i;g++){var y=o+g/i*s;p.x=d*Math.cos(y),p.y=d*Math.sin(y),u.push(p.x,p.y,p.z),c.push(0,0,1),m.x=(p.x/r+1)/2,m.y=(p.y/r+1)/2,h.push(m.x,m.y)}d+=f}for(var b=0;b<a;b++)for(var x=b*(i+1),w=0;w<i;w++){var _=w+x,E=_,T=_+i+1,S=_+i+2,M=_+1;l.push(E,T,M),l.push(T,S,M)}return e.setIndex(l),e.setAttribute("position",new Bu(u,3)),e.setAttribute("normal",new Bu(c,3)),e.setAttribute("uv",new Bu(h,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}]),t}(qu),hv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lm([new bs(0,.5),new bs(-.5,-.5),new bs(.5,-.5)]),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;mr(this,t),(e=or(this,t)).type="ShapeGeometry",e.parameters={shapes:n,curveSegments:r};var i=[],a=[],o=[],s=[],l=0,u=0;if(!1===Array.isArray(n))h(n);else for(var c=0;c<n.length;c++)h(n[c]),e.addGroup(l,u,c),l+=u,u=0;function h(e){var t=a.length/3,n=e.extractPoints(r),l=n.shape,c=n.holes;!1===rv.isClockWise(l)&&(l=l.reverse());for(var h=0,d=c.length;h<d;h++){var f=c[h];!0===rv.isClockWise(f)&&(c[h]=f.reverse())}for(var p=rv.triangulateShape(l,c),m=0,v=c.length;m<v;m++){var g=c[m];l=l.concat(g)}for(var y=0,b=l.length;y<b;y++){var x=l[y];a.push(x.x,x.y,0),o.push(0,0,1),s.push(x.x,x.y)}for(var w=0,_=p.length;w<_;w++){var E=p[w],T=E[0]+t,S=E[1]+t,M=E[2]+t;i.push(T,S,M),u+=3}}return e.setIndex(i),e.setAttribute("position",new Bu(a,3)),e.setAttribute("normal",new Bu(o,3)),e.setAttribute("uv",new Bu(s,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}],[{key:"fromJSON",value:function(e,n){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=n[e.shapes[i]];r.push(o)}return new t(r,e.curveSegments)}}]),t}(qu),dv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;mr(this,t),(e=or(this,t)).type="SphereGeometry",e.parameters={radius:n,widthSegments:r,heightSegments:i,phiStart:a,phiLength:o,thetaStart:s,thetaLength:l},r=Math.max(3,Math.floor(r)),i=Math.max(2,Math.floor(i));for(var u=Math.min(s+l,Math.PI),c=0,h=[],d=new Qs,f=new Qs,p=[],m=[],v=[],g=[],y=0;y<=i;y++){var b=[],x=y/i,w=0;0===y&&0===s?w=.5/r:y===i&&u===Math.PI&&(w=-.5/r);for(var _=0;_<=r;_++){var E=_/r;d.x=-n*Math.cos(a+E*o)*Math.sin(s+x*l),d.y=n*Math.cos(s+x*l),d.z=n*Math.sin(a+E*o)*Math.sin(s+x*l),m.push(d.x,d.y,d.z),f.copy(d).normalize(),v.push(f.x,f.y,f.z),g.push(E+w,1-x),b.push(c++)}h.push(b)}for(var T=0;T<i;T++)for(var S=0;S<r;S++){var M=h[T][S+1],A=h[T][S],k=h[T+1][S],P=h[T+1][S+1];(0!==T||s>0)&&p.push(M,A,P),(T!==i-1||u<Math.PI)&&p.push(A,k,P)}return e.setIndex(p),e.setAttribute("position",new Bu(m,3)),e.setAttribute("normal",new Bu(v,3)),e.setAttribute("uv",new Bu(g,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}]),t}(qu),fv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return mr(this,t),(e=or(this,t,[[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],n,r])).type="TetrahedronGeometry",e.parameters={radius:n,detail:r},e}return cr(t,e),gr(t,null,[{key:"fromJSON",value:function(e){return new t(e.radius,e.detail)}}]),t}(Sm),pv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;mr(this,t),(e=or(this,t)).type="TorusGeometry",e.parameters={radius:n,tube:r,radialSegments:i,tubularSegments:a,arc:o},i=Math.floor(i),a=Math.floor(a);for(var s=[],l=[],u=[],c=[],h=new Qs,d=new Qs,f=new Qs,p=0;p<=i;p++)for(var m=0;m<=a;m++){var v=m/a*o,g=p/i*Math.PI*2;d.x=(n+r*Math.cos(g))*Math.cos(v),d.y=(n+r*Math.cos(g))*Math.sin(v),d.z=r*Math.sin(g),l.push(d.x,d.y,d.z),h.x=n*Math.cos(v),h.y=n*Math.sin(v),f.subVectors(d,h).normalize(),u.push(f.x,f.y,f.z),c.push(m/a),c.push(p/i)}for(var y=1;y<=i;y++)for(var b=1;b<=a;b++){var x=(a+1)*y+b-1,w=(a+1)*(y-1)+b-1,_=(a+1)*(y-1)+b,E=(a+1)*y+b;s.push(x,w,E),s.push(w,_,E)}return e.setIndex(s),e.setAttribute("position",new Bu(l,3)),e.setAttribute("normal",new Bu(u,3)),e.setAttribute("uv",new Bu(c,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}]),t}(qu),mv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;mr(this,t),(e=or(this,t)).type="TorusKnotGeometry",e.parameters={radius:n,tube:r,tubularSegments:i,radialSegments:a,p:o,q:s},i=Math.floor(i),a=Math.floor(a);for(var l=[],u=[],c=[],h=[],d=new Qs,f=new Qs,p=new Qs,m=new Qs,v=new Qs,g=new Qs,y=new Qs,b=0;b<=i;++b){var x=b/i*o*Math.PI*2;C(x,o,s,n,p),C(x+.01,o,s,n,m),g.subVectors(m,p),y.addVectors(m,p),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize();for(var w=0;w<=a;++w){var _=w/a*Math.PI*2,E=-r*Math.cos(_),T=r*Math.sin(_);d.x=p.x+(E*y.x+T*v.x),d.y=p.y+(E*y.y+T*v.y),d.z=p.z+(E*y.z+T*v.z),u.push(d.x,d.y,d.z),f.subVectors(d,p).normalize(),c.push(f.x,f.y,f.z),h.push(b/i),h.push(w/a)}}for(var S=1;S<=i;S++)for(var M=1;M<=a;M++){var A=(a+1)*(S-1)+(M-1),k=(a+1)*S+(M-1),P=(a+1)*S+M,R=(a+1)*(S-1)+M;l.push(A,k,R),l.push(k,P,R)}function C(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(s)*.5}return e.setIndex(l),e.setAttribute("position",new Bu(u,3)),e.setAttribute("normal",new Bu(c,3)),e.setAttribute("uv",new Bu(h,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}]),t}(qu),vv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new mm(new Qs(-1,-1,0),new Qs(-1,1,0),new Qs(1,1,0)),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];mr(this,t),(e=or(this,t)).type="TubeGeometry",e.parameters={path:n,tubularSegments:r,radius:i,radialSegments:a,closed:o};var s=n.computeFrenetFrames(r,o);e.tangents=s.tangents,e.normals=s.normals,e.binormals=s.binormals;var l=new Qs,u=new Qs,c=new bs,h=new Qs,d=[],f=[],p=[],m=[];function v(e){h=n.getPointAt(e/r,h);for(var t=s.normals[e],o=s.binormals[e],c=0;c<=a;c++){var p=c/a*Math.PI*2,m=Math.sin(p),v=-Math.cos(p);u.x=v*t.x+m*o.x,u.y=v*t.y+m*o.y,u.z=v*t.z+m*o.z,u.normalize(),f.push(u.x,u.y,u.z),l.x=h.x+i*u.x,l.y=h.y+i*u.y,l.z=h.z+i*u.z,d.push(l.x,l.y,l.z)}}return function(){for(var e=0;e<r;e++)v(e);v(!1===o?r:0),function(){for(var e=0;e<=r;e++)for(var t=0;t<=a;t++)c.x=e/r,c.y=t/a,p.push(c.x,c.y)}(),function(){for(var e=1;e<=r;e++)for(var t=1;t<=a;t++){var n=(a+1)*(e-1)+(t-1),i=(a+1)*e+(t-1),o=(a+1)*e+t,s=(a+1)*(e-1)+t;m.push(n,i,s),m.push(i,o,s)}}()}(),e.setIndex(m),e.setAttribute("position",new Bu(d,3)),e.setAttribute("normal",new Bu(f,3)),e.setAttribute("uv",new Bu(p,2)),e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.path=this.parameters.path.toJSON(),e}}],[{key:"fromJSON",value:function(e){return new t((new gm[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}]),t}(qu),gv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(mr(this,t),(e=or(this,t)).type="WireframeGeometry",e.parameters={geometry:n},null!==n){var r=[],i=new Set,a=new Qs,o=new Qs;if(null!==n.index){var s=n.attributes.position,l=n.index,u=n.groups;0===u.length&&(u=[{start:0,count:l.count,materialIndex:0}]);for(var c=0,h=u.length;c<h;++c)for(var d=u[c],f=d.start,p=f,m=f+d.count;p<m;p+=3)for(var v=0;v<3;v++){var g=l.getX(p+v),y=l.getX(p+(v+1)%3);a.fromBufferAttribute(s,g),o.fromBufferAttribute(s,y),!0===yv(a,o,i)&&(r.push(a.x,a.y,a.z),r.push(o.x,o.y,o.z))}}else for(var b=n.attributes.position,x=0,w=b.count/3;x<w;x++)for(var _=0;_<3;_++){var E=3*x+_,T=3*x+(_+1)%3;a.fromBufferAttribute(b,E),o.fromBufferAttribute(b,T),!0===yv(a,o,i)&&(r.push(a.x,a.y,a.z),r.push(o.x,o.y,o.z))}e.setAttribute("position",new Bu(r,3))}return e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.parameters=ar({},e.parameters),this}}]),t}(qu);function yv(e,t,n){var r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var bv=Object.freeze({__proto__:null,BoxGeometry:dc,CapsuleGeometry:wm,CircleGeometry:_m,ConeGeometry:Tm,CylinderGeometry:Em,DodecahedronGeometry:Mm,EdgesGeometry:Cm,ExtrudeGeometry:ov,IcosahedronGeometry:lv,LatheGeometry:xm,OctahedronGeometry:uv,PlaneGeometry:Ic,PolyhedronGeometry:Sm,RingGeometry:cv,ShapeGeometry:hv,SphereGeometry:dv,TetrahedronGeometry:fv,TorusGeometry:pv,TorusKnotGeometry:mv,TubeGeometry:vv,WireframeGeometry:gv}),xv=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isShadowMaterial=!0,n.type="ShadowMaterial",n.color=new vu(0),n.transparent=!0,n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.fog=e.fog,this}}]),t}(bu),wv=function(e){function t(e){var n;return mr(this,t),(n=or(this,t,[e])).isRawShaderMaterial=!0,n.type="RawShaderMaterial",n}return cr(t,e),gr(t)}(gc),_v=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshStandardMaterial=!0,n.defines={STANDARD:""},n.type="MeshStandardMaterial",n.color=new vu(16777215),n.roughness=1,n.metalness=0,n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new vu(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=uo,n.normalScale=new bs(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.roughnessMap=null,n.metalnessMap=null,n.alphaMap=null,n.envMap=null,n.envMapIntensity=1,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.flatShading=!1,n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),t}(bu),Ev=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshPhysicalMaterial=!0,n.defines={STANDARD:"",PHYSICAL:""},n.type="MeshPhysicalMaterial",n.anisotropyRotation=0,n.anisotropyMap=null,n.clearcoatMap=null,n.clearcoatRoughness=0,n.clearcoatRoughnessMap=null,n.clearcoatNormalScale=new bs(1,1),n.clearcoatNormalMap=null,n.ior=1.5,Object.defineProperty(ur(n),"reflectivity",{get:function(){return hs(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),n.iridescenceMap=null,n.iridescenceIOR=1.3,n.iridescenceThicknessRange=[100,400],n.iridescenceThicknessMap=null,n.sheenColor=new vu(0),n.sheenColorMap=null,n.sheenRoughness=1,n.sheenRoughnessMap=null,n.transmissionMap=null,n.thickness=0,n.thicknessMap=null,n.attenuationDistance=1/0,n.attenuationColor=new vu(1,1,1),n.specularIntensity=1,n.specularIntensityMap=null,n.specularColor=new vu(1,1,1),n.specularColorMap=null,n._anisotropy=0,n._clearcoat=0,n._iridescence=0,n._sheen=0,n._transmission=0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"anisotropy",get:function(){return this._anisotropy},set:function(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}},{key:"clearcoat",get:function(){return this._clearcoat},set:function(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}},{key:"iridescence",get:function(){return this._iridescence},set:function(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}},{key:"sheen",get:function(){return this._sheen},set:function(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}},{key:"transmission",get:function(){return this._transmission},set:function(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=nr(e.iridescenceThicknessRange),this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}]),t}(_v),Tv=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshPhongMaterial=!0,n.type="MeshPhongMaterial",n.color=new vu(16777215),n.specular=new vu(1118481),n.shininess=30,n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new vu(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=uo,n.normalScale=new bs(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=pi,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.flatShading=!1,n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),t}(bu),Sv=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshToonMaterial=!0,n.defines={TOON:""},n.type="MeshToonMaterial",n.color=new vu(16777215),n.map=null,n.gradientMap=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new vu(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=uo,n.normalScale=new bs(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.alphaMap=null,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}]),t}(bu),Mv=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshNormalMaterial=!0,n.type="MeshNormalMaterial",n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=uo,n.normalScale=new bs(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLinewidth=1,n.flatShading=!1,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}]),t}(bu),Av=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshLambertMaterial=!0,n.type="MeshLambertMaterial",n.color=new vu(16777215),n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new vu(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=uo,n.normalScale=new bs(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=pi,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.flatShading=!1,n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),t}(bu),kv=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isMeshMatcapMaterial=!0,n.defines={MATCAP:""},n.type="MeshMatcapMaterial",n.color=new vu(16777215),n.matcap=null,n.map=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=uo,n.normalScale=new bs(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.alphaMap=null,n.flatShading=!1,n.fog=!0,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),t}(bu),Pv=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).isLineDashedMaterial=!0,n.type="LineDashedMaterial",n.scale=1,n.dashSize=3,n.gapSize=1,n.setValues(e),n}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),t}(kp);function Rv(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function Cv(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Lv(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n}function Iv(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,l=0;l!==t;++l)i[o++]=e[s+l];return i}function Ov(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}}var Dv={convertArray:Rv,isTypedArray:Cv,getKeyframeOrder:Lv,sortedArray:Iv,flattenJSON:Ov,subclip:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],d=0;d<l.times.length;++d){var f=l.times[d]*i;if(!(f<n||f>=r)){c.push(l.times[d]);for(var p=0;p<u;++p)h.push(l.values[d*u+p])}}0!==c.length&&(l.times=Rv(c,l.times.constructor),l.values=Rv(h,l.values.constructor),o.push(l))}a.tracks=o;for(var m=1/0,v=0;v<a.tracks.length;++v)m>a.tracks[v].times[0]&&(m=a.tracks[v].times[0]);for(var g=0;g<a.tracks.length;++g)a.tracks[g].shift(-1*m);return a.resetDuration(),a},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var i=n.tracks.length,a=t/r,o=function(){var t=n.tracks[s],r=t.ValueTypeName;if("bool"===r||"string"===r)return 0;var i=e.tracks.find((function(e){return e.name===t.name&&e.ValueTypeName===r}));if(void 0===i)return 0;var o=0,l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);var u=0,c=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=c/3);var h,d=t.times.length-1;if(a<=t.times[0]){var f=o,p=l-o;h=t.values.slice(f,p)}else if(a>=t.times[d]){var m=d*l+o,v=m+l-o;h=t.values.slice(m,v)}else{var g=t.createInterpolant(),y=o,b=l-o;g.evaluate(a),h=g.resultBuffer.slice(y,b)}"quaternion"===r&&(new Zs).fromArray(h).normalize().conjugate().toArray(h);for(var x=i.times.length,w=0;w<x;++w){var _=w*c+u;if("quaternion"===r)Zs.multiplyQuaternionsFlat(i.values,_,h,0,i.values,_);else for(var E=c-2*u,T=0;T<E;++T)i.values[_+T]-=h[T]}},s=0;s<i;++s)o();return e.blendMode=to,e}},Nv=function(){function e(t,n,r,i){mr(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return gr(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var l=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var u=n+a>>>1;e<t[u]?a=u:n=u+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}(),Bv=function(e){function t(e,n,r,i){var a;return mr(this,t),(a=or(this,t,[e,n,r,i]))._weightPrev=-0,a._offsetPrev=-0,a._weightNext=-0,a._offsetNext=-0,a.DefaultSettings_={endingStart:Za,endingEnd:Za},a}return cr(t,e),gr(t,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case Qa:i=e,o=2*t-n;break;case $a:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Qa:a=e,s=2*n-t;break;case $a:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=a*u}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,v=-h*m+2*h*p-h*f,g=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p,x=0;x!==o;++x)i[x]=v*a[u+x]+g*a[l+x]+y*a[s+x]+b*a[c+x];return i}}]),t}(Nv),Uv=function(e){function t(e,n,r,i){return mr(this,t),or(this,t,[e,n,r,i])}return cr(t,e),gr(t,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=(n-t)/(r-t),c=1-u,h=0;h!==o;++h)i[h]=a[l+h]*c+a[s+h]*u;return i}}]),t}(Nv),zv=function(e){function t(e,n,r,i){return mr(this,t),or(this,t,[e,n,r,i])}return cr(t,e),gr(t,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),t}(Nv),Fv=function(){function e(t,n,r,i){if(mr(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Rv(n,this.TimeBufferType),this.values=Rv(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return gr(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new zv(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new Uv(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Bv(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case Ya:t=this.InterpolantFactoryMethodDiscrete;break;case Ka:t=this.InterpolantFactoryMethodLinear;break;case Ja:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ya;case this.InterpolantFactoryMethodLinear:return Ka;case this.InterpolantFactoryMethodSmooth:return Ja}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*o,a*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&Cv(r))for(var l=0,u=r.length;l!==u;++l){var c=r[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Ja,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==e[0]))if(r)s=!0;else for(var u=o*n,c=u-n,h=u+n,d=0;d!==n;++d){var f=t[u+d];if(f!==t[c+d]||f!==t[h+d]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var p=o*n,m=a*n,v=0;v!==n;++v)t[m+v]=t[p+v]}++a}}if(i>0){e[a]=e[i];for(var g=i*n,y=a*n,b=0;b!==n;++b)t[y+b]=t[g+b];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Rv(e.times,Array),values:Rv(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();Fv.prototype.TimeBufferType=Float32Array,Fv.prototype.ValueBufferType=Float32Array,Fv.prototype.DefaultInterpolation=Ka;var Hv=function(e){function t(){return mr(this,t),or(this,t,arguments)}return cr(t,e),gr(t)}(Fv);Hv.prototype.ValueTypeName="bool",Hv.prototype.ValueBufferType=Array,Hv.prototype.DefaultInterpolation=Ya,Hv.prototype.InterpolantFactoryMethodLinear=void 0,Hv.prototype.InterpolantFactoryMethodSmooth=void 0;var jv=function(e){function t(){return mr(this,t),or(this,t,arguments)}return cr(t,e),gr(t)}(Fv);jv.prototype.ValueTypeName="color";var Gv=function(e){function t(){return mr(this,t),or(this,t,arguments)}return cr(t,e),gr(t)}(Fv);Gv.prototype.ValueTypeName="number";var Vv=function(e){function t(e,n,r,i){return mr(this,t),or(this,t,[e,n,r,i])}return cr(t,e),gr(t,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),l=e*o,u=l+o;l!==u;l+=4)Zs.slerpFlat(i,0,a,l-o,a,l,s);return i}}]),t}(Nv),Wv=function(e){function t(){return mr(this,t),or(this,t,arguments)}return cr(t,e),gr(t,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Vv(this.times,this.values,this.getValueSize(),e)}}]),t}(Fv);Wv.prototype.ValueTypeName="quaternion",Wv.prototype.DefaultInterpolation=Ka,Wv.prototype.InterpolantFactoryMethodSmooth=void 0;var qv=function(e){function t(){return mr(this,t),or(this,t,arguments)}return cr(t,e),gr(t)}(Fv);qv.prototype.ValueTypeName="string",qv.prototype.ValueBufferType=Array,qv.prototype.DefaultInterpolation=Ya,qv.prototype.InterpolantFactoryMethodLinear=void 0,qv.prototype.InterpolantFactoryMethodSmooth=void 0;var Xv=function(e){function t(){return mr(this,t),or(this,t,arguments)}return cr(t,e),gr(t)}(Fv);Xv.prototype.ValueTypeName="vector";var Yv=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eo;mr(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=cs(),this.duration<0&&this.resetDuration()}return gr(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(Kv(n[i]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,a=n.length;i!==a;++i)t.push(Fv.toJSON(n[i]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],l=[];s.push((o+i-1)%i,o,(o+1)%i),l.push(0,1,0);var u=Lv(s);s=Iv(s,1,u),l=Iv(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),a.push(new Gv(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/n))}return new this(e,-1,a)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(i);if(l&&l.length>1){var u=l[1],c=r[u];c||(r[u]=c=[]),c.push(s)}}var h=[];for(var d in r)h.push(this.CreateFromMorphTargetSequence(d,r[d],t,n));return h}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];Ov(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[],u=0;u<l.length;u++){var c=l[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){var h={},d=void 0;for(d=0;d<c.length;d++)if(c[d].morphTargets)for(var f=0;f<c[d].morphTargets.length;f++)h[c[d].morphTargets[f]]=-1;for(var p in h){for(var m=[],v=[],g=0;g!==c[d].morphTargets.length;++g){var y=c[d];m.push(y.time),v.push(y.morphTarget===p?1:0)}r.push(new Gv(".morphTargetInfluence["+p+"]",m,v))}s=h.length*a}else{var b=".bones["+t[u].name+"]";n(Xv,b+".position",c,"pos",r),n(Wv,b+".quaternion",c,"rot",r),n(Xv,b+".scale",c,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}}]),e}();function Kv(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gv;case"vector":case"vector2":case"vector3":case"vector4":return Xv;case"color":return jv;case"quaternion":return Wv;case"bool":case"boolean":return Hv;case"string":return qv}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Ov(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var Jv={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Zv=gr((function e(t,n,r){mr(this,e);var i=this,a=!1,o=0,s=0,l=void 0,u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){var t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=u.length;t<n;t+=2){var r=u[t],i=u[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}})),Qv=new Zv,$v=function(){function e(t){mr(this,e),this.manager=void 0!==t?t:Qv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return gr(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}();$v.DEFAULT_MATERIAL_NAME="__DEFAULT";var eg,tg={},ng=function(e){function t(e,n){var r;return mr(this,t),(r=or(this,t,[e])).response=n,r}return cr(t,e),gr(t)}(Yn(Error)),rg=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this;void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=Jv.get(e);if(void 0!==a)return this.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===tg[e]){tg[e]=[],tg[e].push({onLoad:t,onProgress:n,onError:r});var o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(o).then((function(t){if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;var n=tg[e],r=t.body.getReader(),i=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),a=i?parseInt(i):0,o=0!==a,s=0,l=new ReadableStream({start:function(e){!function t(){r.read().then((function(r){var i=r.done,l=r.value;if(i)e.close();else{s+=l.byteLength;for(var u=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a}),c=0,h=n.length;c<h;c++){var d=n[c];d.onProgress&&d.onProgress(u)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new ng('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((function(e){switch(l){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((function(e){return(new DOMParser).parseFromString(e,s)}));case"json":return e.json();default:if(void 0===s)return e.text();var t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((function(e){return r.decode(e)}))}})).then((function(t){Jv.add(e,t);var n=tg[e];delete tg[e];for(var r=0,i=n.length;r<i;r++){var a=n[r];a.onLoad&&a.onLoad(t)}})).catch((function(t){var n=tg[e];if(void 0===n)throw i.manager.itemError(e),t;delete tg[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e)})).finally((function(){i.manager.itemEnd(e)})),this.manager.itemStart(e)}else tg[e].push({onLoad:t,onProgress:n,onError:r})}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"setMimeType",value:function(e){return this.mimeType=e,this}}]),t}($v),ig=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this,a=new rg(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=Yv.parse(e[n]);t.push(r)}return t}}]),t}($v),ag=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this,a=[],o=new Yp,s=new rg(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var l=0;function u(u){s.load(e[u],(function(e){var n=i.parse(e,!0);a[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=Fi),o.image=a,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(var c=0,h=e.length;c<h;++c)u(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Fi),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}]),t}($v),og=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Jv.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=Ss("img");function s(){u(),Jv.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){u(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function u(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}]),t}($v),sg=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=new _c;i.colorSpace=fo;var a=new og(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,6==++o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var l=0;l<e.length;++l)s(l);return i}}]),t}($v),lg=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this,a=new Qf,o=new rg(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n;try{n=i.parse(e)}catch(e){if(void 0===r)return void console.error(e);r(e)}void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:Ii,a.wrapT=void 0!==n.wrapT?n.wrapT:Ii,a.magFilter=void 0!==n.magFilter?n.magFilter:Fi,a.minFilter=void 0!==n.minFilter?n.minFilter:Fi,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace?a.colorSpace=n.colorSpace:void 0!==n.encoding&&(a.encoding=n.encoding),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Gi),1===n.mipmapCount&&(a.minFilter=Fi),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n)}),n,r),a}}]),t}($v),ug=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=new js,a=new og(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}]),t}($v),cg=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return mr(this,t),(n=or(this,t)).isLight=!0,n.type="Light",n.color=new vu(e),n.intensity=r,n}return cr(t,e),gr(t,[{key:"dispose",value:function(){}},{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,void 0!==this.groundColor&&(n.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(n.object.distance=this.distance),void 0!==this.angle&&(n.object.angle=this.angle),void 0!==this.decay&&(n.object.decay=this.decay),void 0!==this.penumbra&&(n.object.penumbra=this.penumbra),void 0!==this.shadow&&(n.object.shadow=this.shadow.toJSON()),n}}]),t}($l),hg=function(e){function t(e,n,r){var i;return mr(this,t),(i=or(this,t,[e,r])).isHemisphereLight=!0,i.type="HemisphereLight",i.position.copy($l.DEFAULT_UP),i.updateMatrix(),i.groundColor=new vu(n),i}return cr(t,e),gr(t,[{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.groundColor.copy(e.groundColor),this}}]),t}(cg),dg=new kl,fg=new Qs,pg=new Qs,mg=function(){function e(t){mr(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new bs(512,512),this.map=null,this.mapPass=null,this.matrix=new kl,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Rc,this._frameExtents=new bs(1,1),this._viewportCount=1,this._viewports=[new Gs(0,0,1,1)]}return gr(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;fg.setFromMatrixPosition(e.matrixWorld),t.position.copy(fg),pg.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(pg),t.updateMatrixWorld(),dg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dg),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(dg)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),vg=function(e){function t(){var e;return mr(this,t),(e=or(this,t,[new bc(50,1,.5,500)])).isSpotLightShadow=!0,e.focus=1,e}return cr(t,e),gr(t,[{key:"updateMatrices",value:function(e){var n=this.camera,r=2*us*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||n.far;r===n.fov&&i===n.aspect&&a===n.far||(n.fov=r,n.aspect=i,n.far=a,n.updateProjectionMatrix()),tr(lr(t.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),t}(mg),gg=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;return mr(this,t),(r=or(this,t,[e,n])).isSpotLight=!0,r.type="SpotLight",r.position.copy($l.DEFAULT_UP),r.updateMatrix(),r.target=new $l,r.distance=i,r.angle=a,r.penumbra=o,r.decay=s,r.map=null,r.shadow=new vg,r}return cr(t,e),gr(t,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),t}(cg),yg=new kl,bg=new Qs,xg=new Qs,wg=function(e){function t(){var e;return mr(this,t),(e=or(this,t,[new bc(90,1,.5,500)])).isPointLightShadow=!0,e._frameExtents=new bs(4,2),e._viewportCount=6,e._viewports=[new Gs(2,1,1,1),new Gs(0,1,1,1),new Gs(3,1,1,1),new Gs(1,1,1,1),new Gs(3,0,1,1),new Gs(1,0,1,1)],e._cubeDirections=[new Qs(1,0,0),new Qs(-1,0,0),new Qs(0,0,1),new Qs(0,0,-1),new Qs(0,1,0),new Qs(0,-1,0)],e._cubeUps=[new Qs(0,1,0),new Qs(0,1,0),new Qs(0,1,0),new Qs(0,1,0),new Qs(0,0,1),new Qs(0,0,-1)],e}return cr(t,e),gr(t,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),bg.setFromMatrixPosition(e.matrixWorld),n.position.copy(bg),xg.copy(n.position),xg.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(xg),n.updateMatrixWorld(),r.makeTranslation(-bg.x,-bg.y,-bg.z),yg.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(yg)}}]),t}(mg),_g=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return mr(this,t),(r=or(this,t,[e,n])).isPointLight=!0,r.type="PointLight",r.distance=i,r.decay=a,r.shadow=new wg,r}return cr(t,e),gr(t,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),t}(cg),Eg=function(e){function t(){var e;return mr(this,t),(e=or(this,t,[new Vc(-5,5,5,-5,.5,500)])).isDirectionalLightShadow=!0,e}return cr(t,e),gr(t)}(mg),Tg=function(e){function t(e,n){var r;return mr(this,t),(r=or(this,t,[e,n])).isDirectionalLight=!0,r.type="DirectionalLight",r.position.copy($l.DEFAULT_UP),r.updateMatrix(),r.target=new $l,r.shadow=new Eg,r}return cr(t,e),gr(t,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),t}(cg),Sg=function(e){function t(e,n){var r;return mr(this,t),(r=or(this,t,[e,n])).isAmbientLight=!0,r.type="AmbientLight",r}return cr(t,e),gr(t)}(cg),Mg=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return mr(this,t),(r=or(this,t,[e,n])).isRectAreaLight=!0,r.type="RectAreaLight",r.width=i,r.height=a,r}return cr(t,e),gr(t,[{key:"power",get:function(){return this.intensity*this.width*this.height*Math.PI},set:function(e){this.intensity=e/(this.width*this.height*Math.PI)}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return n.object.width=this.width,n.object.height=this.height,n}}]),t}(cg),Ag=function(){function e(){mr(this,e),this.isSphericalHarmonics3=!0,this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Qs)}return gr(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}]),e}(),kg=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ag,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return mr(this,t),(e=or(this,t,[void 0,r])).isLightProbe=!0,e.sh=n,e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return n.object.sh=this.sh.toArray(),n}}]),t}(cg),Pg=function(e){function t(e){var n;return mr(this,t),(n=or(this,t,[e])).textures={},n}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this,a=new rg(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var n=this.textures;function r(e){return void 0===n[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),n[e]}var i=t.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new vu).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(i.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(i.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(i.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(i.depthFunc=e.depthFunc),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(i.blendSrc=e.blendSrc),void 0!==e.blendDst&&(i.blendDst=e.blendDst),void 0!==e.blendEquation&&(i.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(i.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(i.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(i.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==i.blendColor&&i.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(i.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),void 0!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(i.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var a in e.uniforms){var o=e.uniforms[a];switch(i.uniforms[a]={},o.type){case"t":i.uniforms[a].value=r(o.value);break;case"c":i.uniforms[a].value=(new vu).setHex(o.value);break;case"v2":i.uniforms[a].value=(new bs).fromArray(o.value);break;case"v3":i.uniforms[a].value=(new Qs).fromArray(o.value);break;case"v4":i.uniforms[a].value=(new Gs).fromArray(o.value);break;case"m3":i.uniforms[a].value=(new xs).fromArray(o.value);break;case"m4":i.uniforms[a].value=(new kl).fromArray(o.value);break;default:i.uniforms[a].value=o.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(i.glslVersion=e.glslVersion),void 0!==e.extensions)for(var s in e.extensions)i.extensions[s]=e.extensions[s];if(void 0!==e.lights&&(i.lights=e.lights),void 0!==e.clipping&&(i.clipping=e.clipping),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=r(e.map)),void 0!==e.matcap&&(i.matcap=r(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){var l=e.normalScale;!1===Array.isArray(l)&&(l=[l,l]),i.normalScale=(new bs).fromArray(l)}return void 0!==e.displacementMap&&(i.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=r(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=r(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=r(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new bs).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=r(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=r(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=r(e.thicknessMap)),void 0!==e.anisotropyMap&&(i.anisotropyMap=r(e.anisotropyMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=r(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}},{key:"setTextures",value:function(e){return this.textures=e,this}}],[{key:"createMaterialFromType",value:function(e){return new{ShadowMaterial:xv,SpriteMaterial:Ef,RawShaderMaterial:wv,ShaderMaterial:gc,PointsMaterial:zp,MeshPhysicalMaterial:Ev,MeshStandardMaterial:_v,MeshPhongMaterial:Tv,MeshToonMaterial:Sv,MeshNormalMaterial:Mv,MeshLambertMaterial:Av,MeshDepthMaterial:ef,MeshDistanceMaterial:tf,MeshBasicMaterial:xu,MeshMatcapMaterial:kv,LineDashedMaterial:Pv,LineBasicMaterial:kp,Material:bu}[e]}}]),t}($v),Rg=function(){function e(){mr(this,e)}return gr(e,null,[{key:"decodeText",value:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}},{key:"extractUrlBase",value:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}},{key:"resolveURL",value:function(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}]),e}(),Cg=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isInstancedBufferGeometry=!0,e.type="InstancedBufferGeometry",e.instanceCount=1/0,e}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.instanceCount=e.instanceCount,this}},{key:"toJSON",value:function(){var e=tr(lr(t.prototype),"toJSON",this).call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}]),t}(qu),Lg=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this,a=new rg(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),o=Ts(i.type,a),s=new xf(o,i.stride);return s.uuid=i.uuid,t[r]=s,s}var i=e.isInstancedBufferGeometry?new Cg:new qu,a=e.data.index;if(void 0!==a){var o=Ts(a.type,a.array);i.setIndex(new ku(o,1))}var s=e.data.attributes;for(var l in s){var u=s[l],c=void 0;if(u.isInterleavedBufferAttribute){var h=r(e.data,u.data);c=new _f(h,u.itemSize,u.offset,u.normalized)}else{var d=Ts(u.type,u.array);c=new(u.isInstancedBufferAttribute?np:ku)(d,u.itemSize,u.normalized)}void 0!==u.name&&(c.name=u.name),void 0!==u.usage&&c.setUsage(u.usage),i.setAttribute(l,c)}var f=e.data.morphAttributes;if(f)for(var p in f){for(var m=f[p],v=[],g=0,y=m.length;g<y;g++){var b=m[g],x=void 0;if(b.isInterleavedBufferAttribute){var w=r(e.data,b.data);x=new _f(w,b.itemSize,b.offset,b.normalized)}else{var _=Ts(b.type,b.array);x=new ku(_,b.itemSize,b.normalized)}void 0!==b.name&&(x.name=b.name),v.push(x)}i.morphAttributes[p]=v}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var E=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==E)for(var T=0,S=E.length;T!==S;++T){var M=E[T];i.addGroup(M.start,M.count,M.materialIndex)}var A=e.data.boundingSphere;if(void 0!==A){var k=new Qs;void 0!==A.center&&k.fromArray(A.center),i.boundingSphere=new bl(k,A.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}]),t}($v),Ig=function(e){function t(e){return mr(this,t),or(this,t,[e])}var n,r,i;return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this,a=""===this.path?Rg.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new rg(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);i.parse(a,t)}),n,r)}},{key:"loadAsync",value:(i=Qn(fr().mark((function e(t,n){var r,i,a,o,s,l;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,i=""===this.path?Rg.extractUrlBase(t):this.path,this.resourcePath=this.resourcePath||i,(a=new rg(this.manager)).setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),e.next=9,a.loadAsync(t,n);case 9:if(o=e.sent,s=JSON.parse(o),void 0!==(l=s.metadata)&&void 0!==l.type&&"geometry"!==l.type.toLowerCase()){e.next=14;break}throw new Error("THREE.ObjectLoader: Can't load "+t);case 14:return e.next=16,r.parseAsync(s);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,s,o,n),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),void 0!==t){var c=!1;for(var h in a)if(a[h].data instanceof HTMLImageElement){c=!0;break}!1===c&&t(l)}return l}},{key:"parseAsync",value:(r=Qn(fr().mark((function e(t){var n,r,i,a,o,s,l,u;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),e.next=5,this.parseImagesAsync(t.images);case 5:return a=e.sent,o=this.parseTextures(t.textures,a),s=this.parseMaterials(t.materials,o),l=this.parseObject(t.object,i,s,o,n),u=this.parseSkeletons(t.skeletons,l),this.bindSkeletons(l,u),e.abrupt("return",l);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Lm).fromJSON(e[n]);t[i.uuid]=i}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=(new tp).fromJSON(e[i],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n={};if(void 0!==e)for(var r=new Lg,i=0,a=e.length;i<a;i++){var o=void 0,s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;default:s.type in bv?o=bv[s.type].fromJSON(s,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var i=new Pg;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=Yv.parse(r);t[i.uuid]=i}return t}},{key:"parseImages",value:function(e,t){var n,r=this,i={};function a(e){if("string"==typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:Ts(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var o=new Zv(t);(n=new og(o)).setCrossOrigin(this.crossOrigin);for(var s=0,l=e.length;s<l;s++){var u=e[s],c=u.url;if(Array.isArray(c)){for(var h=[],d=0,f=c.length;d<f;d++){var p=a(c[d]);null!==p&&(p instanceof HTMLImageElement?h.push(p):h.push(new Qf(p.data,p.width,p.height)))}i[u.uuid]=new zs(h)}else{var m=a(u.url);i[u.uuid]=new zs(m)}}}return i}},{key:"parseImagesAsync",value:(n=Qn(fr().mark((function e(t){var n,r,i,a,o,s,l,u,c,h,d,f,p,m,v;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(){return o=Qn(fr().mark((function e(t){var r,a;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=8;break}return a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r=t)?r:n.resourcePath+r,e.next=5,i.loadAsync(a);case 5:return e.abrupt("return",e.sent);case 8:if(!t.data){e.next=12;break}return e.abrupt("return",{data:Ts(t.type,t.data),width:t.width,height:t.height});case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)},a=function(e){return o.apply(this,arguments)},n=this,r={},!(void 0!==t&&t.length>0)){e.next=33;break}(i=new og(this.manager)).setCrossOrigin(this.crossOrigin),s=0,l=t.length;case 8:if(!(s<l)){e.next=33;break}if(u=t[s],c=u.url,!Array.isArray(c)){e.next=26;break}h=[],d=0,f=c.length;case 14:if(!(d<f)){e.next=23;break}return p=c[d],e.next=18,a(p);case 18:null!==(m=e.sent)&&(m instanceof HTMLImageElement?h.push(m):h.push(new Qf(m.data,m.width,m.height)));case 20:d++,e.next=14;break;case 23:r[u.uuid]=new zs(h),e.next=30;break;case 26:return e.next=28,a(u.url);case 28:v=e.sent,r[u.uuid]=new zs(v);case 30:s++,e.next=8;break;case 33:return e.abrupt("return",r);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=t[o.image],l=s.data,u=void 0;Array.isArray(l)?(u=new _c,6===l.length&&(u.needsUpdate=!0)):(u=l&&l.data?new Qf:new js,l&&(u.needsUpdate=!0)),u.source=s,u.uuid=o.uuid,void 0!==o.name&&(u.name=o.name),void 0!==o.mapping&&(u.mapping=n(o.mapping,Og)),void 0!==o.channel&&(u.channel=o.channel),void 0!==o.offset&&u.offset.fromArray(o.offset),void 0!==o.repeat&&u.repeat.fromArray(o.repeat),void 0!==o.center&&u.center.fromArray(o.center),void 0!==o.rotation&&(u.rotation=o.rotation),void 0!==o.wrap&&(u.wrapS=n(o.wrap[0],Dg),u.wrapT=n(o.wrap[1],Dg)),void 0!==o.format&&(u.format=o.format),void 0!==o.internalFormat&&(u.internalFormat=o.internalFormat),void 0!==o.type&&(u.type=o.type),void 0!==o.colorSpace&&(u.colorSpace=o.colorSpace),void 0!==o.encoding&&(u.encoding=o.encoding),void 0!==o.minFilter&&(u.minFilter=n(o.minFilter,Ng)),void 0!==o.magFilter&&(u.magFilter=n(o.magFilter,Ng)),void 0!==o.anisotropy&&(u.anisotropy=o.anisotropy),void 0!==o.flipY&&(u.flipY=o.flipY),void 0!==o.generateMipmaps&&(u.generateMipmaps=o.generateMipmaps),void 0!==o.premultiplyAlpha&&(u.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(u.unpackAlignment=o.unpackAlignment),void 0!==o.compareFunction&&(u.compareFunction=o.compareFunction),void 0!==o.userData&&(u.userData=o.userData),r[o.uuid]=u}return r}},{key:"parseObject",value:function(e,t,n,r,i){var a,o,s;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function c(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":a=new bf,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new vu(e.background):a.background=c(e.background)),void 0!==e.environment&&(a.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new yf(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new gf(e.fog.color,e.fog.density)),""!==e.fog.name&&(a.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":a=new bc(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=ar({},e.view));break;case"OrthographicCamera":a=new Vc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=ar({},e.view));break;case"AmbientLight":a=new Sg(e.color,e.intensity);break;case"DirectionalLight":a=new Tg(e.color,e.intensity);break;case"PointLight":a=new _g(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Mg(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new gg(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new hg(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new kg).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),s=u(e.material),a=new Jf(o,s),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),s=u(e.material),a=new cc(o,s);break;case"InstancedMesh":o=l(e.geometry),s=u(e.material);var h=e.count,d=e.instanceMatrix,f=e.instanceColor;(a=new cp(o,s,h)).instanceMatrix=new np(new Float32Array(d.array),16),void 0!==f&&(a.instanceColor=new np(new Float32Array(f.array),f.itemSize));break;case"BatchedMesh":o=l(e.geometry),s=u(e.material),(a=new Ap(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,s)).geometry=o,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map((function(e){var t=new tl;t.min.fromArray(e.boxMin),t.max.fromArray(e.boxMax);var n=new bl;return n.radius=e.sphereRadius,n.center.fromArray(e.sphereCenter),{boxInitialized:e.boxInitialized,box:t,sphereInitialized:e.sphereInitialized,sphere:n}})),a._maxGeometryCount=e.maxGeometryCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=c(e.matricesTexture.uuid);break;case"LOD":a=new Ff;break;case"Line":a=new Op(l(e.geometry),u(e.material));break;case"LineLoop":a=new Up(l(e.geometry),u(e.material));break;case"LineSegments":a=new Bp(l(e.geometry),u(e.material));break;case"PointCloud":case"Points":a=new Vp(l(e.geometry),u(e.material));break;case"Sprite":a=new Nf(u(e.material));break;case"Group":a=new lf;break;case"Bone":a=new Zf;break;default:a=new $l}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children)for(var p=e.children,m=0;m<p.length;m++)a.add(this.parseObject(p[m],t,n,r,i));if(void 0!==e.animations)for(var v=e.animations,g=0;g<v.length;g++){var y=v[g];a.animations.push(i[y])}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);for(var b=e.levels,x=0;x<b.length;x++){var w=b[x],_=a.getObjectByProperty("uuid",w.object);void 0!==_&&a.addLevel(_,w.distance,w.hysteresis)}}return a}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}}]),t}($v),Og={UVMapping:Mi,CubeReflectionMapping:Ai,CubeRefractionMapping:ki,EquirectangularReflectionMapping:Pi,EquirectangularRefractionMapping:Ri,CubeUVReflectionMapping:Ci},Dg={RepeatWrapping:Li,ClampToEdgeWrapping:Ii,MirroredRepeatWrapping:Oi},Ng={NearestFilter:Di,NearestMipmapNearestFilter:Ni,NearestMipmapLinearFilter:Ui,LinearFilter:Fi,LinearMipmapNearestFilter:Hi,LinearMipmapLinearFilter:Gi},Bg=function(e){function t(e){var n;return mr(this,t),(n=or(this,t,[e])).isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),n.options={premultiplyAlpha:"none"},n}return cr(t,e),gr(t,[{key:"setOptions",value:function(e){return this.options=e,this}},{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Jv.get(e);if(void 0!==a)return i.manager.itemStart(e),a.then?void a.then((function(n){t&&t(n),i.manager.itemEnd(e)})).catch((function(e){r&&r(e)})):(setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a);var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;var s=fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,ar(i.options,{colorSpaceConversion:"none"}))})).then((function(n){return Jv.add(e,n),t&&t(n),i.manager.itemEnd(e),n})).catch((function(t){r&&r(t),Jv.remove(e),i.manager.itemError(e),i.manager.itemEnd(e)}));Jv.add(e,s),i.manager.itemStart(e)}}]),t}($v),Ug=function(){function e(){mr(this,e)}return gr(e,null,[{key:"getContext",value:function(){return void 0===eg&&(eg=new(window.AudioContext||window.webkitAudioContext)),eg}},{key:"setContext",value:function(e){eg=e}}]),e}(),zg=function(e){function t(e){return mr(this,t),or(this,t,[e])}return cr(t,e),gr(t,[{key:"load",value:function(e,t,n,r){var i=this,a=new rg(this.manager);function o(t){r?r(t):console.error(t),i.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(e){try{var n=e.slice(0);Ug.getContext().decodeAudioData(n,(function(e){t(e)})).catch(o)}catch(e){o(e)}}),n,r)}}]),t}($v),Fg=new kl,Hg=new kl,jg=new kl,Gg=function(){function e(){mr(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new bc,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new bc,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return gr(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,jg.copy(e.projectionMatrix);var n,r,i=t.eyeSep/2,a=i*t.near/t.focus,o=t.near*Math.tan(ls*t.fov*.5)/t.zoom;Hg.elements[12]=-i,Fg.elements[12]=i,n=-o*t.aspect+a,r=o*t.aspect+a,jg.elements[0]=2*t.near/(r-n),jg.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(jg),n=-o*t.aspect-a,r=o*t.aspect-a,jg.elements[0]=2*t.near/(r-n),jg.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(jg)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Hg),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Fg)}}]),e}(),Vg=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];mr(this,e),this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return gr(e,[{key:"start",value:function(){this.startTime=Wg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=Wg();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function Wg(){return("undefined"==typeof performance?Date:performance).now()}var qg=new Qs,Xg=new Zs,Yg=new Qs,Kg=new Qs,Jg=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).type="AudioListener",e.context=Ug.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new Vg,e}return cr(t,e),gr(t,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){tr(lr(t.prototype),"updateMatrixWorld",this).call(this,e);var n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(qg,Xg,Yg),Kg.set(0,0,-1).applyQuaternion(Xg),n.positionX){var i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(qg.x,i),n.positionY.linearRampToValueAtTime(qg.y,i),n.positionZ.linearRampToValueAtTime(qg.z,i),n.forwardX.linearRampToValueAtTime(Kg.x,i),n.forwardY.linearRampToValueAtTime(Kg.y,i),n.forwardZ.linearRampToValueAtTime(Kg.z,i),n.upX.linearRampToValueAtTime(r.x,i),n.upY.linearRampToValueAtTime(r.y,i),n.upZ.linearRampToValueAtTime(r.z,i)}else n.setPosition(qg.x,qg.y,qg.z),n.setOrientation(Kg.x,Kg.y,Kg.z,r.x,r.y,r.z)}}]),t}($l),Zg=function(e){function t(e){var n;return mr(this,t),(n=or(this,t)).type="Audio",n.listener=e,n.context=e.context,n.gain=n.context.createGain(),n.gain.connect(e.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}return cr(t,e),gr(t,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),t}($l),Qg=new Qs,$g=new Zs,ey=new Qs,ty=new Qs,ny=function(e){function t(e){var n;return mr(this,t),(n=or(this,t,[e])).panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}return cr(t,e),gr(t,[{key:"connect",value:function(){tr(lr(t.prototype),"connect",this).call(this),this.panner.connect(this.gain)}},{key:"disconnect",value:function(){tr(lr(t.prototype),"disconnect",this).call(this),this.panner.disconnect(this.gain)}},{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if(tr(lr(t.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Qg,$g,ey),ty.set(0,0,1).applyQuaternion($g);var n=this.panner;if(n.positionX){var r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Qg.x,r),n.positionY.linearRampToValueAtTime(Qg.y,r),n.positionZ.linearRampToValueAtTime(Qg.z,r),n.orientationX.linearRampToValueAtTime(ty.x,r),n.orientationY.linearRampToValueAtTime(ty.y,r),n.orientationZ.linearRampToValueAtTime(ty.z,r)}else n.setPosition(Qg.x,Qg.y,Qg.z),n.setOrientation(ty.x,ty.y,ty.z)}}}]),t}(Zg),ry=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;mr(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return gr(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),iy=function(){function e(t,n,r){var i,a,o;switch(mr(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return gr(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var l=t,u=t+t;l!==u;++l)if(n[l]!==n[l+t]){o.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]}},{key:"_slerp",value:function(e,t,n,r){Zs.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,i){var a=this._workIndex*i;Zs.multiplyQuaternionsFlat(e,a,e,t,e,n),Zs.slerpFlat(e,t,e,t,e,a,r)}},{key:"_lerp",value:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,i){for(var a=0;a!==i;++a){var o=t+a;e[o]=e[o]+e[n+a]*r}}}]),e}(),ay="\\[\\]\\.:\\/",oy=new RegExp("["+ay+"]","g"),sy="[^"+ay+"]",ly="[^"+ay.replace("\\.","")+"]",uy=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",sy)+/(WCOD+)?/.source.replace("WCOD",ly)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sy)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sy)+"$"),cy=["material","materials","bones","map"],hy=function(){function e(t,n,r){mr(this,e);var i=r||dy.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return gr(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),dy=function(){function e(t,n,r){mr(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return gr(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var l=t[i];if(void 0!==l){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else void 0!==l.fromArray&&void 0!==l.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(c=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var h=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t)}}else console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(oy,"")}},{key:"parseTrackName",value:function(e){var t=uy.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==cy.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}]),e}();dy.Composite=hy,dy.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},dy.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},dy.prototype.GetterByBindingType=[dy.prototype._getValue_direct,dy.prototype._getValue_array,dy.prototype._getValue_arrayElement,dy.prototype._getValue_toArray],dy.prototype.SetterByBindingTypeAndVersioning=[[dy.prototype._setValue_direct,dy.prototype._setValue_direct_setNeedsUpdate,dy.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[dy.prototype._setValue_array,dy.prototype._setValue_array_setNeedsUpdate,dy.prototype._setValue_array_setMatrixWorldNeedsUpdate],[dy.prototype._setValue_arrayElement,dy.prototype._setValue_arrayElement_setNeedsUpdate,dy.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[dy.prototype._setValue_fromArray,dy.prototype._setValue_fromArray_setNeedsUpdate,dy.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var fy=function(){function e(){mr(this,e),this.isAnimationObjectGroup=!0,this.uuid=cs(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}return gr(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=e.length,l=this.nCachedObjects_,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,f=t[d];if(void 0===f){f=s++,t[d]=f,e.push(h);for(var p=0,m=a;p!==m;++p)i[p].push(new dy(h,n[p],r[p]))}else if(f<l){o=e[f];var v=--l,g=e[v];t[g.uuid]=f,e[f]=g,t[d]=v,e[v]=h;for(var y=0,b=a;y!==b;++y){var x=i[y],w=x[v],_=x[f];x[f]=w,void 0===_&&(_=new dy(h,n[y],r[y])),x[v]=_}}else e[f]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=t[l];if(void 0!==u&&u>=i){var c=i++,h=e[c];t[h.uuid]=u,e[u]=h,t[l]=c,e[c]=s;for(var d=0,f=r;d!==f;++d){var p=n[d],m=p[c],v=p[u];p[u]=m,p[c]=v}}}this.nCachedObjects_=i}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o].uuid,u=t[l];if(void 0!==u)if(delete t[l],u<i){var c=--i,h=e[c],d=--a,f=e[d];t[h.uuid]=u,e[u]=h,t[f.uuid]=c,e[c]=f,e.pop();for(var p=0,m=r;p!==m;++p){var v=n[p],g=v[c],y=v[d];v[u]=g,v[c]=y,v.pop()}}else{var b=--a,x=e[b];b>0&&(t[x.uuid]=u),e[u]=x,e.pop();for(var w=0,_=r;w!==_;++w){var E=n[w];E[u]=E[b],E.pop()}}}this.nCachedObjects_=i}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var h=u,d=s.length;h!==d;++h){var f=s[h];c[h]=new dy(f,e,t)}return c}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}]),e}(),py=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;mr(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i;for(var a=n.tracks,o=a.length,s=new Array(o),l={endingStart:Za,endingEnd:Za},u=0;u!==o;++u){var c=a[u].createInterpolant(null);s[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return gr(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,i=r.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+n,l[0]=e/a,l[1]=t/a,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;a<0||0===n?t=0:(this._startTime=null,t=n*a)}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var l=this._interpolants,u=this._propertyBindings;if(this.blendMode===to)for(var c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(s);else for(var d=0,f=l.length;d!==f;++d)l[d].evaluate(o),u[d].accumulate(r,s)}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,a=n===Xa;if(0===e)return-1===i?r:a&&1==(1&i)?t-r:r;if(n===Wa){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&1==(1&i))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=Qa,r.endingEnd=Qa):(r.endingStart=e?this.zeroSlopeAtStart?Qa:Za:$a,r.endingEnd=t?this.zeroSlopeAtEnd?Qa:Za:$a)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}]),e}(),my=new Float32Array(1),vy=function(e){function t(e){var n;return mr(this,t),(n=or(this,t))._root=e,n._initMemoryManager(),n._accuIndex=0,n.time=0,n.timeScale=1,n}return cr(t,e),gr(t,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var h=r[c],d=h.name,f=u[d];if(void 0!==f)++f.referenceCount,a[c]=f;else{if(void 0!==(f=a[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(f=new iy(dy.create(n,d,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,d),a[c]=f}o[c].resultBuffer=f.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Uv(new Float32Array(2),new Float32Array(2),1,my)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,i=r.uuid,a="string"==typeof e?Yv.findByName(r,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],l=null;if(void 0===n&&(n=null!==a?a.blendMode:eo),void 0!==s){var u=s.actionByRoot[i];if(void 0!==u&&u.blendMode===n)return u;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;var c=new py(this,a,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Yv.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o)t[o]._update(r,e,i,a);for(var s=this._bindings,l=this._nActiveBindings,u=0;u!==l;++u)s[u].apply(a);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),t}(as),gy=function(){function e(t){mr(this,e),this.value=t}return gr(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}(),yy=0,by=function(e){function t(){var e;return mr(this,t),(e=or(this,t)).isUniformsGroup=!0,Object.defineProperty(ur(e),"id",{value:yy++}),e.name="",e.usage=Wo,e.uniforms=[],e}return cr(t,e),gr(t,[{key:"add",value:function(e){return this.uniforms.push(e),this}},{key:"remove",value:function(e){var t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}},{key:"setName",value:function(e){return this.name=e,this}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"dispose",value:function(){return this.dispatchEvent({type:"dispose"}),this}},{key:"copy",value:function(e){this.name=e.name,this.usage=e.usage;var t=e.uniforms;this.uniforms.length=0;for(var n=0,r=t.length;n<r;n++)for(var i=Array.isArray(t[n])?t[n]:[t[n]],a=0;a<i.length;a++)this.uniforms.push(i[a].clone());return this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(as),xy=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return mr(this,t),(r=or(this,t,[e,n])).isInstancedInterleavedBuffer=!0,r.meshPerAttribute=i,r}return cr(t,e),gr(t,[{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"clone",value:function(e){var n=tr(lr(t.prototype),"clone",this).call(this,e);return n.meshPerAttribute=this.meshPerAttribute,n}},{key:"toJSON",value:function(e){var n=tr(lr(t.prototype),"toJSON",this).call(this,e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}]),t}(xf),wy=function(){function e(t,n,r,i,a){mr(this,e),this.isGLBufferAttribute=!0,this.name="",this.buffer=t,this.type=n,this.itemSize=r,this.elementSize=i,this.count=a,this.version=0}return gr(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setBuffer",value:function(e){return this.buffer=e,this}},{key:"setType",value:function(e,t){return this.type=e,this.elementSize=t,this}},{key:"setItemSize",value:function(e){return this.itemSize=e,this}},{key:"setCount",value:function(e){return this.count=e,this}}]),e}(),_y=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;mr(this,e),this.ray=new Al(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new zl,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return gr(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"setFromCamera",value:function(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}},{key:"intersectObject",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Ty(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(Ey),t}},{key:"intersectObjects",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=e.length;r<i;r++)Ty(e[r],this,n,t);return n.sort(Ey),n}}]),e}();function Ey(e,t){return e.distance-t.distance}function Ty(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)Ty(i[a],t,n,!0)}var Sy=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return mr(this,e),this.radius=t,this.phi=n,this.theta=r,this}return gr(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(hs(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),My=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return mr(this,e),this.radius=t,this.theta=n,this.y=r,this}return gr(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ay=new bs,ky=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new bs(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bs(-1/0,-1/0);mr(this,e),this.isBox2=!0,this.min=t,this.max=n}return gr(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Ay.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return this.clampPoint(e,Ay).distanceTo(e)}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),Py=new Qs,Ry=new Qs,Cy=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs;mr(this,e),this.start=t,this.end=n}return gr(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){Py.subVectors(e,this.start),Ry.subVectors(this.end,this.start);var n=Ry.dot(Ry),r=Ry.dot(Py)/n;return t&&(r=hs(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ly=new Qs,Iy=function(e){function t(e,n){var r;mr(this,t),(r=or(this,t)).light=e,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.color=n,r.type="SpotLightHelper";for(var i=new qu,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],o=0,s=1;o<32;o++,s++){var l=o/32*Math.PI*2,u=s/32*Math.PI*2;a.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new Bu(a,3));var c=new kp({fog:!1,toneMapped:!1});return r.cone=new Bp(i,c),r.add(r.cone),r.update(),r}return cr(t,e),gr(t,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Ly.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ly),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),t}($l),Oy=new Qs,Dy=new kl,Ny=new kl,By=function(e){function t(e){var n;mr(this,t);for(var r=Uy(e),i=new qu,a=[],o=[],s=new vu(0,0,1),l=new vu(0,1,0),u=0;u<r.length;u++){var c=r[u];c.parent&&c.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),o.push(s.r,s.g,s.b),o.push(l.r,l.g,l.b))}return i.setAttribute("position",new Bu(a,3)),i.setAttribute("color",new Bu(o,3)),(n=or(this,t,[i,new kp({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})])).isSkeletonHelper=!0,n.type="SkeletonHelper",n.root=e,n.bones=r,n.matrix=e.matrixWorld,n.matrixAutoUpdate=!1,n}return cr(t,e),gr(t,[{key:"updateMatrixWorld",value:function(e){var n=this.bones,r=this.geometry,i=r.getAttribute("position");Ny.copy(this.root.matrixWorld).invert();for(var a=0,o=0;a<n.length;a++){var s=n[a];s.parent&&s.parent.isBone&&(Dy.multiplyMatrices(Ny,s.matrixWorld),Oy.setFromMatrixPosition(Dy),i.setXYZ(o,Oy.x,Oy.y,Oy.z),Dy.multiplyMatrices(Ny,s.parent.matrixWorld),Oy.setFromMatrixPosition(Dy),i.setXYZ(o+1,Oy.x,Oy.y,Oy.z),o+=2)}r.getAttribute("position").needsUpdate=!0,tr(lr(t.prototype),"updateMatrixWorld",this).call(this,e)}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),t}(Bp);function Uy(e){var t=[];!0===e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,Uy(e.children[n]));return t}var zy=function(e){function t(e,n,r){var i;return mr(this,t),(i=or(this,t,[new dv(n,4,2),new xu({wireframe:!0,fog:!1,toneMapped:!1})])).light=e,i.color=r,i.type="PointLightHelper",i.matrix=i.light.matrixWorld,i.matrixAutoUpdate=!1,i.update(),i}return cr(t,e),gr(t,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),t}(cc),Fy=new Qs,Hy=new vu,jy=new vu,Gy=function(e){function t(e,n,r){var i;mr(this,t),(i=or(this,t)).light=e,i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r,i.type="HemisphereLightHelper";var a=new uv(n);a.rotateY(.5*Math.PI),i.material=new xu({wireframe:!0,fog:!1,toneMapped:!1}),void 0===i.color&&(i.material.vertexColors=!0);var o=a.getAttribute("position"),s=new Float32Array(3*o.count);return a.setAttribute("color",new ku(s,3)),i.add(new cc(a,i.material)),i.update(),i}return cr(t,e),gr(t,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Hy.copy(this.light.color),jy.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?Hy:jy;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Fy.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),t}($l),Vy=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;mr(this,t),i=new vu(i),a=new vu(a);for(var o=r/2,s=n/r,l=n/2,u=[],c=[],h=0,d=0,f=-l;h<=r;h++,f+=s){u.push(-l,0,f,l,0,f),u.push(f,0,-l,f,0,l);var p=h===o?i:a;p.toArray(c,d),d+=3,p.toArray(c,d),d+=3,p.toArray(c,d),d+=3,p.toArray(c,d),d+=3}var m=new qu;return m.setAttribute("position",new Bu(u,3)),m.setAttribute("color",new Bu(c,3)),(e=or(this,t,[m,new kp({vertexColors:!0,toneMapped:!1})])).type="GridHelper",e}return cr(t,e),gr(t,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),t}(Bp),Wy=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;mr(this,t),o=new vu(o),s=new vu(s);var l=[],u=[];if(r>1)for(var c=0;c<r;c++){var h=c/r*(2*Math.PI),d=Math.sin(h)*n,f=Math.cos(h)*n;l.push(0,0,0),l.push(d,0,f);var p=1&c?o:s;u.push(p.r,p.g,p.b),u.push(p.r,p.g,p.b)}for(var m=0;m<i;m++)for(var v=1&m?o:s,g=n-n/i*m,y=0;y<a;y++){var b=y/a*(2*Math.PI),x=Math.sin(b)*g,w=Math.cos(b)*g;l.push(x,0,w),u.push(v.r,v.g,v.b),b=(y+1)/a*(2*Math.PI),x=Math.sin(b)*g,w=Math.cos(b)*g,l.push(x,0,w),u.push(v.r,v.g,v.b)}var _=new qu;return _.setAttribute("position",new Bu(l,3)),_.setAttribute("color",new Bu(u,3)),(e=or(this,t,[_,new kp({vertexColors:!0,toneMapped:!1})])).type="PolarGridHelper",e}return cr(t,e),gr(t,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),t}(Bp),qy=new Qs,Xy=new Qs,Yy=new Qs,Ky=function(e){function t(e,n,r){var i;mr(this,t),(i=or(this,t)).light=e,i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r,i.type="DirectionalLightHelper",void 0===n&&(n=1);var a=new qu;a.setAttribute("position",new Bu([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var o=new kp({fog:!1,toneMapped:!1});return i.lightPlane=new Op(a,o),i.add(i.lightPlane),(a=new qu).setAttribute("position",new Bu([0,0,0,0,0,1],3)),i.targetLine=new Op(a,o),i.add(i.targetLine),i.update(),i}return cr(t,e),gr(t,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),qy.setFromMatrixPosition(this.light.matrixWorld),Xy.setFromMatrixPosition(this.light.target.matrixWorld),Yy.subVectors(Xy,qy),this.lightPlane.lookAt(Xy),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Xy),this.targetLine.scale.z=Yy.length()}}]),t}($l),Jy=new Qs,Zy=new yc,Qy=function(e){function t(e){var n;mr(this,t);var r=new qu,i=new kp({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],o=[],s={};function l(e,t){u(e),u(t)}function u(e){a.push(0,0,0),o.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(a.length/3-1)}l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4"),r.setAttribute("position",new Bu(a,3)),r.setAttribute("color",new Bu(o,3)),(n=or(this,t,[r,i])).type="CameraHelper",n.camera=e,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=e.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=s,n.update();var c=new vu(16755200),h=new vu(16711680),d=new vu(43775),f=new vu(16777215),p=new vu(3355443);return n.setColors(c,h,d,f,p),n}return cr(t,e),gr(t,[{key:"setColors",value:function(e,t,n,r,i){var a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0}},{key:"update",value:function(){var e=this.geometry,t=this.pointMap;Zy.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$y("c",t,e,Zy,0,0,-1),$y("t",t,e,Zy,0,0,1),$y("n1",t,e,Zy,-1,-1,-1),$y("n2",t,e,Zy,1,-1,-1),$y("n3",t,e,Zy,-1,1,-1),$y("n4",t,e,Zy,1,1,-1),$y("f1",t,e,Zy,-1,-1,1),$y("f2",t,e,Zy,1,-1,1),$y("f3",t,e,Zy,-1,1,1),$y("f4",t,e,Zy,1,1,1),$y("u1",t,e,Zy,.7,1.1,-1),$y("u2",t,e,Zy,-.7,1.1,-1),$y("u3",t,e,Zy,0,2,-1),$y("cf1",t,e,Zy,-1,0,1),$y("cf2",t,e,Zy,1,0,1),$y("cf3",t,e,Zy,0,-1,1),$y("cf4",t,e,Zy,0,1,1),$y("cn1",t,e,Zy,-1,0,-1),$y("cn2",t,e,Zy,1,0,-1),$y("cn3",t,e,Zy,0,-1,-1),$y("cn4",t,e,Zy,0,1,-1),e.getAttribute("position").needsUpdate=!0}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),t}(Bp);function $y(e,t,n,r,i,a,o){Jy.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var l=n.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],Jy.x,Jy.y,Jy.z)}var eb,tb,nb=new tl,rb=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;mr(this,t);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new Float32Array(24),o=new qu;return o.setIndex(new ku(i,1)),o.setAttribute("position",new ku(a,3)),(n=or(this,t,[o,new kp({color:r,toneMapped:!1})])).object=e,n.type="BoxHelper",n.matrixAutoUpdate=!1,n.update(),n}return cr(t,e),gr(t,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&nb.setFromObject(this.object),!nb.isEmpty()){var t=nb.min,n=nb.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e,n){return tr(lr(t.prototype),"copy",this).call(this,e,n),this.object=e.object,this}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),t}(Bp),ib=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;mr(this,t);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new qu;return a.setIndex(new ku(i,1)),a.setAttribute("position",new Bu([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(n=or(this,t,[a,new kp({color:r,toneMapped:!1})])).box=e,n.type="Box3Helper",n.geometry.computeBoundingSphere(),n}return cr(t,e),gr(t,[{key:"updateMatrixWorld",value:function(e){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),tr(lr(t.prototype),"updateMatrixWorld",this).call(this,e))}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),t}(Bp),ab=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960;mr(this,t);var a=i,o=new qu;o.setAttribute("position",new Bu([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),o.computeBoundingSphere(),(n=or(this,t,[o,new kp({color:a,toneMapped:!1})])).type="PlaneHelper",n.plane=e,n.size=r;var s=new qu;return s.setAttribute("position",new Bu([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),s.computeBoundingSphere(),n.add(new cc(s,new xu({color:a,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),n}return cr(t,e),gr(t,[{key:"updateMatrixWorld",value:function(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),tr(lr(t.prototype),"updateMatrixWorld",this).call(this,e)}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}]),t}(Op),ob=new Qs,sb=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qs(0,0,1),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qs(0,0,0),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*i,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*o;return mr(this,t),(e=or(this,t)).type="ArrowHelper",void 0===eb&&((eb=new qu).setAttribute("position",new Bu([0,0,0,0,1,0],3)),(tb=new Em(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(r),e.line=new Op(eb,new kp({color:a,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new cc(tb,new xu({color:a,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(n),e.setLength(i,o,s),e}return cr(t,e),gr(t,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{ob.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(ob,t)}}},{key:"setLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return tr(lr(t.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}},{key:"dispose",value:function(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}]),t}($l),lb=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;mr(this,t);var r=[0,0,0,n,0,0,0,0,0,0,n,0,0,0,0,0,0,n],i=new qu;return i.setAttribute("position",new Bu(r,3)),i.setAttribute("color",new Bu([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),(e=or(this,t,[i,new kp({vertexColors:!0,toneMapped:!1})])).type="AxesHelper",e}return cr(t,e),gr(t,[{key:"setColors",value:function(e,t,n){var r=new vu,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),t}(Bp),ub=function(){function e(){mr(this,e),this.type="ShapePath",this.color=new vu,this.subPaths=[],this.currentPath=null}return gr(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new bm,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e){function t(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=t[a],l=-l,s=t[i],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=u*(e.x-o.x)-l*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var n,r,i,a=rv.isClockWise,o=this.subPaths;if(0===o.length)return[];var s=[];if(1===o.length)return r=o[0],(i=new Lm).curves=r.curves,s.push(i),s;var l=!a(o[0].getPoints());l=e?!l:l;var u,c,h=[],d=[],f=[],p=0;d[p]=void 0,f[p]=[];for(var m=0,v=o.length;m<v;m++)n=a(u=(r=o[m]).getPoints()),(n=e?!n:n)?(!l&&d[p]&&p++,d[p]={s:new Lm,p:u},d[p].s.curves=r.curves,l&&p++,f[p]=[]):f[p].push({h:r,p:u[0]});if(!d[0])return function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new Lm;a.curves=i.curves,t.push(a)}return t}(o);if(d.length>1){for(var g=!1,y=0,b=0,x=d.length;b<x;b++)h[b]=[];for(var w=0,_=d.length;w<_;w++)for(var E=f[w],T=0;T<E.length;T++){for(var S=E[T],M=!0,A=0;A<d.length;A++)t(S.p,d[A].p)&&(w!==A&&y++,M?(M=!1,h[A].push(S)):g=!0);M&&h[w].push(S)}y>0&&!1===g&&(f=h)}for(var k=0,P=d.length;k<P;k++){i=d[k].s,s.push(i);for(var R=0,C=(c=f[k]).length;R<C;R++)i.holes.push(c[R].h)}return s}}]),e}();function cb(e){return cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cb(e)}function hb(){return hb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hb.apply(this,arguments)}function db(e,t,n,r){return db="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,r){var i,a=pb(e,t);if(a){if((i=Object.getOwnPropertyDescriptor(a,t)).set)return i.set.call(r,n),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(r,t)){if(!i.writable)return!1;i.value=n,Object.defineProperty(r,t,i)}else!function(e,t,n){(t=Sb(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(r,t,n);return!0},db(e,t,n,r)}function fb(){return fb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=pb(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},fb.apply(this,arguments)}function pb(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bb(e)););return e}function mb(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return vb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vb(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function vb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gb(e,t,n){return t=bb(t),function(e,t){if(t&&("object"===cb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,yb()?Reflect.construct(t,n||[],bb(e).constructor):t.apply(e,n))}function yb(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yb=function(){return!!e})()}function bb(e){return bb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bb(e)}function xb(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wb(e,t)}function wb(e,t){return wb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wb(e,t)}function _b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Sb(r.key),r)}}function Tb(e,t,n){return t&&Eb(e.prototype,t),n&&Eb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sb(e){var t=function(e,t){if("object"!=cb(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=cb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==cb(t)?t:String(t)}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:br}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=br);var Mb="srgb",Ab="srgb-linear",kb=Number(br.replace(/\D+/g,"")),Pb=kb>=152,Rb=new Map([[ao,Ab],[oo,Mb]]),Cb=new Map([[Ab,ao],[Mb,oo]]);function Lb(e){return null===e?null:Pb?e.outputColorSpace:Rb.get(e.outputEncoding)}function Ib(e,t){null!==e&&(Pb?e.colorSpace=t:e.encoding=Cb.get(t))}new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10]);var Ob=function(e){function t(){var e,n;return _b(this,t),(e=gb(this,t,[{name:"CopyMaterial",uniforms:{inputBuffer:new gy(null),opacity:new gy(1)},blending:Or,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <colorspace_fragment>\n#include <dithering_fragment>\n}",vertexShader:"varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}"}])).fragmentShader=(n=e.fragmentShader,kb<154?n.replace("colorspace_fragment","encodings_fragment"):n),e}return xb(t,e),Tb(t,[{key:"inputBuffer",set:function(e){this.uniforms.inputBuffer.value=e}},{key:"setInputBuffer",value:function(e){this.uniforms.inputBuffer.value=e}},{key:"getOpacity",value:function(e){return this.uniforms.opacity.value}},{key:"setOpacity",value:function(e){this.uniforms.opacity.value=e}}]),t}(gc),Db=new yc,Nb=null,Bb=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bf,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Db;_b(this,e),this.name=t,this.renderer=null,this.scene=n,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}return Tb(e,[{key:"renderToScreen",get:function(){return!this.rtt},set:function(e){if(this.rtt===e){var t=this.fullscreenMaterial;null!==t&&(t.needsUpdate=!0),this.rtt=!e}}},{key:"mainScene",set:function(e){}},{key:"mainCamera",set:function(e){}},{key:"setRenderer",value:function(e){this.renderer=e}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(e){this.enabled=e}},{key:"fullscreenMaterial",get:function(){return null!==this.screen?this.screen.material:null},set:function(e){var t=this.screen;null!==t?t.material=e:((t=new cc(function(){if(null===Nb){var e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(Nb=new qu).setAttribute?(Nb.setAttribute("position",new ku(e,3)),Nb.setAttribute("uv",new ku(t,2))):(Nb.addAttribute("position",new ku(e,3)),Nb.addAttribute("uv",new ku(t,2)))}return Nb}(),e)).frustumCulled=!1,null===this.scene&&(this.scene=new bf),this.scene.add(t),this.screen=t)}},{key:"getFullscreenMaterial",value:function(){return this.fullscreenMaterial}},{key:"setFullscreenMaterial",value:function(e){this.fullscreenMaterial=e}},{key:"getDepthTexture",value:function(){return null}},{key:"setDepthTexture",value:function(e){}},{key:"render",value:function(e,t,n,r,i){throw new Error("Render method not implemented!")}},{key:"setSize",value:function(e,t){}},{key:"initialize",value:function(e,t,n){}},{key:"dispose",value:function(){for(var t=0,n=Object.keys(this);t<n.length;t++){var r=n[t],i=this[r];(i instanceof Ws||i instanceof bu||i instanceof js||i instanceof e)&&this[r].dispose()}}}]),e}(),Ub=function(e){function t(e){var n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return _b(this,t),(n=gb(this,t,["CopyPass"])).fullscreenMaterial=new Ob,n.needsSwap=!1,n.renderTarget=e,void 0===e&&(n.renderTarget=new Ws(1,1,{minFilter:Fi,magFilter:Fi,stencilBuffer:!1,depthBuffer:!1}),n.renderTarget.texture.name="CopyPass.Target"),n.autoResize=r,n}return xb(t,e),Tb(t,[{key:"resize",get:function(){return this.autoResize},set:function(e){this.autoResize=e}},{key:"texture",get:function(){return this.renderTarget.texture}},{key:"getTexture",value:function(){return this.renderTarget.texture}},{key:"setAutoResizeEnabled",value:function(e){this.autoResize=e}},{key:"render",value:function(e,t,n,r,i){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}},{key:"setSize",value:function(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}},{key:"initialize",value:function(e,t,n){void 0!==n&&(this.renderTarget.texture.type=n,n!==Wi?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":Lb(e)===Mb&&Ib(this.renderTarget.texture,Mb))}}]),t}(Bb),zb=function(e){function t(){var e;return _b(this,t),(e=gb(this,t,["ClearMaskPass",null,null])).needsSwap=!1,e}return xb(t,e),Tb(t,[{key:"render",value:function(e,t,n,r,i){var a=e.state.buffers.stencil;a.setLocked(!1),a.setTest(!1)}}]),t}(Bb),Fb=new vu,Hb=function(e){function t(){var e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _b(this,t),(e=gb(this,t,["ClearPass",null,null])).needsSwap=!1,e.color=n,e.depth=r,e.stencil=i,e.overrideClearColor=null,e.overrideClearAlpha=-1,e}return xb(t,e),Tb(t,[{key:"setClearFlags",value:function(e,t,n){this.color=e,this.depth=t,this.stencil=n}},{key:"getOverrideClearColor",value:function(){return this.overrideClearColor}},{key:"setOverrideClearColor",value:function(e){this.overrideClearColor=e}},{key:"getOverrideClearAlpha",value:function(){return this.overrideClearAlpha}},{key:"setOverrideClearAlpha",value:function(e){this.overrideClearAlpha=e}},{key:"render",value:function(e,t,n,r,i){var a=this.overrideClearColor,o=this.overrideClearAlpha,s=e.getClearAlpha(),l=null!==a,u=o>=0;l?(e.getClearColor(Fb),e.setClearColor(a,u?o:s)):u&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(Fb,s):u&&e.setClearAlpha(s)}}]),t}(Bb),jb=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return _b(this,t),(r=gb(this,t,["RenderPass",e,n])).needsSwap=!1,r.clearPass=new Hb,r.overrideMaterialManager=null===i?null:new Yb(i),r.ignoreBackground=!1,r.skipShadowMapUpdate=!1,r.selection=null,r}return xb(t,e),Tb(t,[{key:"mainScene",set:function(e){this.scene=e}},{key:"mainCamera",set:function(e){this.camera=e}},{key:"renderToScreen",get:function(){return fb(bb(t.prototype),"renderToScreen",this)},set:function(e){!function(e,t,n,r,i){if(!db(e,"renderToScreen",n,r||e))throw new TypeError("failed to set property")}(bb(t.prototype),0,e,this),this.clearPass.renderToScreen=e}},{key:"overrideMaterial",get:function(){var e=this.overrideMaterialManager;return null!==e?e.material:null},set:function(e){var t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new Yb(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}},{key:"getOverrideMaterial",value:function(){return this.overrideMaterial}},{key:"setOverrideMaterial",value:function(e){this.overrideMaterial=e}},{key:"clear",get:function(){return this.clearPass.enabled},set:function(e){this.clearPass.enabled=e}},{key:"getSelection",value:function(){return this.selection}},{key:"setSelection",value:function(e){this.selection=e}},{key:"isBackgroundDisabled",value:function(){return this.ignoreBackground}},{key:"setBackgroundDisabled",value:function(e){this.ignoreBackground=e}},{key:"isShadowMapDisabled",value:function(){return this.skipShadowMapUpdate}},{key:"setShadowMapDisabled",value:function(e){this.skipShadowMapUpdate=e}},{key:"getClearPass",value:function(){return this.clearPass}},{key:"render",value:function(e,t,n,r,i){var a=this.scene,o=this.camera,s=this.selection,l=o.layers.mask,u=a.background,c=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;null!==s&&o.layers.set(s.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||null!==this.clearPass.overrideClearColor)&&(a.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,a,o):e.render(a,o),o.layers.mask=l,a.background=u,e.shadowMap.autoUpdate=c}}]),t}(Bb);new Float32Array([255/256/Math.pow(256,3),255/256/Math.pow(256,2),255/256/256,255/256]);var Gb=function(e){function t(e,n){var r;return _b(this,t),(r=gb(this,t,["MaskPass",e,n])).needsSwap=!1,r.clearPass=new Hb(!1,!1,!0),r.inverse=!1,r}return xb(t,e),Tb(t,[{key:"mainScene",set:function(e){this.scene=e}},{key:"mainCamera",set:function(e){this.camera=e}},{key:"inverted",get:function(){return this.inverse},set:function(e){this.inverse=e}},{key:"clear",get:function(){return this.clearPass.enabled},set:function(e){this.clearPass.enabled=e}},{key:"getClearPass",value:function(){return this.clearPass}},{key:"isInverted",value:function(){return this.inverted}},{key:"setInverted",value:function(e){this.inverted=e}},{key:"render",value:function(e,t,n,r,i){var a=e.getContext(),o=e.state.buffers,s=this.scene,l=this.camera,u=this.clearPass,c=this.inverted?0:1,h=1-c;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.stencil.setFunc(a.ALWAYS,c,4294967295),o.stencil.setClear(h),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(e,null):(u.render(e,t),u.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(s,l)):(e.setRenderTarget(t),e.render(s,l),e.setRenderTarget(n),e.render(s,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(a.EQUAL,1,4294967295),o.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.stencil.setLocked(!0)}}]),t}(Bb),Vb=.001,Wb=function(){function e(){_b(this,e),this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}return Tb(e,[{key:"autoReset",get:function(){return this._autoReset},set:function(e){"undefined"!=typeof document&&void 0!==document.hidden&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}},{key:"delta",get:function(){return this._delta*Vb}},{key:"fixedDelta",get:function(){return this._fixedDelta*Vb},set:function(e){this._fixedDelta=1e3*e}},{key:"elapsed",get:function(){return this._elapsed*Vb}},{key:"update",value:function(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(void 0!==e?e:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}},{key:"reset",value:function(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}},{key:"handleEvent",value:function(e){document.hidden||(this.currentTime=performance.now()-this.startTime)}},{key:"dispose",value:function(){this.autoReset=!1}}]),e}(),qb=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.depthBuffer,i=void 0===r||r,a=n.stencilBuffer,o=void 0!==a&&a,s=n.multisampling,l=void 0===s?0:s,u=n.frameBufferType;_b(this,e),this.renderer=null,this.inputBuffer=this.createBuffer(i,o,u,l),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Ub,this.depthTexture=null,this.passes=[],this.timer=new Wb,this.autoRenderToScreen=!0,this.setRenderer(t)}return Tb(e,[{key:"multisampling",get:function(){return this.inputBuffer.samples||0},set:function(e){var t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}},{key:"getTimer",value:function(){return this.timer}},{key:"getRenderer",value:function(){return this.renderer}},{key:"setRenderer",value:function(e){if(this.renderer=e,null!==e){var t=e.getSize(new bs),n=e.getContext().getContextAttributes().alpha,r=this.inputBuffer.texture.type;r===Wi&&Lb(e)===Mb&&(Ib(this.inputBuffer.texture,Mb),Ib(this.outputBuffer.texture,Mb),this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);var i,a=mb(this.passes);try{for(a.s();!(i=a.n()).done;)i.value.initialize(e,n,r)}catch(e){a.e(e)}finally{a.f()}}}},{key:"replaceRenderer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.renderer,r=n.domElement.parentNode;return this.setRenderer(e),t&&null!==r&&(r.removeChild(n.domElement),r.appendChild(e.domElement)),n}},{key:"createDepthTexture",value:function(){var e=this.depthTexture=new mh;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=sa,e.type=ta):e.type=Ji,e}},{key:"deleteDepthTexture",value:function(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();var e,t=mb(this.passes);try{for(t.s();!(e=t.n()).done;)e.value.setDepthTexture(null)}catch(e){t.e(e)}finally{t.f()}}}},{key:"createBuffer",value:function(e,t,n,r){var i=this.renderer,a=null===i?new bs:i.getDrawingBufferSize(new bs),o={minFilter:Fi,magFilter:Fi,stencilBuffer:t,depthBuffer:e,type:n},s=new Ws(a.width,a.height,o);return r>0&&(s.ignoreDepthForMultisampleCopy=!1,s.samples=r),n===Wi&&Lb(i)===Mb&&Ib(s.texture,Mb),s.texture.name="EffectComposer.Buffer",s.texture.generateMipmaps=!1,s}},{key:"setMainScene",value:function(e){var t,n=mb(this.passes);try{for(n.s();!(t=n.n()).done;)t.value.mainScene=e}catch(e){n.e(e)}finally{n.f()}}},{key:"setMainCamera",value:function(e){var t,n=mb(this.passes);try{for(n.s();!(t=n.n()).done;)t.value.mainCamera=e}catch(e){n.e(e)}finally{n.f()}}},{key:"addPass",value:function(e,t){var n=this.passes,r=this.renderer,i=r.getDrawingBufferSize(new bs),a=r.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(e.setRenderer(r),e.setSize(i.width,i.height),e.initialize(r,a,o),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){var s,l=this.createDepthTexture(),u=mb(n);try{for(u.s();!(s=u.n()).done;)(e=s.value).setDepthTexture(l)}catch(e){u.e(e)}finally{u.f()}}else e.setDepthTexture(this.depthTexture)}},{key:"removePass",value:function(e){var t=this.passes,n=t.indexOf(e);-1!==n&&t.splice(n,1).length>0&&(null!==this.depthTexture&&(t.reduce((function(e,t){return e||t.needsDepthTexture}),!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())),this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0)))}},{key:"removeAllPasses",value:function(){var e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}},{key:"render",value:function(e){var t,n,r,i=this.renderer,a=this.copyPass,o=this.inputBuffer,s=this.outputBuffer,l=!1;void 0===e&&(this.timer.update(),e=this.timer.delta);var u,c=mb(this.passes);try{for(c.s();!(u=c.n()).done;){var h=u.value;h.enabled&&(h.render(i,o,s,e,l),h.needsSwap&&(l&&(a.renderToScreen=h.renderToScreen,t=i.getContext(),(n=i.state.buffers.stencil).setFunc(t.NOTEQUAL,1,4294967295),a.render(i,o,s,e,l),n.setFunc(t.EQUAL,1,4294967295)),r=o,o=s,s=r),h instanceof Gb?l=!0:h instanceof zb&&(l=!1))}}catch(e){c.e(e)}finally{c.f()}}},{key:"setSize",value:function(e,t,n){var r=this.renderer,i=r.getSize(new bs);void 0!==e&&void 0!==t||(e=i.width,t=i.height),i.width===e&&i.height===t||r.setSize(e,t,n);var a=r.getDrawingBufferSize(new bs);this.inputBuffer.setSize(a.width,a.height),this.outputBuffer.setSize(a.width,a.height);var o,s=mb(this.passes);try{for(s.s();!(o=s.n()).done;)o.value.setSize(a.width,a.height)}catch(e){s.e(e)}finally{s.f()}}},{key:"reset",value:function(){var e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}},{key:"dispose",value:function(){var e,t=mb(this.passes);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(e){t.e(e)}finally{t.f()}this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}}]),e}(),Xb=!1,Yb=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_b(this,e),this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=function(e){if(e.isMesh){var n;if(e.material.flatShading)switch(e.material.side){case Lr:n=t.materialsFlatShadedDoubleSide;break;case Cr:n=t.materialsFlatShadedBackSide;break;default:n=t.materialsFlatShaded}else switch(e.material.side){case Lr:n=t.materialsDoubleSide;break;case Cr:n=t.materialsBackSide;break;default:n=t.materials}t.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++t.meshCount}}}return Tb(e,[{key:"cloneMaterial",value:function(e){if(!(e instanceof gc))return e.clone();var t=e.uniforms,n=new Map;for(var r in t){var i=t[r].value;i.isRenderTargetTexture&&(t[r].value=null,n.set(r,i))}var a,o=e.clone(),s=mb(n);try{for(s.s();!(a=s.n()).done;){var l=a.value;t[l[0]].value=l[1],o.uniforms[l[0]].value=l[1]}}catch(e){s.e(e)}finally{s.f()}return o}},{key:"setMaterial",value:function(e){var t=this;if(this.disposeMaterials(),this.material=e,null!==e){for(var n=this.materials=[this.cloneMaterial(e),this.cloneMaterial(e),this.cloneMaterial(e)],r=0,i=n;r<i.length;r++){var a=i[r];a.uniforms=hb({},e.uniforms),a.side=Rr}n[2].skinning=!0,this.materialsBackSide=n.map((function(n){var r=t.cloneMaterial(n);return r.uniforms=hb({},e.uniforms),r.side=Cr,r})),this.materialsDoubleSide=n.map((function(n){var r=t.cloneMaterial(n);return r.uniforms=hb({},e.uniforms),r.side=Lr,r})),this.materialsFlatShaded=n.map((function(n){var r=t.cloneMaterial(n);return r.uniforms=hb({},e.uniforms),r.flatShading=!0,r})),this.materialsFlatShadedBackSide=n.map((function(n){var r=t.cloneMaterial(n);return r.uniforms=hb({},e.uniforms),r.flatShading=!0,r.side=Cr,r})),this.materialsFlatShadedDoubleSide=n.map((function(n){var r=t.cloneMaterial(n);return r.uniforms=hb({},e.uniforms),r.flatShading=!0,r.side=Lr,r}))}}},{key:"render",value:function(e,t,n){var r=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Xb){var i=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);var a,o=mb(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;s[0].material=s[1]}}catch(e){o.e(e)}finally{o.f()}this.meshCount!==i.size&&i.clear()}else{var l=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=l}e.shadowMap.enabled=r}},{key:"disposeMaterials",value:function(){if(null!==this.material){var e,t=mb(this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide));try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(e){t.e(e)}finally{t.f()}}}},{key:"dispose",value:function(){this.originalMaterials.clear(),this.disposeMaterials()}}],[{key:"workaroundEnabled",get:function(){return Xb},set:function(e){Xb=e}}]),e}();function Kb(e,t,n){return e+(t-e)*n}function Jb(e,t,n,r){var i=Kb(e,t,.75),a=Kb(n,r,.75);return Kb(i,a,.875)}function Zb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zb(Object(n),!0).forEach((function(t){$b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $b(e,t,n){return(t=lx(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ex(e,t,n){return t=nx(t),function(e,t){if(t&&("object"===ix(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,tx()?Reflect.construct(t,n||[],nx(e).constructor):t.apply(e,n))}function tx(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(tx=function(){return!!e})()}function nx(e){return nx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nx(e)}function rx(e,t){return rx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rx(e,t)}function ix(e){return ix="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ix(e)}function ax(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ox(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lx(r.key),r)}}function sx(e,t,n){return t&&ox(e.prototype,t),n&&ox(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function lx(e){var t=function(e,t){if("object"!=ix(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=ix(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ix(t)?t:String(t)}new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array(2),new Float32Array(2),new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125]),new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4]),new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3]),Jb(0,0,0,0),new Float32Array([0,0,0,0]),Jb(0,0,0,1),new Float32Array([0,0,0,1]),Jb(0,0,1,0),new Float32Array([0,0,1,0]),Jb(0,0,1,1),new Float32Array([0,0,1,1]),Jb(0,1,0,0),new Float32Array([0,1,0,0]),Jb(0,1,0,1),new Float32Array([0,1,0,1]),Jb(0,1,1,0),new Float32Array([0,1,1,0]),Jb(0,1,1,1),new Float32Array([0,1,1,1]),Jb(1,0,0,0),new Float32Array([1,0,0,0]),Jb(1,0,0,1),new Float32Array([1,0,0,1]),Jb(1,0,1,0),new Float32Array([1,0,1,0]),Jb(1,0,1,1),new Float32Array([1,0,1,1]),Jb(1,1,0,0),new Float32Array([1,1,0,0]),Jb(1,1,0,1),new Float32Array([1,1,0,1]),Jb(1,1,1,0),new Float32Array([1,1,1,0]),Jb(1,1,1,1),new Float32Array([1,1,1,1]),Math.PI;var ux=new qu;ux.setAttribute("position",new ku(new Float32Array([-1,-1,3,-1,-1,3]),2)),ux.setAttribute("uv",new ku(new Float32Array([0,0,2,0,0,2]),2)),ux.boundingSphere=new bl,ux.computeBoundingSphere=function(){};var cx=new Vc,hx=function(){function e(t){ax(this,e),this._mesh=new cc(ux,t),this._mesh.frustumCulled=!1}return sx(e,[{key:"render",value:function(e){e.render(this._mesh,cx)}},{key:"material",get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}},{key:"dispose",value:function(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}}]),e}(),dx={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new kl},viewMat:{value:new kl},projViewMat:{value:new kl},projectionMatrixInv:{value:new kl},viewMatrixInv:{value:new kl},cameraPos:{value:new Qs},resolution:{value:new bs},time:{value:0},samples:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1},frame:{value:0}},depthWrite:!1,depthTest:!1,vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = vec4(position, 1);\n}",fragmentShader:"\n    #define SAMPLES 16\n    #define FSAMPLES 16.0\nuniform sampler2D sceneDiffuse;\nuniform highp sampler2D sceneNormal;\nuniform highp sampler2D sceneDepth;\nuniform mat4 projectionMatrixInv;\nuniform mat4 viewMatrixInv;\nuniform mat4 projMat;\nuniform mat4 viewMat;\nuniform mat4 projViewMat;\nuniform vec3 cameraPos;\nuniform vec2 resolution;\nuniform float time;\nuniform vec3[SAMPLES] samples;\nuniform float radius;\nuniform float distanceFalloff;\nuniform float near;\nuniform float far;\nuniform float frame;\nuniform bool logDepth;\nuniform bool ortho;\nuniform bool screenSpaceRadius;\nuniform sampler2D bluenoise;\n    varying vec2 vUv;\n    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)\n    {\n        return (zFar * zNear) / (zFar - d * (zFar - zNear));\n    }\n    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {\n      return nearZ + (farZ - nearZ) * d;\n    }\n    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {\n      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;\n      float a = farZ / (farZ - nearZ);\n      float b = farZ * nearZ / (nearZ - farZ);\n      float linDepth = a + b / depth;\n      return ortho ? linearize_depth_ortho(\n        linDepth,\n        nearZ,\n        farZ\n      ) :linearize_depth(linDepth, nearZ, farZ);\n    }\n\n    vec3 getWorldPosLog(vec3 posS) {\n      vec2 uv = posS.xy;\n      float z = posS.z;\n      float nearZ =near;\n      float farZ = far;\n      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n      float a = farZ / (farZ - nearZ);\n      float b = farZ * nearZ / (nearZ - farZ);\n      float linDepth = a + b / depth;\n      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n      vec4 wpos = projectionMatrixInv * clipVec;\n      return wpos.xyz / wpos.w;\n    }\n    vec3 getWorldPos(float depth, vec2 coord) {\n      #ifdef LOGDEPTH\n        return getWorldPosLog(vec3(coord, depth));\n      #endif\n      float z = depth * 2.0 - 1.0;\n      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n      // Perspective division\n     vec4 worldSpacePosition = viewSpacePosition;\n     worldSpacePosition.xyz /= worldSpacePosition.w;\n      return worldSpacePosition.xyz;\n  }\n\n  vec3 computeNormal(vec3 worldPos, vec2 vUv) {\n    ivec2 p = ivec2(vUv * resolution);\n    float c0 = texelFetch(sceneDepth, p, 0).x;\n    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;\n    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;\n    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;\n    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;\n    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;\n    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;\n    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;\n    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;\n\n    float dl = abs((2.0 * l1 - l2) - c0);\n    float dr = abs((2.0 * r1 - r2) - c0);\n    float db = abs((2.0 * b1 - b2) - c0);\n    float dt = abs((2.0 * t1 - t2) - c0);\n\n    vec3 ce = getWorldPos(c0, vUv).xyz;\n\n    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz\n                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;\n    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz\n                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;\n\n    return normalize(cross(dpdx, dpdy));\n}\n\nmat3 makeRotationZ(float theta) {\n\tfloat c = cos(theta);\n\tfloat s = sin(theta);\n\treturn mat3(c, - s, 0,\n\t\t\ts,  c, 0,\n\t\t\t0,  0, 1);\n  }\n\nvoid main() {\n      vec4 diffuse = texture2D(sceneDiffuse, vUv);\n      float depth = texture2D(sceneDepth, vUv).x;\n      if (depth == 1.0) {\n        gl_FragColor = vec4(vec3(1.0), 1.0);\n        return;\n      }\n      vec3 worldPos = getWorldPos(depth, vUv);\n      #ifdef HALFRES\n        vec3 normal = texture2D(sceneNormal, vUv).rgb;\n      #else\n        vec3 normal = computeNormal(worldPos, vUv);\n      #endif\n      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);\n      vec2 harmoniousNumbers = vec2(\n        1.618033988749895,\n        1.324717957244746\n      );\n      noise.rg += harmoniousNumbers * frame;\n      noise.rg = fract(noise.rg);\n        vec3 helperVec = vec3(0.0, 1.0, 0.0);\n        if (dot(helperVec, normal) > 0.99) {\n          helperVec = vec3(1.0, 0.0, 0.0);\n        }\n        vec3 tangent = normalize(cross(helperVec, normal));\n        vec3 bitangent = cross(normal, tangent);\n        mat3 tbn = mat3(tangent, bitangent, normal) *  makeRotationZ(noise.r * 2.0 * 3.1415962) ;\n\n      float occluded = 0.0;\n      float totalWeight = 0.0;\n      float radiusToUse = screenSpaceRadius ? distance(\n        worldPos,\n        getWorldPos(depth, vUv +\n          vec2(radius, 0.0) / resolution)\n      ) : radius;\n      float distanceFalloffToUse =screenSpaceRadius ?\n          radiusToUse * distanceFalloff\n      : radiusToUse * distanceFalloff * 0.2;\n      float bias = (min(\n        0.1,\n        distanceFalloffToUse * 0.1\n      ) / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;\n      float phi = 1.61803398875;\n      float offsetMove = 0.0;\n      float offsetMoveInv = 1.0 / FSAMPLES;\n      for(float i = 0.0; i < FSAMPLES; i++) {\n        vec3 sampleDirection = tbn * samples[int(i)];\n\n        float moveAmt = fract(noise.g + offsetMove);\n        offsetMove += offsetMoveInv;\n\n        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;\n        vec4 offset = projMat * vec4(samplePos, 1.0);\n        offset.xyz /= offset.w;\n        offset.xyz = offset.xyz * 0.5 + 0.5;\n        \n        vec2 diff = gl_FragCoord.xy - floor(offset.xy * resolution);\n        // From Rabbid76's hbao\n        vec2 clipRangeCheck = step(vec2(0.0),offset.xy) * step(offset.xy, vec2(1.0));\n          float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;\n\n          #ifdef LOGDEPTH\n\n          float distSample = linearize_depth_log(sampleDepth, near, far);\n\n          #else\n\n          float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);\n\n          #endif\n\n          float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);\n          \n          float rangeCheck = distSample == distWorld ? 0.0 : smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));\n          \n          float sampleValid = (clipRangeCheck.x * clipRangeCheck.y);\n          occluded += rangeCheck * float(sampleDepth != depth) * float(distSample + bias < distWorld) * step(\n            1.0,\n            dot(diff, diff)\n          ) * sampleValid;\n          \n          totalWeight += sampleValid;\n      }\n      float occ = clamp(1.0 - occluded / (totalWeight == 0.0 ? 1.0 : totalWeight), 0.0, 1.0);\n      gl_FragColor = vec4(occ, 0.5 + 0.5 * normal);\n}"},fx={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},transparencyDWFalse:{value:null},transparencyDWTrue:{value:null},transparencyDWTrueDepth:{value:null},transparencyAware:{value:!1},projMat:{value:new kl},viewMat:{value:new kl},projectionMatrixInv:{value:new kl},viewMatrixInv:{value:new kl},cameraPos:{value:new Qs},resolution:{value:new bs},color:{value:new Qs(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1},fog:{value:!1},fogExp:{value:!1},fogDensity:{value:0},fogNear:{value:1/0},fogFar:{value:1/0},colorMultiply:{value:!0}},depthWrite:!1,depthTest:!1,vertexShader:"\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = vec4(position, 1);\n\t\t}",fragmentShader:"\n\t\tuniform sampler2D sceneDiffuse;\n    uniform highp sampler2D sceneDepth;\n    uniform highp sampler2D downsampledDepth;\n    uniform highp sampler2D transparencyDWFalse;\n    uniform highp sampler2D transparencyDWTrue;\n    uniform highp sampler2D transparencyDWTrueDepth;\n    uniform sampler2D tDiffuse;\n    uniform sampler2D blueNoise;\n    uniform vec2 resolution;\n    uniform vec3 color;\n    uniform mat4 projectionMatrixInv;\n    uniform mat4 viewMatrixInv;\n    uniform float intensity;\n    uniform float renderMode;\n    uniform float near;\n    uniform float far;\n    uniform bool gammaCorrection;\n    uniform bool logDepth;\n    uniform bool ortho;\n    uniform bool screenSpaceRadius;\n    uniform bool fog;\n    uniform bool fogExp;\n    uniform bool colorMultiply;\n    uniform bool transparencyAware;\n    uniform float fogDensity;\n    uniform float fogNear;\n    uniform float fogFar;\n    uniform float radius;\n    uniform float distanceFalloff;\n    uniform vec3 cameraPos;\n    varying vec2 vUv;\n    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)\n    {\n        return (zFar * zNear) / (zFar - d * (zFar - zNear));\n    }\n    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {\n      return nearZ + (farZ - nearZ) * d;\n    }\n    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {\n      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;\n      float a = farZ / (farZ - nearZ);\n      float b = farZ * nearZ / (nearZ - farZ);\n      float linDepth = a + b / depth;\n      return ortho ? linearize_depth_ortho(\n        linDepth,\n        nearZ,\n        farZ\n      ) :linearize_depth(linDepth, nearZ, farZ);\n    }\n    vec3 getWorldPosLog(vec3 posS) {\n        vec2 uv = posS.xy;\n        float z = posS.z;\n        float nearZ =near;\n        float farZ = far;\n        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n        float a = farZ / (farZ - nearZ);\n        float b = farZ * nearZ / (nearZ - farZ);\n        float linDepth = a + b / depth;\n        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n        vec4 wpos = projectionMatrixInv * clipVec;\n        return wpos.xyz / wpos.w;\n      }\n      vec3 getWorldPos(float depth, vec2 coord) {\n       // if (logDepth) {\n        #ifdef LOGDEPTH\n          return getWorldPosLog(vec3(coord, depth));\n        #endif\n      //  }\n        float z = depth * 2.0 - 1.0;\n        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n        // Perspective division\n       vec4 worldSpacePosition = viewSpacePosition;\n       worldSpacePosition.xyz /= worldSpacePosition.w;\n        return worldSpacePosition.xyz;\n    }\n  \n    vec3 computeNormal(vec3 worldPos, vec2 vUv) {\n      ivec2 p = ivec2(vUv * resolution);\n      float c0 = texelFetch(sceneDepth, p, 0).x;\n      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;\n      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;\n      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;\n      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;\n      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;\n      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;\n      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;\n      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;\n  \n      float dl = abs((2.0 * l1 - l2) - c0);\n      float dr = abs((2.0 * r1 - r2) - c0);\n      float db = abs((2.0 * b1 - b2) - c0);\n      float dt = abs((2.0 * t1 - t2) - c0);\n  \n      vec3 ce = getWorldPos(c0, vUv).xyz;\n  \n      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz\n                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;\n      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz\n                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;\n  \n      return normalize(cross(dpdx, dpdy));\n  }\n\n    #include <common>\n    #include <dithering_pars_fragment>\n    void main() {\n        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);\n        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);\n        float depth = texture2D(\n            sceneDepth,\n            vUv\n        ).x;\n        #ifdef HALFRES \n        vec4 texel;\n        if (depth == 1.0) {\n            texel = vec4(0.0, 0.0, 0.0, 1.0);\n        } else {\n        vec3 worldPos = getWorldPos(depth, vUv);\n        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);\n       // vec4 texel = texture2D(tDiffuse, vUv);\n       // Find closest depth;\n       float totalWeight = 0.0;\n       float radiusToUse = screenSpaceRadius ? distance(\n        worldPos,\n        getWorldPos(depth, vUv +\n          vec2(radius, 0.0) / resolution)\n      ) : radius;\n      float distanceFalloffToUse =screenSpaceRadius ?\n          radiusToUse * distanceFalloff\n      : distanceFalloff;\n        for(float x = -1.0; x <= 1.0; x++) {\n            for(float y = -1.0; y <= 1.0; y++) {\n                vec2 offset = vec2(x, y);\n                ivec2 p = ivec2(\n                    (vUv * resolution * 0.5) + offset\n                );\n                vec2 pUv = vec2(p) / (resolution * 0.5);\n                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;\n                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);\n                vec3 normalSample = sampleInfo.gba * 2.0 - 1.0;\n                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);\n                float tangentPlaneDist = abs(dot(worldPosSample - worldPos, normal));\n                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);\n                float weight = rangeCheck;\n                totalWeight += weight;\n                texel += sampleInfo * weight;\n            }\n        }\n        if (totalWeight == 0.0) {\n            texel = texture2D(tDiffuse, vUv);\n        } else {\n            texel /= totalWeight;\n        }\n    }\n        #else\n        vec4 texel = texture2D(tDiffuse, vUv);\n        #endif\n\n        #ifdef LOGDEPTH\n        texel.r = clamp(texel.r, 0.0, 1.0);\n        if (texel.r == 0.0) {\n          texel.r = 1.0;\n        }\n        #endif\n     \n        float finalAo = pow(texel.r, intensity);\n        float fogFactor;\n        float fogDepth = distance(\n            cameraPos,\n            getWorldPos(depth, vUv)\n        );\n        if (fog) {\n            if (fogExp) {\n                fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n            } else {\n                fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n            }\n        }\n        if (transparencyAware) {\n            float transparencyDWOff = texture2D(transparencyDWFalse, vUv).a;\n            float transparencyDWOn = texture2D(transparencyDWTrue, vUv).a;\n            float adjustmentFactorOff = transparencyDWOff;\n            float adjustmentFactorOn = (1.0 - transparencyDWOn) * (\n                texture2D(transparencyDWTrueDepth, vUv).r == texture2D(sceneDepth, vUv).r ? 1.0 : 0.0\n            );\n            float adjustmentFactor = max(adjustmentFactorOff, adjustmentFactorOn);\n            finalAo = mix(finalAo, 1.0, adjustmentFactor);\n        }\n        finalAo = mix(finalAo, 1.0, fogFactor);\n        vec3 aoApplied = color * mix(vec3(1.0), sceneTexel.rgb, float(colorMultiply));\n        if (renderMode == 0.0) {\n            gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);\n        } else if (renderMode == 1.0) {\n            gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);\n        } else if (renderMode == 2.0) {\n            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);\n        } else if (renderMode == 3.0) {\n            if (vUv.x < 0.5) {\n                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);\n            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {\n                gl_FragColor = vec4(1.0);\n            } else {\n                gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);\n            }\n        } else if (renderMode == 4.0) {\n            if (vUv.x < 0.5) {\n                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);\n            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {\n                gl_FragColor = vec4(1.0);\n            } else {\n                gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);\n            }\n        }\n        #include <dithering_fragment>\n        if (gammaCorrection) {\n            gl_FragColor = LinearTosRGB(gl_FragColor);\n        }\n    }\n    "},px={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new kl},viewMat:{value:new kl},projectionMatrixInv:{value:new kl},viewMatrixInv:{value:new kl},cameraPos:{value:new Qs},resolution:{value:new bs},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},depthWrite:!1,depthTest:!1,vertexShader:"\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = vec4(position, 1.0);\n\t\t}",fragmentShader:"\n\t\tuniform sampler2D sceneDiffuse;\n    uniform highp sampler2D sceneDepth;\n    uniform sampler2D tDiffuse;\n    uniform sampler2D blueNoise;\n    uniform mat4 projectionMatrixInv;\n    uniform mat4 viewMatrixInv;\n    uniform vec2 resolution;\n    uniform float r;\n    uniform float radius;\n     uniform float worldRadius;\n    uniform float index;\n     uniform float near;\n     uniform float far;\n     uniform float distanceFalloff;\n     uniform bool logDepth;\n     uniform bool screenSpaceRadius;\n    varying vec2 vUv;\n\n    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)\n    {\n        highp float z_n = 2.0 * d - 1.0;\n        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));\n    }\n    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {\n     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;\n     float a = farZ / (farZ - nearZ);\n     float b = farZ * nearZ / (nearZ - farZ);\n     float linDepth = a + b / depth;\n     return linearize_depth(linDepth, nearZ, farZ);\n   }\n   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {\n     return nearZ + (farZ - nearZ) * d;\n   }\n   vec3 getWorldPosLog(vec3 posS) {\n     vec2 uv = posS.xy;\n     float z = posS.z;\n     float nearZ =near;\n     float farZ = far;\n     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n     float a = farZ / (farZ - nearZ);\n     float b = farZ * nearZ / (nearZ - farZ);\n     float linDepth = a + b / depth;\n     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n     vec4 wpos = projectionMatrixInv * clipVec;\n     return wpos.xyz / wpos.w;\n   }\n    vec3 getWorldPos(float depth, vec2 coord) {\n     #ifdef LOGDEPTH\n          return getWorldPosLog(vec3(coord, depth));\n     #endif\n        \n        float z = depth * 2.0 - 1.0;\n        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n        // Perspective division\n       vec4 worldSpacePosition = viewSpacePosition;\n       worldSpacePosition.xyz /= worldSpacePosition.w;\n        return worldSpacePosition.xyz;\n    }\n    #include <common>\n    #define NUM_SAMPLES 16\n    uniform vec2 poissonDisk[NUM_SAMPLES];\n    void main() {\n        const float pi = 3.14159;\n        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n        vec2 uv = vUv;\n        vec4 data = texture2D(tDiffuse, vUv);\n        float occlusion = data.r;\n        float baseOcc = data.r;\n        vec3 normal = data.gba * 2.0 - 1.0;\n        float count = 1.0;\n        float d = texture2D(sceneDepth, vUv).x;\n        if (d == 1.0) {\n          gl_FragColor = data;\n          return;\n        }\n        vec3 worldPos = getWorldPos(d, vUv);\n        float size = radius;\n        float angle;\n        if (index == 0.0) {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;\n        } else if (index == 1.0) {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;\n        } else if (index == 2.0) {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;\n        } else {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;\n        }\n\n        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));\n        float radiusToUse = screenSpaceRadius ? distance(\n          worldPos,\n          getWorldPos(d, vUv +\n            vec2(worldRadius, 0.0) / resolution)\n        ) : worldRadius;\n        float distanceFalloffToUse =screenSpaceRadius ?\n        radiusToUse * distanceFalloff\n    : radiusToUse * distanceFalloff * 0.2;\n\n\n        for(int i = 0; i < NUM_SAMPLES; i++) {\n            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;\n            vec4 dataSample = texture2D(tDiffuse, uv + offset);\n            float occSample = dataSample.r;\n            vec3 normalSample = dataSample.gba * 2.0 - 1.0;\n            float dSample = texture2D(sceneDepth, uv + offset).x;\n            vec3 worldPosSample = getWorldPos(dSample, uv + offset);\n            float tangentPlaneDist = abs(dot(worldPosSample - worldPos, normal));\n            float rangeCheck = dSample == 1.0 ? 0.0 :exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));\n            occlusion += occSample * rangeCheck;\n            count += rangeCheck;\n        }\n        if (count > 0.0) {\n          occlusion /= count;\n        }\n        #ifdef LOGDEPTH\n          occlusion = clamp(occlusion, 0.0, 1.0);\n          if (occlusion == 0.0) {\n            occlusion = 1.0;\n          }\n        #endif\n        gl_FragColor = vec4(occlusion, 0.5 + 0.5 * normal);\n    }\n    "},mx={uniforms:{sceneDepth:{value:null},resolution:{value:new bs},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new kl},projectionMatrixInv:{value:new kl},logDepth:{value:!1}},depthWrite:!1,depthTest:!1,vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = vec4(position, 1);\n    }",fragmentShader:"\n    uniform highp sampler2D sceneDepth;\n    uniform vec2 resolution;\n    uniform float near;\n    uniform float far;\n    uniform bool logDepth;\n    uniform mat4 viewMatrixInv;\n    uniform mat4 projectionMatrixInv;\n    varying vec2 vUv;\n    layout(location = 1) out vec4 gNormal;\n    vec3 getWorldPosLog(vec3 posS) {\n        vec2 uv = posS.xy;\n        float z = posS.z;\n        float nearZ =near;\n        float farZ = far;\n        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n        float a = farZ / (farZ - nearZ);\n        float b = farZ * nearZ / (nearZ - farZ);\n        float linDepth = a + b / depth;\n        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n        vec4 wpos = projectionMatrixInv * clipVec;\n        return wpos.xyz / wpos.w;\n      }\n      vec3 getWorldPos(float depth, vec2 coord) {\n        if (logDepth) {\n          return getWorldPosLog(vec3(coord, depth));\n        }\n        float z = depth * 2.0 - 1.0;\n        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n        // Perspective division\n       vec4 worldSpacePosition = viewSpacePosition;\n       worldSpacePosition.xyz /= worldSpacePosition.w;\n        return worldSpacePosition.xyz;\n    }\n  \n    vec3 computeNormal(vec3 worldPos, vec2 vUv) {\n      ivec2 p = ivec2(vUv * resolution);\n      float c0 = texelFetch(sceneDepth, p, 0).x;\n      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;\n      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;\n      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;\n      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;\n      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;\n      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;\n      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;\n      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;\n  \n      float dl = abs((2.0 * l1 - l2) - c0);\n      float dr = abs((2.0 * r1 - r2) - c0);\n      float db = abs((2.0 * b1 - b2) - c0);\n      float dt = abs((2.0 * t1 - t2) - c0);\n  \n      vec3 ce = getWorldPos(c0, vUv).xyz;\n  \n      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz\n                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;\n      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz\n                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;\n  \n      return normalize(cross(dpdx, dpdy));\n  }\n    void main() {\n        vec2 uv = vUv - vec2(0.5) / resolution;\n        vec2 pixelSize = vec2(1.0) / resolution;\n        vec2[4] uvSamples;\n        uvSamples[0] = uv;\n        uvSamples[1] = uv + vec2(pixelSize.x, 0.0);\n        uvSamples[2] = uv + vec2(0.0, pixelSize.y);\n        uvSamples[3] = uv + pixelSize;\n        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;\n        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;\n        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;\n        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;\n        float minDepth = min(min(depth00, depth10), min(depth01, depth11));\n        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));\n        float targetDepth = minDepth;\n        // Checkerboard pattern to avoid artifacts\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { \n            targetDepth = maxDepth;\n        }\n        int chosenIndex = 0;\n        float[4] samples;\n        samples[0] = depth00;\n        samples[1] = depth10;\n        samples[2] = depth01;\n        samples[3] = depth11;\n        for(int i = 0; i < 4; ++i) {\n            if (samples[i] == targetDepth) {\n                chosenIndex = i;\n                break;\n            }\n        }\n        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);\n        gNormal = vec4(computeNormal(\n            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]\n        ), 0.0);\n    }"},vx="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",gx=Uint8Array.from(atob(vx),(function(e){return e.charCodeAt(0)}));function yx(e,t,n){if(t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE)){var r=t.getQueryParameter(e,t.QUERY_RESULT)/1e6;n.lastTime=r}else setTimeout((function(){yx(e,t,n)}),1)}var bx=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:512;return ax(this,t),(r=ex(this,t)).width=i,r.height=a,r.clear=!0,r.camera=n,r.scene=e,r.autosetGamma=!0,r.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new vu(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0,colorMultiply:!0,transparencyAware:!1,accumulate:!1},{set:function(e,t,n){var i=e[t];return e[t]=n,n.equals?n.equals(i)||r.firstFrame():i!==n&&r.firstFrame(),"aoSamples"===t&&i!==n&&r.configureAOPass(r.configuration.logarithmicDepthBuffer),"denoiseSamples"===t&&i!==n&&r.configureDenoisePass(r.configuration.logarithmicDepthBuffer),"halfRes"===t&&i!==n&&(r.configureAOPass(r.configuration.logarithmicDepthBuffer),r.configureHalfResTargets(),r.configureEffectCompositer(r.configuration.logarithmicDepthBuffer),r.setSize(r.width,r.height)),"depthAwareUpsampling"===t&&i!==n&&r.configureEffectCompositer(r.configuration.logarithmicDepthBuffer),"gammaCorrection"===t&&(r.autosetGamma=!1),"transparencyAware"===t&&i!==n&&(r.autoDetectTransparency=!1,r.configureTransparencyTarget()),!0}}),r.samples=[],r.samplesDenoise=[],r.autoDetectTransparency=!0,r.frames=0,r.lastViewMatrix=new kl,r.lastProjectionMatrix=new kl,r.configureEffectCompositer(r.configuration.logarithmicDepthBuffer),r.configureSampleDependentPasses(),r.configureHalfResTargets(),r.detectTransparency(),r.configureTransparencyTarget(),r.copyQuad=new hx(new gc({uniforms:{tDiffuse:{value:null}},depthWrite:!1,vertexShader:"\n            varying vec2 vUv;\n            void main() {\n                vUv = uv;\n                gl_Position = vec4(position, 1);\n            }\n            ",fragmentShader:"\n            uniform sampler2D tDiffuse;\n            varying vec2 vUv;\n            void main() {\n                gl_FragColor = texture2D(tDiffuse, vUv);\n            }\n            "})),r.writeTargetInternal=new Ws(r.width,r.height,{minFilter:Fi,magFilter:Fi,depthBuffer:!1}),r.readTargetInternal=new Ws(r.width,r.height,{minFilter:Fi,magFilter:Fi,depthBuffer:!1}),r.outputTargetInternal=new Ws(r.width,r.height,{minFilter:Fi,magFilter:Fi,depthBuffer:!1}),r.accumulationRenderTarget=new Ws(r.width,r.height,$b($b({minFilter:Fi,magFilter:Fi,depthBuffer:!1,format:ra,type:Qi,stencilBuffer:!1},"depthBuffer",!1),"alpha",!0)),r.accumulationQuad=new hx(new gc({uniforms:{frame:{value:0},tDiffuse:{value:null}},transparent:!0,opacity:1,vertexShader:"\n             varying vec2 vUv;\n             void main() {\n                 vUv = uv;\n                 gl_Position = vec4(position, 1);\n             }",fragmentShader:"\n             uniform sampler2D tDiffuse;\n             uniform float frame;\n                varying vec2 vUv;\n                void main() {\n                    vec4 color = texture2D(tDiffuse, vUv);\n                    gl_FragColor = vec4(color.rgb, 1.0 / (frame + 1.0));\n                }\n                "})),r.bluenoise=new Qf(gx,128,128),r.bluenoise.colorSpace=ho,r.bluenoise.wrapS=Li,r.bluenoise.wrapT=Li,r.bluenoise.minFilter=Di,r.bluenoise.magFilter=Di,r.bluenoise.needsUpdate=!0,r.lastTime=0,r.needsDepthTexture=!0,r.needsSwap=!0,r._r=new bs,r._c=new vu,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rx(e,t)}(t,e),sx(t,[{key:"configureHalfResTargets",value:function(){this.firstFrame(),this.configuration.halfRes?(this.depthDownsampleTarget=new Js(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=la,this.depthDownsampleTarget.texture[0].type=Zi,this.depthDownsampleTarget.texture[0].minFilter=Di,this.depthDownsampleTarget.texture[0].magFilter=Di,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=ra,this.depthDownsampleTarget.texture[1].type=Qi,this.depthDownsampleTarget.texture[1].minFilter=Di,this.depthDownsampleTarget.texture[1].magFilter=Di,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new hx(new gc(mx))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}},{key:"detectTransparency",value:function(){if(this.autoDetectTransparency){var e=!1;this.scene.traverse((function(t){t.material&&t.material.transparent&&(e=!0)})),e&&(this.configuration.transparencyAware=!0)}}},{key:"configureTransparencyTarget",value:function(){this.configuration.transparencyAware?(this.transparencyRenderTargetDWFalse=new Ws(this.width,this.height,{minFilter:Fi,magFilter:Di,type:Qi,format:ra}),this.transparencyRenderTargetDWTrue=new Ws(this.width,this.height,{minFilter:Fi,magFilter:Di,type:Qi,format:ra}),this.transparencyRenderTargetDWTrue.depthTexture=new mh(this.width,this.height,Ji),this.depthCopyPass=new hx(new gc({uniforms:{depthTexture:{value:this.depthTexture}},vertexShader:"\n            varying vec2 vUv;\n            void main() {\n                vUv = uv;\n                gl_Position = vec4(position, 1);\n            }",fragmentShader:"\n            uniform sampler2D depthTexture;\n            varying vec2 vUv;\n            void main() {\n               gl_FragDepth = texture2D(depthTexture, vUv).r + 0.00001;\n               gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n            }\n            "}))):(this.transparencyRenderTargetDWFalse&&(this.transparencyRenderTargetDWFalse.dispose(),this.transparencyRenderTargetDWFalse=null),this.transparencyRenderTargetDWTrue&&(this.transparencyRenderTargetDWTrue.dispose(),this.transparencyRenderTargetDWTrue=null),this.depthCopyPass&&(this.depthCopyPass.dispose(),this.depthCopyPass=null))}},{key:"renderTransparency",value:function(e){var t=this.scene.background,n=e.getClearColor(new vu),r=e.getClearAlpha(),i=new Map,a=e.autoClearDepth;this.scene.traverse((function(e){i.set(e,e.visible)})),this.scene.background=null,e.autoClearDepth=!1,e.setClearColor(new vu(0,0,0),0),this.depthCopyPass.material.uniforms.depthTexture.value=this.depthTexture,e.setRenderTarget(this.transparencyRenderTargetDWFalse),this.scene.traverse((function(e){e.material&&(e.visible=i.get(e)&&e.material.transparent&&!e.material.depthWrite&&!e.userData.treatAsOpaque)})),e.clear(!0,!0,!0),this.depthCopyPass.render(e),e.render(this.scene,this.camera),e.setRenderTarget(this.transparencyRenderTargetDWTrue),this.scene.traverse((function(e){e.material&&(e.visible=i.get(e)&&e.material.transparent&&e.material.depthWrite&&!e.userData.treatAsOpaque)})),e.clear(!0,!0,!0),this.depthCopyPass.render(e),e.render(this.scene,this.camera),this.scene.traverse((function(e){e.visible=i.get(e)})),e.setClearColor(n,r),this.scene.background=t,e.autoClearDepth=a}},{key:"configureSampleDependentPasses",value:function(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}},{key:"configureAOPass",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.firstFrame(),this.samples=this.generateHemisphereSamples(this.configuration.aoSamples);var t=Qb({},dx);t.fragmentShader=t.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),e&&(t.fragmentShader="#define LOGDEPTH\n"+t.fragmentShader),this.configuration.halfRes&&(t.fragmentShader="#define HALFRES\n"+t.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new gc(t)):this.effectShaderQuad=new hx(new gc(t))}},{key:"configureDenoisePass",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.firstFrame(),this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);var t=Qb({},px);t.fragmentShader=t.fragmentShader.replace("16",this.configuration.denoiseSamples),e&&(t.fragmentShader="#define LOGDEPTH\n"+t.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new gc(t)):this.poissonBlurQuad=new hx(new gc(t))}},{key:"configureEffectCompositer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.firstFrame();var t=Qb({},fx);e&&(t.fragmentShader="#define LOGDEPTH\n"+t.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(t.fragmentShader="#define HALFRES\n"+t.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new gc(t)):this.effectCompositerQuad=new hx(new gc(t))}},{key:"generateHemisphereSamples",value:function(e){for(var t=[],n=0;n<e;n++){var r=2.399963*n,i=Math.sqrt(n+.5)/Math.sqrt(e),a=i*Math.cos(r),o=i*Math.sin(r),s=Math.sqrt(1-(a*a+o*o));t.push(new Qs(a,o,s))}return t}},{key:"generateDenoiseSamples",value:function(e,t){for(var n=2*Math.PI*t/e,r=1/e,i=r,a=[],o=r,s=0,l=0;l<e;l++)a.push(new bs(Math.cos(s),Math.sin(s)).multiplyScalar(Math.pow(o,.75))),o+=i,s+=n;return a}},{key:"setSize",value:function(e,t){this.firstFrame(),this.width=e,this.height=t;var n=this.configuration.halfRes?.5:1;this.writeTargetInternal.setSize(e*n,t*n),this.readTargetInternal.setSize(e*n,t*n),this.accumulationRenderTarget.setSize(e*n,t*n),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(e*n,t*n),this.configuration.transparencyAware&&(this.transparencyRenderTargetDWFalse.setSize(e,t),this.transparencyRenderTargetDWTrue.setSize(e,t)),this.outputTargetInternal.setSize(e,t)}},{key:"setDepthTexture",value:function(e){this.depthTexture=e}},{key:"firstFrame",value:function(){this.needsFrame=!0}},{key:"render",value:function(e,t,n){var r,i,a,o=e.xr.enabled;e.xr.enabled=!1,e.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=e.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer)),this.detectTransparency(),t.texture.type===this.outputTargetInternal.texture.type&&t.texture.format===this.outputTargetInternal.texture.format||(this.outputTargetInternal.texture.type=t.texture.type,this.outputTargetInternal.texture.format=t.texture.format,this.outputTargetInternal.texture.needsUpdate=!0),this.camera.updateMatrixWorld(),this.lastViewMatrix.equals(this.camera.matrixWorldInverse)&&this.lastProjectionMatrix.equals(this.camera.projectionMatrix)&&this.configuration.accumulate&&!this.needsFrame?this.frame++:(e.setRenderTarget(this.accumulationRenderTarget),e.clear(!0,!0,!0),this.frame=0,this.needsFrame=!1),this.lastViewMatrix.copy(this.camera.matrixWorldInverse),this.lastProjectionMatrix.copy(this.camera.projectionMatrix),this.debugMode&&null===(i=(r=e.getContext()).getExtension("EXT_disjoint_timer_query_webgl2"))&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1),this.debugMode&&(a=r.createQuery(),r.beginQuery(i.TIME_ELAPSED_EXT,a)),this.configuration.transparencyAware&&this.renderTransparency(e),this._r.set(this.width,this.height);var s=this.configuration.aoRadius;if(this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(s*=.5),this.frame<1024/this.configuration.aoSamples){this.configuration.halfRes&&(e.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(e)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new Qs),this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=s,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectShaderQuad.material.uniforms.frame.value=this.frame,e.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(e);for(var l=0;l<this.configuration.denoiseIterations;l++){var u=[this.readTargetInternal,this.writeTargetInternal];this.writeTargetInternal=u[0],this.readTargetInternal=u[1],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new Qs),this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?.5:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=s,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=l,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(e)}e.setRenderTarget(this.accumulationRenderTarget);var c=e.autoClear;e.autoClear=!1,this.accumulationQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.accumulationQuad.material.uniforms.frame.value=this.frame,this.accumulationQuad.render(e),e.autoClear=c}this.configuration.transparencyAware&&(this.effectCompositerQuad.material.uniforms.transparencyDWFalse.value=this.transparencyRenderTargetDWFalse.texture,this.effectCompositerQuad.material.uniforms.transparencyDWTrue.value=this.transparencyRenderTargetDWTrue.texture,this.effectCompositerQuad.material.uniforms.transparencyDWTrueDepth.value=this.transparencyRenderTargetDWTrue.depthTexture,this.effectCompositerQuad.material.uniforms.transparencyAware.value=!0),this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=s,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.autosetGamma?this.renderToScreen:this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.accumulationRenderTarget.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),this.effectCompositerQuad.material.uniforms.colorMultiply.value=this.configuration.colorMultiply,this.effectCompositerQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new Qs),this.effectCompositerQuad.material.uniforms.fog.value=!!this.scene.fog,this.scene.fog&&(this.scene.fog.isFog?(this.effectCompositerQuad.material.uniforms.fogExp.value=!1,this.effectCompositerQuad.material.uniforms.fogNear.value=this.scene.fog.near,this.effectCompositerQuad.material.uniforms.fogFar.value=this.scene.fog.far):this.scene.fog.isFogExp2?(this.effectCompositerQuad.material.uniforms.fogExp.value=!0,this.effectCompositerQuad.material.uniforms.fogDensity.value=this.scene.fog.density):console.error("Unsupported fog type ".concat(this.scene.fog.constructor.name," in SSAOPass."))),e.setRenderTarget(this.outputTargetInternal),this.effectCompositerQuad.render(e),e.setRenderTarget(this.renderToScreen?null:n),this.copyQuad.material.uniforms.tDiffuse.value=this.outputTargetInternal.texture,this.copyQuad.render(e),this.debugMode&&(r.endQuery(i.TIME_ELAPSED_EXT),yx(a,r,this)),e.xr.enabled=o}},{key:"enableDebugMode",value:function(){this.debugMode=!0}},{key:"disableDebugMode",value:function(){this.debugMode=!1}},{key:"setDisplayMode",value:function(e){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(e)}},{key:"setQualityMode",value:function(e){"Performance"===e?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):"Low"===e?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):"Medium"===e?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):"High"===e?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):"Ultra"===e&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}}]),t}(Bb);Uint8Array.from(atob(vx),(function(e){return e.charCodeAt(0)}));var xx=n(4780),wx=n.n(xx),_x={},Ex=document.getElementById("connectInfo"),Tx=function(e,t){Ex.innerHTML="";var n;n=t?"<span style='color:green'></span>":"<span style='color:red'></span>",_x[e]=n;var r="";for(var i in _x)r+="".concat(i," - ").concat(_x[i],"<br>");Ex.innerHTML=r};function Sx(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null!==e[0].index,r=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),a={},o={},s=e[0].morphTargetsRelative,l=new qu,u=0,c=0;c<e.length;++c){var h=e[c],d=0;if(n!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var f in h.attributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[f]&&(a[f]=[]),a[f].push(h.attributes[f]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(s!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var p in h.morphAttributes){if(!i.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[p]&&(o[p]=[]),o[p].push(h.morphAttributes[p])}if(t){var m=void 0;if(n)m=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;m=h.attributes.position.count}l.addGroup(u,m,c),u+=m}}if(n){for(var v=0,g=[],y=0;y<e.length;++y){for(var b=e[y].index,x=0;x<b.count;++x)g.push(b.getX(x)+v);v+=e[y].attributes.position.count}l.setIndex(g)}for(var w in a){var _=Mx(a[w]);if(!_)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+w+" attribute."),null;l.setAttribute(w,_)}for(var E in o){var T=o[E][0].length;if(0===T)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[E]=[];for(var S=0;S<T;++S){for(var M=[],A=0;A<o[E].length;++A)M.push(o[E][A][S]);var k=Mx(M);if(!k)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+E+" morphAttribute."),null;l.morphAttributes[E].push(k)}}return l}function Mx(e){for(var t,n,r,i=-1,a=0,o=0;o<e.length;++o){var s=e[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===r&&(r=s.normalized),r!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===i&&(i=s.gpuType),i!==s.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=s.array.length}for(var l=new t(a),u=0,c=0;c<e.length;++c)l.set(e[c].array,u),u+=e[c].array.length;var h=new ku(l,n,r);return void 0!==i&&(h.gpuType=i),h}function Ax(e,t){if(t===no)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===io||t===ro){var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)r.push(a);e.setIndex(r),n=e.getIndex()}var o=n.count-2,s=[];if(t===io)for(var l=1;l<=o;l++)s.push(n.getX(0)),s.push(n.getX(l)),s.push(n.getX(l+1));else for(var u=0;u<o;u++)u%2==0?(s.push(n.getX(u)),s.push(n.getX(u+1)),s.push(n.getX(u+2))):(s.push(n.getX(u+2)),s.push(n.getX(u+1)),s.push(n.getX(u)));s.length/3!==o&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c.clearGroups(),c}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}function kx(e,t,n){if(Px())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&Rx(i,n.prototype),i}function Px(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Px=function(){return!!e})()}function Rx(e,t){return Rx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rx(e,t)}function Cx(e){return function(e){if(Array.isArray(e))return Lx(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Lx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lx(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ix={},Ox=function(t){var n;switch(t.type){case"ShapeGeometry":var r=new Lm;t.shapeArgs.forEach((function(e){var t;return(t=r)[e.draw].apply(t,Cx(e.drawArgs))})),(n={args:t.args,geometry:new hv(r)}).edges=new Cm(n.geometry);break;case"ExtrudeGeometry":r=new Lm,t.shapeArgs.forEach((function(e){var t;return(t=r)[e.draw].apply(t,Cx(e.drawArgs))})),(n={geometry:new ov(r,t.extrudeSettings)}).edges=new Cm(n.geometry);break;case"ParametricGeometry":case"TubeGeometry":var i=new qu;i.setAttribute("position",new ku(t.attributes.position.array,t.attributes.position.itemSize,t.attributes.position.Boolean)),i.setAttribute("normal",new ku(t.attributes.normal.array,t.attributes.normal.itemSize,t.attributes.normal.Boolean)),i.setAttribute("uv",new ku(t.attributes.uv.array,t.attributes.uv.itemSize,t.attributes.uv.Boolean)),i.setIndex(new ku(t.index.array,t.index.itemSize,t.index.Boolean)),(n={geometry:i}).edges=new Cm(n.geometry);break;default:if(Ix.hasOwnProperty(t.type)){var a=!1;Ix[t.type].forEach((function(e){if(e.args.length===t.args.length){for(var r=!0,i=0;i<e.args.length;i++)e.args[i]===t.args[i]||(r=!1);r&&(a=!0,(n=e).count++,n.instances=[])}})),a||((n={args:t.args,geometry:kx(e[t.type],Cx(t.args)),count:0}).edges=new Cm(n.geometry),Ix[t.type].push(n))}else Ix[t.type]=[],(n={args:t.args,geometry:kx(e[t.type],Cx(t.args)),count:0}).edges=new Cm(n.geometry),Ix[t.type].push(n)}return n};function Dx(e){return Dx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dx(e)}function Nx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bx(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ux,zx,Fx,Hx,jx,Gx,Vx,Wx,qx,Xx,Yx,Kx,Jx={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Zx={duration:.5,overwrite:!1,delay:0},Qx=1e8,$x=1e-8,ew=2*Math.PI,tw=ew/4,nw=0,rw=Math.sqrt,iw=Math.cos,aw=Math.sin,ow=function(e){return"string"==typeof e},sw=function(e){return"function"==typeof e},lw=function(e){return"number"==typeof e},uw=function(e){return void 0===e},cw=function(e){return"object"===Dx(e)},hw=function(e){return!1!==e},dw=function(){return"undefined"!=typeof window},fw=function(e){return sw(e)||ow(e)},pw="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},mw=Array.isArray,vw=/(?:-?\.?\d|\.)+/gi,gw=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,yw=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,bw=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,xw=/[+-]=-?[.\d]+/,ww=/[^,'"\[\]\s]+/gi,_w=/[\d.+\-=]+(?:e[-+]\d*)*/i,Ew={},Tw={},Sw=function(e){return(Tw=Jw(e,Ew))&&OE},Mw=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Aw=function(e,t){return!t&&console.warn(e)},kw=function(e,t){return e&&(Ew[e]=t)&&Tw&&(Tw[e]=t)||Ew},Pw=function(){return 0},Rw={},Cw=[],Lw={},Iw={},Ow={},Dw=30,Nw=[],Bw="",Uw=function(e){var t,n,r=e[0];if(cw(r)||sw(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(n=Nw.length;n--&&!Nw[n].targetTest(r););t=Nw[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new aE(e[n],t)))||e.splice(n,1);return e},zw=function(e){return e._gsap||Uw(S_(e))[0]._gsap},Fw=function(e,t,n){return(n=e[t])&&sw(n)?e[t]():uw(n)&&e.getAttribute&&e.getAttribute(t)||n},Hw=function(e,t){return(e=e.split(",")).forEach(t)||e},jw=function(e){return Math.round(1e5*e)/1e5||0},Gw=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},Vw=function(){var e,t,n=Cw.length,r=Cw.slice(0);for(Lw={},Cw.length=0,e=0;e<n;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},Ww=function(e,t,n,r){Cw.length&&Vw(),e.render(t,n,r),Cw.length&&Vw()},qw=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(ww).length<2?t:ow(e)?e.trim():e},Xw=function(e){return e},Yw=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Kw=function(e,t){for(var n in t)n in e||"duration"===n||"ease"===n||(e[n]=t[n])},Jw=function(e,t){for(var n in t)e[n]=t[n];return e},Zw=function e(t,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(t[r]=cw(n[r])?e(t[r]||(t[r]={}),n[r]):n[r]);return t},Qw=function(e,t){var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},$w=function(e){var t=e.parent||zx,n=e.keyframes?Kw:Yw;if(hw(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},e_=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=t._prev,a=t._next;i?i._next=a:e[n]===t&&(e[n]=a),a?a._prev=i:e[r]===t&&(e[r]=i),t._next=t._prev=t.parent=null},t_=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},n_=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},r_=function e(t){return!t||t._ts&&e(t.parent)},i_=function(e){return e._repeat?a_(e._tTime,e=e.duration()+e._rDelay)*e:0},a_=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},o_=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},s_=function(e){return e._end=jw(e._start+(e._tDur/Math.abs(e._ts||e._rts||$x)||0))},l_=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=jw(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),s_(e),n._dirty||n_(n,e)),e},u_=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=o_(e.rawTime(),t),(!t._dur||w_(0,t.totalDuration(),n)-t._tTime>$x)&&t.render(n,!0)),n_(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},c_=function(e,t,n,r){return t.parent&&t_(t),t._start=jw((lw(n)?n:n||e!==zx?y_(e,n,t):e._time)+t._delay),t._end=jw(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),function(e,t,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var a,o=e[r];if(i)for(a=t[i];o&&o[i]>a;)o=o._prev;o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e}(e,t,"_first","_last",e._sort?"_start":0),p_(t)||(e._recent=t),r||u_(e,t),e},h_=function(e,t){return(Ew.ScrollTrigger||Mw("scrollTrigger",t))&&Ew.ScrollTrigger.create(t,e)},d_=function(e,t,n,r){return dE(e,t),e._initted?!n&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&Vx!==q_.frame?(Cw.push(e),e._lazy=[t,r],1):void 0:1},f_=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},p_=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},m_=function(e,t,n,r){var i=e._repeat,a=jw(t)||0,o=e._tTime/e._tDur;return o&&!r&&(e._time*=a/e._dur),e._dur=a,e._tDur=i?i<0?1e10:jw(a*(i+1)+e._rDelay*i):a,o&&!r?l_(e,e._tTime=e._tDur*o):e.parent&&s_(e),n||n_(e.parent,e),e},v_=function(e){return e instanceof sE?n_(e):m_(e,e._dur)},g_={_start:0,endTime:Pw,totalDuration:Pw},y_=function e(t,n,r){var i,a,o,s=t.labels,l=t._recent||g_,u=t.duration()>=Qx?l.endTime(!1):t._dur;return ow(n)&&(isNaN(n)||n in s)?(a=n.charAt(0),o="%"===n.substr(-1),i=n.indexOf("="),"<"===a||">"===a?(i>=0&&(n=n.replace(/=/,"")),("<"===a?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(i<0?l:r).totalDuration()/100:1)):i<0?(n in s||(s[n]=u),s[n]):(a=parseFloat(n.charAt(i-1)+n.substr(i+1)),o&&r&&(a=a/100*(mw(r)?r[0]:r).totalDuration()),i>1?e(t,n.substr(0,i-1),r)+a:u+a)):null==n?u:+n},b_=function(e,t,n){var r,i,a=lw(t[1]),o=(a?2:1)+(e<2?0:1),s=t[o];if(a&&(s.duration=t[1]),s.parent=n,e){for(r=s,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=hw(i.vars.inherit)&&i.parent;s.immediateRender=hw(r.immediateRender),e<2?s.runBackwards=1:s.startAt=t[o-1]}return new vE(t[0],s,t[o+1])},x_=function(e,t){return e||0===e?t(e):t},w_=function(e,t,n){return n<e?e:n>t?t:n},__=function(e){if("string"!=typeof e)return"";var t=_w.exec(e);return t?e.substr(t.index+t[0].length):""},E_=[].slice,T_=function(e,t){return e&&cw(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&cw(e[0]))&&!e.nodeType&&e!==Fx},S_=function(e,t,n){return!ow(e)||n||!Hx&&X_()?mw(e)?function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var r;return ow(e)&&!t||T_(e,1)?(r=n).push.apply(r,S_(e)):n.push(e)}))||n}(e,n):T_(e)?E_.call(e,0):e?[e]:[]:E_.call((t||jx).querySelectorAll(e),0)},M_=function(e){return e.sort((function(){return.5-Math.random()}))},A_=function(e){if(sw(e))return e;var t=cw(e)?e:{each:e},n=eE(t.ease),r=t.from||0,i=parseFloat(t.base)||0,a={},o=r>0&&r<1,s=isNaN(r)||o,l=t.axis,u=r,c=r;return ow(r)?u=c={center:.5,edges:.5,end:1}[r]||0:!o&&s&&(u=r[0],c=r[1]),function(e,o,h){var d,f,p,m,v,g,y,b,x,w=(h||t).length,_=a[w];if(!_){if(!(x="auto"===t.grid?0:(t.grid||[1,Qx])[1])){for(y=-Qx;y<(y=h[x++].getBoundingClientRect().left)&&x<w;);x--}for(_=a[w]=[],d=s?Math.min(x,w)*u-.5:r%x,f=s?w*c/x-.5:r/x|0,y=0,b=Qx,g=0;g<w;g++)p=g%x-d,m=f-(g/x|0),_[g]=v=l?Math.abs("y"===l?m:p):rw(p*p+m*m),v>y&&(y=v),v<b&&(b=v);"random"===r&&M_(_),_.max=y-b,_.min=b,_.v=w=(parseFloat(t.amount)||parseFloat(t.each)*(x>w?w-1:l?"y"===l?w/x:x:Math.max(x,w/x))||0)*("edges"===r?-1:1),_.b=w<0?i-w:i,_.u=__(t.amount||t.each)||0,n=n&&w<0?Q_(n):n}return w=(_[e]-_.min)/_.max||0,jw(_.b+(n?n(w):w)*_.v)+_.u}},k_=function(e){var t=e<1?Math.pow(10,(e+"").length-2):1;return function(n){var r=Math.round(parseFloat(n)/e)*e*t;return(r-r%1)/t+(lw(n)?0:__(n))}},P_=function(e,t){var n,r,i=mw(e);return!i&&cw(e)&&(n=i=e.radius||Qx,e.values?(e=S_(e.values),(r=!lw(e[0]))&&(n*=n)):e=k_(e.increment)),x_(t,i?sw(e)?function(t){return r=e(t),Math.abs(r-t)<=n?r:t}:function(t){for(var i,a,o=parseFloat(r?t.x:t),s=parseFloat(r?t.y:0),l=Qx,u=0,c=e.length;c--;)(i=r?(i=e[c].x-o)*i+(a=e[c].y-s)*a:Math.abs(e[c]-o))<l&&(l=i,u=c);return u=!n||l<=n?e[u]:t,r||u===t||lw(t)?u:u+__(t)}:k_(e))},R_=function(e,t,n,r){return x_(mw(e)?!t:!0===n?!!(n=0):!r,(function(){return mw(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r}))},C_=function(e,t,n){return x_(n,(function(n){return e[~~t(n)]}))},L_=function(e){for(var t,n,r,i,a=0,o="";~(t=e.indexOf("random(",a));)r=e.indexOf(")",t),i="["===e.charAt(t+7),n=e.substr(t+7,r-t-7).match(i?ww:vw),o+=e.substr(a,t-a)+R_(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),a=r+1;return o+e.substr(a,e.length-a)},I_=function(e,t,n,r,i){var a=t-e,o=r-n;return x_(i,(function(t){return n+((t-e)/a*o||0)}))},O_=function(e,t,n){var r,i,a,o=e.labels,s=Qx;for(r in o)(i=o[r]-t)<0==!!n&&i&&s>(i=Math.abs(i))&&(a=r,s=i);return a},D_=function(e,t,n){var r,i,a=e.vars,o=a[t];if(o)return r=a[t+"Params"],i=a.callbackScope||e,n&&Cw.length&&Vw(),r?o.apply(i,r):o.call(i)},N_=function(e){return t_(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&D_(e,"onInterrupt"),e},B_=255,U_={aqua:[0,B_,B_],lime:[0,B_,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,B_],navy:[0,0,128],white:[B_,B_,B_],olive:[128,128,0],yellow:[B_,B_,0],orange:[B_,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[B_,0,0],pink:[B_,192,203],cyan:[0,B_,B_],transparent:[B_,B_,B_,0]},z_=function(e,t,n){return(6*(e=e<0?e+1:e>1?e-1:e)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*B_+.5|0},F_=function(e,t,n){var r,i,a,o,s,l,u,c,h,d,f=e?lw(e)?[e>>16,e>>8&B_,e&B_]:0:U_.black;if(!f){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),U_[e])f=U_[e];else if("#"===e.charAt(0)){if(e.length<6&&(r=e.charAt(1),i=e.charAt(2),a=e.charAt(3),e="#"+r+r+i+i+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(f=parseInt(e.substr(1,6),16))>>16,f>>8&B_,f&B_,parseInt(e.substr(7),16)/255];f=[(e=parseInt(e.substr(1),16))>>16,e>>8&B_,e&B_]}else if("hsl"===e.substr(0,3))if(f=d=e.match(vw),t){if(~e.indexOf("="))return f=e.match(gw),n&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,s=+f[1]/100,r=2*(l=+f[2]/100)-(i=l<=.5?l*(s+1):l+s-l*s),f.length>3&&(f[3]*=1),f[0]=z_(o+1/3,r,i),f[1]=z_(o,r,i),f[2]=z_(o-1/3,r,i);else f=e.match(vw)||U_.transparent;f=f.map(Number)}return t&&!d&&(r=f[0]/B_,i=f[1]/B_,a=f[2]/B_,l=((u=Math.max(r,i,a))+(c=Math.min(r,i,a)))/2,u===c?o=s=0:(h=u-c,s=l>.5?h/(2-u-c):h/(u+c),o=u===r?(i-a)/h+(i<a?6:0):u===i?(a-r)/h+2:(r-i)/h+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*s+.5),f[2]=~~(100*l+.5)),n&&f.length<4&&(f[3]=1),f},H_=function(e){var t=[],n=[],r=-1;return e.split(G_).forEach((function(e){var i=e.match(yw)||[];t.push.apply(t,i),n.push(r+=i.length+1)})),t.c=n,t},j_=function(e,t,n){var r,i,a,o,s="",l=(e+s).match(G_),u=t?"hsla(":"rgba(",c=0;if(!l)return e;if(l=l.map((function(e){return(e=F_(e,t,1))&&u+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(a=H_(e),(r=n.c).join(s)!==a.c.join(s)))for(o=(i=e.replace(G_,"1").split(yw)).length-1;c<o;c++)s+=i[c]+(~r.indexOf(c)?l.shift()||u+"0,0,0,0)":(a.length?a:l.length?l:n).shift());if(!i)for(o=(i=e.split(G_)).length-1;c<o;c++)s+=i[c]+l[c];return s+i[o]},G_=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in U_)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),V_=/hsl[a]?\(/,W_=function(e){var t,n=e.join(" ");if(G_.lastIndex=0,G_.test(n))return t=V_.test(n),e[1]=j_(e[1],t),e[0]=j_(e[0],t,H_(e[1])),!0},q_=function(){var e,t,n,r,i,a,o=Date.now,s=500,l=33,u=o(),c=u,h=1e3/240,d=h,f=[],p=function n(p){var m,v,g,y,b=o()-c,x=!0===p;if(b>s&&(u+=b-l),((m=(g=(c+=b)-u)-d)>0||x)&&(y=++r.frame,i=g-1e3*r.time,r.time=g/=1e3,d+=m+(m>=h?4:h-m),v=1),x||(e=t(n)),v)for(a=0;a<f.length;a++)f[a](g,i,y,p)};return r={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(e){return i/(1e3/(e||60))},wake:function(){Gx&&(!Hx&&dw()&&(Fx=Hx=window,jx=Fx.document||{},Ew.gsap=OE,(Fx.gsapVersions||(Fx.gsapVersions=[])).push(OE.version),Sw(Tw||Fx.GreenSockGlobals||!Fx.gsap&&Fx||{}),n=Fx.requestAnimationFrame),e&&r.sleep(),t=n||function(e){return setTimeout(e,d-1e3*r.time+1|0)},qx=1,p(2))},sleep:function(){(n?Fx.cancelAnimationFrame:clearTimeout)(e),qx=0,t=Pw},lagSmoothing:function(e,t){s=e||1e8,l=Math.min(t,s,0)},fps:function(e){h=1e3/(e||240),d=1e3*r.time+h},add:function(e){f.indexOf(e)<0&&f.push(e),X_()},remove:function(e){var t;~(t=f.indexOf(e))&&f.splice(t,1)&&a>=t&&a--},_listeners:f},r}(),X_=function(){return!qx&&q_.wake()},Y_={},K_=/^[\d.\-M][\d.\-,\s]/,J_=/["']/g,Z_=function(e){for(var t,n,r,i={},a=e.substr(1,e.length-3).split(":"),o=a[0],s=1,l=a.length;s<l;s++)n=a[s],t=s!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,t),i[o]=isNaN(r)?r.replace(J_,"").trim():+r,o=n.substr(t+1).trim();return i},Q_=function(e){return function(t){return 1-e(1-t)}},$_=function e(t,n){for(var r,i=t._first;i;)i instanceof sE?e(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?e(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},eE=function(e,t){return e&&(sw(e)?e:Y_[e]||function(e){var t=(e+"").split("("),n=Y_[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[Z_(t[1])]:function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<n?e.indexOf(")",n+1):n)}(e).split(",").map(qw)):Y_._CE&&K_.test(e)?Y_._CE("",e):n}(e))||t},tE=function(e,t,n,r){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===r&&(r=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,a={easeIn:t,easeOut:n,easeInOut:r};return Hw(e,(function(e){for(var t in Y_[e]=Ew[e]=a,Y_[i=e.toLowerCase()]=n,a)Y_[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Y_[e+"."+t]=a[t]})),a},nE=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},rE=function e(t,n,r){var i=n>=1?n:1,a=(r||(t?.3:.45))/(n<1?n:1),o=a/ew*(Math.asin(1/i)||0),s=function(e){return 1===e?1:i*Math.pow(2,-10*e)*aw((e-o)*a)+1},l="out"===t?s:"in"===t?function(e){return 1-s(1-e)}:nE(s);return a=ew/a,l.config=function(n,r){return e(t,n,r)},l},iE=function e(t,n){void 0===n&&(n=1.70158);var r=function(e){return e?--e*e*((n+1)*e+n)+1:0},i="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:nE(r);return i.config=function(n){return e(t,n)},i};Hw("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;tE(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),Y_.Linear.easeNone=Y_.none=Y_.Linear.easeIn,tE("Elastic",rE("in"),rE("out"),rE()),Xx=7.5625,Yx=2.75,Kx=function(e){return e<.36363636363636365?Xx*e*e:e<.7272727272727273?Xx*Math.pow(e-1.5/Yx,2)+.75:e<.9090909090909092?Xx*(e-=2.25/Yx)*e+.9375:Xx*Math.pow(e-2.625/Yx,2)+.984375},tE("Bounce",(function(e){return 1-Kx(1-e)}),Kx),tE("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),tE("Circ",(function(e){return-(rw(1-e*e)-1)})),tE("Sine",(function(e){return 1===e?1:1-iw(e*tw)})),tE("Back",iE("in"),iE("out"),iE()),Y_.SteppedEase=Y_.steps=Ew.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),i=t?1:0;return function(e){return((r*w_(0,.99999999,e)|0)+i)*n}}},Zx.ease=Y_["quad.out"],Hw("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return Bw+=e+","+e+"Params,"}));var aE=function(e,t){this.id=nw++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Fw,this.set=t?t.getSetter:wE},oE=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,m_(this,+e.duration,1,1),this.data=e.data,qx||q_.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,m_(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(X_(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(l_(this,e),!n._dp||n.parent||u_(n,this);n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&c_(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===$x||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),Ww(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+i_(this))%this._dur||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+i_(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?a_(this._tTime,n)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?o_(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this.totalTime(w_(-this._delay,this._tDur,t),!0))},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(X_(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=$x)&&Math.abs(this._zTime)!==$x))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&c_(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(hw(e)?this.totalDuration():this.duration())/Math.abs(this._ts)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?o_(t.rawTime(e),this):this._tTime:this._tTime},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(t._ts||1),t=t._dp;return n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,v_(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){return arguments.length?(this._rDelay=e,v_(this)):this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(y_(this,e),hw(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,hw(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-$x))},t.eventCallback=function(e,t,n){var r=this.vars;return arguments.length>1?(t?(r[e]=t,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(e){var t=this;return new Promise((function(n){var r=sw(e)?e:Xw,i=function(){var e=t.then;t.then=null,sw(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){N_(this)},e}();Yw(oE.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var sE=function(e){function t(t,n){var r;return void 0===t&&(t={}),(r=e.call(this,t)||this).labels={},r.smoothChildTiming=!!t.smoothChildTiming,r.autoRemoveChildren=!!t.autoRemoveChildren,r._sort=hw(t.sortChildren),zx&&c_(t.parent||zx,Nx(r),n),t.reversed&&r.reverse(),t.paused&&r.paused(!0),t.scrollTrigger&&h_(Nx(r),t.scrollTrigger),r}Bx(t,e);var n=t.prototype;return n.to=function(e,t,n){return b_(0,arguments,this),this},n.from=function(e,t,n){return b_(1,arguments,this),this},n.fromTo=function(e,t,n,r){return b_(2,arguments,this),this},n.set=function(e,t,n){return t.duration=0,t.parent=this,$w(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new vE(e,t,y_(this,n),1),this},n.call=function(e,t,n){return c_(this,vE.delayedCall(0,e,t),n)},n.staggerTo=function(e,t,n,r,i,a,o){return n.duration=t,n.stagger=n.stagger||r,n.onComplete=a,n.onCompleteParams=o,n.parent=this,new vE(e,n,y_(this,i)),this},n.staggerFrom=function(e,t,n,r,i,a,o){return n.runBackwards=1,$w(n).immediateRender=hw(n.immediateRender),this.staggerTo(e,t,n,r,i,a,o)},n.staggerFromTo=function(e,t,n,r,i,a,o,s){return r.startAt=n,$w(r).immediateRender=hw(r.immediateRender),this.staggerTo(e,t,r,i,a,o,s)},n.render=function(e,t,n){var r,i,a,o,s,l,u,c,h,d,f,p,m=this._time,v=this._dirty?this.totalDuration():this._tDur,g=this._dur,y=this!==zx&&e>v-$x&&e>=0?v:e<$x?0:e,b=this._zTime<0!=e<0&&(this._initted||!g);if(y!==this._tTime||n||b){if(m!==this._time&&g&&(y+=this._time-m,e+=this._time-m),r=y,h=this._start,l=!(c=this._ts),b&&(g||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(f=this._yoyo,s=g+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*s+e,t,n);if(r=jw(y%s),y===v?(o=this._repeat,r=g):((o=~~(y/s))&&o===y/s&&(r=g,o--),r>g&&(r=g)),d=a_(this._tTime,s),!m&&this._tTime&&d!==o&&(d=o),f&&1&o&&(r=g-r,p=1),o!==d&&!this._lock){var x=f&&1&d,w=x===(f&&1&o);if(o<d&&(x=!x),m=x?0:g,this._lock=1,this.render(m||(p?0:jw(o*s)),t,!g)._lock=0,this._tTime=y,!t&&this.parent&&D_(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(g=this._dur,v=this._tDur,w&&(this._lock=2,m=x?g:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;$_(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(u=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if(!r._dur&&"isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(!r._dur&&"isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,jw(m),jw(r)),u&&(y-=r-(r=u._start))),this._tTime=y,this._time=r,this._act=!c,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&r&&!t&&(D_(this,"onStart"),this._tTime!==y))return this;if(r>=m&&e>=0)for(i=this._first;i;){if(a=i._next,(i._act||r>=i._start)&&i._ts&&u!==i){if(i.parent!==this)return this.render(e,t,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,t,n),r!==this._time||!this._ts&&!l){u=0,a&&(y+=this._zTime=-1e-8);break}}i=a}else{i=this._last;for(var _=e<0?e:r;i;){if(a=i._prev,(i._act||_<=i._end)&&i._ts&&u!==i){if(i.parent!==this)return this.render(e,t,n);if(i.render(i._ts>0?(_-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(_-i._start)*i._ts,t,n),r!==this._time||!this._ts&&!l){u=0,a&&(y+=this._zTime=_?-1e-8:$x);break}}i=a}}if(u&&!t&&(this.pause(),u.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=h,s_(this),this.render(e,t,n);this._onUpdate&&!t&&D_(this,"onUpdate",!0),(y===v&&v>=this.totalDuration()||!y&&m)&&(h!==this._start&&Math.abs(c)===Math.abs(this._ts)||this._lock||((e||!g)&&(y===v&&this._ts>0||!y&&this._ts<0)&&t_(this,1),t||e<0&&!m||!y&&!m&&v||(D_(this,y===v&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<v&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(e,t){var n=this;if(lw(t)||(t=y_(this,t,e)),!(e instanceof oE)){if(mw(e))return e.forEach((function(e){return n.add(e,t)})),this;if(ow(e))return this.addLabel(e,t);if(!sw(e))return this;e=vE.delayedCall(0,e)}return this!==e?c_(this,e,t):this},n.getChildren=function(e,t,n,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=-Qx);for(var i=[],a=this._first;a;)a._start>=r&&(a instanceof vE?t&&i.push(a):(n&&i.push(a),e&&i.push.apply(i,a.getChildren(!0,t,n)))),a=a._next;return i},n.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},n.remove=function(e){return ow(e)?this.removeLabel(e):sw(e)?this.killTweensOf(e):(e_(this,e),e===this._recent&&(this._recent=this._last),n_(this))},n.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=jw(q_.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},n.addLabel=function(e,t){return this.labels[e]=y_(this,t),this},n.removeLabel=function(e){return delete this.labels[e],this},n.addPause=function(e,t,n){var r=vE.delayedCall(0,t||Pw,n);return r.data="isPause",this._hasPause=1,c_(this,r,y_(this,e))},n.removePause=function(e){var t=this._first;for(e=y_(this,e);t;)t._start===e&&"isPause"===t.data&&t_(t),t=t._next},n.killTweensOf=function(e,t,n){for(var r=this.getTweensOf(e,n),i=r.length;i--;)lE!==r[i]&&r[i].kill(e,t);return this},n.getTweensOf=function(e,t){for(var n,r=[],i=S_(e),a=this._first,o=lw(t);a;)a instanceof vE?Gw(a._targets,i)&&(o?(!lE||a._initted&&a._ts)&&a.globalTime(0)<=t&&a.globalTime(a.totalDuration())>t:!t||a.isActive())&&r.push(a):(n=a.getTweensOf(i,t)).length&&r.push.apply(r,n),a=a._next;return r},n.tweenTo=function(e,t){t=t||{};var n,r=this,i=y_(r,e),a=t,o=a.startAt,s=a.onStart,l=a.onStartParams,u=a.immediateRender,c=vE.to(r,Yw({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale())||$x,onStart:function(){if(r.pause(),!n){var e=t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale());c._dur!==e&&m_(c,e,0,1).render(c._time,!0,!0),n=1}s&&s.apply(c,l||[])}},t));return u?c.render(0):c},n.tweenFromTo=function(e,t,n){return this.tweenTo(t,Yw({startAt:{time:y_(this,e)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(e){return void 0===e&&(e=this._time),O_(this,y_(this,e))},n.previousLabel=function(e){return void 0===e&&(e=this._time),O_(this,y_(this,e),1)},n.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+$x)},n.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var r,i=this._first,a=this.labels;i;)i._start>=n&&(i._start+=e,i._end+=e),i=i._next;if(t)for(r in a)a[r]>=n&&(a[r]+=e);return n_(this)},n.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},n.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),n_(this)},n.totalDuration=function(e){var t,n,r,i=0,a=this,o=a._last,s=Qx;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-e:e));if(a._dirty){for(r=a.parent;o;)t=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>s&&a._sort&&o._ts&&!a._lock?(a._lock=1,c_(a,o,n-o._delay,1)._lock=0):s=n,n<0&&o._ts&&(i-=n,(!r&&!a._dp||r&&r.smoothChildTiming)&&(a._start+=n/a._ts,a._time-=n,a._tTime-=n),a.shiftChildren(-n,!1,-Infinity),s=0),o._end>i&&o._ts&&(i=o._end),o=t;m_(a,a===zx&&a._time>i?a._time:i,1,1),a._dirty=0}return a._tDur},t.updateRoot=function(e){if(zx._ts&&(Ww(zx,o_(e,zx)),Vx=q_.frame),q_.frame>=Dw){Dw+=Jx.autoSleep||120;var t=zx._first;if((!t||!t._ts)&&Jx.autoSleep&&q_._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||q_.sleep()}}},t}(oE);Yw(sE.prototype,{_lock:0,_hasPause:0,_forcing:0});var lE,uE=function(e,t,n,r,i,a,o){var s,l,u,c,h,d,f,p,m=new RE(this._pt,e,t,0,1,TE,null,i),v=0,g=0;for(m.b=n,m.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=L_(r)),a&&(a(p=[n,r],e,t),n=p[0],r=p[1]),l=n.match(bw)||[];s=bw.exec(r);)c=s[0],h=r.substring(v,s.index),u?u=(u+1)%5:"rgba("===h.substr(-5)&&(u=1),c!==l[g++]&&(d=parseFloat(l[g-1])||0,m._pt={_next:m._pt,p:h||1===g?h:",",s:d,c:"="===c.charAt(1)?parseFloat(c.substr(2))*("-"===c.charAt(0)?-1:1):parseFloat(c)-d,m:u&&u<4?Math.round:0},v=bw.lastIndex);return m.c=v<r.length?r.substring(v,r.length):"",m.fp=o,(xw.test(r)||f)&&(m.e=0),this._pt=m,m},cE=function(e,t,n,r,i,a,o,s,l){sw(r)&&(r=r(i||0,e,a));var u,c=e[t],h="get"!==n?n:sw(c)?l?e[t.indexOf("set")||!sw(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():c,d=sw(c)?l?bE:yE:gE;if(ow(r)&&(~r.indexOf("random(")&&(r=L_(r)),"="===r.charAt(1)&&((u=parseFloat(h)+parseFloat(r.substr(2))*("-"===r.charAt(0)?-1:1)+(__(h)||0))||0===u)&&(r=u)),h!==r)return isNaN(h*r)||""===r?(!c&&!(t in e)&&Mw(t,r),uE.call(this,e,t,h,r,d,s||Jx.stringFilter,l)):(u=new RE(this._pt,e,t,+h||0,r-(h||0),"boolean"==typeof c?EE:_E,0,d),l&&(u.fp=l),o&&u.modifier(o,this,e),this._pt=u)},hE=function(e,t,n,r,i,a){var o,s,l,u;if(Iw[e]&&!1!==(o=new Iw[e]).init(i,o.rawVars?t[e]:function(e,t,n,r,i){if(sw(e)&&(e=fE(e,i,t,n,r)),!cw(e)||e.style&&e.nodeType||mw(e)||pw(e))return ow(e)?fE(e,i,t,n,r):e;var a,o={};for(a in e)o[a]=fE(e[a],i,t,n,r);return o}(t[e],r,i,a,n),n,r,a)&&(n._pt=s=new RE(n._pt,i,e,0,1,o.render,o,0,o.priority),n!==Wx))for(l=n._ptLookup[n._targets.indexOf(i)],u=o._props.length;u--;)l[o._props[u]]=s;return o},dE=function e(t,n){var r,i,a,o,s,l,u,c,h,d,f,p,m,v=t.vars,g=v.ease,y=v.startAt,b=v.immediateRender,x=v.lazy,w=v.onUpdate,_=v.onUpdateParams,E=v.callbackScope,T=v.runBackwards,S=v.yoyoEase,M=v.keyframes,A=v.autoRevert,k=t._dur,P=t._startAt,R=t._targets,C=t.parent,L=C&&"nested"===C.data?C.parent._targets:R,I="auto"===t._overwrite&&!Ux,O=t.timeline;if(O&&(!M||!g)&&(g="none"),t._ease=eE(g,Zx.ease),t._yEase=S?Q_(eE(!0===S?g:S,Zx.ease)):0,S&&t._yoyo&&!t._repeat&&(S=t._yEase,t._yEase=t._ease,t._ease=S),t._from=!O&&!!v.runBackwards,!O){if(p=(c=R[0]?zw(R[0]).harness:0)&&v[c.prop],r=Qw(v,Rw),P&&P.render(-1,!0).kill(),y)if(t_(t._startAt=vE.set(R,Yw({data:"isStart",overwrite:!1,parent:C,immediateRender:!0,lazy:hw(x),startAt:null,delay:0,onUpdate:w,onUpdateParams:_,callbackScope:E,stagger:0},y))),n<0&&!b&&!A&&t._startAt.render(-1,!0),b){if(n>0&&!A&&(t._startAt=0),k&&n<=0)return void(n&&(t._zTime=n))}else!1===A&&(t._startAt=0);else if(T&&k)if(P)!A&&(t._startAt=0);else if(n&&(b=!1),a=Yw({overwrite:!1,data:"isFromStart",lazy:b&&hw(x),immediateRender:b,stagger:0,parent:C},r),p&&(a[c.prop]=p),t_(t._startAt=vE.set(R,a)),n<0&&t._startAt.render(-1,!0),b){if(!n)return}else e(t._startAt,$x);for(t._pt=0,x=k&&hw(x)||x&&!k,i=0;i<R.length;i++){if(u=(s=R[i])._gsap||Uw(R)[i]._gsap,t._ptLookup[i]=d={},Lw[u.id]&&Cw.length&&Vw(),f=L===R?i:L.indexOf(s),c&&!1!==(h=new c).init(s,p||r,t,f,L)&&(t._pt=o=new RE(t._pt,s,h.name,0,1,h.render,h,0,h.priority),h._props.forEach((function(e){d[e]=o})),h.priority&&(l=1)),!c||p)for(a in r)Iw[a]&&(h=hE(a,r,t,f,s,L))?h.priority&&(l=1):d[a]=o=cE.call(t,s,a,"get",r[a],f,L,0,v.stringFilter);t._op&&t._op[i]&&t.kill(s,t._op[i]),I&&t._pt&&(lE=t,zx.killTweensOf(s,d,t.globalTime(0)),m=!t.parent,lE=0),t._pt&&x&&(Lw[u.id]=1)}l&&PE(t),t._onInit&&t._onInit(t)}t._onUpdate=w,t._initted=(!t._op||t._pt)&&!m},fE=function(e,t,n,r,i){return sw(e)?e.call(t,n,r,i):ow(e)&&~e.indexOf("random(")?L_(e):e},pE=Bw+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",mE=(pE+",id,stagger,delay,duration,paused,scrollTrigger").split(","),vE=function(e){function t(t,n,r,i){var a;"number"==typeof n&&(r.duration=n,n=r,r=null);var o,s,l,u,c,h,d,f,p=(a=e.call(this,i?n:$w(n))||this).vars,m=p.duration,v=p.delay,g=p.immediateRender,y=p.stagger,b=p.overwrite,x=p.keyframes,w=p.defaults,_=p.scrollTrigger,E=p.yoyoEase,T=n.parent||zx,S=(mw(t)||pw(t)?lw(t[0]):"length"in n)?[t]:S_(t);if(a._targets=S.length?Uw(S):Aw("GSAP target "+t+" not found. https://greensock.com",!Jx.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=b,x||y||fw(m)||fw(v)){if(n=a.vars,(o=a.timeline=new sE({data:"nested",defaults:w||{}})).kill(),o.parent=o._dp=Nx(a),o._start=0,x)Yw(o.vars.defaults,{ease:"none"}),y?S.forEach((function(e,t){return x.forEach((function(n,r){return o.to(e,n,r?">":t*y)}))})):x.forEach((function(e){return o.to(S,e,">")}));else{if(u=S.length,d=y?A_(y):Pw,cw(y))for(c in y)~pE.indexOf(c)&&(f||(f={}),f[c]=y[c]);for(s=0;s<u;s++){for(c in l={},n)mE.indexOf(c)<0&&(l[c]=n[c]);l.stagger=0,E&&(l.yoyoEase=E),f&&Jw(l,f),h=S[s],l.duration=+fE(m,Nx(a),s,h,S),l.delay=(+fE(v,Nx(a),s,h,S)||0)-a._delay,!y&&1===u&&l.delay&&(a._delay=v=l.delay,a._start+=v,l.delay=0),o.to(h,l,d(s,h,S))}o.duration()?m=v=0:a.timeline=0}m||a.duration(m=o.duration())}else a.timeline=0;return!0!==b||Ux||(lE=Nx(a),zx.killTweensOf(S),lE=0),c_(T,Nx(a),r),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(g||!m&&!x&&a._start===jw(T._time)&&hw(g)&&r_(Nx(a))&&"nested"!==T.data)&&(a._tTime=-1e-8,a.render(Math.max(0,-v))),_&&h_(Nx(a),_),a}Bx(t,e);var n=t.prototype;return n.render=function(e,t,n){var r,i,a,o,s,l,u,c,h,d=this._time,f=this._tDur,p=this._dur,m=e>f-$x&&e>=0?f:e<$x?0:e;if(p){if(m!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(r=m,c=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,n);if(r=jw(m%o),m===f?(a=this._repeat,r=p):((a=~~(m/o))&&a===m/o&&(r=p,a--),r>p&&(r=p)),(l=this._yoyo&&1&a)&&(h=this._yEase,r=p-r),s=a_(this._tTime,o),r===d&&!n&&this._initted)return this;a!==s&&(c&&this._yEase&&$_(c,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(jw(o*a),!0).invalidate()._lock=0))}if(!this._initted){if(d_(this,e<0?e:r,n,t))return this._tTime=0,this;if(p!==this._dur)return this.render(e,t,n)}if(this._tTime=m,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(h||this._ease)(r/p),this._from&&(this.ratio=u=1-u),r&&!d&&!t&&D_(this,"onStart"),r&&!d&&!t&&(D_(this,"onStart"),this._tTime!==m))return this;for(i=this._pt;i;)i.r(u,i.d),i=i._next;c&&c.render(e<0?e:!r&&l?-1e-8:c._dur*u,t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),D_(this,"onUpdate")),this._repeat&&a!==s&&this.vars.onRepeat&&!t&&this.parent&&D_(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),(e||!p)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&t_(this,1),t||e<0&&!d||!m&&!d||(D_(this,m===f?"onComplete":"onReverseComplete",!0),this._prom&&!(m<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var i,a,o,s=e.ratio,l=t<0||!t&&(!e._start&&f_(e)&&(e._initted||!p_(e))||(e._ts<0||e._dp._ts<0)&&!p_(e))?0:1,u=e._rDelay,c=0;if(u&&e._repeat&&(c=w_(0,e._tDur,t),a=a_(c,u),o=a_(e._tTime,u),e._yoyo&&1&a&&(l=1-l),a!==o&&(s=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==s||r||e._zTime===$x||!t&&e._zTime){if(!e._initted&&d_(e,t,r,n))return;for(o=e._zTime,e._zTime=t||(n?$x:0),n||(n=t&&!o),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=c,i=e._pt;i;)i.r(l,i.d),i=i._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!n&&D_(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&D_(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&t_(e,1),n||(D_(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},n.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?N_(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,lE&&!0!==lE.vars.overwrite)._first||N_(this),this.parent&&n!==this.timeline.totalDuration()&&m_(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,a,o,s,l,u,c=this._targets,h=e?S_(e):c,d=this._ptLookup,f=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(c,h))return"all"===t&&(this._pt=0),N_(this);for(r=this._op=this._op||[],"all"!==t&&(ow(t)&&(s={},Hw(t,(function(e){return s[e]=1})),t=s),t=function(e,t){var n,r,i,a,o=e[0]?zw(e[0]).harness:0,s=o&&o.aliases;if(!s)return t;for(r in n=Jw({},t),s)if(r in n)for(i=(a=s[r].split(",")).length;i--;)n[a[i]]=n[r];return n}(c,t)),u=c.length;u--;)if(~h.indexOf(c[u]))for(s in i=d[u],"all"===t?(r[u]=t,o=i,a={}):(a=r[u]=r[u]||{},o=t),o)(l=i&&i[s])&&("kill"in l.d&&!0!==l.d.kill(s)||e_(this,l,"_pt"),delete i[s]),"all"!==a&&(a[s]=1);return this._initted&&!this._pt&&f&&N_(this),this},t.to=function(e,n){return new t(e,n,arguments[2])},t.from=function(e,t){return b_(1,arguments)},t.delayedCall=function(e,n,r,i){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},t.fromTo=function(e,t,n){return b_(2,arguments)},t.set=function(e,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(e,n)},t.killTweensOf=function(e,t,n){return zx.killTweensOf(e,t,n)},t}(oE);Yw(vE.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Hw("staggerTo,staggerFrom,staggerFromTo",(function(e){vE[e]=function(){var t=new sE,n=E_.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var gE=function(e,t,n){return e[t]=n},yE=function(e,t,n){return e[t](n)},bE=function(e,t,n,r){return e[t](r.fp,n)},xE=function(e,t,n){return e.setAttribute(t,n)},wE=function(e,t){return sw(e[t])?yE:uw(e[t])&&e.setAttribute?xE:gE},_E=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},EE=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},TE=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},SE=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},ME=function(e,t,n,r){for(var i,a=this._pt;a;)i=a._next,a.p===r&&a.modifier(e,t,n),a=i},AE=function(e){for(var t,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?e_(this,r,"_pt"):r.dep||(t=1),r=n;return!t},kE=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},PE=function(e){for(var t,n,r,i,a=e._pt;a;){for(t=a._next,n=r;n&&n.pr>a.pr;)n=n._next;(a._prev=n?n._prev:i)?a._prev._next=a:r=a,(a._next=n)?n._prev=a:i=a,a=t}e._pt=r},RE=function(){function e(e,t,n,r,i,a,o,s,l){this.t=t,this.s=r,this.c=i,this.p=n,this.r=a||_E,this.d=o||this,this.set=s||gE,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=kE,this.m=e,this.mt=n,this.tween=t},e}();Hw(Bw+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return Rw[e]=1})),Ew.TweenMax=Ew.TweenLite=vE,Ew.TimelineLite=Ew.TimelineMax=sE,zx=new sE({sortChildren:!1,defaults:Zx,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Jx.stringFilter=W_;var CE={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return function(e){var t=(e=!e.name&&e.default||e).name,n=sw(e),r=t&&!n&&e.init?function(){this._props=[]}:e,i={init:Pw,render:SE,add:cE,kill:AE,modifier:ME,rawVars:0},a={targetTest:0,get:0,getSetter:wE,aliases:{},register:0};if(X_(),e!==r){if(Iw[t])return;Yw(r,Yw(Qw(e,i),a)),Jw(r.prototype,Jw(i,Qw(e,a))),Iw[r.prop=t]=r,e.targetTest&&(Nw.push(r),Rw[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}kw(t,r),e.register&&e.register(OE,r,RE)}(e)}))},timeline:function(e){return new sE(e)},getTweensOf:function(e,t){return zx.getTweensOf(e,t)},getProperty:function(e,t,n,r){ow(e)&&(e=S_(e)[0]);var i=zw(e||{}).get,a=n?Xw:qw;return"native"===n&&(n=""),e?t?a((Iw[t]&&Iw[t].get||i)(e,t,n,r)):function(t,n,r){return a((Iw[t]&&Iw[t].get||i)(e,t,n,r))}:e},quickSetter:function(e,t,n){if((e=S_(e)).length>1){var r=e.map((function(e){return OE.quickSetter(e,t,n)})),i=r.length;return function(e){for(var t=i;t--;)r[t](e)}}e=e[0]||{};var a=Iw[t],o=zw(e),s=o.harness&&(o.harness.aliases||{})[t]||t,l=a?function(t){var r=new a;Wx._pt=0,r.init(e,n?t+n:t,Wx,0,[e]),r.render(1,r),Wx._pt&&SE(1,Wx)}:o.set(e,s);return a?l:function(t){return l(e,s,n?t+n:t,o,1)}},isTweening:function(e){return zx.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=eE(e.ease,Zx.ease)),Zw(Zx,e||{})},config:function(e){return Zw(Jx,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,i=e.defaults,a=e.extendTimeline;(r||"").split(",").forEach((function(e){return e&&!Iw[e]&&!Ew[e]&&Aw(t+" effect requires "+e+" plugin.")})),Ow[t]=function(e,t,r){return n(S_(e),Yw(t||{},i),r)},a&&(sE.prototype[t]=function(e,n,r){return this.add(Ow[t](e,cw(n)?n:(r=n)&&{},this),r)})},registerEase:function(e,t){Y_[e]=eE(t)},parseEase:function(e,t){return arguments.length?eE(e,t):Y_},getById:function(e){return zx.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,r,i=new sE(e);for(i.smoothChildTiming=hw(e.smoothChildTiming),zx.remove(i),i._dp=0,i._time=i._tTime=zx._time,n=zx._first;n;)r=n._next,!t&&!n._dur&&n instanceof vE&&n.vars.onComplete===n._targets[0]||c_(i,n,n._start-n._delay),n=r;return c_(zx,i,0),i},utils:{wrap:function e(t,n,r){var i=n-t;return mw(t)?C_(t,e(0,t.length),n):x_(r,(function(e){return(i+(e-t)%i)%i+t}))},wrapYoyo:function e(t,n,r){var i=n-t,a=2*i;return mw(t)?C_(t,e(0,t.length-1),n):x_(r,(function(e){return t+((e=(a+(e-t)%a)%a||0)>i?a-e:e)}))},distribute:A_,random:R_,snap:P_,normalize:function(e,t,n){return I_(e,t,0,1,n)},getUnit:__,clamp:function(e,t,n){return x_(n,(function(n){return w_(e,t,n)}))},splitColor:F_,toArray:S_,selector:function(e){return e=S_(e)[0]||Aw("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return S_(t,n.querySelectorAll?n:n===e?Aw("Invalid scope")||jx.createElement("div"):e)}},mapRange:I_,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||__(n))}},interpolate:function e(t,n,r,i){var a=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!a){var o,s,l,u,c,h=ow(t),d={};if(!0===r&&(i=1)&&(r=null),h)t={p:t},n={p:n};else if(mw(t)&&!mw(n)){for(l=[],u=t.length,c=u-2,s=1;s<u;s++)l.push(e(t[s-1],t[s]));u--,a=function(e){e*=u;var t=Math.min(c,~~e);return l[t](e-t)},r=n}else i||(t=Jw(mw(t)?[]:{},t));if(!l){for(o in n)cE.call(d,t,o,"get",n[o]);a=function(e){return SE(e,d)||(h?t.p:t)}}}return x_(r,a)},shuffle:M_},install:Sw,effects:Ow,ticker:q_,updateRoot:sE.updateRoot,plugins:Iw,globalTimeline:zx,core:{PropTween:RE,globals:kw,Tween:vE,Timeline:sE,Animation:oE,getCache:zw,_removeLinkedListItem:e_,suppressOverwrites:function(e){return Ux=e}}};Hw("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return CE[e]=vE[e]})),q_.add(sE.updateRoot),Wx=CE.to({},{duration:0});var LE=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},IE=function(e,t){return{name:e,rawVars:1,init:function(e,n,r){r._onInit=function(e){var r,i;if(ow(n)&&(r={},Hw(n,(function(e){return r[e]=1})),n=r),t){for(i in r={},n)r[i]=t(n[i]);n=r}!function(e,t){var n,r,i,a=e._targets;for(n in t)for(r=a.length;r--;)(i=e._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=LE(i,n)),i&&i.modifier&&i.modifier(t[n],e,a[r],n))}(e,n)}}}},OE=CE.registerPlugin({name:"attr",init:function(e,t,n,r,i){var a,o;for(a in t)(o=this.add(e,"setAttribute",(e.getAttribute(a)||0)+"",t[a],r,i,0,0,a))&&(o.op=a),this._props.push(a)}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n])}},IE("roundProps",k_),IE("modifiers"),IE("snap",P_))||CE;function DE(e){return DE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DE(e)}vE.version=sE.version=OE.version="3.7.0",Gx=1,dw()&&X_(),Y_.Power0,Y_.Power1,Y_.Power2,Y_.Power3,Y_.Power4,Y_.Linear,Y_.Quad,Y_.Cubic,Y_.Quart,Y_.Quint,Y_.Strong,Y_.Elastic,Y_.Back,Y_.SteppedEase,Y_.Bounce,Y_.Sine,Y_.Expo,Y_.Circ;var NE,BE,UE,zE,FE,HE,jE,GE={},VE=180/Math.PI,WE=Math.PI/180,qE=Math.atan2,XE=/([A-Z])/g,YE=/(?:left|right|width|margin|padding|x)/i,KE=/[\s,\(]\S/,JE={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ZE=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},QE=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},$E=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},eT=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},tT=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},nT=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},rT=function(e,t,n){return e.style[t]=n},iT=function(e,t,n){return e.style.setProperty(t,n)},aT=function(e,t,n){return e._gsap[t]=n},oT=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},sT=function(e,t,n,r,i){var a=e._gsap;a.scaleX=a.scaleY=n,a.renderTransform(i,a)},lT=function(e,t,n,r,i){var a=e._gsap;a[t]=n,a.renderTransform(i,a)},uT="transform",cT=uT+"Origin",hT=function(e,t){var n=BE.createElementNS?BE.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):BE.createElement(e);return n.style?n:BE.createElement(e)},dT=function e(t,n,r){var i=getComputedStyle(t);return i[n]||i.getPropertyValue(n.replace(XE,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&e(t,pT(n)||n,1)||""},fT="O,Moz,ms,Ms,Webkit".split(","),pT=function(e,t,n){var r=(t||FE).style,i=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(fT[i]+e in r););return i<0?null:(3===i?"ms":i>=0?fT[i]:"")+e},mT=function(){"undefined"!=typeof window&&window.document&&(NE=window,BE=NE.document,UE=BE.documentElement,FE=hT("div")||{style:{}},hT("div"),uT=pT(uT),cT=uT+"Origin",FE.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",jE=!!pT("perspective"),zE=1)},vT=function e(t){var n,r=hT("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,a=this.nextSibling,o=this.style.cssText;if(UE.appendChild(r),r.appendChild(this),this.style.display="block",t)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(a?i.insertBefore(this,a):i.appendChild(this)),UE.removeChild(r),this.style.cssText=o,n},gT=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},yT=function(e){var t;try{t=e.getBBox()}catch(n){t=vT.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===vT||(t=vT.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+gT(e,["x","cx","x1"])||0,y:+gT(e,["y","cy","y1"])||0,width:0,height:0}},bT=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!yT(e))},xT=function(e,t){if(t){var n=e.style;t in GE&&t!==cT&&(t=uT),n.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty(t.replace(XE,"-$1").toLowerCase())):n.removeAttribute(t)}},wT=function(e,t,n,r,i,a){var o=new RE(e._pt,t,n,0,1,a?nT:tT);return e._pt=o,o.b=r,o.e=i,e._props.push(n),o},_T={deg:1,rad:1,turn:1},ET=function e(t,n,r,i){var a,o,s,l,u=parseFloat(r)||0,c=(r+"").trim().substr((u+"").length)||"px",h=FE.style,d=YE.test(n),f="svg"===t.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),m=100,v="px"===i,g="%"===i;return i===c||!u||_T[i]||_T[c]?u:("px"!==c&&!v&&(u=e(t,n,r,"px")),l=t.getCTM&&bT(t),!g&&"%"!==c||!GE[n]&&!~n.indexOf("adius")?(h[d?"width":"height"]=m+(v?c:i),o=~n.indexOf("adius")||"em"===i&&t.appendChild&&!f?t:t.parentNode,l&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==BE&&o.appendChild||(o=BE.body),(s=o._gsap)&&g&&s.width&&d&&s.time===q_.time?jw(u/s.width*m):((g||"%"===c)&&(h.position=dT(t,"position")),o===t&&(h.position="static"),o.appendChild(FE),a=FE[p],o.removeChild(FE),h.position="absolute",d&&g&&((s=zw(o)).time=q_.time,s.width=o[p]),jw(v?a*u/m:a&&u?m/a*u:0))):(a=l?t.getBBox()[d?"width":"height"]:t[p],jw(g?u/a*m:u/100*a)))},TT=function(e,t,n,r){var i;return zE||mT(),t in JE&&"transform"!==t&&~(t=JE[t]).indexOf(",")&&(t=t.split(",")[0]),GE[t]&&"transform"!==t?(i=NT(e,r),i="transformOrigin"!==t?i[t]:i.svg?i.origin:BT(dT(e,cT))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=PT[t]&&PT[t](e,t,n)||dT(e,t)||Fw(e,t)||("opacity"===t?1:0)),n&&!~(i+"").trim().indexOf(" ")?ET(e,t,i,n)+n:i},ST=function(e,t,n,r){if(!n||"none"===n){var i=pT(t,e,1),a=i&&dT(e,i,1);a&&a!==n?(t=i,n=a):"borderColor"===t&&(n=dT(e,"borderTopColor"))}var o,s,l,u,c,h,d,f,p,m,v,g,y=new RE(this._pt,e.style,t,0,1,TE),b=0,x=0;if(y.b=n,y.e=r,n+="","auto"==(r+="")&&(e.style[t]=r,r=dT(e,t)||r,e.style[t]=n),W_(o=[n,r]),r=o[1],l=(n=o[0]).match(yw)||[],(r.match(yw)||[]).length){for(;s=yw.exec(r);)d=s[0],p=r.substring(b,s.index),c?c=(c+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(c=1),d!==(h=l[x++]||"")&&(u=parseFloat(h)||0,v=h.substr((u+"").length),(g="="===d.charAt(1)?+(d.charAt(0)+"1"):0)&&(d=d.substr(2)),f=parseFloat(d),m=d.substr((f+"").length),b=yw.lastIndex-m.length,m||(m=m||Jx.units[t]||v,b===r.length&&(r+=m,y.e+=m)),v!==m&&(u=ET(e,t,h,m)||0),y._pt={_next:y._pt,p:p||1===x?p:",",s:u,c:g?g*f:f-u,m:c&&c<4||"zIndex"===t?Math.round:0});y.c=b<r.length?r.substring(b,r.length):""}else y.r="display"===t&&"none"===r?nT:tT;return xw.test(r)&&(y.e=0),this._pt=y,y},MT={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},AT=function(e){var t=e.split(" "),n=t[0],r=t[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==r&&"right"!==r||(e=n,n=r,r=e),t[0]=MT[n]||n,t[1]=MT[r]||r,t.join(" ")},kT=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,r,i,a=t.t,o=a.style,s=t.u,l=a._gsap;if("all"===s||!0===s)o.cssText="",r=1;else for(i=(s=s.split(",")).length;--i>-1;)n=s[i],GE[n]&&(r=1,n="transformOrigin"===n?cT:uT),xT(a,n);r&&(xT(a,uT),l&&(l.svg&&a.removeAttribute("transform"),NT(a,1),l.uncache=1))}},PT={clearProps:function(e,t,n,r,i){if("isFromStart"!==i.data){var a=e._pt=new RE(e._pt,t,n,0,0,kT);return a.u=r,a.pr=-10,a.tween=i,e._props.push(n),1}}},RT=[1,0,0,1,0,0],CT={},LT=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},IT=function(e){var t=dT(e,uT);return LT(t)?RT:t.substr(7).match(gw).map(jw)},OT=function(e,t){var n,r,i,a,o=e._gsap||zw(e),s=e.style,l=IT(e);return o.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?RT:l:(l!==RT||e.offsetParent||e===UE||o.svg||(i=s.display,s.display="block",(n=e.parentNode)&&e.offsetParent||(a=1,r=e.nextSibling,UE.appendChild(e)),l=IT(e),i?s.display=i:xT(e,"display"),a&&(r?n.insertBefore(e,r):n?n.appendChild(e):UE.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},DT=function(e,t,n,r,i,a){var o,s,l,u=e._gsap,c=i||OT(e,!0),h=u.xOrigin||0,d=u.yOrigin||0,f=u.xOffset||0,p=u.yOffset||0,m=c[0],v=c[1],g=c[2],y=c[3],b=c[4],x=c[5],w=t.split(" "),_=parseFloat(w[0])||0,E=parseFloat(w[1])||0;n?c!==RT&&(s=m*y-v*g)&&(l=_*(-v/s)+E*(m/s)-(m*x-v*b)/s,_=_*(y/s)+E*(-g/s)+(g*x-y*b)/s,E=l):(_=(o=yT(e)).x+(~w[0].indexOf("%")?_/100*o.width:_),E=o.y+(~(w[1]||w[0]).indexOf("%")?E/100*o.height:E)),r||!1!==r&&u.smooth?(b=_-h,x=E-d,u.xOffset=f+(b*m+x*g)-b,u.yOffset=p+(b*v+x*y)-x):u.xOffset=u.yOffset=0,u.xOrigin=_,u.yOrigin=E,u.smooth=!!r,u.origin=t,u.originIsAbsolute=!!n,e.style[cT]="0px 0px",a&&(wT(a,u,"xOrigin",h,_),wT(a,u,"yOrigin",d,E),wT(a,u,"xOffset",f,u.xOffset),wT(a,u,"yOffset",p,u.yOffset)),e.setAttribute("data-svg-origin",_+" "+E)},NT=function(e,t){var n=e._gsap||new aE(e);if("x"in n&&!t&&!n.uncache)return n;var r,i,a,o,s,l,u,c,h,d,f,p,m,v,g,y,b,x,w,_,E,T,S,M,A,k,P,R,C,L,I,O,D=e.style,N=n.scaleX<0,B="px",U="deg",z=dT(e,cT)||"0";return r=i=a=l=u=c=h=d=f=0,o=s=1,n.svg=!(!e.getCTM||!bT(e)),v=OT(e,n.svg),n.svg&&(M=(!n.uncache||"0px 0px"===z)&&!t&&e.getAttribute("data-svg-origin"),DT(e,M||z,!!M||n.originIsAbsolute,!1!==n.smooth,v)),p=n.xOrigin||0,m=n.yOrigin||0,v!==RT&&(x=v[0],w=v[1],_=v[2],E=v[3],r=T=v[4],i=S=v[5],6===v.length?(o=Math.sqrt(x*x+w*w),s=Math.sqrt(E*E+_*_),l=x||w?qE(w,x)*VE:0,(h=_||E?qE(_,E)*VE+l:0)&&(s*=Math.abs(Math.cos(h*WE))),n.svg&&(r-=p-(p*x+m*_),i-=m-(p*w+m*E))):(O=v[6],L=v[7],P=v[8],R=v[9],C=v[10],I=v[11],r=v[12],i=v[13],a=v[14],u=(g=qE(O,C))*VE,g&&(M=T*(y=Math.cos(-g))+P*(b=Math.sin(-g)),A=S*y+R*b,k=O*y+C*b,P=T*-b+P*y,R=S*-b+R*y,C=O*-b+C*y,I=L*-b+I*y,T=M,S=A,O=k),c=(g=qE(-_,C))*VE,g&&(y=Math.cos(-g),I=E*(b=Math.sin(-g))+I*y,x=M=x*y-P*b,w=A=w*y-R*b,_=k=_*y-C*b),l=(g=qE(w,x))*VE,g&&(M=x*(y=Math.cos(g))+w*(b=Math.sin(g)),A=T*y+S*b,w=w*y-x*b,S=S*y-T*b,x=M,T=A),u&&Math.abs(u)+Math.abs(l)>359.9&&(u=l=0,c=180-c),o=jw(Math.sqrt(x*x+w*w+_*_)),s=jw(Math.sqrt(S*S+O*O)),g=qE(T,S),h=Math.abs(g)>2e-4?g*VE:0,f=I?1/(I<0?-I:I):0),n.svg&&(M=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!LT(dT(e,uT)),M&&e.setAttribute("transform",M))),Math.abs(h)>90&&Math.abs(h)<270&&(N?(o*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(s*=-1,h+=h<=0?180:-180)),n.x=r-((n.xPercent=r&&(n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-r)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+B,n.y=i-((n.yPercent=i&&(n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+B,n.z=a+B,n.scaleX=jw(o),n.scaleY=jw(s),n.rotation=jw(l)+U,n.rotationX=jw(u)+U,n.rotationY=jw(c)+U,n.skewX=h+U,n.skewY=d+U,n.transformPerspective=f+B,(n.zOrigin=parseFloat(z.split(" ")[2])||0)&&(D[cT]=BT(z)),n.xOffset=n.yOffset=0,n.force3D=Jx.force3D,n.renderTransform=n.svg?VT:jE?GT:zT,n.uncache=0,n},BT=function(e){return(e=e.split(" "))[0]+" "+e[1]},UT=function(e,t,n){var r=__(t);return jw(parseFloat(t)+parseFloat(ET(e,"x",n+"px",r)))+r},zT=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,GT(e,t)},FT="0deg",HT="0px",jT=") ",GT=function(e,t){var n=t||this,r=n.xPercent,i=n.yPercent,a=n.x,o=n.y,s=n.z,l=n.rotation,u=n.rotationY,c=n.rotationX,h=n.skewX,d=n.skewY,f=n.scaleX,p=n.scaleY,m=n.transformPerspective,v=n.force3D,g=n.target,y=n.zOrigin,b="",x="auto"===v&&e&&1!==e||!0===v;if(y&&(c!==FT||u!==FT)){var w,_=parseFloat(u)*WE,E=Math.sin(_),T=Math.cos(_);_=parseFloat(c)*WE,w=Math.cos(_),a=UT(g,a,E*w*-y),o=UT(g,o,-Math.sin(_)*-y),s=UT(g,s,T*w*-y+y)}m!==HT&&(b+="perspective("+m+jT),(r||i)&&(b+="translate("+r+"%, "+i+"%) "),(x||a!==HT||o!==HT||s!==HT)&&(b+=s!==HT||x?"translate3d("+a+", "+o+", "+s+") ":"translate("+a+", "+o+jT),l!==FT&&(b+="rotate("+l+jT),u!==FT&&(b+="rotateY("+u+jT),c!==FT&&(b+="rotateX("+c+jT),h===FT&&d===FT||(b+="skew("+h+", "+d+jT),1===f&&1===p||(b+="scale("+f+", "+p+jT),g.style[uT]=b||"translate(0, 0)"},VT=function(e,t){var n,r,i,a,o,s=t||this,l=s.xPercent,u=s.yPercent,c=s.x,h=s.y,d=s.rotation,f=s.skewX,p=s.skewY,m=s.scaleX,v=s.scaleY,g=s.target,y=s.xOrigin,b=s.yOrigin,x=s.xOffset,w=s.yOffset,_=s.forceCSS,E=parseFloat(c),T=parseFloat(h);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=WE,f*=WE,n=Math.cos(d)*m,r=Math.sin(d)*m,i=Math.sin(d-f)*-v,a=Math.cos(d-f)*v,f&&(p*=WE,o=Math.tan(f-p),i*=o=Math.sqrt(1+o*o),a*=o,p&&(o=Math.tan(p),n*=o=Math.sqrt(1+o*o),r*=o)),n=jw(n),r=jw(r),i=jw(i),a=jw(a)):(n=m,a=v,r=i=0),(E&&!~(c+"").indexOf("px")||T&&!~(h+"").indexOf("px"))&&(E=ET(g,"x",c,"px"),T=ET(g,"y",h,"px")),(y||b||x||w)&&(E=jw(E+y-(y*n+b*i)+x),T=jw(T+b-(y*r+b*a)+w)),(l||u)&&(o=g.getBBox(),E=jw(E+l/100*o.width),T=jw(T+u/100*o.height)),o="matrix("+n+","+r+","+i+","+a+","+E+","+T+")",g.setAttribute("transform",o),_&&(g.style[uT]=o)},WT=function(e,t,n,r,i,a){var o,s,l=360,u=ow(i),c=parseFloat(i)*(u&&~i.indexOf("rad")?VE:1),h=a?c*a:c-r,d=r+h+"deg";return u&&("short"===(o=i.split("_")[1])&&(h%=l)!=h%180&&(h+=h<0?l:-360),"cw"===o&&h<0?h=(h+36e9)%l-~~(h/l)*l:"ccw"===o&&h>0&&(h=(h-36e9)%l-~~(h/l)*l)),e._pt=s=new RE(e._pt,t,n,r,h,QE),s.e=d,s.u="deg",e._props.push(n),s},qT=function(e,t){for(var n in t)e[n]=t[n];return e},XT=function(e,t,n){var r,i,a,o,s,l,u,c=qT({},n._gsap),h=n.style;for(i in c.svg?(a=n.getAttribute("transform"),n.setAttribute("transform",""),h[uT]=t,r=NT(n,1),xT(n,uT),n.setAttribute("transform",a)):(a=getComputedStyle(n)[uT],h[uT]=t,r=NT(n,1),h[uT]=a),GE)(a=c[i])!==(o=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(s=__(a)!==(u=__(o))?ET(n,i,a,u):parseFloat(a),l=parseFloat(o),e._pt=new RE(e._pt,r,i,s,l-s,ZE),e._pt.u=u||0,e._props.push(i));qT(r,c)};Hw("padding,margin,Width,Radius",(function(e,t){var n="Top",r="Right",i="Bottom",a="Left",o=(t<3?[n,r,i,a]:[n+a,n+r,i+r,i+a]).map((function(n){return t<2?e+n:"border"+n+e}));PT[t>1?"border"+e:e]=function(e,t,n,r,i){var a,s;if(arguments.length<4)return a=o.map((function(t){return TT(e,t,n)})),5===(s=a.join(" ")).split(a[0]).length?a[0]:s;a=(r+"").split(" "),s={},o.forEach((function(e,t){return s[e]=a[t]=a[t]||a[(t-1)/2|0]})),e.init(t,s,i)}}));var YT,KT,JT={name:"css",register:mT,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,i){var a,o,s,l,u,c,h,d,f,p,m,v,g,y,b,x=this._props,w=e.style,_=n.vars.startAt;for(h in zE||mT(),t)if("autoRound"!==h&&(o=t[h],!Iw[h]||!hE(h,t,n,r,e,i)))if(u=DE(o),c=PT[h],"function"===u&&(u=DE(o=o.call(n,r,e,i))),"string"===u&&~o.indexOf("random(")&&(o=L_(o)),c)c(this,e,h,o,n)&&(b=1);else if("--"===h.substr(0,2))a=(getComputedStyle(e).getPropertyValue(h)+"").trim(),o+="",G_.lastIndex=0,G_.test(a)||(d=__(a),f=__(o)),f?d!==f&&(a=ET(e,h,a,f)+f):d&&(o+=d),this.add(w,"setProperty",a,o,r,i,0,0,h),x.push(h);else if("undefined"!==u){if(_&&h in _?(a="function"==typeof _[h]?_[h].call(n,r,e,i):_[h],h in Jx.units&&!__(a)&&(a+=Jx.units[h]),"="===(a+"").charAt(1)&&(a=TT(e,h))):a=TT(e,h),l=parseFloat(a),(p="string"===u&&"="===o.charAt(1)?+(o.charAt(0)+"1"):0)&&(o=o.substr(2)),s=parseFloat(o),h in JE&&("autoAlpha"===h&&(1===l&&"hidden"===TT(e,"visibility")&&s&&(l=0),wT(this,w,"visibility",l?"inherit":"hidden",s?"inherit":"hidden",!s)),"scale"!==h&&"transform"!==h&&~(h=JE[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in GE)if(v||((g=e._gsap).renderTransform&&!t.parseTransform||NT(e,t.parseTransform),y=!1!==t.smoothOrigin&&g.smooth,(v=this._pt=new RE(this._pt,w,uT,0,1,g.renderTransform,g,0,-1)).dep=1),"scale"===h)this._pt=new RE(this._pt,g,"scaleY",g.scaleY,(p?p*s:s-g.scaleY)||0),x.push("scaleY",h),h+="X";else{if("transformOrigin"===h){o=AT(o),g.svg?DT(e,o,0,y,0,this):((f=parseFloat(o.split(" ")[2])||0)!==g.zOrigin&&wT(this,g,"zOrigin",g.zOrigin,f),wT(this,w,h,BT(a),BT(o)));continue}if("svgOrigin"===h){DT(e,o,1,y,0,this);continue}if(h in CT){WT(this,g,h,l,o,p);continue}if("smoothOrigin"===h){wT(this,g,"smooth",g.smooth,o);continue}if("force3D"===h){g[h]=o;continue}if("transform"===h){XT(this,o,e);continue}}else h in w||(h=pT(h)||h);if(m||(s||0===s)&&(l||0===l)&&!KE.test(o)&&h in w)s||(s=0),(d=(a+"").substr((l+"").length))!==(f=__(o)||(h in Jx.units?Jx.units[h]:d))&&(l=ET(e,h,a,f)),this._pt=new RE(this._pt,m?g:w,h,l,p?p*s:s-l,m||"px"!==f&&"zIndex"!==h||!1===t.autoRound?ZE:eT),this._pt.u=f||0,d!==f&&(this._pt.b=a,this._pt.r=$E);else if(h in w)ST.call(this,e,h,a,o);else{if(!(h in e)){Mw(h,o);continue}this.add(e,h,a||e[h],o,r,i)}x.push(h)}b&&PE(this)},get:TT,aliases:JE,getSetter:function(e,t,n){var r=JE[t];return r&&r.indexOf(",")<0&&(t=r),t in GE&&t!==cT&&(e._gsap.x||TT(e,"x"))?n&&HE===n?"scale"===t?oT:aT:(HE=n||{})&&("scale"===t?sT:lT):e.style&&!uw(e.style[t])?rT:~t.indexOf("-")?iT:wE(e,t)},core:{_removeProperty:xT,_getMatrix:OT}};OE.utils.checkPrefix=pT,KT=Hw("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+(YT="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){GE[e]=1})),Hw(YT,(function(e){Jx.units[e]="deg",CT[e]=1})),JE[KT[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+YT,Hw("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");JE[t[1]]=KT[t[0]]})),Hw("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){Jx.units[e]="px"})),OE.registerPlugin(JT);var ZT=OE.registerPlugin(JT)||OE;function QT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $T(e){return $T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$T(e)}function eS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rS(r.key),r)}}function nS(e,t,n){return t&&tS(e.prototype,t),n&&tS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function rS(e){var t=function(e,t){if("object"!=$T(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=$T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$T(t)?t:String(t)}ZT.core.Tween;var iS=new Qs,aS=new Qs,oS=new Qs,sS=new Gs,lS=new Qs,uS=new Qs,cS=new Gs,hS=new Gs,dS=new kl,fS=new kl;function pS(e,t){if(e||t){var n=e.count===t.count,r=e.normalized===t.normalized,i=e.array.constructor===t.array.constructor,a=e.itemSize===t.itemSize;if(!(n&&r&&i&&a))throw new Error}}function mS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.array.constructor,r=e.normalized,i=e.itemSize,a=null===t?e.count:t;return new ku(new n(i*a),i,r)}function vS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e.isInterleavedBufferAttribute)for(var r=e.itemSize,i=0,a=e.count;i<a;i++){var o=i+n;t.setX(o,e.getX(i)),r>=2&&t.setY(o,e.getY(i)),r>=3&&t.setZ(o,e.getZ(i)),r>=4&&t.setW(o,e.getW(i))}else{var s=t.array,l=s.constructor,u=s.BYTES_PER_ELEMENT*e.itemSize*n;new l(s.buffer,u,e.array.length).set(e.array)}}function gS(e,t,n){for(var r=e.elements,i=t.elements,a=0,o=i.length;a<o;a++)r[a]+=i[a]*n}function yS(e,t,n){var r=e.skeleton,i=e.geometry,a=r.bones,o=r.boneInverses;cS.fromBufferAttribute(i.attributes.skinIndex,t),hS.fromBufferAttribute(i.attributes.skinWeight,t),dS.elements.fill(0);for(var s=0;s<4;s++){var l=hS.getComponent(s);if(0!==l){var u=cS.getComponent(s);fS.multiplyMatrices(a[u].matrixWorld,o[u]),gS(dS,fS,l)}}return dS.multiply(e.bindMatrix).premultiply(e.bindMatrixInverse),n.transformDirection(dS),n}function bS(e,t,n,r,i){lS.set(0,0,0);for(var a=0,o=e.length;a<o;a++){var s=t[a],l=e[a];0!==s&&(uS.fromBufferAttribute(l,r),n?lS.addScaledVector(uS,s):lS.addScaledVector(uS.sub(i),s))}i.add(lS)}var xS=function(){function e(t){eS(this,e),this.matrixWorld=new kl,this.geometryHash=null,this.boneMatrices=null,this.primitiveCount=-1,this.mesh=t,this.update()}return nS(e,[{key:"update",value:function(){var e=this.mesh,t=e.geometry,n=e.skeleton,r=(t.index?t.index.count:t.attributes.position.count)/3;if(this.matrixWorld.copy(e.matrixWorld),this.geometryHash=t.attributes.position.version,this.primitiveCount=r,n){n.boneTexture||n.computeBoneTexture(),n.update();var i=n.boneMatrices;this.boneMatrices&&this.boneMatrices.length===i.length?this.boneMatrices.set(i):this.boneMatrices=i.slice()}else this.boneMatrices=null}},{key:"didChange",value:function(){var e=this.mesh,t=e.geometry,n=(t.index?t.index.count:t.attributes.position.count)/3,r=this.matrixWorld.equals(e.matrixWorld)&&this.geometryHash===t.attributes.position.version&&function(e,t){if(null===e||null===t)return e===t;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}(e.skeleton&&e.skeleton.boneMatrices||null,this.boneMatrices)&&this.primitiveCount===n;return!r}}]),e}(),wS=function(){function e(t){eS(this,e),Array.isArray(t)||(t=[t]);var n=[];t.forEach((function(e){e.traverseVisible((function(e){e.isMesh&&n.push(e)}))})),this.meshes=n,this.useGroups=!0,this.applyWorldTransforms=!0,this.attributes=["position","normal","color","tangent","uv","uv2"],this._intermediateGeometry=new Array(n.length).fill().map((function(){return new qu})),this._diffMap=new WeakMap}return nS(e,[{key:"getMaterials",value:function(){var e=[];return this.meshes.forEach((function(t){var n;Array.isArray(t.material)?e.push.apply(e,function(e){if(Array.isArray(e))return QT(e)}(n=t.material)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return QT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?QT(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):e.push(t.material)})),e}},{key:"generate",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qu,t=[],n=this.meshes,r=this.useGroups,i=this._intermediateGeometry,a=this._diffMap,o=0,s=n.length;o<s;o++){var l=n[o],u=i[o],c=a.get(l);!c||c.didChange(l)?(this._convertToStaticGeometry(l,u),t.push(!1),c?c.update():a.set(l,new xS(l))):t.push(!0)}if(0===i.length){e.setIndex(null);var h=e.attributes;for(var d in h)e.deleteAttribute(d);for(var f in this.attributes)e.setAttribute(this.attributes[f],new ku(new Float32Array(0),4,!1))}else!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useGroups:!1,updateIndex:!1,skipAttributes:[]},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new qu,r=null!==e[0].index,i=t.useGroups,a=void 0!==i&&i,o=t.updateIndex,s=void 0!==o&&o,l=t.skipAttributes,u=void 0===l?[]:l,c=new Set(Object.keys(e[0].attributes)),h={},d=0;n.clearGroups();for(var f=0;f<e.length;++f){var p=e[f],m=0;if(r!==(null!==p.index))throw new Error("StaticGeometryGenerator: All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.");for(var v in p.attributes){if(!c.has(v))throw new Error('StaticGeometryGenerator: All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.');void 0===h[v]&&(h[v]=[]),h[v].push(p.attributes[v]),m++}if(m!==c.size)throw new Error("StaticGeometryGenerator: Make sure all geometries have the same number of attributes.");if(a){var g=void 0;if(r)g=p.index.count;else{if(void 0===p.attributes.position)throw new Error("StaticGeometryGenerator: The geometry must have either an index or a position attribute");g=p.attributes.position.count}n.addGroup(d,g,f),d+=g}}if(r){var y=!1;if(!n.index){for(var b=0,x=0;x<e.length;++x)b+=e[x].index.count;n.setIndex(new ku(new Uint32Array(b),1,!1)),y=!0}if(s||y)for(var w=n.index,_=0,E=0,T=0;T<e.length;++T){var S=e[T],M=S.index;if(!0!==u[T])for(var A=0;A<M.count;++A)w.setX(_,M.getX(A)+E),_++;E+=S.attributes.position.count}}for(var k in h){var P=h[k];if(!(k in n.attributes)){var R=0;for(var C in P)R+=P[C].count;n.setAttribute(k,mS(h[k][0],R))}for(var L=n.attributes[k],I=0,O=0,D=P.length;O<D;O++){var N=P[O];!0!==u[O]&&vS(N,L,I),I+=N.count}}}(i,{useGroups:r,skipAttributes:t},e);for(var p in e.attributes)e.attributes[p].needsUpdate=!0;return e}},{key:"_convertToStaticGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qu,n=e.geometry,r=this.applyWorldTransforms,i=this.attributes.includes("normal"),a=this.attributes.includes("tangent"),o=n.attributes,s=t.attributes;!t.index&&n.index&&(t.index=n.index.clone()),s.position||t.setAttribute("position",mS(o.position)),i&&!s.normal&&o.normal&&t.setAttribute("normal",mS(o.normal)),a&&!s.tangent&&o.tangent&&t.setAttribute("tangent",mS(o.tangent)),pS(n.index,t.index),pS(o.position,s.position),i&&pS(o.normal,s.normal),a&&pS(o.tangent,s.tangent);var l=o.position,u=i?o.normal:null,c=a?o.tangent:null,h=n.morphAttributes.position,d=n.morphAttributes.normal,f=n.morphAttributes.tangent,p=n.morphTargetsRelative,m=e.morphTargetInfluences,v=new xs;v.getNormalMatrix(e.matrixWorld),n.index&&t.index.array.set(n.index.array);for(var g=0,y=o.position.count;g<y;g++)iS.fromBufferAttribute(l,g),u&&aS.fromBufferAttribute(u,g),c&&(sS.fromBufferAttribute(c,g),oS.fromBufferAttribute(c,g)),m&&(h&&bS(h,m,p,g,iS),d&&bS(d,m,p,g,aS),f&&bS(f,m,p,g,oS)),e.isSkinnedMesh&&(e.applyBoneTransform(g,iS),u&&yS(e,g,aS),c&&yS(e,g,oS)),r&&iS.applyMatrix4(e.matrixWorld),s.position.setXYZ(g,iS.x,iS.y,iS.z),u&&(r&&aS.applyNormalMatrix(v),s.normal.setXYZ(g,aS.x,aS.y,aS.z)),c&&(r&&oS.transformDirection(e.matrixWorld),s.tangent.setXYZW(g,oS.x,oS.y,oS.z,sS.w));for(var b in this.attributes){var x=this.attributes[b];"position"!==x&&"tangent"!==x&&"normal"!==x&&x in o&&(s[x]||t.setAttribute(x,mS(o[x])),pS(o[x],s[x]),vS(o[x],s[x]))}return e.matrixWorld.determinant()<0&&function(e){var t=e.index,n=e.attributes;if(t)for(var r=0,i=t.count;r<i;r+=3){var a=t.getX(r),o=t.getX(r+2);t.setX(r,o),t.setX(r+2,a)}else for(var s in n)for(var l=n[s],u=l.itemSize,c=0,h=l.count;c<h;c+=3)for(var d=0;d<u;d++){var f=l.getComponent(c,d),p=l.getComponent(c+2,d);l.setComponent(c,d,p),l.setComponent(c+2,d,f)}}(t),t}}]),e}(),_S=0,ES=1,TS=2,SS=2,MS=1.25,AS=1,kS=32,PS=65535,RS=Math.pow(2,-24),CS=Symbol("SKIP_GENERATION");function LS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function IS(e){return function(e){return e.index?e.index.count:e.attributes.position.count}(e)/3}function OS(e){var t=IS(e),n=e.drawRange,r=n.start/3,i=(n.start+n.count)/3,a=Math.max(0,r),o=Math.min(t,i)-a;return[{offset:Math.floor(a),count:Math.floor(o)}]}function DS(e){if(!e.groups||!e.groups.length)return OS(e);var t,n=[],r=new Set,i=e.drawRange,a=i.start/3,o=(i.start+i.count)/3,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return LS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LS(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e.groups);try{for(s.s();!(t=s.n()).done;){var l=t.value,u=l.start/3,c=(l.start+l.count)/3;r.add(Math.max(a,u)),r.add(Math.min(o,c))}}catch(e){s.e(e)}finally{s.f()}for(var h=Array.from(r.values()).sort((function(e,t){return e-t})),d=0;d<h.length-1;d++){var f=h[d],p=h[d+1];n.push({offset:Math.floor(f),count:Math.floor(p-f)})}return n}function NS(e,t,n,r,i){for(var a=1/0,o=1/0,s=1/0,l=-1/0,u=-1/0,c=-1/0,h=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,v=-1/0,g=6*t,y=6*(t+n);g<y;g+=6){var b=e[g+0],x=e[g+1],w=b-x,_=b+x;w<a&&(a=w),_>l&&(l=_),b<h&&(h=b),b>p&&(p=b);var E=e[g+2],T=e[g+3],S=E-T,M=E+T;S<o&&(o=S),M>u&&(u=M),E<d&&(d=E),E>m&&(m=E);var A=e[g+4],k=e[g+5],P=A-k,R=A+k;P<s&&(s=P),R>c&&(c=R),A<f&&(f=A),A>v&&(v=A)}r[0]=a,r[1]=o,r[2]=s,r[3]=l,r[4]=u,r[5]=c,i[0]=h,i[1]=d,i[2]=f,i[3]=p,i[4]=m,i[5]=v}function BS(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function US(e){for(var t=-1,n=-1/0,r=0;r<3;r++){var i=e[r+3]-e[r];i>n&&(n=i,t=r)}return t}function zS(e,t){t.set(e)}function FS(e,t,n){for(var r,i,a=0;a<3;a++){var o=a+3;r=e[a],i=t[a],n[a]=r<i?r:i,r=e[o],i=t[o],n[o]=r>i?r:i}}function HS(e,t,n){for(var r=0;r<3;r++){var i=t[e+2*r],a=t[e+2*r+1],o=i-a,s=i+a;o<n[r]&&(n[r]=o),s>n[r+3]&&(n[r+3]=s)}}function jS(e){var t=e[3]-e[0],n=e[4]-e[1],r=e[5]-e[2];return 2*(t*n+n*r+r*t)}function GS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var VS=32,WS=function(e,t){return e.candidate-t.candidate},qS=new Array(VS).fill().map((function(){return{count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}})),XS=new Float32Array(6);function YS(e){return YS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},YS(e)}function KS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ZS(r.key),r)}}function JS(e,t,n){return t&&KS(e.prototype,t),n&&KS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZS(e){var t=function(e,t){if("object"!=YS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=YS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==YS(t)?t:String(t)}var QS,$S,eM,tM,nM=JS((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.boundingData=new Float32Array(6)}));function rM(e,t,n,r,i,a){for(var o=r,s=r+i-1,l=a.pos,u=2*a.axis;;){for(;o<=s&&n[6*o+u]<l;)o++;for(;o<=s&&n[6*s+u]>=l;)s--;if(!(o<s))return o;for(var c=0;c<3;c++){var h=t[3*o+c];t[3*o+c]=t[3*s+c],t[3*s+c]=h}for(var d=0;d<6;d++){var f=n[6*o+d];n[6*o+d]=n[6*s+d],n[6*s+d]=f}o++,s--}}function iM(e,t,n,r,i,a){for(var o=r,s=r+i-1,l=a.pos,u=2*a.axis;;){for(;o<=s&&n[6*o+u]<l;)o++;for(;o<=s&&n[6*s+u]>=l;)s--;if(!(o<s))return o;var c=e[o];e[o]=e[s],e[s]=c;for(var h=0;h<6;h++){var d=n[6*o+h];n[6*o+h]=n[6*s+h],n[6*s+h]=d}o++,s--}}function aM(e,t){return 65535===t[e+15]}function oM(e,t){return t[e+6]}function sM(e,t){return t[e+14]}function lM(e){return e+8}function uM(e,t){return t[e+6]}function cM(e,t){return t[e+7]}var hM=Math.pow(2,32);function dM(e){return"count"in e?1:1+dM(e.left)+dM(e.right)}function fM(e,t,n){return QS=new Float32Array(n),$S=new Uint32Array(n),eM=new Uint16Array(n),tM=new Uint8Array(n),pM(e,t)}function pM(e,t){for(var n=e/4,r=e/2,i=("count"in t),a=t.boundingData,o=0;o<6;o++)QS[n+o]=a[o];if(i){if(t.buffer){var s=t.buffer;tM.set(new Uint8Array(s),e);for(var l=e,u=e+s.byteLength;l<u;l+=kS)aM(l/2,eM)||($S[l/4+6]+=n);return e+s.byteLength}var c=t.offset,h=t.count;return $S[n+6]=c,eM[r+14]=h,eM[r+15]=PS,e+kS}var d,f=t.left,p=t.right,m=t.splitAxis;if((d=pM(e+kS,f))/4>hM)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return $S[n+6]=d/4,d=pM(d,p),$S[n+7]=m,d}function mM(e,t){var n=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){for(var n=(e.index?e.index.count:e.attributes.position.count)/3,r=n>Math.pow(2,16),i=r?4:2,a=t?new SharedArrayBuffer(n*i):new ArrayBuffer(n*i),o=r?new Uint32Array(a):new Uint16Array(a),s=0,l=o.length;s<l;s++)o[s]=s;return o}(n,t.useSharedArrayBuffer),function(e){if(0===e.groups.length)return!1;var t=IS(e),n=DS(e).sort((function(e,t){return e.offset-t.offset})),r=n[n.length-1];r.count=Math.min(t-r.offset,r.count);var i=0;return n.forEach((function(e){var t=e.count;return i+=t})),t!==i}(n)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||function(e,t){if(!e.index){var n=e.attributes.position.count,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ArrayBuffer;return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}(n,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new ku(r,1));for(var i=0;i<n;i++)r[i]=i}}(n,t);var r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.attributes.position,o=e.index?e.index.array:null,s=IS(e),l=a.normalized;null===n?(t=new Float32Array(6*s*4),r=0,i=s):(t=n,r=r||0,i=i||s);var u=a.array,c=a.offset||0,h=3;a.isInterleavedBufferAttribute&&(h=a.data.stride);for(var d=["getX","getY","getZ"],f=r;f<r+i;f++){var p=3*f,m=6*f,v=p+0,g=p+1,y=p+2;o&&(v=o[v],g=o[g],y=o[y]),l||(v=v*h+c,g=g*h+c,y=y*h+c);for(var b=0;b<3;b++){var x=void 0,w=void 0,_=void 0;l?(x=a[d[b]](v),w=a[d[b]](g),_=a[d[b]](y)):(x=u[v+b],w=u[g+b],_=u[y+b]);var E=x;w<E&&(E=w),_<E&&(E=_);var T=x;w>T&&(T=w),_>T&&(T=_);var S=(T-E)/2,M=2*b;t[m+M+0]=E+S,t[m+M+1]=S+(Math.abs(E)+S)*RS}}return t}(n),a=t.indirect?OS(n):DS(n);e._roots=a.map((function(n){var a=function(e,t,n,r,i){var a=i.maxDepth,o=i.verbose,s=i.maxLeafTris,l=i.strategy,u=i.onProgress,c=i.indirect,h=e._indirectBuffer,d=e.geometry,f=d.index?d.index.array:null,p=c?iM:rM,m=IS(d),v=new Float32Array(6),g=!1,y=new nM;return NS(t,n,r,y.boundingData,v),function e(n,r,i){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!g&&c>=a&&(g=!0,o&&(console.warn("MeshBVH: Max depth of ".concat(a," reached when generating BVH. Consider increasing maxDepth.")),console.warn(d))),i<=s||c>=a)return b(r+i),n.offset=r,n.count=i,n;var m=function(e,t,n,r,i,a){var o,s=-1,l=0;if(a===_S)-1!==(s=US(t))&&(l=(t[s]+t[s+3])/2);else if(a===ES)-1!==(s=US(e))&&(l=function(e,t,n,r){for(var i=0,a=t,o=t+n;a<o;a++)i+=e[6*a+2*r];return i/n}(n,r,i,s));else if(a===TS)for(var u=jS(e),c=MS*i,h=6*r,d=6*(r+i),f=0;f<3;f++){var p=t[f],m=(t[f+3]-p)/VS;if(i<VS/4){var v=function(e){if(Array.isArray(e))return GS(e)}(o=qS)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return GS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?GS(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();v.length=i;for(var g=0,y=h;y<d;y+=6,g++){var b=v[g];b.candidate=n[y+2*f],b.count=0;for(var x=b.bounds,w=b.leftCacheBounds,_=b.rightCacheBounds,E=0;E<3;E++)_[E]=1/0,_[E+3]=-1/0,w[E]=1/0,w[E+3]=-1/0,x[E]=1/0,x[E+3]=-1/0;HS(y,n,x)}v.sort(WS);for(var T=i,S=0;S<T;S++)for(var M=v[S];S+1<T&&v[S+1].candidate===M.candidate;)v.splice(S+1,1),T--;for(var A=h;A<d;A+=6)for(var k=n[A+2*f],P=0;P<T;P++){var R=v[P];k>=R.candidate?HS(A,n,R.rightCacheBounds):(HS(A,n,R.leftCacheBounds),R.count++)}for(var C=0;C<T;C++){var L=v[C],I=L.count,O=i-L.count,D=L.leftCacheBounds,N=L.rightCacheBounds,B=0;0!==I&&(B=jS(D)/u);var U=0;0!==O&&(U=jS(N)/u);var z=AS+MS*(B*I+U*O);z<c&&(s=f,c=z,l=L.candidate)}}else{for(var F=0;F<VS;F++){var H=qS[F];H.count=0,H.candidate=p+m+F*m;for(var j=H.bounds,G=0;G<3;G++)j[G]=1/0,j[G+3]=-1/0}for(var V=h;V<d;V+=6){var W=~~((n[V+2*f]-p)/m);W>=VS&&(W=VS-1);var q=qS[W];q.count++,HS(V,n,q.bounds)}var X=qS[VS-1];zS(X.bounds,X.rightCacheBounds);for(var Y=VS-2;Y>=0;Y--){var K=qS[Y],J=qS[Y+1];FS(K.bounds,J.rightCacheBounds,K.rightCacheBounds)}for(var Z=0,Q=0;Q<VS-1;Q++){var $=qS[Q],ee=$.count,te=$.bounds,ne=qS[Q+1].rightCacheBounds;0!==ee&&(0===Z?zS(te,XS):FS(te,XS,XS));var re=0,ie=0;0!==(Z+=ee)&&(re=jS(XS)/u);var ae=i-Z;0!==ae&&(ie=jS(ne)/u);var oe=AS+MS*(re*Z+ie*ae);oe<c&&(s=f,c=oe,l=$.candidate)}}}else console.warn("MeshBVH: Invalid build strategy value ".concat(a," used."));return{axis:s,pos:l}}(n.boundingData,u,t,r,i,l);if(-1===m.axis)return b(r+i),n.offset=r,n.count=i,n;var y=p(h,f,t,r,i,m);if(y===r||y===r+i)b(r+i),n.offset=r,n.count=i;else{n.splitAxis=m.axis;var x=new nM,w=r,_=y-r;n.left=x,NS(t,w,_,x.boundingData,v),e(x,w,_,v,c+1);var E=new nM,T=y,S=i-_;n.right=E,NS(t,T,S,E.boundingData,v),e(E,T,S,v,c+1)}return n}(y,n,r,v),y;function b(e){u&&u(e/m)}}(e,i,n.offset,n.count,t),o=dM(a),s=new r(kS*o);return fM(0,a,s),s}))}function vM(e){return vM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vM(e)}function gM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yM(r.key),r)}}function yM(e){var t=function(e,t){if("object"!=vM(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=vM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==vM(t)?t:String(t)}var bM,xM=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.min=1/0,this.max=-1/0}var t,n;return t=e,n=[{key:"setFromPointsField",value:function(e,t){for(var n=1/0,r=-1/0,i=0,a=e.length;i<a;i++){var o=e[i][t];n=o<n?o:n,r=o>r?o:r}this.min=n,this.max=r}},{key:"setFromPoints",value:function(e,t){for(var n=1/0,r=-1/0,i=0,a=t.length;i<a;i++){var o=t[i],s=e.dot(o);n=s<n?s:n,r=s>r?s:r}this.min=n,this.max=r}},{key:"isSeparated",value:function(e){return this.min>e.max||e.min>this.max}}],n&&gM(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();xM.prototype.setFromBox=(bM=new Qs,function(e,t){for(var n=t.min,r=t.max,i=1/0,a=-1/0,o=0;o<=1;o++)for(var s=0;s<=1;s++)for(var l=0;l<=1;l++){bM.x=n.x*o+r.x*(1-o),bM.y=n.y*s+r.y*(1-s),bM.z=n.z*l+r.z*(1-l);var u=e.dot(bM);i=Math.min(u,i),a=Math.max(u,a)}this.min=i,this.max=a}),new xM;var wM,_M,EM,TM,SM,MM,AM,kM=(wM=new Qs,_M=new Qs,EM=new Qs,function(e,t,n){var r=e.start,i=wM,a=t.start,o=_M;EM.subVectors(r,a),wM.subVectors(e.end,e.start),_M.subVectors(t.end,t.start);var s,l,u=EM.dot(o),c=o.dot(i),h=o.dot(o),d=EM.dot(i),f=i.dot(i)*h-c*c;l=(u+(s=0!==f?(u*c-d*h)/f:0)*c)/h,n.x=s,n.y=l}),PM=function(){var e=new bs,t=new Qs,n=new Qs;return function(r,i,a,o){kM(r,i,e);var s,l,u=e.x,c=e.y;if(u>=0&&u<=1&&c>=0&&c<=1)return r.at(u,a),void i.at(c,o);if(u>=0&&u<=1)return c<0?i.at(0,o):i.at(1,o),void r.closestPointToPoint(o,!0,a);if(c>=0&&c<=1)return u<0?r.at(0,a):r.at(1,a),void i.closestPointToPoint(a,!0,o);s=u<0?r.start:r.end,l=c<0?i.start:i.end;var h=t,d=n;return r.closestPointToPoint(l,!0,t),i.closestPointToPoint(s,!0,n),h.distanceToSquared(l)<=d.distanceToSquared(s)?(a.copy(h),void o.copy(l)):(a.copy(s),void o.copy(d))}}(),RM=(TM=new Qs,SM=new Qs,MM=new Ac,AM=new Cy,function(e,t){var n=e.radius,r=e.center,i=t.a,a=t.b,o=t.c;if(AM.start=i,AM.end=a,AM.closestPointToPoint(r,!0,TM).distanceTo(r)<=n)return!0;if(AM.start=i,AM.end=o,AM.closestPointToPoint(r,!0,TM).distanceTo(r)<=n)return!0;if(AM.start=a,AM.end=o,AM.closestPointToPoint(r,!0,TM).distanceTo(r)<=n)return!0;var s=t.getPlane(MM);if(Math.abs(s.distanceToPoint(r))<=n){var l=s.projectPoint(r,SM);if(t.containsPoint(l))return!0}return!1});function CM(e){return CM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CM(e)}function LM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,IM(r.key),r)}}function IM(e){var t=function(e,t){if("object"!=CM(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=CM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==CM(t)?t:String(t)}function OM(e,t,n){return t=NM(t),function(e,t){if(t&&("object"===CM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,DM()?Reflect.construct(t,n||[],NM(e).constructor):t.apply(e,n))}function DM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(DM=function(){return!!e})()}function NM(e){return NM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},NM(e)}function BM(e,t){return BM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},BM(e,t)}function UM(e){return Math.abs(e)<1e-15}var zM,FM,HM,jM,GM=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=OM(this,t,[].concat(r))).isExtendedTriangle=!0,e.satAxes=new Array(4).fill().map((function(){return new Qs})),e.satBounds=new Array(4).fill().map((function(){return new xM})),e.points=[e.a,e.b,e.c],e.sphere=new bl,e.plane=new Ac,e.needsUpdate=!0,e}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BM(e,t)}(t,e),n=t,r=[{key:"intersectsSphere",value:function(e){return RM(e,this)}},{key:"update",value:function(){var e=this.a,t=this.b,n=this.c,r=this.points,i=this.satAxes,a=this.satBounds,o=i[0],s=a[0];this.getNormal(o),s.setFromPoints(o,r);var l=i[1],u=a[1];l.subVectors(e,t),u.setFromPoints(l,r);var c=i[2],h=a[2];c.subVectors(t,n),h.setFromPoints(c,r);var d=i[3],f=a[3];d.subVectors(n,e),f.setFromPoints(d,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}}],r&&LM(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(hu);function VM(e){return VM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VM(e)}function WM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qM(r.key),r)}}function qM(e){var t=function(e,t){if("object"!=VM(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=VM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==VM(t)?t:String(t)}GM.prototype.closestPointToSegment=(zM=new Qs,FM=new Qs,HM=new Cy,function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.start,a=e.end,o=this.points,s=1/0,l=0;l<3;l++){var u=(l+1)%3;HM.start.copy(o[l]),HM.end.copy(o[u]),PM(HM,e,zM,FM),(t=zM.distanceToSquared(FM))<s&&(s=t,n&&n.copy(zM),r&&r.copy(FM))}return this.closestPointToPoint(i,zM),(t=i.distanceToSquared(zM))<s&&(s=t,n&&n.copy(zM),r&&r.copy(i)),this.closestPointToPoint(a,zM),(t=a.distanceToSquared(zM))<s&&(s=t,n&&n.copy(zM),r&&r.copy(a)),Math.sqrt(s)}),GM.prototype.intersectsTriangle=function(){var e=new GM,t=new Array(3),n=new Array(3),r=new xM,i=new xM,a=new Qs,o=new Qs,s=new Qs,l=new Qs,u=new Qs,c=new Cy,h=new Cy,d=new Cy,f=new Qs;function p(e,t,n){for(var r=e.points,i=0,a=-1,s=0;s<3;s++){var l=c.start,u=c.end;l.copy(r[s]),u.copy(r[(s+1)%3]),c.delta(o);var h=UM(t.distanceToPoint(l));if(UM(t.normal.dot(o))&&h){n.copy(c),i=2;break}var d=t.intersectLine(c,f);if(!d&&h&&f.copy(l),(d||h)&&!UM(f.distanceTo(u))){if(i<=1)(1===i?n.start:n.end).copy(f),h&&(a=i);else if(i>=2){(1===a?n.start:n.end).copy(f),i=2;break}if(2==++i&&-1===a)break}}return i}return function(o){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(e.copy(o),e.update(),o=e);var m=this.plane,v=o.plane;if(Math.abs(m.normal.dot(v.normal))>1-1e-10){var g=this.satBounds,y=this.satAxes;n[0]=o.a,n[1]=o.b,n[2]=o.c;for(var b=0;b<4;b++){var x=g[b],w=y[b];if(r.setFromPoints(w,n),x.isSeparated(r))return!1}var _=o.satBounds,E=o.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(var T=0;T<4;T++){var S=_[T],M=E[T];if(r.setFromPoints(M,t),S.isSeparated(r))return!1}for(var A=0;A<4;A++)for(var k=y[A],P=0;P<4;P++){var R=E[P];if(a.crossVectors(k,R),r.setFromPoints(a,t),i.setFromPoints(a,n),r.isSeparated(i))return!1}return c&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),c.start.set(0,0,0),c.end.set(0,0,0)),!0}var C=p(this,v,h);if(1===C&&o.containsPoint(h.end))return c&&(c.start.copy(h.end),c.end.copy(h.end)),!0;if(2!==C)return!1;var L=p(o,m,d);if(1===L&&this.containsPoint(d.end))return c&&(c.start.copy(d.end),c.end.copy(d.end)),!0;if(2!==L)return!1;if(h.delta(s),d.delta(l),s.dot(l)<0){var I=d.start;d.start=d.end,d.end=I}var O=h.start.dot(s),D=h.end.dot(s),N=d.start.dot(s),B=d.end.dot(s);return(O===B||N===D||D<N!=O<B)&&(c&&(u.subVectors(h.start,d.start),u.dot(s)>0?c.start.copy(h.start):c.start.copy(d.start),u.subVectors(h.end,d.end),u.dot(s)<0?c.end.copy(h.end):c.end.copy(d.end)),!0)}}(),GM.prototype.distanceToPoint=(jM=new Qs,function(e){return this.closestPointToPoint(e,jM),e.distanceTo(jM)}),GM.prototype.distanceToTriangle=function(){var e=new Qs,t=new Qs,n=["a","b","c"],r=new Cy,i=new Cy;return function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=o||s?r:null;if(this.intersectsTriangle(a,l))return(o||s)&&(o&&l.getCenter(o),s&&l.getCenter(s)),0;for(var u=1/0,c=0;c<3;c++){var h=void 0,d=n[c],f=a[d];this.closestPointToPoint(f,e),(h=f.distanceToSquared(e))<u&&(u=h,o&&o.copy(e),s&&s.copy(f));var p=this[d];a.closestPointToPoint(p,e),(h=p.distanceToSquared(e))<u&&(u=h,o&&o.copy(p),s&&s.copy(e))}for(var m=0;m<3;m++){var v=n[m],g=n[(m+1)%3];r.set(this[v],this[g]);for(var y=0;y<3;y++){var b=n[y],x=n[(y+1)%3];i.set(a[b],a[x]),PM(r,i,e,t);var w=e.distanceToSquared(t);w<u&&(u=w,o&&o.copy(e),s&&s.copy(t))}}return Math.sqrt(u)}}();var XM,YM,KM,JM,ZM,QM,$M=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isOrientedBox=!0,this.min=new Qs,this.max=new Qs,this.matrix=new kl,this.invMatrix=new kl,this.points=new Array(8).fill().map((function(){return new Qs})),this.satAxes=new Array(3).fill().map((function(){return new Qs})),this.satBounds=new Array(3).fill().map((function(){return new xM})),this.alignedSatBounds=new Array(3).fill().map((function(){return new xM})),this.needsUpdate=!1,t&&this.min.copy(t),n&&this.max.copy(n),r&&this.matrix.copy(r)}var t,n;return t=e,(n=[{key:"set",value:function(e,t,n){this.min.copy(e),this.max.copy(t),this.matrix.copy(n),this.needsUpdate=!0}},{key:"copy",value:function(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}])&&WM(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function eA(e){return eA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eA(e)}function tA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nA(r.key),r)}}function nA(e){var t=function(e,t){if("object"!=eA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=eA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==eA(t)?t:String(t)}$M.prototype.update=function(){for(var e=this.matrix,t=this.min,n=this.max,r=this.points,i=0;i<=1;i++)for(var a=0;a<=1;a++)for(var o=0;o<=1;o++){var s=r[1*i|2*a|4*o];s.x=i?n.x:t.x,s.y=a?n.y:t.y,s.z=o?n.z:t.z,s.applyMatrix4(e)}for(var l=this.satBounds,u=this.satAxes,c=r[0],h=0;h<3;h++){var d=u[h],f=l[h],p=r[1<<h];d.subVectors(c,p),f.setFromPoints(d,r)}var m=this.alignedSatBounds;m[0].setFromPointsField(r,"x"),m[1].setFromPointsField(r,"y"),m[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},$M.prototype.intersectsBox=(XM=new xM,function(e){this.needsUpdate&&this.update();var t=e.min,n=e.max,r=this.satBounds,i=this.satAxes,a=this.alignedSatBounds;if(XM.min=t.x,XM.max=n.x,a[0].isSeparated(XM))return!1;if(XM.min=t.y,XM.max=n.y,a[1].isSeparated(XM))return!1;if(XM.min=t.z,XM.max=n.z,a[2].isSeparated(XM))return!1;for(var o=0;o<3;o++){var s=i[o],l=r[o];if(XM.setFromBox(s,e),l.isSeparated(XM))return!1}return!0}),$M.prototype.intersectsTriangle=(YM=new GM,KM=new Array(3),JM=new xM,ZM=new xM,QM=new Qs,function(e){this.needsUpdate&&this.update(),e.isExtendedTriangle?e.needsUpdate&&e.update():(YM.copy(e),YM.update(),e=YM);var t=this.satBounds,n=this.satAxes;KM[0]=e.a,KM[1]=e.b,KM[2]=e.c;for(var r=0;r<3;r++){var i=t[r],a=n[r];if(JM.setFromPoints(a,KM),i.isSeparated(JM))return!1}for(var o=e.satBounds,s=e.satAxes,l=this.points,u=0;u<3;u++){var c=o[u],h=s[u];if(JM.setFromPoints(h,l),c.isSeparated(JM))return!1}for(var d=0;d<3;d++)for(var f=n[d],p=0;p<4;p++){var m=s[p];if(QM.crossVectors(f,m),JM.setFromPoints(QM,KM),ZM.setFromPoints(QM,l),JM.isSeparated(ZM))return!1}return!0}),$M.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},$M.prototype.distanceToPoint=function(){var e=new Qs;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),$M.prototype.distanceToBox=function(){var e=["x","y","z"],t=new Array(12).fill().map((function(){return new Cy})),n=new Array(12).fill().map((function(){return new Cy})),r=new Qs,i=new Qs;return function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||l)&&(a.getCenter(i),this.closestPointToPoint(i,r),a.closestPointToPoint(r,i),s&&s.copy(r),l&&l.copy(i)),0;for(var u=o*o,c=a.min,h=a.max,d=this.points,f=1/0,p=0;p<8;p++){var m=d[p];i.copy(m).clamp(c,h);var v=m.distanceToSquared(i);if(v<f&&(f=v,s&&s.copy(m),l&&l.copy(i),v<u))return Math.sqrt(v)}for(var g=0,y=0;y<3;y++)for(var b=0;b<=1;b++)for(var x=0;x<=1;x++){var w=(y+1)%3,_=(y+2)%3,E=1<<y|b<<w|x<<_,T=d[b<<w|x<<_],S=d[E];t[g].set(T,S);var M=e[y],A=e[w],k=e[_],P=n[g],R=P.start,C=P.end;R[M]=c[M],R[A]=b?c[A]:h[A],R[k]=x?c[k]:h[A],C[M]=h[M],C[A]=b?c[A]:h[A],C[k]=x?c[k]:h[A],g++}for(var L=0;L<=1;L++)for(var I=0;I<=1;I++)for(var O=0;O<=1;O++){i.x=L?h.x:c.x,i.y=I?h.y:c.y,i.z=O?h.z:c.z,this.closestPointToPoint(i,r);var D=i.distanceToSquared(r);if(D<f&&(f=D,s&&s.copy(r),l&&l.copy(i),D<u))return Math.sqrt(D)}for(var N=0;N<12;N++)for(var B=t[N],U=0;U<12;U++){var z=n[U];PM(B,z,r,i);var F=r.distanceToSquared(i);if(F<f&&(f=F,s&&s.copy(r),l&&l.copy(i),F<u))return Math.sqrt(F)}return Math.sqrt(f)}}();var rA=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._getNewPrimitive=t,this._primitives=[]}var t,n;return t=e,(n=[{key:"getPrimitive",value:function(){var e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}},{key:"releasePrimitive",value:function(e){this._primitives.push(e)}}])&&tA(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function iA(e){return iA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iA(e)}function aA(e,t,n){return t=sA(t),function(e,t){if(t&&("object"===iA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,oA()?Reflect.construct(t,n||[],sA(e).constructor):t.apply(e,n))}function oA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(oA=function(){return!!e})()}function sA(e){return sA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sA(e)}function lA(e,t){return lA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lA(e,t)}var uA=new(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),aA(this,t,[function(){return new GM}])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lA(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(rA));function cA(e){return cA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cA(e)}function hA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fA(r.key),r)}}function dA(e,t,n){return t&&hA(e.prototype,t),n&&hA(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function fA(e){var t=function(e,t){if("object"!=cA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=cA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==cA(t)?t:String(t)}var pA,mA,vA=new(dA((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.float32Array=null,this.uint16Array=null,this.uint32Array=null;var n=[],r=null;this.setBuffer=function(e){r&&n.push(r),r=e,t.float32Array=new Float32Array(e),t.uint16Array=new Uint16Array(e),t.uint32Array=new Uint32Array(e)},this.clearBuffer=function(){r=null,t.float32Array=null,t.uint16Array=null,t.uint32Array=null,0!==n.length&&t.setBuffer(n.pop())}}))),gA=[],yA=new rA((function(){return new tl}));function bA(e,t,n,r,i,a){pA=yA.getPrimitive(),mA=yA.getPrimitive(),gA.push(pA,mA),vA.setBuffer(e._roots[t]);var o=xA(0,e.geometry,n,r,i,a);vA.clearBuffer(),yA.releasePrimitive(pA),yA.releasePrimitive(mA),gA.pop(),gA.pop();var s=gA.length;return s>0&&(mA=gA[s-1],pA=gA[s-2]),o}function xA(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=vA.float32Array,l=vA.uint16Array,u=vA.uint32Array,c=2*e;if(aM(c,l)){var h=oM(e,u),d=sM(c,l);return BS(e,s,pA),r(h,d,!1,o,a+e,pA)}var f,p,m,v,g=function(e){for(var t=vA.uint16Array,n=vA.uint32Array,r=2*e;!aM(r,t);)r=2*(e=lM(e));return oM(e,n)},y=function(e){for(var t=vA.uint16Array,n=vA.uint32Array,r=2*e;!aM(r,t);)r=2*(e=uM(e,n));return oM(e,n)+sM(r,t)},b=lM(e),x=uM(e,u),w=b,_=x;if(i&&(v=mA,BS(w,s,m=pA),BS(_,s,v),f=i(m),(p=i(v))<f)){w=x,_=b;var E=f;f=p,p=E,m=v}m||BS(w,s,m=pA);var T,S=n(m,aM(2*w,l),f,o+1,a+w);if(S===SS){var M=g(w);T=r(M,y(w)-M,!0,o+1,a+w,m)}else T=S&&xA(w,t,n,r,i,a,o+1);if(T)return!0;BS(_,s,v=mA);var A,k=n(v,aM(2*_,l),p,o+1,a+_);if(k===SS){var P=g(_);A=r(P,y(_)-P,!0,o+1,a+_,v)}else A=k&&xA(_,t,n,r,i,a,o+1);return!!A}var wA=new Qs,_A=new Qs,EA=new Qs,TA=new Qs,SA=new Qs,MA=new bs,AA=new bs,kA=new bs,PA=new Qs,RA=new Qs,CA=new Qs,LA=new Qs;function IA(e,t,n,r,i){var a=3*r,o=a+0,s=a+1,l=a+2,u=e.index;e.index&&(o=u.getX(o),s=u.getX(s),l=u.getX(l));var c=e.attributes,h=function(e,t,n,r,i,a,o,s,l){EA.fromBufferAttribute(t,a),TA.fromBufferAttribute(t,o),SA.fromBufferAttribute(t,s);var u=function(e,t,n,r,i,a){return null===(a===Cr?e.intersectTriangle(r,n,t,!0,i):e.intersectTriangle(t,n,r,a!==Lr,i))?null:{distance:e.origin.distanceTo(i),point:i.clone()}}(e,EA,TA,SA,LA,l);if(u){r&&(MA.fromBufferAttribute(r,a),AA.fromBufferAttribute(r,o),kA.fromBufferAttribute(r,s),u.uv=hu.getInterpolation(LA,EA,TA,SA,MA,AA,kA,new bs)),i&&(MA.fromBufferAttribute(i,a),AA.fromBufferAttribute(i,o),kA.fromBufferAttribute(i,s),u.uv1=hu.getInterpolation(LA,EA,TA,SA,MA,AA,kA,new bs)),n&&(PA.fromBufferAttribute(n,a),RA.fromBufferAttribute(n,o),CA.fromBufferAttribute(n,s),u.normal=hu.getInterpolation(LA,EA,TA,SA,PA,RA,CA,new Qs),u.normal.dot(e.direction)>0&&u.normal.multiplyScalar(-1));var c={a,b:o,c:s,normal:new Qs,materialIndex:0};hu.getNormal(EA,TA,SA,c.normal),u.face=c,u.faceIndex=a}return u}(n,c.position,c.normal,c.uv,c.uv1,o,s,l,t);return h?(h.faceIndex=r,i&&i.push(h),h):null}function OA(e,t,n,r){var i=e.a,a=e.b,o=e.c,s=t,l=t+1,u=t+2;n&&(s=n.getX(s),l=n.getX(l),u=n.getX(u)),i.x=r.getX(s),i.y=r.getY(s),i.z=r.getZ(s),a.x=r.getX(l),a.y=r.getY(l),a.z=r.getZ(l),o.x=r.getX(u),o.y=r.getY(u),o.z=r.getZ(u)}function DA(e,t,n,r,i,a,o){for(var s=n.geometry,l=s.index,u=s.attributes.position,c=e,h=t+e;c<h;c++){var d;if(OA(o,3*(d=c),l,u),o.needsUpdate=!0,r(o,d,i,a))return!0}return!1}function NA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&Array.isArray(t)&&(t=new Set(t));for(var n,r,i,a,o=e.geometry,s=o.index?o.index.array:null,l=o.attributes.position,u=0,c=e._roots,h=0,d=c.length;h<d;h++)n=c[h],r=new Uint32Array(n),i=new Uint16Array(n),a=new Float32Array(n),f(0,u),u+=n.byteLength;function f(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=2*e;if(i[u+15]===PS){for(var c=r[e+6],h=1/0,d=1/0,p=1/0,m=-1/0,v=-1/0,g=-1/0,y=3*c,b=3*(c+i[u+14]);y<b;y++){var x=s[y],w=l.getX(x),_=l.getY(x),E=l.getZ(x);w<h&&(h=w),w>m&&(m=w),_<d&&(d=_),_>v&&(v=_),E<p&&(p=E),E>g&&(g=E)}return(a[e+0]!==h||a[e+1]!==d||a[e+2]!==p||a[e+3]!==m||a[e+4]!==v||a[e+5]!==g)&&(a[e+0]=h,a[e+1]=d,a[e+2]=p,a[e+3]=m,a[e+4]=v,a[e+5]=g,!0)}var T=e+8,S=r[e+6],M=T+n,A=S+n,k=o,P=!1,R=!1;t?k||(P=t.has(M),R=t.has(A),k=!P&&!R):(P=!0,R=!0);var C=k||R,L=!1;(k||P)&&(L=f(T,n,k));var I=!1;C&&(I=f(S,n,k));var O=L||I;if(O)for(var D=0;D<3;D++){var N=T+D,B=S+D,U=a[N],z=a[N+3],F=a[B],H=a[B+3];a[e+D]=U<F?U:F,a[e+D+3]=z>H?z:H}return O}}var BA=new tl;function UA(e,t,n,r){return BS(e,t,BA),n.intersectBox(BA,r)}var zA=new Qs;function FA(e,t,n,r,i){vA.setBuffer(e._roots[t]),HA(0,e,n,r,i),vA.clearBuffer()}function HA(e,t,n,r,i){var a=vA.float32Array,o=vA.uint16Array,s=vA.uint32Array,l=2*e;if(aM(l,o))!function(e,t,n,r,i,a){for(var o=e.geometry,s=(e._indirectBuffer,r),l=r+i;s<l;s++)IA(o,t,n,s,a)}(t,n,r,oM(e,s),sM(l,o),i);else{var u=lM(e);UA(u,a,r,zA)&&HA(u,t,n,r,i);var c=uM(e,s);UA(c,a,r,zA)&&HA(c,t,n,r,i)}}var jA=new Qs,GA=["x","y","z"];function VA(e,t,n,r){vA.setBuffer(e._roots[t]);var i=WA(0,e,n,r);return vA.clearBuffer(),i}function WA(e,t,n,r){var i=vA.float32Array,a=vA.uint16Array,o=vA.uint32Array,s=2*e;if(aM(s,a))return function(e,t,n,r,i){for(var a=e.geometry,o=(e._indirectBuffer,1/0),s=null,l=r,u=r+i;l<u;l++){var c;(c=IA(a,t,n,l))&&c.distance<o&&(s=c,o=c.distance)}return s}(t,n,r,oM(e,o),sM(s,a));var l,u,c=cM(e,o),h=GA[c],d=r.direction[h]>=0;d?(l=lM(e),u=uM(e,o)):(l=uM(e,o),u=lM(e));var f=UA(l,i,r,jA)?WA(l,t,n,r):null;if(f){var p=f.point[h];if(d?p<=i[u+c]:p>=i[u+c+3])return f}var m=UA(u,i,r,jA)?WA(u,t,n,r):null;return f&&m?f.distance<=m.distance?f:m:f||m||null}var qA=new tl,XA=new GM,YA=new GM,KA=new kl,JA=new $M,ZA=new $M;function QA(e,t,n,r){vA.setBuffer(e._roots[t]);var i=$A(0,e,n,r);return vA.clearBuffer(),i}function $A(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=vA.float32Array,o=vA.uint16Array,s=vA.uint32Array,l=2*e;if(null===i&&(n.boundingBox||n.computeBoundingBox(),JA.set(n.boundingBox.min,n.boundingBox.max,r),i=JA),!aM(l,o)){var u=e+8,c=s[e+6];return BS(u,a,qA),!(!i.intersectsBox(qA)||!$A(u,t,n,r,i))||(BS(c,a,qA),!(!i.intersectsBox(qA)||!$A(c,t,n,r,i)))}var h=t.geometry,d=h.index,f=h.attributes.position,p=n.index,m=n.attributes.position,v=oM(e,s),g=sM(l,o);if(KA.copy(r).invert(),n.boundsTree){BS(e,a,ZA),ZA.matrix.copy(KA),ZA.needsUpdate=!0;var y=n.boundsTree.shapecast({intersectsBounds:function(e){return ZA.intersectsBox(e)},intersectsTriangle:function(e){e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(var t=3*v,n=3*(g+v);t<n;t+=3)if(OA(YA,t,d,f),YA.needsUpdate=!0,e.intersectsTriangle(YA))return!0;return!1}});return y}for(var b=3*v,x=3*(g+v);b<x;b+=3){OA(XA,b,d,f),XA.a.applyMatrix4(KA),XA.b.applyMatrix4(KA),XA.c.applyMatrix4(KA),XA.needsUpdate=!0;for(var w=0,_=p.count;w<_;w+=3)if(OA(YA,w,p,m),YA.needsUpdate=!0,XA.intersectsTriangle(YA))return!0}}var ek=new kl,tk=new $M,nk=new $M,rk=new Qs,ik=new Qs,ak=new Qs,ok=new Qs;function sk(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),tk.set(t.boundingBox.min,t.boundingBox.max,n),tk.needsUpdate=!0;var s=e.geometry,l=s.attributes.position,u=s.index,c=t.attributes.position,h=t.index,d=uA.getPrimitive(),f=uA.getPrimitive(),p=rk,m=ik,v=null,g=null;i&&(v=ak,g=ok);var y=1/0,b=null,x=null;return ek.copy(n).invert(),nk.matrix.copy(ek),e.shapecast({boundsTraverseOrder:function(e){return tk.distanceToBox(e)},intersectsBounds:function(e,t,n){return n<y&&n<o&&(t&&(nk.min.copy(e.min),nk.max.copy(e.max),nk.needsUpdate=!0),!0)},intersectsRange:function(e,r){if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:function(e){return nk.distanceToBox(e)},intersectsBounds:function(e,t,n){return n<y&&n<o},intersectsRange:function(t,i){for(var o=t,s=t+i;o<s;o++){OA(f,3*o,h,c),f.a.applyMatrix4(n),f.b.applyMatrix4(n),f.c.applyMatrix4(n),f.needsUpdate=!0;for(var w=e,_=e+r;w<_;w++){OA(d,3*w,u,l),d.needsUpdate=!0;var E=d.distanceToTriangle(f,p,v);if(E<y&&(m.copy(p),g&&g.copy(v),y=E,b=w,x=o),E<a)return!0}}}});for(var i=0,s=IS(t);i<s;i++){OA(f,3*i,h,c),f.a.applyMatrix4(n),f.b.applyMatrix4(n),f.c.applyMatrix4(n),f.needsUpdate=!0;for(var w=e,_=e+r;w<_;w++){OA(d,3*w,u,l),d.needsUpdate=!0;var E=d.distanceToTriangle(f,p,v);if(E<y&&(m.copy(p),g&&g.copy(v),y=E,b=w,x=i),E<a)return!0}}}}),uA.releasePrimitive(d),uA.releasePrimitive(f),y===1/0?null:(r.point?r.point.copy(m):r.point=m.clone(),r.distance=y,r.faceIndex=b,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(ek),m.applyMatrix4(ek),i.distance=m.sub(i.point).length(),i.faceIndex=x),r)}function lk(e,t,n,r,i,a,o){for(var s=n.geometry,l=s.index,u=s.attributes.position,c=e,h=t+e;c<h;c++){var d;if(OA(o,3*(d=n.resolveTriangleIndex(c)),l,u),o.needsUpdate=!0,r(o,d,i,a))return!0}return!1}function uk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&Array.isArray(t)&&(t=new Set(t));for(var n,r,i,a,o=e.geometry,s=o.index?o.index.array:null,l=o.attributes.position,u=0,c=e._roots,h=0,d=c.length;h<d;h++)n=c[h],r=new Uint32Array(n),i=new Uint16Array(n),a=new Float32Array(n),f(0,u),u+=n.byteLength;function f(n,o){var u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=2*n;if(i[c+15]===PS){for(var h=r[n+6],d=1/0,p=1/0,m=1/0,v=-1/0,g=-1/0,y=-1/0,b=h,x=h+i[c+14];b<x;b++)for(var w=3*e.resolveTriangleIndex(b),_=0;_<3;_++){var E=w+_;E=s?s[E]:E;var T=l.getX(E),S=l.getY(E),M=l.getZ(E);T<d&&(d=T),T>v&&(v=T),S<p&&(p=S),S>g&&(g=S),M<m&&(m=M),M>y&&(y=M)}return(a[n+0]!==d||a[n+1]!==p||a[n+2]!==m||a[n+3]!==v||a[n+4]!==g||a[n+5]!==y)&&(a[n+0]=d,a[n+1]=p,a[n+2]=m,a[n+3]=v,a[n+4]=g,a[n+5]=y,!0)}var A=n+8,k=r[n+6],P=A+o,R=k+o,C=u,L=!1,I=!1;t?C||(L=t.has(P),I=t.has(R),C=!L&&!I):(L=!0,I=!0);var O=C||I,D=!1;(C||L)&&(D=f(A,o,C));var N=!1;O&&(N=f(k,o,C));var B=D||N;if(B)for(var U=0;U<3;U++){var z=A+U,F=k+U,H=a[z],j=a[z+3],G=a[F],V=a[F+3];a[n+U]=H<G?H:G,a[n+U+3]=j>V?j:V}return B}}var ck=new Qs;function hk(e,t,n,r,i){vA.setBuffer(e._roots[t]),dk(0,e,n,r,i),vA.clearBuffer()}function dk(e,t,n,r,i){var a=vA.float32Array,o=vA.uint16Array,s=vA.uint32Array,l=2*e;if(aM(l,o))!function(e,t,n,r,i,a){for(var o=e.geometry,s=e._indirectBuffer,l=r,u=r+i;l<u;l++)IA(o,t,n,s?s[l]:l,a)}(t,n,r,oM(e,s),sM(l,o),i);else{var u=lM(e);UA(u,a,r,ck)&&dk(u,t,n,r,i);var c=uM(e,s);UA(c,a,r,ck)&&dk(c,t,n,r,i)}}var fk=new Qs,pk=["x","y","z"];function mk(e,t,n,r){vA.setBuffer(e._roots[t]);var i=vk(0,e,n,r);return vA.clearBuffer(),i}function vk(e,t,n,r){var i=vA.float32Array,a=vA.uint16Array,o=vA.uint32Array,s=2*e;if(aM(s,a))return function(e,t,n,r,i){for(var a=e.geometry,o=e._indirectBuffer,s=1/0,l=null,u=r,c=r+i;u<c;u++){var h;(h=IA(a,t,n,o?o[u]:u))&&h.distance<s&&(l=h,s=h.distance)}return l}(t,n,r,oM(e,o),sM(s,a));var l,u,c=cM(e,o),h=pk[c],d=r.direction[h]>=0;d?(l=lM(e),u=uM(e,o)):(l=uM(e,o),u=lM(e));var f=UA(l,i,r,fk)?vk(l,t,n,r):null;if(f){var p=f.point[h];if(d?p<=i[u+c]:p>=i[u+c+3])return f}var m=UA(u,i,r,fk)?vk(u,t,n,r):null;return f&&m?f.distance<=m.distance?f:m:f||m||null}var gk=new tl,yk=new GM,bk=new GM,xk=new kl,wk=new $M,_k=new $M;function Ek(e,t,n,r){vA.setBuffer(e._roots[t]);var i=Tk(0,e,n,r);return vA.clearBuffer(),i}function Tk(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=vA.float32Array,o=vA.uint16Array,s=vA.uint32Array,l=2*e;if(null===i&&(n.boundingBox||n.computeBoundingBox(),wk.set(n.boundingBox.min,n.boundingBox.max,r),i=wk),!aM(l,o)){var u=e+8,c=s[e+6];return BS(u,a,gk),!(!i.intersectsBox(gk)||!Tk(u,t,n,r,i))||(BS(c,a,gk),!(!i.intersectsBox(gk)||!Tk(c,t,n,r,i)))}var h=t.geometry,d=h.index,f=h.attributes.position,p=n.index,m=n.attributes.position,v=oM(e,s),g=sM(l,o);if(xk.copy(r).invert(),n.boundsTree){BS(e,a,_k),_k.matrix.copy(xk),_k.needsUpdate=!0;var y=n.boundsTree.shapecast({intersectsBounds:function(e){return _k.intersectsBox(e)},intersectsTriangle:function(e){e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(var n=v,i=g+v;n<i;n++)if(OA(bk,3*t.resolveTriangleIndex(n),d,f),bk.needsUpdate=!0,e.intersectsTriangle(bk))return!0;return!1}});return y}for(var b=v,x=g+v;b<x;b++){var w=t.resolveTriangleIndex(b);OA(yk,3*w,d,f),yk.a.applyMatrix4(xk),yk.b.applyMatrix4(xk),yk.c.applyMatrix4(xk),yk.needsUpdate=!0;for(var _=0,E=p.count;_<E;_+=3)if(OA(bk,_,p,m),bk.needsUpdate=!0,yk.intersectsTriangle(bk))return!0}}var Sk=new kl,Mk=new $M,Ak=new $M,kk=new Qs,Pk=new Qs,Rk=new Qs,Ck=new Qs;function Lk(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),Mk.set(t.boundingBox.min,t.boundingBox.max,n),Mk.needsUpdate=!0;var s=e.geometry,l=s.attributes.position,u=s.index,c=t.attributes.position,h=t.index,d=uA.getPrimitive(),f=uA.getPrimitive(),p=kk,m=Pk,v=null,g=null;i&&(v=Rk,g=Ck);var y=1/0,b=null,x=null;return Sk.copy(n).invert(),Ak.matrix.copy(Sk),e.shapecast({boundsTraverseOrder:function(e){return Mk.distanceToBox(e)},intersectsBounds:function(e,t,n){return n<y&&n<o&&(t&&(Ak.min.copy(e.min),Ak.max.copy(e.max),Ak.needsUpdate=!0),!0)},intersectsRange:function(r,i){if(t.boundsTree){var s=t.boundsTree;return s.shapecast({boundsTraverseOrder:function(e){return Ak.distanceToBox(e)},intersectsBounds:function(e,t,n){return n<y&&n<o},intersectsRange:function(t,o){for(var w=t,_=t+o;w<_;w++){var E=s.resolveTriangleIndex(w);OA(f,3*E,h,c),f.a.applyMatrix4(n),f.b.applyMatrix4(n),f.c.applyMatrix4(n),f.needsUpdate=!0;for(var T=r,S=r+i;T<S;T++){var M=e.resolveTriangleIndex(T);OA(d,3*M,u,l),d.needsUpdate=!0;var A=d.distanceToTriangle(f,p,v);if(A<y&&(m.copy(p),g&&g.copy(v),y=A,b=T,x=w),A<a)return!0}}}})}for(var w=0,_=IS(t);w<_;w++){OA(f,3*w,h,c),f.a.applyMatrix4(n),f.b.applyMatrix4(n),f.c.applyMatrix4(n),f.needsUpdate=!0;for(var E=r,T=r+i;E<T;E++){var S=e.resolveTriangleIndex(E);OA(d,3*S,u,l),d.needsUpdate=!0;var M=d.distanceToTriangle(f,p,v);if(M<y&&(m.copy(p),g&&g.copy(v),y=M,b=E,x=w),M<a)return!0}}}}),uA.releasePrimitive(d),uA.releasePrimitive(f),y===1/0?null:(r.point?r.point.copy(m):r.point=m.clone(),r.distance=y,r.faceIndex=b,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(Sk),m.applyMatrix4(Sk),i.distance=m.sub(i.point).length(),i.faceIndex=x),r)}var Ik=new vA.constructor,Ok=new vA.constructor,Dk=new rA((function(){return new tl})),Nk=new tl,Bk=new tl,Uk=new tl,zk=new tl,Fk=!1;function Hk(e,t,n,r,i){var a,o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=arguments.length>10&&void 0!==arguments[10]&&arguments[10];d?(a=Ok,o=Ik):(a=Ik,o=Ok);var f=a.float32Array,p=a.uint32Array,m=a.uint16Array,v=o.float32Array,g=o.uint32Array,y=o.uint16Array,b=2*t,x=aM(2*e,m),w=aM(b,y),_=!1;if(w&&x)_=d?i(oM(t,g),sM(2*t,y),oM(e,p),sM(2*e,m),c,l+t,u,s+e):i(oM(e,p),sM(2*e,m),oM(t,g),sM(2*t,y),u,s+e,c,l+t);else if(w){var E=Dk.getPrimitive();BS(t,v,E),E.applyMatrix4(n);var T=lM(e),S=uM(e,p);BS(T,f,Nk),BS(S,f,Bk);var M=E.intersectsBox(Nk),A=E.intersectsBox(Bk);_=M&&Hk(t,T,r,n,i,l,s,c,u+1,E,!d)||A&&Hk(t,S,r,n,i,l,s,c,u+1,E,!d),Dk.releasePrimitive(E)}else{var k=lM(t),P=uM(t,g);BS(k,v,Uk),BS(P,v,zk);var R=h.intersectsBox(Uk),C=h.intersectsBox(zk);if(R&&C)_=Hk(e,k,n,r,i,s,l,u,c+1,h,d)||Hk(e,P,n,r,i,s,l,u,c+1,h,d);else if(R)if(x)_=Hk(e,k,n,r,i,s,l,u,c+1,h,d);else{var L=Dk.getPrimitive();L.copy(Uk).applyMatrix4(n);var I=lM(e),O=uM(e,p);BS(I,f,Nk),BS(O,f,Bk);var D=L.intersectsBox(Nk),N=L.intersectsBox(Bk);_=D&&Hk(k,I,r,n,i,l,s,c,u+1,L,!d)||N&&Hk(k,O,r,n,i,l,s,c,u+1,L,!d),Dk.releasePrimitive(L)}else if(C)if(x)_=Hk(e,P,n,r,i,s,l,u,c+1,h,d);else{var B=Dk.getPrimitive();B.copy(zk).applyMatrix4(n);var U=lM(e),z=uM(e,p);BS(U,f,Nk),BS(z,f,Bk);var F=B.intersectsBox(Nk),H=B.intersectsBox(Bk);_=F&&Hk(P,U,r,n,i,l,s,c,u+1,B,!d)||H&&Hk(P,z,r,n,i,l,s,c,u+1,B,!d),Dk.releasePrimitive(B)}}return _}function jk(e){return jk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jk(e)}function Gk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gk(Object(n),!0).forEach((function(t){Wk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wk(e,t,n){return(t=Yk(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qk(){return qk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qk.apply(this,arguments)}function Xk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yk(r.key),r)}}function Yk(e){var t=function(e,t){if("object"!=jk(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=jk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==jk(t)?t:String(t)}var Kk=new $M,Jk=new tl,Zk={strategy:_S,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0},Qk=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((n=qk(Vk(Vk({},Zk),{},Wk({},CS,!1)),n)).useSharedArrayBuffer&&"undefined"==typeof SharedArrayBuffer)throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,n[CS]||(mM(this,n),!t.boundingBox&&n.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new tl)));var r=this._indirectBuffer;this.resolveTriangleIndex=n.indirect?function(e){return r[e]}:function(e){return e}}var t,n,r;return t=e,n=[{key:"indirect",get:function(){return!!this._indirectBuffer}},{key:"refit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(this.indirect?uk:NA)(this,e)}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots[t],r=new Uint32Array(n),i=new Uint16Array(n);!function t(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=2*a,l=i[s+15]===PS;if(l){var u=r[a+6],c=i[s+14];e(o,l,new Float32Array(n,4*a,6),u,c)}else{var h=a+kS/4,d=r[a+6],f=r[a+7];e(o,l,new Float32Array(n,4*a,6),f)||(t(h,o+1),t(d,o+1))}}(0)}},{key:"raycast",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rr,n=this._roots,r=this.geometry,i=[],a=t.isMaterial,o=Array.isArray(t),s=r.groups,l=a?t.side:t,u=this.indirect?hk:FA,c=0,h=n.length;c<h;c++){var d=o?t[s[c].materialIndex].side:l,f=i.length;if(u(this,c,d,e,i),o)for(var p=s[c].materialIndex,m=f,v=i.length;m<v;m++)i[m].face.materialIndex=p}return i}},{key:"raycastFirst",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rr,n=this._roots,r=this.geometry,i=t.isMaterial,a=Array.isArray(t),o=null,s=r.groups,l=i?t.side:t,u=this.indirect?mk:VA,c=0,h=n.length;c<h;c++){var d=u(this,c,a?t[s[c].materialIndex].side:l,e);null!=d&&(null==o||d.distance<o.distance)&&(o=d,a&&(d.face.materialIndex=s[c].materialIndex))}return o}},{key:"intersectsGeometry",value:function(e,t){for(var n=!1,r=this._roots,i=this.indirect?Ek:QA,a=0,o=r.length;a<o&&!(n=i(this,a,e,t));a++);return n}},{key:"shapecast",value:function(e){var t=this,n=uA.getPrimitive(),r=this.indirect?lk:DA,i=e.boundsTraverseOrder,a=e.intersectsBounds,o=e.intersectsRange,s=e.intersectsTriangle;if(o&&s){var l=o;o=function(e,i,a,o,u){return!!l(e,i,a,o,u)||r(e,i,t,s,a,o,n)}}else o||(o=s?function(e,i,a,o){return r(e,i,t,s,a,o,n)}:function(e,t,n){return n});for(var u=!1,c=0,h=this._roots,d=0,f=h.length;d<f;d++){var p=h[d];if(u=bA(this,d,a,o,i,c))break;c+=p.byteLength}return uA.releasePrimitive(n),u}},{key:"bvhcast",value:function(e,t,n){var r=this,i=n.intersectsRanges,a=n.intersectsTriangles,o=uA.getPrimitive(),s=this.geometry.index,l=this.geometry.attributes.position,u=this.indirect?function(e){var t=r.resolveTriangleIndex(e);OA(o,3*t,s,l)}:function(e){OA(o,3*e,s,l)},c=uA.getPrimitive(),h=e.geometry.index,d=e.geometry.attributes.position,f=e.indirect?function(t){var n=e.resolveTriangleIndex(t);OA(c,3*n,h,d)}:function(e){OA(c,3*e,h,d)};if(a){var p=function(e,n,r,i,s,l,h,d){for(var p=r,m=r+i;p<m;p++){f(p),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(var v=e,g=e+n;v<g;v++)if(u(v),o.needsUpdate=!0,a(o,c,v,p,s,l,h,d))return!0}return!1};if(i){var m=i;i=function(e,t,n,r,i,a,o,s){return!!m(e,t,n,r,i,a,o,s)||p(e,t,n,r,i,a,o,s)}}else i=p}return function(e,t,n,r){if(Fk)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Fk=!0;for(var i,a=e._roots,o=t._roots,s=0,l=0,u=(new kl).copy(n).invert(),c=0,h=a.length;c<h;c++){Ik.setBuffer(a[c]),l=0;var d=Dk.getPrimitive();BS(0,Ik.float32Array,d),d.applyMatrix4(u);for(var f=0,p=o.length;f<p&&(Ok.setBuffer(o[c]),i=Hk(0,0,n,u,r,s,l,0,0,d),Ok.clearBuffer(),l+=o[f].length,!i);f++);if(Dk.releasePrimitive(d),Ik.clearBuffer(),s+=a[c].length,i)break}return Fk=!1,i}(this,e,t,i)}},{key:"intersectsBox",value:function(e,t){return Kk.set(e.min,e.max,t),Kk.needsUpdate=!0,this.shapecast({intersectsBounds:function(e){return Kk.intersectsBox(e)},intersectsTriangle:function(e){return Kk.intersectsTriangle(e)}})}},{key:"intersectsSphere",value:function(e){return this.shapecast({intersectsBounds:function(t){return e.intersectsBox(t)},intersectsTriangle:function(t){return t.intersectsSphere(e)}})}},{key:"closestPointToGeometry",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;return(this.indirect?Lk:sk)(this,e,t,n,r,i,a)}},{key:"closestPointToPoint",value:function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=r*r,o=i*i,s=1/0,l=null;if(e.shapecast({boundsTraverseOrder:function(e){return wA.copy(t).clamp(e.min,e.max),wA.distanceToSquared(t)},intersectsBounds:function(e,t,n){return n<s&&n<o},intersectsTriangle:function(e,n){e.closestPointToPoint(t,wA);var r=t.distanceToSquared(wA);return r<s&&(_A.copy(wA),s=r,l=n),r<a}}),s===1/0)return null;var u=Math.sqrt(s);return n.point?n.point.copy(_A):n.point=_A.clone(),n.distance=u,n.faceIndex=l,n}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0)}},{key:"getBoundingBox",value:function(e){return e.makeEmpty(),this._roots.forEach((function(t){BS(0,new Float32Array(t),Jk),e.union(Jk)})),e}}],r=[{key:"serialize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Vk({cloneBuffers:!0},t);var n,r=e.geometry,i=e._roots,a=e._indirectBuffer,o=r.getIndex();return n=t.cloneBuffers?{roots:i.map((function(e){return e.slice()})),index:o.array.slice(),indirectBuffer:a?a.slice():null}:{roots:i,index:o.array,indirectBuffer:a},n}},{key:"deserialize",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=Vk({setIndex:!0,indirect:Boolean(t.indirectBuffer)},r);var i=t.index,a=t.roots,o=t.indirectBuffer,s=new e(n,Vk(Vk({},r),{},Wk({},CS,!0)));if(s._roots=a,s._indirectBuffer=o||null,r.setIndex){var l=n.getIndex();if(null===l){var u=new ku(t.index,1,!1);n.setIndex(u)}else l.array!==i&&(l.array.set(i),l.needsUpdate=!0)}return s}}],n&&Xk(t.prototype,n),r&&Xk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function $k(e){return $k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$k(e)}function eP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tP(r.key),r)}}function tP(e){var t=function(e,t){if("object"!=$k(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=$k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$k(t)?t:String(t)}function nP(e){return nP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nP(e)}function rP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iP(Object(n),!0).forEach((function(t){oP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oP(e,t,n){return(t=uP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sP(){return sP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sP.apply(this,arguments)}function lP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uP(r.key),r)}}function uP(e){var t=function(e,t){if("object"!=nP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=nP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nP(t)?t:String(t)}function cP(e,t,n){return t=dP(t),function(e,t){if(t&&("object"===nP(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,hP()?Reflect.construct(t,n||[],dP(e).constructor):t.apply(e,n))}function hP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(hP=function(){return!!e})()}function dP(e){return dP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dP(e)}function fP(e,t){return fP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fP(e,t)}var pP,mP,vP=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=cP(this,t,[new Worker(new URL(n.p+n.u(480),n.b),{type:void 0})])).name="GenerateMeshBVHWorker",e}var r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fP(e,t)}(t,e),r=t,i=[{key:"runTask",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r,i){if(t.getAttribute("position").isInterleavedBufferAttribute||t.index&&t.index.isInterleavedBufferAttribute)throw new Error("GenerateMeshBVHWorker: InterleavedBufferAttribute are not supported for the geometry attributes.");e.onerror=function(e){i(new Error("GenerateMeshBVHWorker: ".concat(e.message)))},e.onmessage=function(a){var o=a.data;if(o.error)i(new Error(o.error)),e.onmessage=null;else if(o.serialized){var s=o.serialized,l=o.position,u=Qk.deserialize(s,t,{setIndex:!1}),c=sP({setBoundingBox:!0},n);if(t.attributes.position.array=l,t.index)t.index.array=s.index;else{var h=new ku(s.index,1,!1);t.setIndex(h)}c.setBoundingBox&&(t.boundingBox=u.getBoundingBox(new tl)),r(u),e.onmessage=null}else n.onProgress&&n.onProgress(o.progress)};var a,o=t.index?t.index.array:null,s=t.attributes.position.array,l=[s];o&&l.push(o),e.postMessage({index:o,position:s,options:aP(aP({},n),{},{onProgress:null,includedProgressCallback:Boolean(n.onProgress),groups:(a=t.groups,function(e){if(Array.isArray(e))return rP(e)}(a)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return rP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rP(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})},l.map((function(e){return e.buffer})).filter((function(e){return"undefined"==typeof SharedArrayBuffer||!(e instanceof SharedArrayBuffer)})))}))}}],i&&lP(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),t}(function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="WorkerBase",this.running=!1,this.worker=t,this.worker.onerror=function(e){throw e.message?new Error("".concat(n.name,': Could not create Web Worker with error "').concat(e.message,'"')):new Error("".concat(n.name,": Could not create Web Worker."))}}var t,n;return t=e,n=[{key:"runTask",value:function(){}},{key:"generate",value:function(){var e=this;if(this.running)throw new Error("GenerateMeshBVHWorker: Already running job.");if(null===this.worker)throw new Error("GenerateMeshBVHWorker: Worker has been disposed.");this.running=!0;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=this.runTask.apply(this,[this.worker].concat(n));return i.finally((function(){e.running=!1})),i}},{key:"dispose",value:function(){this.worker.terminate(),this.worker=null}}],n&&eP(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()),gP=0,yP=function e(t,n,r){if(n&&(gP=0),gP)setTimeout((function(){e(t)}),500);else{var i=window.performance.now(),a=[];if(t.forEach((function(e){if(e.userData.groupMerged)a.push(e);else if(e.isInstancedMesh){if(e.instanceMatrix)for(var t=ij?e.instanceMatrix.count:Math.floor(e.instanceMatrix.count/2),n=0;n<t;n++){c=e.geometry.clone();var i=new kl;if(e.getMatrixAt(n,i),r){var o=new Qs,s=new Zs,l=new Qs;i.decompose(o,s,l),o.x+=r.x,o.y+=r.y,o.z+=r.z,i.compose(o,s,l)}try{c.applyMatrix4(i)}catch(e){console.log("commune-specific matrix error")}for(var u in c.attributes)"position"!==u&&c.deleteAttribute(u);(c=c.toNonIndexed()).index=null,a.push(c)}}else{e.updateMatrixWorld(!0);var c=e.geometry.clone();for(var h in c.applyMatrix4(e.matrixWorld),c.attributes)"position"!==h&&c.deleteAttribute(h);(c=c.toNonIndexed()).index=null,a.push(c)}})),n&&r){gP=0;var o=new lf,s=Sx(a,!1),l=new cc(s,OF.whiteFull);o.add(l);var u=new wS(o);u.attributes=["position"];var c=u.generate();c.boundsTree=new Qk(c),mP=new cc(c,OF.whiteFull),(pP=new cc(c,OF.cyanFull)).name="collider",pP.material.wireframe=!0,pP.visible=!0}else{var h=Sx(a,!1);Lj(1),gP=1,(new vP).generate(h).then((function(e){h.boundsTree=e,mP=new cc(h,OF.whiteFull),(pP=new cc(h,OF.cyanFull)).name="collider",gP=0,Lj(0);var t=window.performance.now()-i;console.log("Collider generated in ".concat(t.toFixed(3),"ms"))}))}}},bP=function e(){if(pP)if(gP)setTimeout(e,500);else{var t=[],n=[];if(uG.children.forEach((function(e){e.children.forEach((function(e){if(e.material===OF.whiteFull){e.updateMatrixWorld(!0);var t=e.geometry.clone();for(var r in t.applyMatrix4(e.matrixWorld),t.attributes)"position"!==r&&t.deleteAttribute(r);t.index&&(t=t.toNonIndexed()),t.userData.groupMerged=!0,n.push(t)}}))})),n.length>0){var r=Sx(n,!1);r.userData.groupMerged=!0,t.push(r)}t.push(mP.geometry),t.forEach((function(e){for(var t in e.attributes)"position"!==t&&e.deleteAttribute(t);e.index=null}));var i=Sx(t,!1);Lj(1),gP=1,(new vP).generate(i).then((function(e){i.boundsTree=e,(pP=new cc(i,OF.whiteFull)).name="collider",pP.visible=!1,Lj(0),gP=0}))}},xP=Object.create(null);xP.open="0",xP.close="1",xP.ping="2",xP.pong="3",xP.message="4",xP.upgrade="5",xP.noop="6";var wP=Object.create(null);Object.keys(xP).forEach((function(e){wP[xP[e]]=e}));var _P,EP={type:"error",data:"parser error"},TP="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),SP="function"==typeof ArrayBuffer,MP=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},AP=function(e,t,n){var r=e.type,i=e.data;return TP&&i instanceof Blob?t?n(i):kP(i,n):SP&&(i instanceof ArrayBuffer||MP(i))?t?n(i):kP(new Blob([i]),n):n(xP[r]+(i||""))},kP=function(e,t){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function PP(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}for(var RP="undefined"==typeof Uint8Array?[]:new Uint8Array(256),CP=0;CP<64;CP++)RP["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(CP)]=CP;var LP,IP="function"==typeof ArrayBuffer,OP=function(e,t){if("string"!=typeof e)return{type:"message",data:NP(e,t)};var n=e.charAt(0);return"b"===n?{type:"message",data:DP(e.substring(1),t)}:wP[n]?e.length>1?{type:wP[n],data:e.substring(1)}:{type:wP[n]}:EP},DP=function(e,t){if(IP){var n=function(e){var t,n,r,i,a,o=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var u=new ArrayBuffer(o),c=new Uint8Array(u);for(t=0;t<s;t+=4)n=RP[e.charCodeAt(t)],r=RP[e.charCodeAt(t+1)],i=RP[e.charCodeAt(t+2)],a=RP[e.charCodeAt(t+3)],c[l++]=n<<2|r>>4,c[l++]=(15&r)<<4|i>>2,c[l++]=(3&i)<<6|63&a;return u}(e);return NP(n,t)}return{base64:!0,data:e}},NP=function(e,t){return"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer},BP=String.fromCharCode(30);function UP(e){return e.reduce((function(e,t){return e+t.length}),0)}function zP(e,t){if(e[0].length===t)return e.shift();for(var n=new Uint8Array(t),r=0,i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function FP(e){if(e)return function(e){for(var t in FP.prototype)e[t]=FP.prototype[t];return e}(e)}FP.prototype.on=FP.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},FP.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},FP.prototype.off=FP.prototype.removeListener=FP.prototype.removeAllListeners=FP.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},FP.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},FP.prototype.emitReserved=FP.prototype.emit,FP.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},FP.prototype.hasListeners=function(e){return!!this.listeners(e).length};var HP="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function jP(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t}),{})}var GP=HP.setTimeout,VP=HP.clearTimeout;function WP(e,t){t.useNativeTimers?(e.setTimeoutFn=GP.bind(HP),e.clearTimeoutFn=VP.bind(HP)):(e.setTimeoutFn=HP.setTimeout.bind(HP),e.clearTimeoutFn=HP.clearTimeout.bind(HP))}function qP(e){return qP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qP(e)}function XP(){return XP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iR(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},XP.apply(this,arguments)}function YP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,JP(r.key),r)}}function KP(e,t,n){return t&&YP(e.prototype,t),n&&YP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JP(e){var t=function(e,t){if("object"!=qP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=qP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qP(t)?t:String(t)}function ZP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QP(e,t,n){return t=iR(t),function(e,t){if(t&&("object"===qP(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $P(e)}(e,nR()?Reflect.construct(t,n||[],iR(e).constructor):t.apply(e,n))}function $P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eR(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function tR(e){var t="function"==typeof Map?new Map:void 0;return tR=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(nR())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&rR(i,n.prototype),i}(e,arguments,iR(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),rR(n,e)},tR(e)}function nR(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(nR=function(){return!!e})()}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rR(e,t)}function iR(e){return iR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},iR(e)}var aR,oR=function(e){function t(e,n,r){var i;return ZP(this,t),(i=QP(this,t,[e])).description=n,i.context=r,i.type="TransportError",i}return eR(t,e),KP(t)}(tR(Error)),sR=function(e){function t(e){var n;return ZP(this,t),(n=QP(this,t)).writable=!1,WP($P(n),e),n.opts=e,n.query=e.query,n.socket=e.socket,n}return eR(t,e),KP(t,[{key:"onError",value:function(e,n,r){return XP(iR(t.prototype),"emitReserved",this).call(this,"error",new oR(e,n,r)),this}},{key:"open",value:function(){return this.readyState="opening",this.doOpen(),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,XP(iR(t.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(e){var t=OP(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){XP(iR(t.prototype),"emitReserved",this).call(this,"packet",e)}},{key:"onClose",value:function(e){this.readyState="closed",XP(iR(t.prototype),"emitReserved",this).call(this,"close",e)}},{key:"pause",value:function(e){}},{key:"createUri",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}},{key:"_hostname",value:function(){var e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}},{key:"_port",value:function(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}},{key:"_query",value:function(e){var t=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}]),t}(FP),lR="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),uR=64,cR={},hR=0,dR=0;function fR(e){var t="";do{t=lR[e%uR]+t,e=Math.floor(e/uR)}while(e>0);return t}function pR(){var e=fR(+new Date);return e!==aR?(hR=0,aR=e):e+"."+fR(hR++)}for(;dR<uR;dR++)cR[lR[dR]]=dR;var mR=!1;try{mR="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}var vR=mR;function gR(e){var t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||vR))return new XMLHttpRequest}catch(e){}if(!t)try{return new(HP[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function yR(e){return yR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yR(e)}function bR(){return bR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bR.apply(this,arguments)}function xR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ER(r.key),r)}}function _R(e,t,n){return t&&wR(e.prototype,t),n&&wR(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ER(e){var t=function(e,t){if("object"!=yR(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=yR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yR(t)?t:String(t)}function TR(e,t,n){return t=AR(t),function(e,t){if(t&&("object"===yR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return SR(e)}(e,MR()?Reflect.construct(t,n||[],AR(e).constructor):t.apply(e,n))}function SR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MR(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(MR=function(){return!!e})()}function AR(e){return AR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},AR(e)}function kR(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PR(e,t)}function PR(e,t){return PR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},PR(e,t)}function RR(){}var CR=null!=new gR({xdomain:!1}).responseType,LR=function(e){function t(e){var n;if(xR(this,t),(n=TR(this,t,[e])).polling=!1,"undefined"!=typeof location){var r="https:"===location.protocol,i=location.port;i||(i=r?"443":"80"),n.xd="undefined"!=typeof location&&e.hostname!==location.hostname||i!==e.port}var a=e&&e.forceBase64;return n.supportsBinary=CR&&!a,n.opts.withCredentials&&(n.cookieJar=void 0),n}return kR(t,e),_R(t,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var n=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var r=0;this.polling&&(r++,this.once("pollComplete",(function(){--r||n()}))),this.writable||(r++,this.once("drain",(function(){--r||n()})))}else n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var n=e.split(BP),r=[],i=0;i<n.length;i++){var a=OP(n[i],t);if(r.push(a),"error"===a.type)break}return r})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,n){var r=e.length,i=new Array(r),a=0;e.forEach((function(e,n){AP(e,!1,(function(e){var o;i[n]=e,++a===r&&(o=i.join(BP),t.doWrite(o,(function(){t.writable=!0,t.emitReserved("drain")})))}))}))}(e)}},{key:"uri",value:function(){var e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=pR()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return bR(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new IR(this.uri(),e)}},{key:"doWrite",value:function(e,t){var n=this,r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(function(e,t){n.onError("xhr post error",e,t)}))}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t,n){e.onError("xhr poll error",t,n)})),this.pollXhr=t}}]),t}(sR),IR=function(e){function t(e,n){var r;return xR(this,t),WP(SR(r=TR(this,t)),n),r.opts=n,r.method=n.method||"GET",r.uri=e,r.data=void 0!==n.data?n.data:null,r.create(),r}return kR(t,e),_R(t,[{key:"create",value:function(){var e,n=this,r=jP(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;var i=this.xhr=new gR(r);try{i.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders)for(var a in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(a)&&i.setRequestHeader(a,this.opts.extraHeaders[a])}catch(e){}if("POST"===this.method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{i.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=function(){var e;3===i.readyState&&(null===(e=n.opts.cookieJar)||void 0===e||e.parseCookies(i)),4===i.readyState&&(200===i.status||1223===i.status?n.onLoad():n.setTimeoutFn((function(){n.onError("number"==typeof i.status?i.status:0)}),0))},i.send(this.data)}catch(e){return void this.setTimeoutFn((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=t.requestsCount++,t.requests[this.index]=this)}},{key:"onError",value:function(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}},{key:"cleanup",value:function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=RR,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete t.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}},{key:"abort",value:function(){this.cleanup()}}]),t}(FP);function OR(){for(var e in IR.requests)IR.requests.hasOwnProperty(e)&&IR.requests[e].abort()}IR.requestsCount=0,IR.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",OR):"function"==typeof addEventListener&&addEventListener("onpagehide"in HP?"pagehide":"unload",OR,!1));var DR="function"==typeof Promise&&"function"==typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},NR=HP.WebSocket||HP.MozWebSocket;function BR(e){return BR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BR(e)}function UR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zR(r.key),r)}}function zR(e){var t=function(e,t){if("object"!=BR(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=BR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==BR(t)?t:String(t)}function FR(e,t,n){return t=jR(t),function(e,t){if(t&&("object"===BR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,HR()?Reflect.construct(t,n||[],jR(e).constructor):t.apply(e,n))}function HR(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(HR=function(){return!!e})()}function jR(e){return jR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jR(e)}function GR(e,t){return GR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},GR(e,t)}n(1880).Sn;var VR="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),WR=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=FR(this,t,[e])).supportsBinary=!e.forceBase64,n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GR(e,t)}(t,e),n=t,r=[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=VR?{}:jP(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=VR?new NR(e,t,n):t?new NR(e,t):new NR(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=function(t){return e.onClose({description:"websocket connection closed",context:t})},this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var n=function(){var n=e[r],i=r===e.length-1;AP(n,t.supportsBinary,(function(e){try{t.ws.send(e)}catch(e){}i&&DR((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},r=0;r<e.length;r++)n()}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=pR()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}},{key:"check",value:function(){return!!NR}}],r&&UR(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(sR);function qR(e){return qR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qR(e)}function XR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,YR(r.key),r)}}function YR(e){var t=function(e,t){if("object"!=qR(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=qR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qR(t)?t:String(t)}function KR(e,t,n){return t=ZR(t),function(e,t){if(t&&("object"===qR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,JR()?Reflect.construct(t,n||[],ZR(e).constructor):t.apply(e,n))}function JR(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(JR=function(){return!!e})()}function ZR(e){return ZR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ZR(e)}function QR(e,t){return QR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},QR(e,t)}var $R=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),KR(this,t,arguments)}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QR(e,t)}(t,e),n=t,r=[{key:"name",get:function(){return"webtransport"}},{key:"doOpen",value:function(){var e=this;"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((function(){e.onClose()})).catch((function(t){e.onError("webtransport error",t)})),this.transport.ready.then((function(){e.transport.createBidirectionalStream().then((function(t){var n=function(e,t){LP||(LP=new TextDecoder);var n=[],r=0,i=-1,a=!1;return new TransformStream({transform:function(o,s){for(n.push(o);;){if(0===r){if(UP(n)<1)break;var l=zP(n,1);a=128==(128&l[0]),i=127&l[0],r=i<126?3:126===i?1:2}else if(1===r){if(UP(n)<2)break;var u=zP(n,2);i=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(2===r){if(UP(n)<8)break;var c=zP(n,8),h=new DataView(c.buffer,c.byteOffset,c.length),d=h.getUint32(0);if(d>Math.pow(2,21)-1){s.enqueue(EP);break}i=d*Math.pow(2,32)+h.getUint32(4),r=3}else{if(UP(n)<i)break;var f=zP(n,i);s.enqueue(OP(a?f:LP.decode(f),t)),r=0}if(0===i||i>e){s.enqueue(EP);break}}}})}(Number.MAX_SAFE_INTEGER,e.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),i=new TransformStream({transform:function(e,t){!function(e,t){TP&&e.data instanceof Blob?e.data.arrayBuffer().then(PP).then(t):SP&&(e.data instanceof ArrayBuffer||MP(e.data))?t(PP(e.data)):AP(e,!1,(function(e){_P||(_P=new TextEncoder),t(_P.encode(e))}))}(e,(function(n){var r,i=n.length;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);var a=new DataView(r.buffer);a.setUint8(0,126),a.setUint16(1,i)}else{r=new Uint8Array(9);var o=new DataView(r.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(i))}e.data&&"string"!=typeof e.data&&(r[0]|=128),t.enqueue(r),t.enqueue(n)}))}});i.readable.pipeTo(t.writable),e.writer=i.writable.getWriter(),function t(){r.read().then((function(n){var r=n.done,i=n.value;r||(e.onPacket(i),t())})).catch((function(e){}))}();var a={type:"open"};e.query.sid&&(a.data='{"sid":"'.concat(e.query.sid,'"}')),e.writer.write(a).then((function(){return e.onOpen()}))}))})))}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var n=function(){var n=e[r],i=r===e.length-1;t.writer.write(n).then((function(){i&&DR((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},r=0;r<e.length;r++)n()}},{key:"doClose",value:function(){var e;null===(e=this.transport)||void 0===e||e.close()}}],r&&XR(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(sR),eC={websocket:WR,webtransport:$R,polling:LR},tC=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,nC=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function rC(e){if(e.length>2e3)throw"URI too long";var t,n,r,i,a=e,o=e.indexOf("["),s=e.indexOf("]");-1!=o&&-1!=s&&(e=e.substring(0,o)+e.substring(o,s).replace(/:/g,";")+e.substring(s,e.length));for(var l=tC.exec(e||""),u={},c=14;c--;)u[nC[c]]=l[c]||"";return-1!=o&&-1!=s&&(u.source=a,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=(r=u.path,i=r.replace(/\/{2,9}/g,"/").split("/"),"/"!=r.slice(0,1)&&0!==r.length||i.splice(0,1),"/"==r.slice(-1)&&i.splice(i.length-1,1),i),u.queryKey=(t=u.query,n={},t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n),u}function iC(){return iC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iC.apply(this,arguments)}function aC(e){return aC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aC(e)}function oC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,sC(r.key),r)}}function sC(e){var t=function(e,t){if("object"!=aC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=aC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==aC(t)?t:String(t)}function lC(e,t,n){return t=cC(t),function(e,t){if(t&&("object"===aC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hC(e)}(e,uC()?Reflect.construct(t,n||[],cC(e).constructor):t.apply(e,n))}function uC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uC=function(){return!!e})()}function cC(e){return cC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cC(e)}function hC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dC(e,t){return dC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dC(e,t)}var fC=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=lC(this,t)).binaryType="arraybuffer",n.writeBuffer=[],e&&"object"===aC(e)&&(r=e,e=null),e?(e=rC(e),r.hostname=e.host,r.secure="https"===e.protocol||"wss"===e.protocol,r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=rC(r.host).host),WP(hC(n),r),n.secure=null!=r.secure?r.secure:"undefined"!=typeof location&&"https:"===location.protocol,r.hostname&&!r.port&&(r.port=n.secure?"443":"80"),n.hostname=r.hostname||("undefined"!=typeof location?location.hostname:"localhost"),n.port=r.port||("undefined"!=typeof location&&location.port?location.port:n.secure?"443":"80"),n.transports=r.transports||["polling","websocket","webtransport"],n.writeBuffer=[],n.prevBufferLen=0,n.opts=iC({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),n.opts.path=n.opts.path.replace(/\/$/,"")+(n.opts.addTrailingSlash?"/":""),"string"==typeof n.opts.query&&(n.opts.query=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}(n.opts.query)),n.id=null,n.upgrades=null,n.pingInterval=null,n.pingTimeout=null,n.pingTimeoutTimer=null,"function"==typeof addEventListener&&(n.opts.closeOnBeforeunload&&(n.beforeunloadEventListener=function(){n.transport&&(n.transport.removeAllListeners(),n.transport.close())},addEventListener("beforeunload",n.beforeunloadEventListener,!1)),"localhost"!==n.hostname&&(n.offlineEventListener=function(){n.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",n.offlineEventListener,!1))),n.open(),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dC(e,t)}(t,e),n=t,r=[{key:"createTransport",value:function(e){var t=iC({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var n=iC({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new eC[e](n)}},{key:"open",value:function(){var e,n=this;if(this.opts.rememberUpgrade&&t.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((function(){n.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(function(e){return t.onClose("transport close",e)}))}},{key:"probe",value:function(e){var n=this,r=this.createTransport(e),i=!1;t.priorWebsocketSuccess=!1;var a=function(){i||(r.send([{type:"ping",data:"probe"}]),r.once("packet",(function(e){if(!i)if("pong"===e.type&&"probe"===e.data){if(n.upgrading=!0,n.emitReserved("upgrading",r),!r)return;t.priorWebsocketSuccess="websocket"===r.name,n.transport.pause((function(){i||"closed"!==n.readyState&&(h(),n.setTransport(r),r.send([{type:"upgrade"}]),n.emitReserved("upgrade",r),r=null,n.upgrading=!1,n.flush())}))}else{var a=new Error("probe error");a.transport=r.name,n.emitReserved("upgradeError",a)}})))};function o(){i||(i=!0,h(),r.close(),r=null)}var s=function(e){var t=new Error("probe error: "+e);t.transport=r.name,o(),n.emitReserved("upgradeError",t)};function l(){s("transport closed")}function u(){s("socket closed")}function c(e){r&&e.name!==r.name&&o()}var h=function(){r.removeListener("open",a),r.removeListener("error",s),r.removeListener("close",l),n.off("close",u),n.off("upgrading",c)};r.once("open",a),r.once("error",s),r.once("close",l),this.once("close",u),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((function(){i||r.open()}),200):r.open()}},{key:"onOpen",value:function(){if(this.readyState="open",t.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade)for(var e=0,n=this.upgrades.length;e<n;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((function(){e.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}},{key:"getWritablePackets",value:function(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,n=0;n<this.writeBuffer.length;n++){var r=this.writeBuffer[n].data;if(r&&(t+="string"==typeof(e=r)?function(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}},{key:"write",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"send",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"sendPacket",value:function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},n=function n(){e.off("upgrade",n),e.off("upgradeError",n),t()},r=function(){e.once("upgrade",n),e.once("upgradeError",n)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?r():t()})):this.upgrading?r():t()),this}},{key:"onError",value:function(e){t.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}],r&&oC(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(FP);function pC(e){return pC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pC(e)}fC.protocol=4,fC.protocol;var mC="function"==typeof ArrayBuffer,vC=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer},gC=Object.prototype.toString,yC="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===gC.call(Blob),bC="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===gC.call(File);function xC(e){return mC&&(e instanceof ArrayBuffer||vC(e))||yC&&e instanceof Blob||bC&&e instanceof File}function wC(e,t){if(!e||"object"!==pC(e))return!1;if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(wC(e[n]))return!0;return!1}if(xC(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return wC(e.toJSON(),!0);for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&wC(e[i]))return!0;return!1}function _C(e){return _C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_C(e)}function EC(e){var t=[],n=e.data,r=e;return r.data=TC(n,t),r.attachments=t.length,{packet:r,buffers:t}}function TC(e,t){if(!e)return e;if(xC(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){for(var r=new Array(e.length),i=0;i<e.length;i++)r[i]=TC(e[i],t);return r}if("object"===_C(e)&&!(e instanceof Date)){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(a[o]=TC(e[o],t));return a}return e}function SC(e,t){return e.data=MC(e.data,t),delete e.attachments,e}function MC(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=MC(e[n],t);else if("object"===_C(e))for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=MC(e[r],t));return e}function AC(e){return AC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AC(e)}function kC(e,t,n){return t=CC(t),function(e,t){if(t&&("object"===AC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,PC()?Reflect.construct(t,n||[],CC(e).constructor):t.apply(e,n))}function PC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(PC=function(){return!!e})()}function RC(){return RC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CC(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},RC.apply(this,arguments)}function CC(e){return CC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},CC(e)}function LC(e,t){return LC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},LC(e,t)}function IC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,NC(r.key),r)}}function DC(e,t,n){return t&&OC(e.prototype,t),n&&OC(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function NC(e){var t=function(e,t){if("object"!=AC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=AC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==AC(t)?t:String(t)}var BC,UC=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],zC=5;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(BC||(BC={}));var FC=function(){function e(t){IC(this,e),this.replacer=t}return DC(e,[{key:"encode",value:function(e){return e.type!==BC.EVENT&&e.type!==BC.ACK||!wC(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===BC.EVENT?BC.BINARY_EVENT:BC.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==BC.BINARY_EVENT&&e.type!==BC.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}},{key:"encodeAsBinary",value:function(e){var t=EC(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}]),e}();function HC(e){return"[object Object]"===Object.prototype.toString.call(e)}var jC=function(e){function t(e){var n;return IC(this,t),(n=kC(this,t)).reviver=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LC(e,t)}(t,e),DC(t,[{key:"add",value:function(e){var n;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var r=(n=this.decodeString(e)).type===BC.BINARY_EVENT;r||n.type===BC.BINARY_ACK?(n.type=r?BC.EVENT:BC.ACK,this.reconstructor=new GC(n),0===n.attachments&&RC(CC(t.prototype),"emitReserved",this).call(this,"decoded",n)):RC(CC(t.prototype),"emitReserved",this).call(this,"decoded",n)}else{if(!xC(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,RC(CC(t.prototype),"emitReserved",this).call(this,"decoded",n))}}},{key:"decodeString",value:function(e){var n=0,r={type:Number(e.charAt(0))};if(void 0===BC[r.type])throw new Error("unknown packet type "+r.type);if(r.type===BC.BINARY_EVENT||r.type===BC.BINARY_ACK){for(var i=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var a=e.substring(i,n);if(a!=Number(a)||"-"!==e.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(a)}if("/"===e.charAt(n+1)){for(var o=n+1;++n&&","!==e.charAt(n)&&n!==e.length;);r.nsp=e.substring(o,n)}else r.nsp="/";var s=e.charAt(n+1);if(""!==s&&Number(s)==s){for(var l=n+1;++n;){var u=e.charAt(n);if(null==u||Number(u)!=u){--n;break}if(n===e.length)break}r.id=Number(e.substring(l,n+1))}if(e.charAt(++n)){var c=this.tryParse(e.substr(n));if(!t.isPayloadValid(r.type,c))throw new Error("invalid payload");r.data=c}return r}},{key:"tryParse",value:function(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}},{key:"destroy",value:function(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case BC.CONNECT:return HC(t);case BC.DISCONNECT:return void 0===t;case BC.CONNECT_ERROR:return"string"==typeof t||HC(t);case BC.EVENT:case BC.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===UC.indexOf(t[0]));case BC.ACK:case BC.BINARY_ACK:return Array.isArray(t)}}}]),t}(FP),GC=function(){function e(t){IC(this,e),this.packet=t,this.buffers=[],this.reconPack=t}return DC(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=SC(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}();function VC(e,t,n){return e.on(t,n),function(){e.off(t,n)}}function WC(e){return WC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WC(e)}function qC(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return XC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?XC(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function XC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function YC(){return YC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YC.apply(this,arguments)}function KC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,JC(r.key),r)}}function JC(e){var t=function(e,t){if("object"!=WC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=WC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==WC(t)?t:String(t)}function ZC(e,t,n){return t=eL(t),function(e,t){if(t&&("object"===WC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,QC()?Reflect.construct(t,n||[],eL(e).constructor):t.apply(e,n))}function QC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(QC=function(){return!!e})()}function $C(){return $C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eL(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},$C.apply(this,arguments)}function eL(e){return eL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eL(e)}function tL(e,t){return tL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tL(e,t)}var nL=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),rL=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ZC(this,t)).connected=!1,i.recovered=!1,i.receiveBuffer=[],i.sendBuffer=[],i._queue=[],i._queueSeq=0,i.ids=0,i.acks={},i.flags={},i.io=e,i.nsp=n,r&&r.auth&&(i.auth=r.auth),i._opts=YC({},r),i.io._autoConnect&&i.open(),i}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tL(e,t)}(t,e),n=t,r=[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[VC(e,"open",this.onopen.bind(this)),VC(e,"packet",this.onpacket.bind(this)),VC(e,"error",this.onerror.bind(this)),VC(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(nL.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;var i={type:BC.EVENT,data:n,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]){var a=this.ids++,o=n.pop();this._registerAckCallback(a,o),i.id=a}var s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var n,r=this,i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0!==i){var a=this.io.setTimeoutFn((function(){delete r.acks[e];for(var n=0;n<r.sendBuffer.length;n++)r.sendBuffer[n].id===e&&r.sendBuffer.splice(n,1);t.call(r,new Error("operation has timed out"))}),i);this.acks[e]=function(){r.io.clearTimeoutFn(a);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.apply(r,[null].concat(n))}}else this.acks[e]=t}},{key:"emitWithAck",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((function(n,i){r.push((function(e,t){return a?e?i(e):n(t):n(e)})),t.emit.apply(t,[e].concat(r))}))}},{key:"_addToQueue",value:function(e){var t,n=this;"function"==typeof e[e.length-1]&&(t=e.pop());var r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:YC({fromQueue:!0},this.flags)};e.push((function(e){if(r===n._queue[0]){if(null!==e)r.tryCount>n._opts.retries&&(n._queue.shift(),t&&t(e));else if(n._queue.shift(),t){for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];t.apply(void 0,[null].concat(a))}return r.pending=!1,n._drainQueue()}})),this._queue.push(r),this._drainQueue()}},{key:"_drainQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.connected&&0!==this._queue.length){var t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e._sendConnectPacket(t)})):this._sendConnectPacket(this.auth)}},{key:"_sendConnectPacket",value:function(e){this.packet({type:BC.CONNECT,data:this._pid?YC({pid:this._pid,offset:this._lastOffset},e):e})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case BC.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case BC.EVENT:case BC.BINARY_EVENT:this.onevent(e);break;case BC.ACK:case BC.BINARY_ACK:this.onack(e);break;case BC.DISCONNECT:this.ondisconnect();break;case BC.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var n,r=qC(this._anyListeners.slice());try{for(r.s();!(n=r.n()).done;)n.value.apply(this,e)}catch(e){r.e(e)}finally{r.f()}}$C(eL(t.prototype),"emit",this).apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}},{key:"ack",value:function(e){var t=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t.packet({type:BC.ACK,id:e,data:i})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){e.notifyOutgoingListeners(t),e.packet(t)})),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:BC.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}},{key:"prependAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}},{key:"offAnyOutgoing",value:function(e){if(!this._anyOutgoingListeners)return this;if(e){for(var t=this._anyOutgoingListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var t,n=qC(this._anyOutgoingListeners.slice());try{for(n.s();!(t=n.n()).done;)t.value.apply(this,e.data)}catch(e){n.e(e)}finally{n.f()}}}}],r&&KC(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(FP);function iL(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}function aL(e){return aL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aL(e)}function oL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,sL(r.key),r)}}function sL(e){var t=function(e,t){if("object"!=aL(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=aL(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==aL(t)?t:String(t)}function lL(e,t,n){return t=cL(t),function(e,t){if(t&&("object"===aL(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hL(e)}(e,uL()?Reflect.construct(t,n||[],cL(e).constructor):t.apply(e,n))}function uL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uL=function(){return!!e})()}function cL(e){return cL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cL(e)}function hL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dL(e,t){return dL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dL(e,t)}iL.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},iL.prototype.reset=function(){this.attempts=0},iL.prototype.setMin=function(e){this.ms=e},iL.prototype.setMax=function(e){this.max=e},iL.prototype.setJitter=function(e){this.jitter=e};var fL=function(e){function n(e,r){var i,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(i=lL(this,n)).nsps={},i.subs=[],e&&"object"===aL(e)&&(r=e,e=void 0),(r=r||{}).path=r.path||"/socket.io",i.opts=r,WP(hL(i),r),i.reconnection(!1!==r.reconnection),i.reconnectionAttempts(r.reconnectionAttempts||1/0),i.reconnectionDelay(r.reconnectionDelay||1e3),i.reconnectionDelayMax(r.reconnectionDelayMax||5e3),i.randomizationFactor(null!==(a=r.randomizationFactor)&&void 0!==a?a:.5),i.backoff=new iL({min:i.reconnectionDelay(),max:i.reconnectionDelayMax(),jitter:i.randomizationFactor()}),i.timeout(null==r.timeout?2e4:r.timeout),i._readyState="closed",i.uri=e;var o=r.parser||t;return i.encoder=new o.Encoder,i.decoder=new o.Decoder,i._autoConnect=!1!==r.autoConnect,i._autoConnect&&i.open(),i}var r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dL(e,t)}(n,e),r=n,i=[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new fC(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var i=VC(n,"open",(function(){r.onopen(),e&&e()})),a=function(n){t.cleanup(),t._readyState="closed",t.emitReserved("error",n),e?e(n):t.maybeReconnectOnOpen()},o=VC(n,"error",a);if(!1!==this._timeout){var s=this._timeout,l=this.setTimeoutFn((function(){i(),a(new Error("timeout")),n.close()}),s);this.opts.autoUnref&&l.unref(),this.subs.push((function(){t.clearTimeoutFn(l)}))}return this.subs.push(i),this.subs.push(o),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(VC(e,"ping",this.onping.bind(this)),VC(e,"data",this.ondata.bind(this)),VC(e,"error",this.onerror.bind(this)),VC(e,"close",this.onclose.bind(this)),VC(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}},{key:"ondecoded",value:function(e){var t=this;DR((function(){t.emitReserved("packet",e)}),this.setTimeoutFn)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new rL(this,e,t),this.nsps[e]=n),n}},{key:"_destroy",value:function(e){for(var t=0,n=Object.keys(this.nsps);t<n.length;t++){var r=n[t];if(this.nsps[r].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),n=0;n<t.length;n++)this.engine.write(t[n],e.options)}},{key:"cleanup",value:function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(n){n?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",n)):t.onreconnect()})))}),n);this.opts.autoUnref&&r.unref(),this.subs.push((function(){e.clearTimeoutFn(r)}))}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}],i&&oL(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),n}(FP);function pL(){return pL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pL.apply(this,arguments)}function mL(e){return mL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mL(e)}var vL,gL={};function yL(e,t){"object"===mL(e)&&(t=e,e=void 0);var n,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=rC(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),i=r.source,a=r.id,o=r.path,s=gL[a]&&o in gL[a].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?n=new fL(i,t):(gL[a]||(gL[a]=new fL(i,t)),n=gL[a]),r.query&&!t.query&&(t.query=r.queryKey),n.socket(r.path,t)}pL(yL,{Manager:fL,Socket:rL,io:yL,connect:yL}),"undefined"!=typeof OffscreenCanvas?(vL=new Worker(new URL(n.p+n.u(100),n.b))).onmessage=function(e){return _L(e.data)}:setTimeout((function(){console.log("This browser does not support offscreen canvas.")}),250);var bL,xL,wL,_L=function(e){var t=new Qf(e.imagedata,e.side,e.side);t.colorSpace=fo,t.needsUpdate=!0,t.flipY=!0;var n=new Ef({map:t}),r=new Nf(n);r.scale.set(1,1,1),r.position.set(1,1,-12);try{EL[e.id].sprite=r,rG.add(r)}catch(e){}},EL={},TL=0,SL=function(e){EL.hasOwnProperty(e)&&EL[e].hasOwnProperty("sprite")&&(rG.remove(EL[e].sprite),delete EL[e])},ML=performance.now(),AL=n(5280),kL=function(e){return AL.toDataURL(e).then((function(e){var t=new Image(200);t.src=e;var n=document.createElement("div");n.style="display:flex;\n        z-index:200;\n        background:rgba(20,20,20,0.9);\n        position:absolute;\n        width:100%;\n        height:100%;\n        align-items: center;\n        justify-content: center;\n        cursor:pointer;",n.append(t),document.body.append(n),n.addEventListener("click",(function(){return n.remove()}))})).catch((function(e){console.error(e)}))};function PL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var RL=document.createElement("div");RL.className="artistList";var CL={},LL=[],IL=function(e,t,n){document.getElementById("videoGuide")&&document.getElementById("videoGuide").remove();var r=document.createElement("div");r.id="videoGuide",r.style="z-index:49;\n  position:absolute;\n    left:75%;\n    top:0px;\n  ",pj&&(r.style.left="calc( 75% - 70px )");var i=document.createElement("video");i.id="vidsem",i.controls=!0,t&&(i.poster=t);var a=document.createElement("source"),o=document.createElement("button");o.innerText="x",o.className="vidbuttons",o.style="width: 20px",o.addEventListener("click",(function(){i.remove(),a.src=null,r.remove(),h.innerHTML="",h.style.display="none"})),i.width=.25*window.innerWidth,i.addEventListener("leavepictureinpicture",(function(){return r.style.opacity=1}));var s=document.createElement("div");s.style="display: flex;justify-content: space-around;";var l=document.createElement("div");l.style.display="none";var u=document.createElement("button");u.innerText="Subtitles",u.className="vidbuttons",u.disabled=!0,u.addEventListener("click",(function(){"none"===l.style.display?l.style.display="block":l.style.display="none"}));var c=document.createElement("button");c.innerText="Float video",c.className="vidbuttons",c.addEventListener("click",(function(){return e=i,void(document.pictureInPictureElement?(document.exitPictureInPicture(),e.parentElement.style.opacity=1):document.pictureInPictureEnabled&&e.requestPictureInPicture().then((function(t){return e.parentElement.style.opacity=0})));var e})),c.disabled=!0,s.append(u,c,o),i.preload="none",i.setAttribute("crossorigin","anonymous"),i.addEventListener("loadeddata",(function(){i.readyState>=1&&(c.disabled=!1)})),a.src=e,a.type="video/mp4",i.append(a);var h=document.getElementById("subtitles");CL[n].hasOwnProperty("subtitles")&&(u.disabled=!1,CL[n].subtitles.forEach((function(e){var t=document.createElement("div");t.className="tracksSubsSelects",t.innerText=e.lang+" - "+e.author.substring(0,8)+"",l.append(t),t.setAttribute("data-state","inactive");var n=document.createElement("track"),r=e.lang+" - "+e.author;n.srclang=e.lang,n.src=e.src,n.kind="subtitles",n.label=r,n.id=r,i.append(n);var a=i.textTracks.getTrackById(r);t.addEventListener("click",(function(){t.style.color="black",a.mode="showing",t.setAttribute("data-state","active")})),a.addEventListener("cuechange",(function(e){a.mode="hidden",h.style.display="block";try{var t=a.activeCues[0].getCueAsHTML();h.innerText=t.textContent}catch(e){}}))}))),r.append(i,s,l),document.body.append(r)},OL=[{room:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"541886",name:"photoshare's ",blockchain:"tezos"},skybox:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"534491",name:"sand",blockchain:"tezos"},gallery:[{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[5,.5,10]},tokenType:"block"},position:{x:"-51.0000",y:"12.8000",z:"-41.0300"},rotation:{x:"-0.0016",y:"-0.0016",z:"-0.0016"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[5,.5,40]},tokenType:"block"},position:{x:"-55.3426",y:"12.8430",z:"41.0614"},rotation:{x:"-3.1392",y:"0.0356",z:"3.1399"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"22"},position:{x:"-51.2692",y:"15.5973",z:"-90.1959"},rotation:{x:"0.0232",y:"-0.0264",z:"0.0006"},scale:{x:"1.3200",y:"1.3200",z:"1.3200"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"0"},position:{x:"-60.0426",y:"16.9616",z:"-70.0891"},rotation:{x:"-1.1677",y:"1.5482",z:"1.1676"},scale:{x:"3.0000",y:"3.0000",z:"3.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"2"},position:{x:"-54.0395",y:"15.7283",z:"-41.9131"},rotation:{x:"-2.3268",y:"1.5395",z:"2.3271"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"3"},position:{x:"-60.8881",y:"17.4502",z:"-23.3394"},rotation:{x:"2.3829",y:"1.5109",z:"-2.3838"},scale:{x:"2.1300",y:"2.1300",z:"2.1300"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"4"},position:{x:"-46.1868",y:"17.5041",z:"-22.8358"},rotation:{x:"1.9466",y:"-1.4727",z:"1.9482"},scale:{x:"2.5000",y:"2.5000",z:"2.5000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"5"},position:{x:"-48.4700",y:"15.5300",z:"27.3432"},rotation:{x:"3.1384",y:"-0.0107",z:"3.1416"},scale:{x:"1.4800",y:"1.4800",z:"1.4800"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"10"},position:{x:"-57.0036",y:"17.2916",z:"59.9473"},rotation:{x:"3.1244",y:"0.0225",z:"-3.1412"},scale:{x:"2.4500",y:"2.4500",z:"2.4500"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"7"},position:{x:"-54.0000",y:"17.2000",z:"-7.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"8"},position:{x:"-59.8154",y:"17.0002",z:"20.0091"},rotation:{x:"1.9352",y:"1.5138",z:"-1.9358"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"15"},position:{x:"-90.4422",y:"16.5775",z:"61.2112"},rotation:{x:"2.5034",y:"1.5117",z:"-2.5043"},scale:{x:"1.7500",y:"1.7500",z:"1.7500"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"20"},position:{x:"-81.2600",y:"17.3300",z:"84.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"2.5000",y:"2.5000",z:"2.5000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"44"},position:{x:"-53.5800",y:"17.5800",z:"69.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"2.7200",y:"2.7200",z:"2.7200"}},{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[5,.5,50]},tokenType:"block"},position:{x:"-25.8426",y:"3.5316",z:"84.8616"},rotation:{x:"1.5654",y:"1.1376",z:"-1.5648"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[5,.5,5]},tokenType:"block"},position:{x:"-50.8994",y:"13.4547",z:"84.8936"},rotation:{x:"1.4337",y:"-1.3471",z:"1.4302"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1ABUhpy4eBgyjBYMWHtjDiaAeomvQo3tpw",token_id:"42"},position:{x:"-48.2584",y:"23.8603",z:"84.9969"},rotation:{x:"1.5681",y:"0.0872",z:"-1.5601"},scale:{x:"2.3500",y:"2.3500",z:"2.3500"}}],startPoint:{position:{x:-54.32798068250951,y:15.02482335473547,z:14.576811628669887},direction:{x:-.04582890888266345,y:-.018795194213121636,z:-.9987724724806524}}},{room:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1185554",name:"vicdoval's tracing of \"aracanum's dark purgatory\"",blockchain:"tezos"},skybox:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1407613",name:"0x_wes's ",blockchain:"tezos"},gallery:[{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[50,50,.2]},tokenType:"block"},position:{x:"-1.0000",y:"0.0000",z:"-26.5000"},rotation:{x:"-1.5692",y:"0.0016",z:"3.1400"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1FUP27Pi4Tq2dQnLhhw34WoVgY4ciBecgu",token_id:"1"},position:{x:"-13.0182",y:"2.0428",z:"-4.9754"},rotation:{x:"1.7976",y:"1.4608",z:"-1.7989"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"18660"},position:{x:"-13.1415",y:"1.9127",z:"-14.8769"},rotation:{x:"-1.1976",y:"1.4475",z:"1.1950"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"18771"},position:{x:"-16.6900",y:"1.6100",z:"-14.9400"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"19425"},position:{x:"-9.9790",y:"2.3841",z:"-29.3355"},rotation:{x:"-0.0268",y:"-0.0464",z:"-0.0012"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"193039"},position:{x:"13.1610",y:"2.5760",z:"-15.0174"},rotation:{x:"-2.1801",y:"-1.4649",z:"-2.1827"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"135279"},position:{x:"-14.9870",y:"2.3846",z:"-36.9852"},rotation:{x:"-3.1128",y:"0.0291",z:"3.1408"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"116056"},position:{x:"21.0639",y:"1.6166",z:"-2.0168"},rotation:{x:"3.1124",y:"-0.0160",z:"3.1411"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"125820"},position:{x:"0.1517",y:"4.8639",z:"-97.8572"},rotation:{x:"0.1052",y:"0.0155",z:"-0.0016"},scale:{x:"2.6300",y:"2.6300",z:"2.6300"}},{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[20,20,.2]},tokenType:"block"},position:{x:"-0.0235",y:"0.0834",z:"-58.3603"},rotation:{x:"-1.57",y:"0.0053",z:"3.14"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"523160"},position:{x:"15.0698",y:"5.1473",z:"-77.9548"},rotation:{x:"1.6683",y:"-1.5053",z:"1.6685"},scale:{x:"2.9600",y:"2.9600",z:"2.9600"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"169351"},position:{x:"-17.8948",y:"4.7000",z:"-70.7821"},rotation:{x:"2.0613",y:"1.5241",z:"-2.0618"},scale:{x:"2.9100",y:"2.9100",z:"2.9100"}}],name:"Kidmograph's art",timeId:"2024-01-03T11:28:31.547Z"},{room:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"424636",name:"ruined naos of overlooked grandeur",blockchain:"tezos"},skybox:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1328220",name:"anaglyphic's ",blockchain:"tezos"},gallery:[{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[100,2,100]},tokenType:"block"},position:{x:"-8.0000",y:"-2.0700",z:"-9.0000"},rotation:{x:"-0.7854",y:"1.5685",z:"0.7838"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"24"},position:{x:"-33.1006",y:"1.8933",z:"5.6892"},rotation:{x:"-0.8817",y:"1.5205",z:"0.8811"},scale:{x:"1.4400",y:"1.4400",z:"1.4400"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"6"},position:{x:"-22.1612",y:"1.9241",z:"16.7909"},rotation:{x:"3.0903",y:"-0.0532",z:"3.1389"},scale:{x:"1.6400",y:"1.6400",z:"1.6400"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"18"},position:{x:"4.6949",y:"1.7881",z:"13.8632"},rotation:{x:"-1.0402",y:"-1.5305",z:"-1.0398"},scale:{x:"1.4400",y:"1.4400",z:"1.4400"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"0"},position:{x:"5.2300",y:"1.7900",z:"-10.2200"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"1.5300",y:"1.5300",z:"1.5300"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"1"},position:{x:"-33.4551",y:"1.3886",z:"-25.8804"},rotation:{x:"-2.9647",y:"1.5435",z:"2.9648"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"3"},position:{x:"-16.9064",y:"4.6464",z:"-38.7895"},rotation:{x:"0.0513",y:"0.0456",z:"-0.0023"},scale:{x:"3.2600",y:"3.2600",z:"3.2600"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"4"},position:{x:"-23.0000",y:"1.3000",z:"-17.6700"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"11"},position:{x:"-7.4378",y:"1.0386",z:"-17.9252"},rotation:{x:"2.3319",y:"-1.5470",z:"2.3320"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"17"},position:{x:"-10.9615",y:"1.2155",z:"-6.3817"},rotation:{x:"-3.1408",y:"0.0448",z:"3.1416"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RMb18HPPm1Dtcb74AfUQgdc4uHcxmEHU2",token_id:"20"},position:{x:"9.0000",y:"3.5800",z:"0.0800"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"2.9000",y:"2.9000",z:"2.9000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"478461"},position:{x:"-32.9135",y:"26.5222",z:"-27.9204"},rotation:{x:"2.9225",y:"1.5561",z:"-2.9225"},scale:{x:"2.1000",y:"2.1000",z:"2.1000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"649930"},position:{x:"-0.0432",y:"1.2848",z:"19.0112"},rotation:{x:"-3.1328",y:"0.0108",z:"3.1415"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}}],name:"Lola Dupre's collages",timeId:"2024-01-03T11:47:34.274Z"},{room:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"667561",name:"primitif systmatique 7377 au soleil cyan",blockchain:"tezos"},skybox:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"531100",name:"sand",blockchain:"tezos"},gallery:[{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[60,1,60]},tokenType:"block"},position:{x:"-4.0000",y:"-10.5300",z:"-125.0000"},rotation:{x:"-0.0016",y:"-0.0016",z:"-0.0016"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1XKUyUtRqobh5CqZzXFJW6UT5t55Sn3iT6",token_id:"45"},position:{x:"7.2321",y:"-7.6686",z:"-142.2599"},rotation:{x:"1.5721",y:"-1.5568",z:"1.5721"},scale:{x:"1.3200",y:"1.3200",z:"1.3200"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"4"},position:{x:"15.0426",y:"-6.1321",z:"-120.0758"},rotation:{x:"3.1412",y:"-0.0032",z:"3.1400"},scale:{x:"2.7500",y:"2.7500",z:"2.7500"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"6"},position:{x:"10.9344",y:"-6.5909",z:"-99.9036"},rotation:{x:"-1.8523",y:"1.5421",z:"1.8508"},scale:{x:"2.1100",y:"2.1100",z:"2.1100"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"3"},position:{x:"4.0323",y:"-7.5605",z:"-107.5811"},rotation:{x:"-2.1413",y:"-1.5404",z:"-2.1431"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"14"},position:{x:"-11.2814",y:"-6.6217",z:"-90.6326"},rotation:{x:"3.0872",y:"0.0316",z:"-3.1416"},scale:{x:"1.8900",y:"1.8900",z:"1.8900"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"2"},position:{x:"-34.7727",y:"-7.4174",z:"-107.5253"},rotation:{x:"-0.6274",y:"1.5204",z:"0.6252"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"15"},position:{x:"-31.8507",y:"-5.2147",z:"-142.5162"},rotation:{x:"2.0296",y:"1.5239",z:"-2.0300"},scale:{x:"1.5800",y:"1.5800",z:"1.5800"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"19"},position:{x:"-5.2900",y:"-7.5800",z:"-152.4200"},rotation:{x:"-2.3562",y:"-1.5685",z:"-2.3578"},scale:{x:"1.6000",y:"1.6000",z:"1.6000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1VeJpbrADEmFrA7rxok3CKa6RWCetzznpC",token_id:"20"},position:{x:"23.0000",y:"-7.0600",z:"-132.0000"},rotation:{x:"-0.0016",y:"-0.0016",z:"-0.0016"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT18qkaGppMc3uAVAEoFK2Vvh1HsyNLYSv8N",token_id:"5"},position:{x:"-2.6469",y:"2.4278",z:"-120.1607"},rotation:{x:"-3.1180",y:"-0.0116",z:"3.1403"},scale:{x:"1.5100",y:"1.5100",z:"1.5100"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1X3hLhhmLXZh89seeakhCy4bEsnhDhupPc",token_id:"1"},position:{x:"-17.0000",y:"-8.5000",z:"-159.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1SLmPYea1jVP71yp5yYoC55DxQmLYsZeSh",token_id:"4"},position:{x:"-2.5504",y:"-2.7939",z:"-80.0787"},rotation:{x:"-3.1396",y:"-0.0331",z:"-3.1415"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1PnKcs11gC2dHC5hLwiABriWWwUPJzb69e",token_id:"11"},position:{x:"-12.4663",y:"-2.6995",z:"-84.6079"},rotation:{x:"0.0304",y:"0.0351",z:"-0.0027"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}}],startPoint:{position:{x:-17.41478087027364,y:2.0040863448245285,z:-127.6301275907797},direction:{x:.9999898121523262,y:.0039999893333423665,z:.002091811867369841}},name:"Illustrations by PensiunanSetan",timeId:"2024-01-03T17:26:10.739Z"},{room:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1393474",name:"softcity crew's kura",blockchain:"tezos"},skybox:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1044368",name:"photoshare's ",blockchain:"tezos"},gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"14213"},position:{x:"-14.0000",y:"1.5000",z:"-8.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"156765"},position:{x:"-5.0000",y:"1.5000",z:"-1.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"108233"},position:{x:"-0.0167",y:"1.2946",z:"1.8280"},rotation:{x:"-0.8752",y:"1.5041",z:"0.8741"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"28086"},position:{x:"-12.1776",y:"2.7264",z:"6.0026"},rotation:{x:"0.4366",y:"1.3739",z:"-0.4292"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"288451"},position:{x:"7.5967",y:"2.4272",z:"13.4189"},rotation:{x:"3.1348",y:"-0.0044",z:"3.1416"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"783735"},position:{x:"0.8534",y:"4.3235",z:"14.3093"},rotation:{x:"2.4233",y:"0.6076",z:"-2.6788"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"191860"},position:{x:"-7.9758",y:"2.3407",z:"-14.0379"},rotation:{x:"-0.0272",y:"-0.0060",z:"-0.0002"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[15,.1,15]},tokenType:"block"},position:{x:"11.0000",y:"6.0000",z:"-9.0000"},rotation:{x:"-2.3562",y:"-1.5685",z:"-2.3578"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[4,.1,15]},tokenType:"block"},position:{x:"12.0556",y:"2.6403",z:"5.2077"},rotation:{x:"-2.6824",y:"-0.0061",z:"-3.1386"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"38274"},position:{x:"6.0000",y:"7.5000",z:"-2.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"186565"},position:{x:"4.0000",y:"7.5000",z:"-15.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"598215"},position:{x:"18.0000",y:"7.5000",z:"-15.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}}],name:"jjjjjjjjjjohn's still lifes",timeId:"2024-01-03T17:47:41.603Z"},{room:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1155741",name:"graphica's stilted titanic piazza de minute substance",blockchain:"tezos"},skybox:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1009681",name:"",blockchain:"tezos"},gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1CD3cTqBxwPKcihd27QDALLy351iSUKPhV",token_id:"50"},position:{x:"-14.5095",y:"3.0928",z:"15.4103"},rotation:{x:"-3.1302",y:"0.9327",z:"3.1324"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"31779"},position:{x:"14.0609",y:"2.2019",z:"-3.2344"},rotation:{x:"-3.0200",y:"-1.1927",z:"-3.0285"},scale:{x:"1.9400",y:"1.9400",z:"1.9400"}},{tokenType:"block",block:{geometry:{type:"BoxGeometry",args:[3,.1,10]},tokenType:"block"},position:{x:"10.0632",y:"0.9149",z:"3.7381"},rotation:{x:"1.1946",y:"-1.1327",z:"1.1595"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"19863"},position:{x:"18.2184",y:"6.3108",z:"8.4290"},rotation:{x:"-3.0961",y:"0.8263",z:"3.1082"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"25806"},position:{x:"23.8815",y:"5.7357",z:"8.1360"},rotation:{x:"0.0893",y:"1.0130",z:"-0.0758"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"28832"},position:{x:"34.2974",y:"5.8855",z:"-12.0137"},rotation:{x:"-0.0065",y:"-0.7472",z:"-0.0044"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"144691"},position:{x:"48.2152",y:"9.4423",z:"-2.5269"},rotation:{x:"1.6497",y:"-1.1382",z:"1.6577"},scale:{x:"3.0000",y:"3.0000",z:"3.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"670950"},position:{x:"-0.9970",y:"3.1720",z:"-17.8265"},rotation:{x:"-0.0068",y:"-0.0500",z:"-0.0003"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"88385"},position:{x:"-13.2982",y:"6.4640",z:"-7.3130"},rotation:{x:"0.3088",y:"1.0144",z:"-0.2654"},scale:{x:"3.1200",y:"3.1200",z:"3.1200"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"804255"},position:{x:"12.7111",y:"4.8602",z:"14.2155"},rotation:{x:"3.0910",y:"-0.9058",z:"3.1018"},scale:{x:"2.0000",y:"2.0000",z:"2.0000"}}],name:"Anna Malina's animations",timeId:"2024-01-06T10:52:32.234Z"}],DL=function(){return OL[Math.floor(Math.random()*OL.length)]};function NL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function BL(){return BL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},BL.apply(this,arguments)}var UL,zL={name:"GallicaPix",chain:"IIIF",url:"https://gallicapix.bnf.fr/",display_uri:"https://gallica.bnf.fr/iiif/ark:/12148/bpt6k6439443x/f302/1175.7333333333333,514.3833333333333,1867.9463333333335,1837.0833333333335/200,200/0/native"},FL={name:"Gallica by URL",url:"https://gallica.bnf.fr",chain:"IIIF",display_uri:"https://gallica.bnf.fr/iiif/ark:/12148/btv1b53164599c/f1/4574.62311557789,2773.2381909547735,2927.7587939698496,2992.820100502513/200,200/0/native"},HL={name:"Gallicarama",url:"https://gallicarama.bnf.fr/",chain:"IIIF",display_uri:"https://gallica.bnf.fr/iiif/ark:/12148/btv1b532006577/f41/94.70299999999997,79.87,2069.774,1859.83/200,200/0/native"},jL=function(e,t,n){e.source="Gallica";var r=!1;n&&(r=BL({},n));var i=e.region.split(","),a=parseInt(i[2])/parseInt(i[3]);parseInt(1400*a),e.size=",".concat(1400);var o="https://gallica.bnf.fr/iiif/".concat(e.ark,"/").concat(e.vue,"/").concat(e.region,"/").concat(e.size,"/").concat(e.rotation,"/").concat(e.quality);if(t)VL(e,o,t,r);else{var s="";if(r){var l=r.name.length>20?r.name.substring(0,20)+"":r.name,u=r.artist.length>20?r.artist.substring(0,20)+"":r.artist;s="".concat(l," ").concat(u," ")}s+=e.vue;var c=parseInt(200*a),h="".concat(c,",").concat(200),d={IIIFdata:e,link:o,item:r,desc:s,display_uri:"https://gallica.bnf.fr/iiif/".concat(e.ark,"/").concat(e.vue,"/").concat(e.region,"/").concat(h,"/").concat(e.rotation,"/").concat(e.quality),chain:"IIIF"};document.getElementById("importedIIIFContent").append(aH(d,"loadIIIFAsset"))}},GL=0,VL=function(e,t,n,r){GL++;var i=e.ark+e.vue+"|"+GL;if(r){r.gallica=!0;var a="https://gallica.bnf.fr/".concat(e.ark,"/").concat(e.vue,".item");r.permalink=a,r.IIIFdata=e,MU[i]=r,fF(t,{id:i},"IIIF",n)}else fetch("https://gallica.bnf.fr/iiif/".concat(e.ark,"/manifest.json")).then((function(e){return e.json()})).then((function(r){var a={description:"",artist:""};r.metadata.forEach((function(e){switch(e.label){case"Title":a.name=e.value,a.title=e.value;break;case"Date":a.year=e.value;case"Language":case"ShelfMark":"string"==typeof e.value?a.description+="".concat(e.value," | "):a.description+="".concat(e.value[0]["@value"]," | ")}})),a.gallica=!0;var o="https://gallica.bnf.fr/".concat(e.ark,"/").concat(e.vue,".item");a.permalink=o,a.IIIFdata=e,MU[i]=a,fF(t,{id:i},"IIIF",n)}))},WL=[],qL={},XL=window.location.search,YL=new URLSearchParams(XL),KL=new Worker(new URL(n.p+n.u(136),n.b)),JL=[],ZL=window.localStorage;KL.onmessage=function(e){switch(e.data.type){case"remote":!function(e){var t=e.data;t.chain="tezos",t.token_id=t.id,t.load?(yU(t),hj()):(JL.push(t),qL[t.curator].hasOwnProperty("DOMelement")||(qL[t.curator].DOMelement=document.createElement("div"),qL[t.curator].DOMelement.style="display: flex;margin: 20px;padding: 0px;flex-flow: wrap;"),qL[t.curator].DOMelement.append(aH(t,"loadGallery")),document.getElementById("collection").append(qL[t.curator].DOMelement))}(e);break;case"local":!function(e){var t=JSON.parse(ZL.getItem("localGalleries"));t?(t.push(e.data),ZL.setItem("localGalleries",JSON.stringify(t))):ZL.setItem("localGalleries",JSON.stringify([e.data])),Tj(),Tj()}(e);break;case"gallicarama":t=e.data,n=document.getElementById("gallicaRamaImports"),t.chain="IIIF",n.append(aH(t,"gallicaramaProject"))}var t,n;r["Galleries Natives"].fin=window.performance.now()};var QL=[{room:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"380956",name:"estienne's gaping prison of unambiguous emancipation",blockchain:"tezos"},skybox:0,gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1SwhrE6Nw5BpHb2PgxLKTAAiFD1DctKDYh",token_id:"0"},position:{x:"0.1100",y:"3.1000",z:"-6.2900"},rotation:{x:"-0.0016",y:"-0.0016",z:"-0.0016"},scale:{x:"1.7700",y:"1.7700",z:"1.7700"}}],startPoint:{position:{x:0,y:0,z:0},direction:{x:-.039934102200907186,y:.24352634067371745,z:-.9690718182258093}},name:"single7",timeId:"2024-02-25T18:33:29.352Z"},{room:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1158024",name:"CSPOK'S Representation of \"Corvos's Mysterious Depth\"",blockchain:"tezos"},skybox:0,gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1SwhrE6Nw5BpHb2PgxLKTAAiFD1DctKDYh",token_id:"0"},position:{x:"59.7654",y:"23.9788",z:"-5.1098"},rotation:{x:"1.1629",y:"1.5224",z:"-1.1641"},scale:{x:"2.2000",y:"2.2000",z:"2.2000"}}],startPoint:{position:{x:72.55120398831967,y:22.3988233820056,z:-5.057042795519675},direction:{x:-.9941277500990547,y:.10779017040999482,z:-.009554875508107966}},name:"single06",timeId:"2024-02-25T18:21:52.388Z",chain:"tezos"},{room:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"479112",blockchain:"tezos"},skybox:0,gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"63922"},position:{x:"0.0000",y:"3.5000",z:"15.0000"},rotation:{x:"3.1400",y:"0.0000",z:"3.1400"},scale:{x:"2.7000",y:"2.7000",z:"2.7000"}}],startPoint:{position:{x:0,y:0,z:0},direction:{x:-.001654686534684842,y:.11693555110770382,z:.9931381267978837}},name:"Single01",timeId:"2024-02-04T13:24:17.871Z"},{room:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"426153",blockchain:"tezos"},skybox:0,gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",token_id:"255433"},position:{x:"0.8809",y:"2.6584",z:"28.6037"},rotation:{x:"3.0484",y:"-0.0035",z:"3.1413"},scale:{x:"2.6100",y:"2.6100",z:"2.6100"}}],startPoint:{position:{x:0,y:0,z:0},direction:{x:-.001654686534684842,y:.11693555110770382,z:.9931381267978837}},name:"Single02",timeId:"2024-02-04T13:44:13.303Z"},{room:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1188724",blockchain:"tezos"},skybox:0,gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1DYnie4dm196oEtkNvahDvsBvQREQrDVAP",token_id:"20"},position:{x:"-1.0000",y:"5.2000",z:"-11.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"3.6800",y:"3.6800",z:"3.6800"}}],startPoint:{position:{x:-8399512677892189e-30,y:2.2,z:-6829806175397558e-30},direction:{x:.0035758241411601196,y:.17115317892211684,z:-.9852379422386074}},name:"Single04",timeId:"2024-02-04T14:14:47.302Z"},{room:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"541809",blockchain:"tezos"},skybox:0,gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1SwhrE6Nw5BpHb2PgxLKTAAiFD1DctKDYh",token_id:"0"},position:{x:"30.0000",y:"18.0800",z:"37.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"3.0000",y:"3.0000",z:"3.0000"}}],startPoint:{position:{x:30,y:15,z:51},direction:{x:.012387406352336927,y:.09505995115388405,z:-.9953944734880154}},name:"Single05",timeId:"2024-02-04T14:19:41.783Z"}],$L="",eI=window.localStorage,tI=function(){if(eI.getItem("currentUserSpace")){var e=JSON.parse(eI.getItem("currentUserSpace")),t=e.spriteID.split("/");KH(e.name,"https://assets.objkt.media/file/assets-003/".concat(t[1],"/").concat(t[2],"/thumb288"))}},nI=[],rI=function(e,t,n,r){var i=document.createElement("div");i.className="serviceContainer";var a=document.createElement("div");a.innerText=e.name,a.className="serviceLoaderButton",a.addEventListener("click",(function(){t(),r||(nI.push(function(e){var t=document.createElement("div");t.className="serviceContainer";var n=document.createElement("div");n.innerText=e.name,n.className="serviceLoaderButton";var r=document.createElement("div");return r.className="serviceDesc",r.innerText="Terminate "+e.name,n.addEventListener("click",(function(){e.terminate(),Tj();var n=[];nI.forEach((function(e){e!=t&&n.push(e)})),nI=[].concat(n)})),t.append(n),t.append(r),t}(e)),Tj())}));var o=document.createElement("div");o.className="serviceDesc",o.innerText=e.desc,i.append(a),i.append(o),n.push(i)},iI={"Target wallet":$L};var aI=function(e){var t=document.createElement("div");return t.id="optionDiv",t.append(function(e,t){var n=document.createElement("div");n.style="display:flex;justify-content: space-between;";var r=document.createElement("input");r.type=t,r.value={"Target wallet":iI["Target wallet"]}[e],r.id=e,r.style="width:400px",r.addEventListener("change",(function(){iI[e]=r.value}));var i=document.createElement("div");return i.innerText=e,i.style="margin-right:5px;",n.appendChild(i),n.appendChild(r),n}("Target wallet","text")),t},oI=function e(t,n){if(sI.innerHTML="",t){var r=.05*window.innerWidth,i=r,a=r,o="multiply",s=Hn("svg").attr("width",i*t.length).attr("height",a).attr("viewBox","0 0 ".concat(i*t.length," ").concat(a)).attr("xmlns","http://www.w3.org/2000/svg").style("cursor","pointer");s.append("text").attr("font-family","sans-serif").attr("x",i*t.length*.5+.1*i).attr("y",.95*a).attr("fill","rgb(0,255,235)").attr("font-size",1.2*i).attr("font-weight","bolder").attr("text-anchor","middle").style("mix-blend-mode",o).text(t),s.append("text").attr("font-family","sans-serif").attr("x",i*t.length*.5+.05*i).attr("y",.95*a).attr("fill","rgb(255,0,0)").attr("font-size",1.2*i).attr("font-weight","bolder").attr("text-anchor","middle").style("mix-blend-mode",o).text(t),sI.style.left=window.innerWidth/2-i*t.length/2+"px",sI.style.top=window.innerHeight/2-r/2+"px",sI.appendChild(s.node())}n&&setTimeout((function(){e("")}),n)},sI=document.getElementById("info");function lI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||uI(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uI(e,t){if(e){if("string"==typeof e)return cI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cI(e,t):void 0}}function cI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var hI,dI={},fI=function(e,t,n){if(e)for(var r=0;r<n;r++){var i=t[r];if(!e.has(i.level)){var a=new Map;e.set(i.level,a)}var o=e.get(i.level);o.set(i.tokenId,i),e.set(i.level,o)}else{for(var s=new Map,l=0;l<n;l++){var u=t[l];if(!s.has(u.level)){var c=new Map;s.set(u.level,c)}var h=s.get(u.level);h.set(u.tokenId,u),s.set(u.level,h)}e=s}var d,f=(d=e,function(e){if(Array.isArray(e))return cI(e)}(d)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(d)||uI(d)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(e,t){var n=lI(e,2),r=n[0],i=(n[1],lI(t,2)),a=i[0];return i[1],r-a}));return new Map(f)};"undefined"!=typeof OffscreenCanvas?hI=new Worker(new URL(n.p+n.u(640),n.b)):console.log("This browser does not support offscreen canvas.");var pI=function(e){oI("CLEARING BLOCKS",2e3),function(e){dI[e](),delete dI[e]}(e),mI[e].slider.clear(),mI[e].slider.remove(),mI[e]=null,delete mI[e]},mI={},vI=new dc(1.5,.3,.75),gI=new Cm(vI),yI=new Ic(1.5,.3);"undefined"!=typeof OffscreenCanvas&&(hI.onmessage=function(e){return bI(e.data)});var bI=function(e){if(mI[e.feedType]){var t=new lf,n=new cc(vI,OF.whiteFull),r=new Bp(gI,OF.blackLineLone);n.position.set(0,0,-.3755),r.position.set(0,0,-.3755);var i=new Qf(e.img.data,1e3,200);i.colorSpace=fo,i.generateMipmaps=!0,i.flipY=!0,i.magFilter=Fi,i.minFilter=Vi,i.generateMipmaps=!0,i.needsUpdate=!0;var a=new xu({map:i}),o=new cc(yI,a);r.userData.isBlockPanel=1,t.userData.item=e,t.userData.focused=!1,t.add(o,n,r),t.userData.isBlockDisplay=!0;var s,l=mI[e.feedType].group;e.hasOwnProperty("level")?s="string"==typeof e.level?e.level:JSON.stringify(e.level):e.token.hasOwnProperty("level")&&(s="string"==typeof e.token.level?e.token.level:JSON.stringify(e.token.level)),l[s].add(t),oI(),t.position.y=50;var u=t.parent.children.length;ZT.to(t.position,{duration:2,y:.35*u-2})}},xI=function(e){var t=e.children[0],n=e.children[1];ZT.to(t.position,{duration:2,y:-20,ease:"power1.in"}),ZT.to(n.position,{duration:2,y:-20,ease:"power1.in"}),setTimeout((function(){n.children.forEach((function(e){e.children.forEach((function(e){e.material.map&&e.material.dispose()}))})),e.remove(t),e.remove(n)}),2e3)},wI=function(e,t,n,r){mI.hasOwnProperty(t)||(mI[t]={map:new Map,group:{},blocks:new lf,slider:new lf,added:!0,lowerblock:999999999999},mI[t].blocks.add(mI[t].slider),mI[t].blocks.userData={tokenType:"datavis",feedType:t,args:r},n?(mI[t].blocks.position.set(parseFloat(n.position.x),parseFloat(n.position.y),parseFloat(n.position.z)),mI[t].blocks.rotation.set(parseFloat(n.rotation.x),parseFloat(n.rotation.y),parseFloat(n.rotation.z)),mI[t].blocks.scale.set(parseFloat(n.scale.x),parseFloat(n.scale.y),parseFloat(n.scale.z)),uG.add(mI[t].blocks)):(cG.add(mI[t].blocks),mI[t].blocks.position.y=1,BU(mI[t].blocks)));var i=mI[t].map,a=mI[t].group,o=mI[t].slider,s=0,l=0,u=e.size<=24?0:e.size-24;switch(t){case"teztok-nft-livefeed":case"teztok-nft-lat-transact":case"teztok-sales-nft-livefeed":case"artblocks-nft-livefeed":case"gmstudio-nft-livefeed":case"bright-nft-livefeed":case"genart-nft-livefeed":case"verse-nft-livefeed":case"superrare-nft-livefeed":case"artblocks%3Agmstudio%3Abright%3Agenart%3Asuperrare%3Averse-nft-livefeed":l=!0}mI[t].added&&(zB(!0),mI[t].added=!1),e.forEach((function(e,n){if(s>=u)if(i.has(n)){var r=i.get(n);r.size!=e.size&&e.forEach((function(e,n){r.has(n)||(r.set(n,e),hI.postMessage({operation:e,feedType:t}))}))}else{n<mI[t].lowestBlock&&(mI[t].lowestBlock=n),i.set(n,e),function(e,t,n,r,i){var a=new lf,o=i?JSON.stringify(10*Math.cos(t/13*Math.PI)):0;o=parseFloat(o);var s=i?10*Math.sin(t/13*Math.PI):-5;a.position.set(o,0,s),a.rotation.y=i?-t/13*Math.PI-Math.PI/2:0;var l=e;"number"==typeof e&&(l=JSON.stringify(l)),a.name=JSON.stringify(l),n[l]=a;var u=function(e){var t=e,n=document.createElement("canvas"),r=n.getContext("2d");n.width=100,n.height=100*t.length,r.fillStyle="white",r.fillRect(0,0,100,100*t.length),r.textAlign="center",r.font="bolder 90px monospace";for(var i=0;i<t.length;i++)r.fillStyle="black",i>3&&(r.fillStyle="red"),r.strokeRect(0,100*i,100,100),r.fillText(t[i],50,100*(i+1)-25);return n.toDataURL()}(l);mF(u).then((function(e){var n=new lf;n.position.x=-1;var o=new xu({map:e}),s=l.length/10,u=new dc(.1,s,.1),c=new Cm(u),h=new Ic(.1,s),d=new cc(h,o),f=new cc(u,OF.whiteFull);f.position.z=-.051;var p=new Bp(c,OF.blackLineLone);p.position.z=-.051,n.add(d,f,p);var m=i?10*Math.cos((t-.42)/13*Math.PI):-1.15,v=i?10*Math.sin((t-.42)/13*Math.PI):-5;n.position.set(m,0,v),n.rotation.y=i?-t/13*Math.PI-Math.PI/2:0,r.add(n),r.add(a)}))}(n,s,a,o,l);for(var c=(o.children.length-42)/2,h=0;h<c;h++)setTimeout((function(){xI(o)}),3e3*h);e.forEach((function(e,n){hI.postMessage({operation:e,feedType:t})}))}s++}))},_I={};["artblocks","gmstudio","bright","genart","verse","superrare","artblocks%3Agmstudio%3Abright%3Agenart%3Asuperrare%3Averse"].forEach((function(e){var t={interval:0,currentFeed:0};_I[e]=t}));var EI=function(e){TI(e),oI("CALLING ARTACLE",1500),_I[e].interval=setInterval((function(){TI(e)}),25e3)},TI=function(e){fetch("https://artacle.io/api/activity/transactionsV3?platform=".concat(e)).then((function(e){return e.json()})).then((function(t){var n=t.transactions;n.forEach((function(e){e.tokenId=e.tokenName+e.token,e.level=parseInt(e.ts/3e5),e.token={type:"ETH",name:e.tokenName,editions:1,platform:e.tags[0],artist_profile:{alias:e.collectionArtist},display_uri:e.imageUrl,txnHash:e.txnHash,tokenId:e.tokenName+e.token,url:"https://artacle.io/project/".concat(e.projectId,"/token/").concat(e.token),metadata:{id:e.token,projectId:e.projectId}},e.txnHash.length>0&&(e.permalink="https://etherscan.io/tx/"+e.txnHash),e.type="S"===e.opType?"SALE":"LISTING","S"===e.opType&&(e.previousSale={profit:{profit_in_crypto:e.valueETH-e.prevValueETH,profit_in_usd:e.valueUSD-e.prevValueUSD}}),e.price=e.valueUSD,e.seller_profile={alias:e.fromWallet,address:e.fromWallet},e.buyer_profile={alias:e.toWallet,address:e.toWallet}}));var r=_I[e].currentFeed;r=fI(r,n,200),wI(r,"".concat(e,"-nft-livefeed"))}))};function SI(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return MI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MI(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function MI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var AI,kI,PI,RI,CI=function(e,t){oI(e[0].mediaType+" NEWS",2500);var n=new Map;n.set("NEWSFEED",e),wI(n,"news-feed-rss",t)};function LI(e){return LI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},LI(e)}function II(){II=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),s=new R(r||[]);return i(o,"_invoke",{value:M(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var x={};u(x,o,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(C([])));_&&_!==n&&r.call(_,o)&&(x=_);var E=b.prototype=g.prototype=Object.create(x);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,a,o,s){var l=h(e[i],e,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==LI(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function M(t,n,r){var i=d;return function(a,o){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=A(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(t,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function A(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=h(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(LI(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new S(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(E),u(E,l,"Generator"),u(E,o,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function OI(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function DI(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function NI(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){DI(a,r,i,o,s,"next",e)}function s(e){DI(a,r,i,o,s,"throw",e)}o(void 0)}))}}var BI=0,UI=function(e,t){GI(e,t),oI("CALLING TEZTOK");var n="sales"===e?"teztok-sales-nft-livefeed":"teztok-nft-livefeed",r=setInterval((function(){GI(e,t)}),12e3);!function(e,t){dI[e]=function(){return clearInterval(r)}}(n)},zI=new Map;function FI(e){return HI.apply(this,arguments)}function HI(){return HI=NI(II().mark((function e(t){var n,r;return II().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t.forEach((function(e,t,r){e.forEach((function(e,t){"SALE"===e.implements&&1===e.token.editions&&(zI.get(e.id)||(zI.set(e.id,!0),n.push(e)))}))})),r=0;case 3:if(!(r<n.length)){e.next=9;break}return e.next=6,ZI(n[r]);case 6:r++,e.next=3;break;case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),HI.apply(this,arguments)}function jI(e){return e.forEach((function(e){e.token.mime=e.token.mime_type,e.tokenId=e.id,e.seller_address===VH||e.artist_address===VH||e.buyer_address===VH?e.userInvolved=!0:e.userInvolved=!1})),e}function GI(e,t){fetch("https://livefeed-proxy.teztok.com/feed").then((function(e){return e.json()})).then((function(n){var r=jI(n.events),i="teztok-nft-livefeed";if("sales"===e){var a=[];r.forEach((function(e){"SALE"===e.implements&&1===e.token.editions&&a.push(e)})),r=a,i="teztok-sales-nft-livefeed"}FI(BI=fI(BI,r,r.length)).then((function(n){"sales"===e&&n.forEach((function(e,t,n){e.previousSale||n.delete(t)})),wI(BI=n,i,t,0)}))}))}var VI,WI={latestGeneralTransactions:(0,xx.gql)(AI||(AI=OI(['\n    query latestGeneralTransactions {\n      events(\n        limit: 500\n        order_by: { opid: desc }\n        where: {\n          token: { metadata_status: { _eq: "processed" } }\n          implements: { _eq: "SALE" }\n          price_in_usd: { _gte: "100000000" }\n        }\n      ) {\n        type\n        timestamp\n        seller_address\n        buyer_address\n        price\n\n        implements\n        level\n        price_in_usd\n        token_id\n        id\n        fa2_address\n        token {\n          fa2_address\n          token_id\n          editions\n          name\n          mime_type\n          description\n          price\n          platform\n          last_sale_at\n          display_uri\n          artifact_uri\n          last_sales_price\n          artist_profile {\n            account\n            alias\n            twitter\n          }\n        }\n\n        seller_profile {\n          alias\n        }\n\n        buyer_profile {\n          account\n          alias\n        }\n      }\n    }\n  ']))),latestSales:(0,xx.gql)(kI||(kI=OI(['\n    query GetLatestSales($id: String!) {\n      events(\n        where: { implements: { _eq: "SALE" }, seller_address: { _eq: $id } }\n        order_by: { opid: desc }\n        limit: 100\n      ) {\n        type\n        timestamp\n        seller_address\n        buyer_address\n        price\n\n        implements\n        level\n        price_in_usd\n        token_id\n        id\n        fa2_address\n        token {\n          fa2_address\n          token_id\n          editions\n          name\n          description\n          mime_type\n          price\n          platform\n          last_sale_at\n          display_uri\n          artifact_uri\n          last_sales_price\n          artist_profile {\n            account\n            alias\n            twitter\n          }\n        }\n\n        seller_profile {\n          alias\n        }\n\n        buyer_profile {\n          account\n          alias\n        }\n      }\n    }\n  ']))),latestPurchases:(0,xx.gql)(PI||(PI=OI(['\n    query GetLatestPurchases($id: String!) {\n      events(\n        where: { implements: { _eq: "SALE" }, buyer_address: { _eq: $id } }\n        order_by: { opid: desc }\n        limit: 100\n      ) {\n        type\n        timestamp\n        seller_address\n        implements\n        buyer_address\n        price\n        price_in_usd\n        level\n        token_id\n        id\n        fa2_address\n        token {\n          fa2_address\n          token_id\n          editions\n          mime_type\n          name\n          description\n          price\n          platform\n          last_sale_at\n          display_uri\n          artifact_uri\n          last_sales_price\n          artist_profile {\n            account\n            alias\n            twitter\n          }\n        }\n\n        seller_profile {\n          alias\n        }\n\n        buyer_profile {\n          account\n          alias\n        }\n      }\n    }\n  ']))),previousSale:(0,xx.gql)(RI||(RI=OI(['\n    query previousPrice($token_id: String!, $contract: String!) {\n      events(\n        limit: 2\n        where: {\n          fa2_address: { _eq: $contract }\n          token_id: { _eq: $token_id }\n          implements: { _eq: "SALE" }\n        }\n        order_by: { timestamp: desc }\n      ) {\n        type\n        token {\n          fa2_address\n          token_id\n          mime_type\n        }\n        id\n        price\n        price_in_usd\n        timestamp\n      }\n    }\n  '])))},qI=function(){var e=!1;VH&&(e=VH);var t=document.getElementById("Target wallet").value;return t&&(e=t),e},XI=function(e,t){var n;(n=e||qI())?(oI("LATEST SALES",2500),(0,xx.request)("https://api.teztok.com/v1/graphql",WI.latestSales,{id:n}).then((function(e){var r=jI(e.events),i=[];r.sort((function(e,t){return new Date(e.timestamp)-new Date(t.timestamp)})).forEach((function(e){1===e.token.editions&&(e.level="LAT-SALES",e.token.level="LAT-SALES",e.price=e.token.last_sales_price,i.push(e))}));var a=new Map;a.set("LAT-SALES",i),FI(a).then((function(e){var r=e.get("LAT-SALES").sort((function(e,t){return new Date(t.timestamp)-new Date(e.timestamp)}));a.set("LAT-SALES",r),wI(a,"teztok-nft-lat-sales",t,{targetWallet:n})}))}))):oI("NO TARGET FOR ANALYSIS",2500)},YI=function(e,t){var n;(n=e||qI())?(oI("LATEST PURCHASES",2500),(0,xx.request)("https://api.teztok.com/v1/graphql",WI.latestPurchases,{id:n}).then((function(e){var r=e.events.sort((function(e,t){return new Date(e.timestamp)-new Date(t.timestamp)}));r.forEach((function(e){e.level="LAT-PURCHASES",e.token.level="LAT-PURCHASES",e.token.price=e.price}));var i=new Map;i.set("LAT-PURCHASES",r),FI(i).then((function(e){var r=e.get("LAT-PURCHASES").sort((function(e,t){return new Date(t.timestamp)-new Date(e.timestamp)}));i.set("LAT-PURCHASES",r),wI(i,"teztok-nft-lat-purchases",t,{targetWallet:n})}))}))):oI("NO TARGET FOR ANALYSIS",2500)},KI=function(e){return Math.floor(e/864e5)},JI=function(e){oI("LATEST LARGE TRANSACTIONS",2500),(0,xx.request)("https://api.teztok.com/v1/graphql",WI.latestGeneralTransactions).then((function(t){var n=jI(t.events),r=[],i=KI(Date.now());n.forEach((function(e){"SALE"===e.implements&&1===e.token.editions&&(e.level=KI(new Date(e.timestamp))-i,e.level>=-20&&(e.level+=" days",r.push(e)))}));var a=fI(0,n=r,n.length);FI(a).then((function(t){wI(a=t,"teztok-nft-lat-transact",e,0)}))}))};function ZI(e){return QI.apply(this,arguments)}function QI(){return(QI=NI(II().mark((function e(t){return II().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,xx.request)("https://api.teztok.com/v1/graphql",WI.previousSale,{token_id:t.token_id,contract:t.fa2_address}).then((function(e){var n=e.events[0],r=e.events[1];if(r){var i={previousSale:{price:r.price,price_in_usd:r.price_in_usd},profit:{profit_in_crypto:n.price-r.price,profit_in_usd:n.price_in_usd-r.price_in_usd}};i&&r.price>0&&n.price>0&&(t.previousSale=i)}}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,xx.gql)(VI||($I=["\n  query {\n    activityPage(filter: {}, first: 100) {\n      pageInfo {\n        endCursor\n        hasNextPage\n      }\n      nodes {\n        id\n        entryType\n        artwork {\n          title\n          artist {\n            name\n          }\n        }\n        amount\n      }\n    }\n  }\n"],eO||(eO=$I.slice(0)),VI=Object.freeze(Object.defineProperties($I,{raw:{value:Object.freeze(eO)}}))));var $I,eO,tO=[];rI({name:"TezTok",desc:"TezTok indexes and normalizes NFT related data on the Tezos Blockchain. The indexer aggregates and stores an event history for all tokens. Every time a new event occurs on a token, the indexer processes the event history and re-creates a token model along with listings, offers, tags, and holdings. TezTok is accountable for all the data presented, the anaver.se only loads such data and does not have its own data analysis service."},(function(){var e=[],t={livefeed:{name:"Live feed",desc:"The TezTok NFT live feed. The use of this NFT LiveFeed is at your own risk. It is your own responsibility to check if the drops displayed are legitimate. The data displayed is to the best of of the TezTok team knowledge. On examination, you will be redirected to the objkt.com website.",terminate:function(){return pI("teztok-nft-livefeed")}},salefeed:{name:"Live Sales",desc:"The TezTok NFT live feed, but only showing 1/1 secondary market sales.",terminate:function(){return pI("teztok-sales-nft-livefeed")}},latsales:{name:"Latest sales",desc:"The latest 1/1 NFT sales of the targeted wallet (latest 100 transactions).",terminate:function(){return pI("teztok-nft-lat-sales")}},latpurchases:{name:"Latest purchases",desc:"The wallet's latest NFT acquisitions (lastest 100 transactions).",terminate:function(){return pI("teztok-nft-lat-purchases")}},lattransact:{name:"Latest transactions",desc:"The 500 latest transactions above USD$100.",terminate:function(){return pI("teztok-nft-lat-transact")}}};rI(t.livefeed,UI,e),rI(t.lattransact,JI,e),rI(t.latsales,XI,e),rI(t.latpurchases,YI,e);var n=document.getElementById("galleryMainWindow");n.innerHTML="",n.append(aI()),e.forEach((function(e){return n.append(e)}))}),tO,1),rI({name:"Artacle",desc:"Artacle provides transaction feeds for platforms such as Artblocks and gmStudio. It aims at providing AI-powered insights on generative art collections, including rarity scores, sales data and analytics."},(function(){var e=[],t={artaclelivefeed:{name:"Artacle 1/1",desc:"A cumulative 1/1 feed including generative art platforms and 1/1 platform SuperRare.",terminate:function(){return pI("artblocks%3Agmstudio%3Abright%3Agenart%3Asuperrare%3Averse-nft-livefeed")},start:function(){return EI("artblocks%3Agmstudio%3Abright%3Agenart%3Asuperrare%3Averse")}},superrarelivefeed:{name:"SUPERRARE",desc:"SUPERRARE is a community aiming to revolutionize the economics of human creativity.",terminate:function(){return pI("superrare-nft-livefeed")},start:function(){return EI("superrare")}},artblockslivefeed:{name:"Artblocks live",desc:"Live feed of Artblocks transactions.",terminate:function(){return pI("artblocks-nft-livefeed")},start:function(){return EI("artblocks")}},verselivefeed:{name:"Verse live",desc:"Live feed of Verse transactions.",terminate:function(){return pI("verse-nft-livefeed")},start:function(){return EI("verse")}},gmstudiolivefeed:{name:"GMstudio live",desc:"Live feed of GMstudio transactions.",terminate:function(){return pI("gmstudio-nft-livefeed")},start:function(){return EI("gmstudio")}},brightlivefeed:{name:"Bright Moments",desc:"Live feed of Bright Moments transactions.",terminate:function(){return pI("bright-nft-livefeed")},start:function(){return EI("bright")}},genartlivefeed:{name:"GENART live",desc:"GENART is a fully on-chain generative art platform that is operated as a DAO. ",terminate:function(){return pI("genart-nft-livefeed")},start:function(){return EI("genart")}}};for(var n in t)rI(t[n],t[n].start,e);var r=document.getElementById("galleryMainWindow");r.innerHTML="",r.append(aI()),e.forEach((function(e){return r.append(e)}))}),tO,1);var nO=new Audio("/sound/jetpack/jetpack_start.mp3");nO.volume=1;var rO=new Audio("/sound/jetpack/jetpack_croisiere.mp3");rO.volume=1,rO.loop=!0;var iO=!0,aO=function(){"undefined"!=typeof OffscreenCanvas&&(nO.play(),iO=!0,setTimeout((function(){iO&&rO.play()}),2e3))},oO=function(){nO.pause(),rO.pause(),iO=!1},sO=new Audio("/sound/steps/steps.mp3");sO.volume=.1;for(var lO=function(e){"undefined"!=typeof OffscreenCanvas&&(e?sO.play():sO.pause())},uO=[],cO=1;cO<=4;cO++)uO.push(new Audio("/sound/ball/ball"+cO+".wav"));var hO,dO,fO,pO=function(e){var t=uO[Math.floor(Math.random()*uO.length)];t.volume=e>=1?1:e,t.play()},mO=new Audio("/sound/camera/cameraclick.mp3"),vO=function(){var e="oo"+Array(49).fill(0).map((function(e){return"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"[58*Math.random()|0]})).join("");return console.log("Generating random hash"),console.log(e),e},gO=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}};function yO(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var bO,xO,wO,_O,EO=(0,xx.gql)(fO||(fO=yO(["\n  query GetObjktsByHolderPaged(\n    $limit: Int!\n    $offset: Int!\n    $where: token_holder_bool_exp = {}\n    $order_by: [token_holder_order_by!] = {}\n  ) {\n    token_holder(\n      limit: $limit\n      offset: $offset\n      where: $where\n      order_by: $order_by\n    ) {\n      token {\n        ...TokenDefault\n        __typename\n\n        fa {\n          collection_type\n          contract\n          name\n        }\n      }\n      __typename\n      holder {\n        alias\n      }\n    }\n  }\n\n  fragment TokenDefault on token {\n    pk\n    token_id\n    artifact_uri\n    description\n    display_uri\n    thumbnail_uri\n    timestamp\n    mime\n    name\n    creators {\n      creator_address\n      holder {\n        alias\n        twitter\n        logo\n        tzdomain\n      }\n    }\n    attributes {\n      attribute {\n        id\n        name\n        type\n        value\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n"]))),TO={},SO={},MO={},AO=function e(t,n,r){return(0,xx.request)("https://data.objkt.com/v3/graphql",EO,{where:{holder_address:{_eq:t},quantity:{_gt:0},token:{fa:{live:{_eq:!0}}}},order_by:{last_incremented_at:"desc"},limit:r||500,offset:n||0}).then((function(i){i.token_holder.forEach((function(e){if(e.token.id=e.token.fa.contract+e.token.token_id,e.token.hasOwnProperty("creators")&&e.token.creators[0]){var t=e.token.creators[0].creator_address;MO.hasOwnProperty(t)||(MO[t]={wallet:t}),MO[t][e.token.id]=e.token,SO.hasOwnProperty(t)||(SO[t]=e.token.creators[0].alias),MU[e.token.id]=e.token}})),500===i.token_holder.length&&500===r?e(t,n+500,500):(PO(MO),Tx("OBJKT tokens retrieval",1))})).catch((function(e){console.log("Failed to retrieve your OBJKT tokens"),console.log(e),Tx("OBJKT tokens retrieval",0)}))},kO=function(e,t){return(0,xx.request)("https://data.objkt.com/v3/graphql",function(e,t){return(0,xx.gql)(dO||(dO=yO(['\n  query getTokensByContract {\n    token(\n      where: { fa_contract: { _eq: "','" }, token_id: {_eq: "','"} }\n    ) {\n     token_id\n     artifact_uri\n     description\n     display_uri\n     mime\n     thumbnail_uri\n     timestamp\n     name\n     creators {\n       creator_address\n       holder {\n        alias\n        address\n        twitter\n        logo\n        tzdomain\n      }\n     }\n     attributes {\n       attribute {\n         id\n         name\n         type\n         value\n         __typename\n       }\n       __typename\n     }\n     __typename\n          fa {\n           collection_type\n           contract\n           name\n           \n         }\n       \n     }\n }\n'])),e,t)}(e,t)).then((function(n){var r=e,i=n.token[0].token_id,a=n.token[0];a.contract=r,a.token_id=i,a.chain="tezos",a.artist=a.creators[0].holder.alias,a.link='<span>Check on <a href="https://objkt.com/tokens/'.concat(a.contract,"/").concat(a.token_id,'" target="_blank">objkt</a></span>'),a.id=e+"/"+t;var o=aH(a,"loadItem"),s=document.getElementById("importedContractContent");s?s.append(o):QN(a)}))},PO=function(e){var t=Object.values(e);gO(t);var n={};for(var r in t.forEach((function(e){n[e.wallet]=e,delete e.wallet})),n)for(var i in n[r]){var a=n[r][i];a.chain="tezos",a.contract=a.fa.contract,a.creators.forEach((function(e){var t=e.holder;t.address=e.creator_address,HH(t)})),AU[r]=aH(a,"displayCollection")}},RO=function(e){var t={},n=0;e.forEach((function(e){if(n++,e.hasOwnProperty("objktMetaData")&&(e.tezosMetaData=e.objktMetaData),e.hasOwnProperty("contract")&&e.hasOwnProperty("token_id")&&(e.tezosMetaData={contract:e.contract,token_id:e.token_id}),n<500){var r=e.tezosMetaData.contract+e.tezosMetaData.token_id;t.hasOwnProperty(r)||(t[r]="{\n          token_id: { _eq: ".concat(JSON.stringify(e.tezosMetaData.token_id)," },\n          fa_contract: { _eq: ").concat(JSON.stringify(e.tezosMetaData.contract)," },\n        }"))}}));var r=[];for(var i in t)r.push(t[i]);var a="query{\n    token(where: {_or:[".concat(r,"]}) {\n      description\n      artifact_uri\n      content_rating\n      display_uri\n      metadata\n      mime\n      name\n      thumbnail_uri\n      timestamp\n      creators{\n        creator_address\n        holder {\n          alias\n          twitter\n          address\n        }\n      }\n      fa{\n        contract\n      }\n      token_id\n    }\n  }");(0,xx.request)("https://data.objkt.com/v3/graphql",a).then((function(t){e.forEach((function(e){t.token.forEach((function(t){if(t.fa.contract===e.tezosMetaData.contract&&t.token_id===e.tezosMetaData.token_id)if(t.content_rating&&vU(),t.display_uri||t.artifact_uri){var n=t.display_uri?"https://assets.objkt.media/file/assets-003/"+t.display_uri.replace("ipfs://","")+"/display":"https://assets.objkt.media/file/assets-003/"+t.artifact_uri.replace("ipfs://","")+"/artifact",r={position:e.position,rotation:e.rotation,scale:e.scale};t.contract=t.fa.contract,t.chain="tezos",t.blockchain="tezos";var i=gU?"?ref=".concat(gU):"",a="https://objkt.com/tokens/".concat(t.fa.contract,"/").concat(t.token_id).concat(i);t.url=a;var o=t.fa.contract+JSON.stringify(t.token_id);t.artist="",t.creators.forEach((function(e){t.artist+=" ".concat(e.holder.alias)})),MU[o]=t;var s=!!e.hasOwnProperty("note")&&e.note;fF(n,{id:o},"tezos",r,s)}else console.log("%c [objkt.com] The token ["+t.name+"] was minted without a proper metadata capture.","font-weight:bold;")}))}))})).catch((function(e){console.log(e),oI("GALLERY ERROR",2e3)}))},CO=function(){zB(1),uG.clear(),LO.innerHTML="Final score <br>\n  Valid hits: ".concat(UO.valid,"<br>\n  Invalid hits: ").concat(UO.invalid,"<br>"),eD(),setTimeout((function(){LO.innerHTML="",LO.style.display="none"}),5e3)},LO=document.getElementById("targetInfo"),IO=function(){KO(FO[0],Math.floor(60+30*Math.random())),pO(1),FO[0].colliding=!0},OO={},DO=function(){zB(0),bO=parseInt(gG.position.x),xO=parseInt(gG.position.y),wO=parseInt(gG.position.z),UO={valid:0,invalid:0,turns:10},LL.forEach((function(e){if(NH.hasOwnProperty(e.curator)&&NH[e.curator].hasOwnProperty("alias")){var t=[];e.gallery.forEach((function(e){"tezos"!==e.tokenType&&"IIIF"!==e.tokenType||t.push(e)})),OO[NH[e.curator].alias]=t}})),LO.style.display="block",YO(),cD(1),document.addEventListener("click",IO),BO()},NO="";function BO(){NO=zO(Object.keys(OO)),LO.innerHTML="Current score <br>\n  Valid hits: ".concat(UO.valid,"<br>\n  Invalid hits: ").concat(UO.invalid,"<br>\n  Turns left: ").concat(UO.turns,'<br>\n  <br><br>\n  You are looking for the piece that is <strong>not</strong> by \n  <span style="background:red;font-weight:bolder;color:white;padding:2px;">').concat(NO,"</span>.");var e=NO;if(NO&&e){for(;NO===e;)e=zO(Object.keys(OO));(_O=zO(OO[e])).id=_O.tezosMetaData.contract+JSON.stringify(_O.tezosMetaData.token_id);var t=[zO(OO[NO]),zO(OO[NO]),_O];gO(t);for(var n=0;n<3;n++){var r=t[n];r.position.x="".concat(bO+3*(n-1),".0000"),r.position.y="".concat(xO,".0000"),r.position.z="".concat(wO-5,".0000"),1===n&&(r.position.z="".concat(wO-7,".0000")),r.rotation.x="0.0000",r.rotation.y="".concat(1-n,".0000"),r.rotation.z="0.0000",r.scale.x="1.0000",r.scale.y="1.0000",r.scale.z="1.0000"}RO(t)}}var UO={valid:0,invalid:0,turns:10},zO=function(e){return e[Math.floor(Math.random()*e.length)]},FO=[],HO=new _y,jO=new bs,GO=new bl,VO=new Qs,WO=new Qs,qO=(new Qs(0,0,1),new Mv({transparent:!0,opacity:1})),XO=new dv(1,20,20);function YO(){new vu(16711935),new vu("blue");var e=new cc(XO,qO);rG.add(e);var t=.5*(.2*Math.random()+.6);return e.scale.setScalar(t),e.collider=new bl(e.position,t),e.velocity=new Qs(0,0,0),e.mass=Math.pow(t,3)*Math.PI*4/3,e.position.copy(gG.position),e.colliding=!0,FO.push(e),e}var KO=function(e,t){jO.x=0,jO.y=0,HO.setFromCamera(jO,gG),e.position.copy(gG.position).addScaledVector(HO.ray.direction,3),e.velocity.set(Math.random()-.5,Math.random()-.5,Math.random()-.5).addScaledVector(HO.ray.direction,t).multiplyScalar(.5)};function JO(e,t){for(var n=t.geometry.boundsTree,r=function(){var t=FO[i];if(t.colliding){var r=t.collider;t.velocity.y+=-10*e,r.center.addScaledVector(t.velocity,e),GO.copy(t.collider);var a=!1;if(n.shapecast({intersectsBounds:function(e){return e.intersectsSphere(GO)},intersectsTriangle:function(e){e.closestPointToPoint(GO.center,VO),VO.sub(GO.center);var t=VO.length();if(t<GO.radius){var n=t-GO.radius;VO.multiplyScalar(1/t),GO.center.addScaledVector(VO,n),a=!0}},traverseBoundsOrder:function(e){return e.distanceToPoint(GO.center)-GO.radius}}),a){VO.subVectors(GO.center,r.center).normalize(),t.velocity.reflect(VO);var o=t.velocity.dot(VO);t.velocity.addScaledVector(VO,.5*-o),t.velocity.multiplyScalar(Math.max(1-e,0)),r.center.copy(GO.center),WO.copy(GO.center).addScaledVector(VO,-GO.radius),o>1&&(pO(1/(gG.position.distanceTo(FO[0].position)/3)),uG.children.forEach((function(e){FO[0].position.distanceTo(e.position)<1.5&&(lD(e.userData.id),function(e){e===_O.id?(UO.valid++,uG.clear()):UO.invalid++,LO.innerHTML="Current score <br>\n    Valid hits: ".concat(UO.valid,"<br>\n    Invalid hits: ").concat(UO.invalid,"<br>\n    Turns left: ").concat(UO.turns,'<br>\n    <br><br>\n    You are looking for the piece that is <strong>not</strong> by \n    <span style="background:red;font-weight:bolder;color:white;padding:2px;">').concat(NO,"</span>."),UO.turns--,0===UO.turns?CO():e===_O.id&&BO()}(e.userData.id))})))}}if(FO.length>1)for(var s=0,l=FO.length;s<l;s++){for(var u=FO[s],c=u.collider,h=s+1;h<l;h++){var d=FO[h],f=d.collider;VO.subVectors(c.center,f.center);var p=VO.length()-(c.radius+f.radius);if(p<0){VO.normalize();var m=u.velocity.dot(VO),v=d.velocity.dot(VO),g=Math.max(m,.2),y=Math.max(v,.2),b=g+y,x=g/b,w=y/b;c.center.addScaledVector(VO,-x*p),f.center.addScaledVector(VO,w*p);var _=new Qs;_.addScaledVector(VO,-m).addScaledVector(VO,v);var E=_.length(),T=u.mass,S=d.mass,M=void 0,A=void 0,k=.5;_.dot(u.velocity)>_.dot(d.velocity)?(M=k*E*(T-S)/(T+S),A=k*E*2*T/(T+S),M-=E):(M=k*E*2*S/(T+S),A=k*E*(S-T)/(T+S),A-=E),_.normalize(),u.velocity.addScaledVector(_,M),d.velocity.addScaledVector(_,A),WO.copy(c.center).addScaledVector(VO,-c.radius)}}u.position.copy(c.center)}},i=0,a=FO.length;i<a;i++)r()}var ZO,QO,$O,eD=function(){for(var e=0;e<FO.length;e++){var t=FO[e];FO.splice(e,1),e--,t.material.dispose(),t.geometry.dispose(),rG.remove(t)}},tD=function(){KO(FO[0],Math.floor(60+30*Math.random())),pO(1),FO[0].colliding=!0},nD=0,rD=0,iD=function(){zB(0),rD=1,eD(),oI("BLUDGEBALL STARTED"),setTimeout((function(){oI("")}),1500),YO(),ZO=aD(),QO=ZO[nD],sD(QO),document.addEventListener("click",tD),oD.style.display="block"},aD=function(){var e=[];return uG.children.forEach((function(t){t.userData.hasOwnProperty("id")&&e.push(t.userData.id)})),gO(e)},oD=document.getElementById("targetInfo"),sD=function(e){if(e){var t=MU[e],n=["HIT","GOOD JOB","THAT'S RIGHT"];if(t){var r="";t.hasOwnProperty("creators")&&t.creators[0]&&NH.hasOwnProperty(t.creators[0].creator_address)&&NH[t.creators[0].creator_address].alias&&(r=" by "+NH[t.creators[0].creator_address].alias);var i=parseInt(nD+1)+"/"+ZO.length+" ";oI(n[Math.floor(Math.random()*n.length)],2e3),oD.innerText=r?i+t.name+r:i+t.name}}else oD.innerText="Practice Mode"},lD=function(e){e===QO&&(++nD<ZO.length&&(QO=ZO[nD],sD(QO)),nD===ZO.length&&(oD.innerText="",oD.style.display="none",oI("YOU WIN",2500),eD()))},uD=function(){oD.innerText="",oD.style.display="none",oI("BLUDGE - OVER",2e3),eD(),rD=0,zB(1)},cD=function(e){return rD=e},hD=[],dD={bludgeball:{name:"BludgeBall",desc:"Ever dreamed of throwing a ball? Get the unique opportunity to throw a ball at stuff. Click to throw, click again to have the ball come back to you!",terminate:uD},guessgame:{name:"Guess the intruder",desc:"Given a name and three pieces, guess which one is not from the said artist.",terminate:CO}};function fD(){var e=[];rI({name:"BludgeBall",desc:"Throw a ball around! Hit the frames suspended in your current location in a random order, or just practice if you're not in the mood.",terminate:uD},iD,e);var t=document.getElementById("galleryMainWindow");t.innerHTML="",e.forEach((function(e){return t.append(e)}))}function pD(){var e=[];rI({name:"Guess the Seminar artist",desc:"Given a name and three pieces, guess which one is not from the said artist.",terminate:CO},DO,e);var t=document.getElementById("galleryMainWindow");t.innerHTML="",e.forEach((function(e){return t.append(e)}))}function mD(e){return mD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mD(e)}function vD(e,t,n){return t=yD(t),function(e,t){if(t&&("object"===mD(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return bD(e)}(e,gD()?Reflect.construct(t,n||[],yD(e).constructor):t.apply(e,n))}function gD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gD=function(){return!!e})()}function yD(e){return yD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yD(e)}function bD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xD(e,t){return xD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xD(e,t)}setTimeout((function(){rI(dD.bludgeball,fD,hD,1),rI(dD.guessgame,pD,hD,1)}),2e3),(0,xx.gql)($O||($O=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  query Articles(\n    $filters: ArticleFilter\n    $sort: ArticleSortInput\n    $skip: Int\n    $take: Int\n  ) {\n    articles(filters: $filters, sort: $sort, skip: $skip, take: $take) {\n      ...ArticleInfos\n      __typename\n    }\n  }\n\n  fragment ArticleInfos on Article {\n    id\n    createdAt\n    slug\n    title\n    flag\n    metadata\n    description\n    tags\n    thumbnailUri\n    thumbnailMedia {\n      ...MediaImage\n      __typename\n    }\n    metadataLocked\n    author {\n      ...UserBadgeInfos\n      __typename\n    }\n    __typename\n  }\n\n  fragment MediaImage on MediaImage {\n    cid\n    width\n    height\n    placeholder\n    mimeType\n    metadata\n    processed\n    __typename\n  }\n\n  fragment UserBadgeInfos on User {\n    id\n    type\n    name\n    avatarUri\n    avatarMedia {\n      ...MediaImage\n      __typename\n    }\n    flag\n    __typename\n  }\n"])));var wD={type:"change"},_D={type:"start"},ED={type:"end"},TD=new Al,SD=new Ac,MD=Math.cos(70*ys.DEG2RAD),AD=function(e){function t(e,n){var r,i,a,o,s,l,u,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=vD(this,t)).object=e,r.domElement=n,r.domElement.style.touchAction="none",r.enabled=!0,r.target=new Qs,r.cursor=new Qs,r.minDistance=0,r.maxDistance=1/0,r.minZoom=0,r.maxZoom=1/0,r.minTargetRadius=0,r.maxTargetRadius=1/0,r.minPolarAngle=0,r.maxPolarAngle=Math.PI,r.minAzimuthAngle=-1/0,r.maxAzimuthAngle=1/0,r.enableDamping=!1,r.dampingFactor=.05,r.enableZoom=!0,r.zoomSpeed=1,r.enableRotate=!0,r.rotateSpeed=1,r.enablePan=!0,r.panSpeed=1,r.screenSpacePanning=!0,r.keyPanSpeed=7,r.zoomToCursor=!1,r.autoRotate=!1,r.autoRotateSpeed=2,r.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},r.mouseButtons={LEFT:xr.ROTATE,MIDDLE:xr.DOLLY,RIGHT:xr.PAN},r.touches={ONE:wr.ROTATE,TWO:wr.DOLLY_PAN},r.target0=r.target.clone(),r.position0=r.object.position.clone(),r.zoom0=r.object.zoom,r._domElementKeyEvents=null,r.getPolarAngle=function(){return m.phi},r.getAzimuthalAngle=function(){return m.theta},r.getDistance=function(){return this.object.position.distanceTo(this.target)},r.listenToKeyEvents=function(e){e.addEventListener("keydown",ne),this._domElementKeyEvents=e},r.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ne),this._domElementKeyEvents=null},r.saveState=function(){h.target0.copy(h.target),h.position0.copy(h.object.position),h.zoom0=h.object.zoom},r.reset=function(){h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.zoom=h.zoom0,h.object.updateProjectionMatrix(),h.dispatchEvent(wD),h.update(),f=d.NONE},r.update=(i=new Qs,a=(new Zs).setFromUnitVectors(e.up,new Qs(0,1,0)),o=a.clone().invert(),s=new Qs,l=new Zs,u=new Qs,c=2*Math.PI,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=h.object.position;i.copy(n).sub(h.target),i.applyQuaternion(a),m.setFromVector3(i),h.autoRotate&&f===d.NONE&&O(function(e){return null!==e?2*Math.PI/60*h.autoRotateSpeed*e:2*Math.PI/60/60*h.autoRotateSpeed}(t)),h.enableDamping?(m.theta+=v.theta*h.dampingFactor,m.phi+=v.phi*h.dampingFactor):(m.theta+=v.theta,m.phi+=v.phi);var r=h.minAzimuthAngle,b=h.maxAzimuthAngle;isFinite(r)&&isFinite(b)&&(r<-Math.PI?r+=c:r>Math.PI&&(r-=c),b<-Math.PI?b+=c:b>Math.PI&&(b-=c),m.theta=r<=b?Math.max(r,Math.min(b,m.theta)):m.theta>(r+b)/2?Math.max(r,m.theta):Math.min(b,m.theta)),m.phi=Math.max(h.minPolarAngle,Math.min(h.maxPolarAngle,m.phi)),m.makeSafe(),!0===h.enableDamping?h.target.addScaledVector(y,h.dampingFactor):h.target.add(y),h.target.sub(h.cursor),h.target.clampLength(h.minTargetRadius,h.maxTargetRadius),h.target.add(h.cursor),h.zoomToCursor&&R||h.object.isOrthographicCamera?m.radius=G(m.radius):m.radius=G(m.radius*g),i.setFromSpherical(m),i.applyQuaternion(o),n.copy(h.target).add(i),h.object.lookAt(h.target),!0===h.enableDamping?(v.theta*=1-h.dampingFactor,v.phi*=1-h.dampingFactor,y.multiplyScalar(1-h.dampingFactor)):(v.set(0,0,0),y.set(0,0,0));var x=!1;if(h.zoomToCursor&&R){var w=null;if(h.object.isPerspectiveCamera){var _=i.length(),E=_-(w=G(_*g));h.object.position.addScaledVector(k,E),h.object.updateMatrixWorld()}else if(h.object.isOrthographicCamera){var T=new Qs(P.x,P.y,0);T.unproject(h.object),h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/g)),h.object.updateProjectionMatrix(),x=!0;var S=new Qs(P.x,P.y,0);S.unproject(h.object),h.object.position.sub(S).add(T),h.object.updateMatrixWorld(),w=i.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),h.zoomToCursor=!1;null!==w&&(this.screenSpacePanning?h.target.set(0,0,-1).transformDirection(h.object.matrix).multiplyScalar(w).add(h.object.position):(TD.origin.copy(h.object.position),TD.direction.set(0,0,-1).transformDirection(h.object.matrix),Math.abs(h.object.up.dot(TD.direction))<MD?e.lookAt(h.target):(SD.setFromNormalAndCoplanarPoint(h.object.up,h.target),TD.intersectPlane(SD,h.target))))}else h.object.isOrthographicCamera&&(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/g)),h.object.updateProjectionMatrix(),x=!0);return g=1,R=!1,!!(x||s.distanceToSquared(h.object.position)>p||8*(1-l.dot(h.object.quaternion))>p||u.distanceToSquared(h.target)>0)&&(h.dispatchEvent(wD),s.copy(h.object.position),l.copy(h.object.quaternion),u.copy(h.target),!0)}),r.dispose=function(){h.domElement.removeEventListener("contextmenu",re),h.domElement.removeEventListener("pointerdown",Q),h.domElement.removeEventListener("pointercancel",ee),h.domElement.removeEventListener("wheel",te),h.domElement.removeEventListener("pointermove",$),h.domElement.removeEventListener("pointerup",ee),null!==h._domElementKeyEvents&&(h._domElementKeyEvents.removeEventListener("keydown",ne),h._domElementKeyEvents=null)};var h=bD(r),d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=d.NONE,p=1e-6,m=new Sy,v=new Sy,g=1,y=new Qs,b=new bs,x=new bs,w=new bs,_=new bs,E=new bs,T=new bs,S=new bs,M=new bs,A=new bs,k=new Qs,P=new bs,R=!1,C=[],L={};function I(e){var t=Math.abs(e)/(100*(0|window.devicePixelRatio));return Math.pow(.95,h.zoomSpeed*t)}function O(e){v.theta-=e}function D(e){v.phi-=e}var N,B=(N=new Qs,function(e,t){N.setFromMatrixColumn(t,0),N.multiplyScalar(-e),y.add(N)}),U=function(){var e=new Qs;return function(t,n){!0===h.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(h.object.up,e)),e.multiplyScalar(t),y.add(e)}}(),z=function(){var e=new Qs;return function(t,n){var r=h.domElement;if(h.object.isPerspectiveCamera){var i=h.object.position;e.copy(i).sub(h.target);var a=e.length();a*=Math.tan(h.object.fov/2*Math.PI/180),B(2*t*a/r.clientHeight,h.object.matrix),U(2*n*a/r.clientHeight,h.object.matrix)}else h.object.isOrthographicCamera?(B(t*(h.object.right-h.object.left)/h.object.zoom/r.clientWidth,h.object.matrix),U(n*(h.object.top-h.object.bottom)/h.object.zoom/r.clientHeight,h.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),h.enablePan=!1)}}();function F(e){h.object.isPerspectiveCamera||h.object.isOrthographicCamera?g/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function H(e){h.object.isPerspectiveCamera||h.object.isOrthographicCamera?g*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function j(e,t){if(h.zoomToCursor){R=!0;var n=h.domElement.getBoundingClientRect(),r=e-n.left,i=t-n.top,a=n.width,o=n.height;P.x=r/a*2-1,P.y=-i/o*2+1,k.set(P.x,P.y,1).unproject(h.object).sub(h.object.position).normalize()}}function G(e){return Math.max(h.minDistance,Math.min(h.maxDistance,e))}function V(e){b.set(e.clientX,e.clientY)}function W(e){_.set(e.clientX,e.clientY)}function q(e){if(1===C.length)b.set(e.pageX,e.pageY);else{var t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);b.set(n,r)}}function X(e){if(1===C.length)_.set(e.pageX,e.pageY);else{var t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);_.set(n,r)}}function Y(e){var t=ae(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);S.set(0,i)}function K(e){if(1==C.length)x.set(e.pageX,e.pageY);else{var t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);x.set(n,r)}w.subVectors(x,b).multiplyScalar(h.rotateSpeed);var i=h.domElement;O(2*Math.PI*w.x/i.clientHeight),D(2*Math.PI*w.y/i.clientHeight),b.copy(x)}function J(e){if(1===C.length)E.set(e.pageX,e.pageY);else{var t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);E.set(n,r)}T.subVectors(E,_).multiplyScalar(h.panSpeed),z(T.x,T.y),_.copy(E)}function Z(e){var t=ae(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);M.set(0,i),A.set(0,Math.pow(M.y/S.y,h.zoomSpeed)),F(A.y),S.copy(M),j(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}function Q(e){!1!==h.enabled&&(0===C.length&&(h.domElement.setPointerCapture(e.pointerId),h.domElement.addEventListener("pointermove",$),h.domElement.addEventListener("pointerup",ee)),function(e){C.push(e.pointerId)}(e),"touch"===e.pointerType?function(e){switch(ie(e),C.length){case 1:switch(h.touches.ONE){case wr.ROTATE:if(!1===h.enableRotate)return;q(e),f=d.TOUCH_ROTATE;break;case wr.PAN:if(!1===h.enablePan)return;X(e),f=d.TOUCH_PAN;break;default:f=d.NONE}break;case 2:switch(h.touches.TWO){case wr.DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&Y(e),h.enablePan&&X(e)}(e),f=d.TOUCH_DOLLY_PAN;break;case wr.DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&Y(e),h.enableRotate&&q(e)}(e),f=d.TOUCH_DOLLY_ROTATE;break;default:f=d.NONE}break;default:f=d.NONE}f!==d.NONE&&h.dispatchEvent(_D)}(e):function(e){var t;switch(e.button){case 0:t=h.mouseButtons.LEFT;break;case 1:t=h.mouseButtons.MIDDLE;break;case 2:t=h.mouseButtons.RIGHT;break;default:t=-1}switch(t){case xr.DOLLY:if(!1===h.enableZoom)return;!function(e){j(e.clientX,e.clientX),S.set(e.clientX,e.clientY)}(e),f=d.DOLLY;break;case xr.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enablePan)return;W(e),f=d.PAN}else{if(!1===h.enableRotate)return;V(e),f=d.ROTATE}break;case xr.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enableRotate)return;V(e),f=d.ROTATE}else{if(!1===h.enablePan)return;W(e),f=d.PAN}break;default:f=d.NONE}f!==d.NONE&&h.dispatchEvent(_D)}(e))}function $(e){!1!==h.enabled&&("touch"===e.pointerType?function(e){switch(ie(e),f){case d.TOUCH_ROTATE:if(!1===h.enableRotate)return;K(e),h.update();break;case d.TOUCH_PAN:if(!1===h.enablePan)return;J(e),h.update();break;case d.TOUCH_DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&Z(e),h.enablePan&&J(e)}(e),h.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&Z(e),h.enableRotate&&K(e)}(e),h.update();break;default:f=d.NONE}}(e):function(e){switch(f){case d.ROTATE:if(!1===h.enableRotate)return;!function(e){x.set(e.clientX,e.clientY),w.subVectors(x,b).multiplyScalar(h.rotateSpeed);var t=h.domElement;O(2*Math.PI*w.x/t.clientHeight),D(2*Math.PI*w.y/t.clientHeight),b.copy(x),h.update()}(e);break;case d.DOLLY:if(!1===h.enableZoom)return;!function(e){M.set(e.clientX,e.clientY),A.subVectors(M,S),A.y>0?F(I(A.y)):A.y<0&&H(I(A.y)),S.copy(M),h.update()}(e);break;case d.PAN:if(!1===h.enablePan)return;!function(e){E.set(e.clientX,e.clientY),T.subVectors(E,_).multiplyScalar(h.panSpeed),z(T.x,T.y),_.copy(E),h.update()}(e)}}(e))}function ee(e){!function(e){delete L[e.pointerId];for(var t=0;t<C.length;t++)if(C[t]==e.pointerId)return void C.splice(t,1)}(e),0===C.length&&(h.domElement.releasePointerCapture(e.pointerId),h.domElement.removeEventListener("pointermove",$),h.domElement.removeEventListener("pointerup",ee)),h.dispatchEvent(ED),f=d.NONE}function te(e){!1!==h.enabled&&!1!==h.enableZoom&&f===d.NONE&&(e.preventDefault(),h.dispatchEvent(_D),function(e){j(e.clientX,e.clientY),e.deltaY<0?H(I(e.deltaY)):e.deltaY>0&&F(I(e.deltaY)),h.update()}(e),h.dispatchEvent(ED))}function ne(e){!1!==h.enabled&&!1!==h.enablePan&&function(e){var t=!1;switch(e.code){case h.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?D(2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):z(0,h.keyPanSpeed),t=!0;break;case h.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?D(-2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):z(0,-h.keyPanSpeed),t=!0;break;case h.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?O(2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):z(h.keyPanSpeed,0),t=!0;break;case h.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?O(-2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):z(-h.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),h.update())}(e)}function re(e){!1!==h.enabled&&e.preventDefault()}function ie(e){var t=L[e.pointerId];void 0===t&&(t=new bs,L[e.pointerId]=t),t.set(e.pageX,e.pageY)}function ae(e){var t=e.pointerId===C[0]?C[1]:C[0];return L[t]}return h.domElement.addEventListener("contextmenu",re),h.domElement.addEventListener("pointerdown",Q),h.domElement.addEventListener("pointercancel",ee),h.domElement.addEventListener("wheel",te,{passive:!1}),r.update(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xD(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(as);function kD(e,t,n){if(PD())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&RD(i,n.prototype),i}function PD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(PD=function(){return!!e})()}function RD(e,t){return RD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},RD(e,t)}function CD(e){return function(e){if(Array.isArray(e))return LD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return LD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LD(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ID={BoxGeometry:[{width:1},{height:1},{depth:1}],PlaneGeometry:[{width:1},{height:1}],CapsuleGeometry:[{radius:1},{length:1},{capSegments:6},{radialSegments:12}],CircleGeometry:[{radius:1},{segments:32},{thetaStart:0},{thetaLength:2*Math.PI}],ConeGeometry:[{radius:1},{height:2},{radialSegments:12},{heightSegments:4},{openEnded:0},{thetaStart:0},{thetaLength:2*Math.PI}],CylinderGeometry:[{radiusTop:1},{radiusBottom:1},{height:2},{radialSegments:16},{heightSegments:3},{openEnded:0},{thetaStart:0},{thetaLength:2*Math.PI}],DodecahedronGeometry:[{radius:1},{detail:3}],RingGeometry:[{innerRadius:1},{outerRadius:3},{thetaSegments:16},{phiSegments:16},{thetaStart:0},{thetaLength:2*Math.PI}],SphereGeometry:[{radius:1},{widthSegments:16},{heightSegments:32},{phiStart:0},{phiLength:2*Math.PI},{thetaStart:0},{thetaLength:2*Math.PI}],TorusGeometry:[{radius:2},{tube:.2},{radialSegments:16},{tubularSegments:8},{arc:2*Math.PI}]},OD=0,DD={},ND=0,BD=function t(n){if(OD){OD.clear();var r=[];ID[n].forEach((function(e){var t=Object.keys(e)[0],i=e[t];DD.hasOwnProperty(n)&&DD[n].hasOwnProperty(t)&&(i=DD[n][t]),r.push(i)}));var i=kD(e[n],r),a=OF.whiteFull,o=new Cm(i),s=new Bp(o,OF.blackLineLone),l=new cc(i,a);if(l.position.set(0,0,0),s.position.set(0,0,0),OD.add(l,s),n!=ND){var u=document.getElementById("previewSliderContainer");u.innerHTML="",ID[n].forEach((function(e){var r=Object.keys(e)[0],i=document.createElement("label");i.innerText=r,i.for=n+r;var a=document.createElement("input");a.type="range",a.name=n+r,a.style="width:200px",a.value=l.geometry.parameters[r],a.min=0,a.max=30,a.step=.001,a.addEventListener("input",(function(){DD.hasOwnProperty(n)||(DD[n]={}),DD[n][r]=a.value,t(n)})),u.append(i,a)})),ND=n;var c=document.createElement("button");c.innerText="Create Mesh",c.addEventListener("click",(function(){for(var t,r,i={geometry:{type:n,args:[]}},a=0;a<u.children.length;a++)"range"===u.children[a].type&&i.geometry.args.push(u.children[a].value);t=[i],(r=new lf).position.y+=.5,r.position.z-=4,t.forEach((function(t){var n=kD(e[t.geometry.type],CD(t.geometry.args)),i=new cc(n,OF.ghost),a=new Cm(n),o=new Bp(a,OF.blackLineLone);t.tokenType="block",r.userData=t,r.userData.tokenType="block",r.add(i,o)})),BU(r),cG.add(r),Tj()})),u.append(c)}}},UD=window.localStorage;UD.getItem("favoriteNativeIterations")||UD.setItem("favoriteNativeIterations","{}");var zD,FD=function(e,t,n){var r=document.createElement("div");r.id="iterationMenu";var i=document.getElementById("tokens");e.hasOwnProperty("personal")?r.style.animation="personalIterationSlideLeft .15s linear forwards":r.style.animation="iterationSlideLeft .15s linear forwards";var a=document.createElement("div");a.id="iterationClose",a.innerText="close",a.addEventListener("click",(function(){return HD()}));var o=new Image;o.loading="lazy",o.className="thumbnail",o.setAttribute("data-src","/loading.gif"),o.setAttribute("draggable","false"),o.style.imageRendering="auto",o.setAttribute("data-src","/loading.gif"),o.onerror=function(e){return o.src="/notfound.png"},o.src=t,o.style="cursor:pointer;margin:unset";var s=document.createElement("div");if(s.style="    \n  width: 100%;\n  height: calc(100% - 40px);\n  margin-top: 35px;\n  overflow-y: auto;\n  display: inline-flex;\n  flex-direction: column;\n  flex-wrap: nowrap;\n  align-items: center;",e.hasOwnProperty("name")){var l=document.createElement("div");l.innerText=e.name,l.style="\n    padding: 2%;\n    width: 90%;\n    margin-bottom: 10px;\n    background: red;\n    color: white;\n    text-align: center;\n    border-radius: 5px;\n    ",s.append(l)}switch(s.append(o),e.gentk.type){case"sprite":var u=GD("Select Mask"),c=function(){var t=e.chain+"/"+e.contract+"/"+e.token_id;eB(t),rB(),Tj(),tI()};u.addEventListener("click",c),o.addEventListener("click",c),s.append(u);break;case"skybox":(h=GD("Load in Anaverse")).addEventListener("click",n),o.addEventListener("click",n),s.append(h);break;case"world":var h;(h=GD("Load in Anaverse")).addEventListener("click",n),o.addEventListener("click",n),s.append(h);var d="https://anaver.se/?loadroom=".concat(e.chain,"/").concat(e.contract,"/").concat(e.token_id),f=GD("Copy access link");f.addEventListener("click",(function(){f.innerText="Copied!",navigator.clipboard.writeText(d),setTimeout((function(){return f.innerText="Copy access link"}),1300)}));var p=GD("Display QR code");p.addEventListener("click",(function(){return kL(d)})),s.append(f,p)}var m=GD("Add to favorites");if(JSON.parse(UD.getItem("favoriteNativeIterations")).hasOwnProperty(e.contract+e.token_id)&&(m.innerText="Remove from favorites"),m.addEventListener("click",(function(){var t=JSON.parse(UD.getItem("favoriteNativeIterations")),n=e.contract+e.token_id,r=document.getElementById("artNameBand"+n);t.hasOwnProperty(n)?(delete t[n],m.innerText="Add to favorites",r.style=""):(t[n]=!0,r.style="background:red;color:white;",m.innerText="Remove from favorites"),UD.setItem("favoriteNativeIterations",JSON.stringify(t))})),s.append(m),nB()&&"world"===e.gentk.type){var v=GD("Send to chat");v.addEventListener("click",(function(){YN(e,"location"),Tj()})),s.append(v)}switch(e.chain){case"tezos":if(e.hasOwnProperty("holder")){var g=document.createElement("div");g.style="\n          display:flex;\n          width: 90%;\n          margin-top:15px;\n          font-size: 10px;\n          border:1px solid red;\n          border-radius:5px;\n          padding:5px";var y=document.createElement("div"),b=document.createElement("div");b.style="margin-right: 10px;";var x=GD("Inspect on objkt.com");if(x.addEventListener("click",(function(){return window.open(e.url,"_blank")})),s.append(x),e.holder.logo){var w=document.createElement("img");w.className="profilePic",w.setAttribute("draggable","false"),w.loading="lazy",w.setAttribute("data-src","/loading.gif"),w.src=e.holder.logo,w.onerror=function(){return w.remove()},b.append(w),g.append(b)}y.innerHTML='<strong>Current holder information</strong><br>\n      <strong>Address:</strong> <a style="word-break: break-all;" href="https://objkt.com/users/'.concat(e.holder.address,'/owned" target="_blank">').concat(e.holder.address,"</a>"),e.holder.alias&&(y.innerHTML+="<br><strong>Alias:</strong> ".concat(e.holder.alias)),e.holder.twitter&&(y.innerHTML+='<br><strong>Twitter:</strong> <a href="'.concat(e.holder.twitter,'" target="_blank">@').concat(e.holder.twitter.replace("https://twitter.com/",""),"</a>")),g.append(y),s.append(g);var _=e.hasOwnProperty("token")?e.token.attributes:e.attributes;if(_.length>0){var E=document.createElement("div");E.style="\n          width: 90%;\n          padding:2%;\n          margin-top:15px;\n          font-size: 10px;\n          border:1px solid red;\n          word-break: break-all;\n          border-radius: 5px;",_.forEach((function(e){var t=document.createElement("div");t.innerHTML="<strong>".concat(e.attribute.name,"</strong><br> ").concat(e.attribute.value),E.append(t)})),s.append(E)}}break;case"ethereum":var T=GD("Inspect on highlight.xyz");if(T.addEventListener("click",(function(){return window.open(e.url,"_blank")})),s.append(T),e.hasOwnProperty("attributes")&&e.attributes.length>0){var S=document.createElement("div");S.style="\n          width: 90%;\n          padding:2%;\n          margin-top:15px;\n          font-size: 10px;\n          border:1px solid red;\n          word-break: break-all;\n          border-radius: 5px;",e.attributes.forEach((function(e){var t=document.createElement("div");t.innerHTML="<strong>".concat(e.name,"</strong><br> ").concat(e.value),S.append(t)})),s.append(S)}}(Gn<=6||Gn>=20)&&(r.style.backgroundColor="rgba(0,0,0,0.6)"),r.append(a,s),i.append(r),zD=e},HD=function(){var e=document.getElementById("iterationMenu");e&&(e.style.animation="iterationSlideRight .15s linear forwards",setTimeout((function(){e.innerHTML="",e.remove()}),200))},jD=function(e,t,n){document.getElementById("iterationMenu")?(HD(),e!=zD&&setTimeout((function(){FD(e,t,n)}),250)):FD(e,t,n)},GD=function(e){var t=document.createElement("div");return t.className="iterationPanelButton",t.innerText=e,t};function VD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var WD=window.localStorage,qD="Loaded collection",XD=0,YD=document.createElement("div");YD.id="galleryLeftMenu",YD.style.borderRight="1px solid black";var KD=document.createElement("div");KD.id="galleryMainWindow",KD.style.overflow="hidden auto";var JD,ZD,QD,$D,eN={IIIF:{},"Loaded collection":{},"Loaded creations":{},"Contract import":{},"Objkt Curated":{},Seminars:{},"Public galleries":{},"Local galleries":{},"Gallery builder":{},Construction:{},Multiuser:{},"Data visualisation":{},"Mini games":{}},tN=function(){var e=document.getElementById("tokens");e.innerHTML="",e.style="overflow:hidden hidden;display:grid;justify-content: left;grid-template-columns: 200px 2fr;width:100%",e.append(YD,KD),cj&&(YD.style.left="-300px",YD.style.animation="0.2s linear 0s 1 normal forwards running loaderSlideRight",KD.style.top="100%",KD.style.animation="0.2s linear 0s 1 normal forwards running loaderSlideTop"),XD||oN(),nN();var t="";(Gn<=6||Gn>=20)&&(t='style="background-color:#313131;color:white;"'),KD.innerHTML="<div ".concat(t,' class="helperPanel">').concat(gj[qD],"</div>"),KD.appendChild(eN[qD].DOM.content)},nN=function(){eN["Gallery builder"].DOM.content=iN(),eN["Local galleries"].DOM.content=rN();var e=document.createElement("div");e.style="display:grid;position:relative;grid-template-columns: 50% 50%;width:200%;height:100%";var t=document.createElement("div");t.id="list",t.className="artistList";var n=document.createElement("div");for(var r in n.id="collection",(Gn<=6||Gn>=20)&&(n.style.color="white"),AU)t.append(AU[r]);e.append(t,n),eN["Loaded collection"].DOM.content=e,setTimeout((function(){document.getElementById("forceLoadCollection")&&document.getElementById("forceLoadCollection").addEventListener("click",(function(){AO(VH||"tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9",500,500),Tj(),oI("LOADING COLLECTION",2e3)}))}),500)},rN=function(){var e=document.createElement("div");e.className="artistList";var t=JSON.parse(WD.getItem("localGalleries"));return t&&t.length>0&&t.forEach((function(t){t.chain="tezos",e.appendChild(aH(t,"loadLocalGallery"))})),e},iN=function(){var e=document.createElement("div");e.id="galleryBuilder",e.innerHTML="",(Gn>=20||Gn<=6)&&(e.style.color="white");var t=document.createElement("div");WU.room.name&&(t.innerHTML='\n<div id="galleryCreator">\n<div id="galleryCreatorForm">\n \n  <div id="galleryMetaData">\n  <b>Save your current gallery</b><br>\n  <br>Room ID: '.concat(WU.room.name,"\n  <br>Skybox ID: ").concat(WU.skybox.name,"\n  <br>Number of pieces: ").concat(uG.children.length,"\n  </div>\n  \n</div>\n</div><br>"));var n=document.createElement("input"),r=document.createElement("div");uG.children.length>0&&Object.keys(WU.room).length>0&&Object.keys(WU.skybox).length>0?(r.id="saveGallery",r.innerText="Save Gallery",r.addEventListener("click",SU),n.type="text",n.placeholder="Enter a gallery name",n.required=!0,n.minlength=4,n.maxlength=40,n.id="galleryName",n.addEventListener("focusin",(function(){return Dj(1)})),n.addEventListener("focusout",(function(){return Dj(0)})),t.appendChild(n)):(r.id="saveGallery",r.innerHTML="<span>Choose an indexed room <br> and an indexed skybox to <br> get started.</span>"),t.appendChild(r);var i=document.createElement("div");i.style="padding: 5%; border: 1px dashed cyan;margin:2%;";var a=document.createElement("button");a.innerText="Use current position as starting point",a.addEventListener("click",SG);var o=document.createElement("div");o.id="currentStartingPointDiv",o.innerText="Current starting point:"+JSON.stringify(WU.startPoint),i.append(a,o);var s=document.createElement("div");uG.children.forEach((function(e){if(MU.hasOwnProperty(e.userData.id)){var t=document.createElement("div");t.style="margin:10px;border:1px dashed cyan;padding:5px;";var n=document.createElement("div");n.style="display:flex;justify-content:space-between;";var r=MU[e.userData.id],i=new Image;i.style="max-width:100px;max-height:100px",i.src=r.img,n.append(i);var a=document.createElement("div"),o=document.createElement("button");o.innerText="remove",o.style="height:30px;margin-left: 5px;",o.addEventListener("click",(function(){uG.children.forEach((function(t){e.userData.id===t.userData.id&&(uG.remove(t),bP(),n.remove())}))})),a.style="display:flex;align-items: center;";var l=["x","y","z"];if(["position","rotation","scale"].forEach((function(t){var n=document.createElement("div");n.style.marginLeft="15px";var r=document.createElement("div");r.innerText=t,n.append(r),l.forEach((function(r){var i=document.createElement("div"),a=document.createElement("div");a.innerText=r,a.style.padding="3px";var o=document.createElement("input");o.style.width="60px",o.type="number",o.value=e[t][r],o.step=.01,o.addEventListener("change",(function(){return e[t][r]=o.value})),i.style.display="flex",i.append(a,o),n.append(i)})),a.append(n)})),a.append(o),n.append(a),t.append(n),s.append(t),e.userData.hasOwnProperty("note")){var u=document.createElement("div"),c=document.createElement("textarea");c.style="width: calc(100% - 20px);margin: 5px;",c.value=e.userData.note,c.addEventListener("focusin",(function(){return Dj(1)})),c.addEventListener("focusout",(function(){return Dj(0)})),c.addEventListener("change",(function(){e.userData.note=c.value,r.note=c.value})),u.append(c),t.append(u)}}})),t.style="padding:5%;border:1px dashed cyan;",e.append(t,i,s);var l=document.createElement("div"),u=document.createElement("div");u.innerHTML="<b>Import a gallery.json file<br> from your local device.</b><br></br>";var c=document.createElement("input");return c.style.border="1px dashed cyan",c.style.padding="10px",c.style.margin="10px",c.style.backgroundColor="white",c.type="file",c.addEventListener("change",(function(e){KL.postMessage({type:"local",path:e.target.files[0]}),Tj(),oI("GALLERY LOADED",2e3)})),e.addEventListener("dragover",(function(e){return e.preventDefault()})),e.addEventListener("drop",(function(e){var t;e.preventDefault(),e.dataTransfer.items&&((t=e.dataTransfer.items,function(e){if(Array.isArray(e))return VD(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return VD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VD(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach((function(e,t){if("file"===e.kind){var n=e.getAsFile();KL.postMessage({type:"local",path:n})}})),Tj(),oI("GALLERY LOADED",2e3))})),l.appendChild(u),l.appendChild(c),l.style="padding:5%;border:1px dashed cyan;margin-top:50px",e.appendChild(l),e},aN=function(){var e=document.createElement("div");e.style="display:flex;margin:10px;";var t=document.createElement("div");t.style="width:140px;border: 1px solid black;border-radius: 5px;padding: 10px;",Object.keys(ID).forEach((function(e){var n=document.createElement("div");n.className="geomTab",n.innerText=e.replace("Geometry",""),t.append(n),n.addEventListener("click",(function(){BD(e)}))}));var n=document.createElement("div");return n.style="margin-left:20px;width:500px;height:500px",n.append(function(){var e=document.createElement("div"),t=new pf({antialias:0,alpha:!0});t.domElement.style="width:500px;height:500px;border: 2px solid red; border-radius:5px;cursor:all-scroll;\n  background: repeating-linear-gradient(45deg, rgba(255, 0, 0,0.5), rgba(255, 0, 0,0.5) 4px, rgb(255, 255, 255) 4px, rgb(255, 255, 255) 10px);\n  ",t.domElement.id="rendererPreview",OD=new bf,t.setClearColor(0,0),t.setSize(500,500),t.setPixelRatio(1);var n=new bc(60,1,.1,200);n.position.set(5,5,5),n.updateProjectionMatrix(),n.lookAt(0,0,0);var r=new AD(n,t.domElement);!function e(){r.update(),t.render(OD,n),requestAnimationFrame(e)}();var i=document.createElement("div");return i.id="previewSliderContainer",e.style="display: flex;",e.append(t.domElement,i),e}()),e.append(t,n),e},oN=function(){var e,t;(Gn<=6||Gn>=20)&&(YD.style.color="white"),function(){var e=function(e){eN[e].DOM={},eN[e].DOM.title=document.createElement("div"),eN[e].DOM.content=document.createElement("div");var t=document.createElement("div");t.innerText=e,t.id=e,t.className="gallerieMenuButton",t.addEventListener("click",(function(){HD(),qD=e;for(var n=document.getElementsByClassName("gallerieMenuButton"),r=0;r<n.length;r++)n[r].style.backgroundColor="transparent",n[r].style.color="black",(Gn<=6||Gn>=20)&&(n[r].style.color="white");t.style.backgroundColor="rgba(0,0,0,.8)",t.style.color="white";var i="";(Gn<=6||Gn>=20)&&(i='style="background-color:#313131;color:white;"'),KD.innerHTML="<div ".concat(i,' class="helperPanel">').concat(gj[e],"</div>"),KD.appendChild(eN[e].DOM.content)})),YD.appendChild(t)};for(var t in eN)e(t)}(),eN.IIIF.DOM.content=VF(),eN["Contract import"].DOM.content=function(){var e=document.createElement("div"),t=document.createElement("ul");function n(e,n){var r=document.createElement("li");r.style="list-style-type:none;\n  padding:5px;    \n  margin-top: 15px;\n  display: flex;\n  flex-direction: column;\n  border: 1px solid gray;\n  background: rgba(50,50,50,0.1);\n  border-radius: 4px;";var i=document.createElement("input");i.type="text",i.placeholder=n,i.addEventListener("focusin",(function(){return Dj(1)})),i.addEventListener("focusout",(function(){return Dj(0)})),[].push(i),r.append(i);var a=document.createElement("button");a.innerText="Load ".concat(e," indexed asset"),a.addEventListener("click",(function(){return jN({native:!1,blockchain:e.toLowerCase(),id:i.value})})),r.append(a),t.append(r)}t.style="padding:10px;",n("Tezos","contract/id"),n("Solana","contract");var r=document.createElement("div");r.className="artistList",r.id="importedContractContent";var i=document.createElement("div"),a=JSON.parse(WD.getItem("importedContracts"));if(a){var o=function(e){var t=document.createElement("div");t.id=e,t.style="border:1px solid gray;padding:5px;margin:5px;background:white;display: flex;justify-content: space-between;";var n=a[e],r=document.createElement("div");r.innerText="".concat(n.name," - ").concat(n.type),r.style="font-size:12px;cursor:pointer;font-family: monospace;",r.addEventListener("click",(function(){r.innerText="Loading ".concat(n.name,""),jN(asset)}));var o=document.createElement("div");o.innerText="x",o.style="font-size:10px; padding:2px;cursor:pointer;font-family: monospace;border:1px solid black",o.addEventListener("click",(function(){t.remove(),delete a[e],WD.setItem("importedContracts",JSON.stringify(a))})),t.append(r,o),i.append(t)};for(var s in a)o(s)}return e.append(t,i,r),e}(),eN["Loaded creations"].DOM.content=function(){var e=document.createElement("div");if(AH.length>0){e.style="display:grid;position:relative;grid-template-columns: 50% 50%;width:200%";var t=document.createElement("div");t.id="list",t.className="artistList";var n=document.createElement("div");return n.id="collection",(Gn<=6||Gn>=20)&&(n.style.color="white"),AH.forEach((function(e){return t.appendChild(e)})),e.append(t,n),e}document.getElementById("Loaded creations").style.display="none"}(),eN["Loaded collection"].DOM.content=function(){var e=document.createElement("div");e.style="display:grid;position:relative;grid-template-columns: 50% 50%;width:200%;height:100%";var t=document.createElement("div");t.id="list";var n=document.createElement("div");for(var r in n.id="collection",t.className="artistList",(Gn<=6||Gn>=20)&&(n.style.color="white"),AU)t.appendChild(AU[r]);return e.append(t,n),e}(),eN["Objkt Curated"].DOM.content=function(){document.createElement("div").className="artistList";var e=document.createElement("div");e.className="artistList",e.style="display:flex;flex-direction: column;";var t=document.createElement("div");t.style.padding="20px";var n=document.createElement("input");n.placehoder="Objkt gallery search",n.className="gloaderTextInput",n.addEventListener("focusin",(function(){return Dj(1)})),n.addEventListener("focusout",(function(){return Dj(0)}));var r=document.createElement("div");r.className="artistList",r.id="objktCuratedDisplay",hN.forEach((function(e){return r.append(e)}));var i=document.createElement("button");return i.innerText="Search",i.addEventListener("click",(function(){return fN(n.value)})),t.append(n,i),e.append(t,r),e}(),eN.Seminars.DOM.content=RL,eN.Construction.DOM.content=aN(),eN["Local galleries"].DOM.content=rN(),eN["Gallery builder"].DOM.content=iN(),eN["Public galleries"].DOM.content=function(){var e=document.createElement("div");e.style="display: grid; position: relative; grid-template-columns: 50% 50%; width: 200%; height: 100%;";var t=document.createElement("div");t.id="collection",t.style="overflow-y:scroll;";var n=document.createElement("div");return n.className="artistList",n.id="galleryCuratorList",n.style="overflow-y:scroll",e.append(n,t),WL.forEach((function(e){return n.append(e)})),e}(),eN.Multiuser.DOM.content=function(){var e=document.createElement("div"),t=document.createElement("div");t.style="padding:15px";var n=document.createElement("div");n.style="padding:15px";var r=document.createElement("img"),i=$N.spriteID.split("/");r.src="https://assets.objkt.media/file/assets-003/".concat(i[1],"/").concat(i[2],"/thumb288"),r.style="max-width:70px;padding:15px;margin-left:15px;";var a=document.createElement("input");a.id="chatserver",a.name="chatserver",a.value=$N.server,a.setAttribute("list","chatserverlist"),a.addEventListener("focusin",(function(){return Dj(1)})),a.addEventListener("focusout",(function(){return Dj(0)}));var o=document.createElement("datalist");o.id="chatserverlist",o.innerHTML='\n<option value="https://mux.anaver.se/"></option>\n<option value="http://localhost:3000/"></option>\n';var s=document.createElement("input");s.value=$N.name,s.minlength=4,s.addEventListener("focusin",(function(){return Dj(1)})),s.addEventListener("focusout",(function(){return Dj(0)}));var l=document.createElement("button");l.innerText="Change user name";var u=document.createElement("button");u.innerText="Change server";var c=document.createElement("div");c.id="currentServer",setTimeout((function(){nB()&&(c.innerText="You are currently connected to [".concat($N.server,"] as ").concat($N.name," - ").concat(HN.id,"."))}),400);var h=function(){s.value.length>=3&&($N.server=a.value,$N.name=s.value,c.innerText="You are currently connected to [".concat($N.server,"] as ").concat($N.name," - ").concat(HN.id,"."),rB(),Tj(),tI())};l.addEventListener("click",h),u.addEventListener("click",h);var d=document.createElement("div");d.id="userInfoDiv",t.append(s,l),n.append(a,o,u);var f=document.createElement("table");f.id="serverStatus",f.style.display="none",f.innerHTML='<thead>\n      <tr>\n        <th scope="col" >Space</th>\n        <th scope="col">User List</th>\n      </tr>\n    </thead>\n      <tbody id="serverStatusBody"></tbody>\n';var p=document.createElement("div"),m=document.createElement("div");return p.append(r),m.append(t,n),d.append(p,m),e.append(d,c,f),e}(),eN["Mini games"].DOM.content=(e=document.createElement("div"),hD.forEach((function(t){return e.appendChild(t)})),e),eN["Data visualisation"].DOM.content=((t=document.createElement("div")).className="serviceList",tO.length>0&&tO.forEach((function(e){return t.appendChild(e)})),t),XD=1};function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sN.apply(this,arguments)}function lN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var uN,cN,hN=[],dN=function(e){return(0,xx.gql)(QD||(QD=lN(['\n  query getObjktCuratedGallery {\n    gallery(\n      where: { gallery_id: { _eq: "','" } }\n    ) {\n      gallery_id\n      slug\n      description\n      curators {\n        curator {\n          address\n          alias\n          logo\n          twitter\n        }\n      }\n      tokens {\n        token {\n          token_id\n          artifact_uri\n          description\n          display_uri\n          mime\n          thumbnail_uri\n          timestamp\n          name\n          fa_contract\n          creators {\n            creator_address\n            holder {\n             alias\n             twitter\n             logo\n             tzdomain\n           }\n          }\n        }\n      }\n    }\n  }\n'])),e)},fN=function(e){return(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)($D||($D=lN(['\n      query getObjktCuration($name: String) {\n        gallery(\n          where: {\n            registry: { name: { _eq: "objkt" } }\n            items: { _gt: 0 }\n            name: { _iregex: $name }\n          }\n          order_by: { updated_at: desc }\n          limit: 10\n        ) {\n          gallery_id\n          name\n          description\n          slug\n          logo\n          items\n          tokens {\n            token {\n              content_rating\n            }\n          }\n          curators {\n            curator {\n              address\n              alias\n              logo\n              twitter\n            }\n          }\n        }\n      }\n    ']))),{name:e}).then((function(e){return pN(e)}))},pN=function(e,t){t||(document.getElementById("objktCuratedDisplay").innerHTML=""),e.gallery.forEach((function(e){e.url="https://objkt.com/curations/objkt/"+e.slug,e.chain="tezos";var n=aH(e,"loadCuration");t?hN.push(n):document.getElementById("objktCuratedDisplay").append(n)}))},mN=function(e){if(e){var t=new URL(e);return new URLSearchParams(t.search).get("fxhash")}},vN=function(){for(var e,t=document.getElementsByClassName("galleryFilterCheckbox"),n=[],r=document.getElementsByClassName("gentkCell"),i=0;i<t.length;i++)t[i].checked&&n.push(t[i].dataset.key);if(n.length>0){e=t[0].dataset.slug;for(var a=0;a<r.length;a++)r[a].style.display="none"}else for(var o=0;o<r.length;o++)r[o].style.display="inline-block";if(0===n.length)for(var s=document.getElementById("iterationList").children,l=0;l<s.length;l++)s[l].style.display="block";if(e&&_N[e]&&n.length>0){var u=[];n.forEach((function(t){_N[e].collection.forEach((function(e){document.getElementById(e.DOMid).style.display="none",e.token.attributes.forEach((function(n){var r=n.attribute;("string"==typeof r.value?r.value:JSON.stringify(r.value))===t&&u.push(e.DOMid)}))}))})),u.forEach((function(e){return document.getElementById(e).style.display="block"}))}},gN=function(){var e;(function(){var e,t=function(){var t=_N[n];t.slug=n,t.tag={},t.tags.forEach((function(e){switch(t.tag[e]=!0,e){case"firstPerson":case"world":case"skybox":t.type=e}})),t.title=t.name.replace("anaverse - ","");var r=aH(t,"listIterations"),i=document.createElement("div");i.className="gentkDesc",i.innerText=t.description,e=[],t.filters={},t.DOMelements={profile:r,description:i,gallery:e}};for(var n in _N)t();!function(){var e=[];for(var t in _N)_N[t].slug=t,e.push(_N[t]),delete _N[t];gO(e),_N={},e.forEach((function(e){_N[e.slug]=e}))}()})(),VH&&(e=VH,(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(ZD||(ZD=lN(['\n    query getObjktCuration {\n      gallery(\n        where: {registry: {name: {_eq: "objkt"}}, items: {_gt: 5}, name: {}, curators: {curator_address: {_eq: "','"}}}\n        order_by: {updated_at: desc}\n        limit: 10\n      ) {\n        gallery_id\n        name\n        logo\n        description\n        slug\n        items\n        curators {\n          curator {\n            address\n            alias\n            logo\n            twitter\n          }\n        }\n      }\n    }\n    \n    '])),e)).then((function(e){return pN(e,!0)}))),function(){hj();var e=window.location.search,t=new URLSearchParams(e);if(t.has("wallet")){var n=t.get("wallet");JH(n),$L=n}else tI();if(t.has("loadroom")){var r=t.get("loadroom").split("/"),i={room:{blockchain:r[0],contract:r[1],token_id:r[2],name:""},gallery:[]};yU(i)}if(t.has("partnerPlatform")){var a=t.get("partnerPlatform");"teia.art"===a&&hj(a,!0)}t.has("loadsingle")&&function(e,t){var n=QL[Math.floor(Math.random()*QL.length)];VH||$N.name||iB("https://mux.anaver.se","USER_"+JSON.stringify(Date.now()).substring(8),$N.space),n.gallery[0].tezosMetaData={contract:e,token_id:t},n.gallery[0].isSingleTemplate=1,yU(n),setTimeout((function(){return sj}),200)}(t.get("singlecontract"),t.get("singletokenid"))}()};function yN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var bN,xN,wN,_N={},EN=function(e,t){var n=document.createElement("meta");n.setAttribute("property","og:image"),n.setAttribute("content",t);var r=document.createElement("meta");r.setAttribute("name","twitter:image"),r.setAttribute("content",t);var i=document.createElement("meta");i.setAttribute("property","og:title"),i.setAttribute("content",e);var a=document.createElement("meta");a.setAttribute("name","og:title"),a.setAttribute("content",e),document.head.append(n,r,i,a)},TN={room:{blockchain:"tezos",token_id:"540571",contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE"},skybox:{blockchain:"tezos",token_id:"527345",contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE"},gallery:[{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"3"},position:{x:"-30.0000",y:"1.5000",z:"-1.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"2"},position:{x:"-30.0000",y:"1.5000",z:"2.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"4"},position:{x:"-30.0000",y:"1.5000",z:"-4.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"0"},position:{x:"-30.0000",y:"1.5000",z:"5.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"1"},position:{x:"-32.0000",y:"8.5000",z:"0.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"3.8000",y:"3.8000",z:"3.8000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"5"},position:{x:"-19.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1043411"},position:{x:"38.0000",y:"15.5000",z:"0.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"2.6000",y:"2.6000",z:"2.6000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"10"},position:{x:"-7.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"7"},position:{x:"-11.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"6"},position:{x:"-15.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1CUPoajzwiYQN8gfueuktNbAQS5jJ4Jf7V",token_id:"6"},position:{x:"0.0000",y:"5.5000",z:"-85.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"6.4000",y:"6.4000",z:"6.4000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1C3dCG9XMnP7iT7tUDs55ebr43wfF3TV7k",token_id:"0"},position:{x:"116.0000",y:"7.5000",z:"-29.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"6.8000",y:"6.8000",z:"6.8000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1RncKS9P56FhSDradukH9SjMSobqE8zpLV",token_id:"1"},position:{x:"97.0000",y:"15.5000",z:"38.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"3.9000",y:"3.9000",z:"3.9000"}},{tokenType:"tezos",tezosMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"25128"},position:{x:"-71.0000",y:"15.5000",z:"-60.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"2.9000",y:"2.9000",z:"2.9000"}},{tokenType:"IIIF",IIIFdata:{ark:"ark:/12148/btv1b7000018k",vue:"f1",region:"675.581227436823,708.5747292418771,3385.7617328519855,2950.5617328519857",rotation:"0",quality:"native",documentSource:"ark:/12148/btv1b7000018k",source:"Gallica",size:",1400"},position:{x:"-81.8400",y:"5.2300",z:"75.0000"},rotation:{x:"-0.7854",y:"1.5685",z:"0.7838"},scale:{x:"4.2000",y:"4.2000",z:"4.2000"}},{tokenType:"datavis",datavis:{tokenType:"datavis",feedType:"teztok-nft-livefeed",args:0},position:{x:"-15.0000",y:"2.5000",z:"60.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"IIIF",IIIFdata:{ark:"ark:/12148/bd6t5254636v",vue:"f1",region:"1279.954887218045,955.8812030075187,5678.097744360903,3425.9218045112784",rotation:"0",quality:"native",documentSource:"ark:/12148/bd6t5254636v",source:"Gallica",size:",1400"},position:{x:"-23.3057",y:"5.8082",z:"112.6326"},rotation:{x:"3.0609",y:"0.0332",z:"-3.1390"},scale:{x:"6.5000",y:"6.5000",z:"6.5000"}},{tokenType:"IIIF",IIIFdata:{ark:"ark:/12148/btv1b532635173",vue:"f1",region:"890.5139999999999,1155.06,2010.177,2654.7749999999996",rotation:"0",quality:"native",documentSource:"ark:/12148/btv1b532635173",source:"Gallica",size:",1400"},position:{x:"-49.5907",y:"4.2953",z:"17.7577"},rotation:{x:"1.2074",y:"1.5187",z:"-1.2086"},scale:{x:"2.4000",y:"2.4000",z:"2.4000"}},{tokenType:"IIIF",IIIFdata:{ark:"ark:/12148/btv1b101169373",vue:"f1",region:"591.2798264642083,786.402169197397,4848.494577006508,3344.672885032538",rotation:"0",quality:"native",documentSource:"ark:/12148/btv1b101169373",source:"Gallica",size:",1400"},position:{x:"-89.0000",y:"5.6800",z:"23.8300"},rotation:{x:"-0.7854",y:"1.5685",z:"0.7838"},scale:{x:"4.8600",y:"4.8600",z:"4.8600"}}],name:"ANAVER.SE TUTORIAL",collection:"tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9",startPoint:{position:{x:-12,y:1.5,z:3},direction:{x:-.94,y:.02,z:-.3}}},SN=!1,MN=function(e){SN&&!e||(yU(TN),oj(),SN=!0)};function AN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var kN,PN,RN,CN,LN,IN=function(e){Ej(),e.iterationsLoaded?BN(e):jN({native:!0,nativeRequestType:"iterationList",blockchain:e.chain,gentk:e})},ON=[],DN=function(e){return AO(e).then((function(){return RH(e)})).then((function(){"tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"!=e&&wx()("https://data.objkt.com/v3/graphql",(0,xx.gql)(wN||(wN=AN(['query getUserAnaverse {\n      token(\n        where: {royalties: {receiver_address: {_eq: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"}}, \n        tags: {tag: {name: {_eq: "anaverse"}}}, holders: {holder_address: {_eq: "','"}}}\n        limit: 30\n        order_by: {level: desc_nulls_last}\n        ) {\n          artifact_uri\n          name\n          ophash\n          fa_contract\n          token_id\n          holders(limit: 1, order_by: {last_incremented_at: desc_nulls_last}) {\n            holder {\n              address\n              alias\n              logo\n              twitter\n            }\n          }\n          attributes {\n            attribute {\n              name\n              value\n            }\n          }\n          display_uri\n          thumbnail_uri\n          tags {\n            tag {\n              name\n            }\n          }\n        }\n      }\n      '])),e)).then((function(e){var t=[];e.token.forEach((function(e){var n=0;e.hasOwnProperty("tags")&&e.tags.forEach((function(t){"room"===t.tag.name&&(e.type="room",n=1),"world"===t.tag.name&&(n=1),"skybox"===t.tag.name&&(e.type="skybox",n=1),"firstPerson"===t.tag.name&&(e.type="firstPerson",n=1)})),e.hasOwnProperty("tags")&&e.tags.forEach((function(r){"anaverse"===r.tag.name&&n&&t.push(e)}))})),function(e){e.forEach((function(e){e.contract=e.fa_contract,e.chain="tezos",e.hash=mN(e.artifact_uri.replace("ipfs://","https://")),e.personal=!0,e.slug=e.name.slice(0,e.name.lastIndexOf("#")-1),e.holder=e.holders[0].holder;var t="";e.hasOwnProperty("attributes")&&Array.isArray(e.attributes)&&e.attributes.forEach((function(e){"name"===e.attribute.name.toLowerCase()&&(t+=e.attribute.value)})),t.length<1&&(t=e.name);var n=e.holder.alias?e.holder.alias+"'s ":"";t=n+t.toLowerCase(),e.name=t,e.completeName=t,ON.push(aH(e,"loadIteration"))}))}(t)})).catch((function(e){console.log(e),Tx("personal native anaver.se tokens retrieval",0),console.log("Error : the request to retrieve your native anaver.se tokens failed")}))}))},NN=window.localStorage,BN=function(e){e.iterationsLoaded=!0;var t=document.getElementById("collection");t.innerHTML="",document.getElementById("loadingCollection")&&document.getElementById("loadingCollection").remove();var n=document.createElement("div");if(n.innerHTML=" Back",n.style="border-radius: 5px;\n    cursor: pointer;\n    padding: 4px;\n    margin: 5px;\n    width: 65px;",n.addEventListener("click",(function(){HD(),t.parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideRight",setTimeout((function(){return t.innerHTML=""}),250)})),t.prepend(n),e.DOMelements.hasOwnProperty("profile")){var r=document.createElement("div");r.style.display="flex",r.appendChild(e.DOMelements.profile.cloneNode(1)),r.appendChild(e.DOMelements.description),t.appendChild(r)}var i=document.createElement("DIV");i.id="filter",i.innerText="FILTER TOKENS";var a,o=document.createElement("div");o.id="iterationList",o.style="display: flex;\n  margin: 20px;\n  padding: 0px;\n  flex-direction: row;\n  flex-wrap: wrap;",VH&&(a=JSON.parse(NN.getItem(VH)))&&(prevLoad=JSON.parse(a.prevLoad));for(var s=e.DOMelements.gallery.length,l=0;l<s;l++)o.appendChild(e.DOMelements.gallery[l]);var u=document.createElement("div");if(e.DOMelements.hasOwnProperty("filters"))u.style="display: grid;grid-template-columns: 20% 80%;",e.DOMelements.filters.forEach((function(e){i.appendChild(e)})),u.appendChild(i);else{var c=document.createElement("div");u.appendChild(c)}u.appendChild(o),t.append(u)},UN=0,zN=function(){return UN=0};function FN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var HN,jN=function(e){if(e.native)switch(e.nativeRequestType){case"generatorList":Promise.all([(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(uN||(uN=yN(['\n      query getCrossChain {\n        token(\n          where: {\n            tags: {\n              tag: { name: { _eq: "anaverse" } }\n              token: { tags: { tag: { name: { _eq: "crosschain" } } } }\n            }\n            supply: { _gt: "0" }\n          }\n        ) {\n          attributes {\n            attribute {\n              name\n              value\n            }\n          }\n          token_id\n          fa_contract\n          accessibility\n          artifact_uri\n          average\n          content_rating\n          decimals\n          description\n          display_uri\n          extra\n          flag\n          highest_offer\n          is_boolean_amount\n          last_listed\n          last_metadata_update\n          level\n          lowest_ask\n          metadata\n          mime\n          name\n          ophash\n          supply\n          symbol\n          thumbnail_uri\n          timestamp\n          tzip16_key\n          tags {\n            tag {\n              name\n            }\n          }\n        }\n      }\n    '])))).then((function(e){e.token.forEach((function(e){e.iterationsLoaded=!1,e.id=e.fa_contract+e.token_id,e.tags.forEach((function(t){var n=t.tag.name;e.tags.push(n),"anaverse"===n&&(_N[e.name]=e),"skybox"===n&&(_N[e.name].type="skybox")}));var t=e.artifact_uri.slice(7),n="https://assets.objkt.media/file/assets-003/".concat(t,"/artifact/").replace("//artifact","/artifact");e.imgUrl="https://assets.objkt.media/file/assets-003/".concat(e.fa_contract,"/").concat(e.token_id,"/thumb288"),e.figuresUrl=n+"figures.js",e.skyboxUrl=n+"skybox.js",e.spriteUrl=n+"sprite.js",e.attributes.forEach((function(t){switch(t.attribute.name){case"target_chain":e.chain=t.attribute.value;break;case"author_wallet":e.crosschain_author_wallet=t.attribute.value,e.link="https://highlight.xyz/user/@".concat(t.attribute.value)}}))}))})),(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(cN||(cN=yN(['\n      query getAnaverse {\n        gallery(\n          where: {\n            curators: {\n              curator_address: { _eq: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9" }\n            }\n          }\n          order_by: { inserted_at: desc }\n        ) {\n          logo\n          name\n          gallery_id\n          description\n          tokens(limit: 1, order_by: { id: asc }) {\n            id\n            token {\n              tags {\n                tag {\n                  name\n                }\n              }\n              fa_contract\n              artifact_uri\n              display_uri\n              thumbnail_uri\n              token_id\n            }\n          }\n        }\n      }\n    '])))).then((function(e){e.gallery.forEach((function(e){if(e.iterationsLoaded=!1,e.id=parseInt(e.gallery_id),e.tags=[],e.tokens.length>0){e.contract=e.tokens[0].token.fa_contract,e.tokens[0].token.tags.forEach((function(t){var n=t.tag.name;e.tags.push(n),"anaverse"===n&&(_N[e.name]=e),"skybox"===n&&(_N[e.name].type="skybox"),"sprite"===n&&(_N[e.name].type="sprite")})),e.link="https://objkt.com/explore/tokens/1?gallery=fxhash:"+e.gallery_id,e.chain="tezos";var t=e.tokens[0].token.artifact_uri.slice(7,e.tokens[0].token.artifact_uri.indexOf("?fxhash=")),n="https://assets.objkt.media/file/assets-003/".concat(t,"/artifact/").replace("//artifact","/artifact");e.figuresUrl=n+"figures.js",e.skyboxUrl=n+"skybox.js",e.spriteUrl=n+"sprite.js"}}))})).catch((function(e){console.log(e),Tx("anaver.se native tokens retrieval",0)}))]).then((function(){Tx("anaver.se native tokens retrieval",1),gN()}));break;case"iterationList":switch(e.blockchain){case"tezos":!function(e){wx()("https://data.objkt.com/v3/graphql",(0,xx.gql)(bN||(bN=AN(["\n      query getAllIterations($galleryId: String) {\n        gallery(where: { gallery_id: { _eq: $galleryId } }) {\n          tokens(order_by: { id: desc }) {\n            fa_contract\n            token_id\n            token {\n              name\n              artifact_uri\n              ophash\n              holders(\n                limit: 1\n                order_by: { last_incremented_at: desc_nulls_last }\n              ) {\n                holder {\n                  address\n                  alias\n                  twitter\n                  logo\n                }\n              }\n              attributes {\n                attribute {\n                  name\n                  value\n                }\n              }\n            }\n          }\n        }\n      }\n    "]))),{galleryId:JSON.stringify(e.id)}).then((function(t){e.collection=t.gallery[0].tokens,e.collection.forEach((function(t){HH(t.token.holders[0].holder),function(e,t){var n=mN(t.token.artifact_uri),r=t.token_id;t.gentk=e,t.hash=n,t.id=r,t.contract=t.fa_contract,t.chain=e.chain,t.DOMid=t.chain+"/"+t.contract+"/"+t.token_id;var i="";t.token.holders[0].holder.alias&&(i=t.token.holders[0].holder.alias+"'S "),t.holder=t.token.holders[0].holder,t.token.hasOwnProperty("attributes")&&Array.isArray(t.token.attributes)&&t.token.attributes.forEach((function(e){"name"===e.attribute.name.toLowerCase()&&(i+=e.attribute.value)})),i=i.toLowerCase(),t.name=i,t.completeName=i,t.link="<div style='font-size:10px'>Open on <a target='_blank' href=\"https://objkt.com/tokens/".concat(t.contract,"/").concat(t.token_id,'">objkt</a></div>'),e.DOMelements.gallery.push(aH(t,"loadIteration")),t.token.holders[0].holder.alias&&t.token.attributes.push({attribute:{name:"Owner",value:t.token.holders[0].holder.alias}}),function(e,t){e.hasOwnProperty("filters")||(e.filters={}),t&&t.length>0&&t.forEach((function(t){var n=t.attribute;e.filters.hasOwnProperty(n.name)?e.filters[n.name].hasOwnProperty(n.value)?e.filters[n.name][n.value]++:e.filters[n.name][n.value]=1:e.filters[n.name]={}}))}(e,t.token.attributes)}(e,t)})),gO(e.DOMelements.gallery),function(e){var t,n=[],r=function(){(t=document.createElement("div")).innerHTML="<hr>"+i+" ("+Object.keys(e.filters[i]).length+")",t.style.cursor="pointer";var r=document.createElement("ul");for(var a in r.style.display="none",r.style.listStyle="none",e.filters[i]){var o=document.createElement("li"),s=document.createElement("input");s.type="checkbox",s.className="galleryFilterCheckbox",s.dataset.slug=e.slug,s.dataset.key=a;var l=e.filters[i][a];s.name=a+" ("+l+")";var u=document.createElement("label");u.innerText=a+" ("+l+")",u.for=a+" ("+l+")",s.addEventListener("change",vN),o.appendChild(s),o.appendChild(u),r.appendChild(o)}t.addEventListener("click",(function(){"none"===r.style.display?r.style.display="block":r.style.display="none"})),n.push(t,r)};for(var i in e.filters)r();e.DOMelements.filters=n}(e),BN(e)}))}(e.gentk);break;case"ethereum":o=e.gentk,wx()("https://api.highlight.xyz:8080/",(0,xx.gql)(kN||(kN=FN(["\n      query GetPublicCollectionByWalletAddress($walletAddress: String!) {\n        getPublicCollectionsByWallet(walletAddress: $walletAddress) {\n          collections {\n            id\n            name\n            type\n            collectionType\n            symbol\n            chainId\n            contractId\n            status\n            baseUri\n            contractUri\n            description\n            address\n            seriesTokens(first: 500) {\n              edges {\n                id\n                tokenId\n                name\n                ownerAddress\n\n                attributes {\n                  name\n                  value\n                  __typename\n                }\n                imageUrl\n                animationUrl\n                minted\n                __typename\n              }\n              pageInfo {\n                endCursor\n                totalCount\n                __typename\n              }\n              __typename\n            }\n            seriesDetails {\n              coverImage\n              logoUrl\n              __typename\n            }\n            generativeDetails {\n              logoUrl\n              __typename\n            }\n            seriesImages {\n              urls\n              coverImageUrl\n              __typename\n            }\n            editions {\n              name\n              description\n              image\n              size\n              onChainImage\n              animation\n              __typename\n            }\n            mintVectors {\n              id\n              stats {\n                total\n                __typename\n              }\n              __typename\n            }\n            __typename\n          }\n          __typename\n        }\n      }\n    "]))),{walletAddress:o.crosschain_author_wallet}).then((function(e){e.getPublicCollectionsByWallet.collections.forEach((function(e){wx()("https://api.highlight.xyz:8080/",(0,xx.gql)(PN||(PN=FN(["\n          query GetCollectionAddress($collectionId: String!) {\n            getPublicCollection(collectionId: $collectionId) {\n              address\n            }\n          }\n        "]))),{collectionId:e.id}).then((function(t){o.contract=t.getPublicCollection.address,o.collectionId=e.id})).then((function(){var t=!1;e.seriesTokens.edges[0].attributes.forEach((function(n){n.value===o.artifact_uri&&(t=e)})),t&&(t.seriesTokens.edges.forEach((function(e){!function(e,t){t.imgUrl=t.imageUrl,t.chain="ethereum",t.gentk=e,t.token_id=t.tokenId,t.contract=e.contract,t.url="https://highlight.xyz/mint/".concat(e.collectionId,"/tokens/").concat(t.token_id),t.link="<div style='font-size:10px'>Open on <a href=\"".concat(t.url,'" target="_blank">Highlight</a></div>');var n=new URL(t.animationUrl),r=n.searchParams.get("ms"),i=n.searchParams.get("h"),a=t.tokenId;r>1&&(i+=a),t.hash=i;var o=aH(t,"loadIteration");e.iterationsLoaded=1,e.DOMelements.gallery.push(o)}(o,e)})),BN(o))}))}))}))}break;case"specificToken":switch(e.blockchain){case"tezos":e.hasOwnProperty("gallery")?bU(e.gallery,e.contract,e.token_id):(a=e.sculpture,wx()("https://data.objkt.com/v3/graphql",'query getSculpture {\n        token(\n          limit: 1\n          where: {fa_contract: {_eq: "'.concat(a.sculptureMetaData.contract,'"}, token_id: {_eq: "').concat(a.sculptureMetaData.token_id,'"}}\n        ) {\n          artifact_uri\n          name\n          ophash\n          fa_contract\n          token_id\n          display_uri\n          thumbnail_uri  \n        }\n      }\n      ')).then((function(e){var t=e.token[0];t.type="world",t.tag={world:!0,item:!0};var n=new URL(t.artifact_uri.replace("ipfs://","https://")),r=new URLSearchParams(n.search).get("fxhash"),i=t.artifact_uri.slice(7,53);t.figuresUrl="https://assets.objkt.media/file/assets-003/".concat(i,"/artifact/figures.js").replace("//art","/art");var o={position:a.position,rotation:a.rotation,scale:a.scale};t.chain="tezos",t.contract=a.sculptureMetaData.contract,nz(t,a.sculptureMetaData.token_id,r,"",o)})));break;case"ethereum":n=e.gallery,r=e.contract,i=e.token_id,wx()("https://api.highlight.xyz:8080/",(0,xx.gql)(CN||(CN=FN(["\n      query GetCollectionByOnChainId($onChainId: String!) {\n        getCollectionByOnChainId(onChainId: $onChainId) {\n          id\n          name\n          __typename\n        }\n      }\n    "]))),{onChainId:"1:".concat(r)}).then((function(e){return e.getCollectionByOnChainId.id})).then((function(e){return wx()("https://api.highlight.xyz:8080/",(0,xx.gql)(LN||(LN=FN(["\n          query TokenDetails($collectionId: String!, $tokenId: String!) {\n            getPublicCollection(collectionId: $collectionId) {\n              seriesToken(tokenId: $tokenId) {\n                id\n                tokenId\n                name\n                description\n                imageUrl\n                animationUrl\n                minted\n                ownerAddress\n                attributes {\n                  name\n                  value\n                  __typename\n                }\n                __typename\n              }\n              __typename\n            }\n          }\n        "]))),{collectionId:e,tokenId:"string"==typeof i?i:JSON.stringify(i)})})).then((function(e){return e.getPublicCollection.seriesToken})).then((function(e){var t=new URL(e.animationUrl),a=t.searchParams.get("ms"),o=t.searchParams.get("h"),s=e.tokenId;a>1&&(o+=s),e.hash=o;var l=function(t){"ethereum"===_N[t].chain&&(YU("gallery",[]),e.attributes.forEach((function(a){if(a.value===_N[t].artifact_uri){var s=_N[t];s.contract=r,nz(s,"string"==typeof i?i:JSON.stringify(i),o,e.name,0,n)}})))};for(var u in _N)l(u);return e})).then((function(e){return n.skybox?xU(n):nz({skyboxUrl:"./initial_skybox.js",tag:{anaverse:!0,skybox:!0},type:"skybox"},0,vO(),"",!0,!1),setTimeout((function(){n.hasOwnProperty("startPoint")?(YU("startPoint",n.startPoint),_G()):(YU("startPoint",0),zN())}),3e3),e})).then((function(e){return(t=e.ownerAddress,wx()("https://api.highlight.xyz:8080/",(0,xx.gql)(RN||(RN=FN(["\n      query PublicUserProfile($slug: String!) {\n        getPublicAccountSettings(slug: $slug) {\n          id\n          displayAvatar\n          displayName\n          walletAddresses\n          verified\n          __typename\n        }\n      }\n    "]))),{slug:t}).then((function(e){return e.getPublicAccountSettings}))).then((function(t){e.owner=t,e.name=e.owner.displayName.length>0?e.owner.displayName.toUpperCase()+"'S "+e.name:e.name,ez("room",e.name)})).catch((function(e){console.log("Could not find information on the room owner")}));var t}))}break;case"sendToChat":switch(e.blockchain){case"tezos":case"ethereum":ZN(e)}break;case"userSprite":"tezos"===e.blockchain&&(t=e.sprite,wx()("https://data.objkt.com/v3/graphql",(0,xx.gql)(xN||(xN=AN(['query getUserSprite {\n    token(\n      where: {fa_contract: {_eq: "','"}, token_id: {_eq: "','"}}\n    ) {\n      artifact_uri\n      thumbnail_uri\n      attributes {\n        attribute {\n          name\n          value\n        }\n      }\n    }\n  }'])),t.contract,t.token_id)).then((function(e){var n=e.token[0],r=n.artifact_uri.slice(7);r=r.substring(0,r.indexOf("/"));var i="https://assets.objkt.media/file/assets-003/".concat(r,"/artifact/").replace("//artifact","/artifact");!function(e,t,n,r){vL.postMessage({side:window.innerHeight,spriteURL:t,hash:n,id:e,name:r})}(t.user,i+"sprite.js",mN(n.artifact_uri),t.userName)})))}else switch(e.blockchain){case"tezos":e.hasOwnProperty("assetList")?RO(e.assetList):function(e){var t,n=e.substring(0,e.indexOf("/")),r=e.substring(e.indexOf("/")+1);if(0===n.indexOf("KT1"))return kO(n,r);(0,xx.request)("https://data.objkt.com/v3/graphql",(t=n,(0,xx.gql)(hO||(hO=yO(['query getContract($_eq: String = "','") {\n  fa(where: {path: {_eq: $_eq}}) {\n    contract\n  }\n}'])),t))).then((function(e){return e.fa[0].contract})).then((function(e){return kO(e,r)}))}(e.id);break;case"solana":e.hasOwnProperty("solanaMetaData")?function(e){fetch("https://api.solana.fm/v0/magiceden/tokens/".concat(e.solanaMetaData.contract,"?network=mainnet")).then((function(e){return e.json()})).then((function(t){var n={position:e.position,rotation:e.rotation,scale:e.scale},r=e.solanaMetaData.contract,i=t.result.image;e.chain="solana",e.type="solana",MU[r]=t.result,MU[r].contract=r,fF(i,{id:r},"solana",n)}))}(e):function(e){fetch("https://api.solana.fm/v0/magiceden/tokens/".concat(e,"?network=mainnet")).then((function(e){return e.json()})).then((function(t){var n=t.result;n.id=e,n.contract=e,n.display_uri=n.image,n.link='<span>Check on <a href="https://solana.fm/address/'.concat(n.contract,'" target="_blank">solana.fm</a></span>'),n.chain="solana",n.url="https://solana.fm/address/".concat(n.contract),MU[n.contract]=n;var r=document.getElementById("importedContractContent");r&&r.append(aH(n,"loadItem"))}))}(e.id)}var t,n,r,i,a,o},GN=document.getElementById("messageR"),VN=document.getElementById("messageC"),WN=document.getElementById("sendMessage"),qN=function(){HN.emit("".concat($N.space.id,"-CHAT"),"".concat($N.name,": ").concat(WN.value).toUpperCase()),WN.innerText="",WN.value=""},XN=function(e,t,n){var r=document.createElement("div");return r.style="padding:3px;margin-top:2px;border-radius:2px;".concat(t),r.innerText=e,n&&r.addEventListener("click",n),r},YN=function(e,t){var n={type:t,contract:e.contract,token_id:e.token_id,chain:e.chain,emitter:$N.name,name:e.name};switch(e.chain){case"IIIF":n.IIIFdata=e.IIIFdata,n.link=e.link,n.item=e.item;break;case"solana":n.solanaMetaData={contract:e.id}}HN.emit("".concat($N.space.id,"-CHAT"),JSON.stringify(n))},KN=function(e){if("{"===e[0]){var t=JSON.parse(e),n=t.contract;t.hasOwnProperty("token_id")&&(n+="/"+t.token_id);var r={blockchain:t.chain,id:n},i="".concat(t.emitter," has sent a ").concat(t.type,".").toUpperCase();switch(VN.append(XN(i,"")),GN.append(XN(i,"background-color: rgba(255, 255, 255, 0.9);width: fit-content;")),t.type){case"IIIF":JN(t);break;case"painting":r.native=!1,r.solanaMetaData=t.solanaMetaData,jN(r);break;case"location":r.native=!0,r.gallery=[],r.nativeRequestType="sendToChat",r.name=t.name,r.contract=t.contract,r.token_id=t.token_id,jN(r)}}else e=e.toUpperCase(),VN.append(XN(e,"")),GN.append(XN(e,"background-color: rgba(255, 255, 255, 0.9);width: fit-content;"));document.getElementById("messageDiv").scrollTo({top:999999,left:0,behavior:"smooth"})},JN=function(e){var t="[ - ".concat(e.item.name," ").concat(e.item.artist,"]").toUpperCase();VN.append(XN(t,"cursor:pointer;",(function(){oI("FETCHING ITEM DATA"),VL(e.IIIFdata,e.link,null,e.item)}))),GN.append(XN(t,"background-color: rgba(255, 255, 255, 0.9);width: fit-content;cursor:pointer;pointer-events:auto;"))},ZN=function(e){e.id;var t="[ - ".concat(e.name,"]").toUpperCase();e.nativeRequestType="specificToken",e.gallery=[],VN.append(XN(t,"cursor:pointer;",(function(){return jN(e)}))),GN.append(XN(t,"background-color: rgba(255, 255, 255, 0.9);width: fit-content;cursor:pointer;pointer-events:auto;"))},QN=function(e){var t=e.id,n="[ - ".concat(e.name," - ").concat(e.artist,"]").toUpperCase();VN.append(XN(n,"cursor:pointer;",(function(){oI("FETCHING ITEM DATA"),MU[t]=e,MU[t].contract=e.contract,MU[t].token_id=e.token_id;var n=fH(e);fF(n,{id:t},e.chain),setTimeout((function(){return yG.lock()}),500)}))),GN.append(XN(n,"background-color: rgba(255, 255, 255, 0.9);width: fit-content;cursor:pointer;pointer-events:auto;"))},$N={spriteID:"tezos/KT1EfsNuqwLAWDd3o4pvfUx1CAh5GMdTrRvr/176456"},eB=function(e){return $N.spriteID=e},tB=window.localStorage;tB.getItem("currentUserSpace")&&($N=JSON.parse(tB.getItem("currentUserSpace")));var nB=function(){return!!HN&&HN.connected};window.disconnectSocket=function(){return HN.disconnect()};var rB=function(){iB($N.server,$N.name,$N.space)},iB=function(e,t,n){console.log("Starting multi-user connection"),HN&&(HN.disconnect(),HN=null,function(){for(var e in EL)SL(e)}(),clearInterval(bL)),window.addEventListener("beforeunload",(function(e){HN.disconnect()})),$N.server=e,$N.name=t,$N.hasOwnProperty("space")&&$N.space?"tezos/KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE/540571"!=n.id&&($N.space=n):$N.space=n,tB.setItem("currentUserSpace",JSON.stringify($N)),(HN=yL(e)).on("connect_error",(function(e){console.log("Could not connect to multiuser server"),HN.disconnect()})),HN.on("connect_failed",(function(e){return console.log("connect_failed")})),WN.style.display="block",document.getElementById("messageDiv").style.display="block",WN.addEventListener("focusin",(function(){return Dj(1)})),WN.addEventListener("focusout",(function(){return Dj(0)})),WN.addEventListener("change",qN),HN.on("".concat($N.space.id,"-HISTORY"),(function(e){console.log("fetching location history..."),e.chatHistory.forEach((function(e){return KN(e)}));var t=[];Object.values(e.gallery).forEach((function(e){return t.push(JSON.parse(e))})),_U(t)})),HN.on("".concat($N.space.id,"-CHAT"),(function(e){return KN(e)})),HN.on("".concat($N.space.id,"-DISCONNECT"),(function(e){return SL(e)})),HN.on("MULTISTATUS",(function(e){return oB(JSON.parse(e))})),HN.emit("USERNAME",{name:t,space:n,spriteID:$N.spriteID}),console.log("starting streaming positions"),TL=1,HN.on("".concat($N.space.id,"-MULTIUSER"),(function(e){var t,n=JSON.parse(e),r=HN.id;for(var i in n)if(i!=r){var a=!1;if(n[i].position.length>0&&(a=JSON.parse(n[i].position)),EL.hasOwnProperty(i)&&a)EL[i].position=a;else{EL[i]={position:a};var o=n[i].spriteID.split("/"),s={native:!0,nativeRequestType:"userSprite",sprite:{blockchain:o[0],contract:o[1],token_id:o[2],userName:n[i].name,user:i},blockchain:o[0]};jN(s)}}(t=performance.now()-ML)>500&&(Object.values(EL).forEach((function(e){e.hasOwnProperty("sprite")&&e.sprite.position&&ZT.to(e.sprite.position,{duration:t/1e3,x:e.position.x,y:e.position.y,z:e.position.z,ease:"linear"})})),ML=performance.now())})),bL=setInterval((function(){var e={x:gG.position.x,y:gG.position.y,z:gG.position.z};HN.emit("".concat($N.space.id,"-MULTIUSER"),JSON.stringify(e))}),1e3),HN.on("".concat($N.space.id,"-DISCONNECT"),(function(e){return SL(e)})),HN.on("".concat($N.space.id,"-WORLDITEM"),(function(e){return _U([JSON.parse(e)])})),HN.on("".concat($N.space.id,"-WORLDITEM-REMOVE"),(function(e){uG.children.forEach((function(t){EU(t).id===e&&uG.remove(t)})),bP()}))},aB={},oB=function(e){for(var t in aB)aB[t].userList=[];for(var n=0;n<e.length;n+=4){var r=e[n],i=e[n+1],a=e[n+2],o=e[n+3];aB.hasOwnProperty(o)||(aB[o]={spaceid:o,spacename:a,userList:[]}),aB[o].userList.push({name:r,userId:i})}!function(){var e=document.getElementById("serverStatusBody");if(e){document.getElementById("serverStatus").style.display="block";var t=function(){var t=aB[n];0===t.userList.length&&(delete aB[n],document.getElementById(n)&&document.getElementById(n).remove());var r=document.createElement("tr");if(r.id=n,r.className="statusBodyLine",document.getElementById(n)){var i=document.getElementById(n+"-useridcase");i.innerHTML="",t.userList.forEach((function(e){return i.innerHTML+="<span><strong>".concat(e.name,"</strong> - ").concat(e.userId)}))}else if(t.userList.length>0){var a=document.createElement("td"),o=t.spaceid.split("/"),s={};s.chain=o[0],s.contract=o[1],s.token_id=o[2],s.spacename=t.spacename,s.spaceid=t.spaceid,s.gentk={type:"world"},"tutorial"===s.chain&&(s.chain="tezos"),a.append(aH(s,"joinSpace")),a.style="padding: 15px;";var l=document.createElement("td");l.id=n+"-useridcase",l.className="multiUserCell",t.userList.forEach((function(e){return l.innerHTML+="<span><strong>".concat(e.name,"</strong> - ").concat(e.userId)})),r.append(a,l),e.append(r)}};for(var n in aB)t()}}()},sB=function(e){var t=e.split("/"),n={room:{blockchain:t[0],contract:t[1],token_id:t[2],name:""},gallery:[]};yU(n)},lB=function(e){e&&(yG.unlock(),e.hasOwnProperty("permalink")?(VH&&(e.permalink+="?ref="+VH),window.open(e.permalink,"_blank")):e.hasOwnProperty("url")&&(VH&&(e.url+="?ref="+VH),window.open(e.url,"_blank")))},uB=document.getElementById("itemMetaData"),cB=document.getElementById("assetLoader");cB.addEventListener("click",(function(){cB.innerHTML="",cB.style.display="none"}));var hB=function(e){var t=e.artifact_uri?"https://assets.objkt.media/file/assets-003/"+e.artifact_uri.replace("ipfs://","")+"/artifact":"https://assets.objkt.media/file/assets-003/"+e.display_uri.replace("ipfs://","")+"/artifact";if(0===e.mime.indexOf("image")){var n=new Image;n.src=t,n.style="display:block;margin:auto;pointer-events:none;max-width:100%;max-height:100%;",cB.append(n),cB.style.display="flex"}else if(0===e.mime.indexOf("video")){var r=document.createElement("video"),i=document.createElement("source");i.src=t,r.append(i),r.autoplay=!0,r.loop=!0,r.style="display:block;margin:auto;pointer-events:none;max-width:100%;max-height:100%;",cB.append(r),cB.style.display="flex"}};function dB(e,t){return e?e.length>t?e.substring(0,t)+"":e:""}var fB=document.getElementById("itemMetaNote"),pB=document.getElementById("artwork-detailedMetaData"),mB=document.getElementById("artwork-title"),vB=document.getElementById("artwork-artist"),gB=document.getElementById("artwork-description"),yB=document.getElementById("artwork-mime-type"),bB=document.getElementById("artwork-openExternal"),xB=document.getElementById("messageDiv"),wB=document.getElementById("sendMessage"),_B='<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 96 960 960" width="20"><path fill="white" d="M180 936q-24 0-42-18t-18-42V276q0-24 18-42t42-18h279v60H180v600h600V597h60v279q0 24-18 42t-42 18H180Zm202-219-42-43 398-398H519v-60h321v321h-60V319L382 717Z"/></svg>',EB=function(){var e=document.createElement("div");return e.className="focusToolButton",e.innerHTML="Load asset &nbsp;&nbsp; ".concat('<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path fill="white" d="M184.615-200Q157-200 138.5-218.5 120-237 120-264.615v-430.77Q120-723 138.5-741.5 157-760 184.615-760h164.616v40H184.615q-9.23 0-16.923 7.692Q160-704.615 160-695.385v430.77q0 9.23 7.692 16.923Q175.385-240 184.615-240h590.77q9.23 0 16.923-7.692Q800-255.385 800-264.615v-430.77q0-9.23-7.692-16.923Q784.615-720 775.385-720H610.769v-40h164.616Q803-760 821.5-741.5 840-723 840-695.385v430.77Q840-237 821.5-218.5 803-200 775.385-200h-590.77ZM480-364 307.692-536.308 336-564.616l124 124V-760h40v319.384l124-124 28.308 28.308L480-364Z"/></svg>'),e};var TB,SB=document.getElementById("personalNotes"),MB=function(e,t){SB.style.display="flex",SB.innerHTML="";var n=document.createElement("div"),r=document.createElement("div");r.style="color:white;font-family:sans-serif;font-weight:bolder;font-size:12px;padding: 2px;",r.innerText="Notes";var i=document.createElement("textarea");i.className="focusTextNote",i.value=e.hasOwnProperty("note")?e.note:"",i.addEventListener("focusin",(function(){return Dj(1)})),i.addEventListener("focusout",(function(){return Dj(0)})),i.addEventListener("change",(function(){e.note=i.value,t.parent.userData.note=i.value})),n.append(r,i),SB.append(n)},AB=function(){pB.style.display="none",SB.innerHTML="",SB.style.display="none",xB.style.display="block",wB.style.display="block",document.getElementById("transactionThumbnail")&&document.getElementById("transactionThumbnail").remove()},kB=document.getElementById("artwork-detailedMetaData"),PB=document.getElementById("artwork-title"),RB=document.getElementById("artwork-artist"),CB=document.getElementById("artwork-description"),LB=document.getElementById("artwork-mime-type"),IB=document.getElementById("artwork-openExternal"),OB=document.getElementById("cont"),DB=new bs,NB=new _y,BB=!1,UB=0;NB.params={Mesh:{},Line:{threshold:.1},LOD:{},Points:{threshold:.1},Sprite:{}};var zB=function(e){return BB=e},FB=0,HB=!1,jB=new dc(20,20,.1),GB=document.getElementById("roomLegendG"),VB=document.getElementById("roomLegendR"),WB=document.getElementById("info"),qB=document.getElementById("mobile-control"),XB=function(){zB(0),FB||((FB=new cc(jB,OF.blackOpacityFocus)).position.z=-2.7,FB.position.y=20.5,OF.blackOpacityFocus.opacity=0,cG.add(FB)),HB?(ZT.to(OF.blackOpacityFocus,{duration:.3,opacity:0}),ZT.to(FB.position,{duration:.4,y:20.5}),ZT.to(OF.torcheMaterial,{duration:.3,opacity:.8}),HB=0,setTimeout((function(){FB=0,cG.clear(),GB.style.display="block",VB.style.display="block",WB.style.display="block",pj&&(qB.style.display="block"),zB(1)}),550),setTimeout((function(){JB&&(uG.attach(JB),ZT.to(JB.position,{duration:.5,x:KB.position.x,y:KB.position.y,z:KB.position.z,ease:"power1.in"}),ZT.to(JB.rotation,{duration:.5,x:KB.rotation.x,y:KB.rotation.y,z:KB.rotation.z,ease:"power1.in"}),ZT.to(JB.scale,{duration:.5,x:KB.scale.x,y:KB.scale.y,z:KB.scale.z,ease:"power1.in"})),KB=0}),280)):(ZT.to(FB.position,{duration:.5,delay:.55,y:.5}),ZT.to(OF.blackOpacityFocus,{duration:.5,delay:.55,opacity:.8}),ZT.to(OF.torcheMaterial,{duration:.5,delay:.55,opacity:0}),GB.style.display="none",VB.style.display="none",WB.style.display="none",Pj&&kj(),pj&&(qB.style.display="none"),HB=1)},YB=function(){if(BB){NB.setFromCamera(DB,gG,0,12);var e=NB.intersectObjects(uG.children);if(e)if(e.length>1){if((TB=e[0]).object.hasOwnProperty("userData")&&TB.distance<12)if(TB.object.userData.isWorldItem)MU.hasOwnProperty(TB.object.userData.objktID)&&!HB&&function(e){if(uB.style.display="block",!HB)if(Rj){for(var t in uB.style.top="50%",MU)MU[t].focused=!1;e.focused=!0,uB.innerHTML=e.tooltipMetadata,uB.innerHTML+="<span style='font-size:8px;font-family:monospace;min-width:90px;'>Click to focus | Push V to hide metadata</span>",e.hasOwnProperty("note")&&e.note&&e.note.length&&(fB.style.display="block",fB.innerText=e.note)}else uB.style.width="auto",uB.style.top="90%",fB.style.display="none",uB.innerHTML="<span style='font-size:10px;font-family:monospace;min-width:90px;'>Push V to toggle metadata</span>"}(MU[TB.object.userData.objktID]);else if(TB.object.userData.isBlockPanel){var t=TB.object.parent;UB&&(UB.material===OF.redFull||UB.material===OF.cyanFull&&UB.parent!=t)&&(UB.material=OF.whiteFull,UB.scale.x-=.04,t.children.forEach((function(e){e.isMesh&&e.material===OF.whiteFull&&(e.material=OF.redFull,e.scale.x+=.04,UB=e)}))),UB||t.children.forEach((function(e){(e.isMesh&&e.material===OF.whiteFull||e.material===OF.cyanFull)&&(e.material=OF.redFull,e.scale.x+=.04,UB=e)}))}}else document.getElementById("itemMetaData").style.display="none",document.getElementById("itemMetaNote").style.display="none",TB=null,UB&&UB.material===OF.redFull&&(UB.material=OF.whiteFull,UB.scale.x-=.04,UB=null)}};OB.addEventListener("wheel",(function(e){if(TB){var t=TB.object.parent;if(t.userData.hasOwnProperty("isBlockDisplay")){var n=e.deltaY/700;ZT.to(t.parent.position,{duration:.4,y:t.parent.position.y+n})}}})),OB.addEventListener("touchstart",(function(){return YB()}));var KB=0,JB=0,ZB=2e3;OB.addEventListener("click",(function(){var e=!1,t=performance.now();if(t-ZB>700)if(ZB=t,KB)yG.lock(),AB(),XB();else if(TB&&BB)if(TB.object.parent.userData.hasOwnProperty("isBlockDisplay")){var n=TB.object.parent;n.userData.focused?(ZT.to(n.position,{duration:.25,z:n.position.z-.3,ease:"power1.in"}),n.userData.focused=!1):(ZT.to(n.position,{duration:.25,z:n.position.z+.3,ease:"power1.in"}),n.userData.focused=!0,KB=!0,"news-feed-rss"===n.userData.item.feedType?setTimeout((function(){return window.open(n.userData.item.link,"_blank")}),250):function(e){XB(),IB.innerHTML="",kB.style.display="flex",PB.innerText=e.token.name?e.token.name:"",e.token.hasOwnProperty("creators")&&(RB.innerText=e.token.creators[0]),e.token.hasOwnProperty("artist_profile")&&(e.token.artist_profile.hasOwnProperty("alias")?RB.innerText=e.token.artist_profile.alias:RB.innerText="Unkown artist");var t=function(e){var t=new Image(288);return t.src=e.imgurl,t.id="transactionThumbnail",t}(e);if(document.body.append(t),CB.innerText=e.token.description,e.token.hasOwnProperty("mime")&&(LB.innerText="[MIME type -  ".concat(e.token.mime,"]")),"tezos"===e.chain){if(e.display_uri=e.token.display_uri,e.display_uri="https://assets.objkt.media/file/assets-003/"+e.display_uri.replace("ipfs://","")+"/display",e.token.mime){var n=EB();e.token.url="https://assets.objkt.media/file/assets-003/"+e.token.artifact_uri.replace("ipfs://","")+"/display",n.addEventListener("click",(function(){return hB(e.token)})),IB.append(n)}e.token.url="https://objkt.com/tokens/".concat(e.token.fa2_address,"/").concat(e.token.token_id);var r=document.createElement("div");if(r.className="focusToolButton",r.innerHTML="Inspect on Objkt &nbsp;&nbsp; ".concat(_B),r.addEventListener("click",(function(){return lB(e.token)})),IB.append(r),VH){var i=document.createElement("div");i.className="focusToolButton",i.innerHTML="Copy referral link",i.addEventListener("click",(function(){i.innerText="Referral link copied!",navigator.clipboard.writeText(e.token.url+"?ref="+VH),setTimeout((function(){return r.innerHTML="Copy referral link"}),2e3)})),IB.append(i)}var a=document.createElement("div");a.className="focusToolButton",a.innerHTML="Load in Anaverse",a.addEventListener("click",(function(){var t=e.display_uri;e.token.fa={contract:e.token.fa2_address};var n={id:e.token.fa2_address+e.token.token_id};e.url="https://objkt.com/tokens/"+e.token.fa2_address+"/"+e.token.token_id,MU[n.id]=e.token,fF(t,n,"tezos"),AB(),XB()})),IB.append(a)}}(n.userData.item))}else if(BB){var r=TB.object;r.hasOwnProperty("userData")&&TB.distance<12&&!Fj&&r.userData.isWorldItem&&MU.hasOwnProperty(r.userData.objktID)&&(document.getElementById("itemMetaData").style.display="none",document.getElementById("itemMetaNote").style.display="none",yG.unlock(),JB=r.parent,(KB={position:{},rotation:{},scale:{}}).position=new Qs(JB.position.x,JB.position.y,JB.position.z),KB.rotation=new Qs(JB.rotation.x,JB.rotation.y,JB.rotation.z),KB.scale=new Qs(JB.scale.x,JB.scale.y,JB.scale.z),cG.attach(JB),XB(),ZT.to(JB.position,{duration:.5,x:0,y:0,z:-2.5,ease:"power1.in"}),ZT.to(JB.rotation,{duration:.5,x:0,y:0,z:0,ease:"power1.in"}),ZT.to(JB.scale,{duration:.5,x:1,y:1,z:1,ease:"power1.in"}),setTimeout((function(){!function(e,t){pB.style.display="flex",cj&&(pB.style.left="-300px",pB.style.animation="0.4s linear 0.1s 1 normal forwards running loaderSlideRight"),e&&(mB.innerText=e.name?e.name:"",vB.innerText=e.artist?e.artist:"",gB.innerText="",e.hasOwnProperty("description")&&e.description&&(gB.innerText=e.description),e.hasOwnProperty("mime")&&(yB.innerText="[MIME type -  ".concat(e.mime,"]")),function(e,t){if(e.hasOwnProperty("type")){bB.innerHTML="";var n=document.createElement("div");n.className="focusToolButton";var r=0;switch(e.type){case"tezos":case"objkt":if(r="Objkt",e.mime&&e.mime.indexOf("html")<0&&e.mime.indexOf("application")<0){var i=EB();bB.append(i),i.addEventListener("click",(function(){return hB(e)}))}if(nB()){var a=((u=document.createElement("div")).className="focusToolButton",u.innerHTML="Send to chat",u);bB.append(a),a.addEventListener("click",(function(){YN(e,"painting"),yG.lock(),AB(),XB()}))}break;case"artacle":case"ethereum":r="Artacle";break;case"solana":if("image"===e.properties.category||"video"===e.properties.category){var o=EB();bB.append(o),o.addEventListener("click",(function(){return function(e){var t=e.properties.files[0].uri;if("image"===e.properties.category){var n=new Image;n.src=t,n.style="display:block;margin:auto;pointer-events:none;max-width:100%;max-height:100%;",cB.append(n),cB.style.display="flex"}else if("video"===e.properties.category){var r=document.createElement("video"),i=document.createElement("source");i.src=t,r.append(i),r.autoplay=!0,r.loop=!0,r.style="display:block;margin:auto;pointer-events:none;max-width:100%;max-height:100%;",cB.append(r),cB.style.display="flex"}}(e)}))}r="Solana FM";break;default:r="web2"}if(r){if(n.innerHTML="Inspect on ".concat(r," &nbsp;&nbsp; ").concat(_B),e.hasOwnProperty("gallica")){n.innerHTML="Ouvrir dans Gallica &nbsp;&nbsp; ".concat(_B);var s=EB();bB.append(s),s.addEventListener("click",(function(){return function(e){var t="https://gallica.bnf.fr/iiif/".concat(e.IIIFdata.ark,"/").concat(e.IIIFdata.vue,"/").concat(e.IIIFdata.region,"/").concat(e.IIIFdata.size,"/").concat(e.IIIFdata.rotation,"/").concat(e.IIIFdata.quality),n=new Image;n.src=t,n.style="display:block;margin:auto;pointer-events:none;max-width:100%;max-height:100%;",cB.append(n),cB.style.display="flex"}(e)}))}if(e.hasOwnProperty("britishLibrary")){n.innerHTML="Access on the British Library &nbsp;&nbsp; ".concat(_B);var l=EB();bB.append(l),l.addEventListener("click",(function(){return function(e){var t="https://api.bl.uk/image/iiif/".concat(e.IIIFdata.ark,"/").concat(e.IIIFdata.region,"/").concat(e.IIIFdata.size,"/").concat(e.IIIFdata.rotation,"/").concat(e.IIIFdata.quality,".jpg"),n=new Image;n.src=t,n.style="display:block;margin:auto;pointer-events:none;max-width:100%;max-height:100%;",cB.append(n),cB.style.display="flex"}(e)}))}n.addEventListener("click",(function(){return lB(e)})),bB.append(n)}}var u,c,h=((c=document.createElement("div")).className="focusToolButton",c.innerHTML="Add note &nbsp;&nbsp; ".concat('<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path fill="white" d="M180.001-400v-59.999h280V-400h-280Zm0-160v-59.999h440V-560h-440Zm0-160v-59.999h440V-720h-440Zm344.615 539.999v-105.692l217.153-216.153q7.462-7.461 16.111-10.5 8.65-3.038 17.299-3.038 9.436 0 18.252 3.538 8.816 3.539 16.029 10.615l37 37.385q6.462 7.461 10 16.153 3.539 8.693 3.539 17.385 0 8.692-3.231 17.692t-10.308 16.461L630.307-180.001H524.616Zm287.691-250.307-37-37.385 37 37.385Zm-240 202.615h38l129.847-130.462-18.385-19-18.615-18.769-130.847 130.231v38Zm149.462-149.462-18.615-18.769 37 37.769-18.385-19Z"/></svg>'),c);MB(e,t),e.hasOwnProperty("note")?e.note&&(SB.style.display="flex"):(SB.style.display="none",h.addEventListener("click",(function(){return SB.style.display="flex"}))),bB.append(h)}(e,t)),uB.style.display="none",xB.style.display="none",wB.style.display="none"}(MU[r.userData.objktID],r)}),550),e=!0)}e||yG.lock()}));var QB=new Audio,$B=function(){return QB.volume=.1};$B();var eU=document.getElementById("audio-radio"),tU=document.getElementById("radio-name"),nU=document.getElementById("track-name"),rU=document.getElementById("radio-play"),iU=!1;rU.addEventListener("click",(function(){$B(),iU?(QB.pause(),iU=!1,rU.innerHTML='<img  style="width:15px;height:15px" src="icons/play.svg">'):(QB.play(),iU=!0,rU.innerHTML='<img  style="width:15px;height:15px" src="icons/stop.svg">')}));var aU=!1,oU=0,sU=window.localStorage,lU=document.getElementById("matureNotice");document.getElementById("hideNotice").addEventListener("click",(function(){yG.lock(),lU.style.display="none"}));var uU,cU,hU,dU,fU,pU,mU,vU=function(){yG.unlock(),lU.style.display="block"},gU=null,yU=function(e){zB(!0),gU=e.curator,jN({native:!0,nativeRequestType:"specificToken",blockchain:e.room.blockchain,contract:e.room.contract,token_id:e.room.token_id,gallery:e})},bU=function(e,t,n){return(0,xx.request)("https://data.objkt.com/v3/graphql",' query checkRoom {\n      token(where: {token_id: {_eq: "'.concat(n,'"},fa_contract: {_eq: "').concat(t,'"},creators: {creator_address: {_eq: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"}}}) {\n        artifact_uri\n        attributes {\n          attribute {\n            name\n            value\n          }\n        }\n    average\n    decimals\n    description\n    display_uri\n    fa{contract}\n    token_id\n    extra\n    flag\n    highest_offer\n    is_boolean_amount\n    last_listed\n    last_metadata_update\n    level\n    lowest_ask\n    metadata\n    mime\n    name\n    ophash\n    rights\n    tags {\n      tag {\n        name\n      }\n    }\n    supply\n    symbol\n    thumbnail_uri\n    timestamp\n    tzip16_key\n    creators {\n      creator_address\n    }\n    holders {\n      holder {\n        address\n        alias\n      }\n    }\n      }\n    }')).then((function(t){PU(),oU=0,e.hasOwnProperty("startPoint")?YU("startPoint",e.startPoint):(YU("startPoint",0),zN()),YU("gallery",[]),e.hasOwnProperty("DOMthumb")&&EN(JSON.parse(e.name)+" | ANAVER.SE",e.DOMthumb.src.replace("/thumbnail","/display")),e.hasOwnProperty("gallery")&&e.gallery.forEach((function(e){"block"!=e.tokenType&&"sculpture"!=e.tokenType&&oU++})),zB(!0);var r=t.token[0];uG.clear();var i="";r.holders[0].holder.alias&&(i=r.holders[0].holder.alias.toUpperCase()+"'S "),r.hasOwnProperty("attributes")&&r.attributes.forEach((function(e){"name"===e.attribute.name.toLowerCase()&&(i+=e.attribute.value)}));var a=new URL(r.artifact_uri.replace("ipfs://","https://")),o=new URLSearchParams(a.search).get("fxhash");r.type="world",r.tag={room:!0};var s=r.artifact_uri.slice(7,53);r.figuresUrl="https://assets.objkt.media/file/assets-003/".concat(s,"/artifact/figures.js"),r.contract=r.fa.contract,r.chain="tezos",r.tags.forEach((function(e){return r.tag[e.tag.name]=!0})),r.tag.hasOwnProperty("commune")?tz(r,e.gallery):nz(r,n,o,i,0,e),Tx("Gallery room retrieval",1),e.hasOwnProperty("audioguide")&&function(e,t){QB.pause(),clearInterval(undefined),QB.src=e,tU.innerText=t,nU.innerText="Gallery audioguide",aU=!0,eU.style.display="flex",setTimeout((function(){iU=!0,rU.innerHTML='<img  style="width:15px;height:15px" src="icons/stop.svg">',QB.play().catch((function(e){iU=!1,rU.innerHTML='<img  style="width:15px;height:15px" src="icons/play.svg">'}))}),1500)}("https://assets.objkt.media/file/assets-003/"+e.artifact.replace("ipfs://","")+"/artifact/"+e.audioguide.mainTrack,e.name),e.hasOwnProperty("collection")&&e.collection&&(e.collection,zH([e.collection]).then((function(){NH[e.collection].alias})).catch((function(e){console.log(e)})))})).then((function(t){e.skybox?xU(e):nz({skyboxUrl:"./initial_skybox.js",tag:{anaverse:!0,skybox:!0},type:"skybox"},0,vO(),"",!0,!1)})).catch((function(e){console.log(e),Tx("Gallery room retrieval",0)}))},xU=function(e){if(parseInt(e.skybox)){var t=parseInt(e.skybox)+0;e.skybox={token_id:t},wU(e,"")}else if("tezos"===e.skybox.blockchain){var n=',fa_contract: {_eq: "'.concat(e.skybox.contract,'"}');YU("skybox",{contract:e.skybox.contract,token_id:e.skybox.token_id,name:e.skybox.name,blockchain:"tezos"}),wU(e,n)}},wU=function(e,t){return(0,xx.request)("https://data.objkt.com/v3/graphql",' query checkRoom {\n      token(where: {token_id: {_eq: "'.concat(e.skybox.token_id,'"}').concat(t,',creators: {creator_address: {_eq: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"}}}) {\n        artifact_uri\n    average\n    decimals\n    description\n    display_uri\n    extra\n    flag\n    highest_offer\n    is_boolean_amount\n    last_listed\n    last_metadata_update\n    level\n    lowest_ask\n    metadata\n    mime\n    name\n    ophash\n    rights\n    supply\n    symbol\n    thumbnail_uri\n    token_id\n    timestamp\n    tzip16_key\n    creators {\n      creator_address\n    }\n    holders {\n      holder {\n        address\n        alias\n      }\n    }\n    fa_contract\n      }\n    }')).then((function(e){var t=e.token[0];if(t){Lj(1);var n=1.75*window.innerHeight,r=new URL(t.artifact_uri.replace("ipfs://","https://")),i=new URLSearchParams(r.search).get("fxhash"),a=t.artifact_uri.slice(7,53),o="https://assets.objkt.media/file/assets-003/".concat(a,"/artifact/skybox.js");rG.fog&&(rG.fog.near=99999,rG.fog.far=99999),mU.postMessage({side:n,skyurl:o,hash:i})}Tx("Gallery skybox retrieval",1)})).catch((function(e){console.log(e),Tx("Gallery skybox retrieval",0)}))},_U=function(t){var n={objkt:[],tezos:[],openSea:[],ethereum:[],solana:[],block:[],sculpture:[],IIIF:[],datavis:[]};if(t.forEach((function(e){return n[e.tokenType].push(e)})),n.tezos.length>0){var r={native:!1,blockchain:"tezos",assetList:n.tezos};jN(r)}if(n.solana.length>0)for(var i=function(e){setTimeout((function(){var t=n.solana[e];t.native=!1,t.blockchain=t.tokenType,jN(t)}),500*e)},a=0;a<n.solana.length;a++)i(a);n.block.length>0&&(n.block.forEach((function(t){var n=new lf;n.userData=t.block,n.userData.tokenType="block";var r=kD(e[t.block.geometry.type],CD(t.block.geometry.args)),i=new cc(r,OF.whiteFull),a=new Cm(r),o=new Bp(a,OF.blackLineLone);n.add(i,o),n.position.set(DU(t.position.x),DU(t.position.y),DU(t.position.z)),n.rotation.set(DU(t.rotation.x),DU(t.rotation.y),DU(t.rotation.z)),n.scale.set(DU(t.scale.x),DU(t.scale.y),DU(t.scale.z)),uG.attach(n)})),bP()),n.sculpture.length>0&&n.sculpture.forEach((function(e){var t={native:!0,nativeRequestType:"specificToken",blockchain:e.sculptureMetaData.blockchain,sculpture:e};jN(t)})),n.IIIF.length>0&&zF(n.IIIF),n.datavis.length>0&&n.datavis.forEach((function(e){switch(e.datavis.feedType){case"teztok-nft-livefeed":UI(0,e);break;case"teztok-nft-lat-sales":XI(e.datavis.args.targetWallet,e);break;case"teztok-nft-lat-purchases":YI(e.datavis.args.targetWallet,e);break;case"teztok-nft-lat-transact":JI(e);break;case"news-feed-rss":!function(e,t,n){fetch(e).then((function(e){return e.text()})).then((function(e){var r=function(e,t){for(var n=[],r=0;r<e.length;r++){var i,a={mediaType:t},o=SI(e[r].children);try{for(o.s();!(i=o.n()).done;){var s=i.value;switch(s.tagName){case"media:thumbnail":a.imgurl=s.getAttribute("url");break;case"pubDate":a.date=new Date(s.textContent);break;default:a[s.tagName]=s.textContent}}}catch(e){o.e(e)}finally{o.f()}a.level="NEWSFEED",n.push(a)}return n}((new DOMParser).parseFromString(e,"application/xml").getElementsByTagName("item"),t);CI(r,n)}))}(e.datavis.args.target,e.datavis.args.mediaType,e)}})),setTimeout((function(){if(TL&&nB()){var e=[];t.forEach((function(t){return e.push({item:t,id:TU(t).id})})),HN.emit("".concat($N.space.id,"-LOADGALLERY"),JSON.stringify(e))}}),1500)},EU=function(e){var t={};if(e.userData.hasOwnProperty("tokenType")){switch(t.tokenType=e.userData.tokenType,e.userData.hasOwnProperty("note")&&(t.note=e.userData.note),t.tokenType){case"block":t.block=e.userData;break;case"datavis":t.datavis=e.userData;break;case"sculpture":t.sculptureMetaData=e.userData.sculptureMetaData;break;case"IIIF":t.IIIFdata=e.userData.IIIFdata;break;case"solana":t.solanaMetaData=e.userData.solanaMetaData;break;case"ethereum":t.ethereumMetaData=e.userData.ethereumMetaData;case"tezos":t.tezosMetaData=e.userData.tezosMetaData}return TU(e,t)}},TU=function(e,t){var n="",r=["x","y","z"];return["position","rotation","scale"].forEach((function(i){t&&(t[i]={}),r.forEach((function(r){var a=Nn(".4f")(e[i][r]);t&&(t[i][r]=a),n+=JSON.stringify(a)}))})),{id:n,item:t}},SU=function(){if(WU.name=document.getElementById("galleryName").value,WU.name.length>0){WU.timeId=new Date;var e={};for(var t in uG.children.forEach((function(t){var n=EU(t);e[n.id]=n.item})),WU.gallery=[],e)WU.gallery.push(e[t]);galleryCreator.style.display="none",galleryCreator.style.zIndex=-5,document.getElementById("galleryMetaData").innerHTML="",document.addEventListener("keydown",Hj);var n=JSON.parse(sU.getItem("localGalleries"));n?(n.push(WU),sU.setItem("localGalleries",JSON.stringify(n))):sU.setItem("localGalleries",JSON.stringify([WU])),Dj(0),Tj(),oI("GALLERY SAVED LOCALLY",1500)}},MU={},AU={},kU=0,PU=function(){return kU=0},RU=2.5,CU=new Ic(RU,RU),LU=new dc(2.6,2.6,.05),IU=new dc(2.65,.05,.15),OU=new dc(.05,2.65,.15),DU=function(e){return Number(e)?Number(e):Number("-"+e.substring(1))},NU=function(e,t,n,r,i){kU++,MU[t.id].img=e,i&&(MU[t.id].note=i),oI("LOADING PIECE "+kU+(oU>0?"/"+oU:""),1500);var a=new lf;mF(e).then((function(e){e.magFilter=Fi,e.minFilter=Gi,e.colorSpace=fo,e.anisotropy=mG;var o,s,l,u,c,h,d=new xu({map:e});if(e.image.height===e.image.width)o=new cc(CU,d),(s=new cc(LU,OF.ghost)).position.set(0,0,-.05),(u=new cc(IU,OF.ghost)).position.set(0,1.3,0),(l=new cc(IU,OF.ghost)).position.set(0,-1.3,0),(c=new cc(OU,OF.ghost)).position.set(-1.3,0,0),(h=new cc(OU,OF.ghost)).position.set(1.3,0,0);else if(e.image.height>e.image.width){var f=RU*(e.image.width/e.image.height);o=new cc(new Ic(f,RU),d),(s=new cc(new dc(f+.1,2.6,.05),OF.ghost)).position.set(0,0,-.05),(u=new cc(new dc(f+.15,.05,.15),OF.ghost)).position.set(0,1.3,0),(l=new cc(new dc(f+.15,.05,.15),OF.ghost)).position.set(0,-1.3,0),(c=new cc(OU,OF.ghost)).position.set(-(f/2+.05),0,0),(h=new cc(OU,OF.ghost)).position.set(f/2+.05,0,0)}else{var p=RU*(e.image.height/e.image.width);o=new cc(new Ic(RU,p),d),(s=new cc(new dc(2.6,p+.1,.05),OF.hatchingMaterial)).position.set(0,0,-.05),(u=new cc(IU,OF.ghost)).position.set(0,p/2+.05,0),(l=new cc(IU,OF.ghost)).position.set(0,-(p/2+.05),0),(c=new cc(new dc(.05,p+.15,.15),OF.ghost)).position.set(-1.3,0,0),(h=new cc(new dc(.05,p+.15,.15),OF.ghost)).position.set(1.3,0,0)}switch(o.position.set(0,0,0),a.add(s,u,l,c,h,o),a.position.z=-4,o.userData.isWorldItem=!0,t&&(o.userData.objktID=t.id),a.position.y+=.5,t&&(a.userData.tokenType=n,a.userData.id=t.id),i&&(a.userData.note=i,o.userData.note=i),n){case"ethereum":case"openSea":a.userData.ethereumMetaData={contract:MU[t.id].contract,token_id:MU[t.id].token_id},a.userData.type="ethereum";break;case"tezos":case"objkt":a.userData.tezosMetaData={contract:MU[t.id].fa.contract,token_id:MU[t.id].token_id},a.userData.type="tezos";break;case"solana":a.userData.solanaMetaData={contract:MU[t.id].contract}}MU[t.id].hasOwnProperty("IIIFdata")&&(a.userData.IIIFdata=MU[t.id].IIIFdata),function(e,t){switch(e.type=t,t){case"tezos":case"objkt":!function(e){var t=e.collection?e.collection:"";e.hasOwnProperty("artist_profile")&&e.artist_profile&&(e.artist=e.artist_profile.alias)," null"!==e.artist&&null!==e.artist&&void 0!==e.artist||(e.artist=" unknown artist"),e.tooltipMetadata="<strong>".concat(e.name,"</strong> - ").concat(e.artist,"<br>\n").concat(t,"<br><br><em>").concat(dB(e.description,250),'</em><br>\n<br>\n<span style="font-size:9px;font-family:monospace;font-style: italic;">[media type:  ').concat(e.mime,"]</span>\n<br><br>")}(e);break;case"ethereum":case"openSeaMetaData":case"openSea":!function(e){e.hasOwnProperty("name")?e.tooltipMetadata="<strong>".concat(e.name,"</strong><br><br>"):e.tooltipMetadata="No information provider available.<br><br>"}(e);break;case"solana":!function(e){e.url="https://solana.fm/address/".concat(e.contract),e.tooltipMetadata="<strong>".concat(e.name,"</strong><br><br>")}(e);break;case"web2":buildWeb2Metadata(e);break;case"IIIF":!function(e){e.tooltipMetadata="<strong>".concat(e.name,"</strong><br> ").concat(e.artist,"<br>\n  <br><em>").concat(dB(e.description,250),'</em><br>\n  <br>\n  <span style="font-size:9px;font-family:monospace;font-style: italic;">[').concat(e.year,"]</span>\n  <br><br>")}(e)}}(MU[t.id],n),r?(a.children.forEach((function(e){"Mesh"===e.type&&("PlaneGeometry"===e.geometry.type?(e.material.opacity=1,e.material.transparent=!1):e.material=OF.whiteFull)})),a.position.set(DU(r.position.x),DU(r.position.y),DU(r.position.z)),a.rotation.set(DU(r.rotation.x),DU(r.rotation.y),DU(r.rotation.z)),a.scale.set(DU(r.scale.x),DU(r.scale.y),DU(r.scale.z)),uG.attach(a),bP()):(setTimeout((function(){return BU(a)}),800),a.position.y=4,cG.add(a),ZT.to(a.position,{duration:.5,y:.5,ease:"power1.in"})),setTimeout((function(){oI()}),2e3)}))},BU=function(e){var t=document.getElementById("worldItemTooltip");zB(0),pj&&(document.getElementById("hang-button").style.display="flex"),[{name:"scale",extent:[.01,10],start:1,step:"0.01",threetype:"scale",axis:"all"},{name:"X position",extent:[-5,5],start:0,step:"0.01",threetype:"position",axis:"x"},{name:"Y position",extent:[-5,5],start:0,step:"0.01",threetype:"position",axis:"y"},{name:"Z position",extent:[-10,-1],start:0,step:"0.01",threetype:"position",axis:"z"},{name:"X rotation",extent:[-Math.PI,Math.PI],start:0,step:"0.01",threetype:"rotation",axis:"x"},{name:"Y rotation",extent:[-Math.PI,Math.PI],start:0,step:"0.01",threetype:"rotation",axis:"y"},{name:"Z rotation",extent:[-Math.PI,Math.PI],start:0,step:"0.01",threetype:"rotation",axis:"z"}].forEach((function(n){var r=document.createElement("div");r.className="worldTooltipDivs";var i=document.createElement("input"),a=document.createElement("input"),o=document.createElement("span");o.draggable=!1,i.style.pointerEvents="all",i.type="range",i.value=n.start,i.step=n.step,i.min=n.extent[0],i.max=n.extent[1],a.step=n.step,a.type="number",a.style="width:50px;pointer-events: all;margin: auto;",i.value=n.start,a.value=i.value,o.addEventListener("click",(function(){i.value=n.start,"all"===n.axis?e[n.threetype].set(n.start,n.start,n.start):e[n.threetype][n.axis]=n.start})),a.addEventListener("input",(function(){i.value=a.value,"all"===n.axis?e[n.threetype].set(i.value,i.value,i.value):e[n.threetype][n.axis]=i.value})),i.addEventListener("input",(function(){a.value=i.value,"all"===n.axis?e[n.threetype].set(i.value,i.value,i.value):e[n.threetype][n.axis]=i.value})),o.innerText=n.name,o.className="worldTooltipLabel",r.appendChild(i),r.appendChild(a),r.appendChild(o),t.appendChild(r),r.addEventListener("dragstart",(function(e){return e.preventDefault()}))}));var n=document.createElement("div");n.innerText=Pj?"Grid snapping is toggled":"Grid snapping is untoggled",n.className="worldTooltipLabel",n.style="width: 200px;margin: auto;",n.addEventListener("click",(function(){kj(),n.innerText=Pj?"Grid snapping is toggled":"Grid snapping is untoggled",n.style.color=Pj?"white":"black",n.style.backgroundColor=Pj?"black":"white"})),t.appendChild(document.createElement("br")),t.appendChild(n);var r=document.createElement("div");r.innerText="Delete frame",r.className="worldTooltipLabel",r.style="width: 200px;margin: auto;color:red;margin-top:4px;",r.addEventListener("click",(function(){cG.clear(),zj()})),t.appendChild(r),t.appendChild(document.createElement("br"));var i=document.createElement("div"),a="H";pj&&(a="<svg xmlns='http://www.w3.org/2000/svg' height='14' viewBox='0 -960 960 960' width='14'> <path d='M160-80q-33 0-56.5-23.5T80-160v-480q0-33 23.5-56.5T160-720h160l160-160 160 160h160q33 0 56.5 23.5T880-640v480q0 33-23.5 56.5T800-80H160Zm0-80h640v-480H160v480Zm80-80h480L570-440 450-280l-90-120-120 160Zm460-200q25 0 42.5-17.5T760-500q0-25-17.5-42.5T700-560q-25 0-42.5 17.5T640-500q0 25 17.5 42.5T700-440ZM404-720h152l-76-76-76 76ZM160-160v-480 480Z' /> </svg>",t.style.backgroundColor="rgba(255,255,255,0.5)",t.style.border="2px solid black"),i.innerHTML="Use <b>".concat(a,"</b> to hang this item where it is."),t.appendChild(i),t.style.display="block",t.style.animation="worldToolTipSlideIn 0.1s linear forwards"},UU=0,zU=0,FU=function(e){var t=e.pos,n=e.rot,r=e.scale,i=e.mesh,a=e.i,o=e.fig,s=e.lines,l=e.count;i.hasOwnProperty("isBox")&&(dU.pos.push(t.x,t.y,t.z),ij||(l=zU,fU.pos.push(t.x-.35,t.y-.05,t.z+.35)),r?(r.x=r.x*i.parameters[0],r.y=r.y*i.parameters[1],r.z=r.z*i.parameters[2]):((r=new Qs(1,1,1)).x=i.parameters[0],r.y=i.parameters[1],r.z=i.parameters[2]),dU.scale.push(r.x,r.y,r.z),ij||fU.scale.push(r.x,r.y,r.z),(i=uU).isBox=!0,a=UU-1,UU++);var u=new Qs(t.x,t.y,t.z),c=new Ul(0,0,0,"XYZ"),h=new Zs,d=new Qs(1,1,1);r&&(d=new Qs(r.x,r.y,r.z)),n&&c.set(n.x,n.y,n.z);var f,p=new kl;if(h.setFromEuler(c),p.compose(u,h,d),o.hatch||o.full)i.setMatrixAt(a,p),o.hatch&&(i.setColorAt(a,OF.whiteColor),ij||(u.x-=.35,u.y-=.05,u.z+=.35,(f=new kl).compose(u,h,d),i.setMatrixAt(Math.floor(l/2+a),f),i.setColorAt(Math.floor(l/2+a),OF.whiteColor))),o.full&&(ij?i.setColorAt(a,OF.blackColor):(i.setColorAt(a,OF.redColor),u.x-=.35,u.y-=.05,u.z+=.35,(f=new kl).compose(u,h,d),i.setMatrixAt(l/2+a,f),i.setColorAt(l/2+a,OF.cyanColor)));else if(o.lines){var m=new kl,v=new Qs(0,0,0);m.compose(u,h,v),i.setMatrixAt(a,m)}i.hasOwnProperty("isBox")||(s.userData.Params.pos.push(t.x,t.y,t.z),s.userData.Params.rot.push(h.x,h.y,h.z,h.w),s.userData.Params.scale.push(d.x,d.y,d.z),ij||(s.userData.ParamsCyan.pos.push(t.x-.35,t.y-.05,t.z+.35),s.userData.ParamsCyan.rot.push(h.x,h.y,h.z,h.w),s.userData.ParamsCyan.scale.push(d.x,d.y,d.z))),i.hasOwnProperty("isBox")&&(dU.rot.push(h.x,h.y,h.z,h.w),ij||fU.rot.push(h.x,h.y,h.z,h.w))},HU=function(e,t){for(var n in Ix={},e.forEach((function(e){"PlaneGeometry"!=e.geometry.type&&Ox(e.geometry)})),zU=0,Ix)Ix[n].forEach((function(e){if("BoxGeometry"===e.geometry.type)e.count++,ij||(e.count=Math.floor(2*e.count)),zU+=e.count,e.instanceNum=0,e.instancedMesh={isBox:!0,parameters:e.args};else if(e.count>1){e.count++,ij||(e.count=Math.floor(2*e.count+2)),e.instancedMesh=new cp(e.geometry,OF.whiteFull,e.count),e.instancedMesh.geometry.center(),e.instancedMesh.instanceMatrix.needsUpdate=!0,t.push(e.instancedMesh),e.instanceNum=0;var n=new Cm(e.instancedMesh.geometry);n.setAttribute("linewidth",new np(new Float32Array([5]),1));var r=(new Cg).copy(n);r.center(),r.instanceCount=1/0;var i=ij?OF.blackLine:OF.redLine;if(i.needsUpdate=!0,e.instanceEdges=new Bp(r,i),e.instanceEdges.frustumCulled=!1,e.instanceEdges.userData.Params={pos:[],rot:[],scale:[]},!ij){var a=new Cm(e.instancedMesh.geometry),o=(new Cg).copy(a);o.center(),o.instanceCount=1/0,e.instanceEdgesCyan=new Bp(o,OF.cyanLine),OF.cyanLine.needsUpdate=!0,e.instanceEdges.frustumCulled=!1,e.instanceEdges.userData.ParamsCyan={pos:[],rot:[],scale:[]}}}else e.instanceNum=-1}));if(zU>0){(uU=new cp(new dc(1,1,1),OF.whiteFull,zU)).instanceMatrix.needsUpdate=!0;var r=new Cm(uU.geometry),i=(new Cg).copy(r);i.center(),i.instanceCount=1/0;var a,o=ij?OF.blackLine:OF.redLine;(cU=new Bp(i,o)).frustumCulled=!1,dU={pos:[],rot:[],scale:[]},ij||((a=(new Cg).copy(r)).center(),a.instanceCount=1/0,(hU=new Bp(a,OF.cyanLine)).frustumCulled=!1,fU={pos:[],rot:[],scale:[]}),UU=1}for(var s in e.forEach((function(e){var n=Ox(e.geometry);if(e.hasOwnProperty("parentGroup")&&(n.instanceNum=-1),e.hasOwnProperty("position")&&(e.pos=e.position),e.hasOwnProperty("rotation")&&(e.rot=e.position),e.attributes){var r=new qu;r.setAttribute("position",new ku(e.attributes.positions,3)),n.geometry=r,n.edges=new Cm(r),n.instanceNum=-1}n.instanceNum>-1||"BoxGeometry"===n.geometry.type&&!e.hasOwnProperty("parentGroup")?e.hatch||e.full?(FU({pos:e.pos,rot:e.rot,scale:e.scale,mesh:n.instancedMesh,i:n.instanceNum,fig:e,lines:n.instanceEdges,count:n.count}),n.instanceNum++):FU({pos:e.pos,rot:e.rot,scale:e.scale,mesh:n.instancedMesh,i:n.instanceNum,fig:e,lines:n.instanceEdges,count:n.count}):function(e,t,n){var r;(e.hatch||e.full||e.lines)&&(n&&(r=function(e,t,n,r){var i=[],a=!!t&&OF.whiteFull;if(ij){if(a=n?OF.blackFull:a,n||t){var o=new cc(e.geometry,a);o.userData.color="black",i.push(o)}r&&((r=new Bp(e.edges,OF.blackLineLone)).userData.color="black",i.push(r))}else{if(n||t){a=n?OF.redFull:a;var s=new cc(e.geometry,a);s.userData.color="red",a=n?OF.cyanFull:a;var l=new cc(e.geometry,a);l.userData.color="cyan",i.push(s,l)}if(r){var u=new Bp(e.edges,OF.redLineLone);u.userData.color="red";var c=new Bp(e.edges,OF.cyanLineLone);c.userData.color="cyan",i.push(u,c)}}return i}(n,e.hatch,e.full,e.lines)),r.forEach((function(n){e.hasOwnProperty("uncentered")&&e.uncentered||n.geometry.center(),n.position.set(e.pos.x,e.pos.y,e.pos.z),"cyan"===n.userData.color&&(n.position.x-=.35,n.position.y-=.05,n.position.z+=.35),e.hasOwnProperty("rot")&&n.rotation.set(e.rot.x,e.rot.y,e.rot.z),e.hasOwnProperty("scale")&&n.scale.set(e.scale.x+.01,e.scale.y+.01,e.scale.z+.01),e.hasOwnProperty("parentGroup")?jU[e.parentGroup].add(n):t.push(n)})))}(e,t,n)})),uU&&i&&(i.setAttribute("instT",new np(new Float32Array(dU.pos),3)),i.setAttribute("instR",new np(new Float32Array(dU.rot),4)),i.setAttribute("instS",new np(new Float32Array(dU.scale),3)),t.push(uU,cU),ij||(a.setAttribute("instT",new np(new Float32Array(fU.pos),3)),a.setAttribute("instR",new np(new Float32Array(fU.rot),4)),a.setAttribute("instS",new np(new Float32Array(fU.scale),3)),t.push(hU)),uU.instanceColor&&(uU.instanceColor.needsUpdate=!0)),Ix)Ix[s].forEach((function(e){e.hasOwnProperty("instanceMesh")&&(e.instanceMesh.instanceColor.needsUpdate=!0),e.hasOwnProperty("instanceEdges")&&(e.instanceEdges.geometry.setAttribute("instT",new np(new Float32Array(e.instanceEdges.userData.Params.pos),3)),e.instanceEdges.geometry.setAttribute("instR",new np(new Float32Array(e.instanceEdges.userData.Params.rot),4)),e.instanceEdges.geometry.setAttribute("instS",new np(new Float32Array(e.instanceEdges.userData.Params.scale),3)),t.push(e.instanceEdges),ij||(e.instanceEdgesCyan.geometry.setAttribute("instT",new np(new Float32Array(e.instanceEdges.userData.ParamsCyan.pos),3)),e.instanceEdgesCyan.geometry.setAttribute("instR",new np(new Float32Array(e.instanceEdges.userData.ParamsCyan.rot),4)),e.instanceEdgesCyan.geometry.setAttribute("instS",new np(new Float32Array(e.instanceEdges.userData.ParamsCyan.scale),3)),t.push(e.instanceEdgesCyan)))}))},jU={},GU=function(e,t,n,r){var i=!1,a=[],o=[];for(var s in function(e){if(jU={},e)for(var t in e){var n=e[t];jU[t]=new lf,n.hasOwnProperty("pos")&&jU[t].position.set(n.pos.x,n.pos.y,n.pos.z),n.hasOwnProperty("rot")&&jU[t].rotation.set(n.rot.x,n.rot.y,n.rot.z)}}(n),HU(t,a),jU){var l=jU[s];(new tl).setFromObject(l).getCenter(l.position).multiplyScalar(-1),a.push(l)}var u=new lf;if(u.userData.color="red",r.hasOwnProperty("commune")&&(i=!0),"roomGroup"===e.name){if(function(){for(var t=0;t<a.length;t++)if("roomGroup"===e.name){if(a[t].isGroup||a[t].isLineSegments){if(a[t].isGroup){var n=[];a[t].updateWorldMatrix(!1,!0),a[t].children.forEach((function(e){if(e.material===OF.whiteFull){e.updateMatrixWorld(!0);var t=e.geometry.clone();for(var r in t.applyMatrix4(e.matrixWorld),t.attributes)"position"!==r&&t.deleteAttribute(r);(t=t.toNonIndexed()).index=null,n.push(t)}}));var r=Sx(n,!1);r.userData.groupMerged=!0,o.push(r)}}else a[t].userData.groupMerged=!1,o.push(a[t]);u.add(a[t])}}(),!i||r.finalCommune){var c={name:WU.room.name,id:WU.room.blockchain+"/"+WU.room.contract+"/"+WU.room.token_id};"tezos/KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE/540571"===c.id&&(c.id="tutorial",c.name="tutorial"),yP(o,!1,!1),iB($N.server,$N.name,c)}wG()}else a.forEach((function(e){return u.add(e)}));var h=!1;if("movingGroup"===e.name)if(u.userData.tokenType="sculpture",u.userData.sculptureMetaData=r.metadata,r.loc){e=uG;var d=r.loc;u.position.set(DU(d.position.x),DU(d.position.y),DU(d.position.z)),u.rotation.set(DU(d.rotation.x),DU(d.rotation.y),DU(d.rotation.z)),u.scale.set(DU(d.scale.x),DU(d.scale.y),DU(d.scale.z)),h=!0,uG.attach(u),bP()}else u.position.z-=4,BU(u);h||(u.children.forEach((function(e){e.isLineSegments||(e.castShadow=!0,e.receiveShadow=!0)})),e.add(u)),setTimeout((function(){oI()}),400),console.log("%cLoading new anaver.se native content.","font-weight:bolder;text-decoration:underline"),r.gallery&&(console.log("%cBuilding gallery.","font-weight:bolder;text-decoration:underline"),r.gallery.hasOwnProperty("gallery")&&(nB()&&TL&&"tutorial"!=$N.space.id&&!r.gallery.gallery[0].hasOwnProperty("isSingleTemplate")?r.gallery.gallery.forEach((function(e){var t="",n=["x","y","z"];["position","rotation","scale"].forEach((function(r){n.forEach((function(n){return t+=JSON.stringify(e[r][n])}))})),HN.emit("".concat($N.space.id,"-WORLDITEM"),JSON.stringify({item:e,id:t}))})):_U(r.gallery.gallery)))},VU=[],WU={room:{},skybox:{},gallery:[]},qU={},XU=0,YU=function(e,t){return WU[e]=t},KU=new Worker(new URL(n.p+n.u(560),n.b));"undefined"!=typeof OffscreenCanvas?mU=new Worker(new URL(n.p+n.u(96),n.b)):setTimeout((function(){console.log("This browser does not support offscreen canvas."),fj()}),250);var JU=!0,ZU=["PAINTING THE SKIES","CALLING THE UNIVERSE","SHUFFLING THE COSMOS","GENERATING INFINITY","UPSETTING SAFARI","OVERLOADING CANVAS2D","MOVING PIXELS AROUND","#100%CODE #LANDSCAPE"],QU=["CHANGING LOCATION","GOING SOMEWHERE ELSE","PLANNING ESCAPE","BEAM ME UP SCOTTY","VERSING ANA","THIS IS A TRUE STORY","GENERATING VERTICES","INSTANCIATING MESHES","UNFRIENDING GPU","INTERSECTING ART & TECHNOLOGY","LOOKING FOR ORDER AND CHAOS","MIDCURVING ARCHITECTURE","CONNECTING TO SELF"],$U=function(e){return e[Math.floor(Math.random()*e.length)]},ez=function(e,t){var n=t.toUpperCase();"firstPerson"===e?(document.getElementById("firstPersonLegendR").innerText=n,document.getElementById("firstPersonLegendG").innerText=n):"room"===e&&(document.getElementById("roomLegendR").innerText=n,document.getElementById("roomLegendG").innerText=n)},tz=function(e,t){setInterval((function(){VU.forEach((function(e){e.bbox.containsPoint(gG.position)&&ez("room",e.name)}))}),2e3);var n=[];e.hasOwnProperty("gallery_id")||(e.name=e.name.substring(0,e.name.lastIndexOf("#")-1),e.gallery_id=_N[e.name].gallery_id),(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(pU||(pU=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n      query getAllIterations($galleryId: String) {\n        gallery(where: { gallery_id: { _eq: $galleryId } }) {\n          tokens(order_by: { id: asc }) {\n            fa_contract\n            token_id\n            token {\n              name\n              artifact_uri\n              ophash\n              holders(\n                limit: 1\n                order_by: { last_incremented_at: desc_nulls_last }\n              ) {\n                holder {\n                  alias\n                }\n              }\n              attributes {\n                attribute {\n                  name\n                  value\n                }\n              }\n            }\n          }\n        }\n      }\n    "]))),{galleryId:e.gallery_id}).then((function(r){for(var i=function(){var e=r.gallery[0].tokens[a],t=e.token.artifact_uri,i=t.replace("ipfs://","").substring(t.indexOf("/?fxhash")+2,t.indexOf("/?fxhash")+53),o="";e.token.holders[0].holder.alias&&(o=e.token.holders[0].holder.alias+"'S "),e.token.attributes.forEach((function(e){"name"!==e.attribute.name&&"Name"!==e.attribute.name||(o+=e.attribute.value)})),o=o.toUpperCase(),n.push({hash:i,name:o})},a=0;a<r.gallery[0].tokens.length;a++)i();WU.room={contract:r.gallery[0].tokens[0].fa_contract,token_id:r.gallery[0].tokens[0].token_id,name:e.name,blockchain:e.chain},KU.postMessage({figuresUrl:e.figuresUrl,hash:n,type:"world",tag:{room:!0},name:"Commune",gallery:t})})),Tj()},nz=function(e,t,n,i,a,o){switch(0===r["Tlchargement premier espace"].dbut&&(r["Tlchargement premier espace"].dbut=performance.now()),e.type){case"skybox":e.hasOwnProperty("tag")&&(WU.skybox={contract:e.contract,token_id:t,name:i,blockchain:e.chain});var s=1.75*window.innerHeight,l=e.skyboxUrl;oI($U(ZU)),"undefined"!=typeof OffscreenCanvas&&mU.postMessage({side:s,skyurl:l,hash:n});break;default:var u;if(e.hasOwnProperty("tag")){u=e.tag,e.tag.room&&(WU.room={contract:e.contract,token_id:t,name:i,blockchain:e.chain},WU.gallery=[]),zN(),u.room&&oI($U(QU));var c={blockchain:e.chain,contract:e.contract,token_id:t};KU.postMessage({figuresUrl:e.figuresUrl,hash:n,type:e.type,tag:u,name:i,loc:a,genid:e.id,objktid:t,gallery:o,metadata:c});break}}};"undefined"!=typeof OffscreenCanvas&&(mU.onmessage=function(e){6==++XU?(qU[e.data.pos]=e.data.imagedata,TG(qU,e.data.side),qU={},XU=0):qU[e.data.pos]=e.data.imagedata});function rz(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||lz(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iz(){return iz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iz.apply(this,arguments)}function az(e){return az="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},az(e)}function oz(){return oz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vz(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},oz.apply(this,arguments)}function sz(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=lz(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function lz(e,t){if(e){if("string"==typeof e)return uz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uz(e,t):void 0}}function uz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fz(r.key),r)}}function dz(e,t,n){return t&&hz(e.prototype,t),n&&hz(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function fz(e){var t=function(e,t){if("object"!=az(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=az(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==az(t)?t:String(t)}function pz(e,t,n){return t=vz(t),function(e,t){if(t&&("object"===az(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,mz()?Reflect.construct(t,n||[],vz(e).constructor):t.apply(e,n))}function mz(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(mz=function(){return!!e})()}function vz(e){return vz=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vz(e)}function gz(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yz(e,t)}function yz(e,t){return yz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yz(e,t)}KU.onmessage=function(e){return function(e){switch(e.type){case"purge":oG.clear(),uG.clear(),lG.clear(),function(){Lj(1);var e=[new cc(new Ic(0,0))];e[0].position.y=-20,yP(e)}(),clearInterval(void 0);break;case"firstPerson":if(oG.clear(),GU(oG,e.figures,e.groups,e),oG.scale.set(.1,.1,.1),e.features.hasOwnProperty("fpLoc")){var t=e.features.fpLoc;oG.rotation.set(t.rot.x,t.rot.y,t.rot.z),oG.position.set(t.pos.x,t.pos.y,t.pos.z)}else oG.position.set(.1,-.11,-.1),oG.rotation.y=-Math.PI/2;"string"==typeof e.name&&ez(e.type,e.name);break;case"world":e.tag.room?(yG&&(yG.moveSpeed=100),uG.clear(),e.hasOwnProperty("commune")||lG.clear(),JU&&(JU=!1,r["Tlchargement premier espace"].fin=performance.now(),r["Cration Monde"].dbut=performance.now()),e.gallery&&e.gallery.hasOwnProperty("startPoint")&&(e.startPoint=e.gallery.startPoint),e.hasOwnProperty("startPoint")?function(e){UN=e}(e.startPoint):WU.hasOwnProperty("startPoint")?WU.startPoint&&YU("startPoint",WU.startPoint):zN(),UN?(gG.position.x=UN.position.x,gG.position.y=UN.position.y,gG.position.z=UN.position.z,gG.lookAt(UN.position.x+UN.direction.x,UN.position.y+UN.direction.y,UN.position.z+UN.direction.z)):(gG.position.x=0,gG.position.y=3,gG.position.z=0,zN()),e.features,"string"==typeof e.name&&ez("room",e.name),e.hasOwnProperty("commune")||lG.clear(),GU(lG,e.figures,e.groups,e),ij||(lG.children[0].position.z=.1)):e.tag.item&&GU(cG,e.figures,e.groups,e)}}(e.data)};var bz=function(e){function t(e){var n;return cz(this,t),(n=pz(this,t,[e])).dracoLoader=null,n.ktx2Loader=null,n.meshoptDecoder=null,n.pluginCallbacks=[],n.register((function(e){return new Sz(e)})),n.register((function(e){return new Oz(e)})),n.register((function(e){return new Dz(e)})),n.register((function(e){return new Nz(e)})),n.register((function(e){return new Az(e)})),n.register((function(e){return new kz(e)})),n.register((function(e){return new Pz(e)})),n.register((function(e){return new Rz(e)})),n.register((function(e){return new Tz(e)})),n.register((function(e){return new Cz(e)})),n.register((function(e){return new Mz(e)})),n.register((function(e){return new Iz(e)})),n.register((function(e){return new Lz(e)})),n.register((function(e){return new _z(e)})),n.register((function(e){return new Bz(e)})),n.register((function(e){return new Uz(e)})),n}return gz(t,e),dz(t,[{key:"load",value:function(e,t,n,r){var i,a=this;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){var o=Rg.extractUrlBase(e);i=Rg.resolveURL(o,this.path)}else i=Rg.extractUrlBase(e);this.manager.itemStart(e);var s=function(t){r?r(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},l=new rg(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(n){try{a.parse(n,i,(function(n){t(n),a.manager.itemEnd(e)}),s)}catch(e){s(e)}}),n,s)}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(e){return this.ktx2Loader=e,this}},{key:"setMeshoptDecoder",value:function(e){return this.meshoptDecoder=e,this}},{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,n,r){var i,a={},o={},s=new TextDecoder;if("string"==typeof e)i=JSON.parse(e);else if(e instanceof ArrayBuffer)if(s.decode(new Uint8Array(e,0,4))===zz){try{a[wz.KHR_BINARY_GLTF]=new Fz(e)}catch(e){return void(r&&r(e))}i=JSON.parse(a[wz.KHR_BINARY_GLTF].content)}else i=JSON.parse(s.decode(e));else i=e;if(void 0===i.asset||i.asset.version[0]<2)r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var l=new uF(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(var u=0;u<this.pluginCallbacks.length;u++){var c=this.pluginCallbacks[u](l);c.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[c.name]=c,a[c.name]=!0}if(i.extensionsUsed)for(var h=0;h<i.extensionsUsed.length;++h){var d=i.extensionsUsed[h],f=i.extensionsRequired||[];switch(d){case wz.KHR_MATERIALS_UNLIT:a[d]=new Ez;break;case wz.KHR_DRACO_MESH_COMPRESSION:a[d]=new Hz(i,this.dracoLoader);break;case wz.KHR_TEXTURE_TRANSFORM:a[d]=new jz;break;case wz.KHR_MESH_QUANTIZATION:a[d]=new Gz;break;default:f.indexOf(d)>=0&&void 0===o[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(a),l.setPlugins(o),l.parse(n,r)}}},{key:"parseAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.parse(e,t,r,i)}))}}]),t}($v);function xz(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var wz={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},_z=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return dz(e,[{key:"_markDefs",value:function(){for(var e=this.parser,t=this.parser.json.nodes||[],n=0,r=t.length;n<r;n++){var i=t[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}},{key:"_loadLight",value:function(e){var t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;var i,a=t.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],s=new vu(16777215);void 0!==o.color&&s.setRGB(o.color[0],o.color[1],o.color[2],po);var l=void 0!==o.range?o.range:0;switch(o.type){case"directional":(i=new Tg(s)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new _g(s)).distance=l;break;case"spot":(i=new gg(s)).distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return i.position.set(0,0,0),i.decay=2,rF(i,o),void 0!==o.intensity&&(i.intensity=o.intensity),i.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(i),t.cache.add(n,r),r}},{key:"getDependency",value:function(e,t){if("light"===e)return this._loadLight(t)}},{key:"createNodeAttachment",value:function(e){var t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return n._getNodeRef(t.cache,i,e)}))}}]),e}(),Ez=function(){function e(){cz(this,e),this.name=wz.KHR_MATERIALS_UNLIT}return dz(e,[{key:"getMaterialType",value:function(){return xu}},{key:"extendParams",value:function(e,t,n){var r=[];e.color=new vu(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var a=i.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],po),e.opacity=a[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture,fo))}return Promise.all(r)}}]),e}(),Tz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_EMISSIVE_STRENGTH}return dz(e,[{key:"extendMaterialParams",value:function(e,t){var n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}]),e}(),Sz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_CLEARCOAT}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){var o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new bs(o,o)}return Promise.all(i)}}]),e}(),Mz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_IRIDESCENCE}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&i.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&i.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(i)}}]),e}(),Az=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_SHEEN}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[];t.sheenColor=new vu(0,0,0),t.sheenRoughness=0,t.sheen=1;var a=r.extensions[this.name];if(void 0!==a.sheenColorFactor){var o=a.sheenColorFactor;t.sheenColor.setRGB(o[0],o[1],o[2],po)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,fo)),void 0!==a.sheenRoughnessTexture&&i.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}]),e}(),kz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_TRANSMISSION}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)}}]),e}(),Pz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_VOLUME}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;var o=a.attenuationColor||[1,1,1];return t.attenuationColor=(new vu).setRGB(o[0],o[1],o[2],po),Promise.all(i)}}]),e}(),Rz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_IOR}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}]),e}(),Cz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_SPECULAR}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));var o=a.specularColorFactor||[1,1,1];return t.specularColor=(new vu).setRGB(o[0],o[1],o[2],po),void 0!==a.specularColorTexture&&i.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,fo)),Promise.all(i)}}]),e}(),Lz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.EXT_MATERIALS_BUMP}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];return t.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&i.push(n.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(i)}}]),e}(),Iz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_MATERIALS_ANISOTROPY}return dz(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ev:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&i.push(n.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(i)}}]),e}(),Oz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.KHR_TEXTURE_BASISU}return dz(e,[{key:"loadTexture",value:function(e){var t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;var i=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i.source,a)}}]),e}(),Dz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.EXT_TEXTURE_WEBP,this.isSupported=null}return dz(e,[{key:"loadTexture",value:function(e){var t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;var a=i.extensions[t],o=r.images[a.source],s=n.textureLoader;if(o.uri){var l=n.options.manager.getHandler(o.uri);null!==l&&(s=l)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(e,a.source,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}]),e}(),Nz=function(){function e(t){cz(this,e),this.parser=t,this.name=wz.EXT_TEXTURE_AVIF,this.isSupported=null}return dz(e,[{key:"loadTexture",value:function(e){var t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;var a=i.extensions[t],o=r.images[a.source],s=n.textureLoader;if(o.uri){var l=n.options.manager.getHandler(o.uri);null!==l&&(s=l)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(e,a.source,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}]),e}(),Bz=function(){function e(t){cz(this,e),this.name=wz.EXT_MESHOPT_COMPRESSION,this.parser=t}return dz(e,[{key:"loadBufferView",value:function(e){var t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],i=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then((function(e){var t=r.byteOffset||0,n=r.byteLength||0,i=r.count,o=r.byteStride,s=new Uint8Array(e,t,n);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(i,o,s,r.mode,r.filter).then((function(e){return e.buffer})):a.ready.then((function(){var e=new ArrayBuffer(i*o);return a.decodeGltfBuffer(new Uint8Array(e),i,o,s,r.mode,r.filter),e}))}))}return null}}]),e}(),Uz=function(){function e(t){cz(this,e),this.name=wz.EXT_MESH_GPU_INSTANCING,this.parser=t}return dz(e,[{key:"createNodeMesh",value:function(e){var t=this,n=this.parser.json,r=n.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;var i,a=sz(n.meshes[r.mesh].primitives);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(o.mode!==Xz.TRIANGLES&&o.mode!==Xz.TRIANGLE_STRIP&&o.mode!==Xz.TRIANGLE_FAN&&void 0!==o.mode)return null}}catch(e){a.e(e)}finally{a.f()}var s=r.extensions[this.name].attributes,l=[],u={},c=function(e){l.push(t.parser.getDependency("accessor",s[e]).then((function(t){return u[e]=t,u[e]})))};for(var h in s)c(h);return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then((function(e){var n,r=e.pop(),i=r.isGroup?r.children:[r],a=e[0].count,o=[],s=sz(i);try{for(s.s();!(n=s.n()).done;){for(var l=n.value,c=new kl,h=new Qs,d=new Zs,f=new Qs(1,1,1),p=new cp(l.geometry,l.material,a),m=0;m<a;m++)u.TRANSLATION&&h.fromBufferAttribute(u.TRANSLATION,m),u.ROTATION&&d.fromBufferAttribute(u.ROTATION,m),u.SCALE&&f.fromBufferAttribute(u.SCALE,m),p.setMatrixAt(m,c.compose(h,d,f));for(var v in u)if("_COLOR_0"===v){var g=u[v];p.instanceColor=new np(g.array,g.itemSize,g.normalized)}else"TRANSLATION"!==v&&"ROTATION"!==v&&"SCALE"!==v&&l.geometry.setAttribute(v,u[v]);$l.prototype.copy.call(p,l),t.parser.assignFinalMaterial(p),o.push(p)}}catch(e){s.e(e)}finally{s.f()}return r.isGroup?(r.clear(),r.add.apply(r,o),r):o[0]})))}}]),e}(),zz="glTF",Fz=dz((function e(t){cz(this,e),this.name=wz.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(t,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==zz)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var i=this.header.length-12,a=new DataView(t,12),o=0;o<i;){var s=a.getUint32(o,!0);o+=4;var l=a.getUint32(o,!0);if(o+=4,1313821514===l){var u=new Uint8Array(t,12+o,s);this.content=r.decode(u)}else if(5130562===l){var c=12+o;this.body=t.slice(c,c+s)}o+=s}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")})),Hz=function(){function e(t,n){if(cz(this,e),!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=wz.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}return dz(e,[{key:"decodePrimitive",value:function(e,t){var n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},l={};for(var u in a){var c=Qz[u]||u.toLowerCase();o[c]=a[u]}for(var h in e.attributes){var d=Qz[h]||h.toLowerCase();if(void 0!==a[h]){var f=n.accessors[e.attributes[h]],p=Yz[f.componentType];l[d]=p.name,s[d]=!0===f.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t,n){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}t(e)}),o,l,po,n)}))}))}}]),e}(),jz=function(){function e(){cz(this,e),this.name=wz.KHR_TEXTURE_TRANSFORM}return dz(e,[{key:"extendTexture",value:function(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}]),e}(),Gz=dz((function e(){cz(this,e),this.name=wz.KHR_MESH_QUANTIZATION})),Vz=function(e){function t(e,n,r,i){return cz(this,t),pz(this,t,[e,n,r,i])}return gz(t,e),dz(t,[{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,a=0;a!==r;a++)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,u=r-t,c=(n-t)/u,h=c*c,d=h*c,f=e*l,p=f-l,m=-2*d+3*h,v=d-h,g=1-m,y=v-h+c,b=0;b!==o;b++){var x=a[p+b+o],w=a[p+b+s]*u,_=a[f+b+o],E=a[f+b]*u;i[b]=g*x+y*w+m*_+v*E}return i}}]),t}(Nv),Wz=new Zs,qz=function(e){function t(){return cz(this,t),pz(this,t,arguments)}return gz(t,e),dz(t,[{key:"interpolate_",value:function(e,n,r,i){var a=oz(vz(t.prototype),"interpolate_",this).call(this,e,n,r,i);return Wz.fromArray(a).normalize().toArray(a),a}}]),t}(Vz),Xz={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Yz={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Kz={9728:Di,9729:Fi,9984:Ni,9985:Hi,9986:Ui,9987:Gi},Jz={33071:Ii,33648:Oi,10497:Li},Zz={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qz={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},$z={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},eF={CUBICSPLINE:void 0,LINEAR:Ka,STEP:Ya};function tF(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new _v({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Rr})),e.DefaultMaterial}function nF(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function rF(e,t){void 0!==t.extras&&("object"===az(t.extras)?iz(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function iF(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(var a=0,o=i.length;a<o;a++)e.morphTargetDictionary[i[a]]=a}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function aF(e){var t,n=e.extensions&&e.extensions[wz.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+oF(n.attributes):e.indices+":"+oF(e.attributes)+":"+e.mode,void 0!==e.targets)for(var r=0,i=e.targets.length;r<i;r++)t+=":"+oF(e.targets[r]);return t}function oF(e){for(var t="",n=Object.keys(e).sort(),r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function sF(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var lF=new kl,uF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};cz(this,e),this.json=t,this.extensions={},this.plugins={},this.options=n,this.cache=new xz,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};var r=!1,i=!1,a=-1;"undefined"!=typeof navigator&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),a=(i=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||i&&a<98?this.textureLoader=new ug(this.options.manager):this.textureLoader=new Bg(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new rg(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return dz(e,[{key:"setExtensions",value:function(e){this.extensions=e}},{key:"setPlugins",value:function(e){this.plugins=e}},{key:"parse",value:function(e,t){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){var a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};return nF(i,a,r),rF(a,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){e(a)}))})).catch(t)}},{key:"_markDefs",value:function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r=0,i=t.length;r<i;r++)for(var a=t[r].joints,o=0,s=a.length;o<s;o++)e[a[o]].isBone=!0;for(var l=0,u=e.length;l<u;l++){var c=e[l];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(n[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}}},{key:"_addNodeRef",value:function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}},{key:"_getNodeRef",value:function(e,t,n){var r=this;if(e.refs[t]<=1)return n;var i=n.clone();return function e(t,n){var i=r.associations.get(t);null!=i&&r.associations.set(n,i);var a,o=sz(t.children.entries());try{for(o.s();!(a=o.n()).done;){var s=rz(a.value,2),l=s[0];e(s[1],n.children[l])}}catch(e){o.e(e)}finally{o.f()}}(n,i),i.name+="_instance_"+e.uses[t]++,i}},{key:"_invokeOne",value:function(e){var t=Object.values(this.plugins);t.push(this);for(var n=0;n<t.length;n++){var r=e(t[n]);if(r)return r}return null}},{key:"_invokeAll",value:function(e){var t=Object.values(this.plugins);t.unshift(this);for(var n=[],r=0;r<t.length;r++){var i=e(t[r]);i&&n.push(i)}return n}},{key:"getDependency",value:function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:if(!(r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)}))))throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}},{key:"getDependencies",value:function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}},{key:"loadBuffer",value:function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[wz.KHR_BINARY_GLTF].body);var r=this.options;return new Promise((function(e,i){n.load(Rg.resolveURL(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}},{key:"loadBufferView",value:function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}},{key:"loadAccessor",value:function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){var i=Zz[r.type],a=Yz[r.componentType],o=!0===r.normalized,s=new a(r.count*i);return Promise.resolve(new ku(s,i,o))}var l=[];return void 0!==r.bufferView?l.push(this.getDependency("bufferView",r.bufferView)):l.push(null),void 0!==r.sparse&&(l.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),l.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(l).then((function(e){var i,a,o=e[0],s=Zz[r.type],l=Yz[r.componentType],u=l.BYTES_PER_ELEMENT,c=u*s,h=r.byteOffset||0,d=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,f=!0===r.normalized;if(d&&d!==c){var p=Math.floor(h/d),m="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+p+":"+r.count,v=t.cache.get(m);v||(i=new l(o,p*d,r.count*d/u),v=new xf(i,d/u),t.cache.add(m,v)),a=new _f(v,s,h%d/u,f)}else i=null===o?new l(r.count*s):new l(o,h,r.count*s),a=new ku(i,s,f);if(void 0!==r.sparse){var g=Zz.SCALAR,y=Yz[r.sparse.indices.componentType],b=r.sparse.indices.byteOffset||0,x=r.sparse.values.byteOffset||0,w=new y(e[1],b,r.sparse.count*g),_=new l(e[2],x,r.sparse.count*s);null!==o&&(a=new ku(a.array.slice(),a.itemSize,a.normalized));for(var E=0,T=w.length;E<T;E++){var S=w[E];if(a.setX(S,_[E*s]),s>=2&&a.setY(S,_[E*s+1]),s>=3&&a.setZ(S,_[E*s+2]),s>=4&&a.setW(S,_[E*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))}},{key:"loadTexture",value:function(e){var t=this.json,n=this.options,r=t.textures[e].source,i=t.images[r],a=this.textureLoader;if(i.uri){var o=n.manager.getHandler(i.uri);null!==o&&(a=o)}return this.loadTextureImage(e,r,a)}},{key:"loadTextureImage",value:function(e,t,n){var r=this,i=this.json,a=i.textures[e],o=i.images[t],s=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[s])return this.textureCache[s];var l=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);var n=(i.samplers||{})[a.sampler]||{};return t.magFilter=Kz[n.magFilter]||Fi,t.minFilter=Kz[n.minFilter]||Gi,t.wrapS=Jz[n.wrapS]||Li,t.wrapT=Jz[n.wrapT]||Li,r.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[s]=l,l}},{key:"loadImageSource",value:function(e,t){var n=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((function(e){return e.clone()}));var i=n.images[e],a=self.URL||self.webkitURL,o=i.uri||"",s=!1;if(void 0!==i.bufferView)o=this.getDependency("bufferView",i.bufferView).then((function(e){s=!0;var t=new Blob([e],{type:i.mimeType});return o=a.createObjectURL(t)}));else if(void 0===i.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");var l=Promise.resolve(o).then((function(e){return new Promise((function(n,i){var a=n;!0===t.isImageBitmapLoader&&(a=function(e){var t=new js(e);t.needsUpdate=!0,n(t)}),t.load(Rg.resolveURL(e,r.path),a,void 0,i)}))})).then((function(e){var t;return!0===s&&a.revokeObjectURL(o),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e}));return this.sourceCache[e]=l,l}},{key:"assignTexture",value:function(e,t,n,r){var i=this;return this.getDependency("texture",n.index).then((function(a){if(!a)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((a=a.clone()).channel=n.texCoord),i.extensions[wz.KHR_TEXTURE_TRANSFORM]){var o=void 0!==n.extensions?n.extensions[wz.KHR_TEXTURE_TRANSFORM]:void 0;if(o){var s=i.associations.get(a);a=i.extensions[wz.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),i.associations.set(a,s)}}return void 0!==r&&(a.colorSpace=r),e[t]=a,a}))}},{key:"assignFinalMaterial",value:function(e){var t=e.geometry,n=e.material,r=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){var o="PointsMaterial:"+n.uuid,s=this.cache.get(o);s||(s=new zp,bu.prototype.copy.call(s,n),s.color.copy(n.color),s.map=n.map,s.sizeAttenuation=!1,this.cache.add(o,s)),n=s}else if(e.isLine){var l="LineBasicMaterial:"+n.uuid,u=this.cache.get(l);u||(u=new kp,bu.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,this.cache.add(l,u)),n=u}if(r||i||a){var c="ClonedMaterial:"+n.uuid+":";r&&(c+="derivative-tangents:"),i&&(c+="vertex-colors:"),a&&(c+="flat-shading:");var h=this.cache.get(c);h||(h=n.clone(),i&&(h.vertexColors=!0),a&&(h.flatShading=!0),r&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(c,h),this.associations.set(h,this.associations.get(n))),n=h}e.material=n}},{key:"getMaterialType",value:function(){return _v}},{key:"loadMaterial",value:function(e){var t,n=this,r=this.json,i=this.extensions,a=r.materials[e],o={},s=[];if((a.extensions||{})[wz.KHR_MATERIALS_UNLIT]){var l=i[wz.KHR_MATERIALS_UNLIT];t=l.getMaterialType(),s.push(l.extendParams(o,a,n))}else{var u=a.pbrMetallicRoughness||{};if(o.color=new vu(1,1,1),o.opacity=1,Array.isArray(u.baseColorFactor)){var c=u.baseColorFactor;o.color.setRGB(c[0],c[1],c[2],po),o.opacity=c[3]}void 0!==u.baseColorTexture&&s.push(n.assignTexture(o,"map",u.baseColorTexture,fo)),o.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,o.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(s.push(n.assignTexture(o,"metalnessMap",u.metallicRoughnessTexture)),s.push(n.assignTexture(o,"roughnessMap",u.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),s.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===a.doubleSided&&(o.side=Lr);var h=a.alphaMode||"OPAQUE";if("BLEND"===h?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,"MASK"===h&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==xu&&(s.push(n.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new bs(1,1),void 0!==a.normalTexture.scale)){var d=a.normalTexture.scale;o.normalScale.set(d,d)}if(void 0!==a.occlusionTexture&&t!==xu&&(s.push(n.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==xu){var f=a.emissiveFactor;o.emissive=(new vu).setRGB(f[0],f[1],f[2],po)}return void 0!==a.emissiveTexture&&t!==xu&&s.push(n.assignTexture(o,"emissiveMap",a.emissiveTexture,fo)),Promise.all(s).then((function(){var r=new t(o);return a.name&&(r.name=a.name),rF(r,a),n.associations.set(r,{materials:e}),a.extensions&&nF(i,r,a),r}))}},{key:"createUniqueName",value:function(e){var t=dy.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}},{key:"loadGeometries",value:function(e){var t=this,n=this.extensions,r=this.primitiveCache;function i(e){return n[wz.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return cF(n,e,t)}))}for(var a=[],o=0,s=e.length;o<s;o++){var l=e[o],u=aF(l),c=r[u];if(c)a.push(c.promise);else{var h;h=l.extensions&&l.extensions[wz.KHR_DRACO_MESH_COMPRESSION]?i(l):cF(new qu,l,t),r[u]={primitive:l,promise:h},a.push(h)}}return Promise.all(a)}},{key:"loadMesh",value:function(e){for(var t=this,n=this.json,r=this.extensions,i=n.meshes[e],a=i.primitives,o=[],s=0,l=a.length;s<l;s++){var u=void 0===a[s].material?tF(this.cache):this.getDependency("material",a[s].material);o.push(u)}return o.push(t.loadGeometries(a)),Promise.all(o).then((function(n){for(var o=n.slice(0,n.length-1),s=n[n.length-1],l=[],u=0,c=s.length;u<c;u++){var h=s[u],d=a[u],f=void 0,p=o[u];if(d.mode===Xz.TRIANGLES||d.mode===Xz.TRIANGLE_STRIP||d.mode===Xz.TRIANGLE_FAN||void 0===d.mode)!0===(f=!0===i.isSkinnedMesh?new Jf(h,p):new cc(h,p)).isSkinnedMesh&&f.normalizeSkinWeights(),d.mode===Xz.TRIANGLE_STRIP?f.geometry=Ax(f.geometry,ro):d.mode===Xz.TRIANGLE_FAN&&(f.geometry=Ax(f.geometry,io));else if(d.mode===Xz.LINES)f=new Bp(h,p);else if(d.mode===Xz.LINE_STRIP)f=new Op(h,p);else if(d.mode===Xz.LINE_LOOP)f=new Up(h,p);else{if(d.mode!==Xz.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);f=new Vp(h,p)}Object.keys(f.geometry.morphAttributes).length>0&&iF(f,i),f.name=t.createUniqueName(i.name||"mesh_"+e),rF(f,i),d.extensions&&nF(r,f,d),t.assignFinalMaterial(f),l.push(f)}for(var m=0,v=l.length;m<v;m++)t.associations.set(l[m],{meshes:e,primitives:m});if(1===l.length)return i.extensions&&nF(r,l[0],i),l[0];var g=new lf;i.extensions&&nF(r,g,i),t.associations.set(g,{meshes:e});for(var y=0,b=l.length;y<b;y++)g.add(l[y]);return g}))}},{key:"loadCamera",value:function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new bc(ys.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new Vc(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),rF(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(e){for(var t=this.json.skins[e],n=[],r=0,i=t.joints.length;r<i;r++)n.push(this._loadNodeShallow(t.joints[r]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){for(var n=e.pop(),r=e,i=[],a=[],o=0,s=r.length;o<s;o++){var l=r[o];if(l){i.push(l);var u=new kl;null!==n&&u.fromArray(n.array,16*o),a.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new tp(i,a)}))}},{key:"loadAnimation",value:function(e){for(var t=this.json,n=this,r=t.animations[e],i=r.name?r.name:"animation_"+e,a=[],o=[],s=[],l=[],u=[],c=0,h=r.channels.length;c<h;c++){var d=r.channels[c],f=r.samplers[d.sampler],p=d.target,m=p.node,v=void 0!==r.parameters?r.parameters[f.input]:f.input,g=void 0!==r.parameters?r.parameters[f.output]:f.output;void 0!==p.node&&(a.push(this.getDependency("node",m)),o.push(this.getDependency("accessor",v)),s.push(this.getDependency("accessor",g)),l.push(f),u.push(p))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(s),Promise.all(l),Promise.all(u)]).then((function(e){for(var t=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=[],u=0,c=t.length;u<c;u++){var h=t[u],d=r[u],f=a[u],p=o[u],m=s[u];if(void 0!==h){h.updateMatrix&&h.updateMatrix();var v=n._createAnimationTracks(h,d,f,p,m);if(v)for(var g=0;g<v.length;g++)l.push(v[g])}}return new Yv(i,void 0,l)}))}},{key:"createNodeMesh",value:function(e){var t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){var t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}},{key:"loadNode",value:function(e){for(var t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),i=[],a=n.children||[],o=0,s=a.length;o<s;o++)i.push(t.getDependency("node",a[o]));var l=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(i),l]).then((function(e){var t=e[0],n=e[1],r=e[2];null!==r&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(r,lF)}));for(var i=0,a=n.length;i<a;i++)t.add(n[i]);return t}))}},{key:"_loadNodeShallow",value:function(e){var t=this.json,n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];var i=t.nodes[e],a=i.name?r.createUniqueName(i.name):"",o=[],s=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return s&&o.push(s),void 0!==i.camera&&o.push(r.getDependency("camera",i.camera).then((function(e){return r._getNodeRef(r.cameraCache,i.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){o.push(e)})),this.nodeCache[e]=Promise.all(o).then((function(t){var o;if((o=!0===i.isBone?new Zf:t.length>1?new lf:1===t.length?t[0]:new $l)!==t[0])for(var s=0,l=t.length;s<l;s++)o.add(t[s]);if(i.name&&(o.userData.name=i.name,o.name=a),rF(o,i),i.extensions&&nF(n,o,i),void 0!==i.matrix){var u=new kl;u.fromArray(i.matrix),o.applyMatrix4(u)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return r.associations.has(o)||r.associations.set(o,{}),r.associations.get(o).nodes=e,o})),this.nodeCache[e]}},{key:"loadScene",value:function(e){var t=this.extensions,n=this.json.scenes[e],r=this,i=new lf;n.name&&(i.name=r.createUniqueName(n.name)),rF(i,n),n.extensions&&nF(t,i,n);for(var a=n.nodes||[],o=[],s=0,l=a.length;s<l;s++)o.push(r.getDependency("node",a[s]));return Promise.all(o).then((function(e){for(var t=0,n=e.length;t<n;t++)i.add(e[t]);return r.associations=function(e){var t,n=new Map,i=sz(r.associations);try{for(i.s();!(t=i.n()).done;){var a=rz(t.value,2),o=a[0],s=a[1];(o instanceof bu||o instanceof js)&&n.set(o,s)}}catch(e){i.e(e)}finally{i.f()}return e.traverse((function(e){var t=r.associations.get(e);null!=t&&n.set(e,t)})),n}(i),i}))}},{key:"_createAnimationTracks",value:function(e,t,n,r,i){var a,o=[],s=e.name?e.name:e.uuid,l=[];switch($z[i.path]===$z.weights?e.traverse((function(e){e.morphTargetInfluences&&l.push(e.name?e.name:e.uuid)})):l.push(s),$z[i.path]){case $z.weights:a=Gv;break;case $z.rotation:a=Wv;break;case $z.position:case $z.scale:a=Xv;break;default:a=1===n.itemSize?Gv:Xv}for(var u=void 0!==r.interpolation?eF[r.interpolation]:Ka,c=this._getArrayFromAccessor(n),h=0,d=l.length;h<d;h++){var f=new a(l[h]+"."+$z[i.path],t.array,c,u);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(f),o.push(f)}return o}},{key:"_getArrayFromAccessor",value:function(e){var t=e.array;if(e.normalized){for(var n=sF(t.constructor),r=new Float32Array(t.length),i=0,a=t.length;i<a;i++)r[i]=t[i]*n;t=r}return t}},{key:"_createCubicSplineTrackInterpolant",value:function(e){e.createInterpolant=function(e){return new(this instanceof Wv?qz:Vz)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}]),e}();function cF(e,t,n){var r=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var o in r){var s=Qz[o]||o.toLowerCase();s in e.attributes||i.push(a(r[o],s))}if(void 0!==t.indices&&!e.index){var l=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(l)}return Os.workingColorSpace!==po&&"COLOR_0"in r&&console.warn('THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "'.concat(Os.workingColorSpace,'" not supported.')),rF(e,t),function(e,t,n){var r=t.attributes,i=new tl;if(void 0!==r.POSITION){var a=n.json.accessors[r.POSITION],o=a.min,s=a.max;if(void 0!==o&&void 0!==s){if(i.set(new Qs(o[0],o[1],o[2]),new Qs(s[0],s[1],s[2])),a.normalized){var l=sF(Yz[a.componentType]);i.min.multiplyScalar(l),i.max.multiplyScalar(l)}var u=t.targets;if(void 0!==u){for(var c=new Qs,h=new Qs,d=0,f=u.length;d<f;d++){var p=u[d];if(void 0!==p.POSITION){var m=n.json.accessors[p.POSITION],v=m.min,g=m.max;if(void 0!==v&&void 0!==g){if(h.setX(Math.max(Math.abs(v[0]),Math.abs(g[0]))),h.setY(Math.max(Math.abs(v[1]),Math.abs(g[1]))),h.setZ(Math.max(Math.abs(v[2]),Math.abs(g[2]))),m.normalized){var y=sF(Yz[m.componentType]);h.multiplyScalar(y)}c.max(h)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(c)}e.boundingBox=i;var b=new bl;i.getCenter(b.center),b.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=b}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,i=!1,a=!1,o=0,s=t.length;o<s;o++){var l=t[o];if(void 0!==l.POSITION&&(r=!0),void 0!==l.NORMAL&&(i=!0),void 0!==l.COLOR_0&&(a=!0),r&&i&&a)break}if(!r&&!i&&!a)return Promise.resolve(e);for(var u=[],c=[],h=[],d=0,f=t.length;d<f;d++){var p=t[d];if(r){var m=void 0!==p.POSITION?n.getDependency("accessor",p.POSITION):e.attributes.position;u.push(m)}if(i){var v=void 0!==p.NORMAL?n.getDependency("accessor",p.NORMAL):e.attributes.normal;c.push(v)}if(a){var g=void 0!==p.COLOR_0?n.getDependency("accessor",p.COLOR_0):e.attributes.color;h.push(g)}}return Promise.all([Promise.all(u),Promise.all(c),Promise.all(h)]).then((function(t){var n=t[0],o=t[1],s=t[2];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=o),a&&(e.morphAttributes.color=s),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function hF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}new bz;var dF=new Worker(new URL(n.p+n.u(784),n.b));dF.onmessage=function(e){var t;e.data[1].hasOwnProperty("id")&&NU.apply(void 0,function(e){if(Array.isArray(e))return hF(e)}(t=e.data)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return hF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hF(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())};var fF=function(e,t,n,r,i){MU[t.id].hasOwnProperty("mime")&&MU[t.id].mime&&MU[t.id].mime.substring(0,MU[t.id].mime.indexOf("/")),r&&!i&&r.hasOwnProperty("note")&&(i=r.note),dF.postMessage({img:e,id:t,type:n,location:r,currentRoom:WU.room,note:i})},pF=new ug,mF=function(e){return new Promise((function(t){return pF.load(e,t)}))},vF="rgb(255,0,0)",gF="rgb(0,255,235)",yF=new xu({color:"white",opacity:.85,transparent:!0}),bF=new kp({color:"black",onBeforeCompile:function(e){e.vertexShader="\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ".concat(e.vertexShader,"\n").replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),xF=new kp({color:gF}),wF=new kp({color:"red"}),_F=new kp({color:"black"}),EF=new kp({color:gF,onBeforeCompile:function(e){e.vertexShader="\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ".concat(e.vertexShader,"\n").replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n").replace("uniform float linewidth;","attribute float linewidth;")}}),TF=new kp({color:vF,onBeforeCompile:function(e){e.vertexShader="\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ".concat(e.vertexShader,"\n").replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),SF=new xu({color:vF,side:Lr}),MF=new xu({color:gF,side:Lr}),AF=new xu({color:"white",side:Lr}),kF=new xu({color:"black",side:Lr}),PF=new vu("rgb(0, 0, 0)"),RF=new vu("rgb(255, 255, 255)"),CF=new vu(vF),LF=new vu(gF),IF=new xu({color:"black",side:Lr,transparent:!0,opacity:0}),OF={torcheMaterial:new xu({color:"black",side:Lr,transparent:!0,opacity:0}),blackOpacityFocus:IF,ghost:yF,whiteFull:AF,blackFull:kF,redFull:SF,redLineLone:wF,redLine:TF,cyanFull:MF,cyanLine:EF,red:vF,cyan:gF,blackLine:bF,hatchingMaterial:0,blackColor:PF,whiteColor:RF,blackLineLone:_F,cyanLineLone:xF,redColor:CF,cyanColor:LF},DF={},NF=function(e,t,n){e.source="BritishLibrary";var r=e.region.split(","),i=parseInt(r[2])/parseInt(r[3]),a=parseInt(1400*i);e.size="".concat(a,",").concat(1400);var o="https://api.bl.uk/image/iiif/".concat(e.ark,"/").concat(e.region,"/").concat(e.size,"/").concat(e.rotation,"/default.jpg");if(t)BF(e,o,t,n);else{var s=document.createElement("div");s.className="gentkProfiles";var l=new Image(200*i,200);l.src=o,l.style.padding="10px",l.style.cursor="pointer",DF[l.src]=l,n&&(desc="".concat(n.name," ").concat(n.artist," ")),desc+=e.vueID;var u=document.createElement("div");u.className="artThumbTitle",u.innerHTML='<div class="artistNames">\n                        <span style="color:black;background:transparent;padding:4px;">'.concat(desc,'</span>\n    <span><a href="http://access.bl.uk/item/viewer/').concat(e.documentSource,"#?cv=").concat(e.vueID,'" target="_blank">Open on British Library</a></span></div>'),s.append(l,u),document.getElementById("importedIIIFContent").append(s),l.addEventListener("click",(function(){Tj(),BF(e,o,null,n)}))}},BF=function(e,t,n,r){if(r){r.IIIFdata=e,r.britishLibrary=!0;var i="http://access.bl.uk/item/viewer/".concat(e.documentSource,"#?cv=").concat(e.vueID);r.permalink=i;var a=e.ark+e.vue+Date.now();MU[a]=r,fF(t,{id:a},"IIIF",n)}else fetch("https://api.bl.uk/metadata/iiif/"+e.documentSource+"/manifest.json").then((function(e){return e.json()})).then((function(r){var i={description:"",artist:""};r.metadata.forEach((function(e){switch(e.label){case"Title":i.name=e.value,i.title=e.value;break;case"Date":i.year=e.value;case"Language":case"ShelfMark":i.description+="".concat(e.value," | ")}})),i.IIIFdata=e,i.britishLibrary=!0;var a="http://access.bl.uk/item/viewer/".concat(e.documentSource,"#?cv=").concat(e.vueID);i.permalink=a;var o=e.ark+e.vue+Date.now();MU[o]=i,fF(t,{id:o},"IIIF",n)}))},UF=[],zF=function(e){e.forEach((function(e){switch(e.IIIFdata.source){case"Gallica":jL(e.IIIFdata,e);break;case"BritishLibrary":NF(e.IIIFdata,e)}}))},FF=function(e){if("string"==typeof e)return e;var t="";return e.forEach((function(e){return t+=e["@value"]+" | "})),t.substring(0,t.length-3)},HF=function(e,t,n){return fetch(e+"/manifest.json").then((function(e){return e.json()})).then((function(e){var r,i={description:"",artist:"",name:""};e.metadata.forEach((function(e){switch(e.label){case"Creator":i.artist=FF(e.value);break;case"Title":i.name=FF(e.value),i.title=i.name;break;case"Date":i.year=FF(e.value);case"Language":case"ShelfMark":i.description+="".concat(FF(e.value)," | ")}}));var a,o,s,l=600,u=parseInt(t.vue),c=JSON.stringify(t.id);if(u){var h=e.sequences[0].canvases[u],d=h.images[0].resource["@id"];if(o={width:h.width,height:h.height},h.width<h.height){var f=h.width/h.height;r=Math.floor(l*f)}else r=600,f=h.height/h.width,l=Math.floor(r*f);t.id=d.replace("https://api.bl.uk/image/iiif/","").replace("/full/max/0/default.jpg",""),s="".concat(t.root,"/").concat(t.id,"/").concat(t.res,"/").concat(r,",").concat(l,"/0/").concat(t.quality,".jpg")}else e.sequences[0].canvases.forEach((function(e){if(e["@id"].substring(e["@id"].lastIndexOf("/")+1)===t.vue){if(o={width:e.width,height:e.height},e.width<e.height){var n=e.width/e.height;r=Math.floor(l*n)}else r=600,n=e.height/e.width,l=Math.floor(r*n);s="".concat(t.root,"/").concat(t.id,"/").concat(t.vue,"/").concat(t.res,"/").concat(r,",").concat(l,"/0/").concat(t.quality,".jpg")}}));if(o){var p=document.createElement("canvas");p.width=r+40,p.height=l+40,p.style="border: 1px solid black;border-radius: 5px;";var m=p.getContext("2d");m.fillStyle="#FFCCCB",m.fillRect(0,0,r+40,l+40);var v=new Image;v.src=s,v.addEventListener("load",(function(){m.drawImage(v,20,20),function(e,t,n){var r={x:.3*e,y:.4*t,w:.4*e,h:.4*t,width:e,height:t};a=r;var i=function(r,i,a,o){m.fillStyle="#FFCCCB",m.fillRect(0,0,e+40,t+40),m.drawImage(n,20,20),m.fillStyle="rgba(0,0,0,.4)",m.fillRect(20,20,e,i),m.fillRect(20,20+i+o,e,t-(i+o)),m.fillRect(20,20+i,r,o),m.fillRect(20+r+a,20+i,e-(r+a),o),m.lineWidth=2,m.setLineDash([]),m.strokeStyle="black",m.strokeRect(20+r,20+i,a,o),m.setLineDash([15,15]),m.strokeStyle="white",m.strokeRect(20+r,20+i,a,o),m.fillStyle="white",m.fillRect(r+13,i+13,14,14),m.fillRect(r+a+13,i+13,14,14),m.fillRect(r+a+13,i+o+13,14,14),m.fillRect(r+13,i+o+13,14,14)};i(r.x,r.y,r.w,r.h);var o=!1,s=function(e){if(e.preventDefault(),e.hasOwnProperty("touches")&&(e=e.touches[0]),e.offsetX>=r.x+13&&e.offsetX<=r.x+35){if(e.offsetY>=r.y+13&&e.offsetY<=r.y+35){if(m.canvas.style.cursor="nwse-resize",o){var t=Math.floor(e.offsetX-r.x),n=Math.floor(e.offsetY-r.y);r.x=e.offsetX-20,r.y=e.offsetY-20,r.w+=20-t,r.h+=20-n,i(r.x,r.y,r.w,r.h)}}else if(e.offsetY>=r.y+r.h+13&&e.offsetY<=r.y+r.h+13+14&&(m.canvas.style.cursor="nesw-resize",o)){var s=Math.floor(e.offsetX-r.x),l=Math.floor(e.offsetY-r.h-r.y);r.x=e.offsetX-20,r.w+=20-s,r.h+=l-20,i(r.x,r.y,r.w,r.h)}}else if(e.offsetX>=r.x+r.w+13&&e.offsetX<=r.x+r.w+13+14){if(e.offsetY>=r.y+13&&e.offsetY<=r.y+13+14){if(m.canvas.style.cursor="nesw-resize",o){var u=Math.floor(e.offsetX-r.w-r.x),c=Math.floor(e.offsetY-r.y);r.y=e.offsetY-20,r.w+=u-20,r.h+=20-c,i(r.x,r.y,r.w,r.h)}}else if(e.offsetY>=r.y+r.h+13&&e.offsetY<=r.y+r.h+13+14){if(o){var h=Math.floor(e.offsetX-r.w-r.x),d=Math.floor(e.offsetY-r.h-r.y);r.w+=h-20,r.h+=d-20,i(r.x,r.y,r.w,r.h)}m.canvas.style.cursor="nwse-resize"}}else e.offsetY>=r.y&&e.offsetY<=r.y+r.h&&e.offsetX>=r.x&&e.offsetX<=r.x+r.w?(m.canvas.style.cursor="move",o&&(r.x=e.offsetX-r.w/2-20,r.y=e.offsetY-r.h/2-20,i(r.x,r.y,r.w,r.h))):m.canvas.style.cursor="crosshair";a=r};m.canvas.addEventListener("mousemove",s),m.canvas.addEventListener("touchmove",s),m.canvas.addEventListener("mousedown",(function(){return o=!0})),m.canvas.addEventListener("mouseup",(function(){return o=!1})),m.canvas.addEventListener("touchstart",(function(){return o=!0})),m.canvas.addEventListener("touchend",(function(){return o=!1}))}(r,l,v)}));var g=document.createElement("button");g.innerText="Load selection",g.style="margin-bottom:5px";var y=document.getElementById("gallicaImportRotation").value;g.addEventListener("click",(function(e){var r=o.height/a.height,s={ark:t.id,vue:t.vue,region:"".concat(a.x*r,",").concat(a.y*r,",").concat(a.w*r,",").concat(a.h*r),rotation:y,quality:t.quality,documentSource:JSON.parse(c)};switch(n){case"gallica":jL(s,null,i);break;case"britlib":s.vueID=u,NF(s,null,i)}document.getElementById("collection").parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideRight",document.getElementById("collection").innerHTML=""})),document.getElementById("IIIFresizeContainer").innerHTML="",document.getElementById("IIIFresizeContainer").append(g,p)}else console.log("Could not retrieve IIIF data.")}))},jF=function(e){switch(!0){case-1!=e.indexOf("gallica"):var t=(i=e.replace("https://gallica.bnf.fr/","")).substring(0,i.lastIndexOf("/")),n=i.substring(i.lastIndexOf("/")+1,i.indexOf("."));HF("https://gallica.bnf.fr/iiif/"+(r={id:t,vue:n,res:"full",root:"https://gallica.bnf.fr/iiif",quality:"native"}).id,r,"gallica");break;case-1!=e.indexOf("bl.uk/"):var r,i=e.replace("https://access.bl.uk/item/viewer/",""),a=e.substring(e.indexOf("#?")+1),o=new URLSearchParams(a);t=i.substring(0,i.indexOf("#?")),n=o.get("cv"),HF("https://api.bl.uk/metadata/iiif/"+(r={id:t,vue:n,res:"full",root:"https://api.bl.uk/image/iiif",quality:"default"}).id,r,"britlib")}},GF=function(){var e=document.createElement("div");if(e.style="display:flex;padding:10px;flex-direction:column",UF.length>0){var t=document.createElement("li");t.style="list-style: none;\n  border: 1px dashed cyan;  \n  margin: 15px;\n  background: white;\n  font-size: 12px;\n  padding: 10px;",t.innerText="These links have been imported. Click on a link to charge its target asset.",UF.forEach((function(e){var n=document.createElement("ul");n.innerText=e,n.style="cursor: pointer",n.addEventListener("click",(function(){return jF(e)})),t.append(n)})),e.append(t)}var n=document.createElement("div");n.id="IIIFresizeContainer";var r=document.createElement("input");r.name="gallicaImportRotation",r.type="number",r.value=0,r.min=-360,r.max=360,r.step=90,r.id="gallicaImportRotation",r.style="width:80px;margin-left:50px";var i=document.createElement("label");i.innerText="Rotation: ",i.for="gallicaImportRotation",i.style="font-size:10px;margin-left:50px";var a=document.createElement("div");a.style="padding:10px;border:1px solid cyan;margin:15px;background-color:white;font-family: sans-serif;\n  font-weight: 100;",a.innerHTML='To load a page from a document in the anaverse, simply \n  paste its URL in the text field below. You can try this <a href="https://gallica.bnf.fr/ark:/12148/btv1b52504111z/f73.item.zoom" target="_blank">\n   Gallica</a> document on porcelain making or that <a href="https://access.bl.uk/item/viewer/ark:/81055/vdc_100098770628.0x000001#?c=0&m=0&s=0&cv=18&xywh=0%2C-106%2C6684%2C4855"\n    target="_blank" >British Library</a> Japanese design manual. [Note: due to a cyber attack, the British Library online services have been shut down for an unknown duration]<br><br>Design tip: do not select an area outside the document (light red), it will \n    cause your selection to fail.';var o=document.createElement("input");return o.style="width:400px;margin:10px;",o.placeholder="Paste link here",o.addEventListener("focusin",(function(){return Dj(1)})),o.addEventListener("focusout",(function(){return Dj(0)})),o.addEventListener("change",(function(){return jF(o.value)})),e.append(a),e.append(o,i,r,n),e},VF=function(){var e=document.createElement("div");e.id="IIIFDiv",e.style="display:grid;position:relative;grid-template-columns: 50% 50%;width:200%;height:100%";var t=document.createElement("div");t.id="importedIIIFContent",t.style="display: flex;margin:10px;flex-wrap:wrap";var n=document.createElement("div");n.id="list";var r=document.createElement("div");r.id="collection",(Gn<=6||Gn>=20)&&(r.style.color="white");var i=document.createElement("div");return i.className="artistList",i.append(aH(FL,"loadGallica"),aH(zL,"loadGallicaPix"),aH(HL,"loadGallicaRama")),n.append(i,t),e.append(n,r),e},WF=window.localStorage;WF.getItem("favoriteGalleries")||WF.setItem("favoriteGalleries","{}");var qF,XF=function(e,t,n){var r=document.createElement("div");r.id="iterationMenu";var i=document.getElementById("tokens");r.style.animation="iterationSlideLeft .15s linear forwards";var a=document.createElement("div");a.id="iterationClose",a.innerText="close",a.addEventListener("click",(function(){return HD()}));var o=document.createElement("div");if(o.style="    \n    width: 100%;\n    height: calc(100% - 40px);\n    margin-top: 35px;\n    overflow-y: auto;\n    display: inline-flex;\n    flex-direction: column;\n    flex-wrap: nowrap;\n    align-items: center;",e.hasOwnProperty("name")){var s=document.createElement("div");s.innerText=e.name,s.style="\n      padding: 2%;\n      width: 90%;\n      margin-bottom: 10px;\n      background: red;\n      color: white;\n      text-align: center;\n      border-radius: 5px;\n      ",o.append(s)}if(t){var l=new Image;l.loading="lazy",l.className="thumbnail",l.setAttribute("data-src","/loading.gif"),l.setAttribute("draggable","false"),l.style.imageRendering="auto",l.setAttribute("data-src","/loading.gif"),l.onerror=function(e){return l.src="/notfound.png"},l.src=t,l.style="cursor:pointer;margin:unset",l.addEventListener("click",n),o.append(l)}var u,c=GD("Add to favorites");JSON.parse(WF.getItem("favoriteGalleries")).hasOwnProperty(e.contract+e.token_id)&&(c.innerText="Remove from favorites"),c.addEventListener("click",(function(){var t=JSON.parse(WF.getItem("favoriteGalleries")),n=e.contract+e.token_id,r=document.getElementById("artNameBand"+n);t.hasOwnProperty(n)?(delete t[n],c.innerText="Add to favorites",r.style=""):(t[n]=!0,r.style="background:red;color:white;",c.innerText="Remove from favorites"),WF.setItem("favoriteGalleries",JSON.stringify(t))}));var h="https://anaver.se/?gallery=1&galc=".concat(e.contract,"&galid=").concat(e.id);e.sem?((u=GD("Load seminar")).addEventListener("click",n),h=e.hasOwnProperty("targetGallery")?"https://anaver.se/?videoguide=1&gallery=1&vgc=".concat(e.contract,"&vgid=").concat(e.token_id,"&galc=").concat(e.gallery_contract,"&galid=").concat(e.gallery_token_id):"https://anaver.se/?videoguide=1&vgc=".concat(e.contract,"&vgid=").concat(e.token_id)):(u=GD("Enter gallery")).addEventListener("click",n),o.append(u,c);var d=GD("Copy access link");d.addEventListener("click",(function(){d.innerText="Copied!",navigator.clipboard.writeText(h),setTimeout((function(){d.innerText="Copy access link"}),1300)}));var f=GD("Display QR code");f.addEventListener("click",(function(){return kL(h)})),o.append(d,f);var p=document.createElement("div");if(p.className="iterationBox","tezos"===e.chain){var m=GD("Inspect on objkt.com");m.addEventListener("click",(function(){return window.open(e.url,"_blank")})),o.append(m);var v=document.createElement("div");if(v.className="iterationBox",v.style="display:flex;flex-direction: column;",e.hasOwnProperty("item")){for(var g=0;g<e.item.creators.length;g++){g>0&&v.append(document.createElement("hr"));var y=e.item.creators[g];v.append(KF(y.holder))}o.append(v),p.innerText=e.item.description}else p.innerText=e.description;if(o.append(p),e.sem){var b,x=document.createElement("div");x.className="iterationBox";var w=[];e.tags.forEach((function(e){0===e.tag.name.indexOf("pres://")&&(b=e.tag.name.replace("pres://","")),0===e.tag.name.indexOf("pan://")&&w.push(e.tag.name.replace("pan://",""))})),TO.hasOwnProperty(b)?x.append(KF(NH[b])):zH([b].concat(w)).then((function(){var e=KF(NH[b]);e.style.border="2px solid red",e.style.borderRadius="4px",x.append(e),w.forEach((function(e){x.append(document.createElement("hr")),x.append(KF(NH[e]))}))})),o.append(x)}if(e.hasOwnProperty("curation")){var _=GD("Generate Gallery");_.addEventListener("click",(function(){Tj();var t=DL();!function(e,t){(0,xx.request)("https://data.objkt.com/v3/graphql",dN(e)).then((function(e){for(var n=e.gallery[0].tokens,r=sN({},t),i=[],a=0;a<r.gallery.length;a++){var o=r.gallery[a];"objkt"===o.tokenType||"tezos"===o.tokenType?a<n.length&&(o.objktMetaData={contract:n[a].token.fa_contract,token_id:n[a].token.token_id},i.push(o)):"block"===o.tokenType&&i.push(o)}r.gallery=i,yU(r)}))}(e.gallery_id,t)}));var E=GD("Load assets in contract import");E.addEventListener("click",(function(){HD(),function(e){(0,xx.request)("https://data.objkt.com/v3/graphql",dN(e)).then((function(e){var t=e.gallery[0].tokens,n=document.getElementById("galleryMainWindow"),r="Contract import",i="";(Gn<=6||Gn>=20)&&(i='style="background-color:#313131;color:white;"'),n.innerHTML="<div ".concat(i,' class="helperPanel">').concat(gj[r],"</div>"),n.appendChild(eN[r].DOM.content);for(var a=t.length<=20?t.length:20,o=function(e){setTimeout((function(){var n=t[e].token;n.contract=n.fa_contract,n.chain="tezos",n.artist=n.creators[0].holder.alias;var r=aH(n,"loadItem");document.getElementById("importedContractContent").append(r)}),300*e)},s=0;s<a;s++)o(s)}))}(e.gallery_id)})),d.remove(),f.remove(),c.remove(),u.remove(),p.remove(),p.innerHTML="\n        ".concat(e.tokens.length," pieces in this curation.\n        <br><hr>\n\n        ").concat(e.description,"\n        ");var T=document.createElement("div");T.className="iterationBox",T.style="display:flex;flex-direction: column;";for(var S=0;S<e.curators.length;S++){S>0&&T.append(document.createElement("hr"));var M=e.curators[S].curator;T.append(KF(M))}o.append(_,E,T,p)}if(e.hasOwnProperty("localGallery")){p.remove(),f.remove(),d.remove(),c.remove(),m.remove();var A=GD("Download JSON file");A.addEventListener("click",(function(){return function(e){["url","token_id","chain","contract","localGallery"].forEach((function(t){return delete e[t]}));var t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=document.createElement("a");return n.href=URL.createObjectURL(t),n.download="gallery",n.click(),n}(e)}));var k=GD("Delete Gallery");k.addEventListener("click",(function(){var t,n,r,i;t=e,n=document.getElementById(e.timeId),r=JSON.parse(sU.getItem("localGalleries")),i=[],window.confirm("Do you really want to destroy this local gallery?")&&(r.forEach((function(e){e.hasOwnProperty("timeId")?e.timeId!=t.timeId?i.push(e):n&&n.remove():i.push(e)})),sU.setItem("localGalleries",JSON.stringify(i))),HD()}));var P={};e.gallery.forEach((function(e){P.hasOwnProperty(e.tokenType)||(P[e.tokenType]=0),P[e.tokenType]++}));var R="";for(var C in P)R+="".concat(C,": ").concat(P[C],"<br>");p.innerHTML="\n        <strong>Room</strong><br>\n        blockchain: ".concat(e.room.blockchain,"<br>\n        contract: ").concat(e.room.contract,"<br>\n        token_id: ").concat(e.room.token_id,"\n        <hr>\n        <strong>Skybox</strong><br>\n        blockchain: ").concat(e.skybox.blockchain,"<br>\n        contract: ").concat(e.skybox.contract,"<br>\n        token_id: ").concat(e.skybox.token_id,"<br>\n        <hr>\n        <strong>Gallery content</strong><br>\n        ").concat(R,"\n        "),o.append(A,k,p)}}(Gn<=6||Gn>=20)&&(r.style.backgroundColor="rgba(0,0,0,0.6)",r.style.color="white"),r.append(a,o),i.append(r),qF=e},YF=function(e,t,n){document.getElementById("iterationMenu")?(HD(),e!=qF&&setTimeout((function(){XF(e,t,n)}),250)):XF(e,t,n)};function KF(e){var t=document.createElement("div");t.style="display:flex;padding:2px;";var n=document.createElement("div"),r=document.createElement("div");r.style="margin-right: 10px;";var i=document.createElement("img");return i.className="profilePic",i.setAttribute("draggable","false"),i.src=e.logo?e.logo:"/loading.gif",i.loading="lazy",i.setAttribute("data-src","/loading.gif"),i.onerror=function(){return i.remove()},r.append(i),t.append(r),e.alias&&(n.innerHTML+="<strong>Alias:</strong> ".concat(e.alias,"<br>")),n.innerHTML+='\n    <strong>Address:</strong> <a style="word-break: break-all;" href="https://objkt.com/users/'.concat(e.address,'/owned" target="_blank">').concat(e.address,"</a>"),e.twitter&&(n.innerHTML+='<br><strong>Twitter:</strong> <a href="'.concat(e.twitter,'" target="_blank">@').concat(e.twitter.replace("https://twitter.com/",""),"</a>")),t.append(n),t}var JF=window.localStorage;JF.getItem("favoritePaintings")||JF.setItem("favoritePaintings","{}");var ZF,QF=function(e,t,n){var r=document.createElement("div");r.id="iterationMenu";var i=document.getElementById("tokens");r.style.animation="iterationSlideLeft .15s linear forwards";var a=document.createElement("div");a.id="iterationClose",a.innerText="close",a.addEventListener("click",(function(){return HD()}));var o=new Image;o.loading="lazy",o.className="thumbnail",o.setAttribute("data-src","/loading.gif"),o.style.imageRendering="auto",o.setAttribute("data-src","/loading.gif"),o.setAttribute("draggable","false"),o.onerror=function(e){return o.src="/notfound.png"},o.src=t,o.style="cursor:pointer;margin:unset";var s=GD("Load in Anaverse");s.addEventListener("click",n),o.addEventListener("click",n);var l=document.createElement("div");if(l.style="    \n  width: 100%;\n  height: calc(100% - 40px);\n  margin-top: 35px;\n  overflow-y: auto;\n  display: inline-flex;\n  flex-direction: column;\n  flex-wrap: nowrap;\n  align-items: center;",e.hasOwnProperty("name")){var u=document.createElement("div");u.innerText=e.name,u.style="\n    padding: 2%;\n    width: 90%;\n    margin-bottom: 10px;\n    background: red;\n    color: white;\n    text-align: center;\n    border-radius: 5px;\n    ",l.append(u)}l.append(o,s);var c=GD("Add to favorites");JSON.parse(JF.getItem("favoritePaintings")).hasOwnProperty(e.contract+e.token_id)&&(c.innerText="Remove from favorites"),c.addEventListener("click",(function(){var t=JSON.parse(JF.getItem("favoritePaintings")),n=e.contract+e.token_id,r=document.getElementById("artNameBand"+n);t.hasOwnProperty(n)?(delete t[n],c.innerText="Add to favorites",r.style=""):(t[n]=!0,r.style="background:red;color:white;",c.innerText="Remove from favorites"),JF.setItem("favoritePaintings",JSON.stringify(t))})),l.append(c);var h=GD("Generate direct link"),d="https://anaver.se/?gallery=1&loadsingle=1&singlecontract=".concat(e.contract,"&singletokenid=").concat(e.token_id),f='<iframe src="'.concat(d,'" style="border:0px;width:800px;height:600px" />'),p=document.createElement("div");h.addEventListener("click",(function(){p.className="iterationBox",p.style="user-select:text;word-break:break-all;",p.innerText="Link: ".concat(d," \n\n\nIframe code: ").concat(f,"\n")})),l.append(h),l.append(p);var m=document.createElement("div");switch(m.className="iterationBox",e.chain){case"IIIF":if("Gallica"===e.IIIFdata.source){var v=GD("Inspect on Gallica");if(v.addEventListener("click",(function(){return window.open("https://gallica.bnf.fr/".concat(e.IIIFdata.ark,"/").concat(e.IIIFdata.vue,".item"),"_blank")})),l.append(v),m.innerText=e.item.name+" "+e.item.description,nB()){var g=GD("Send to chat");g.addEventListener("click",(function(){YN(e,"IIIF"),Tj()})),l.append(g)}l.append(m)}break;case"tezos":var y=GD("Inspect on objkt.com");y.addEventListener("click",(function(){return window.open(e.url,"_blank")})),l.append(y);var b=document.createElement("div");b.className="iterationBox",b.style="display:flex;flex-direction: column;";for(var x=0;x<e.creators.length;x++){x>0&&b.append(document.createElement("hr"));var w=e.creators[x];b.append(eH(w.holder))}if(m.innerText=e.description,nB()){var _=GD("Send to chat");_.addEventListener("click",(function(){YN(e,"painting"),Tj()})),l.append(_)}l.append(b),l.append(m);break;case"solana":var E=GD("Inspect on Solana FM");if(E.addEventListener("click",(function(){return window.open(e.url,"_blank")})),nB()){var T=GD("Send to chat");T.addEventListener("click",(function(){YN(e,"painting"),Tj()})),l.append(T)}l.append(E)}(Gn<=6||Gn>=20)&&(r.style.backgroundColor="rgba(0,0,0,0.6)",r.style.color="white"),r.append(a,l),i.append(r),ZF=e},$F=function(e,t,n){document.getElementById("iterationMenu")?(HD(),e!=ZF&&setTimeout((function(){QF(e,t,n)}),250)):QF(e,t,n)};function eH(e){var t=document.createElement("div");t.style="display:flex";var n=document.createElement("div"),r=document.createElement("div");r.style="margin-right: 10px;";var i=document.createElement("img");return i.className="profilePic",i.setAttribute("draggable","false"),i.src=e.logo?e.logo:"/loading.gif",i.loading="lazy",i.setAttribute("data-src","/loading.gif"),i.onerror=function(){return i.remove()},r.append(i),t.append(r),e.alias&&(n.innerHTML+="<strong>Alias:</strong> ".concat(e.alias,"<br>")),n.innerHTML+='\n    <strong>Address:</strong> <a style="word-break: break-all;" href="https://objkt.com/users/'.concat(e.address,'/owned" target="_blank">').concat(e.address,"</a>"),e.twitter&&(n.innerHTML+='<br><strong>Twitter:</strong> <a href="'.concat(e.twitter,'" target="_blank">@').concat(e.twitter.replace("https://twitter.com/",""),"</a>")),t.append(n),t}var tH,nH,rH,iH=window.localStorage,aH=function e(t,n){var r=document.createElement("div");r.className="gentkProfiles";var i=new Image;i.loading="lazy",i.className="thumbnail",i.setAttribute("data-src","/loading.gif"),i.style.imageRendering="auto",i.setAttribute("data-src","/loading.gif"),i.setAttribute("draggable","false"),i.onerror=function(e){return i.src="/notfound.png"},i.style.cursor="pointer",r.append(i);var a=t.contract+t.token_id;switch(MU[a]=t,MU[a].contract=t.contract,MU[a].token_id=t.token_id,t.chain){case"IIIF":switch(i.src=t.display_uri,n){case"gallicaramaProject":r.append(yH(t)),i.addEventListener("click",(function(){!function(e){for(var t=BL({},DL()),n=[],r=0;r<t.gallery.length;r++){var i=t.gallery[r];if("objkt"===i.tokenType||"tezos"===i.tokenType){if(r<e.length){var a=e[r].url.replace("https://openapi.bnf.fr/iiif/image/v3/","").replace("/full/max/0/default.webp",""),o=a.substring(0,a.lastIndexOf("/")),s=a.substring(a.lastIndexOf("/")+1);i.tokenType="IIIF",e[r].hasOwnProperty("note")&&e[r].note.length>0&&(i.note=e[r].note),i.IIIFdata={ark:o,vue:s,region:"full",rotation:"0",quality:"native",documentSource:o,source:"Gallica",size:"full"},n.push(i)}}else"block"===i.tokenType&&n.push(i)}t.gallery=n,yU(t)}(t.slides),Tj()}));break;case"loadIIIFAsset":r.append(vH(t)),r.addEventListener("click",(function(){$F(t,i.src,(function(){oI("FETCHING ITEM DATA"),VL(t.IIIFdata,t.link,null,t.item),Tj()}))}));break;case"loadGallica":r.append(gH(t)),r.addEventListener("click",(function(e){var t=document.getElementById("IIIFDiv");xH(t);var n=document.getElementById("collection");n.append(GF()),n.prepend(bH())}));break;case"loadGallicaPix":r.append(gH(t)),r.addEventListener("click",(function(e){var t=document.getElementById("IIIFDiv");xH(t);var n=document.getElementById("collection");n.append(function(){var e=document.createElement("div"),t=document.createElement("select");t.innerText="Zoologie",t.value="zoologie",t.innerHTML='\n   <option value="zoologie">Zoologie</option>\n   <option value="1418">14-18</option>\n   <option value="1418pub">Publicits 14-28</option>\n   <option value="miroir">Le Miroir de sports</option>\n  <option value="PP">Papiers peints et textiles</option>\n   <option value="vogue">Vogue (Paris)</option>\n  ',t.style="margin:10px;";var n=document.createElement("input");n.type="text",n.value="girafe",n.innerText="girafe",n.style="margin:10px;",n.addEventListener("focusin",(function(){return Dj(1)})),n.addEventListener("focusout",(function(){return Dj(0)}));var r=.6*window.innerWidth;e.style="display:flex;width:".concat(r,"px;flex-direction: column;\n      align-items: flex-start;\n      justify-content: space-between;padding:5%;margin:5px;\n  ");var i=document.createElement("div");i.style="padding:10px;border:1px solid cyan;margin:15px;background-color:white;font-family: sans-serif;\n  font-weight: 100;",i.innerHTML='GallicaPix is a machine-learning powered image detector for Gallica. \n  Choose a document corpus and enter a search term to get started. Once the result is loaded, click on\n  the image to open that page in a new tab on the Gallica website. If you are satisfied with your find, you\n  can then load that image by pasting the page\'s address in the "Gallica by URL" tab. ';var a=document.createElement("button");a.innerText="Load results",a.style="margin:10px;";var o=document.createElement("iframe");return o.style="border:1px solid cyan;width:".concat(r,"px;height:").concat(r-50,"px;display:none;"),a.addEventListener("click",(function(){var e,r;o.style.display="block",o.src=(e=t.value,r=n.value,"https://gallicapix.bnf.fr/rest?run=findIllustrations-app.xq&start=1&corpus=".concat(e,"&sourceTarget=&keyword=").concat(r))})),e.append(i,t,n,a,o),e}()),n.prepend(bH())}));break;case"loadGallicaRama":r.append(gH(t)),r.addEventListener("click",(function(e){var t=document.getElementById("IIIFDiv");xH(t);var n=document.getElementById("collection");n.append(function(){var e=document.createElement("div"),t=document.createElement("div");t.style="display:flex;padding:10px;border:1px solid cyan;margin:15px;flex-direction: column;background-color:white;font-family: sans-serif;\n  font-weight: 100;",t.innerHTML='Drop Gallicarama JSON files in this box or select a file to import it. \n    <br><br>\n    Once imported, the Gallicarama project can be loaded in two ways:<br><br>\n    - Click on the thumbnail to load a randomly generated 3D gallery populated with your Gallicarama\'s project slides.<br><br>\n    - Click on the "Load Assets" button to preload each pieces in the "Gallica by URL" tab. This will enable\n      you to crop and resize each slide.';var n=document.createElement("input");n.type="file",n.style="margin:10px;padding:10px;border:1px dashed black;",n.addEventListener("change",(function(e){KL.postMessage({type:"local",path:e.target.files[0]})})),t.addEventListener("dragover",(function(e){return e.preventDefault()})),t.addEventListener("drop",(function(e){var t;e.preventDefault(),e.dataTransfer.items&&(t=e.dataTransfer.items,function(e){if(Array.isArray(e))return NL(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return NL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?NL(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach((function(e,t){if("file"===e.kind){var n=e.getAsFile();KL.postMessage({type:"local",path:n})}}))})),t.append(n);var r=document.createElement("div");return r.id="gallicaRamaImports",r.className="artistList",e.append(t,r),e}()),n.prepend(bH())}))}break;case"tezos":switch(t.hasOwnProperty("token_id")&&t.hasOwnProperty("contract")&&(t.hasOwnProperty("url")||(t.url="https://objkt.com/tokens/".concat(t.contract,"/").concat(t.token_id)),i.src="https://assets.objkt.media/file/assets-003/".concat(t.contract,"/").concat(t.token_id,"/thumb288")),n){case"joinSpace":t.name=t.spacename,r.append(cH(t)),r.style.cursor="pointer","tutorial"===t.spaceid&&(i.src="https://assets.objkt.media/file/assets-003/KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g/1/thumb288"),i.addEventListener("click",(function(){jD(t,i.src,(function(){Tj(),"tutorial"===t.spaceid?(MN(!0),iB($N.server,$N.name,{name:"tutorial",id:"tutorial"})):sB(t.spaceid)}))}));break;case"displayArtistCollection":r.append(hH(t)),i.addEventListener("click",(function(){t.hasOwnProperty("DOMelements")?(document.getElementById("list").parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideLeft",BN(t)):t.hasOwnProperty("gallery_id")?PH(t,t.gallery_id):kH(t)}));break;case"loadCuration":i.src=t.logo,t.curation=!0,r.addEventListener("click",(function(){YF(t,i.src,(function(){return null}))})),r.append(oH(t));break;case"loadSeminar":r.append(lH(t,!0)),i.addEventListener("click",(function(){t.sem=!0,YF(t,i.src,(function(){window.confirm("This will load a ".concat(t.size," video. Do you want to proceed?"))&&(Tj(),t.targetGallery.load=!0,KL.postMessage({type:"remote",galleryURLs:[t.targetGallery]}),t.targetGallery.load=!1,IL(t.vidsrc,t.poster,t.contract+t.token_id))}))}));break;case"loadLocalGallery":i.remove(),r.id=t.timeId,r.style="\n          border: 2px solid red;\n          border-radius: 5px;\n          height: 60px;\n          margin-top: 10px;\n          margin-bottom: 10px;\n          cursor:pointer;\n          background-color: #ffffff;\n          background: repeating-linear-gradient( 45deg, #ff0000, #ff0000 4px, #ffffff 4px, #ffffff 10px );\n          ",t.localGallery=!0,r.addEventListener("click",(function(){YF(t,null,(function(){Tj(),yU(t)}))})),r.append(sH(t));break;case"galleryCurator":r.append(lH(t)),i.addEventListener("click",(function(){document.getElementById("collection").prepend(bH()),document.getElementById("galleryCuratorList").parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideLeft",qL[t.curator].hasOwnProperty("DOMelement")?document.getElementById("collection").append(qL[t.curator].DOMelement):KL.postMessage({type:"remote",galleryURLs:t.list})}));break;case"loadGallery":r.append(lH(t)),i.addEventListener("click",(function(){YF(t,i.src,(function(){Tj(),yU(t)}))}));break;case"loadItem":r.style.cursor="pointer",r.addEventListener("click",(function(){$F(t,i.src,(function(){oI("FETCHING ITEM DATA"),dH(t,a)}))})),pH(t,r);break;case"displayCollection":mH(t,t.creators[0].creator_address,r),i.addEventListener("click",(function(){var n=[];for(var r in MO[t.creators[0].creator_address])n.push(e(MO[t.creators[0].creator_address][r],"loadItem"));t.DOMelements={gallery:n},document.getElementById("list").parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideLeft",BN(t)}));break;case"listIterations":var o="https://assets.objkt.media/file/assets-003/".concat(t.logo.replace("ipfs://",""),"/thumb288");t.imgURI=o,i.src=o,t.tag.hasOwnProperty("commune")?i.addEventListener("click",(function(){return tz(t)})):i.addEventListener("click",(function(){return IN(t)})),r.append(uH(t));break;case"loadIteration":r.id=t.DOMid,r.append(cH(t)),r.style.cursor="pointer",r.addEventListener("click",(function(){jD(t,i.src,(function(){!t.hasOwnProperty("gentk")&&t.hasOwnProperty("slug")&&(t.gentk=_N[t.slug]),nz(t.gentk,t.id,t.hash,t.name),Tj()}))}))}break;case"solana":i.src=t.display_uri,"loadItem"===n&&(r.addEventListener("click",(function(){$F(t,i.src,(function(){oI("FETCHING ITEM DATA"),fF(t.display_uri,{id:t.id},t.chain),Tj()}))})),pH(t,r));break;case"ethereum":switch(n){case"joinSpace":var s=t.imgUrl;t.imgURI=s,i.src=s,t.name=t.spacename,r.append(cH(t)),r.style.cursor="pointer",i.addEventListener("click",(function(){jD(t,i.src,(function(){Tj(),sB(t.spaceid),iB($N.server,$N.name,{name:t.spacename,id:t.spaceid})}))}));break;case"listIterations":s=t.imgUrl,t.imgURI=s,i.src=s,t.tag.hasOwnProperty("commune")?i.addEventListener("click",(function(){return tz(t)})):i.addEventListener("click",(function(){return IN(t)})),r.append(uH(t));break;case"loadIteration":s=t.imgUrl,t.imgURI=s,i.src=s,r.append(cH(t)),i.addEventListener("click",(function(){jD(t,i.src,(function(){nz(t.gentk,t.id,t.hash,t.name),Tj()}))}))}}return r},oH=function(e){var t=document.createElement("div");t.className="artThumbTitle";var n=document.createElement("div");n.className="artistNames",n.style.minWidth="120px";var r=e.curators[0].curator;if(r.logo)try{var i=document.createElement("img");i.className="profilePic",i.setAttribute("draggable","false"),i.loading="lazy",i.setAttribute("data-src","/loading.gif"),i.src=e.curators[0].curator.logo,r.twitter&&(i.style.cursor="pointer",i.addEventListener("click",(function(){return window.open(e.curators[0].curator.twitter,"_blank")}))),i.onerror=function(){return i.remove()},t.appendChild(i)}catch(e){console.log(e)}var a=document.createElement("div");return a.innerHTML="<strong>"+e.name+"</strong>",r.alias&&(a.innerHTML+="<br>by "+e.curators[0].curator.alias),n.append(a),t.append(n),t},sH=function(e){var t=document.createElement("div");return t.style="background:white;padding:4px;border: 2px solid red;",t.innerText=e.name,t},lH=function(e,t){var n=document.createElement("div");n.className="artThumbTitle";var r=document.createElement("div");r.className="artistNames";var i=document.createElement("div");if(i.innerText=e.name,r.append(i),"https://anaver.se/?gallery=1&galc=".concat(e.contract,"&galid=").concat(e.id),t&&(e.lang&&(i.innerText="".concat(e.lang," ").concat(e.name)),e.hasOwnProperty("targetGallery")?"https://anaver.se/?videoguide=1&gallery=1&vgc=".concat(e.contract,"&vgid=").concat(e.token_id,"&galc=").concat(e.gallery_contract,"&galid=").concat(e.gallery_token_id):"https://anaver.se/?videoguide=1&vgc=".concat(e.contract,"&vgid=").concat(e.token_id)),!t){var a=NH[e.curator];if(a.alias){var o=document.createElement("div");o.innerText=a.alias,r.append(o)}if(a&&a.logo)try{var s=document.createElement("img");s.setAttribute("draggable","false"),s.className="profilePic",s.loading="lazy",s.setAttribute("data-src","/loading.gif"),s.src=a.logo,a.twitter&&(s.style.cursor="pointer",s.addEventListener("click",(function(){return window.open(a.twitter,"_blank")}))),s.onerror=function(){return s.remove()},n.appendChild(s)}catch(e){console.log("failed getting image")}}return r.style.minWidth="130px",n.append(r),n},uH=function(e){var t=document.createElement("div");t.className="thumbTitle";var n=document.createElement("A");return n.href=e.link,n.target="_blank",n.innerText=e.name.replace("anaverse -",""),n.style="font-style: italic;font-weight: 100;",t.appendChild(n),t},cH=function(e){var t=document.createElement("div");t.id="artNameBand"+e.contract+e.token_id,t.className="artThumbTitle",JSON.parse(iH.getItem("favoriteNativeIterations")).hasOwnProperty(e.contract+e.token_id)&&(t.style="background:red;color:white;");var n=document.createElement("div");if(n.className="artistNames",e.hasOwnProperty("token")){var r=NH[e.token.holders[0].holder.address];if(r.logo)try{var i=document.createElement("img");i.className="profilePic",i.setAttribute("draggable","false"),i.loading="lazy",i.setAttribute("data-src","/loading.gif"),i.src=r.logo,r.twitter&&(i.style.cursor="pointer",i.addEventListener("click",(function(){return window.open(r.twitter,"_blank")}))),i.onerror=function(){return i.remove()},t.appendChild(i)}catch(e){console.log("failed getting image")}}return n.innerHTML=e.name,t.append(n),t},hH=function(e){var t=document.createElement("div");t.className="artThumbTitle";var n=document.createElement("div");return n.className="artistNames",n.innerHTML='<span style="color:black;background:white;padding:4px;">'.concat(e.name,"</span>"),t.appendChild(n),t},dH=function(e,t){Tj();var n=fH(e);fF(n,{id:t},e.chain)},fH=function(e){var t=0;return e.hasOwnProperty("display_uri")&&e.display_uri&&0===e.display_uri.indexOf("ipfs://")&&(t="https://assets.objkt.media/file/assets-003/"+e.display_uri.replace("ipfs://","")+"/display"),e.fa={contract:e.contract},t||(t="https://assets.objkt.media/file/assets-003/"+e.contract+"/"+e.token_id+"/thumb400"),t},pH=function(e,t){var n=document.createElement("div");n.id="artNameBand"+e.contract+e.token_id,n.className="artThumbTitle",JSON.parse(iH.getItem("favoritePaintings")).hasOwnProperty(e.contract+e.token_id)&&(n.style="background:red;color:white;");var r=document.createElement("div");r.className="artistNames";var i=e.name;r.style.minWidth="120px",r.innerHTML='<span style="font-weight:bold;">'.concat(i,"</span>"),n.append(r),t.append(n)},mH=function(e,t,n){return zH([t]).then((function(){var r=NH[t],i=document.createElement("div");i.className="artThumbTitle";var a=r.twitter?"@".concat(r.twitter):"",o=document.createElement("div");o.className="artistNames";var s=r.alias?r.alias:"";e.artist=s,s=s.length<50?s:s.substring(0,50)+"";var l=!1;UH.hasOwnProperty(t)&&(l=!0);var u=l?"white":"black",c=l?"red":"transparent";if(o.innerHTML='<span style="color:'.concat(u,";background:").concat(c,';padding:4px;">').concat(s,'</span>\n        <span><a href="').concat(r.twitter,'" target="_blank">').concat(a.replace("https://twitter.com/",""),"</a></span>"),r.logo)try{i.appendChild(wH(r.logo))}catch(e){console.log("failed getting image")}i.append(o),n.append(i)}))},vH=function(e){var t=document.createElement("div");t.className="artThumbTitle";var n=document.createElement("div");return n.className="artistNames",n.innerHTML="".concat(e.desc,'<br><a href="https://gallica.bnf.fr/').concat(e.IIIFdata.ark,"/").concat(e.IIIFdata.vue,'.item" target="_blank">Open on Gallica</a>'),t.append(n),t},gH=function(e){var t=document.createElement("div");t.className="artThumbTitle";var n=document.createElement("div");return n.className="artistNames",n.innerHTML='<a href="'.concat(e.url,'" target="blank">').concat(e.name,"</a>"),t.append(n),t},yH=function(e){var t=document.createElement("div");t.className="artThumbTitle",t.style="display: flex;\n  flex-direction: column;\n  min-width:100px;";var n=document.createElement("div");n.className="artistNames",n.innerHTML="<strong>".concat(e.meta.title,"</strong><br>").concat(e.meta.author);var r=document.createElement("button");return r.innerText="Load assets",r.className="thumbToolAction",r.addEventListener("click",(function(){e.slides.forEach((function(e){var t=e.url.replace("https://openapi.bnf.fr/iiif/image/v3/ark:/","https://gallica.bnf.fr/ark:/").replace("/full/max/0/default.webp","");!function(e){UF.push(e)}(t+=".item")}));var t=document.getElementById("collection");t.parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideRight",setTimeout((function(){return t.innerHTML=""}),350),setTimeout((function(){t.append(GF()),t.prepend(bH()),xH(document.getElementById("IIIFDiv"))}),500)})),t.append(n,r),t},bH=function(){var e=document.createElement("div");return e.innerHTML=" Back",e.style="border-radius: 5px;\n    cursor: pointer;\n    padding: 4px;\n    margin: 5px;\n    width: 65px;",e.addEventListener("click",(function(){collection&&(collection.parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideRight",setTimeout((function(){return collection.innerHTML=""}),250))})),e},xH=function(e){e.style.top="0%",e.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideLeft"},wH=function(e){if(e){var t=new Image;return t.setAttribute("draggable","false"),t.className="profilePic",t.loading="lazy",t.setAttribute("data-src","/loading.gif"),t.src=e,t.onerror=function(){return t.remove()},t}};function _H(e){return function(e){if(Array.isArray(e))return EH(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return EH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?EH(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var SH,MH,AH=[],kH=function(e){return(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(tH||(tH=TH(['\n    query getGalleryContent {\n      token(\n        where: {fa_contract: {_eq: "','"}, creators: {creator_address: {_eq: "','"}}}\n      ) {\n         name\n                  fa_contract\n                  token_id\n                  description\n                  artifact_uri\n                  creators {\n                    creator_address\n                    holder {\n                      address\n                      alias\n                      logo\n                      twitter\n                    }\n                  } \n      }\n    }\n    \n    '])),e.contract,VH)).then((function(t){var n=[];t.token.forEach((function(e){e.contract=e.fa_contract,e.chain="tezos",n.push(aH(e,"loadItem"))})),e.DOMelements={gallery:n},document.getElementById("list").parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideLeft",BN(e)}))},PH=function(e,t){return(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(nH||(nH=TH(["\n      query getAllIterations($galleryId: String) {\n        gallery(where: { gallery_id: { _eq: $galleryId } }) {\n          tokens(order_by: { id: desc }) {\n            token {\n              name\n              fa_contract\n              token_id\n              description\n              artifact_uri\n              creators {\n                creator_address\n                holder {\n                  address\n                  alias\n                  logo\n                  twitter\n                }\n              }\n            }\n          }\n        }\n      }\n    "]))),{galleryId:t}).then((function(t){var n=[];t.gallery.forEach((function(e){e.tokens.forEach((function(e){var t=e.token;t.contract=t.fa_contract,t.chain="tezos",n.push(aH(t,"loadItem"))}))})),e.DOMelements={gallery:n},document.getElementById("list").parentElement.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideLeft",BN(e)}))},RH=function(e){return(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(rH||(rH=TH(["\n      query CollectionsGetCollectionsAndGalleries($address: String!) {\n        fa(\n          where: {\n            _or: [\n              {\n                tokens: {\n                  creators: {\n                    creator_address: { _eq: $address }\n                    verified: { _eq: true }\n                  }\n                }\n              }\n              { creator_address: { _eq: $address } }\n            ]\n          }\n        ) {\n          ...CollectionsCollection\n        }\n        gallery(\n          where: {\n            curators: { curator_address: { _eq: $address } }\n            max_items: { _gt: 0 }\n          }\n          order_by: { inserted_at: asc }\n        ) {\n          ...CollectionsGallery\n        }\n      }\n\n      fragment CollectionsCollection on fa {\n        collection_id\n        path\n        contract\n        category\n        logo\n        name\n        creator_address\n        tokens(limit: 1) {\n          fa_contract\n          token_id\n        }\n      }\n      fragment CollectionsGallery on gallery {\n        gallery_id\n        logo\n        name\n        slug\n        registry {\n          name\n          slug\n          type\n        }\n        tokens(limit: 1) {\n          fa_contract\n          token_id\n        }\n      }\n    "]))),{address:e}).then((function(e){[].concat(_H(e.fa),_H(e.gallery)).forEach((function(e){if(e.tokens&&"fxhashgenesis"!=e.path&&"fxparams"!=e.path&&"fxhash"!=e.path&&"fxtext"!=e.path){e.chain="tezos",e.contract=e.tokens[0].fa_contract,e.token_id=e.tokens[0].token_id;var t=aH(e,"displayArtistCollection");AH.push(t)}})),gO(AH)}))};function CH(e){return CH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CH(e)}function LH(){LH=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),s=new R(r||[]);return i(o,"_invoke",{value:M(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var x={};u(x,o,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(C([])));_&&_!==n&&r.call(_,o)&&(x=_);var E=b.prototype=g.prototype=Object.create(x);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,a,o,s){var l=h(e[i],e,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==CH(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function M(t,n,r){var i=d;return function(a,o){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=A(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(t,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function A(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=h(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(CH(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new S(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(E),u(E,l,"Generator"),u(E,o,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function IH(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function OH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var DH=(0,xx.gql)(SH||(SH=OH(["\n  query getProfiles($artists: [String!]!) {\n    holder(where: { address: { _in: $artists } }) {\n      alias\n      address\n      description\n      discord\n      dns\n      email\n      ethereum\n      facebook\n      flag\n      github\n      gitlab\n      inserted_at\n      instagram\n      last_metadata_update\n      logo\n      medium\n      reddit\n      slack\n      support\n      telegram\n      twitter\n      tzdomain\n      website\n    }\n  }\n"]))),NH={},BH=(0,xx.gql)(MH||(MH=OH(['\n  {\n    token_tag(\n      where: {\n        tag: { name: { _ilike: "anaverse-sem" } }\n        token: {\n          holders: {\n            holder_address: { _eq: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9" }\n          }\n        }\n      }\n    ) {\n      token {\n        tags {\n          tag {\n            name\n          }\n        }\n      }\n    }\n  }\n']))),UH={};function zH(e,t){return FH.apply(this,arguments)}function FH(){var e;return e=LH().mark((function e(t,n){var r,i;return LH().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],t.forEach((function(e){NH.hasOwnProperty(e)||r.push(e)})),!(r.length>0)){e.next=6;break}return e.next=5,(0,xx.request)("https://data.objkt.com/v3/graphql",DH,{artists:r}).then((function(e){for(var t in e&&(e.hasOwnProperty("holder")&&e.holder.forEach((function(e){return NH[e.address]=e})),n&&e.tzprofiles[0].alias&&hj(e.tzprofiles[0].alias)),UH)NH[t].seminarist=!0})).catch((function(e){}));case 5:i=e.sent;case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})),FH=function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){IH(a,r,i,o,s,"next",e)}function s(e){IH(a,r,i,o,s,"throw",e)}o(void 0)}))},FH.apply(this,arguments)}(0,xx.request)("https://data.objkt.com/v3/graphql",BH).then((function(e){e.token_tag.forEach((function(e){e.token.tags.forEach((function(e){0===e.tag.name.indexOf("pres://")&&(UH[e.tag.name.replace("pres://","")]=1)}))}))}));var HH=function(e){return NH[e.address]=e},jH=document.getElementById("walletSync"),GH=document.getElementById("walletDetail"),VH="",WH=window.localStorage;WH.getItem("walldir")||WH.setItem("walldir",'{"eth":{},"tez":{}}'),WH.getItem("beacon:sdk-secret-seed")&&(WH.removeItem("beacon:sdk-secret-seed"),WH.removeItem("beacon:sdk_version"),WH.removeItem("beacon:active-account"),WH.removeItem("beacon:accounts"),WH.removeItem("beacon:postmessage-peers-dapp")),GH.style.display="none";var qH=function(){var e=document.getElementById("walletDetail");"none"===e.style.display?(e.style.display="flex",e.style.zIndex=9999):(e.style.display="none",e.style.zIndex=-50)};document.getElementById("signin").addEventListener("click",qH);var XH=document.getElementById("tzTarget");document.getElementById("tzLoadWallet").addEventListener("click",(function(){VH=XH.value.substring(XH.value.indexOf("tz")),JH(VH),AU={},qH();var e=new URL(document.location.href);e.searchParams.set("wallet",VH),window.history.replaceState({},"",e.href)}));var YH=function e(t){t.remove();var n=document.createElement("input");n.setAttribute("placeholder","Your new name"),n.id="alias",jH.prepend(n),n.addEventListener("focusin",(function(){return Dj(1)})),n.addEventListener("focusout",(function(){return Dj(0)})),n.addEventListener("change",(function(){var t=document.createElement("div");t.id="alias",t.innerText=n.value,$N.name=n.value,rB(),n.remove(),jH.prepend(t),t.addEventListener("click",(function(){return e(t)}))}))},KH=function(e,t){var n=document.getElementById("walletSync");n.innerHTML="";var r=document.createElement("div");r.id="alias",r.innerText=e,r.addEventListener("click",(function(){return YH(r)}));var i=document.createElement("div");i.className="profilePic",i.style.backgroundImage="url(".concat(t,")"),i.style.borderRadius="0px",n.append(r,i)},JH=function(e){VH=e,DN(e),zH([e]).then((function(){var t,n,i,a=NH[e];a?(a.hasOwnProperty("prevLoad")&&(a.prevLoad="{}"),KH(a.alias,a.logo),t=e,n=a.alias,(i=JSON.parse(WH.getItem("walldir"))).tez[t]={name:n,address:t,type:"tez"},WH.setItem("walldir",JSON.stringify(i)),a.alias&&($N.name=a.alias),hj(a.alias)):jH.innerHTML="<div style='font-size:12px'>CONNECTION ERROR</div>",r.Identit.fin=window.performance.now()}))},ZH=document.getElementById("titleG"),QH=document.getElementById("titleR"),$H=document.getElementById("landingTitle"),ej=document.getElementById("hider"),tj=(document.getElementById("titleG"),document.getElementById("titleG"),document.getElementById("enter")),nj=document.getElementById("enterG"),rj=document.getElementById("enterR"),ij=(document.getElementById("tips"),!0),aj=(document.getElementById("perfMode"),window.localStorage),oj=function(){nj.innerText="ENTER TUTORIAL",rj.innerText="ENTER TUTORIAL",fj()};aj.getItem("mode")?(aj.getItem("mode"),ij=!0):aj.setItem("mode","monochrome");var sj=function(){aU&&(QB.play(),iU=!0,rU.innerHTML='<img  style="width:15px;height:15px" src="icons/stop.svg">'),setTimeout((function(){cj&&pG(!0)}),500),document.getElementById("walletDetail").style.display="none";var e=window.location.search,t=new URLSearchParams(e);0!==VH.length||t.has("wallet")||t.has("ethwallet")||(console.log("No wallets found. Loading anaglyphic's collection as a backup."),DN("tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9")),(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(JD||(JD=lN(['\n      query getObjktCuration {\n        gallery(\n          where: {\n            registry: { name: { _eq: "objkt" } }\n            published: { _eq: true }\n            items: { _gt: 4 }\n            name: {}\n            curators: { curator_address: {} }\n          }\n          order_by: { updated_at: desc }\n          limit: 20\n        ) {\n          gallery_id\n          name\n          logo\n          items\n          description\n          slug\n          curators {\n            curator {\n              address\n              alias\n              logo\n              twitter\n            }\n          }\n          tokens {\n            token {\n              content_rating\n            }\n          }\n        }\n      }\n    '])))).then((function(e){var t={gallery:[]};e.gallery.forEach((function(e){try{e.tokens.some((function(e){return"mature"===e.token.content_rating}))||t.gallery.push(e)}catch(e){console.log("Unable to load objkt curation due to unavailable content rating.")}})),pN(t,!0)})),yG.lock(),dG(),ej.style.animation="hide .8s linear forwards",setTimeout((function(){ej.style.display="none"}),1e3)};tj.addEventListener("click",sj);var lj=!1,uj=1;document.body.addEventListener("touchstart",(function(){document.getElementById("keyhelper").style.display="none",uj=4,document.getElementById("fullscreen-button").addEventListener("touchstart",(function(){document.body.requestFullscreen&&document.body.requestFullscreen()}))}));var cj=!0;tj.addEventListener("touchstart",(function(){cj=!1,lj||(lj=!0,pG(!1),vj(),Bj(),setTimeout((function(){sj()}),2e3))}));var hj=function(e,t){document.getElementById("walletSync").style.animation="reveal .8s linear forwards",e&&(t?(ZH.innerHTML=e+"<br>x<br>ANAVER.SE",QH.innerHTML=e+"<br>x<br>ANAVER.SE",document.title=e+" x ANAVER.SE"):(ZH.innerHTML=e.toUpperCase()+"'S<br>ANAVER.SE",QH.innerHTML=e.toUpperCase()+"'S<br>ANAVER.SE",document.title=e.toUpperCase()+"'S ANAVER.SE")),document.getElementById("barcode").style.animation="reveal .8s linear forwards",$H.style.animation="reveal .8s linear forwards"},dj=!1,fj=function(){dj||(document.getElementById("barcode").addEventListener("click",_G),document.getElementById("barcode").style.cursor="pointer",dj=!0,tj.style.animation="reveal .5s linear forwards",tj.style.pointerEvents="all",Fn("#barrouge").transition().duration(500).attr("transform","translate(-2,0)"),Fn("#barcyan").transition().duration(500).attr("transform","translate(2,0)"),ZH.style.animation="shift .5s linear forwards",QH.style.animation="unshift .5s linear forwards",document.getElementById("enterR").style.animation="unshift .5s linear forwards",document.getElementById("enterG").style.animation="shift .5s linear forwards",r["Cration Monde"].fin=performance.now(),r["Total ANAVER.SE"].fin=performance.now(),setTimeout((function(){horlogesLog()}),2500))},pj=!1,mj=1,vj=function(){mj=!1,pG(!1),$H.style.display="flex",tj.style.display="flex",pj=!0,document.getElementById("mobile-control").style.display="block";var e=!1;document.getElementById("help-trigger-button").addEventListener("touchstart",(function(){e?(document.getElementById("mobile-help-panel").style.display="none",document.getElementById("hang-button-desc").style.display="none"):(document.getElementById("mobile-help-panel").style.display="block","flex"===document.getElementById("hang-button").style.display&&(document.getElementById("hang-button-desc").style.display="block")),e=!e})),document.getElementById("mobile-control").style.display="block";try{void 0!==screen.orientation.type&&"landscape-primary"===screen.orientation.type&&screen.orientation.lock("landscape-primary")}catch(e){console.log("Are you using safari for iOS ?"),fj()}},gj={IIIF:"The IIIF consortium lets you import high quality public domain assets from the world's largest National Libraries, Museum and \n  Universities. This tab helps you load documents hosted by the Bibliothque Nationale de France through its <strong>Gallica</strong> service\n  and by the British Library through its <strong>Available Online</strong> program. Click on a service's image to access it. Clicking a link \n  (in red) will open the service's web page.",highlights:'In this page, you can select and <b>load generative structures, \n      skies and items</b>. Because the anaverse is "generative", each element \n      you see in this table is a "generator", i.e. an algorithm creating multiple versions\n      of the same type of worlds. Clicking on a generator will reveal a \n      list of the different versions, or "iterations", available for the loading. If you are lost, do not\n      hesitate to go back to the <a id="tutorialClick">tutorial</a>.',"Loaded collection":'This tab displays the <b>personal collection</b> of the identity you signed in as. If you didn\'t specify an identity,\n                        Anaglyphic\'s personal collection is loaded instead.\n                        To hang a painting, click first on an artist thumbnail, and then select the \n                        piece you want to hang. <a href="https://observablehq.com/@anaglyph-ic/anaverse-seminar-list"\n                        target="blank"><span style="cursor:pointer;color:white;background:red;padding:2px;">Seminar artists</span></a> are marked in red and white.\n                        This only loads the 500 most recent pieces of the wallet. <a style="cursor:pointer" id="forceLoadCollection">Click here</a> to load the entire collection.',"Loaded creations":"This tab displays the <b>personal creations</b> of the identity you signed in as. \n                        If you are not signed in, Ana's personal creations will be loaded instead.\n                        To hang a painting, click first on a collection thumbnail, and then select the \n                        piece you want to hang.","Local galleries":'This tab displays the <b>local galleries you created</b>. These galleries are only accessible\n                        on your current machine, and only as long as you do not purge your local website storage.\n                        To share a gallery with the world, you will need to learn how to <a href="https://observablehq.com/collection/@anaglyph-ic/starting-with-the-anaver-se"\n                        target="blank">export a local gallery</a>.',"Gallery builder":"Use these inputs to either save locally your current gallery or import a compatible gallery.json file.","Public galleries":"This tab displays <b>publicly accessible blockchain-indexed galleries</b>. These galleries are \n                        accessible by all users at all times. They are handcrafted by curators. Some tabs can appear empty because the previously existing galleries\n                        are no longer compatible with the current gallery format. You can contact the curator and ask them to update the gallery format.","Data visualisation":"This tab displays <b>data visualisation procedures</b> available in the anaverse. The data presented \n                          in this tab is public and made to fit in a 3D environment for exploration.","fx(text)":"This tab enables you to search for an fx(text) article and load its tezos-indexed content. The content will be made available for you to hang in the current space.","Objkt Curated":"This tab lets you search for <a href='https://objkt.com/'>objkt.com</a> user curations. If a profile is synced in,\n   this tab will start with the profiles' most recent curations. If not, the most recent curations of all users will be displayed. Use the \n   search field to look for a curation (the search engine looks for the name of the gallery). Clicking on a <strong>curation thumbnail</strong> will load it in a gallery template.\n   Click on <strong>Load assets</strong> instead to load each piece in the Contract import tab and build your own 3D gallery. Only curated galleries with\n   more than five items are displayed.","Mini games":"Mini games for the anaverse.","Your Views inventory":'This panel shows all the pieces privately contained in your "Views vault". These elements are visible to you only. The images and metadata are called from the secure Views servers.',"Active services":"This tab shows all active services in your current anaverse session and lets you terminate them.","Contract import":"This form lets you import artworks by pasting a contract address.",Gallica:"Gallica is the Bibliothque nationale de France's digital library. Established in October 1997, it has more than 6 million digitized materials, including photographs, cartoons, drawings, prints, posters, maps, and more. All library materials are freely available. Use the IIIF format to import a Gallica resource. Simply paste a link from the Gallica integration system to populate the relevant fields.","Screen record":"Use this panel to record your screen while navigating the anaverse.",Seminars:' This tab lets you load <a href="https://observablehq.com/@anaglyph-ic/anaverse-seminar-series"\n    target="blank">Anaverse seminar series</a> videos within your current anaverse context. It also lets you load other compatible videos, for you which you need to provide a valid URL. Please bear in mind that these videos need to be fully preloaded before being played, and that they can be very heavy.',Construction:'This tab lets you add <a href="https://threejs.org/docs/index.html?q=geometry" target="_blank">basic geometries</a> into the world.',Multiuser:"This tab helps you navigate the anaverse multi user system. The list of currently connected users to that server, if any, will be displayed in the table below. Click on a thumbnail to join a space. Do not forget anyone can choose any name. Do not trust random people on the internet. Use T to open the text chat."},yj=!1,bj=document.getElementById("mobile-jetpack"),xj=document.getElementById("mobile-chat"),wj=document.getElementById("header"),_j=document.getElementById("tokens"),Ej=function(){var e=document.getElementById("collection");_j.style.top="0%",_j.style.animation="0.4s linear 0s 1 normal forwards running tokensSlideLeft";var t=document.createElement("div");t.innerText="LOADING COLLECTION ...",t.id="loadingCollection",e.appendChild(t)},Tj=function(e){var t=document.getElementById("anavTooltip");t.style.animation="0.2s linear 0s 1 normal forwards running reveal",yj?(window.innerWidth>window.innerHeight&&yG.lock(),cj&&(wj.style.animation="0.2s linear 0s 1 normal forwards running loaderHeaderSlideUp",_j.style.top="0px",_j.style.animation="0.2s linear 0s 1 normal forwards running tokensSlideDown",t.style.animation="0.2s linear 0s 1 normal forwards running hide",setTimeout((function(){_j.innerHTML="",t.style.zIndex=0,t.style.display="none",yj=!1}),200)),pj&&(bj.style.display="flex",xj.style.display="flex",_j.innerHTML="",t.style.zIndex=0,t.style.display="none",yj=!1)):(cj&&(wj.style.animation="0.2s linear 0s 1 normal forwards running loaderHeaderSlideDown"),window.innerWidth>window.innerHeight&&yG.unlock(),e?function(){var e=document.getElementById("tokens");e.style.width="200%",e.style.height="100%";var t=document.createElement("div");t.id="list",e.append(t);var n=document.createElement("div");n.id="collection",e.append(t,n),cj&&(e.style.position="relative",e.style.top="100%",e.style.animation="0.2s linear 0s 1 normal forwards running loaderSlideTop");var r=document.createElement("div"),i=document.createElement("ul");if(i.style.listStyle="none",e.style.gridTemplateColumns="",e.style.overflow="hidden hidden",e.style.display="grid",ON.length>0){i.className="tokensDiv";var a=document.createElement("div");a.innerText="Personal tokens",a.className="tokenCatTitle",a.style.cursor="pointer",i.style.width="90%",i.style.borderRight="2px solid red",a.addEventListener("click",(function(){"wrap"===i.style.flexWrap?(i.style.display="inline-flex",i.style.height="220px",i.style.alignItems="flex-start",i.style.flexWrap="nowrap"):(i.style.flexWrap="wrap",i.style.height="",i.style.alignItems="")})),r.appendChild(a),i.style.height="220px",i.style.alignItems="flex-start",i.style.flexWrap="nowrap",ON.forEach((function(e){i.append(e)}))}var o=[];for(var s in _N)o.push(_N[s]);var l=o[parseInt(Math.random()*o.length)].description;l.length>500&&(l=l.substring(0,500)+"...");var u="";(Gn<=6||Gn>=20)&&(u='style="background-color:#313131;color:white;"',e.style.color="white");var c=document.createElement("div");c.id="highlight",c.innerHTML="<div ".concat(u," id='highlightDesc' class='helperPanel'>\n    ").concat(gj.highlights,"\n        </div>\n        ");var h=document.createElement("div");h.innerHTML="<div class='tokenCatTitle'>First Person - Handeld Items</div>";var d=document.createElement("div");d.className="tokensDiv";var f=document.createElement("div");f.innerHTML="<div class='tokenCatTitle'>Rooms & spaces</div>";var p=document.createElement("div");p.className="tokensDiv";var m=document.createElement("div");m.innerHTML="<div class='tokenCatTitle'>Skies and environments</div>";var v=document.createElement("div");v.className="tokensDiv";var g=document.createElement("div");g.innerHTML="<div class='tokenCatTitle'>Sculptures</div>";var y=document.createElement("div");y.className="tokensDiv";var b=document.createElement("div");b.innerHTML="<div class='tokenCatTitle'>Masks</div>";var x=document.createElement("div");for(var w in _N){var _=_N[w];switch(_.type){case"firstPerson":d.appendChild(_.DOMelements.profile);break;case"world":_.tag.room||_.tag.commune?p.appendChild(_.DOMelements.profile):_.tag.item&&y.appendChild(_.DOMelements.profile);break;case"skybox":v.appendChild(_.DOMelements.profile);break;case"sprite":x.append(_.DOMelements.profile)}}[c,r,i,b,x,f,p,m,v,g,y,h,d].forEach((function(e){return t.appendChild(e)})),setTimeout((function(){document.getElementById("tutorialClick").addEventListener("click",(function(e){MN(!0),Tj()}))}),200)}():tN(),t.style.display="grid",t.style.zIndex=48,yj=!0,pj&&(bj.style.display="none",xj.style.display="none"))},Sj=document.getElementById("assetLoader"),Mj=function(){var e=document.getElementById("keyhelper");"none"===e.style.display?(e.style.display="flex",e.style.animation="keyhelpappear .3s linear forwards"):(setTimeout((function(){return e.style.display="none"}),300),e.style.animation="keyhelpdisappear .3s linear forwards")};document.getElementById("keyhelpclose").addEventListener("click",Mj);var Aj=0,kj=function(){return Pj=!Pj},Pj=!1,Rj=!0,Cj=!1,Lj=function(e){return Cj=e},Ij=0;window.localStorage,zn({minus:"-"});var Oj=document.getElementById("audio-radio"),Dj=function(e){return Aj=e},Nj=document.getElementById("mobile-chat"),Bj=function(){var e=document.getElementById("messageDiv"),t=document.getElementById("sendMessage");"none"===e.style.display?(cj||(document.getElementById("mobile-chat").style.background="radial-gradient( rgba(255, 0, 0, 0.6) 0%, rgba(255, 0, 0, 0.2) 100% )"),e.style.display="block",t.style.display="block"):(cj||(document.getElementById("mobile-chat").style.background="radial-gradient( rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0.5) 100% )"),e.style.display="none",t.style.display="none")};function Uj(){if(cG.children.length>0){var e=cG.children[0];if(nB()&&TL){uG.attach(e);var t=EU(e);HN.emit("".concat($N.space.id,"-WORLDITEM"),JSON.stringify(t)),"datavis"!=e.userData.tokenType&&uG.remove(e)}else e.children.forEach((function(e){("Mesh"===e.type||e.isLineSegments)&&("PlaneGeometry"===e.geometry.type?(e.material.opacity=1,e.material.transparent=!1):e.isLineSegments||(e.material=OF.whiteFull))})),uG.attach(e),bP();cG.clear(),zB(!0),Fj=0,zj(),Pj&&kj()}}function zj(){var e=document.getElementById("worldItemTooltip");e.style.animation="worldToolTipSlideOut 0.1s linear forwards",setTimeout((function(){e.innerHTML="",e.style.display="none"}),300),zB(1),pj&&(document.getElementById("hang-button").style.display="none")}Nj.addEventListener("click",Bj);var Fj=0,Hj=function(e){if(!Aj)switch(e.code){case"ShiftLeft":Cj?Cj=!1:Ij||(Cj=!0,setTimeout((function(){Cj=!1}),7e3),Ij=!0,setTimeout((function(){Ij=!1}),2e4));break;case"KeyT":Bj();break;case"KeyB":Mj();break;case"KeyL":Tj(!0);break;case"KeyE":default:break;case"KeyP":!function(){var e=function(e){var t=new Image;return t.src=e.domElement.toDataURL(),mO.play(),t}(iG);e.style="display:block;\n    margin:auto;\n    pointer-events:none;\n    max-width:60%;\n    max-height:60%;\n    border-radius: 5px;\n    box-shadow: 0px 0px 20px black;\n    cursor:auto;\n    ",Sj.append(e),Sj.style.display="flex",yG.unlock();var t=document.createElement("div");t.innerHTML='<a href="'.concat(e.src,'" style="color:white" download="anaverse-screenshot">Download HD</a>'),t.id="saveScreenshotDiv",Sj.append(t)}();break;case"KeyC":var t=document.getElementById("viseur");"block"===t.style.display?t.style.display="none":t.style.display="block";break;case"KeyK":document.body.requestFullscreen();break;case"KeyG":0===cG.children.length&&Tj();break;case"KeyN":if("none"===document.getElementById("worldItemTooltip").style.display){if(TB){Fj=1;var n=TB.object.parent;if(nB()){var r=EU(n);HN.emit("".concat($N.space.id,"-WORLDITEM-REMOVE"),JSON.stringify(r))}cG.attach(n),BU(TB.object.parent),yG.unlock(),zB(0)}}else zj();break;case"KeyH":Uj();break;case"KeyY":"flex"===Oj.style.display?Oj.style.display="none":Oj.style.display="flex";break;case"KeyV":Rj=!Rj}};function jj(e){return jj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jj(e)}function Gj(e,t,n){return t=Wj(t),function(e,t){if(t&&("object"===jj(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qj(e)}(e,Vj()?Reflect.construct(t,n||[],Wj(e).constructor):t.apply(e,n))}function Vj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vj=function(){return!!e})()}function Wj(e){return Wj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wj(e)}function qj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xj(e,t){return Xj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xj(e,t)}var Yj,Kj,Jj=new Ul(0,0,0,"YXZ"),Zj=new Qs,Qj={type:"change"},$j={type:"lock"},eG={type:"unlock"},tG=Math.PI/2;function nG(e){return e>-3*tG/2&&e<-tG/2?-tG:e>-tG/2&&e<tG/2?0:e>tG/2&&e<1.5*tG?tG:e>1.5*tG||e<-3*tG/2?2*tG:void 0}var rG,iG,aG=function(e){function t(e,n){var r,i;function a(){Yj.domElement.ownerDocument.pointerLockElement===Yj.domElement?(Yj.dispatchEvent($j),Yj.isLocked=!0):(Yj.dispatchEvent(eG),Yj.isLocked=!1)}function o(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=Gj(this,t),void 0===n&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),n=document.body),r.domElement=n,r.isLocked=!1,r.minPolarAngle=0,r.maxPolarAngle=Math.PI,Yj=qj(r),Kj=function(t){if(!1!==Yj.isLocked){var n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;if(Jj.setFromQuaternion(e.quaternion),Jj.y-=.002*n,Jj.x-=.002*r,Jj.x=Math.max(tG-Yj.maxPolarAngle,Math.min(tG-Yj.minPolarAngle,Jj.x)),e.quaternion.setFromEuler(Jj),Pj){var i=new Ul(nG(Jj._x),nG(Jj._y),nG(Jj._z),"YXZ");cG.quaternion.setFromEuler(i)}else cG.quaternion.setFromEuler(Jj);hG.quaternion.setFromEuler(Jj),Yj.dispatchEvent(Qj)}},r.connect=function(){Yj.domElement.ownerDocument.addEventListener("mousemove",Kj),Yj.domElement.ownerDocument.addEventListener("pointerlockchange",a),Yj.domElement.ownerDocument.addEventListener("pointerlockerror",o)},r.disconnect=function(){Yj.domElement.ownerDocument.removeEventListener("mousemove",Kj),Yj.domElement.ownerDocument.removeEventListener("pointerlockchange",a),Yj.domElement.ownerDocument.removeEventListener("pointerlockerror",o)},r.dispose=function(){this.disconnect()},r.getObject=function(){return e},r.getDirection=(i=new Qs(0,0,-1),function(t){return t.copy(i).applyQuaternion(e.quaternion)}),r.moveForward=function(t){Zj.setFromMatrixColumn(e.matrix,0),Zj.crossVectors(e.up,Zj),e.position.addScaledVector(Zj,t)},r.moveRight=function(t){Zj.setFromMatrixColumn(e.matrix,0),e.position.addScaledVector(Zj,t)},r.lock=function(){r.domElement.requestPointerLock&&(r.domElement.requestPointerLock(),setTimeout((function(){zB(!0)}),500))},r.unlock=function(){return Yj.domElement.ownerDocument.exitPointerLock()},r.connect(),document.addEventListener("pointerlockchange",(function(e){document.pointerLockElement?setTimeout((function(){return zB(1)}),1e3):zB(0)}),!1),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xj(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(as),oG=new lf;oG.name="fpGroup";var sG=new lf;sG.name="worldGroup";var lG=new lf;lG.name="roomGroup";var uG=new lf;uG.name="itemGroup";var cG=new lf;cG.name="movingGroup";var hG=new lf;hG.name="torcheGroup";var dG,fG=!1,pG=function(e){return fG=e},mG=1;sG.add(lG,uG,cG,hG);var vG,gG,yG,bG=new Qs,xG=0,wG=function(){return xG=!1},_G=function(){bG.y=0,UN?(gG.position.x=UN.position.x,gG.position.y=UN.position.y,gG.position.z=UN.position.z,gG.lookAt(UN.position.x+UN.direction.x,UN.position.y+UN.direction.y,UN.position.z+UN.direction.z)):gG.position.set(0,1.5,0)},EG=new sg,TG=function(e,t){var n=[];for(var r in e){var i=document.createElement("canvas");i.width=t,i.height=t,i.getContext("2d").putImageData(e[r],0,0),n.push(i.toDataURL())}var a=EG.load(n);a.needsUpdate=!0,a.colorSpace=fo,a.mapping=ki,rG.background=a,setTimeout((function(){oI()}),1200),fj()},SG=function(){var e=new _y,t=new bs;t.x=0,t.y=0,e.setFromCamera(t,gG),YU("startPoint",{position:{x:gG.position.x,y:gG.position.y,z:gG.position.z},direction:{x:e.ray.direction.x,y:e.ray.direction.y,z:e.ray.direction.z}}),document.getElementById("currentStartingPointDiv")&&(document.getElementById("currentStartingPointDiv").innerText="Current starting point:"+JSON.stringify(WU.startPoint))};r["Total ANAVER.SE"].dbut=window.performance.now(),console.info("\n _______ _______ _______ _______ _______ _______     _______ _______ \n|  _  | |   | | |  _  | |  |  | |   __|_| __  | |   |   __|_|   __|_|\n|     | | | | | |     | |  |  | |   __|_|    -|-|_ _|__   | |   __|_|\n|__|__|_|_|___|_|__|__|_|____/_/|_____|_|__|__|_|_|_|_____|_|_____|_|\n                                                  \nWelcome to the anaver.se\nIf you want to learn more -> twitter.com/anaglyph_ic"),function(){r["Code Barre"].dbut=window.performance.now();var e=document.getElementById("cont");document.getElementById("barcode")&&document.getElementById("barcode").remove();var t=Hn("svg").attr("width",200).attr("height",40).attr("id","barcode");t.style("left","10px"),t.style("top","0px"),t.style("position","absolute");for(var n=t.append("g").attr("id","barrouge"),i=t.append("g").attr("id","barcyan"),a=0;a<30;a++)i.append("rect").style("mix-blend-mode",qn).attr("x",5*a).attr("y",.01*window.innerHeight).attr("width",Wn[a]).attr("height",40).attr("fill","rgb(0,255,235)"),n.append("rect").style("mix-blend-mode",qn).attr("x",5*a).attr("y",.01*window.innerHeight).attr("width",Wn[a]).attr("height",40).attr("fill","rgb(255,0,0)");e.append(t.node()),r["Code Barre"].fin=window.performance.now()}(),function(){if(Gn<=6||Gn>=20){document.getElementById("hider").style.backgroundColor="#313131",document.getElementById("titleG").style.mixBlendMode="screen",document.getElementById("titleR").style.mixBlendMode="screen",document.getElementById("enterR").style.mixBlendMode="screen",document.getElementById("enterG").style.mixBlendMode="screen",document.getElementById("links").style.color="white",document.getElementById("connectInfo").style.color="white",document.getElementById("perfMode").style.color="white",document.getElementById("anavTooltip").style.backgroundColor="rgba(25, 25, 25, 0.6)",document.getElementById("header").style.backgroundColor="rgba(25, 25, 25, 0.6)",document.getElementById("header").style.color="white";for(var e=document.getElementsByClassName("hiderlinks"),t=0;t<e.length;t++)e[t].style.color="white"}}(),function(){var e=JSON.parse(WH.getItem("walldir")),t=document.getElementById("tezosWalletsDirectory");for(var n in e.tez){var r=document.createElement("option");r.value=e.tez[n].name+" - "+n,t.append(r)}}(),function(){var e=window.innerHeight,t=window.innerWidth,n=document.getElementById("cont"),r=new Vg,i=t/e,a=new Qs;document.addEventListener("keydown",Hj),document.getElementById("loader-button").addEventListener("click",(function(){Tj(!0)})),document.getElementById("gallery-button").addEventListener("click",(function(){0===cG.children.length&&(tN(),Tj())})),document.getElementById("hang-button").addEventListener("click",Uj);var o=new bf;(vG=new bc(60,i,1e-4,1e4)).position.set(0,0,.1);var s=new pf({antialias:0,alpha:!0});s.setClearColor(0,0),s.setSize(t,e),s.setPixelRatio(1),o.background=null,oG.position.set(.1,-.11,-.1),oG.rotation.y=-Math.PI/2,o.add(oG),iG=new pf({antialias:0,preserveDrawingBuffer:!0}),mG=iG.capabilities.getMaxAnisotropy(),iG.outputColorSpace=fo,iG.setSize(t,e),iG.setPixelRatio(1),(gG=new bc(60,i,.1,1e4)).position.set(0,1,2),rG=new bf;var l=new Sg(4210752,30);rG.add(l),sG.name="World",rG.add(sG),n.appendChild(iG.domElement),iG.domElement.style.position="absolute",iG.domElement.style.top="0px",iG.domElement.style.left="0px",iG.domElement.style.width=t+"px",iG.domElement.style.height=e+"px";var u="rgb(".concat(Math.floor(150*Math.random()),",").concat(Math.floor(120*Math.random()),",").concat(Math.floor(150*Math.random()),")"),c=new vu(u);rG.background=c,n.appendChild(s.domElement),s.domElement.style.position="absolute",s.domElement.style.top="0px",s.domElement.style.left="0px",s.domElement.style.pointerEvents="none",yG=new aG(gG,iG.domElement);var h=!1,d=!1,f=!1,p=!1;rG.add(yG.getObject());var m,v,g,y=!1,b=document.getElementById("mobile-jetpack");b.addEventListener("touchstart",(function(e){e.preventDefault(),y?m&&(clearInterval(m),oO(),b.style.background="radial-gradient( rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0.5) 100% )"):(w(e),m=setInterval((function(){aO(),bG.y+=2}),40),b.style.background="radial-gradient( rgba(255, 25, 25, 0.7) 0%, rgba(255, 25, 25, 0.5) 100% )"),y=!y})),b.addEventListener("touchend",(function(e){m&&(clearInterval(m),oO(),b.style.background="radial-gradient( rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0.5) 100% )",y=!1)}));var x=new Ul(0,0,0,"YXZ"),w=function(e){for(var t=0;t<e.touches.length;t++){var n=e.touches[t];n.clientX<window.innerWidth/2&&(g=n)}fG=!1};iG.domElement.addEventListener("touchstart",w),iG.domElement.addEventListener("touchmove",(function(e){for(var t=0;t<e.touches.length;t++){var n=e.touches[t];if(n.clientY>.3*window.innerHeight)if(n.clientX>window.innerWidth/2){e.preventDefault(),v&&(e.movementX=15*(n.pageX-v.pageX),e.movementY=3*(n.pageY-v.pageY));var r=e.movementX||e.mozMovementX||e.webkitMovementX||0,i=e.movementY||e.mozMovementY||e.webkitMovementY||0;x.setFromQuaternion(gG.quaternion),x.y-=.002*r,x.x-=.002*i,gG.quaternion.setFromEuler(x),cG.quaternion.setFromEuler(x),hG.quaternion.setFromEuler(x),v=n}else e.preventDefault(),g&&(e.movementX=n.pageX-g.pageX,e.movementY=n.pageY-g.pageY),_&&(h=!1,f=!1,p=!1,d=!1,window.innerHeight,Math.abs(e.movementX)<Math.abs(e.movementY)?e.movementY>0?(h=!1,f=!1,p=!1,d=!0):(h=!0,f=!1,p=!1,d=!1):Math.abs(e.movementX)>Math.abs(e.movementY)&&(e.movementX>0?(h=!1,f=!1,p=!0,d=!1):(h=!1,f=!0,p=!1,d=!1)),g=n,_=!1)}})),iG.domElement.addEventListener("touchend",(function(){g=!1}));var _=!0;iG.domElement.addEventListener("touchend",(function(e){h=!1,d=!1,f=!1,p=!1,v=!1,_=!0})),document.addEventListener("keydown",(function(e){if(!Aj)switch(e.code){case"ArrowUp":case"KeyW":h=!0;break;case"ArrowLeft":case"KeyA":f=!0;break;case"ArrowDown":case"KeyS":d=!0;break;case"ArrowRight":case"KeyD":p=!0;break;case"Space":bG.y<.5&&yG.getObject().position.y>-20?bG.y+=30:(bG.y+=2,aO());break;case"KeyR":_G()}})),document.addEventListener("keyup",(function(e){switch(e.code){case"ArrowUp":case"KeyW":h=!1;break;case"ArrowLeft":case"KeyA":f=!1;break;case"ArrowDown":case"KeyS":d=!1;break;case"ArrowRight":case"KeyD":p=!1;break;case"Space":oO()}})),yG.moveSpeed=0;var E=new Qs,T=new Qs,S=new tl,M=new kl,A=new Cy,k=new Cy(new Qs,new Qs(0,-1,0)),P=!1;dG=function(){if(!yj){var n=function(e){if(Cj||(yG.getObject().position.y<8&&bG.y<0&&yG.getObject().position.y>3?bG.y=-30/uj:bG.y-=50*e/uj),bG.x-=10*bG.x*e*1,bG.z-=10*bG.z*e*1,a.z=Number(h)-Number(d),a.x=Number(p)-Number(f),a.normalize(),yG.getObject().updateMatrixWorld(),(h||d)&&(bG.z-=a.z*yG.moveSpeed*e*1.2),(f||p)&&(bG.x-=a.x*yG.moveSpeed*e*1.2),yG.moveRight(-bG.x*e),yG.moveForward(-bG.z*e),yG.getObject().position.y+=bG.y*e,pP){S.makeEmpty(),M.copy(pP.matrixWorld).invert(),A.copy(k),A.start.applyMatrix4(yG.getObject().matrixWorld).applyMatrix4(M),A.end.applyMatrix4(yG.getObject().matrixWorld).applyMatrix4(M),S.expandByPoint(A.start),S.expandByPoint(A.end),S.min.addScalar(-1),S.max.addScalar(1);var t=!1;pP.geometry.boundsTree.shapecast({intersectsBounds:function(e){return e.intersectsBox(S)},intersectsTriangle:function(e){var n=E,r=T,i=e.closestPointToSegment(A,n,r);if(i<1){t=!0;var a=1-i,o=r.sub(n).normalize();A.start.addScaledVector(o,a),A.end.addScaledVector(o,a)}}});var n=E;n.copy(A.start).applyMatrix4(pP.matrixWorld);var r=T;r.subVectors(n,yG.getObject().position);var i=Math.max(0,r.length()-.1);r.normalize().multiplyScalar(i),t?(yG.getObject().position.add(r),lO(!!(d||h||f||p)),r.y<1&&r.y>0&&(bG.y=.01)):lO(!1)}yG.getObject().position.y<-25&&_G()};if(YB(),ij)P||(lG.children.forEach((function(e){"green"===e.userData.color&&(e.clear(),lG.remove(e))})),iG.renderLists.dispose(),P=!0);else{var i=gG.getWorldDirection(new Qs),l=i.z>0?-1:1,u=i.x>0?1:-1;lG.children.forEach((function(e){"green"===e.userData.color&&(e.position.x=Math.abs(.2*i.x)*l,e.position.z=Math.abs(.2*i.z)*u)}))}if(mj&&fG){if(!xG){(xG=new qb(iG)).addPass(new jb(rG,gG));var c=new bx(rG,gG,t,e),m=(new tl).setFromObject(rG),v=Math.abs(m.max.x)+Math.abs(m.max.y)+Math.abs(m.max.z)+Math.abs(m.min.x)+Math.abs(m.min.y)+Math.abs(m.min.z);c.configuration.aoRadius=v/500,c.configuration.distanceFalloff=v/60,c.configuration.intensity=2,c.configuration.aoSamples=3,c.configuration.denoiseRadius=0,c.configuration.denoiseSamples=1,xG.addPass(c),xG.render()}xG.render()}else iG.render(rG,gG);s.render(o,vG);for(var g=Math.min(r.getDelta(),.5),y=0;y<2;y++)if(n(g/2),pP&&rD)for(var b=0;b<3;b++)JO(g/5,pP);Pj?cG.position.set(Math.floor(yG.getObject().position.x),Math.floor(yG.getObject().position.y),Math.floor(yG.getObject().position.z)):cG.position.set(yG.getObject().position.x,yG.getObject().position.y,yG.getObject().position.z),hG.position.set(yG.getObject().position.x,yG.getObject().position.y,yG.getObject().position.z)}requestAnimationFrame(dG)},window.addEventListener("resize",(function(){e=window.innerHeight,t=window.innerWidth,gG.aspect=t/e,gG.updateProjectionMatrix(),iG.setSize(t,e),iG.setPixelRatio(1),xG&&fG&&xG.setSize(t,e),vG.aspect=t/e,vG.updateProjectionMatrix(),s.setSize(t,e),s.setPixelRatio(1),document.getElementById("vidsem")&&(document.getElementById("vidsem").width=.25*window.innerWidth)}))}(),jN({native:!0,nativeRequestType:"generatorList"}),hj(),function(){return(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(UL||(e=['\n      query {\n        token(\n          where: {\n            tags: { tag: { name: { _eq: "anaverse-gallery" } } }\n            supply: { _gt: "0" }\n          }\n          limit: 500\n        ) {\n          name\n          description\n          creators {\n            creator_address\n            holder {\n              address\n              alias\n              logo\n              twitter\n              tzdomain\n            }\n          }\n          fa_contract\n          token_id\n          artifact_uri\n          thumbnail_uri\n          holders {\n            holder_address\n          }\n        }\n      }\n    '],t||(t=e.slice(0)),UL=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))))).then((function(e){var t=[];e.token.forEach((function(e){var n="https://assets.objkt.media/file/assets-003/"+e.artifact_uri.replace("ipfs://","")+"/artifact",r=!0;if(e.holders.forEach((function(e){"tz1burnburnburnburnburnburnburjAYjjX"===e.holder_address&&(r=!1)})),r){var i=e.creators[0].creator_address;t.push(i),qL.hasOwnProperty(i)||(qL[i]=[]),qL[i].push({galurl:n,contract:e.fa_contract,id:e.token_id,curator:i,thumbnail:e.thumbnail_uri,artifact:e.artifact_uri,item:e,load:!1}),YL.get("gallery")&&YL.get("galc")===e.fa_contract&&YL.get("galid")===e.token_id&&KL.postMessage({type:"remote",galleryURLs:[{galurl:n,contract:e.fa_contract,id:e.token_id,curator:i,thumbnail:e.thumbnail_uri,artifact:e.artifact_uri,item:e,load:!0}]})}})),zH(t).then((function(){Object.values(qL).forEach((function(e){var t=e[0];t.chain="tezos",t.token_id=e[0].id,t.name="Galleries by",t.list=e,WL.push(aH(t,"galleryCurator"))}))}))}));var e,t}(),(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(xL||(xL=PL(['\n      {\n        token_tag(\n          where: {\n            tag: { name: { _ilike: "anaverse-sem" } }\n            token: {\n              holders: {\n                holder_address: { _eq: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9" }\n                quantity: { _gt: "0" }\n              }\n            }\n          }\n        ) {\n          token {\n            creators {\n              creator_address\n            }\n            description\n            fa_contract\n            name\n            token_id\n            artifact_uri\n            thumbnail_uri\n            tags {\n              tag {\n                name\n              }\n            }\n            holders {\n              holder_address\n            }\n            extra\n          }\n        }\n      }\n    '])))).then((function(e){return e.token_tag})).then((function(e){return e.forEach((function(e){var t=e.token;t.contract=t.fa_contract,t.tags.forEach((function(e){if(0===e.tag.name.indexOf("gallery://")){var n=e.tag.name.replace("gallery://","");t.gallery_contract=n.substring(0,n.indexOf("/")),t.gallery_token_id=n.substring(n.indexOf("/")+1)}0===e.tag.name.indexOf("lang://")&&(t.lang=" ("+e.tag.name.replace("lang://","")+")")})),t.extra.forEach((function(e){"video/mp4"===e.mime_type&&(t.size=Math.ceil(e.file_size/1e6)+" Mo")})),t.vidsrc="https://assets.objkt.media/file/assets-003/".concat(t.artifact_uri.replace("ipfs://",""),"/artifact");var n="";t.gallery_contract&&t.gallery_token_id&&Object.values(qL).forEach((function(e){return e.forEach((function(e){e.contract===t.gallery_contract&&e.id===t.gallery_token_id&&(n=e)}))})),t.targetGallery=n,t.targetGallery&&LL.push(n),CL[t.contract+t.token_id]={vidsrc:t.vidsrc},t.chain="tezos";var r=aH(t,"loadSeminar");RL.appendChild(r);var i=window.location.search,a=new URLSearchParams(i);t.poster="https://assets.objkt.media/file/assets-003/".concat(t.fa_contract,"/").concat(t.token_id,"/thumb288"),a.has("videoguide")&&a.has("vgc")&&a.has("vgid")&&IL(CL[a.get("vgc")+a.get("vgid")].vidsrc,"https://assets.objkt.media/file/assets-003/".concat(a.get("vgc"),"/").concat(a.get("vgid"),"/thumb288"),a.get("vgc")+a.get("vgid"))})),(0,xx.request)("https://data.objkt.com/v3/graphql",(0,xx.gql)(wL||(wL=PL(['\n      {\n        token_tag(\n          where: {\n            tag: { name: { _eq: "anaverse-sem-subtitle" } }\n            token: {\n              holders: {\n                holder_address: { _eq: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9" }\n                quantity: { _gt: "0" }\n              }\n            }\n          }\n        ) {\n          token {\n            creators {\n              creator_address\n            }\n            fa_contract\n            name\n            token_id\n            artifact_uri\n            thumbnail_uri\n            tags {\n              tag {\n                name\n              }\n            }\n            holders {\n              holder_address\n            }\n            extra\n            attributes {\n              attribute {\n                name\n                value\n              }\n            }\n          }\n        }\n      }\n    '])))).then((function(e){return e.token_tag})).then((function(e){e.forEach((function(e){e=e.token;var t,n,r="",i=e.creators[0].creator_address;e.attributes.forEach((function(e){switch(e.attribute.name){case"seminar":var i=e.attribute.value;t=i.substring(0,i.indexOf("/")),n=i.substring(i.indexOf("/")+1);break;case"lang":r=e.attribute.value}}));var a="https://assets.objkt.media/file/assets-003/".concat(e.artifact_uri.replace("ipfs://",""),"/artifact");if(CL.hasOwnProperty(t+n)){var o=CL[t+n];o.hasOwnProperty("subtitles")||(o.subtitles=[]),o.subtitles.push({lang:r,author:i,src:a})}}))})),RL})),window.testBox=function(e,t){t||(t=vO());var n=1.75*window.innerHeight;return mU.postMessage({side:n,skyurl:e,hash:t}),console.info("Loading test skybox")},window.testRoom=function(e,t,n){t||(t=vO()),n||(n="Test Room"),KU.postMessage({figuresUrl:e,hash:t,type:"world",tag:{room:!0},name:n})},window.testFirstPerson=function(e,t,n){t||(t=vO()),KU.postMessage({figuresUrl:e,hash:t,type:"firstPerson",tag:{firstPerson:!0},name:n})},window.testItem=function(e,t,n){t||(t=vO()),KU.postMessage({figuresUrl:e,hash:t,type:"world",tag:{item:!0},name:n})},window.testPeinture=function(e){return RO([e])},window.testCommune=function(e,t,n,r){if(r||(r=10),!t){t=[];for(var i=0;i<r;i++)t.push(vO())}n||(n="Test commune"),KU.postMessage({figuresUrl:e,hash:t,type:"world",tag:{room:!0},name:n})},window.testSprite=function(e,t){t||(t=vO());var n=window.innerHeight;return playerspriteworker.postMessage({side:n,spriteURL:e,hash:t,id}),console.info("Loading test sprite")},window.toggleGrav=function(){return Lj(!Cj)},function(){var e=window.location.search,t=new URLSearchParams(e);if(!t.has("gallery"))if(tB.getItem("currentUserSpace")&&!t.has("tutorial")){var n=JSON.parse(tB.getItem("currentUserSpace"));n.name.length>0&&hj(n.name),"tutorial"===n.space.id?MN():t.has("gallery")||t.has("loadroom")||(sB(n.space.id),function(){EN("ANAVER.SE - generative stereoscopic experiments","https://anaver.se/anaverse-splash.png");var e={room:[],fp:[],sky:[]};for(var t in _N)_N[t].tag.hasOwnProperty("room")&&e.room.push(_N[t]);if(Gn>=6&&Gn<20)nz({skyboxUrl:"./initial_skybox.js",tag:{anaverse:!0,skybox:!0},type:"skybox"},0,vO(),"",!0,!1);else for(var n in _N)21525===_N[n].id&&nz(_N[n],0,vO(),"",!0,!1)}())}else $N.server="https://mux.anaver.se",$N.name="USER_"+JSON.stringify(Date.now()).substring(8),$N.space={name:"tutorial",id:"tutorial"},tB.setItem("currentUserSpace",JSON.stringify($N)),MN()}()})()})();