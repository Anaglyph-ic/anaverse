/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={8099:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7117);function i(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}function o(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}function s(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function a(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function l(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function c(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function u(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}function h(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}function d(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),u(e/4294967296>>>0,t,n),u(e>>>0,t,n+4),t}function p(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),h(e>>>0,t,n),h(e/4294967296>>>0,t,n+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=i,t.writeInt16BE=i,t.writeUint16LE=o,t.writeInt16LE=o,t.readInt32BE=s,t.readUint32BE=a,t.readInt32LE=l,t.readUint32LE=c,t.writeUint32BE=u,t.writeInt32BE=u,t.writeUint32LE=h,t.writeInt32LE=h,t.readInt64BE=function(e,t){void 0===t&&(t=0);var n=s(e,t),r=s(e,t+4);return 4294967296*n+r-4294967296*(r>>31)},t.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*a(e,t)+a(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var n=l(e,t);return 4294967296*l(e,t+4)+n-4294967296*(n>>31)},t.readUint64LE=function(e,t){void 0===t&&(t=0);var n=c(e,t);return 4294967296*c(e,t+4)+n},t.writeUint64BE=d,t.writeInt64BE=d,t.writeUint64LE=p,t.writeInt64LE=p,t.readUintBE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,i=1,o=e/8+n-1;o>=n;o--)r+=t[o]*i,i*=256;return r},t.readUintLE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,i=1,o=n;o<n+e/8;o++)r+=t[o]*i,i*=256;return r},t.writeUintBE=function(e,t,n,i){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!r.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,s=e/8+i-1;s>=i;s--)n[s]=t/o&255,o*=256;return n},t.writeUintLE=function(e,t,n,i){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!r.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,s=i;s<i+e/8;s++)n[s]=t/o&255,o*=256;return n},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e),t},t.writeFloat32LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e,!0),t},t.writeFloat64BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e),t},t.writeFloat64LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e,!0),t}},1322:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8099),i=n(7309);t.BLOCK_SIZE=128,t.DIGEST_LENGTH=64,t.KEY_LENGTH=64,t.PERSONALIZATION_LENGTH=16,t.SALT_LENGTH=16,t.MAX_LEAF_SIZE=Math.pow(2,32)-1,t.MAX_FANOUT=255,t.MAX_MAX_DEPTH=255;var o=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),s=[[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30],[28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6],[22,16,24,0,10,4,30,26,20,28,6,12,14,2,18,8],[14,18,6,2,26,24,22,28,4,12,10,20,8,0,30,16],[18,0,10,14,4,8,20,30,28,2,22,24,12,16,6,26],[4,24,12,20,0,22,16,6,8,26,14,10,30,28,2,18],[24,10,2,30,28,26,8,20,0,14,12,6,18,4,16,22],[26,22,14,28,24,2,6,18,10,0,30,8,16,12,4,20],[12,30,28,18,22,6,0,16,24,4,26,14,2,8,20,10],[20,4,16,8,14,12,2,10,30,22,18,28,6,24,26,0],[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30],[28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6]],a=function(){function e(e,n){if(void 0===e&&(e=64),this.digestLength=e,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(o),this._buffer=new Uint8Array(t.BLOCK_SIZE),this._bufferLength=0,this._ctr=new Uint32Array(4),this._flag=new Uint32Array(4),this._lastNode=!1,this._finished=!1,this._vtmp=new Uint32Array(32),this._mtmp=new Uint32Array(32),e<1||e>t.DIGEST_LENGTH)throw new Error("blake2b: wrong digest length");n&&this.validateConfig(n);var i=0;n&&n.key&&(i=n.key.length);var s=1,a=1;n&&n.tree&&(s=n.tree.fanout,a=n.tree.maxDepth),this._state[0]^=e|i<<8|s<<16|a<<24,n&&n.tree&&(this._state[1]^=n.tree.leafSize,this._state[2]^=n.tree.nodeOffsetLowBits,this._state[3]^=n.tree.nodeOffsetHighBits,this._state[4]^=n.tree.nodeDepth|n.tree.innerDigestLength<<8,this._lastNode=n.tree.lastNode),n&&n.salt&&(this._state[8]^=r.readUint32LE(n.salt,0),this._state[9]^=r.readUint32LE(n.salt,4),this._state[10]^=r.readUint32LE(n.salt,8),this._state[11]^=r.readUint32LE(n.salt,12)),n&&n.personalization&&(this._state[12]^=r.readUint32LE(n.personalization,0),this._state[13]^=r.readUint32LE(n.personalization,4),this._state[14]^=r.readUint32LE(n.personalization,8),this._state[15]^=r.readUint32LE(n.personalization,12)),this._initialState=new Uint32Array(this._state),n&&n.key&&i>0&&(this._paddedKey=new Uint8Array(t.BLOCK_SIZE),this._paddedKey.set(n.key),this._buffer.set(this._paddedKey),this._bufferLength=t.BLOCK_SIZE)}return e.prototype.reset=function(){return this._state.set(this._initialState),this._paddedKey?(this._buffer.set(this._paddedKey),this._bufferLength=t.BLOCK_SIZE):this._bufferLength=0,i.wipe(this._ctr),i.wipe(this._flag),this._finished=!1,this},e.prototype.validateConfig=function(e){if(e.key&&e.key.length>t.KEY_LENGTH)throw new Error("blake2b: wrong key length");if(e.salt&&e.salt.length!==t.SALT_LENGTH)throw new Error("blake2b: wrong salt length");if(e.personalization&&e.personalization.length!==t.PERSONALIZATION_LENGTH)throw new Error("blake2b: wrong personalization length");if(e.tree){if(e.tree.fanout<0||e.tree.fanout>t.MAX_FANOUT)throw new Error("blake2b: wrong tree fanout");if(e.tree.maxDepth<0||e.tree.maxDepth>t.MAX_MAX_DEPTH)throw new Error("blake2b: wrong tree depth");if(e.tree.leafSize<0||e.tree.leafSize>t.MAX_LEAF_SIZE)throw new Error("blake2b: wrong leaf size");if(e.tree.innerDigestLength<0||e.tree.innerDigestLength>t.DIGEST_LENGTH)throw new Error("blake2b: wrong tree inner digest length")}},e.prototype.update=function(e,n){if(void 0===n&&(n=e.length),this._finished)throw new Error("blake2b: can't update because hash was finished.");var r=t.BLOCK_SIZE-this._bufferLength,i=0;if(0===n)return this;if(n>r){for(var o=0;o<r;o++)this._buffer[this._bufferLength+o]=e[i+o];this._processBlock(t.BLOCK_SIZE),i+=r,n-=r,this._bufferLength=0}for(;n>t.BLOCK_SIZE;){for(o=0;o<t.BLOCK_SIZE;o++)this._buffer[o]=e[i+o];this._processBlock(t.BLOCK_SIZE),i+=t.BLOCK_SIZE,n-=t.BLOCK_SIZE,this._bufferLength=0}for(o=0;o<n;o++)this._buffer[this._bufferLength+o]=e[i+o];return this._bufferLength+=n,this},e.prototype.finish=function(e){if(!this._finished){for(var n=this._bufferLength;n<t.BLOCK_SIZE;n++)this._buffer[n]=0;this._flag[0]=4294967295,this._flag[1]=4294967295,this._lastNode&&(this._flag[2]=4294967295,this._flag[3]=4294967295),this._processBlock(this._bufferLength),this._finished=!0}var i=this._buffer.subarray(0,64);for(n=0;n<16;n++)r.writeUint32LE(this._state[n],i,4*n);return e.set(i.subarray(0,e.length)),this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.clean=function(){i.wipe(this._vtmp),i.wipe(this._mtmp),i.wipe(this._state),i.wipe(this._buffer),i.wipe(this._initialState),this._paddedKey&&i.wipe(this._paddedKey),this._bufferLength=0,i.wipe(this._ctr),i.wipe(this._flag),this._lastNode=!1,this._finished=!1},e.prototype.saveState=function(){if(this._finished)throw new Error("blake2b: cannot save finished state");return{state:new Uint32Array(this._state),buffer:new Uint8Array(this._buffer),bufferLength:this._bufferLength,ctr:new Uint32Array(this._ctr),flag:new Uint32Array(this._flag),lastNode:this._lastNode,paddedKey:this._paddedKey?new Uint8Array(this._paddedKey):void 0,initialState:new Uint32Array(this._initialState)}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._buffer.set(e.buffer),this._bufferLength=e.bufferLength,this._ctr.set(e.ctr),this._flag.set(e.flag),this._lastNode=e.lastNode,this._paddedKey&&i.wipe(this._paddedKey),this._paddedKey=e.paddedKey?new Uint8Array(e.paddedKey):void 0,this._initialState.set(e.initialState),this},e.prototype.cleanSavedState=function(e){i.wipe(e.state),i.wipe(e.buffer),i.wipe(e.initialState),e.paddedKey&&i.wipe(e.paddedKey),e.bufferLength=0,i.wipe(e.ctr),i.wipe(e.flag),e.lastNode=!1},e.prototype._G=function(e,t,n,r,i,o,s,a,l,c,u,h,d){var p=e[t],f=e[o],m=e[n],g=e[s],y=e[r],v=e[a],_=e[i],w=e[l],b=65535&p,x=p>>>16,E=65535&f,S=f>>>16;x+=m>>>16,E+=65535&g,S+=g>>>16,E+=(x+=(b+=65535&m)>>>16)>>>16,b=65535&(p=65535&b|x<<16),x=p>>>16,E=65535&(f=65535&E|(S+=E>>>16)<<16),S=f>>>16,x+=c>>>16,E+=65535&u,S+=u>>>16,p=65535&(b+=65535&c)|(x+=b>>>16)<<16,b=w^=f=65535&(E+=x>>>16)|(S+=E>>>16)<<16,w=_^=p,_=b,b=65535&y,x=y>>>16,E=65535&v,S=v>>>16,x+=_>>>16,E+=65535&w,S+=w>>>16,b=(m^=y=65535&(b+=65535&_)|(x+=b>>>16)<<16)<<8|(g^=v=65535&(E+=x>>>16)|(S+=E>>>16)<<16)>>>24,m=g<<8|m>>>24,g=b,b=65535&p,x=p>>>16,E=65535&f,S=f>>>16,x+=m>>>16,E+=65535&g,S+=g>>>16,E+=(x+=(b+=65535&m)>>>16)>>>16,b=65535&(p=65535&b|x<<16),x=p>>>16,E=65535&(f=65535&E|(S+=E>>>16)<<16),S=f>>>16,x+=h>>>16,E+=65535&d,S+=d>>>16,b=(_^=p=65535&(b+=65535&h)|(x+=b>>>16)<<16)<<16|(w^=f=65535&(E+=x>>>16)|(S+=E>>>16)<<16)>>>16,_=w<<16|_>>>16,w=b,b=65535&y,x=y>>>16,E=65535&v,S=v>>>16,x+=_>>>16,E+=65535&w,S+=w>>>16,b=(g^=v=65535&(E+=(x+=(b+=65535&_)>>>16)>>>16)|(S+=E>>>16)<<16)<<1|(m^=y=65535&b|x<<16)>>>31,m=m<<1|g>>>31,g=b,e[t]=p,e[o]=f,e[n]=m,e[s]=g,e[r]=y,e[a]=v,e[i]=_,e[l]=w},e.prototype._incrementCounter=function(e){for(var t=0;t<3;t++){var n=this._ctr[t]+e;if(this._ctr[t]=n>>>0,this._ctr[t]===n)return;e=1}},e.prototype._processBlock=function(e){this._incrementCounter(e);var t=this._vtmp;t.set(this._state),t.set(o,16),t[24]^=this._ctr[0],t[25]^=this._ctr[1],t[26]^=this._ctr[2],t[27]^=this._ctr[3],t[28]^=this._flag[0],t[29]^=this._flag[1],t[30]^=this._flag[2],t[31]^=this._flag[3];for(var n=this._mtmp,i=0;i<32;i++)n[i]=r.readUint32LE(this._buffer,4*i);for(var a=0;a<12;a++)this._G(t,0,8,16,24,1,9,17,25,n[s[a][0]],n[s[a][0]+1],n[s[a][1]],n[s[a][1]+1]),this._G(t,2,10,18,26,3,11,19,27,n[s[a][2]],n[s[a][2]+1],n[s[a][3]],n[s[a][3]+1]),this._G(t,4,12,20,28,5,13,21,29,n[s[a][4]],n[s[a][4]+1],n[s[a][5]],n[s[a][5]+1]),this._G(t,6,14,22,30,7,15,23,31,n[s[a][6]],n[s[a][6]+1],n[s[a][7]],n[s[a][7]+1]),this._G(t,0,10,20,30,1,11,21,31,n[s[a][8]],n[s[a][8]+1],n[s[a][9]],n[s[a][9]+1]),this._G(t,2,12,22,24,3,13,23,25,n[s[a][10]],n[s[a][10]+1],n[s[a][11]],n[s[a][11]+1]),this._G(t,4,14,16,26,5,15,17,27,n[s[a][12]],n[s[a][12]+1],n[s[a][13]],n[s[a][13]+1]),this._G(t,6,8,18,28,7,9,19,29,n[s[a][14]],n[s[a][14]+1],n[s[a][15]],n[s[a][15]+1]);for(i=0;i<16;i++)this._state[i]^=t[i]^t[i+16]},e}();t.BLAKE2b=a,t.hash=function(e,n,r){void 0===n&&(n=t.DIGEST_LENGTH);var i=new a(n,r);i.update(e);var o=i.digest();return i.clean(),o}},3683:(e,t)=>{"use strict";t.z=function(){for(var e=0,t=0;t<arguments.length;t++)e+=arguments[t].length;var n=new Uint8Array(e),r=0;for(t=0;t<arguments.length;t++){var i=arguments[t];n.set(i,r),r+=i.length}return n}},4153:(e,t)=>{"use strict";function n(e,t){if(e.length!==t.length)return 0;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 1&n-1>>>8}Object.defineProperty(t,"__esModule",{value:!0}),t.select=function(e,t,n){return~(e-1)&t|e-1&n},t.lessOrEqual=function(e,t){return(0|e)-(0|t)-1>>>31&1},t.compare=n,t.equal=function(e,t){return 0!==e.length&&0!==t.length&&0!==n(e,t)}},1050:(e,t,n)=>{"use strict";t.zh=t.SH=t.Xx=t._w=t.aP=t.KS=t.jQ=void 0;n(1416);const r=n(3350),i=n(7309);function o(e){const t=new Float64Array(16);if(e)for(let n=0;n<e.length;n++)t[n]=e[n];return t}t.jQ=64,t.KS=64,t.aP=32,new Uint8Array(32)[0]=9;const s=o(),a=o([1]),l=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t){for(let n=0;n<16;n++)e[n]=0|t[n]}function f(e){let t=1;for(let n=0;n<16;n++){let r=e[n]+t+65535;t=Math.floor(r/65536),e[n]=r-65536*t}e[0]+=t-1+37*(t-1)}function m(e,t,n){const r=~(n-1);for(let n=0;n<16;n++){const i=r&(e[n]^t[n]);e[n]^=i,t[n]^=i}}function g(e,t){const n=o(),r=o();for(let e=0;e<16;e++)r[e]=t[e];f(r),f(r),f(r);for(let e=0;e<2;e++){n[0]=r[0]-65517;for(let e=1;e<15;e++)n[e]=r[e]-65535-(n[e-1]>>16&1),n[e-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const e=n[15]>>16&1;n[14]&=65535,m(r,n,1-e)}for(let t=0;t<16;t++)e[2*t]=255&r[t],e[2*t+1]=r[t]>>8}function y(e,t){const n=new Uint8Array(32),r=new Uint8Array(32);return g(n,e),g(r,t),function(e,t){let n=0;for(let r=0;r<32;r++)n|=e[r]^t[r];return(1&n-1>>>8)-1}(n,r)}function v(e){const t=new Uint8Array(32);return g(t,e),1&t[0]}function _(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]+n[r]}function w(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]-n[r]}function b(e,t,n){let r,i,o=0,s=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=0,w=0,b=0,x=0,E=0,S=0,M=0,T=0,A=0,R=0,C=0,L=0,P=0,I=0,O=0,N=0,k=0,D=n[0],B=n[1],U=n[2],z=n[3],F=n[4],H=n[5],G=n[6],V=n[7],j=n[8],W=n[9],q=n[10],K=n[11],X=n[12],Y=n[13],J=n[14],Z=n[15];r=t[0],o+=r*D,s+=r*B,a+=r*U,l+=r*z,c+=r*F,u+=r*H,h+=r*G,d+=r*V,p+=r*j,f+=r*W,m+=r*q,g+=r*K,y+=r*X,v+=r*Y,_+=r*J,w+=r*Z,r=t[1],s+=r*D,a+=r*B,l+=r*U,c+=r*z,u+=r*F,h+=r*H,d+=r*G,p+=r*V,f+=r*j,m+=r*W,g+=r*q,y+=r*K,v+=r*X,_+=r*Y,w+=r*J,b+=r*Z,r=t[2],a+=r*D,l+=r*B,c+=r*U,u+=r*z,h+=r*F,d+=r*H,p+=r*G,f+=r*V,m+=r*j,g+=r*W,y+=r*q,v+=r*K,_+=r*X,w+=r*Y,b+=r*J,x+=r*Z,r=t[3],l+=r*D,c+=r*B,u+=r*U,h+=r*z,d+=r*F,p+=r*H,f+=r*G,m+=r*V,g+=r*j,y+=r*W,v+=r*q,_+=r*K,w+=r*X,b+=r*Y,x+=r*J,E+=r*Z,r=t[4],c+=r*D,u+=r*B,h+=r*U,d+=r*z,p+=r*F,f+=r*H,m+=r*G,g+=r*V,y+=r*j,v+=r*W,_+=r*q,w+=r*K,b+=r*X,x+=r*Y,E+=r*J,S+=r*Z,r=t[5],u+=r*D,h+=r*B,d+=r*U,p+=r*z,f+=r*F,m+=r*H,g+=r*G,y+=r*V,v+=r*j,_+=r*W,w+=r*q,b+=r*K,x+=r*X,E+=r*Y,S+=r*J,M+=r*Z,r=t[6],h+=r*D,d+=r*B,p+=r*U,f+=r*z,m+=r*F,g+=r*H,y+=r*G,v+=r*V,_+=r*j,w+=r*W,b+=r*q,x+=r*K,E+=r*X,S+=r*Y,M+=r*J,T+=r*Z,r=t[7],d+=r*D,p+=r*B,f+=r*U,m+=r*z,g+=r*F,y+=r*H,v+=r*G,_+=r*V,w+=r*j,b+=r*W,x+=r*q,E+=r*K,S+=r*X,M+=r*Y,T+=r*J,A+=r*Z,r=t[8],p+=r*D,f+=r*B,m+=r*U,g+=r*z,y+=r*F,v+=r*H,_+=r*G,w+=r*V,b+=r*j,x+=r*W,E+=r*q,S+=r*K,M+=r*X,T+=r*Y,A+=r*J,R+=r*Z,r=t[9],f+=r*D,m+=r*B,g+=r*U,y+=r*z,v+=r*F,_+=r*H,w+=r*G,b+=r*V,x+=r*j,E+=r*W,S+=r*q,M+=r*K,T+=r*X,A+=r*Y,R+=r*J,C+=r*Z,r=t[10],m+=r*D,g+=r*B,y+=r*U,v+=r*z,_+=r*F,w+=r*H,b+=r*G,x+=r*V,E+=r*j,S+=r*W,M+=r*q,T+=r*K,A+=r*X,R+=r*Y,C+=r*J,L+=r*Z,r=t[11],g+=r*D,y+=r*B,v+=r*U,_+=r*z,w+=r*F,b+=r*H,x+=r*G,E+=r*V,S+=r*j,M+=r*W,T+=r*q,A+=r*K,R+=r*X,C+=r*Y,L+=r*J,P+=r*Z,r=t[12],y+=r*D,v+=r*B,_+=r*U,w+=r*z,b+=r*F,x+=r*H,E+=r*G,S+=r*V,M+=r*j,T+=r*W,A+=r*q,R+=r*K,C+=r*X,L+=r*Y,P+=r*J,I+=r*Z,r=t[13],v+=r*D,_+=r*B,w+=r*U,b+=r*z,x+=r*F,E+=r*H,S+=r*G,M+=r*V,T+=r*j,A+=r*W,R+=r*q,C+=r*K,L+=r*X,P+=r*Y,I+=r*J,O+=r*Z,r=t[14],_+=r*D,w+=r*B,b+=r*U,x+=r*z,E+=r*F,S+=r*H,M+=r*G,T+=r*V,A+=r*j,R+=r*W,C+=r*q,L+=r*K,P+=r*X,I+=r*Y,O+=r*J,N+=r*Z,r=t[15],w+=r*D,b+=r*B,x+=r*U,E+=r*z,S+=r*F,M+=r*H,T+=r*G,A+=r*V,R+=r*j,C+=r*W,L+=r*q,P+=r*K,I+=r*X,O+=r*Y,N+=r*J,k+=r*Z,o+=38*b,s+=38*x,a+=38*E,l+=38*S,c+=38*M,u+=38*T,h+=38*A,d+=38*R,p+=38*C,f+=38*L,m+=38*P,g+=38*I,y+=38*O,v+=38*N,_+=38*k,i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),e[0]=o,e[1]=s,e[2]=a,e[3]=l,e[4]=c,e[5]=u,e[6]=h,e[7]=d,e[8]=p,e[9]=f,e[10]=m,e[11]=g,e[12]=y,e[13]=v,e[14]=_,e[15]=w}function x(e,t){b(e,t,t)}function E(e,t){const n=o();let r;for(r=0;r<16;r++)n[r]=t[r];for(r=253;r>=0;r--)x(n,n),2!==r&&4!==r&&b(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}function S(e,t){const n=o(),r=o(),i=o(),s=o(),a=o(),l=o(),u=o(),h=o(),d=o();w(n,e[1],e[0]),w(d,t[1],t[0]),b(n,n,d),_(r,e[0],e[1]),_(d,t[0],t[1]),b(r,r,d),b(i,e[3],t[3]),b(i,i,c),b(s,e[2],t[2]),_(s,s,s),w(a,r,n),w(l,s,i),_(u,s,i),_(h,r,n),b(e[0],a,l),b(e[1],h,u),b(e[2],u,l),b(e[3],a,h)}function M(e,t,n){for(let r=0;r<4;r++)m(e[r],t[r],n)}function T(e,t){const n=o(),r=o(),i=o();E(i,t[2]),b(n,t[0],i),b(r,t[1],i),g(e,r),e[31]^=v(n)<<7}function A(e,t){const n=[o(),o(),o(),o()];p(n[0],u),p(n[1],h),p(n[2],a),b(n[3],u,h),function(e,t,n){p(e[0],s),p(e[1],a),p(e[2],a),p(e[3],s);for(let r=255;r>=0;--r){const i=n[r/8|0]>>(7&r)&1;M(e,t,i),S(t,e),S(e,e),M(e,t,i)}}(e,n,t)}t._w=function(e){if(e.length!==t.aP)throw new Error(`ed25519: seed must be ${t.aP} bytes`);const n=(0,r.hash)(e);n[0]&=248,n[31]&=127,n[31]|=64;const i=new Uint8Array(32),s=[o(),o(),o(),o()];A(s,n),T(i,s);const a=new Uint8Array(64);return a.set(e),a.set(i,32),{publicKey:i,secretKey:a}};const R=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function C(e,t){let n,r,i,o;for(r=63;r>=32;--r){for(n=0,i=r-32,o=r-12;i<o;++i)t[i]+=n-16*t[r]*R[i-(r-32)],n=Math.floor((t[i]+128)/256),t[i]-=256*n;t[i]+=n,t[r]=0}for(n=0,i=0;i<32;i++)t[i]+=n-(t[31]>>4)*R[i],n=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=n*R[i];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,e[r]=255&t[r]}function L(e){const t=new Float64Array(64);for(let n=0;n<64;n++)t[n]=e[n];for(let t=0;t<64;t++)e[t]=0;C(e,t)}t.Xx=function(e,t){const n=new Float64Array(64),i=[o(),o(),o(),o()],s=(0,r.hash)(e.subarray(0,32));s[0]&=248,s[31]&=127,s[31]|=64;const a=new Uint8Array(64);a.set(s.subarray(32),32);const l=new r.SHA512;l.update(a.subarray(32)),l.update(t);const c=l.digest();l.clean(),L(c),A(i,c),T(a,i),l.reset(),l.update(a.subarray(0,32)),l.update(e.subarray(32)),l.update(t);const u=l.digest();L(u);for(let e=0;e<32;e++)n[e]=c[e];for(let e=0;e<32;e++)for(let t=0;t<32;t++)n[e+t]+=u[e]*s[t];return C(a.subarray(32),n),a},t.SH=function(e){let t=[o(),o(),o(),o()];if(function(e,t){const n=o(),r=o(),i=o(),c=o(),u=o(),h=o(),f=o();return p(e[2],a),function(e,t){for(let n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}(e[1],t),x(i,e[1]),b(c,i,l),w(i,i,e[2]),_(c,e[2],c),x(u,c),x(h,u),b(f,h,u),b(n,f,i),b(n,n,c),function(e,t){const n=o();let r;for(r=0;r<16;r++)n[r]=t[r];for(r=250;r>=0;r--)x(n,n),1!==r&&b(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}(n,n),b(n,n,i),b(n,n,c),b(n,n,c),b(e[0],n,c),x(r,e[0]),b(r,r,c),y(r,i)&&b(e[0],e[0],d),x(r,e[0]),b(r,r,c),y(r,i)?-1:(v(e[0])===t[31]>>7&&w(e[0],s,e[0]),b(e[3],e[0],e[1]),0)}(t,e))throw new Error("Ed25519: invalid public key");let n=o(),r=o(),i=t[1];_(n,a,i),w(r,a,i),E(r,r),b(n,n,r);let c=new Uint8Array(32);return g(c,n),c},t.zh=function(e){const t=(0,r.hash)(e.subarray(0,32));t[0]&=248,t[31]&=127,t[31]|=64;const n=new Uint8Array(t.subarray(0,32));return(0,i.wipe)(t),n}},7117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var n=65535&e,r=65535&t;return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},19:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openBox=t.box=t.precomputeSharedKey=t.generateKeyPair=void 0;const r=n(7664),i=n(7025),o=n(7801),s=n(7309);var a=n(7664);Object.defineProperty(t,"generateKeyPair",{enumerable:!0,get:function(){return a.generateKeyPair}});const l=new Uint8Array(16);function c(e,t){const n=(0,r.scalarMult)(t,e);return(0,i.hsalsa)(n,l,n),n}t.precomputeSharedKey=c,t.box=function(e,t,n,r){const i=c(e,t),a=(0,o.secretBox)(i,n,r);return(0,s.wipe)(i),a},t.openBox=function(e,t,n,r){const i=c(e,t),a=(0,o.openSecretBox)(i,n,r);return(0,s.wipe)(i),a}},450:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(19),t),i(n(7801),t)},7801:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateKey=t.openSecretBox=t.secretBox=void 0;const r=n(7025),i=n(3027),o=n(7309),s=n(1416);t.secretBox=function(e,t,n){if(24!==t.length)throw new Error("secretBox nonce must be 24 bytes");const s=new Uint8Array(64),a=new Uint8Array(32);a.set(t),(0,r.stream)(e,a,s,8);const l=new Uint8Array(16+n.length);for(let e=0;e<32&&e<n.length;e++)l[16+e]=n[e]^s[32+e];n.length>32&&(0,r.streamXOR)(e,a,n.subarray(32),l.subarray(48),8);const c=(0,i.oneTimeAuth)(s.subarray(0,32),l.subarray(16));for(let e=0;e<c.length;e++)l[e]=c[e];return(0,o.wipe)(c),(0,o.wipe)(s),(0,o.wipe)(a),l},t.openSecretBox=function(e,t,n){if(24!==t.length)throw new Error("secretBox nonce must be 24 bytes");if(n.length<16)throw new Error("secretBox data must be at least 16 bytes");const s=new Uint8Array(64),a=new Uint8Array(32);a.set(t),(0,r.stream)(e,a,s,8);const l=(0,i.oneTimeAuth)(s.subarray(0,32),n.subarray(16));if(!(0,i.equal)(l,n.subarray(0,16)))return null;const c=n.subarray(16),u=new Uint8Array(c.length);for(let e=0;e<32&&e<c.length;e++)u[e]=c[e]^s[32+e];return c.length>32&&(0,r.streamXOR)(e,a,c.subarray(32),u.subarray(32),8),(0,o.wipe)(l),(0,o.wipe)(s),(0,o.wipe)(a),u},t.generateKey=function(e){return(0,s.randomBytes)(32,e)}},3027:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4153),i=n(7309);t.DIGEST_LENGTH=16;var o=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var n=e[0]|e[1]<<8;this._r[0]=8191&n;var r=e[2]|e[3]<<8;this._r[1]=8191&(n>>>13|r<<3);var i=e[4]|e[5]<<8;this._r[2]=7939&(r>>>10|i<<6);var o=e[6]|e[7]<<8;this._r[3]=8191&(i>>>7|o<<9);var s=e[8]|e[9]<<8;this._r[4]=255&(o>>>4|s<<12),this._r[5]=s>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=8191&(s>>>14|a<<2);var l=e[12]|e[13]<<8;this._r[7]=8065&(a>>>11|l<<5);var c=e[14]|e[15]<<8;this._r[8]=8191&(l>>>8|c<<8),this._r[9]=c>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,n){for(var r=this._fin?0:2048,i=this._h[0],o=this._h[1],s=this._h[2],a=this._h[3],l=this._h[4],c=this._h[5],u=this._h[6],h=this._h[7],d=this._h[8],p=this._h[9],f=this._r[0],m=this._r[1],g=this._r[2],y=this._r[3],v=this._r[4],_=this._r[5],w=this._r[6],b=this._r[7],x=this._r[8],E=this._r[9];n>=16;){var S=e[t+0]|e[t+1]<<8;i+=8191&S;var M=e[t+2]|e[t+3]<<8;o+=8191&(S>>>13|M<<3);var T=e[t+4]|e[t+5]<<8;s+=8191&(M>>>10|T<<6);var A=e[t+6]|e[t+7]<<8;a+=8191&(T>>>7|A<<9);var R=e[t+8]|e[t+9]<<8;l+=8191&(A>>>4|R<<12),c+=R>>>1&8191;var C=e[t+10]|e[t+11]<<8;u+=8191&(R>>>14|C<<2);var L=e[t+12]|e[t+13]<<8;h+=8191&(C>>>11|L<<5);var P=e[t+14]|e[t+15]<<8,I=0,O=I;O+=i*f,O+=o*(5*E),O+=s*(5*x),O+=a*(5*b),I=(O+=l*(5*w))>>>13,O&=8191,O+=c*(5*_),O+=u*(5*v),O+=h*(5*y),O+=(d+=8191&(L>>>8|P<<8))*(5*g);var N=I+=(O+=(p+=P>>>5|r)*(5*m))>>>13;N+=i*m,N+=o*f,N+=s*(5*E),N+=a*(5*x),I=(N+=l*(5*b))>>>13,N&=8191,N+=c*(5*w),N+=u*(5*_),N+=h*(5*v),N+=d*(5*y),I+=(N+=p*(5*g))>>>13,N&=8191;var k=I;k+=i*g,k+=o*m,k+=s*f,k+=a*(5*E),I=(k+=l*(5*x))>>>13,k&=8191,k+=c*(5*b),k+=u*(5*w),k+=h*(5*_),k+=d*(5*v);var D=I+=(k+=p*(5*y))>>>13;D+=i*y,D+=o*g,D+=s*m,D+=a*f,I=(D+=l*(5*E))>>>13,D&=8191,D+=c*(5*x),D+=u*(5*b),D+=h*(5*w),D+=d*(5*_);var B=I+=(D+=p*(5*v))>>>13;B+=i*v,B+=o*y,B+=s*g,B+=a*m,I=(B+=l*f)>>>13,B&=8191,B+=c*(5*E),B+=u*(5*x),B+=h*(5*b),B+=d*(5*w);var U=I+=(B+=p*(5*_))>>>13;U+=i*_,U+=o*v,U+=s*y,U+=a*g,I=(U+=l*m)>>>13,U&=8191,U+=c*f,U+=u*(5*E),U+=h*(5*x),U+=d*(5*b);var z=I+=(U+=p*(5*w))>>>13;z+=i*w,z+=o*_,z+=s*v,z+=a*y,I=(z+=l*g)>>>13,z&=8191,z+=c*m,z+=u*f,z+=h*(5*E),z+=d*(5*x);var F=I+=(z+=p*(5*b))>>>13;F+=i*b,F+=o*w,F+=s*_,F+=a*v,I=(F+=l*y)>>>13,F&=8191,F+=c*g,F+=u*m,F+=h*f,F+=d*(5*E);var H=I+=(F+=p*(5*x))>>>13;H+=i*x,H+=o*b,H+=s*w,H+=a*_,I=(H+=l*v)>>>13,H&=8191,H+=c*y,H+=u*g,H+=h*m,H+=d*f;var G=I+=(H+=p*(5*E))>>>13;G+=i*E,G+=o*x,G+=s*b,G+=a*w,I=(G+=l*_)>>>13,G&=8191,G+=c*v,G+=u*y,G+=h*g,G+=d*m,i=O=8191&(I=(I=((I+=(G+=p*f)>>>13)<<2)+I|0)+(O&=8191)|0),o=N+=I>>>=13,s=k&=8191,a=D&=8191,l=B&=8191,c=U&=8191,u=z&=8191,h=F&=8191,d=H&=8191,p=G&=8191,t+=16,n-=16}this._h[0]=i,this._h[1]=o,this._h[2]=s,this._h[3]=a,this._h[4]=l,this._h[5]=c,this._h[6]=u,this._h[7]=h,this._h[8]=d,this._h[9]=p},e.prototype.finish=function(e,t){void 0===t&&(t=0);var n,r,i,o,s=new Uint16Array(10);if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=n,n=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=5*n,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,s[0]=this._h[0]+5,n=s[0]>>>13,s[0]&=8191,o=1;o<10;o++)s[o]=this._h[o]+n,n=s[o]>>>13,s[o]&=8191;for(s[9]-=8192,r=(1^n)-1,o=0;o<10;o++)s[o]&=r;for(r=~r,o=0;o<10;o++)this._h[o]=this._h[o]&r|s[o];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),i=this._h[0]+this._pad[0],this._h[0]=65535&i,o=1;o<8;o++)i=(this._h[o]+this._pad[o]|0)+(i>>>16)|0,this._h[o]=65535&i;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,n=0,r=e.length;if(this._leftover){(t=16-this._leftover)>r&&(t=r);for(var i=0;i<t;i++)this._buffer[this._leftover+i]=e[n+i];if(r-=t,n+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(r>=16&&(t=r-r%16,this._blocks(e,n,t),n+=t,r-=t),r){for(i=0;i<r;i++)this._buffer[this._leftover+i]=e[n+i];this._leftover+=r}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return i.wipe(this._buffer),i.wipe(this._r),i.wipe(this._h),i.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();t.Poly1305=o,t.oneTimeAuth=function(e,t){var n=new o(e);n.update(t);var r=n.digest();return n.clean(),r},t.equal=function(e,n){return e.length===t.DIGEST_LENGTH&&n.length===t.DIGEST_LENGTH&&r.equal(e,n)}},1416:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const r=n(6008),i=n(8099),o=n(7309);function s(e,n=t.defaultRandomSource){return n.randomBytes(e)}t.defaultRandomSource=new r.SystemRandomSource,t.randomBytes=s,t.randomUint32=function(e=t.defaultRandomSource){const n=s(4,e),r=(0,i.readUint32LE)(n);return(0,o.wipe)(n),r};const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(e,n=a,r=t.defaultRandomSource){if(n.length<2)throw new Error("randomString charset is too short");if(n.length>256)throw new Error("randomString charset is too long");let i="";const l=n.length,c=256-256%l;for(;e>0;){const t=s(Math.ceil(256*e/c),r);for(let r=0;r<t.length&&e>0;r++){const o=t[r];o<c&&(i+=n.charAt(o%l),e--)}(0,o.wipe)(t)}return i}t.randomString=l,t.randomStringForEntropy=function(e,n=a,r=t.defaultRandomSource){return l(Math.ceil(e/(Math.log(n.length)/Math.LN2)),n,r)}},5455:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRandomSource=void 0,t.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let e=0;e<t.length;e+=65536)this._crypto.getRandomValues(t.subarray(e,e+Math.min(t.length-e,65536)));return t}}},8871:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandomSource=void 0;const r=n(7309);t.NodeRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const e=n(5883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let e=0;e<n.length;e++)n[e]=t[e];return(0,r.wipe)(t),n}}},6008:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRandomSource=void 0;const r=n(5455),i=n(8871);t.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new r.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new i.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}},7318:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8099),i=n(7309);function o(e,t,n){for(var i,o=1634760805,s=n[3]<<24|n[2]<<16|n[1]<<8|n[0],a=n[7]<<24|n[6]<<16|n[5]<<8|n[4],l=n[11]<<24|n[10]<<16|n[9]<<8|n[8],c=n[15]<<24|n[14]<<16|n[13]<<8|n[12],u=857760878,h=t[3]<<24|t[2]<<16|t[1]<<8|t[0],d=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],f=t[15]<<24|t[14]<<16|t[13]<<8|t[12],m=2036477234,g=n[19]<<24|n[18]<<16|n[17]<<8|n[16],y=n[23]<<24|n[22]<<16|n[21]<<8|n[20],v=n[27]<<24|n[26]<<16|n[25]<<8|n[24],_=n[31]<<24|n[30]<<16|n[29]<<8|n[28],w=1797285236,b=o,x=s,E=a,S=l,M=c,T=u,A=h,R=d,C=p,L=f,P=m,I=g,O=y,N=v,k=_,D=w,B=0;B<20;B+=2)b^=(i=(O^=(i=(C^=(i=(M^=(i=b+O|0)<<7|i>>>25)+b|0)<<9|i>>>23)+M|0)<<13|i>>>19)+C|0)<<18|i>>>14,T^=(i=(x^=(i=(N^=(i=(L^=(i=T+x|0)<<7|i>>>25)+T|0)<<9|i>>>23)+L|0)<<13|i>>>19)+N|0)<<18|i>>>14,P^=(i=(A^=(i=(E^=(i=(k^=(i=P+A|0)<<7|i>>>25)+P|0)<<9|i>>>23)+k|0)<<13|i>>>19)+E|0)<<18|i>>>14,D^=(i=(I^=(i=(R^=(i=(S^=(i=D+I|0)<<7|i>>>25)+D|0)<<9|i>>>23)+S|0)<<13|i>>>19)+R|0)<<18|i>>>14,b^=(i=(S^=(i=(E^=(i=(x^=(i=b+S|0)<<7|i>>>25)+b|0)<<9|i>>>23)+x|0)<<13|i>>>19)+E|0)<<18|i>>>14,T^=(i=(M^=(i=(R^=(i=(A^=(i=T+M|0)<<7|i>>>25)+T|0)<<9|i>>>23)+A|0)<<13|i>>>19)+R|0)<<18|i>>>14,P^=(i=(L^=(i=(C^=(i=(I^=(i=P+L|0)<<7|i>>>25)+P|0)<<9|i>>>23)+I|0)<<13|i>>>19)+C|0)<<18|i>>>14,D^=(i=(k^=(i=(N^=(i=(O^=(i=D+k|0)<<7|i>>>25)+D|0)<<9|i>>>23)+O|0)<<13|i>>>19)+N|0)<<18|i>>>14;r.writeUint32LE(b+o|0,e,0),r.writeUint32LE(x+s|0,e,4),r.writeUint32LE(E+a|0,e,8),r.writeUint32LE(S+l|0,e,12),r.writeUint32LE(M+c|0,e,16),r.writeUint32LE(T+u|0,e,20),r.writeUint32LE(A+h|0,e,24),r.writeUint32LE(R+d|0,e,28),r.writeUint32LE(C+p|0,e,32),r.writeUint32LE(L+f|0,e,36),r.writeUint32LE(P+m|0,e,40),r.writeUint32LE(I+g|0,e,44),r.writeUint32LE(O+y|0,e,48),r.writeUint32LE(N+v|0,e,52),r.writeUint32LE(k+_|0,e,56),r.writeUint32LE(D+w|0,e,60)}function s(e,t,n,r,s){if(void 0===s&&(s=0),32!==e.length)throw new Error("Salsa20: key size must be 32 bytes");if(r.length<n.length)throw new Error("Salsa20: destination is shorter than source");var l,c;if(0===s){if(8!==t.length)throw new Error("Salsa20 nonce must be 8 bytes");(l=new Uint8Array(16)).set(t),c=t.length}else{if(16!==t.length)throw new Error("Salsa20 nonce with counter must be 16 bytes");l=t,c=16-s}for(var u=new Uint8Array(64),h=0;h<n.length;h+=64){o(u,l,e);for(var d=h;d<h+64&&d<n.length;d++)r[d]=n[d]^u[d-h];a(l,c,l.length-c)}return i.wipe(u),0===s&&i.wipe(l),r}function a(e,t,n){for(var r=1;n--;)r=r+(255&e[t])|0,e[t]=255&r,r>>>=8,t++;if(r>0)throw new Error("Salsa20: counter overflow")}t.streamXOR=s,t.stream=function(e,t,n,r){return void 0===r&&(r=0),i.wipe(n),s(e,t,n,n,r)}},3350:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8099),i=n(7309);t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var o=function(){function e(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},e.prototype.update=function(e,n){if(void 0===n&&(n=e.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var r=0;if(this._bytesHashed+=n,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&n>0;)this._buffer[this._bufferLength++]=e[r++],n--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(n>=this.blockSize&&(r=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,r,n),n%=this.blockSize);n>0;)this._buffer[this._bufferLength++]=e[r++],n--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,n=this._bufferLength,i=t/536870912|0,o=t<<3,s=t%128<112?128:256;this._buffer[n]=128;for(var l=n+1;l<s-8;l++)this._buffer[l]=0;r.writeUint32BE(i,this._buffer,s-8),r.writeUint32BE(o,this._buffer,s-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,s),this._finished=!0}for(l=0;l<this.digestLength/8;l++)r.writeUint32BE(this._stateHi[l],e,8*l),r.writeUint32BE(this._stateLo[l],e,8*l+4);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){i.wipe(e.stateHi),i.wipe(e.stateLo),e.buffer&&i.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.SHA512=o;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(e,t,n,i,o,a,l){for(var c,u,h,d,p,f,m,g,y=n[0],v=n[1],_=n[2],w=n[3],b=n[4],x=n[5],E=n[6],S=n[7],M=i[0],T=i[1],A=i[2],R=i[3],C=i[4],L=i[5],P=i[6],I=i[7];l>=128;){for(var O=0;O<16;O++){var N=8*O+a;e[O]=r.readUint32BE(o,N),t[O]=r.readUint32BE(o,N+4)}for(O=0;O<80;O++){var k,D,B=y,U=v,z=_,F=w,H=b,G=x,V=E,j=M,W=T,q=A,K=R,X=C,Y=L,J=P;if(p=65535&(u=I),f=u>>>16,m=65535&(c=S),g=c>>>16,p+=65535&(u=(C>>>14|b<<18)^(C>>>18|b<<14)^(b>>>9|C<<23)),f+=u>>>16,m+=65535&(c=(b>>>14|C<<18)^(b>>>18|C<<14)^(C>>>9|b<<23)),g+=c>>>16,p+=65535&(u=C&L^~C&P),f+=u>>>16,m+=65535&(c=b&x^~b&E),g+=c>>>16,c=s[2*O],p+=65535&(u=s[2*O+1]),f+=u>>>16,m+=65535&c,g+=c>>>16,c=e[O%16],f+=(u=t[O%16])>>>16,m+=65535&c,g+=c>>>16,m+=(f+=(p+=65535&u)>>>16)>>>16,p=65535&(u=d=65535&p|f<<16),f=u>>>16,m=65535&(c=h=65535&m|(g+=m>>>16)<<16),g=c>>>16,p+=65535&(u=(M>>>28|y<<4)^(y>>>2|M<<30)^(y>>>7|M<<25)),f+=u>>>16,m+=65535&(c=(y>>>28|M<<4)^(M>>>2|y<<30)^(M>>>7|y<<25)),g+=c>>>16,f+=(u=M&T^M&A^T&A)>>>16,m+=65535&(c=y&v^y&_^v&_),g+=c>>>16,k=65535&(m+=(f+=(p+=65535&u)>>>16)>>>16)|(g+=m>>>16)<<16,D=65535&p|f<<16,p=65535&(u=K),f=u>>>16,m=65535&(c=F),g=c>>>16,f+=(u=d)>>>16,m+=65535&(c=h),g+=c>>>16,v=B,_=U,w=z,b=F=65535&(m+=(f+=(p+=65535&u)>>>16)>>>16)|(g+=m>>>16)<<16,x=H,E=G,S=V,y=k,T=j,A=W,R=q,C=K=65535&p|f<<16,L=X,P=Y,I=J,M=D,O%16==15)for(N=0;N<16;N++)c=e[N],p=65535&(u=t[N]),f=u>>>16,m=65535&c,g=c>>>16,c=e[(N+9)%16],p+=65535&(u=t[(N+9)%16]),f+=u>>>16,m+=65535&c,g+=c>>>16,h=e[(N+1)%16],p+=65535&(u=((d=t[(N+1)%16])>>>1|h<<31)^(d>>>8|h<<24)^(d>>>7|h<<25)),f+=u>>>16,m+=65535&(c=(h>>>1|d<<31)^(h>>>8|d<<24)^h>>>7),g+=c>>>16,h=e[(N+14)%16],f+=(u=((d=t[(N+14)%16])>>>19|h<<13)^(h>>>29|d<<3)^(d>>>6|h<<26))>>>16,m+=65535&(c=(h>>>19|d<<13)^(d>>>29|h<<3)^h>>>6),g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,e[N]=65535&m|g<<16,t[N]=65535&p|f<<16}p=65535&(u=M),f=u>>>16,m=65535&(c=y),g=c>>>16,c=n[0],f+=(u=i[0])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[0]=y=65535&m|g<<16,i[0]=M=65535&p|f<<16,p=65535&(u=T),f=u>>>16,m=65535&(c=v),g=c>>>16,c=n[1],f+=(u=i[1])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[1]=v=65535&m|g<<16,i[1]=T=65535&p|f<<16,p=65535&(u=A),f=u>>>16,m=65535&(c=_),g=c>>>16,c=n[2],f+=(u=i[2])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[2]=_=65535&m|g<<16,i[2]=A=65535&p|f<<16,p=65535&(u=R),f=u>>>16,m=65535&(c=w),g=c>>>16,c=n[3],f+=(u=i[3])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[3]=w=65535&m|g<<16,i[3]=R=65535&p|f<<16,p=65535&(u=C),f=u>>>16,m=65535&(c=b),g=c>>>16,c=n[4],f+=(u=i[4])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[4]=b=65535&m|g<<16,i[4]=C=65535&p|f<<16,p=65535&(u=L),f=u>>>16,m=65535&(c=x),g=c>>>16,c=n[5],f+=(u=i[5])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[5]=x=65535&m|g<<16,i[5]=L=65535&p|f<<16,p=65535&(u=P),f=u>>>16,m=65535&(c=E),g=c>>>16,c=n[6],f+=(u=i[6])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[6]=E=65535&m|g<<16,i[6]=P=65535&p|f<<16,p=65535&(u=I),f=u>>>16,m=65535&(c=S),g=c>>>16,c=n[7],f+=(u=i[7])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[7]=S=65535&m|g<<16,i[7]=I=65535&p|f<<16,a+=128,l-=128}return a}t.hash=function(e){var t=new o;t.update(e);var n=t.digest();return t.clean(),n}},6249:(e,t)=>{"use strict";var n="utf8: invalid string";t.cv=function(e){for(var t=new Uint8Array(function(e){for(var t=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i<128)t+=1;else if(i<2048)t+=2;else if(i<55296)t+=3;else{if(!(i<=57343))throw new Error(n);if(r>=e.length-1)throw new Error(n);r++,t+=4}}return t}(e)),r=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);o<128?t[r++]=o:o<2048?(t[r++]=192|o>>6,t[r++]=128|63&o):o<55296?(t[r++]=224|o>>12,t[r++]=128|o>>6&63,t[r++]=128|63&o):(i++,o=(1023&o)<<10,o|=1023&e.charCodeAt(i),o+=65536,t[r++]=240|o>>18,t[r++]=128|o>>12&63,t[r++]=128|o>>6&63,t[r++]=128|63&o)}return t}},7309:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},6273:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X25519Session=t.SECRET_SEED_LENGTH=t.SAVED_STATE_LENGTH=t.ACCEPT_MESSAGE_LENGTH=t.OFFER_MESSAGE_LENGTH=void 0;const r=n(1416),i=n(7309),o=n(7664),s=n(4826);t.OFFER_MESSAGE_LENGTH=o.PUBLIC_KEY_LENGTH,t.ACCEPT_MESSAGE_LENGTH=o.PUBLIC_KEY_LENGTH,t.SAVED_STATE_LENGTH=o.SECRET_KEY_LENGTH,t.SECRET_SEED_LENGTH=o.SECRET_KEY_LENGTH,t.X25519Session=class{constructor(e,n){this.offerMessageLength=t.OFFER_MESSAGE_LENGTH,this.acceptMessageLength=t.ACCEPT_MESSAGE_LENGTH,this.sharedKeyLength=o.SHARED_KEY_LENGTH,this.savedStateLength=t.SAVED_STATE_LENGTH,this._seed=e||(0,r.randomBytes)(o.SECRET_KEY_LENGTH,n)}saveState(){return new Uint8Array(this._seed)}restoreState(e){return this._seed=new Uint8Array(e),this}clean(){this._seed&&(0,i.wipe)(this._seed),this._keyPair&&((0,i.wipe)(this._keyPair.secretKey),(0,i.wipe)(this._keyPair.publicKey)),this._sharedKey&&(0,i.wipe)(this._sharedKey),this._sessionKeys&&((0,i.wipe)(this._sessionKeys.receive),(0,i.wipe)(this._sessionKeys.send))}offer(){return this._keyPair=(0,o.generateKeyPairFromSeed)(this._seed),new Uint8Array(this._keyPair.publicKey)}accept(e){if(this._keyPair)throw new Error("X25519Session: accept shouldn't be called by offering party");if(e.length!==this.offerMessageLength)throw new Error("X25519Session: incorrect offer message length");if(this._sharedKey)throw new Error("X25519Session: accept was already called");const t=(0,o.generateKeyPairFromSeed)(this._seed);return this._sharedKey=(0,o.sharedKey)(t.secretKey,e),this._sessionKeys=(0,s.clientSessionKeysFromSharedKey)(this._sharedKey,t.publicKey,e),(0,i.wipe)(t.secretKey),t.publicKey}finish(e){if(e.length!==this.acceptMessageLength)throw new Error("X25519Session: incorrect accept message length");if(!this._keyPair)throw new Error("X25519Session: no offer state");if(this._sharedKey)throw new Error("X25519Session: finish was already called");return this._sharedKey=(0,o.sharedKey)(this._keyPair.secretKey,e),this._sessionKeys=(0,s.serverSessionKeysFromSharedKey)(this._sharedKey,this._keyPair.publicKey,e),this}getSharedKey(){if(!this._sharedKey)throw new Error("X25519Session: no shared key established");return new Uint8Array(this._sharedKey)}getSessionKeys(){if(!this._sessionKeys)throw new Error("X25519Session: no shared key established");return{receive:new Uint8Array(this._sessionKeys.receive),send:new Uint8Array(this._sessionKeys.send)}}}},4826:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clientSessionKeys=t.serverSessionKeys=t.clientSessionKeysFromSharedKey=t.serverSessionKeysFromSharedKey=t.X25519Session=void 0;const r=n(1322),i=n(7664);var o=n(6273);Object.defineProperty(t,"X25519Session",{enumerable:!0,get:function(){return o.X25519Session}});function s(e,t,n,i=r.BLAKE2b){const o=new i;if(64!==o.digestLength)throw new Error("X25519: incorrect digest length");const s=o.update(e).update(n).update(t).digest();return{send:s.subarray(0,32),receive:s.subarray(32)}}function a(e,t,n,i=r.BLAKE2b){const o=new i;if(64!==o.digestLength)throw new Error("X25519: incorrect digest length");const s=o.update(e).update(t).update(n).digest();return{receive:s.subarray(0,32),send:s.subarray(32)}}t.serverSessionKeysFromSharedKey=s,t.clientSessionKeysFromSharedKey=a,t.serverSessionKeys=function(e,t,n=r.BLAKE2b){return s((0,i.sharedKey)(e.secretKey,t),e.publicKey,t,n)},t.clientSessionKeys=function(e,t,n=r.BLAKE2b){return a((0,i.sharedKey)(e.secretKey,t),e.publicKey,t,n)}},7664:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const r=n(1416),i=n(7309);function o(e){const t=new Float64Array(16);if(e)for(let n=0;n<e.length;n++)t[n]=e[n];return t}t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;const s=new Uint8Array(32);s[0]=9;const a=o([56129,1]);function l(e){let t=1;for(let n=0;n<16;n++){let r=e[n]+t+65535;t=Math.floor(r/65536),e[n]=r-65536*t}e[0]+=t-1+37*(t-1)}function c(e,t,n){const r=~(n-1);for(let n=0;n<16;n++){const i=r&(e[n]^t[n]);e[n]^=i,t[n]^=i}}function u(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]+n[r]}function h(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]-n[r]}function d(e,t,n){let r,i,o=0,s=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=0,w=0,b=0,x=0,E=0,S=0,M=0,T=0,A=0,R=0,C=0,L=0,P=0,I=0,O=0,N=0,k=0,D=n[0],B=n[1],U=n[2],z=n[3],F=n[4],H=n[5],G=n[6],V=n[7],j=n[8],W=n[9],q=n[10],K=n[11],X=n[12],Y=n[13],J=n[14],Z=n[15];r=t[0],o+=r*D,s+=r*B,a+=r*U,l+=r*z,c+=r*F,u+=r*H,h+=r*G,d+=r*V,p+=r*j,f+=r*W,m+=r*q,g+=r*K,y+=r*X,v+=r*Y,_+=r*J,w+=r*Z,r=t[1],s+=r*D,a+=r*B,l+=r*U,c+=r*z,u+=r*F,h+=r*H,d+=r*G,p+=r*V,f+=r*j,m+=r*W,g+=r*q,y+=r*K,v+=r*X,_+=r*Y,w+=r*J,b+=r*Z,r=t[2],a+=r*D,l+=r*B,c+=r*U,u+=r*z,h+=r*F,d+=r*H,p+=r*G,f+=r*V,m+=r*j,g+=r*W,y+=r*q,v+=r*K,_+=r*X,w+=r*Y,b+=r*J,x+=r*Z,r=t[3],l+=r*D,c+=r*B,u+=r*U,h+=r*z,d+=r*F,p+=r*H,f+=r*G,m+=r*V,g+=r*j,y+=r*W,v+=r*q,_+=r*K,w+=r*X,b+=r*Y,x+=r*J,E+=r*Z,r=t[4],c+=r*D,u+=r*B,h+=r*U,d+=r*z,p+=r*F,f+=r*H,m+=r*G,g+=r*V,y+=r*j,v+=r*W,_+=r*q,w+=r*K,b+=r*X,x+=r*Y,E+=r*J,S+=r*Z,r=t[5],u+=r*D,h+=r*B,d+=r*U,p+=r*z,f+=r*F,m+=r*H,g+=r*G,y+=r*V,v+=r*j,_+=r*W,w+=r*q,b+=r*K,x+=r*X,E+=r*Y,S+=r*J,M+=r*Z,r=t[6],h+=r*D,d+=r*B,p+=r*U,f+=r*z,m+=r*F,g+=r*H,y+=r*G,v+=r*V,_+=r*j,w+=r*W,b+=r*q,x+=r*K,E+=r*X,S+=r*Y,M+=r*J,T+=r*Z,r=t[7],d+=r*D,p+=r*B,f+=r*U,m+=r*z,g+=r*F,y+=r*H,v+=r*G,_+=r*V,w+=r*j,b+=r*W,x+=r*q,E+=r*K,S+=r*X,M+=r*Y,T+=r*J,A+=r*Z,r=t[8],p+=r*D,f+=r*B,m+=r*U,g+=r*z,y+=r*F,v+=r*H,_+=r*G,w+=r*V,b+=r*j,x+=r*W,E+=r*q,S+=r*K,M+=r*X,T+=r*Y,A+=r*J,R+=r*Z,r=t[9],f+=r*D,m+=r*B,g+=r*U,y+=r*z,v+=r*F,_+=r*H,w+=r*G,b+=r*V,x+=r*j,E+=r*W,S+=r*q,M+=r*K,T+=r*X,A+=r*Y,R+=r*J,C+=r*Z,r=t[10],m+=r*D,g+=r*B,y+=r*U,v+=r*z,_+=r*F,w+=r*H,b+=r*G,x+=r*V,E+=r*j,S+=r*W,M+=r*q,T+=r*K,A+=r*X,R+=r*Y,C+=r*J,L+=r*Z,r=t[11],g+=r*D,y+=r*B,v+=r*U,_+=r*z,w+=r*F,b+=r*H,x+=r*G,E+=r*V,S+=r*j,M+=r*W,T+=r*q,A+=r*K,R+=r*X,C+=r*Y,L+=r*J,P+=r*Z,r=t[12],y+=r*D,v+=r*B,_+=r*U,w+=r*z,b+=r*F,x+=r*H,E+=r*G,S+=r*V,M+=r*j,T+=r*W,A+=r*q,R+=r*K,C+=r*X,L+=r*Y,P+=r*J,I+=r*Z,r=t[13],v+=r*D,_+=r*B,w+=r*U,b+=r*z,x+=r*F,E+=r*H,S+=r*G,M+=r*V,T+=r*j,A+=r*W,R+=r*q,C+=r*K,L+=r*X,P+=r*Y,I+=r*J,O+=r*Z,r=t[14],_+=r*D,w+=r*B,b+=r*U,x+=r*z,E+=r*F,S+=r*H,M+=r*G,T+=r*V,A+=r*j,R+=r*W,C+=r*q,L+=r*K,P+=r*X,I+=r*Y,O+=r*J,N+=r*Z,r=t[15],w+=r*D,b+=r*B,x+=r*U,E+=r*z,S+=r*F,M+=r*H,T+=r*G,A+=r*V,R+=r*j,C+=r*W,L+=r*q,P+=r*K,I+=r*X,O+=r*Y,N+=r*J,k+=r*Z,o+=38*b,s+=38*x,a+=38*E,l+=38*S,c+=38*M,u+=38*T,h+=38*A,d+=38*R,p+=38*C,f+=38*L,m+=38*P,g+=38*I,y+=38*O,v+=38*N,_+=38*k,i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),e[0]=o,e[1]=s,e[2]=a,e[3]=l,e[4]=c,e[5]=u,e[6]=h,e[7]=d,e[8]=p,e[9]=f,e[10]=m,e[11]=g,e[12]=y,e[13]=v,e[14]=_,e[15]=w}function p(e,t){d(e,t,t)}function f(e,t){const n=new Uint8Array(32),r=new Float64Array(80),i=o(),s=o(),f=o(),m=o(),g=o(),y=o();for(let t=0;t<31;t++)n[t]=e[t];n[31]=127&e[31]|64,n[0]&=248,function(e,t){for(let n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}(r,t);for(let e=0;e<16;e++)s[e]=r[e];i[0]=m[0]=1;for(let e=254;e>=0;--e){const t=n[e>>>3]>>>(7&e)&1;c(i,s,t),c(f,m,t),u(g,i,f),h(i,i,f),u(f,s,m),h(s,s,m),p(m,g),p(y,i),d(i,f,i),d(f,s,g),u(g,i,f),h(i,i,f),p(s,i),h(f,m,y),d(i,f,a),u(i,i,m),d(f,f,i),d(i,m,y),d(m,s,r),p(s,g),c(i,s,t),c(f,m,t)}for(let e=0;e<16;e++)r[e+16]=i[e],r[e+32]=f[e],r[e+48]=s[e],r[e+64]=m[e];const v=r.subarray(32),_=r.subarray(16);!function(e,t){const n=o();for(let e=0;e<16;e++)n[e]=t[e];for(let e=253;e>=0;e--)p(n,n),2!==e&&4!==e&&d(n,n,t);for(let t=0;t<16;t++)e[t]=n[t]}(v,v),d(_,_,v);const w=new Uint8Array(32);return function(e,t){const n=o(),r=o();for(let e=0;e<16;e++)r[e]=t[e];l(r),l(r),l(r);for(let e=0;e<2;e++){n[0]=r[0]-65517;for(let e=1;e<15;e++)n[e]=r[e]-65535-(n[e-1]>>16&1),n[e-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const e=n[15]>>16&1;n[14]&=65535,c(r,n,1-e)}for(let t=0;t<16;t++)e[2*t]=255&r[t],e[2*t+1]=r[t]>>8}(w,_),w}function m(e){return f(e,s)}function g(e){if(e.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const n=new Uint8Array(e);return{publicKey:m(n),secretKey:n}}t.scalarMult=f,t.scalarMultBase=m,t.generateKeyPairFromSeed=g,t.generateKeyPair=function(e){const t=(0,r.randomBytes)(32,e),n=g(t);return(0,i.wipe)(t),n},t.sharedKey=function(e,n,r=!1){if(e.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(n.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const i=f(e,n);if(r){let e=0;for(let t=0;t<i.length;t++)e|=i[t];if(0===e)throw new Error("X25519: invalid shared key")}return i}},7025:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8099),i=n(7318),o=n(7309);function s(e,t,n,r,s){if(void 0===s&&(s=0),0===s){if(24!==t.length)throw new Error("XSalsa20 nonce must be 24 bytes")}else if(32!==t.length)throw new Error("XSalsa20 nonce with counter must be 32 bytes");var l=a(e,t.subarray(0,16),new Uint8Array(32)),c=i.streamXOR(l,t.subarray(16),n,r,s);return o.wipe(l),c}function a(e,t,n){for(var i,o=1634760805,s=e[3]<<24|e[2]<<16|e[1]<<8|e[0],a=e[7]<<24|e[6]<<16|e[5]<<8|e[4],l=e[11]<<24|e[10]<<16|e[9]<<8|e[8],c=e[15]<<24|e[14]<<16|e[13]<<8|e[12],u=857760878,h=t[3]<<24|t[2]<<16|t[1]<<8|t[0],d=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],f=t[15]<<24|t[14]<<16|t[13]<<8|t[12],m=2036477234,g=e[19]<<24|e[18]<<16|e[17]<<8|e[16],y=e[23]<<24|e[22]<<16|e[21]<<8|e[20],v=e[27]<<24|e[26]<<16|e[25]<<8|e[24],_=e[31]<<24|e[30]<<16|e[29]<<8|e[28],w=1797285236,b=0;b<20;b+=2)o^=(i=(y^=(i=(p^=(i=(c^=(i=o+y|0)<<7|i>>>25)+o|0)<<9|i>>>23)+c|0)<<13|i>>>19)+p|0)<<18|i>>>14,u^=(i=(s^=(i=(v^=(i=(f^=(i=u+s|0)<<7|i>>>25)+u|0)<<9|i>>>23)+f|0)<<13|i>>>19)+v|0)<<18|i>>>14,m^=(i=(h^=(i=(a^=(i=(_^=(i=m+h|0)<<7|i>>>25)+m|0)<<9|i>>>23)+_|0)<<13|i>>>19)+a|0)<<18|i>>>14,w^=(i=(g^=(i=(d^=(i=(l^=(i=w+g|0)<<7|i>>>25)+w|0)<<9|i>>>23)+l|0)<<13|i>>>19)+d|0)<<18|i>>>14,o^=(i=(l^=(i=(a^=(i=(s^=(i=o+l|0)<<7|i>>>25)+o|0)<<9|i>>>23)+s|0)<<13|i>>>19)+a|0)<<18|i>>>14,u^=(i=(c^=(i=(d^=(i=(h^=(i=u+c|0)<<7|i>>>25)+u|0)<<9|i>>>23)+h|0)<<13|i>>>19)+d|0)<<18|i>>>14,m^=(i=(f^=(i=(p^=(i=(g^=(i=m+f|0)<<7|i>>>25)+m|0)<<9|i>>>23)+g|0)<<13|i>>>19)+p|0)<<18|i>>>14,w^=(i=(_^=(i=(v^=(i=(y^=(i=w+_|0)<<7|i>>>25)+w|0)<<9|i>>>23)+y|0)<<13|i>>>19)+v|0)<<18|i>>>14;return r.writeUint32LE(o,n,0),r.writeUint32LE(u,n,4),r.writeUint32LE(m,n,8),r.writeUint32LE(w,n,12),r.writeUint32LE(h,n,16),r.writeUint32LE(d,n,20),r.writeUint32LE(p,n,24),r.writeUint32LE(f,n,28),n}t.streamXOR=s,t.stream=function(e,t,n,r){return void 0===r&&(r=0),o.wipe(n),s(e,t,n,n,r)},t.hsalsa=a},9669:(e,t,n)=>{e.exports=n(1609)},5448:(e,t,n)=>{"use strict";var r=n(4867),i=n(6026),o=n(4372),s=n(5327),a=n(4097),l=n(4109),c=n(7985),u=n(5061),h=n(5655),d=n(5263);e.exports=function(e){return new Promise((function(t,n){var p,f=e.data,m=e.headers,g=e.responseType;function y(){e.cancelToken&&e.cancelToken.unsubscribe(p),e.signal&&e.signal.removeEventListener("abort",p)}r.isFormData(f)&&delete m["Content-Type"];var v=new XMLHttpRequest;if(e.auth){var _=e.auth.username||"",w=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(_+":"+w)}var b=a(e.baseURL,e.url);function x(){if(v){var r="getAllResponseHeaders"in v?l(v.getAllResponseHeaders()):null,o={data:g&&"text"!==g&&"json"!==g?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:r,config:e,request:v};i((function(e){t(e),y()}),(function(e){n(e),y()}),o),v=null}}if(v.open(e.method.toUpperCase(),s(b,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,"onloadend"in v?v.onloadend=x:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(x)},v.onabort=function(){v&&(n(u("Request aborted",e,"ECONNABORTED",v)),v=null)},v.onerror=function(){n(u("Network Error",e,null,v)),v=null},v.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||h.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(u(t,e,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",v)),v=null},r.isStandardBrowserEnv()){var E=(e.withCredentials||c(b))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;E&&(m[e.xsrfHeaderName]=E)}"setRequestHeader"in v&&r.forEach(m,(function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete m[t]:v.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),g&&"json"!==g&&(v.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&v.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(p=function(e){v&&(n(!e||e&&e.type?new d("canceled"):e),v.abort(),v=null)},e.cancelToken&&e.cancelToken.subscribe(p),e.signal&&(e.signal.aborted?p():e.signal.addEventListener("abort",p))),f||(f=null),v.send(f)}))}},1609:(e,t,n)=>{"use strict";var r=n(4867),i=n(1849),o=n(321),s=n(7185),a=function e(t){var n=new o(t),a=i(o.prototype.request,n);return r.extend(a,o.prototype,n),r.extend(a,n),a.create=function(n){return e(s(t,n))},a}(n(5655));a.Axios=o,a.Cancel=n(5263),a.CancelToken=n(4972),a.isCancel=n(6502),a.VERSION=n(7288).version,a.all=function(e){return Promise.all(e)},a.spread=n(8713),a.isAxiosError=n(6268),e.exports=a,e.exports.default=a},5263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:(e,t,n)=>{"use strict";var r=n(5263);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},6502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,n)=>{"use strict";var r=n(4867),i=n(5327),o=n(782),s=n(3572),a=n(7185),l=n(4875),c=l.validators;function u(e){this.defaults=e,this.interceptors={request:new o,response:new o}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var i,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!r){var u=[s,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(o),i=Promise.resolve(e);u.length;)i=i.then(u.shift(),u.shift());return i}for(var h=e;n.length;){var d=n.shift(),p=n.shift();try{h=d(h)}catch(e){p(e);break}}try{i=s(h)}catch(e){return Promise.reject(e)}for(;o.length;)i=i.then(o.shift(),o.shift());return i},u.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,r){return this.request(a(r||{},{method:e,url:t,data:n}))}})),e.exports=u},782:(e,t,n)=>{"use strict";var r=n(4867);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},4097:(e,t,n)=>{"use strict";var r=n(1793),i=n(7303);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},5061:(e,t,n)=>{"use strict";var r=n(481);e.exports=function(e,t,n,i,o){var s=new Error(e);return r(s,t,n,i,o)}},3572:(e,t,n)=>{"use strict";var r=n(4867),i=n(8527),o=n(6502),s=n(5655),a=n(5263);function l(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new a("canceled")}e.exports=function(e){return l(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return l(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(l(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},7185:(e,t,n)=>{"use strict";var r=n(4867);e.exports=function(e,t){t=t||{};var n={};function i(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function o(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(e[n],t[n])}function s(e){if(!r.isUndefined(t[e]))return i(void 0,t[e])}function a(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(void 0,t[n])}function l(n){return n in t?i(e[n],t[n]):n in e?i(void 0,e[n]):void 0}var c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l};return r.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||o,i=t(e);r.isUndefined(i)&&t!==l||(n[e]=i)})),n}},6026:(e,t,n)=>{"use strict";var r=n(5061);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},8527:(e,t,n)=>{"use strict";var r=n(4867),i=n(5655);e.exports=function(e,t,n){var o=this||i;return r.forEach(n,(function(n){e=n.call(o,e,t)})),e}},5655:(e,t,n)=>{"use strict";var r=n(4867),i=n(6016),o=n(481),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(l=n(5448)),l),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(0,JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||c.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(s)})),e.exports=c},7288:e=>{e.exports={version:"0.24.0"}},1849:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},5327:(e,t,n)=>{"use strict";var r=n(4867);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))})))})),o=s.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,n)=>{"use strict";var r=n(4867);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},6268:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},7985:(e,t,n)=>{"use strict";var r=n(4867);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},6016:(e,t,n)=>{"use strict";var r=n(4867);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},4109:(e,t,n)=>{"use strict";var r=n(4867),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,s={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4875:(e,t,n)=>{"use strict";var r=n(7288).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var o={};i.transitional=function(e,t,n){function i(e,t){return"[Axios v"+r+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,s){if(!1===e)throw new Error(i(r," has been removed"+(t?" in "+t:"")));return t&&!o[r]&&(o[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},e.exports={assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var o=r[i],s=t[o];if(s){var a=e[o],l=void 0===a||s(a,o,e);if(!0!==l)throw new TypeError("option "+o+" must be "+l)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:i}},4867:(e,t,n)=>{"use strict";var r=n(1849),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:l,isUndefined:s,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,r){l(t[r])&&l(n)?t[r]=e(t[r],n):l(n)?t[r]=e({},n):o(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},8162:(e,t,n)=>{"use strict";var r=n(9509).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==t[s])throw new TypeError(o+" is ambiguous");t[s]=i}var a=e.length,l=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return r.alloc(0);for(var n=0,i=0,o=0;e[n]===l;)i++,n++;for(var s=(e.length-n)*c+1>>>0,u=new Uint8Array(s);e[n];){var h=t[e.charCodeAt(n)];if(255===h)return;for(var d=0,p=s-1;(0!==h||d<o)&&-1!==p;p--,d++)h+=a*u[p]>>>0,u[p]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");o=d,n++}for(var f=s-o;f!==s&&0===u[f];)f++;var m=r.allocUnsafe(i+(s-f));m.fill(0,0,i);for(var g=i;f!==s;)m[g++]=u[f++];return m}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=r.from(t)),!r.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var n=0,i=0,o=0,s=t.length;o!==s&&0===t[o];)o++,n++;for(var c=(s-o)*u+1>>>0,h=new Uint8Array(c);o!==s;){for(var d=t[o],p=0,f=c-1;(0!==d||p<i)&&-1!==f;f--,p++)d+=256*h[f]>>>0,h[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");i=p,o++}for(var m=c-i;m!==c&&0===h[m];)m++;for(var g=l.repeat(n);m<c;++m)g+=e.charAt(h[m]);return g},decodeUnsafe:h,decode:function(e){var t=h(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}},9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=l(e),s=o[0],a=o[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),u=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,l=r-i;a<l;a+=s)o.push(c(e,a,a+s>l?l:a+s));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},7191:(e,t,n)=>{var r=n(8162);e.exports=r("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},3310:(e,t,n)=>{"use strict";var r=n(7191),i=n(9509).Buffer;e.exports=function(e){function t(t){var n=t.slice(0,-4),r=t.slice(-4),i=e(n);if(!(r[0]^i[0]|r[1]^i[1]|r[2]^i[2]|r[3]^i[3]))return n}return{encode:function(t){var n=e(t);return r.encode(i.concat([t,n],t.length+4))},decode:function(e){var n=t(r.decode(e));if(!n)throw new Error("Invalid checksum");return n},decodeUnsafe:function(e){var n=r.decodeUnsafe(e);if(n)return t(n)}}}},8334:(e,t,n)=>{"use strict";var r=n(3482),i=n(3310);e.exports=i((function(e){var t=r("sha256").update(e).digest();return r("sha256").update(t).digest()}))},8764:(e,t,n)=>{"use strict";const r=n(9742),i=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=a(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);const i=function(e){if(l.isBuffer(e)){const t=0|f(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||J(e.length)?a(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),a(e<0?0:0|f(e))}function d(e){const t=e.length<0?0:0|f(e.length),n=a(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function f(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return K(e).length;default:if(i)return r?-1:q(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return M(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),J(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:_(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,r,i){let o,s=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===l)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){let n=!0;for(let r=0;r<l;r++)if(c(e,o+r)!==c(t,r)){n=!1;break}if(n)return o}return-1}function w(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(J(r))return s;e[n+s]=r}return s}function b(e,t,n,r){return X(q(t,e.length-n),e,n,r)}function x(e,t,n,r){return X(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return X(K(t),e,n,r)}function S(e,t,n,r){return X(function(e,t){let n,r,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function M(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,l;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(o=l));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(l=(15&t)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){const t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=A));return n}(r)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},l.allocUnsafe=function(e){return h(e)},l.allocUnsafeSlow=function(e){return h(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=l.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(Y(t,Uint8Array))i+t.length>r.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,i){if(Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),c=this.slice(r,i),u=e.slice(t,n);for(let e=0;e<a;++e)if(c[e]!==u[e]){o=c[e],s=u[e];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":case"latin1":case"binary":return x(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function R(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function C(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function L(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=Z[e[r]];return i}function P(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function I(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r,i){G(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function k(e,t,n,r,i){G(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function D(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,o){return t=+t,n>>>=0,o||D(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,o){return t=+t,n>>>=0,o||D(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Q((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=Q((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||I(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||I(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Q((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=Q((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||j(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||I(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||I(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||I(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||I(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||O(this,e,t,n,Math.pow(2,8*n)-1,0);let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||O(this,e,t,n,Math.pow(2,8*n)-1,0);let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=Q((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Q((function(e,t=0){return k(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=Q((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Q((function(e,t=0){return k(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=l.isBuffer(e)?e:l.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};const z={};function F(e,t,n){z[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function H(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function G(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new z.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){V(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||j(t,e.length-(n+1))}(r,i,o)}function V(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function j(e,t,n){if(Math.floor(e)!==e)throw V(e,n),new z.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}F("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),F("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),F("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=H(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=H(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function q(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function K(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function X(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const Z=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Q(e){return"undefined"==typeof BigInt?$:e}function $(){throw new Error("BigInt not supported")}},1027:(e,t,n)=>{var r=n(9509).Buffer,i=n(2830).Transform,o=n(2553).s;function s(e){i.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}n(5717)(s,i),s.prototype.update=function(e,t,n){"string"==typeof e&&(e=r.from(e,t));var i=this._update(e);return this.hashMode?this:(n&&(i=this._toString(i,n)),i)},s.prototype.setAutoPadding=function(){},s.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},s.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},s.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},s.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){r=e}finally{n(r)}},s.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},s.prototype._finalOrDigest=function(e){var t=this.__final()||r.alloc(0);return e&&(t=this._toString(t,e,!0)),t},s.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new o(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r},e.exports=s},3482:(e,t,n)=>{"use strict";var r=n(5717),i=n(2318),o=n(9785),s=n(9072),a=n(1027);function l(e){a.call(this,"digest"),this._hash=e}r(l,a),l.prototype._update=function(e){this._hash.update(e)},l.prototype._final=function(){return this._hash.digest()},e.exports=function(e){return"md5"===(e=e.toLowerCase())?new i:"rmd160"===e||"ripemd160"===e?new o:new l(s(e))}},4098:function(e,t){var n="undefined"!=typeof self?self:this,r=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=f(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,n,r=p(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=f(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=c(e),t=u(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d.prototype.delete=function(e){delete this.map[c(e)]},d.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},d.prototype.set=function(e,t){this.map[c(e)]=u(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},r&&(d.prototype[Symbol.iterator]=d.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function _(e,t){var n,r,i=(t=t||{}).body;if(e instanceof _){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),v.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function b(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},y.call(_.prototype),y.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},b.error=function(){var e=new b(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];b.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function E(e,n){return new Promise((function(r,o){var s=new _(e,n);if(s.signal&&s.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function l(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new b(i,n))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",l),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",l)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}E.polyfill=!0,e.fetch||(e.fetch=E,e.Headers=d,e.Request=_,e.Response=b),t.Headers=d,t.Request=_,t.Response=b,t.fetch=E,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},7187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var i,o,s,c;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=u.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)r(u[n],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},2445:e=>{"use strict";e.exports=function(e){var t=e.uri,n=e.name,r=e.type;this.uri=t,this.name=n,this.type=r}},804:(e,t,n)=>{"use strict";var r=n(1268);e.exports=function e(t,n,i){var o;void 0===n&&(n=""),void 0===i&&(i=r);var s=new Map;function a(e,t){var n=s.get(t);n?n.push.apply(n,e):s.set(t,e)}if(i(t))o=null,a([n],t);else{var l=n?n+".":"";if("undefined"!=typeof FileList&&t instanceof FileList)o=Array.prototype.map.call(t,(function(e,t){return a([""+l+t],e),null}));else if(Array.isArray(t))o=t.map((function(t,n){var r=e(t,""+l+n,i);return r.files.forEach(a),r.clone}));else if(t&&t.constructor===Object)for(var c in o={},t){var u=e(t[c],""+l+c,i);u.files.forEach(a),o[c]=u.clone}else o=t}return{clone:o,files:s}}},4823:(e,t,n)=>{"use strict";t.ReactNativeFile=n(2445),t.extractFiles=n(804),t.isExtractableFile=n(1268)},1268:(e,t,n)=>{"use strict";var r=n(2445);e.exports=function(e){return"undefined"!=typeof File&&e instanceof File||"undefined"!=typeof Blob&&e instanceof Blob||e instanceof r}},6230:e=>{e.exports="object"==typeof self?self.FormData:window.FormData},8458:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4823),o=r(n(6230)),s=function(e){return i.isExtractableFile(e)||null!==e&&"object"==typeof e&&"function"==typeof e.pipe};t.default=function(e,t,n){var r=i.extractFiles({query:e,variables:t,operationName:n},"",s),a=r.clone,l=r.files;if(0===l.size){if(!Array.isArray(e))return JSON.stringify(a);if(void 0!==t&&!Array.isArray(t))throw new Error("Cannot create request body with given variable type, array expected");var c=e.reduce((function(e,n,r){return e.push({query:n,variables:t?t[r]:void 0}),e}),[]);return JSON.stringify(c)}var u=new("undefined"==typeof FormData?o.default:FormData);u.append("operations",JSON.stringify(a));var h={},d=0;return l.forEach((function(e){h[++d]=e})),u.append("map",JSON.stringify(h)),d=0,l.forEach((function(e,t){u.append(""+ ++d,t)})),u}},8687:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.gql=t.batchRequests=t.request=t.rawRequest=t.GraphQLClient=t.ClientError=void 0;var h=s(n(4098)),d=h,p=n(3033),f=u(n(8458)),m=n(8308);Object.defineProperty(t,"ClientError",{enumerable:!0,get:function(){return m.ClientError}});var g=function(e){var t={};return e&&("undefined"!=typeof Headers&&e instanceof Headers||e instanceof d.Headers?t=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}(e):Array.isArray(e)?e.forEach((function(e){var n=e[0],r=e[1];t[n]=r})):t=e),t},y=function(e){return e.replace(/([\s,]|#[^\n\r]+)+/g," ").trim()},v=function(e){var t=e.url,n=e.query,i=e.variables,o=e.operationName,s=e.headers,c=e.fetch,u=e.fetchOptions;return a(void 0,void 0,void 0,(function(){var e;return l(this,(function(a){switch(a.label){case 0:return e=f.default(n,i,o),[4,c(t,r({method:"POST",headers:r(r({},"string"==typeof e?{"Content-Type":"application/json"}:{}),s),body:e},u))];case 1:return[2,a.sent()]}}))}))},_=function(e){var t=e.url,n=e.query,i=e.variables,o=e.operationName,s=e.headers,c=e.fetch,u=e.fetchOptions;return a(void 0,void 0,void 0,(function(){var e;return l(this,(function(a){switch(a.label){case 0:return e=function(e){var t=e.query,n=e.variables,r=e.operationName;if(!Array.isArray(t)){var i=["query="+encodeURIComponent(y(t))];return n&&i.push("variables="+encodeURIComponent(JSON.stringify(n))),r&&i.push("operationName="+encodeURIComponent(r)),i.join("&")}if(void 0!==n&&!Array.isArray(n))throw new Error("Cannot create query with given variable type, array expected");var o=t.reduce((function(e,t,r){return e.push({query:y(t),variables:n?JSON.stringify(n[r]):void 0}),e}),[]);return"query="+encodeURIComponent(JSON.stringify(o))}({query:n,variables:i,operationName:o}),[4,c(t+"?"+e,r({method:"GET",headers:s},u))];case 1:return[2,a.sent()]}}))}))},w=function(){function e(e,t){this.url=e,this.options=t||{}}return e.prototype.rawRequest=function(e,t,n){var i=this.options,o=i.headers,s=i.fetch,a=void 0===s?h.default:s,l=i.method,u=void 0===l?"POST":l,d=c(i,["headers","fetch","method"]);return b({url:this.url,query:e,variables:t,headers:r(r({},g(o)),g(n)),operationName:void 0,fetch:a,method:u,fetchOptions:d})},e.prototype.request=function(e,t,n){return a(this,void 0,void 0,(function(){var i,o,s,a,u,d,p,f,m,y,v;return l(this,(function(l){switch(l.label){case 0:return i=this.options,o=i.headers,s=i.fetch,a=void 0===s?h.default:s,u=i.method,d=void 0===u?"POST":u,p=c(i,["headers","fetch","method"]),f=this.url,m=S(e),y=m.query,v=m.operationName,[4,b({url:f,query:y,variables:t,headers:r(r({},g(o)),g(n)),operationName:v,fetch:a,method:d,fetchOptions:p})];case 1:return[2,l.sent().data]}}))}))},e.prototype.batchRequests=function(e,t){return a(this,void 0,void 0,(function(){var n,i,o,s,a,u,d,p,f,m;return l(this,(function(l){switch(l.label){case 0:return n=this.options,i=n.headers,o=n.fetch,s=void 0===o?h.default:o,a=n.method,u=void 0===a?"POST":a,d=c(n,["headers","fetch","method"]),p=this.url,f=e.map((function(e){return S(e.document).query})),m=e.map((function(e){return e.variables})),[4,b({url:p,query:f,variables:m,headers:r(r({},g(i)),g(t)),operationName:void 0,fetch:s,method:u,fetchOptions:d})];case 1:return[2,l.sent().data]}}))}))},e.prototype.setHeaders=function(e){return this.options.headers=e,this},e.prototype.setHeader=function(e,t){var n,r=this.options.headers;return r?r[e]=t:this.options.headers=((n={})[e]=t,n),this},e.prototype.setEndpoint=function(e){return this.url=e,this},e}();function b(e){var t=e.url,n=e.query,i=e.variables,o=e.headers,s=e.operationName,c=e.fetch,u=e.method,h=void 0===u?"POST":u,d=e.fetchOptions;return a(this,void 0,void 0,(function(){var e,a,u,p,f,g,y,w;return l(this,(function(l){switch(l.label){case 0:return e="POST"===h.toUpperCase()?v:_,a=Array.isArray(n),[4,e({url:t,query:n,variables:i,operationName:s,headers:o,fetch:c,fetchOptions:d})];case 1:return[4,E(u=l.sent())];case 2:if(p=l.sent(),f=a&&Array.isArray(p)?!p.some((function(e){return!e.data})):!!p.data,u.ok&&!p.errors&&f)return g=u.headers,y=u.status,[2,r(r({},a?{data:p}:p),{headers:g,status:y})];throw w="string"==typeof p?{error:p}:p,new m.ClientError(r(r({},w),{status:u.status,headers:u.headers}),{query:n,variables:i})}}))}))}function x(e,t,n,r){return a(this,void 0,void 0,(function(){return l(this,(function(i){return[2,new w(e).request(t,n,r)]}))}))}function E(e){var t=e.headers.get("Content-Type");return t&&t.startsWith("application/json")?e.json():e.text()}function S(e){var t;if("string"==typeof e)return{query:e};var n=void 0,r=e.definitions.filter((function(e){return"OperationDefinition"===e.kind}));return 1===r.length&&(n=null===(t=r[0].name)||void 0===t?void 0:t.value),{query:p.print(e),operationName:n}}t.GraphQLClient=w,t.rawRequest=function(e,t,n,r){return a(this,void 0,void 0,(function(){return l(this,(function(i){return[2,new w(e).rawRequest(t,n,r)]}))}))},t.request=x,t.batchRequests=function(e,t,n){return a(this,void 0,void 0,(function(){return l(this,(function(r){return[2,new w(e).batchRequests(t,n)]}))}))},t.default=x,t.gql=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.reduce((function(e,n,r){return""+e+n+(r in t?t[r]:"")}),"")}},8308:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ClientError=void 0;var i=function(e){function t(n,r){var i=this,o=t.extractMessage(n)+": "+JSON.stringify({response:n,request:r});return i=e.call(this,o)||this,Object.setPrototypeOf(i,t.prototype),i.response=n,i.request=r,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,t),i}return r(t,e),t.extractMessage=function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: "+e.status+")"}},t}(Error);t.ClientError=i},7242:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.devAssert=function(e,t){if(!Boolean(e))throw new Error(t)}},8002:(e,t)=>{"use strict";function n(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){if(null===e)return"null";if(t.includes(e))return"[Circular]";const r=[...t,e];if(function(e){return"function"==typeof e.toJSON}(e)){const t=e.toJSON();if(t!==e)return"string"==typeof t?t:n(t,r)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";const r=Math.min(10,e.length),i=e.length-r,o=[];for(let i=0;i<r;++i)o.push(n(e[i],t));return 1===i?o.push("... 1 more item"):i>1&&o.push(`... ${i} more items`),"["+o.join(", ")+"]"}(e,r);return function(e,t){const r=Object.entries(e);if(0===r.length)return"{}";if(t.length>2)return"["+function(e){const t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){const t=e.constructor.name;if("string"==typeof t&&""!==t)return t}return t}(e)+"]";const i=r.map((([e,r])=>e+": "+n(r,t)));return"{ "+i.join(", ")+" }"}(e,r)}(e,t);default:return String(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.inspect=function(e){return n(e,[])}},1807:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Token=t.QueryDocumentKeys=t.OperationTypeNode=t.Location=void 0,t.isNode=function(e){const t=null==e?void 0:e.kind;return"string"==typeof t&&o.has(t)};class n{constructor(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}t.Location=n;class r{constructor(e,t,n,r,i,o){this.kind=e,this.start=t,this.end=n,this.line=r,this.column=i,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}t.Token=r;const i={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};t.QueryDocumentKeys=i;const o=new Set(Object.keys(i));let s;t.OperationTypeNode=s,function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(s||(t.OperationTypeNode=s={}))},849:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dedentBlockStringLines=function(e){var t;let n=Number.MAX_SAFE_INTEGER,r=null,o=-1;for(let t=0;t<e.length;++t){var s;const a=e[t],l=i(a);l!==a.length&&(r=null!==(s=r)&&void 0!==s?s:t,o=t,0!==t&&l<n&&(n=l))}return e.map(((e,t)=>0===t?e:e.slice(n))).slice(null!==(t=r)&&void 0!==t?t:0,o+1)},t.isPrintableAsBlockString=function(e){if(""===e)return!0;let t=!0,n=!1,r=!0,i=!1;for(let o=0;o<e.length;++o)switch(e.codePointAt(o)){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 11:case 12:case 14:case 15:case 13:return!1;case 10:if(t&&!i)return!1;i=!0,t=!0,n=!1;break;case 9:case 32:n||(n=t);break;default:r&&(r=n),t=!1}return!t&&(!r||!i)},t.printBlockString=function(e,t){const n=e.replace(/"""/g,'\\"""'),i=n.split(/\r\n|[\n\r]/g),o=1===i.length,s=i.length>1&&i.slice(1).every((e=>0===e.length||(0,r.isWhiteSpace)(e.charCodeAt(0)))),a=n.endsWith('\\"""'),l=e.endsWith('"')&&!a,c=e.endsWith("\\"),u=l||c,h=!(null!=t&&t.minimize)&&(!o||e.length>70||u||s||a);let d="";const p=o&&(0,r.isWhiteSpace)(e.charCodeAt(0));return(h&&!p||s)&&(d+="\n"),d+=n,(h||u)&&(d+="\n"),'"""'+d+'"""'};var r=n(100);function i(e){let t=0;for(;t<e.length&&(0,r.isWhiteSpace)(e.charCodeAt(t));)++t;return t}},100:(e,t)=>{"use strict";function n(e){return e>=48&&e<=57}function r(e){return e>=97&&e<=122||e>=65&&e<=90}Object.defineProperty(t,"__esModule",{value:!0}),t.isDigit=n,t.isLetter=r,t.isNameContinue=function(e){return r(e)||n(e)||95===e},t.isNameStart=function(e){return r(e)||95===e},t.isWhiteSpace=function(e){return 9===e||32===e}},2828:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.Kind=void 0,t.Kind=n,function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(n||(t.Kind=n={}))},8942:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printString=function(e){return`"${e.replace(n,r)}"`};const n=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function r(e){return i[e.charCodeAt(0)]}const i=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"]},3033:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.print=function(e){return(0,r.visit)(e,s)};var r=n(285),i=n(849),o=n(8942);const s={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>a(e.definitions,"\n\n")},OperationDefinition:{leave(e){const t=c("(",a(e.variableDefinitions,", "),")"),n=a([e.operation,a([e.name,t]),a(e.directives," ")]," ");return("query"===n?"":n+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:n,directives:r})=>e+": "+t+c(" = ",n)+c(" ",a(r," "))},SelectionSet:{leave:({selections:e})=>l(e)},Field:{leave({alias:e,name:t,arguments:n,directives:r,selectionSet:i}){const o=c("",e,": ")+t;let s=o+c("(",a(n,", "),")");return s.length>80&&(s=o+c("(\n",u(a(n,"\n")),"\n)")),a([s,a(r," "),i]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+c(" ",a(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:n})=>a(["...",c("on ",e),a(t," "),n]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:n,directives:r,selectionSet:i})=>`fragment ${e}${c("(",a(n,", "),")")} on ${t} ${c("",a(r," ")," ")}`+i},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>t?(0,i.printBlockString)(e):(0,o.printString)(e)},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+a(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+a(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+c("(",a(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:t,operationTypes:n})=>c("",e,"\n")+a(["schema",a(t," "),l(n)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({description:e,name:t,directives:n})=>c("",e,"\n")+a(["scalar",t,a(n," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:r,fields:i})=>c("",e,"\n")+a(["type",t,c("implements ",a(n," & ")),a(r," "),l(i)]," ")},FieldDefinition:{leave:({description:e,name:t,arguments:n,type:r,directives:i})=>c("",e,"\n")+t+(h(n)?c("(\n",u(a(n,"\n")),"\n)"):c("(",a(n,", "),")"))+": "+r+c(" ",a(i," "))},InputValueDefinition:{leave:({description:e,name:t,type:n,defaultValue:r,directives:i})=>c("",e,"\n")+a([t+": "+n,c("= ",r),a(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:r,fields:i})=>c("",e,"\n")+a(["interface",t,c("implements ",a(n," & ")),a(r," "),l(i)]," ")},UnionTypeDefinition:{leave:({description:e,name:t,directives:n,types:r})=>c("",e,"\n")+a(["union",t,a(n," "),c("= ",a(r," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:t,directives:n,values:r})=>c("",e,"\n")+a(["enum",t,a(n," "),l(r)]," ")},EnumValueDefinition:{leave:({description:e,name:t,directives:n})=>c("",e,"\n")+a([t,a(n," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:t,directives:n,fields:r})=>c("",e,"\n")+a(["input",t,a(n," "),l(r)]," ")},DirectiveDefinition:{leave:({description:e,name:t,arguments:n,repeatable:r,locations:i})=>c("",e,"\n")+"directive @"+t+(h(n)?c("(\n",u(a(n,"\n")),"\n)"):c("(",a(n,", "),")"))+(r?" repeatable":"")+" on "+a(i," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>a(["extend schema",a(e," "),l(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>a(["extend scalar",e,a(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:r})=>a(["extend type",e,c("implements ",a(t," & ")),a(n," "),l(r)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:r})=>a(["extend interface",e,c("implements ",a(t," & ")),a(n," "),l(r)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:n})=>a(["extend union",e,a(t," "),c("= ",a(n," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:n})=>a(["extend enum",e,a(t," "),l(n)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:n})=>a(["extend input",e,a(t," "),l(n)]," ")}};function a(e,t=""){var n;return null!==(n=null==e?void 0:e.filter((e=>e)).join(t))&&void 0!==n?n:""}function l(e){return c("{\n",u(a(e,"\n")),"\n}")}function c(e,t,n=""){return null!=t&&""!==t?e+t+n:""}function u(e){return c("  ",e.replace(/\n/g,"\n  "))}function h(e){var t;return null!==(t=null==e?void 0:e.some((e=>e.includes("\n"))))&&void 0!==t&&t}},285:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BREAK=void 0,t.getEnterLeaveForKind=l,t.getVisitFn=function(e,t,n){const{enter:r,leave:i}=l(e,t);return n?i:r},t.visit=function(e,t,n=o.QueryDocumentKeys){const c=new Map;for(const e of Object.values(s.Kind))c.set(e,l(t,e));let u,h,d,p,f=Array.isArray(e),m=[e],g=-1,y=[];const v=[],_=[];let w=e;do{g++;const e=g===m.length,s=e&&0!==y.length;if(e){if(d=0===_.length?void 0:v[v.length-1],h=p,p=_.pop(),s)if(f){h=h.slice();let e=0;for(const[t,n]of y){const r=t-e;null===n?(h.splice(r,1),e++):h[r]=n}}else{h=Object.defineProperties({},Object.getOwnPropertyDescriptors(h));for(const[e,t]of y)h[e]=t}g=u.index,m=u.keys,y=u.edits,f=u.inArray,u=u.prev}else{if(d=p?f?g:m[g]:void 0,h=p?p[d]:w,null==h)continue;p&&v.push(d)}let l;if(!Array.isArray(h)){var b,x;(0,o.isNode)(h)||(0,i.devAssert)(!1,`Invalid AST Node: ${(0,r.inspect)(h)}.`);const n=e?null===(b=c.get(h.kind))||void 0===b?void 0:b.leave:null===(x=c.get(h.kind))||void 0===x?void 0:x.enter;if(l=null==n?void 0:n.call(t,h,d,p,v,_),l===a)break;if(!1===l){if(!e){v.pop();continue}}else if(void 0!==l&&(y.push([d,l]),!e)){if(!(0,o.isNode)(l)){v.pop();continue}h=l}}var E;void 0===l&&s&&y.push([d,h]),e?v.pop():(u={inArray:f,index:g,keys:m,edits:y,prev:u},f=Array.isArray(h),m=f?h:null!==(E=n[h.kind])&&void 0!==E?E:[],g=-1,y=[],p&&_.push(p),p=h)}while(void 0!==u);return 0!==y.length&&(w=y[y.length-1][1]),w},t.visitInParallel=function(e){const t=new Array(e.length).fill(null),n=Object.create(null);for(const r of Object.values(s.Kind)){let i=!1;const o=new Array(e.length).fill(void 0),s=new Array(e.length).fill(void 0);for(let t=0;t<e.length;++t){const{enter:n,leave:a}=l(e[t],r);i||(i=null!=n||null!=a),o[t]=n,s[t]=a}if(!i)continue;const c={enter(...n){const r=n[0];for(let s=0;s<e.length;s++)if(null===t[s]){var i;const l=null===(i=o[s])||void 0===i?void 0:i.apply(e[s],n);if(!1===l)t[s]=r;else if(l===a)t[s]=a;else if(void 0!==l)return l}},leave(...n){const r=n[0];for(let o=0;o<e.length;o++)if(null===t[o]){var i;const r=null===(i=s[o])||void 0===i?void 0:i.apply(e[o],n);if(r===a)t[o]=a;else if(void 0!==r&&!1!==r)return r}else t[o]===r&&(t[o]=null)}};n[r]=c}return n};var r=n(8002),i=n(7242),o=n(1807),s=n(2828);const a=Object.freeze({});function l(e,t){const n=e[t];return"object"==typeof n?n:"function"==typeof n?{enter:n,leave:void 0}:{enter:e.enter,leave:e.leave}}t.BREAK=a},3349:(e,t,n)=>{"use strict";var r=n(9509).Buffer,i=n(8473).Transform;function o(e){i.call(this),this._block=r.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}n(5717)(o,i),o.prototype._transform=function(e,t,n){var r=null;try{this.update(e,t)}catch(e){r=e}n(r)},o.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},o.prototype.update=function(e,t){if(function(e,t){if(!r.isBuffer(e)&&"string"!=typeof e)throw new TypeError("Data must be a string or a buffer")}(e),this._finalized)throw new Error("Digest already called");r.isBuffer(e)||(e=r.from(e,t));for(var n=this._block,i=0;this._blockOffset+e.length-i>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)n[o++]=e[i++];this._update(),this._blockOffset=0}for(;i<e.length;)n[this._blockOffset++]=e[i++];for(var s=0,a=8*e.length;a>0;++s)this._length[s]+=a,(a=this._length[s]/4294967296|0)>0&&(this._length[s]-=4294967296*a);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return t},o.prototype._digest=function(){throw new Error("_digest is not implemented")},e.exports=o},645:(e,t)=>{t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*l-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+p]=255&s,p+=f,s/=256,c-=8);e[n+p-f]|=128*m}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},2318:(e,t,n)=>{"use strict";var r=n(5717),i=n(3349),o=n(9509).Buffer,s=new Array(16);function a(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function l(e,t){return e<<t|e>>>32-t}function c(e,t,n,r,i,o,s){return l(e+(t&n|~t&r)+i+o|0,s)+t|0}function u(e,t,n,r,i,o,s){return l(e+(t&r|n&~r)+i+o|0,s)+t|0}function h(e,t,n,r,i,o,s){return l(e+(t^n^r)+i+o|0,s)+t|0}function d(e,t,n,r,i,o,s){return l(e+(n^(t|~r))+i+o|0,s)+t|0}r(a,i),a.prototype._update=function(){for(var e=s,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var n=this._a,r=this._b,i=this._c,o=this._d;n=c(n,r,i,o,e[0],3614090360,7),o=c(o,n,r,i,e[1],3905402710,12),i=c(i,o,n,r,e[2],606105819,17),r=c(r,i,o,n,e[3],3250441966,22),n=c(n,r,i,o,e[4],4118548399,7),o=c(o,n,r,i,e[5],1200080426,12),i=c(i,o,n,r,e[6],2821735955,17),r=c(r,i,o,n,e[7],4249261313,22),n=c(n,r,i,o,e[8],1770035416,7),o=c(o,n,r,i,e[9],2336552879,12),i=c(i,o,n,r,e[10],4294925233,17),r=c(r,i,o,n,e[11],2304563134,22),n=c(n,r,i,o,e[12],1804603682,7),o=c(o,n,r,i,e[13],4254626195,12),i=c(i,o,n,r,e[14],2792965006,17),n=u(n,r=c(r,i,o,n,e[15],1236535329,22),i,o,e[1],4129170786,5),o=u(o,n,r,i,e[6],3225465664,9),i=u(i,o,n,r,e[11],643717713,14),r=u(r,i,o,n,e[0],3921069994,20),n=u(n,r,i,o,e[5],3593408605,5),o=u(o,n,r,i,e[10],38016083,9),i=u(i,o,n,r,e[15],3634488961,14),r=u(r,i,o,n,e[4],3889429448,20),n=u(n,r,i,o,e[9],568446438,5),o=u(o,n,r,i,e[14],3275163606,9),i=u(i,o,n,r,e[3],4107603335,14),r=u(r,i,o,n,e[8],1163531501,20),n=u(n,r,i,o,e[13],2850285829,5),o=u(o,n,r,i,e[2],4243563512,9),i=u(i,o,n,r,e[7],1735328473,14),n=h(n,r=u(r,i,o,n,e[12],2368359562,20),i,o,e[5],4294588738,4),o=h(o,n,r,i,e[8],2272392833,11),i=h(i,o,n,r,e[11],1839030562,16),r=h(r,i,o,n,e[14],4259657740,23),n=h(n,r,i,o,e[1],2763975236,4),o=h(o,n,r,i,e[4],1272893353,11),i=h(i,o,n,r,e[7],4139469664,16),r=h(r,i,o,n,e[10],3200236656,23),n=h(n,r,i,o,e[13],681279174,4),o=h(o,n,r,i,e[0],3936430074,11),i=h(i,o,n,r,e[3],3572445317,16),r=h(r,i,o,n,e[6],76029189,23),n=h(n,r,i,o,e[9],3654602809,4),o=h(o,n,r,i,e[12],3873151461,11),i=h(i,o,n,r,e[15],530742520,16),n=d(n,r=h(r,i,o,n,e[2],3299628645,23),i,o,e[0],4096336452,6),o=d(o,n,r,i,e[7],1126891415,10),i=d(i,o,n,r,e[14],2878612391,15),r=d(r,i,o,n,e[5],4237533241,21),n=d(n,r,i,o,e[12],1700485571,6),o=d(o,n,r,i,e[3],2399980690,10),i=d(i,o,n,r,e[10],4293915773,15),r=d(r,i,o,n,e[1],2240044497,21),n=d(n,r,i,o,e[8],1873313359,6),o=d(o,n,r,i,e[15],4264355552,10),i=d(i,o,n,r,e[6],2734768916,15),r=d(r,i,o,n,e[13],1309151649,21),n=d(n,r,i,o,e[4],4149444226,6),o=d(o,n,r,i,e[11],3174756917,10),i=d(i,o,n,r,e[2],718787259,15),r=d(r,i,o,n,e[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+o|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=o.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},e.exports=a},6192:(e,t)=>{var n,r,i=function(){var e=function(e,t){var n=e,r=s[t],i=null,o=0,l=null,g=[],y={},_=function(e,t){i=function(e){for(var t=new Array(e),n=0;n<e;n+=1){t[n]=new Array(e);for(var r=0;r<e;r+=1)t[n][r]=null}return t}(o=4*n+17),w(0,0),w(o-7,0),w(0,o-7),x(),b(),S(e,t),n>=7&&E(e),null==l&&(l=T(n,r,g)),M(l,t)},w=function(e,t){for(var n=-1;n<=7;n+=1)if(!(e+n<=-1||o<=e+n))for(var r=-1;r<=7;r+=1)t+r<=-1||o<=t+r||(i[e+n][t+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},b=function(){for(var e=8;e<o-8;e+=1)null==i[e][6]&&(i[e][6]=e%2==0);for(var t=8;t<o-8;t+=1)null==i[6][t]&&(i[6][t]=t%2==0)},x=function(){for(var e=a.getPatternPosition(n),t=0;t<e.length;t+=1)for(var r=0;r<e.length;r+=1){var o=e[t],s=e[r];if(null==i[o][s])for(var l=-2;l<=2;l+=1)for(var c=-2;c<=2;c+=1)i[o+l][s+c]=-2==l||2==l||-2==c||2==c||0==l&&0==c}},E=function(e){for(var t=a.getBCHTypeNumber(n),r=0;r<18;r+=1){var s=!e&&1==(t>>r&1);i[Math.floor(r/3)][r%3+o-8-3]=s}for(r=0;r<18;r+=1)s=!e&&1==(t>>r&1),i[r%3+o-8-3][Math.floor(r/3)]=s},S=function(e,t){for(var n=r<<3|t,s=a.getBCHTypeInfo(n),l=0;l<15;l+=1){var c=!e&&1==(s>>l&1);l<6?i[l][8]=c:l<8?i[l+1][8]=c:i[o-15+l][8]=c}for(l=0;l<15;l+=1)c=!e&&1==(s>>l&1),l<8?i[8][o-l-1]=c:l<9?i[8][15-l-1+1]=c:i[8][15-l-1]=c;i[o-8][8]=!e},M=function(e,t){for(var n=-1,r=o-1,s=7,l=0,c=a.getMaskFunction(t),u=o-1;u>0;u-=2)for(6==u&&(u-=1);;){for(var h=0;h<2;h+=1)if(null==i[r][u-h]){var d=!1;l<e.length&&(d=1==(e[l]>>>s&1)),c(r,u-h)&&(d=!d),i[r][u-h]=d,-1==(s-=1)&&(l+=1,s=7)}if((r+=n)<0||o<=r){r-=n,n=-n;break}}},T=function(e,t,n){for(var r=u.getRSBlocks(e,t),i=h(),o=0;o<n.length;o+=1){var s=n[o];i.put(s.getMode(),4),i.put(s.getLength(),a.getLengthInBits(s.getMode(),e)),s.write(i)}var l=0;for(o=0;o<r.length;o+=1)l+=r[o].dataCount;if(i.getLengthInBits()>8*l)throw"code length overflow. ("+i.getLengthInBits()+">"+8*l+")";for(i.getLengthInBits()+4<=8*l&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=8*l||(i.put(236,8),i.getLengthInBits()>=8*l));)i.put(17,8);return function(e,t){for(var n=0,r=0,i=0,o=new Array(t.length),s=new Array(t.length),l=0;l<t.length;l+=1){var u=t[l].dataCount,h=t[l].totalCount-u;r=Math.max(r,u),i=Math.max(i,h),o[l]=new Array(u);for(var d=0;d<o[l].length;d+=1)o[l][d]=255&e.getBuffer()[d+n];n+=u;var p=a.getErrorCorrectPolynomial(h),f=c(o[l],p.getLength()-1).mod(p);for(s[l]=new Array(p.getLength()-1),d=0;d<s[l].length;d+=1){var m=d+f.getLength()-s[l].length;s[l][d]=m>=0?f.getAt(m):0}}var g=0;for(d=0;d<t.length;d+=1)g+=t[d].totalCount;var y=new Array(g),v=0;for(d=0;d<r;d+=1)for(l=0;l<t.length;l+=1)d<o[l].length&&(y[v]=o[l][d],v+=1);for(d=0;d<i;d+=1)for(l=0;l<t.length;l+=1)d<s[l].length&&(y[v]=s[l][d],v+=1);return y}(i,r)};y.addData=function(e,t){var n=null;switch(t=t||"Byte"){case"Numeric":n=d(e);break;case"Alphanumeric":n=p(e);break;case"Byte":n=f(e);break;case"Kanji":n=m(e);break;default:throw"mode:"+t}g.push(n),l=null},y.isDark=function(e,t){if(e<0||o<=e||t<0||o<=t)throw e+","+t;return i[e][t]},y.getModuleCount=function(){return o},y.make=function(){if(n<1){for(var e=1;e<40;e++){for(var t=u.getRSBlocks(e,r),i=h(),o=0;o<g.length;o++){var s=g[o];i.put(s.getMode(),4),i.put(s.getLength(),a.getLengthInBits(s.getMode(),e)),s.write(i)}var l=0;for(o=0;o<t.length;o++)l+=t[o].dataCount;if(i.getLengthInBits()<=8*l)break}n=e}_(!1,function(){for(var e=0,t=0,n=0;n<8;n+=1){_(!0,n);var r=a.getLostPoint(y);(0==n||e>r)&&(e=r,t=n)}return t}())},y.createTableTag=function(e,t){e=e||2;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: "+(t=void 0===t?4*e:t)+"px;",n+='">',n+="<tbody>";for(var r=0;r<y.getModuleCount();r+=1){n+="<tr>";for(var i=0;i<y.getModuleCount();i+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+e+"px;",n+=" height: "+e+"px;",n+=" background-color: ",n+=y.isDark(r,i)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return(n+="</tbody>")+"</table>"},y.createSvgTag=function(e,t,n,r){var i={};"object"==typeof arguments[0]&&(e=(i=arguments[0]).cellSize,t=i.margin,n=i.alt,r=i.title),e=e||2,t=void 0===t?4*e:t,(n="string"==typeof n?{text:n}:n||{}).text=n.text||null,n.id=n.text?n.id||"qrcode-description":null,(r="string"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||"qrcode-title":null;var o,s,a,l,c=y.getModuleCount()*e+2*t,u="";for(l="l"+e+",0 0,"+e+" -"+e+",0 0,-"+e+"z ",u+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',u+=i.scalable?"":' width="'+c+'px" height="'+c+'px"',u+=' viewBox="0 0 '+c+" "+c+'" ',u+=' preserveAspectRatio="xMinYMin meet"',u+=r.text||n.text?' role="img" aria-labelledby="'+A([r.id,n.id].join(" ").trim())+'"':"",u+=">",u+=r.text?'<title id="'+A(r.id)+'">'+A(r.text)+"</title>":"",u+=n.text?'<description id="'+A(n.id)+'">'+A(n.text)+"</description>":"",u+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',u+='<path d="',s=0;s<y.getModuleCount();s+=1)for(a=s*e+t,o=0;o<y.getModuleCount();o+=1)y.isDark(s,o)&&(u+="M"+(o*e+t)+","+a+l);return(u+='" stroke="transparent" fill="black"/>')+"</svg>"},y.createDataURL=function(e,t){e=e||2,t=void 0===t?4*e:t;var n=y.getModuleCount()*e+2*t,r=t,i=n-t;return v(n,n,(function(t,n){if(r<=t&&t<i&&r<=n&&n<i){var o=Math.floor((t-r)/e),s=Math.floor((n-r)/e);return y.isDark(s,o)?0:1}return 1}))},y.createImgTag=function(e,t,n){e=e||2,t=void 0===t?4*e:t;var r=y.getModuleCount()*e+2*t,i="";return i+="<img",i+=' src="',i+=y.createDataURL(e,t),i+='"',i+=' width="',i+=r,i+='"',i+=' height="',i+=r,i+='"',n&&(i+=' alt="',i+=A(n),i+='"'),i+"/>"};var A=function(e){for(var t="",n=0;n<e.length;n+=1){var r=e.charAt(n);switch(r){case"<":t+="&lt;";break;case">":t+="&gt;";break;case"&":t+="&amp;";break;case'"':t+="&quot;";break;default:t+=r}}return t};return y.createASCII=function(e,t){if((e=e||1)<2)return function(e){e=void 0===e?2:e;var t,n,r,i,o,s=1*y.getModuleCount()+2*e,a=e,l=s-e,c={"":""," ":""," ":"","  ":" "},u={"":""," ":""," ":" ","  ":" "},h="";for(t=0;t<s;t+=2){for(r=Math.floor((t-a)/1),i=Math.floor((t+1-a)/1),n=0;n<s;n+=1)o="",a<=n&&n<l&&a<=t&&t<l&&y.isDark(r,Math.floor((n-a)/1))&&(o=" "),a<=n&&n<l&&a<=t+1&&t+1<l&&y.isDark(i,Math.floor((n-a)/1))?o+=" ":o+="",h+=e<1&&t+1>=l?u[o]:c[o];h+="\n"}return s%2&&e>0?h.substring(0,h.length-s-1)+Array(s+1).join(""):h.substring(0,h.length-1)}(t);e-=1,t=void 0===t?2*e:t;var n,r,i,o,s=y.getModuleCount()*e+2*t,a=t,l=s-t,c=Array(e+1).join(""),u=Array(e+1).join("  "),h="",d="";for(n=0;n<s;n+=1){for(i=Math.floor((n-a)/e),d="",r=0;r<s;r+=1)o=1,a<=r&&r<l&&a<=n&&n<l&&y.isDark(i,Math.floor((r-a)/e))&&(o=0),d+=o?c:u;for(i=0;i<e;i+=1)h+=d+"\n"}return h.substring(0,h.length-1)},y.renderTo2dContext=function(e,t){t=t||2;for(var n=y.getModuleCount(),r=0;r<n;r++)for(var i=0;i<n;i++)e.fillStyle=y.isDark(r,i)?"black":"white",e.fillRect(r*t,i*t,t,t)},y};e.stringToBytes=(e.stringToBytesFuncs={default:function(e){for(var t=[],n=0;n<e.length;n+=1){var r=e.charCodeAt(n);t.push(255&r)}return t}}).default,e.createStringToBytes=function(e,t){var n=function(){for(var n=y(e),r=function(){var e=n.read();if(-1==e)throw"eof";return e},i=0,o={};;){var s=n.read();if(-1==s)break;var a=r(),l=r()<<8|r();o[String.fromCharCode(s<<8|a)]=l,i+=1}if(i!=t)throw i+" != "+t;return o}(),r="?".charCodeAt(0);return function(e){for(var t=[],i=0;i<e.length;i+=1){var o=e.charCodeAt(i);if(o<128)t.push(o);else{var s=n[e.charAt(i)];"number"==typeof s?(255&s)==s?t.push(s):(t.push(s>>>8),t.push(255&s)):t.push(r)}}return t}};var t,n,r,i,o,s={L:1,M:0,Q:3,H:2},a=(t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,r=7973,o=function(e){for(var t=0;0!=e;)t+=1,e>>>=1;return t},(i={}).getBCHTypeInfo=function(e){for(var t=e<<10;o(t)-o(n)>=0;)t^=n<<o(t)-o(n);return 21522^(e<<10|t)},i.getBCHTypeNumber=function(e){for(var t=e<<12;o(t)-o(r)>=0;)t^=r<<o(t)-o(r);return e<<12|t},i.getPatternPosition=function(e){return t[e-1]},i.getMaskFunction=function(e){switch(e){case 0:return function(e,t){return(e+t)%2==0};case 1:return function(e,t){return e%2==0};case 2:return function(e,t){return t%3==0};case 3:return function(e,t){return(e+t)%3==0};case 4:return function(e,t){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case 5:return function(e,t){return e*t%2+e*t%3==0};case 6:return function(e,t){return(e*t%2+e*t%3)%2==0};case 7:return function(e,t){return(e*t%3+(e+t)%2)%2==0};default:throw"bad maskPattern:"+e}},i.getErrorCorrectPolynomial=function(e){for(var t=c([1],0),n=0;n<e;n+=1)t=t.multiply(c([1,l.gexp(n)],0));return t},i.getLengthInBits=function(e,t){if(1<=t&&t<10)switch(e){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+e}else if(t<27)switch(e){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+e}else{if(!(t<41))throw"type:"+t;switch(e){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+e}}},i.getLostPoint=function(e){for(var t=e.getModuleCount(),n=0,r=0;r<t;r+=1)for(var i=0;i<t;i+=1){for(var o=0,s=e.isDark(r,i),a=-1;a<=1;a+=1)if(!(r+a<0||t<=r+a))for(var l=-1;l<=1;l+=1)i+l<0||t<=i+l||0==a&&0==l||s==e.isDark(r+a,i+l)&&(o+=1);o>5&&(n+=3+o-5)}for(r=0;r<t-1;r+=1)for(i=0;i<t-1;i+=1){var c=0;e.isDark(r,i)&&(c+=1),e.isDark(r+1,i)&&(c+=1),e.isDark(r,i+1)&&(c+=1),e.isDark(r+1,i+1)&&(c+=1),0!=c&&4!=c||(n+=3)}for(r=0;r<t;r+=1)for(i=0;i<t-6;i+=1)e.isDark(r,i)&&!e.isDark(r,i+1)&&e.isDark(r,i+2)&&e.isDark(r,i+3)&&e.isDark(r,i+4)&&!e.isDark(r,i+5)&&e.isDark(r,i+6)&&(n+=40);for(i=0;i<t;i+=1)for(r=0;r<t-6;r+=1)e.isDark(r,i)&&!e.isDark(r+1,i)&&e.isDark(r+2,i)&&e.isDark(r+3,i)&&e.isDark(r+4,i)&&!e.isDark(r+5,i)&&e.isDark(r+6,i)&&(n+=40);var u=0;for(i=0;i<t;i+=1)for(r=0;r<t;r+=1)e.isDark(r,i)&&(u+=1);return n+Math.abs(100*u/t/t-50)/5*10},i),l=function(){for(var e=new Array(256),t=new Array(256),n=0;n<8;n+=1)e[n]=1<<n;for(n=8;n<256;n+=1)e[n]=e[n-4]^e[n-5]^e[n-6]^e[n-8];for(n=0;n<255;n+=1)t[e[n]]=n;return{glog:function(e){if(e<1)throw"glog("+e+")";return t[e]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e[t]}}}();function c(e,t){if(void 0===e.length)throw e.length+"/"+t;var n=function(){for(var n=0;n<e.length&&0==e[n];)n+=1;for(var r=new Array(e.length-n+t),i=0;i<e.length-n;i+=1)r[i]=e[i+n];return r}(),r={getAt:function(e){return n[e]},getLength:function(){return n.length},multiply:function(e){for(var t=new Array(r.getLength()+e.getLength()-1),n=0;n<r.getLength();n+=1)for(var i=0;i<e.getLength();i+=1)t[n+i]^=l.gexp(l.glog(r.getAt(n))+l.glog(e.getAt(i)));return c(t,0)},mod:function(e){if(r.getLength()-e.getLength()<0)return r;for(var t=l.glog(r.getAt(0))-l.glog(e.getAt(0)),n=new Array(r.getLength()),i=0;i<r.getLength();i+=1)n[i]=r.getAt(i);for(i=0;i<e.getLength();i+=1)n[i]^=l.gexp(l.glog(e.getAt(i))+t);return c(n,0).mod(e)}};return r}var u=function(){var e=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t=function(e,t){var n={};return n.totalCount=e,n.dataCount=t,n},n={getRSBlocks:function(n,r){var i=function(t,n){switch(n){case s.L:return e[4*(t-1)+0];case s.M:return e[4*(t-1)+1];case s.Q:return e[4*(t-1)+2];case s.H:return e[4*(t-1)+3];default:return}}(n,r);if(void 0===i)throw"bad rs block @ typeNumber:"+n+"/errorCorrectionLevel:"+r;for(var o=i.length/3,a=[],l=0;l<o;l+=1)for(var c=i[3*l+0],u=i[3*l+1],h=i[3*l+2],d=0;d<c;d+=1)a.push(t(u,h));return a}};return n}(),h=function(){var e=[],t=0,n={getBuffer:function(){return e},getAt:function(t){var n=Math.floor(t/8);return 1==(e[n]>>>7-t%8&1)},put:function(e,t){for(var r=0;r<t;r+=1)n.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return t},putBit:function(n){var r=Math.floor(t/8);e.length<=r&&e.push(0),n&&(e[r]|=128>>>t%8),t+=1}};return n},d=function(e){var t=e,n={getMode:function(){return 1},getLength:function(e){return t.length},write:function(e){for(var n=t,i=0;i+2<n.length;)e.put(r(n.substring(i,i+3)),10),i+=3;i<n.length&&(n.length-i==1?e.put(r(n.substring(i,i+1)),4):n.length-i==2&&e.put(r(n.substring(i,i+2)),7))}},r=function(e){for(var t=0,n=0;n<e.length;n+=1)t=10*t+i(e.charAt(n));return t},i=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+e};return n},p=function(e){var t=e,n={getMode:function(){return 2},getLength:function(e){return t.length},write:function(e){for(var n=t,i=0;i+1<n.length;)e.put(45*r(n.charAt(i))+r(n.charAt(i+1)),11),i+=2;i<n.length&&e.put(r(n.charAt(i)),6)}},r=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);if("A"<=e&&e<="Z")return e.charCodeAt(0)-"A".charCodeAt(0)+10;switch(e){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+e}};return n},f=function(t){var n=e.stringToBytes(t);return{getMode:function(){return 4},getLength:function(e){return n.length},write:function(e){for(var t=0;t<n.length;t+=1)e.put(n[t],8)}}},m=function(t){var n=e.stringToBytesFuncs.SJIS;if(!n)throw"sjis not supported.";!function(e,t){var r=n("");if(2!=r.length||38726!=(r[0]<<8|r[1]))throw"sjis not supported."}();var r=n(t),i={getMode:function(){return 8},getLength:function(e){return~~(r.length/2)},write:function(e){for(var t=r,n=0;n+1<t.length;){var i=(255&t[n])<<8|255&t[n+1];if(33088<=i&&i<=40956)i-=33088;else{if(!(57408<=i&&i<=60351))throw"illegal char at "+(n+1)+"/"+i;i-=49472}i=192*(i>>>8&255)+(255&i),e.put(i,13),n+=2}if(n<t.length)throw"illegal char at "+(n+1)}};return i},g=function(){var e=[],t={writeByte:function(t){e.push(255&t)},writeShort:function(e){t.writeByte(e),t.writeByte(e>>>8)},writeBytes:function(e,n,r){n=n||0,r=r||e.length;for(var i=0;i<r;i+=1)t.writeByte(e[i+n])},writeString:function(e){for(var n=0;n<e.length;n+=1)t.writeByte(e.charCodeAt(n))},toByteArray:function(){return e},toString:function(){var t="";t+="[";for(var n=0;n<e.length;n+=1)n>0&&(t+=","),t+=e[n];return t+"]"}};return t},y=function(e){var t=e,n=0,r=0,i=0,o={read:function(){for(;i<8;){if(n>=t.length){if(0==i)return-1;throw"unexpected end of file./"+i}var e=t.charAt(n);if(n+=1,"="==e)return i=0,-1;e.match(/^\s$/)||(r=r<<6|s(e.charCodeAt(0)),i+=6)}var o=r>>>i-8&255;return i-=8,o}},s=function(e){if(65<=e&&e<=90)return e-65;if(97<=e&&e<=122)return e-97+26;if(48<=e&&e<=57)return e-48+52;if(43==e)return 62;if(47==e)return 63;throw"c:"+e};return o},v=function(e,t,n){for(var r=function(e,t){var n=e,r=t,i=new Array(e*t),o={setPixel:function(e,t,r){i[t*n+e]=r},write:function(e){e.writeString("GIF87a"),e.writeShort(n),e.writeShort(r),e.writeByte(128),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(255),e.writeByte(255),e.writeByte(255),e.writeString(","),e.writeShort(0),e.writeShort(0),e.writeShort(n),e.writeShort(r),e.writeByte(0);var t=s(2);e.writeByte(2);for(var i=0;t.length-i>255;)e.writeByte(255),e.writeBytes(t,i,255),i+=255;e.writeByte(t.length-i),e.writeBytes(t,i,t.length-i),e.writeByte(0),e.writeString(";")}},s=function(e){for(var t=1<<e,n=1+(1<<e),r=e+1,o=a(),s=0;s<t;s+=1)o.add(String.fromCharCode(s));o.add(String.fromCharCode(t)),o.add(String.fromCharCode(n));var l,c,u,h=g(),d=(l=h,c=0,u=0,{write:function(e,t){if(e>>>t!=0)throw"length over";for(;c+t>=8;)l.writeByte(255&(e<<c|u)),t-=8-c,e>>>=8-c,u=0,c=0;u|=e<<c,c+=t},flush:function(){c>0&&l.writeByte(u)}});d.write(t,r);var p=0,f=String.fromCharCode(i[p]);for(p+=1;p<i.length;){var m=String.fromCharCode(i[p]);p+=1,o.contains(f+m)?f+=m:(d.write(o.indexOf(f),r),o.size()<4095&&(o.size()==1<<r&&(r+=1),o.add(f+m)),f=m)}return d.write(o.indexOf(f),r),d.write(n,r),d.flush(),h.toByteArray()},a=function(){var e={},t=0,n={add:function(r){if(n.contains(r))throw"dup key:"+r;e[r]=t,t+=1},size:function(){return t},indexOf:function(t){return e[t]},contains:function(t){return void 0!==e[t]}};return n};return o}(e,t),i=0;i<t;i+=1)for(var o=0;o<e;o+=1)r.setPixel(o,i,n(o,i));var s=g();r.write(s);for(var a=function(){var e=0,t=0,n=0,r="",i={},o=function(e){r+=String.fromCharCode(s(63&e))},s=function(e){if(e<0);else{if(e<26)return 65+e;if(e<52)return e-26+97;if(e<62)return e-52+48;if(62==e)return 43;if(63==e)return 47}throw"n:"+e};return i.writeByte=function(r){for(e=e<<8|255&r,t+=8,n+=1;t>=6;)o(e>>>t-6),t-=6},i.flush=function(){if(t>0&&(o(e<<6-t),e=0,t=0),n%3!=0)for(var i=3-n%3,s=0;s<i;s+=1)r+="="},i.toString=function(){return r},i}(),l=s.toByteArray(),c=0;c<l.length;c+=1)a.writeByte(l[c]);return a.flush(),"data:image/gif;base64,"+a};return e}();i.stringToBytesFuncs["UTF-8"]=function(e){return function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&e.charCodeAt(n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t}(e)},void 0===(r="function"==typeof(n=function(){return i})?n.apply(t,[]):n)||(e.exports=r)},4281:e=>{"use strict";var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i))||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,o,s,a,l;if("string"==typeof t&&(o="not ",t.substr(0,o.length)===o)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))s="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var c=("number"!=typeof l&&(l=0),l+".".length>(a=e).length||-1===a.indexOf(".",l)?"argument":"property");s='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(r(t,"type"))}return s+". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6753:(e,t,n)=>{"use strict";var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=c;var i=n(9481),o=n(4229);n(5717)(c,i);for(var s=r(o.prototype),a=0;a<s.length;a++){var l=s[a];c.prototype[l]||(c.prototype[l]=o.prototype[l])}function c(e){if(!(this instanceof c))return new c(e);i.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||process.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},2725:(e,t,n)=>{"use strict";e.exports=i;var r=n(4605);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}n(5717)(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},9481:(e,t,n)=>{"use strict";var r;e.exports=S,S.ReadableState=E,n(7187).EventEmitter;var i,o=function(e,t){return e.listeners(t).length},s=n(2503),a=n(8764).Buffer,l=n.g.Uint8Array||function(){},c=n(4616);i=c&&c.debuglog?c.debuglog("stream"):function(){};var u,h,d,p=n(7327),f=n(1195),m=n(2457).getHighWaterMark,g=n(4281).q,y=g.ERR_INVALID_ARG_TYPE,v=g.ERR_STREAM_PUSH_AFTER_EOF,_=g.ERR_METHOD_NOT_IMPLEMENTED,w=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(5717)(S,s);var b=f.errorOrDestroy,x=["error","close","destroy","pause","resume"];function E(e,t,i){r=r||n(6753),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=m(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(u||(u=n(2553).s),this.decoder=new u(e.encoding),this.encoding=e.encoding)}function S(e){if(r=r||n(6753),!(this instanceof S))return new S(e);var t=this instanceof r;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function M(e,t,n,r,o){i("readableAddChunk",t);var s,c=e._readableState;if(null===t)c.reading=!1,function(e,t){if(i("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?C(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,L(e)))}}(e,c);else if(o||(s=function(e,t){var n,r;return r=t,a.isBuffer(r)||r instanceof l||"string"==typeof t||void 0===t||e.objectMode||(n=new y("chunk",["string","Buffer","Uint8Array"],t)),n}(c,t)),s)b(e,s);else if(c.objectMode||t&&t.length>0)if("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),r)c.endEmitted?b(e,new w):T(e,c,t,!0);else if(c.ended)b(e,new v);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!n?(t=c.decoder.write(t),c.objectMode||0!==t.length?T(e,c,t,!1):P(e,c)):T(e,c,t,!1)}else r||(c.reading=!1,P(e,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function T(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&C(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=f.destroy,S.prototype._undestroy=f.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=a.from(e,t),t=""),n=!0),M(this,e,t,!1,n)},S.prototype.unshift=function(e){return M(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){u||(u=n(2553).s);var t=new u(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var A=1073741824;function R(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;i("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(i("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(L,e))}function L(e){var t=e._readableState;i("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function P(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(I,e,t))}function I(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(i("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function O(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function N(e){i("readable nexttick read 0"),e.read(0)}function k(e,t){i("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(i("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function U(e){var t=e._readableState;i("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(z,t,e))}function z(e,t){if(i("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function F(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}S.prototype.read=function(e){i("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return i("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?U(this):C(this),null;if(0===(e=R(e,t))&&t.ended)return 0===t.length&&U(this),null;var r,o=t.needReadable;return i("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&i("length less than watermark",o=!0),t.ended||t.reading?i("reading or ended",o=!1):o&&(i("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=R(n,t))),null===(r=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&U(this)),null!==r&&this.emit("data",r),r},S.prototype._read=function(e){b(this,new _("_read()"))},S.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,i("pipe count=%d opts=%j",r.pipesCount,t);var s=t&&!1===t.end||e===process.stdout||e===process.stderr?f:a;function a(){i("onend"),e.end()}r.endEmitted?process.nextTick(s):n.once("end",s),e.on("unpipe",(function t(o,s){i("onunpipe"),o===n&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,i("cleanup"),e.removeListener("close",d),e.removeListener("finish",p),e.removeListener("drain",l),e.removeListener("error",h),e.removeListener("unpipe",t),n.removeListener("end",a),n.removeListener("end",f),n.removeListener("data",u),c=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}));var l=function(e){return function(){var t=e._readableState;i("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,D(e))}}(n);e.on("drain",l);var c=!1;function u(t){i("ondata");var o=e.write(t);i("dest.write",o),!1===o&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==F(r.pipes,e))&&!c&&(i("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function h(t){i("onerror",t),f(),e.removeListener("error",h),0===o(e,"error")&&b(e,t)}function d(){e.removeListener("finish",p),f()}function p(){i("onfinish"),e.removeListener("close",d),f()}function f(){i("unpipe"),n.unpipe(e)}return n.on("data",u),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(n):e._events.error=[n,e._events.error]:e.on(t,n)}(e,"error",h),e.once("close",d),e.once("finish",p),e.emit("pipe",n),r.flowing||(i("pipe resume"),n.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=F(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},S.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,i("on readable",r.length,r.reading),r.length?C(this):r.reading||process.nextTick(N,this))),n},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(O,this),n},S.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process.nextTick(O,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(i("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(k,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return i("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(i("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var o in e.on("end",(function(){if(i("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(o){i("wrapped data"),n.decoder&&(o=n.decoder.write(o)),n.objectMode&&null==o||(n.objectMode||o&&o.length)&&(t.push(o)||(r=!0,e.pause()))})),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));for(var s=0;s<x.length;s++)e.on(x[s],this.emit.bind(this,x[s]));return this._read=function(t){i("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=n(5850)),h(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=B,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=n(5167)),d(S,e,t)})},4605:(e,t,n)=>{"use strict";e.exports=u;var r=n(4281).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,l=n(6753);function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,n){d(e,t,n)}))}function d(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}n(5717)(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,n){n(new i("_transform()"))},u.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},4229:(e,t,n)=>{"use strict";function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(undefined),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var i;e.exports=S,S.WritableState=E;var o,s={deprecate:n(4927)},a=n(2503),l=n(8764).Buffer,c=n.g.Uint8Array||function(){},u=n(1195),h=n(2457).getHighWaterMark,d=n(4281).q,p=d.ERR_INVALID_ARG_TYPE,f=d.ERR_METHOD_NOT_IMPLEMENTED,m=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,y=d.ERR_STREAM_DESTROYED,v=d.ERR_STREAM_NULL_VALUES,_=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,b=u.errorOrDestroy;function x(){}function E(e,t,o){i=i||n(6753),e=e||{},"boolean"!=typeof o&&(o=t instanceof i),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if("function"!=typeof i)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(process.nextTick(i,r),process.nextTick(L,e,t),e._writableState.errorEmitted=!0,b(e,r)):(i(r),e._writableState.errorEmitted=!0,b(e,r),L(e,t))}(e,n,r,t,i);else{var o=R(n)||e.destroyed;o||n.corked||n.bufferProcessing||!n.bufferedRequest||A(e,n),r?process.nextTick(T,e,n,o,i):T(e,n,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function S(e){var t=this instanceof(i=i||n(6753));if(!t&&!o.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function M(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function T(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),L(e,t)}function A(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,o=new Array(i),s=t.corkedRequestsFree;s.entry=n;for(var a=0,l=!0;n;)o[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;o.allBuffers=l,M(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,h=n.callback;if(M(e,t,!1,t.objectMode?1:c.length,c,u,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function R(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final((function(n){t.pendingcb--,n&&b(e,n),t.prefinished=!0,e.emit("prefinish"),L(e,t)}))}function L(e,t){var n=R(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(C,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}n(5717)(S,a),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===S&&e&&e._writableState instanceof E}})):o=function(e){return e instanceof this},S.prototype.pipe=function(){b(this,new g)},S.prototype.write=function(e,t,n){var r,i=this._writableState,o=!1,s=!i.objectMode&&(r=e,l.isBuffer(r)||r instanceof c);return s&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=x),i.ending?function(e,t){var n=new _;b(e,n),process.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var i;return null===n?i=new v:"string"==typeof n||t.objectMode||(i=new p("chunk",["string","Buffer"],n)),!i||(b(e,i),process.nextTick(r,i),!1)}(this,i,e,n))&&(i.pendingcb++,o=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,n)),t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else M(e,t,!1,a,r,i,o);return c}(this,i,s,e,t,n)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,n){n(new f("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,L(e,t),n&&(t.finished?process.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=u.destroy,S.prototype._undestroy=u.undestroy,S.prototype._destroy=function(e,t){t(e)}},5850:(e,t,n)=>{"use strict";var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(8610),s=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function f(e){var t=e[s];if(null!==t){var n=e[d].read();null!==n&&(e[u]=null,e[s]=null,e[a]=null,t(p(n,!1)))}}function m(e){process.nextTick(f,e)}var g=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((i(r={get stream(){return this[d]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){process.nextTick((function(){e[l]?n(e[l]):t(p(void 0,!0))}))}));var n,r=this[u];if(r)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[c]?n(p(void 0,!0)):t[h](n,r)}),r)}}(r,this));else{var i=this[d].read();if(null!==i)return Promise.resolve(p(i,!1));n=new Promise(this[h])}return this[u]=n,n}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(t,n){e[d].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),r),g);e.exports=function(e){var t,n=Object.create(y,(i(t={},d,{value:e,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,c,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var r=n[d].read();r?(n[u]=null,n[s]=null,n[a]=null,e(p(r,!1))):(n[s]=e,n[a]=t)},writable:!0}),t));return n[u]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[u]=null,n[s]=null,n[a]=null,t(e)),void(n[l]=e)}var r=n[s];null!==r&&(n[u]=null,n[s]=null,n[a]=null,r(p(void 0,!0))),n[c]=!0})),e.on("readable",m.bind(null,n)),n}},7327:(e,t,n)=>{"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=n(8764).Buffer,a=n(2361).inspect,l=a&&a.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,n,r,i=s.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,n=i,r=a,s.prototype.copy.call(t,n,r),a+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],n&&o(t.prototype,n),e}()},1195:e=>{"use strict";function t(e,t){r(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,i){var o=this,s=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return s||a?(i?i(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(r,this,e)):process.nextTick(r,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!i&&e?o._writableState?o._writableState.errorEmitted?process.nextTick(n,o):(o._writableState.errorEmitted=!0,process.nextTick(t,o,e)):process.nextTick(t,o,e):i?(process.nextTick(n,o),i(e)):process.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},8610:(e,t,n)=>{"use strict";var r=n(4281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,o){if("function"==typeof n)return e(t,null,n);n||(n={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||i);var s=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){a=!1,c=!0,s||o.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){s=!1,h=!0,a||o.call(t)},p=function(e){o.call(t,e)},f=function(){var e;return s&&!h?(t._readableState&&t._readableState.ended||(e=new r),o.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new r),o.call(t,e)):void 0},m=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",f),t.req?m():t.on("request",m)):a&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",u),!1!==n.error&&t.on("error",p),t.on("close",f),function(){t.removeListener("complete",u),t.removeListener("abort",f),t.removeListener("request",m),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",d),t.removeListener("error",p),t.removeListener("close",f)}}},5167:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},9946:(e,t,n)=>{"use strict";var r,i=n(4281).q,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function l(e,t,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;e.on("close",(function(){a=!0})),void 0===r&&(r=n(8610)),r(e,{readable:t,writable:i},(function(e){if(e)return o(e);a=!0,o()}));var l=!1;return function(t){if(!a&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new s("pipe"))}}function c(e){e()}function u(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var s=t.map((function(e,n){var o=n<t.length-1;return l(e,o,n>0,(function(e){r||(r=e),e&&s.forEach(c),o||(s.forEach(c),i(r))}))}));return t.reduce(u)}},2457:(e,t,n)=>{"use strict";var r=n(4281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},2503:(e,t,n)=>{e.exports=n(7187).EventEmitter},8473:(e,t,n)=>{(t=e.exports=n(9481)).Stream=t,t.Readable=t,t.Writable=n(4229),t.Duplex=n(6753),t.Transform=n(4605),t.PassThrough=n(2725),t.finished=n(8610),t.pipeline=n(9946)},9785:(e,t,n)=>{"use strict";var r=n(8764).Buffer,i=n(5717),o=n(3349),s=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],d=[1352829926,1548603684,1836072691,2053994217,0];function p(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function f(e,t){return e<<t|e>>>32-t}function m(e,t,n,r,i,o,s,a){return f(e+(t^n^r)+o+s|0,a)+i|0}function g(e,t,n,r,i,o,s,a){return f(e+(t&n|~t&r)+o+s|0,a)+i|0}function y(e,t,n,r,i,o,s,a){return f(e+((t|~n)^r)+o+s|0,a)+i|0}function v(e,t,n,r,i,o,s,a){return f(e+(t&r|n&~r)+o+s|0,a)+i|0}function _(e,t,n,r,i,o,s,a){return f(e+(t^(n|~r))+o+s|0,a)+i|0}i(p,o),p.prototype._update=function(){for(var e=s,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,p=0|this._e,w=0|this._a,b=0|this._b,x=0|this._c,E=0|this._d,S=0|this._e,M=0;M<80;M+=1){var T,A;M<16?(T=m(n,r,i,o,p,e[a[M]],h[0],c[M]),A=_(w,b,x,E,S,e[l[M]],d[0],u[M])):M<32?(T=g(n,r,i,o,p,e[a[M]],h[1],c[M]),A=v(w,b,x,E,S,e[l[M]],d[1],u[M])):M<48?(T=y(n,r,i,o,p,e[a[M]],h[2],c[M]),A=y(w,b,x,E,S,e[l[M]],d[2],u[M])):M<64?(T=v(n,r,i,o,p,e[a[M]],h[3],c[M]),A=g(w,b,x,E,S,e[l[M]],d[3],u[M])):(T=_(n,r,i,o,p,e[a[M]],h[4],c[M]),A=m(w,b,x,E,S,e[l[M]],d[4],u[M])),n=p,p=o,o=f(i,10),i=r,r=T,w=S,S=E,E=f(x,10),x=b,b=A}var R=this._b+i+E|0;this._b=this._c+o+S|0,this._c=this._d+p+w|0,this._d=this._e+n+b|0,this._e=this._a+r+x|0,this._a=R},p.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=r.alloc?r.alloc(20):new r(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},e.exports=p},9509:(e,t,n)=>{var r=n(8764),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},4189:(e,t,n)=>{var r=n(9509).Buffer;function i(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}i.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=r.from(e,t));for(var n=this._block,i=this._blockSize,o=e.length,s=this._len,a=0;a<o;){for(var l=s%i,c=Math.min(o-a,i-l),u=0;u<c;u++)n[l+u]=e[a+u];a+=c,(s+=c)%i==0&&this._update(n)}return this._len+=o,this},i.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=i},9072:(e,t,n)=>{var r=e.exports=function(e){e=e.toLowerCase();var t=r[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};r.sha=n(4448),r.sha1=n(8336),r.sha224=n(8432),r.sha256=n(7499),r.sha384=n(1686),r.sha512=n(7816)},4448:(e,t,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function l(){this.init(),this._w=a,i.call(this,64,56)}function c(e){return e<<30|e>>>2}function u(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,a=0|this._d,l=0|this._e,h=0;h<16;++h)n[h]=e.readInt32BE(4*h);for(;h<80;++h)n[h]=n[h-3]^n[h-8]^n[h-14]^n[h-16];for(var d=0;d<80;++d){var p=~~(d/20),f=0|((t=r)<<5|t>>>27)+u(p,i,o,a)+l+n[d]+s[p];l=a,a=o,o=c(i),i=r,r=f}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},8336:(e,t,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function l(){this.init(),this._w=a,i.call(this,64,56)}function c(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function h(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,a=0|this._d,l=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=(t=n[d-3]^n[d-8]^n[d-14]^n[d-16])<<1|t>>>31;for(var p=0;p<80;++p){var f=~~(p/20),m=c(r)+h(f,i,o,a)+l+n[p]+s[f]|0;l=a,a=o,o=u(i),i=r,r=m}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},8432:(e,t,n)=>{var r=n(5717),i=n(7499),o=n(4189),s=n(9509).Buffer,a=new Array(64);function l(){this.init(),this._w=a,o.call(this,64,56)}r(l,i),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},7499:(e,t,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function l(){this.init(),this._w=a,i.call(this,64,56)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function h(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function d(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function p(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(l,i),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,a=0|this._d,l=0|this._e,f=0|this._f,m=0|this._g,g=0|this._h,y=0;y<16;++y)n[y]=e.readInt32BE(4*y);for(;y<64;++y)n[y]=0|(((t=n[y-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[y-7]+p(n[y-15])+n[y-16];for(var v=0;v<64;++v){var _=g+d(l)+c(l,f,m)+s[v]+n[v]|0,w=h(r)+u(r,i,o)|0;g=m,m=f,f=l,l=a+_|0,a=o,o=i,i=r,r=_+w|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0,this._f=f+this._f|0,this._g=m+this._g|0,this._h=g+this._h|0},l.prototype._hash=function(){var e=o.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},1686:(e,t,n)=>{var r=n(5717),i=n(7816),o=n(4189),s=n(9509).Buffer,a=new Array(160);function l(){this.init(),this._w=a,o.call(this,128,112)}r(l,i),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l},7816:(e,t,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function l(){this.init(),this._w=a,i.call(this,128,112)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function h(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function d(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function y(e,t){return e>>>0<t>>>0?1:0}r(l,i),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,a=0|this._eh,l=0|this._fh,v=0|this._gh,_=0|this._hh,w=0|this._al,b=0|this._bl,x=0|this._cl,E=0|this._dl,S=0|this._el,M=0|this._fl,T=0|this._gl,A=0|this._hl,R=0;R<32;R+=2)t[R]=e.readInt32BE(4*R),t[R+1]=e.readInt32BE(4*R+4);for(;R<160;R+=2){var C=t[R-30],L=t[R-30+1],P=p(C,L),I=f(L,C),O=m(C=t[R-4],L=t[R-4+1]),N=g(L,C),k=t[R-14],D=t[R-14+1],B=t[R-32],U=t[R-32+1],z=I+D|0,F=P+k+y(z,I)|0;F=(F=F+O+y(z=z+N|0,N)|0)+B+y(z=z+U|0,U)|0,t[R]=F,t[R+1]=z}for(var H=0;H<160;H+=2){F=t[H],z=t[H+1];var G=u(n,r,i),V=u(w,b,x),j=h(n,w),W=h(w,n),q=d(a,S),K=d(S,a),X=s[H],Y=s[H+1],J=c(a,l,v),Z=c(S,M,T),Q=A+K|0,$=_+q+y(Q,A)|0;$=($=($=$+J+y(Q=Q+Z|0,Z)|0)+X+y(Q=Q+Y|0,Y)|0)+F+y(Q=Q+z|0,z)|0;var ee=W+V|0,te=j+G+y(ee,W)|0;_=v,A=T,v=l,T=M,l=a,M=S,a=o+$+y(S=E+Q|0,E)|0,o=i,E=x,i=r,x=b,r=n,b=w,n=$+te+y(w=Q+ee|0,Q)|0}this._al=this._al+w|0,this._bl=this._bl+b|0,this._cl=this._cl+x|0,this._dl=this._dl+E|0,this._el=this._el+S|0,this._fl=this._fl+M|0,this._gl=this._gl+T|0,this._hl=this._hl+A|0,this._ah=this._ah+n+y(this._al,w)|0,this._bh=this._bh+r+y(this._bl,b)|0,this._ch=this._ch+i+y(this._cl,x)|0,this._dh=this._dh+o+y(this._dl,E)|0,this._eh=this._eh+a+y(this._el,S)|0,this._fh=this._fh+l+y(this._fl,M)|0,this._gh=this._gh+v+y(this._gl,T)|0,this._hh=this._hh+_+y(this._hl,A)|0},l.prototype._hash=function(){var e=o.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},2830:(e,t,n)=>{e.exports=i;var r=n(7187).EventEmitter;function i(){r.call(this)}n(5717)(i,r),i.Readable=n(9481),i.Writable=n(4229),i.Duplex=n(6753),i.Transform=n(4605),i.PassThrough=n(2725),i.finished=n(8610),i.pipeline=n(9946),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",l));var s=!1;function a(){s||(s=!0,e.end())}function l(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(u(),0===r.listenerCount(this,"error"))throw e}function u(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",l),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return n.on("error",c),e.on("error",c),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e}},2553:(e,t,n)=>{"use strict";var r=n(9509).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function u(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.s=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},4927:(e,t,n)=>{function r(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},5883:()=>{},2361:()=>{},4616:()=>{}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.u=e=>e+".bundle.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,(()=>{"use strict";var e={};n.r(e),n.d(e,{ACESFilmicToneMapping:()=>Gr,AddEquation:()=>hr,AddOperation:()=>Br,AdditiveAnimationBlendMode:()=>mo,AdditiveBlending:()=>ar,AlphaFormat:()=>bi,AlwaysDepth:()=>Rr,AlwaysStencilFunc:()=>Fo,AmbientLight:()=>wm,AmbientLightProbe:()=>Bm,AnimationClip:()=>Wf,AnimationLoader:()=>$f,AnimationMixer:()=>mg,AnimationObjectGroup:()=>pg,AnimationUtils:()=>If,ArcCurve:()=>dp,ArrayCamera:()=>kh,ArrowHelper:()=>iy,Audio:()=>Ym,AudioAnalyser:()=>tg,AudioContext:()=>Nm,AudioListener:()=>Xm,AudioLoader:()=>km,AxesHelper:()=>oy,AxisHelper:()=>Ny,BackSide:()=>tr,BasicDepthPacking:()=>bo,BasicShadowMap:()=>Jn,BinaryTextureLoader:()=>zy,Bone:()=>bd,BooleanKeyframeTrack:()=>Uf,BoundingBoxHelper:()=>ky,Box2:()=>Mg,Box3:()=>Us,Box3Helper:()=>$g,BoxBufferGeometry:()=>Ul,BoxGeometry:()=>Ul,BoxHelper:()=>Qg,BufferAttribute:()=>el,BufferGeometry:()=>vl,BufferGeometryLoader:()=>Am,ByteType:()=>hi,Cache:()=>Kf,Camera:()=>Vl,CameraHelper:()=>Yg,CanvasRenderer:()=>Hy,CanvasTexture:()=>$d,CatmullRomCurve3:()=>vp,CineonToneMapping:()=>Hr,CircleBufferGeometry:()=>ep,CircleGeometry:()=>ep,ClampToEdgeWrapping:()=>Qr,Clock:()=>Gm,Color:()=>Ss,ColorKeyframeTrack:()=>zf,CompressedTexture:()=>Qd,CompressedTextureLoader:()=>em,ConeBufferGeometry:()=>np,ConeGeometry:()=>np,CubeCamera:()=>ql,CubeReflectionMapping:()=>Wr,CubeRefractionMapping:()=>qr,CubeTexture:()=>Kl,CubeTextureLoader:()=>nm,CubeUVReflectionMapping:()=>Yr,CubeUVRefractionMapping:()=>Jr,CubicBezierCurve:()=>xp,CubicBezierCurve3:()=>Ep,CubicInterpolant:()=>Nf,CullFaceBack:()=>Kn,CullFaceFront:()=>Xn,CullFaceFrontBack:()=>Yn,CullFaceNone:()=>qn,Curve:()=>up,CurvePath:()=>Lp,CustomBlending:()=>ur,CustomToneMapping:()=>Vr,CylinderBufferGeometry:()=>tp,CylinderGeometry:()=>tp,Cylindrical:()=>Eg,DataTexture:()=>xd,DataTexture2DArray:()=>zc,DataTexture3D:()=>Wc,DataTextureLoader:()=>rm,DataUtils:()=>cy,DecrementStencilOp:()=>Co,DecrementWrapStencilOp:()=>Po,DefaultLoadingManager:()=>Yf,DepthFormat:()=>Mi,DepthStencilFormat:()=>Ti,DepthTexture:()=>zh,DirectionalLight:()=>_m,DirectionalLightHelper:()=>qg,DiscreteInterpolant:()=>Df,DodecahedronBufferGeometry:()=>ip,DodecahedronGeometry:()=>ip,DoubleSide:()=>nr,DstAlphaFactor:()=>xr,DstColorFactor:()=>Sr,DynamicBufferAttribute:()=>Sy,DynamicCopyUsage:()=>Xo,DynamicDrawUsage:()=>Go,DynamicReadUsage:()=>Wo,EdgesGeometry:()=>cp,EdgesHelper:()=>Dy,EllipseCurve:()=>hp,EqualDepth:()=>Pr,EqualStencilFunc:()=>ko,EquirectangularReflectionMapping:()=>Kr,EquirectangularRefractionMapping:()=>Xr,Euler:()=>xa,EventDispatcher:()=>$o,ExtrudeBufferGeometry:()=>af,ExtrudeGeometry:()=>af,FaceColors:()=>py,FileLoader:()=>Qf,FlatShading:()=>rr,Float16BufferAttribute:()=>ll,Float32Attribute:()=>Iy,Float32BufferAttribute:()=>cl,Float64Attribute:()=>Oy,Float64BufferAttribute:()=>ul,FloatType:()=>gi,Fog:()=>Wh,FogExp2:()=>jh,Font:()=>Xy,FontLoader:()=>Ky,FramebufferTexture:()=>Zd,FrontSide:()=>er,Frustum:()=>tc,GLBufferAttribute:()=>vg,GLSL1:()=>Jo,GLSL3:()=>Zo,GreaterDepth:()=>Or,GreaterEqualDepth:()=>Ir,GreaterEqualStencilFunc:()=>zo,GreaterStencilFunc:()=>Bo,GridHelper:()=>Hg,Group:()=>Dh,HalfFloatType:()=>yi,HemisphereLight:()=>sm,HemisphereLightHelper:()=>Fg,HemisphereLightProbe:()=>Dm,IcosahedronBufferGeometry:()=>cf,IcosahedronGeometry:()=>cf,ImageBitmapLoader:()=>Im,ImageLoader:()=>tm,ImageUtils:()=>Ts,ImmediateRenderObject:()=>Yy,IncrementStencilOp:()=>Ro,IncrementWrapStencilOp:()=>Lo,InstancedBufferAttribute:()=>Td,InstancedBufferGeometry:()=>Tm,InstancedInterleavedBuffer:()=>yg,InstancedMesh:()=>Pd,Int16Attribute:()=>Ry,Int16BufferAttribute:()=>il,Int32Attribute:()=>Ly,Int32BufferAttribute:()=>sl,Int8Attribute:()=>My,Int8BufferAttribute:()=>tl,IntType:()=>fi,InterleavedBuffer:()=>Kh,InterleavedBufferAttribute:()=>Yh,Interpolant:()=>Of,InterpolateDiscrete:()=>ao,InterpolateLinear:()=>lo,InterpolateSmooth:()=>co,InvertStencilOp:()=>Io,JSONLoader:()=>Gy,KeepStencilOp:()=>To,KeyframeTrack:()=>Bf,LOD:()=>fd,LatheBufferGeometry:()=>uf,LatheGeometry:()=>uf,Layers:()=>Ea,LensFlare:()=>jy,LessDepth:()=>Cr,LessEqualDepth:()=>Lr,LessEqualStencilFunc:()=>Do,LessStencilFunc:()=>No,Light:()=>om,LightProbe:()=>Em,Line:()=>Ud,Line3:()=>Rg,LineBasicMaterial:()=>Id,LineCurve:()=>Sp,LineCurve3:()=>Mp,LineDashedMaterial:()=>Lf,LineLoop:()=>Gd,LinePieces:()=>hy,LineSegments:()=>Hd,LineStrip:()=>uy,LinearEncoding:()=>_o,LinearFilter:()=>oi,LinearInterpolant:()=>kf,LinearMipMapLinearFilter:()=>ci,LinearMipMapNearestFilter:()=>ai,LinearMipmapLinearFilter:()=>li,LinearMipmapNearestFilter:()=>si,LinearToneMapping:()=>zr,Loader:()=>Jf,LoaderUtils:()=>Mm,LoadingManager:()=>Xf,LoopOnce:()=>io,LoopPingPong:()=>so,LoopRepeat:()=>oo,LuminanceAlphaFormat:()=>Si,LuminanceFormat:()=>Ei,MOUSE:()=>jn,Material:()=>Ja,MaterialLoader:()=>Sm,Math:()=>hs,MathUtils:()=>hs,Matrix3:()=>ps,Matrix4:()=>da,MaxEquation:()=>mr,Mesh:()=>Dl,MeshBasicMaterial:()=>Za,MeshDepthMaterial:()=>Ch,MeshDistanceMaterial:()=>Lh,MeshFaceMaterial:()=>my,MeshLambertMaterial:()=>Rf,MeshMatcapMaterial:()=>Cf,MeshNormalMaterial:()=>Af,MeshPhongMaterial:()=>Mf,MeshPhysicalMaterial:()=>Sf,MeshStandardMaterial:()=>Ef,MeshToonMaterial:()=>Tf,MinEquation:()=>fr,MirroredRepeatWrapping:()=>$r,MixOperation:()=>Dr,MultiMaterial:()=>gy,MultiplyBlending:()=>cr,MultiplyOperation:()=>kr,NearestFilter:()=>ei,NearestMipMapLinearFilter:()=>ii,NearestMipMapNearestFilter:()=>ni,NearestMipmapLinearFilter:()=>ri,NearestMipmapNearestFilter:()=>ti,NeverDepth:()=>Ar,NeverStencilFunc:()=>Oo,NoBlending:()=>or,NoColors:()=>dy,NoToneMapping:()=>Ur,NormalAnimationBlendMode:()=>fo,NormalBlending:()=>sr,NotEqualDepth:()=>Nr,NotEqualStencilFunc:()=>Uo,NumberKeyframeTrack:()=>Ff,Object3D:()=>Ba,ObjectLoader:()=>Rm,ObjectSpaceNormalMap:()=>So,OctahedronBufferGeometry:()=>hf,OctahedronGeometry:()=>hf,OneFactor:()=>yr,OneMinusDstAlphaFactor:()=>Er,OneMinusDstColorFactor:()=>Mr,OneMinusSrcAlphaFactor:()=>br,OneMinusSrcColorFactor:()=>_r,OrthographicCamera:()=>fc,PCFShadowMap:()=>Zn,PCFSoftShadowMap:()=>Qn,PMREMGenerator:()=>Rc,ParametricGeometry:()=>Wy,Particle:()=>vy,ParticleBasicMaterial:()=>by,ParticleSystem:()=>_y,ParticleSystemMaterial:()=>xy,Path:()=>Pp,PerspectiveCamera:()=>jl,Plane:()=>Ql,PlaneBufferGeometry:()=>ic,PlaneGeometry:()=>ic,PlaneHelper:()=>ey,PointCloud:()=>yy,PointCloudMaterial:()=>wy,PointLight:()=>ym,PointLightHelper:()=>Dg,Points:()=>Xd,PointsMaterial:()=>Vd,PolarGridHelper:()=>Gg,PolyhedronBufferGeometry:()=>rp,PolyhedronGeometry:()=>rp,PositionalAudio:()=>eg,PropertyBinding:()=>dg,PropertyMixer:()=>ng,QuadraticBezierCurve:()=>Tp,QuadraticBezierCurve3:()=>Ap,Quaternion:()=>Ns,QuaternionKeyframeTrack:()=>Gf,QuaternionLinearInterpolant:()=>Hf,REVISION:()=>Vn,RGBADepthPacking:()=>xo,RGBAFormat:()=>xi,RGBAIntegerFormat:()=>Pi,RGBA_ASTC_10x10_Format:()=>eo,RGBA_ASTC_10x5_Format:()=>Zi,RGBA_ASTC_10x6_Format:()=>Qi,RGBA_ASTC_10x8_Format:()=>$i,RGBA_ASTC_12x10_Format:()=>to,RGBA_ASTC_12x12_Format:()=>no,RGBA_ASTC_4x4_Format:()=>Vi,RGBA_ASTC_5x4_Format:()=>ji,RGBA_ASTC_5x5_Format:()=>Wi,RGBA_ASTC_6x5_Format:()=>qi,RGBA_ASTC_6x6_Format:()=>Ki,RGBA_ASTC_8x5_Format:()=>Xi,RGBA_ASTC_8x6_Format:()=>Yi,RGBA_ASTC_8x8_Format:()=>Ji,RGBA_BPTC_Format:()=>ro,RGBA_ETC2_EAC_Format:()=>Gi,RGBA_PVRTC_2BPPV1_Format:()=>zi,RGBA_PVRTC_4BPPV1_Format:()=>Ui,RGBA_S3TC_DXT1_Format:()=>Oi,RGBA_S3TC_DXT3_Format:()=>Ni,RGBA_S3TC_DXT5_Format:()=>ki,RGB_ETC1_Format:()=>Fi,RGB_ETC2_Format:()=>Hi,RGB_PVRTC_2BPPV1_Format:()=>Bi,RGB_PVRTC_4BPPV1_Format:()=>Di,RGB_S3TC_DXT1_Format:()=>Ii,RGFormat:()=>Ci,RGIntegerFormat:()=>Li,RawShaderMaterial:()=>mc,Ray:()=>ha,Raycaster:()=>_g,RectAreaLight:()=>bm,RedFormat:()=>Ai,RedIntegerFormat:()=>Ri,ReinhardToneMapping:()=>Fr,RepeatWrapping:()=>Zr,ReplaceStencilOp:()=>Ao,ReverseSubtractEquation:()=>pr,RingBufferGeometry:()=>df,RingGeometry:()=>df,Scene:()=>qh,SceneUtils:()=>Vy,ShaderChunk:()=>oc,ShaderLib:()=>ac,ShaderMaterial:()=>Gl,ShadowMaterial:()=>xf,Shape:()=>Ip,ShapeBufferGeometry:()=>pf,ShapeGeometry:()=>pf,ShapePath:()=>sy,ShapeUtils:()=>rf,ShortType:()=>di,Skeleton:()=>Md,SkeletonHelper:()=>Ng,SkinnedMesh:()=>wd,SmoothShading:()=>ir,Sphere:()=>ra,SphereBufferGeometry:()=>ff,SphereGeometry:()=>ff,Spherical:()=>xg,SphericalHarmonics3:()=>xm,SplineCurve:()=>Rp,SpotLight:()=>dm,SpotLightHelper:()=>Lg,Sprite:()=>ud,SpriteMaterial:()=>Jh,SrcAlphaFactor:()=>wr,SrcAlphaSaturateFactor:()=>Tr,SrcColorFactor:()=>vr,StaticCopyUsage:()=>Ko,StaticDrawUsage:()=>Ho,StaticReadUsage:()=>jo,StereoCamera:()=>Hm,StreamCopyUsage:()=>Yo,StreamDrawUsage:()=>Vo,StreamReadUsage:()=>qo,StringKeyframeTrack:()=>Vf,SubtractEquation:()=>dr,SubtractiveBlending:()=>lr,TOUCH:()=>Wn,TangentSpaceNormalMap:()=>Eo,TetrahedronBufferGeometry:()=>mf,TetrahedronGeometry:()=>mf,TextGeometry:()=>qy,Texture:()=>Rs,TextureLoader:()=>im,TorusBufferGeometry:()=>gf,TorusGeometry:()=>gf,TorusKnotBufferGeometry:()=>yf,TorusKnotGeometry:()=>yf,Triangle:()=>Xa,TriangleFanDrawMode:()=>vo,TriangleStripDrawMode:()=>yo,TrianglesDrawMode:()=>go,TubeBufferGeometry:()=>vf,TubeGeometry:()=>vf,UVMapping:()=>jr,Uint16Attribute:()=>Cy,Uint16BufferAttribute:()=>ol,Uint32Attribute:()=>Py,Uint32BufferAttribute:()=>al,Uint8Attribute:()=>Ty,Uint8BufferAttribute:()=>nl,Uint8ClampedAttribute:()=>Ay,Uint8ClampedBufferAttribute:()=>rl,Uniform:()=>gg,UniformsLib:()=>sc,UniformsUtils:()=>Hl,UnsignedByteType:()=>ui,UnsignedInt248Type:()=>wi,UnsignedIntType:()=>mi,UnsignedShort4444Type:()=>vi,UnsignedShort5551Type:()=>_i,UnsignedShortType:()=>pi,VSMShadowMap:()=>$n,Vector2:()=>ds,Vector3:()=>ks,Vector4:()=>Ls,VectorKeyframeTrack:()=>jf,Vertex:()=>Ey,VertexColors:()=>fy,VideoTexture:()=>Jd,WebGL1Renderer:()=>Vh,WebGLCubeRenderTarget:()=>Xl,WebGLMultipleRenderTargets:()=>Is,WebGLMultisampleRenderTarget:()=>Os,WebGLRenderTarget:()=>Ps,WebGLRenderTargetCube:()=>Fy,WebGLRenderer:()=>Gh,WebGLUtils:()=>Nh,WireframeGeometry:()=>_f,WireframeHelper:()=>By,WrapAroundEnding:()=>po,XHRLoader:()=>Uy,ZeroCurvatureEnding:()=>uo,ZeroFactor:()=>gr,ZeroSlopeEnding:()=>ho,ZeroStencilOp:()=>Mo,_SRGBAFormat:()=>Qo,sRGBEncoding:()=>wo});var t={};n.r(t),n.d(t,{jt:()=>rI,TF:()=>sI,dO:()=>uI,ai:()=>aI,ez:()=>QP,m5:()=>tI,cg:()=>nI,sv:()=>lI,xo:()=>eI,DO:()=>hI});const r={"Total ANAVER.SE":{dbut:0,fin:0,dure:"NA"},"Code Barre":{dbut:0,fin:0,dure:"NA"},Identit:{dbut:0,fin:0,dure:"NA"},"Liste des Jetons Natifs":{dbut:0,fin:0,dure:"NA"},"Choix alatoire":{dbut:0,fin:0,dure:"NA"},"Tlchargement premier espace":{dbut:0,fin:0,dure:"NA"},"Cration Monde":{dbut:0,fin:0,dure:"NA"},"Galleries Natives":{dbut:0,fin:0,dure:"NA"},"Galleries OBJKT":{dbut:0,fin:0,dure:"NA"},"Galleries VERSUM":{dbut:0,fin:0,dure:"NA"}};function i(){}function o(e){return null==e?i:function(){return this.querySelector(e)}}function s(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function a(){return[]}function l(e){return null==e?a:function(){return this.querySelectorAll(e)}}function c(e){return function(){return this.matches(e)}}function u(e){return function(t){return t.matches(e)}}window.horlogesLog=()=>{console.log("%cTableau de bord des horloges","font-weight:bold;text-decoration:underline;"),console.log("Toutes les dures sont en millisecondes.");for(const e in r)r[e].fin>0?r[e].dure=r[e].fin-r[e].dbut:r[e].dure="NA";console.table(r)};var h=Array.prototype.find;function d(){return this.firstElementChild}var p=Array.prototype.filter;function f(){return Array.from(this.children)}function m(e){return new Array(e.length)}function g(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function y(e){return function(){return e}}function v(e,t,n,r,i,o){for(var s,a=0,l=t.length,c=o.length;a<c;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new g(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function _(e,t,n,r,i,o,s){var a,l,c,u=new Map,h=t.length,d=o.length,p=new Array(h);for(a=0;a<h;++a)(l=t[a])&&(p[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?i[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(e,o[a],a,o)+"",(l=u.get(c))?(r[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new g(e,o[a]);for(a=0;a<h;++a)(l=t[a])&&u.get(p[a])===l&&(i[a]=l)}function w(e){return e.__data__}function b(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function x(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}g.prototype={constructor:g,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var E="http://www.w3.org/1999/xhtml";const S={svg:"http://www.w3.org/2000/svg",xhtml:E,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function M(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),S.hasOwnProperty(t)?{space:S[t],local:e}:e}function T(e){return function(){this.removeAttribute(e)}}function A(e){return function(){this.removeAttributeNS(e.space,e.local)}}function R(e,t){return function(){this.setAttribute(e,t)}}function C(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function L(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function P(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function I(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function O(e){return function(){this.style.removeProperty(e)}}function N(e,t,n){return function(){this.style.setProperty(e,t,n)}}function k(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function D(e,t){return e.style.getPropertyValue(t)||I(e).getComputedStyle(e,null).getPropertyValue(t)}function B(e){return function(){delete this[e]}}function U(e,t){return function(){this[e]=t}}function z(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function F(e){return e.trim().split(/^|\s+/)}function H(e){return e.classList||new G(e)}function G(e){this._node=e,this._names=F(e.getAttribute("class")||"")}function V(e,t){for(var n=H(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function j(e,t){for(var n=H(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function W(e){return function(){V(this,e)}}function q(e){return function(){j(this,e)}}function K(e,t){return function(){(t.apply(this,arguments)?V:j)(this,e)}}function X(){this.textContent=""}function Y(e){return function(){this.textContent=e}}function J(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Z(){this.innerHTML=""}function Q(e){return function(){this.innerHTML=e}}function $(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ee(){this.nextSibling&&this.parentNode.appendChild(this)}function te(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ne(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===E&&t.documentElement.namespaceURI===E?t.createElement(e):t.createElementNS(n,e)}}function re(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ie(e){var t=M(e);return(t.local?re:ne)(t)}function oe(){return null}function se(){var e=this.parentNode;e&&e.removeChild(this)}function ae(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function le(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ce(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ue(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function he(e,t,n){return function(){var r,i=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=t);this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function de(e,t,n){var r=I(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function pe(e,t){return function(){return de(this,e,t)}}function fe(e,t){return function(){return de(this,e,t.apply(this,arguments))}}G.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var me=[null];function ge(e,t){this._groups=e,this._parents=t}function ye(){return new ge([[document.documentElement]],me)}ge.prototype=ye.prototype={constructor:ge,select:function(e){"function"!=typeof e&&(e=o(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s,a,l=t[i],c=l.length,u=r[i]=new Array(c),h=0;h<c;++h)(s=l[h])&&(a=e.call(s,s.__data__,h,l))&&("__data__"in s&&(a.__data__=s.__data__),u[h]=a);return new ge(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return s(e.apply(this,arguments))}}(e):l(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,c=t[o],u=c.length,h=0;h<u;++h)(a=c[h])&&(r.push(e.call(a,a.__data__,h,c)),i.push(a));return new ge(r,i)},selectChild:function(e){return this.select(null==e?d:function(e){return function(){return h.call(this.children,e)}}("function"==typeof e?e:u(e)))},selectChildren:function(e){return this.selectAll(null==e?f:function(e){return function(){return p.call(this.children,e)}}("function"==typeof e?e:u(e)))},filter:function(e){"function"!=typeof e&&(e=c(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&e.call(o,o.__data__,u,s)&&l.push(o);return new ge(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,w);var n=t?_:v,r=this._parents,i=this._groups;"function"!=typeof e&&(e=y(e));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],h=i[c],d=h.length,p=b(e.call(u,u&&u.__data__,c,r)),f=p.length,m=a[c]=new Array(f),g=s[c]=new Array(f),x=l[c]=new Array(d);n(u,h,m,g,x,p,t);for(var E,S,M=0,T=0;M<f;++M)if(E=m[M]){for(M>=T&&(T=M+1);!(S=g[T])&&++T<f;);E._next=S||null}}return(s=new ge(s,r))._enter=a,s._exit=l,s},enter:function(){return new ge(this._enter||this._groups.map(m),this._parents)},exit:function(){return new ge(this._exit||this._groups.map(m),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c,u=n[l],h=r[l],d=u.length,p=a[l]=new Array(d),f=0;f<d;++f)(c=u[f]||h[f])&&(p[f]=c);for(;l<i;++l)a[l]=n[l];return new ge(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=x);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new ge(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],s=0,a=o.length;s<a;++s)(i=o[s])&&e.call(i,i.__data__,s,o);return this},attr:function(e,t){var n=M(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?A:T:"function"==typeof t?n.local?P:L:n.local?C:R)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?O:"function"==typeof t?k:N)(e,t,null==n?"":n)):D(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?B:"function"==typeof t?z:U)(e,t)):this.node()[e]},classed:function(e,t){var n=F(e+"");if(arguments.length<2){for(var r=H(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?K:t?W:q)(n,t))},text:function(e){return arguments.length?this.each(null==e?X:("function"==typeof e?J:Y)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Z:("function"==typeof e?$:Q)(e)):this.node().innerHTML},raise:function(){return this.each(ee)},lower:function(){return this.each(te)},append:function(e){var t="function"==typeof e?e:ie(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:ie(e),r=null==t?oe:"function"==typeof t?t:o(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(se)},clone:function(e){return this.select(e?le:ae)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=ce(e+""),s=o.length;if(!(arguments.length<2)){for(a=t?he:ue,r=0;r<s;++r)this.each(a(o[r],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?fe:pe)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};const ve=ye;var _e={value:()=>{}};function we(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new be(r)}function be(e){this._=e}function xe(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function Ee(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function Se(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=_e,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}be.prototype=we.prototype={constructor:be,on:function(e,t){var n,r=this._,i=xe(e+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=i[o]).type)r[n]=Se(r[n],e.name,t);else if(null==t)for(n in r)r[n]=Se(r[n],e.name,null);return this}for(;++o<s;)if((n=(e=i[o]).type)&&(n=Ee(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new be(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};const Me=we;var Te,Ae,Re=0,Ce=0,Le=0,Pe=0,Ie=0,Oe=0,Ne="object"==typeof performance&&performance.now?performance:Date,ke="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function De(){return Ie||(ke(Be),Ie=Ne.now()+Oe)}function Be(){Ie=0}function Ue(){this._call=this._time=this._next=null}function ze(e,t,n){var r=new Ue;return r.restart(e,t,n),r}function Fe(){Ie=(Pe=Ne.now())+Oe,Re=Ce=0;try{!function(){De(),++Re;for(var e,t=Te;t;)(e=Ie-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Re}()}finally{Re=0,function(){for(var e,t,n=Te,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Te=t);Ae=e,Ge(r)}(),Ie=0}}function He(){var e=Ne.now(),t=e-Pe;t>1e3&&(Oe-=t,Pe=e)}function Ge(e){Re||(Ce&&(Ce=clearTimeout(Ce)),e-Ie>24?(e<1/0&&(Ce=setTimeout(Fe,e-Ne.now()-Oe)),Le&&(Le=clearInterval(Le))):(Le||(Pe=Ne.now(),Le=setInterval(He,1e3)),Re=1,ke(Fe)))}function Ve(e,t,n){var r=new Ue;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}Ue.prototype=ze.prototype={constructor:Ue,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?De():+n)+(null==t?0:+t),this._next||Ae===this||(Ae?Ae._next=this:Te=this,Ae=this),this._call=e,this._time=n,Ge()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ge())}};var je=Me("start","end","cancel","interrupt"),We=[];function qe(e,t,n,r,i,o){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(l){var c,u,h,d;if(1!==n.state)return a();for(c in i)if((d=i[c]).name===n.name){if(3===d.state)return Ve(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[c]):+c<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete i[c])}if(Ve((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=ze((function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:i,on:je,tween:We,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function Ke(e,t){var n=Ye(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Xe(e,t){var n=Ye(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Ye(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Je(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Ze,Qe=180/Math.PI,$e={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function et(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Qe,skewX:Math.atan(l)*Qe,scaleX:s,scaleY:a}}function tt(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],l=[];return o=e(o),s=e(s),function(e,r,i,o,s,a){if(e!==i||r!==o){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:Je(e,i)},{i:l-2,x:Je(r,o)})}else(i||o)&&s.push("translate("+i+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Je(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,s.rotate,a,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Je(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,s.skewX,a,l),function(e,t,n,r,o,s){if(e!==n||t!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:Je(e,n)},{i:a-2,x:Je(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(e){for(var t,n=-1,r=l.length;++n<r;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var nt=tt((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?$e:et(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),rt=tt((function(e){return null==e?$e:(Ze||(Ze=document.createElementNS("http://www.w3.org/2000/svg","g")),Ze.setAttribute("transform",e),(e=Ze.transform.baseVal.consolidate())?et((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):$e)}),", ",")",")");function it(e,t){var n,r;return function(){var i=Xe(this,e),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===t){(r=r.slice()).splice(s,1);break}i.tween=r}}function ot(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Xe(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function st(e,t,n){var r=e._id;return e.each((function(){var e=Xe(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Ye(e,r).value[t]}}function at(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function lt(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ct(){}var ut=.7,ht=1/ut,dt="\\s*([+-]?\\d+)\\s*",pt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ft="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mt=/^#([0-9a-f]{3,8})$/,gt=new RegExp("^rgb\\("+[dt,dt,dt]+"\\)$"),yt=new RegExp("^rgb\\("+[ft,ft,ft]+"\\)$"),vt=new RegExp("^rgba\\("+[dt,dt,dt,pt]+"\\)$"),_t=new RegExp("^rgba\\("+[ft,ft,ft,pt]+"\\)$"),wt=new RegExp("^hsl\\("+[pt,ft,ft]+"\\)$"),bt=new RegExp("^hsla\\("+[pt,ft,ft,pt]+"\\)$"),xt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Et(){return this.rgb().formatHex()}function St(){return this.rgb().formatRgb()}function Mt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=mt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Tt(t):3===n?new Lt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?At(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?At(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=gt.exec(e))?new Lt(t[1],t[2],t[3],1):(t=yt.exec(e))?new Lt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=vt.exec(e))?At(t[1],t[2],t[3],t[4]):(t=_t.exec(e))?At(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=wt.exec(e))?Nt(t[1],t[2]/100,t[3]/100,1):(t=bt.exec(e))?Nt(t[1],t[2]/100,t[3]/100,t[4]):xt.hasOwnProperty(e)?Tt(xt[e]):"transparent"===e?new Lt(NaN,NaN,NaN,0):null}function Tt(e){return new Lt(e>>16&255,e>>8&255,255&e,1)}function At(e,t,n,r){return r<=0&&(e=t=n=NaN),new Lt(e,t,n,r)}function Rt(e){return e instanceof ct||(e=Mt(e)),e?new Lt((e=e.rgb()).r,e.g,e.b,e.opacity):new Lt}function Ct(e,t,n,r){return 1===arguments.length?Rt(e):new Lt(e,t,n,null==r?1:r)}function Lt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Pt(){return"#"+Ot(this.r)+Ot(this.g)+Ot(this.b)}function It(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Ot(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Nt(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Dt(e,t,n,r)}function kt(e){if(e instanceof Dt)return new Dt(e.h,e.s,e.l,e.opacity);if(e instanceof ct||(e=Mt(e)),!e)return new Dt;if(e instanceof Dt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=t===o?(n-r)/a+6*(n<r):n===o?(r-t)/a+2:(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new Dt(s,a,l,e.opacity)}function Dt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Bt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Ut(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}at(ct,Mt,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Et,formatHex:Et,formatHsl:function(){return kt(this).formatHsl()},formatRgb:St,toString:St}),at(Lt,Ct,lt(ct,{brighter:function(e){return e=null==e?ht:Math.pow(ht,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?ut:Math.pow(ut,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pt,formatHex:Pt,formatRgb:It,toString:It})),at(Dt,(function(e,t,n,r){return 1===arguments.length?kt(e):new Dt(e,t,n,null==r?1:r)}),lt(ct,{brighter:function(e){return e=null==e?ht:Math.pow(ht,e),new Dt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?ut:Math.pow(ut,e),new Dt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Lt(Bt(e>=240?e-240:e+120,i,r),Bt(e,i,r),Bt(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const zt=e=>()=>e;function Ft(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):zt(isNaN(e)?t:e)}const Ht=function e(t){var n=function(e){return 1==(e=+e)?Ft:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):zt(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=Ct(e)).r,(t=Ct(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),s=Ft(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function Gt(e){return function(t){var n,r,i=t.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=Ct(t[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=e(o),s=e(s),a=e(a),r.opacity=1,function(e){return r.r=o(e),r.g=s(e),r.b=a(e),r+""}}}Gt((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return Ut((n-r/t)*t,s,i,o,a)}})),Gt((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return Ut((n-r/t)*t,i,o,s,a)}}));var Vt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jt=new RegExp(Vt.source,"g");function Wt(e,t){var n,r,i,o=Vt.lastIndex=jt.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=Vt.exec(e))&&(r=jt.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Je(n,r)})),o=jt.lastIndex;return o<t.length&&(i=t.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)a[(n=l[r]).i]=n.x(e);return a.join("")})}function qt(e,t){var n;return("number"==typeof t?Je:t instanceof Mt?Ht:(n=Mt(t))?(t=n,Ht):Wt)(e,t)}function Kt(e){return function(){this.removeAttribute(e)}}function Xt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Yt(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Jt(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function Zt(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttribute(e)}}function Qt(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttributeNS(e.space,e.local)}}function $t(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function en(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function tn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&en(e,i)),n}return i._value=t,i}function nn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&$t(e,i)),n}return i._value=t,i}function rn(e,t){return function(){Ke(this,e).delay=+t.apply(this,arguments)}}function on(e,t){return t=+t,function(){Ke(this,e).delay=t}}function sn(e,t){return function(){Xe(this,e).duration=+t.apply(this,arguments)}}function an(e,t){return t=+t,function(){Xe(this,e).duration=t}}function ln(e,t){if("function"!=typeof t)throw new Error;return function(){Xe(this,e).ease=t}}function cn(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Ke:Xe;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}var un=ve.prototype.constructor;function hn(e){return function(){this.style.removeProperty(e)}}function dn(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function pn(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&dn(e,o,n)),r}return o._value=t,o}function fn(e){return function(t){this.textContent=e.call(this,t)}}function mn(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&fn(r)),t}return r._value=e,r}var gn=0;function yn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function vn(){return++gn}var _n=ve.prototype;yn.prototype=function(e){return ve().transition(e)}.prototype={constructor:yn,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=o(e));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var l,c,u=r[a],h=u.length,d=s[a]=new Array(h),p=0;p<h;++p)(l=u[p])&&(c=e.call(l,l.__data__,p,u))&&("__data__"in l&&(c.__data__=l.__data__),d[p]=c,qe(d[p],t,n,p,d,Ye(l,n)));return new yn(s,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=l(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var c,u=r[a],h=u.length,d=0;d<h;++d)if(c=u[d]){for(var p,f=e.call(c,c.__data__,d,u),m=Ye(c,n),g=0,y=f.length;g<y;++g)(p=f[g])&&qe(p,t,n,g,f,m);o.push(f),s.push(c)}return new yn(o,s,t,n)},selectChild:_n.selectChild,selectChildren:_n.selectChildren,filter:function(e){"function"!=typeof e&&(e=c(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&e.call(o,o.__data__,u,s)&&l.push(o);return new yn(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,c=t[a],u=n[a],h=c.length,d=s[a]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;a<r;++a)s[a]=t[a];return new yn(s,this._parents,this._name,this._id)},selection:function(){return new un(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=vn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=Ye(s,t);qe(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new yn(r,this._parents,e,n)},call:_n.call,nodes:_n.nodes,node:_n.node,size:_n.size,empty:_n.empty,each:_n.each,on:function(e,t){var n=this._id;return arguments.length<2?Ye(this.node(),n).on.on(e):this.each(cn(n,e,t))},attr:function(e,t){var n=M(e),r="transform"===n?rt:qt;return this.attrTween(e,"function"==typeof t?(n.local?Qt:Zt)(n,r,st(this,"attr."+e,t)):null==t?(n.local?Xt:Kt)(n):(n.local?Jt:Yt)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=M(e);return this.tween(n,(r.local?tn:nn)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?nt:qt;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=D(this,e),s=(this.style.removeProperty(e),D(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}(e,r)).on("end.style."+e,hn(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var s=D(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=D(this,e)),s===l?null:s===r&&l===i?o:(i=l,o=t(r=s,a))}}(e,r,st(this,"style."+e,t))).each(function(e,t){var n,r,i,o,s="style."+t,a="end."+s;return function(){var l=Xe(this,e),c=l.on,u=null==l.value[s]?o||(o=hn(t)):void 0;c===n&&i===u||(r=(n=c).copy()).on(a,i=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var s=D(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,pn(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(st(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,mn(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=Ye(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?it:ot)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?rn:on)(t,e)):Ye(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?sn:an)(t,e)):Ye(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(ln(t,e)):Ye(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;Xe(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=Xe(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t})),0===i&&o()}))},[Symbol.iterator]:_n[Symbol.iterator]};var wn={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function bn(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}ve.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,o=e.__transition,s=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete e.__transition}}(this,e)}))},ve.prototype.transition=function(e){var t,n;e instanceof yn?(t=e._id,e=e._name):(t=vn(),(n=wn).time=De(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)(s=a[c])&&qe(s,e,t,c,a,n||bn(s,t));return new yn(r,this._parents,e,t)};const{abs:xn,max:En,min:Sn}=Math;function Mn(e){return{type:e}}function Tn(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}["w","e"].map(Mn),["n","s"].map(Mn),["n","w","e","s","nw","ne","sw","se"].map(Mn);var An,Rn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cn(e){if(!(t=Rn.exec(e)))throw new Error("invalid format: "+e);var t;return new Ln({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Ln(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Pn(e,t){var n=Tn(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Cn.prototype=Ln.prototype,Ln.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const In={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Pn(100*e,t),r:Pn,s:function(e,t){var n=Tn(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(An=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Tn(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function On(e){return e}var Nn,kn,Dn=Array.prototype.map,Bn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Un(e){return Nn=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?On:(t=Dn.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],s=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(e.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?On:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Dn.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Cn(e)).fill,n=e.align,h=e.sign,d=e.symbol,p=e.zero,f=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):In[v]||(void 0===g&&(g=12),y=!0,v="g"),(p||"0"===t&&"="===n)&&(p=!0,t="0",n="=");var _="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o:/[%p]/.test(v)?l:"",b=In[v],x=/[defgprs%]/.test(v);function E(e){var i,o,l,d=_,E=w;if("c"===v)E=b(e)+E,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:b(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==h&&(S=!1),d=(S?"("===h?h:c:"-"===h||"("===h?"":h)+d,E=("s"===v?Bn[8+An/3]:"")+E+(S&&"("===h?")":""),x)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){E=(46===l?s+e.slice(i+1):e.slice(i))+E,e=e.slice(0,i);break}}m&&!p&&(e=r(e,1/0));var M=d.length+e.length+E.length,T=M<f?new Array(f-M+1).join(t):"";switch(m&&p&&(e=r(T+e,T.length?f-E.length:1/0),T=""),n){case"<":e=d+e+E+T;break;case"=":e=d+T+e+E;break;case"^":e=T.slice(0,M=T.length>>1)+d+e+E+T.slice(M);break;default:e=T+d+e+E}return a(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),E.toString=function(){return e+""},E}return{format:h,formatPrefix:function(e,t){var n,r=h(((e=Cn(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor((n=t,((n=Tn(Math.abs(n)))?n[1]:NaN)/3)))),o=Math.pow(10,-i),s=Bn[8+i/3];return function(e){return r(o*e)+s}}}}(e),kn=Nn.format,Nn.formatPrefix,Nn}function zn(e){return"string"==typeof e?new ge([[document.querySelector(e)]],[document.documentElement]):new ge([[e]],me)}function Fn(e){return zn(ie(e).call(document.documentElement))}function Hn(e,t,n){this.k=e,this.x=t,this.y=n}Un({thousands:",",grouping:[3],currency:["$",""]}),Hn.prototype={constructor:Hn,scale:function(e){return 1===e?this:new Hn(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Hn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Hn(1,0,0),Hn.prototype;const Gn=[];for(let e=0;e<25;e++)Gn.push(parseInt(4*Math.random()));const Vn="137",jn={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Wn={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},qn=0,Kn=1,Xn=2,Yn=3,Jn=0,Zn=1,Qn=2,$n=3,er=0,tr=1,nr=2,rr=1,ir=2,or=0,sr=1,ar=2,lr=3,cr=4,ur=5,hr=100,dr=101,pr=102,fr=103,mr=104,gr=200,yr=201,vr=202,_r=203,wr=204,br=205,xr=206,Er=207,Sr=208,Mr=209,Tr=210,Ar=0,Rr=1,Cr=2,Lr=3,Pr=4,Ir=5,Or=6,Nr=7,kr=0,Dr=1,Br=2,Ur=0,zr=1,Fr=2,Hr=3,Gr=4,Vr=5,jr=300,Wr=301,qr=302,Kr=303,Xr=304,Yr=306,Jr=307,Zr=1e3,Qr=1001,$r=1002,ei=1003,ti=1004,ni=1004,ri=1005,ii=1005,oi=1006,si=1007,ai=1007,li=1008,ci=1008,ui=1009,hi=1010,di=1011,pi=1012,fi=1013,mi=1014,gi=1015,yi=1016,vi=1017,_i=1018,wi=1020,bi=1021,xi=1023,Ei=1024,Si=1025,Mi=1026,Ti=1027,Ai=1028,Ri=1029,Ci=1030,Li=1031,Pi=1033,Ii=33776,Oi=33777,Ni=33778,ki=33779,Di=35840,Bi=35841,Ui=35842,zi=35843,Fi=36196,Hi=37492,Gi=37496,Vi=37808,ji=37809,Wi=37810,qi=37811,Ki=37812,Xi=37813,Yi=37814,Ji=37815,Zi=37816,Qi=37817,$i=37818,eo=37819,to=37820,no=37821,ro=36492,io=2200,oo=2201,so=2202,ao=2300,lo=2301,co=2302,uo=2400,ho=2401,po=2402,fo=2500,mo=2501,go=0,yo=1,vo=2,_o=3e3,wo=3001,bo=3200,xo=3201,Eo=0,So=1,Mo=0,To=7680,Ao=7681,Ro=7682,Co=7683,Lo=34055,Po=34056,Io=5386,Oo=512,No=513,ko=514,Do=515,Bo=516,Uo=517,zo=518,Fo=519,Ho=35044,Go=35048,Vo=35040,jo=35045,Wo=35049,qo=35041,Ko=35046,Xo=35050,Yo=35042,Jo="100",Zo="300 es",Qo=1035;class $o{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const es=[];for(let e=0;e<256;e++)es[e]=(e<16?"0":"")+e.toString(16);let ts=1234567;const ns=Math.PI/180,rs=180/Math.PI;function is(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(es[255&e]+es[e>>8&255]+es[e>>16&255]+es[e>>24&255]+"-"+es[255&t]+es[t>>8&255]+"-"+es[t>>16&15|64]+es[t>>24&255]+"-"+es[63&n|128]+es[n>>8&255]+"-"+es[n>>16&255]+es[n>>24&255]+es[255&r]+es[r>>8&255]+es[r>>16&255]+es[r>>24&255]).toUpperCase()}function os(e,t,n){return Math.max(t,Math.min(n,e))}function ss(e,t){return(e%t+t)%t}function as(e,t,n){return(1-n)*e+n*t}function ls(e){return 0==(e&e-1)&&0!==e}function cs(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function us(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var hs=Object.freeze({__proto__:null,DEG2RAD:ns,RAD2DEG:rs,generateUUID:is,clamp:os,euclideanModulo:ss,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:as,damp:function(e,t,n,r){return as(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(ss(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(ts=e%2147483647),ts=16807*ts%2147483647,(ts-1)/2147483646},degToRad:function(e){return e*ns},radToDeg:function(e){return e*rs},isPowerOfTwo:ls,ceilPowerOfTwo:cs,floorPowerOfTwo:us,setQuaternionFromProperEuler:function(e,t,n,r,i){const o=Math.cos,s=Math.sin,a=o(n/2),l=s(n/2),c=o((t+r)/2),u=s((t+r)/2),h=o((t-r)/2),d=s((t-r)/2),p=o((r-t)/2),f=s((r-t)/2);switch(i){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*f,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*f,a*c);break;case"ZYZ":e.set(l*f,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}});class ds{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}ds.prototype.isVector2=!0;class ps{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,i,o,s,a,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=i,c[5]=a,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],g=r[6],y=r[1],v=r[4],_=r[7],w=r[2],b=r[5],x=r[8];return i[0]=o*f+s*y+a*w,i[3]=o*m+s*v+a*b,i[6]=o*g+s*_+a*x,i[1]=l*f+c*y+u*w,i[4]=l*m+c*v+u*b,i[7]=l*g+c*_+u*x,i[2]=h*f+d*y+p*w,i[5]=h*m+d*v+p*b,i[8]=h*g+d*_+p*x,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*o*c-t*s*l-n*i*c+n*s*a+r*i*l-r*o*a}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=c*o-s*l,h=s*a-c*i,d=l*i-o*a,p=t*u+n*h+r*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(r*l-c*n)*f,e[2]=(s*n-r*o)*f,e[3]=h*f,e[4]=(c*t-r*a)*f,e[5]=(r*i-s*t)*f,e[6]=d*f,e[7]=(n*a-l*t)*f,e[8]=(o*t-n*i)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,o,s){const a=Math.cos(i),l=Math.sin(i);return this.set(n*a,n*l,-n*(a*o+l*s)+o+e,-r*l,r*a,-r*(-l*o+a*s)+s+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],s=r[6],a=r[1],l=r[4],c=r[7];return r[0]=t*i+n*a,r[3]=t*o+n*l,r[6]=t*s+n*c,r[1]=-n*i+t*a,r[4]=-n*o+t*l,r[7]=-n*s+t*c,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function fs(e){for(let t=e.length-1;t>=0;--t)if(e[t]>65535)return!0;return!1}ps.prototype.isMatrix3=!0;const ms={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function gs(e,t){return new ms[e](t)}function ys(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}const vs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_s={h:0,s:0,l:0},ws={h:0,s:0,l:0};function bs(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function xs(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Es(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class Ss{constructor(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,n){return this.r=e,this.g=t,this.b=n,this}setHSL(e,t,n){if(e=ss(e,1),t=os(t,0,1),n=os(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=bs(i,r,e+1/3),this.g=bs(i,r,e),this.b=bs(i,r,e-1/3)}return this}setStyle(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;const r=n[1],i=n[2];switch(r){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){const n=parseFloat(e[1])/360,r=parseInt(e[2],10)/100,i=parseInt(e[3],10)/100;return t(e[4]),this.setHSL(n,r,i)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=n[1],t=e.length;if(3===t)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===t)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=vs[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xs(e.r),this.g=xs(e.g),this.b=xs(e.b),this}copyLinearToSRGB(e){return this.r=Es(e.r),this.g=Es(e.g),this.b=Es(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const t=this.r,n=this.g,r=this.b,i=Math.max(t,n,r),o=Math.min(t,n,r);let s,a;const l=(o+i)/2;if(o===i)s=0,a=0;else{const e=i-o;switch(a=l<=.5?e/(i+o):e/(2-i-o),i){case t:s=(n-r)/e+(n<r?6:0);break;case n:s=(r-t)/e+2;break;case r:s=(t-n)/e+4}s/=6}return e.h=s,e.s=a,e.l=l,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,n){return this.getHSL(_s),_s.h+=e,_s.s+=t,_s.l+=n,this.setHSL(_s.h,_s.s,_s.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(_s),e.getHSL(ws);const n=as(_s.h,ws.h,t),r=as(_s.s,ws.s,t),i=as(_s.l,ws.l,t);return this.setHSL(n,r,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}let Ms;Ss.NAMES=vs,Ss.prototype.isColor=!0,Ss.prototype.r=1,Ss.prototype.g=1,Ss.prototype.b=1;class Ts{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ms&&(Ms=ys("canvas")),Ms.width=e.width,Ms.height=e.height;const n=Ms.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ms}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=ys("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*xs(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*xs(t[e]/255)):t[e]=xs(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let As=0;class Rs extends $o{constructor(e=Rs.DEFAULT_IMAGE,t=Rs.DEFAULT_MAPPING,n=Qr,r=Qr,i=oi,o=li,s=xi,a=ui,l=1,c=_o){super(),Object.defineProperty(this,"id",{value:As++}),this.uuid=is(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=a,this.offset=new ds(0,0),this.repeat=new ds(1,1),this.center=new ds(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ps,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const r=this.image;if(void 0===r.uuid&&(r.uuid=is()),!t&&void 0===e.images[r.uuid]){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(Cs(r[e].image)):t.push(Cs(r[e]))}else t=Cs(r);e.images[r.uuid]={uuid:r.uuid,url:t}}n.image=r.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==jr)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Zr:e.x=e.x-Math.floor(e.x);break;case Qr:e.x=e.x<0?0:1;break;case $r:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Zr:e.y=e.y-Math.floor(e.y);break;case Qr:e.y=e.y<0?0:1;break;case $r:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function Cs(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?Ts.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Rs.DEFAULT_IMAGE=void 0,Rs.DEFAULT_MAPPING=jr,Rs.prototype.isTexture=!0;class Ls{constructor(e=0,t=0,n=0,r=1){this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const o=.01,s=.1,a=e.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<o&&Math.abs(u-f)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<s&&Math.abs(u+f)<s&&Math.abs(p+m)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(d+1)/2,y=(g+1)/2,v=(c+h)/4,_=(u+f)/4,w=(p+m)/4;return e>a&&e>y?e<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=v/n,i=_/n):a>y?a<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(a),n=v/r,i=w/r):y<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(y),n=_/i,r=w/i),this.set(n,r,i,t),this}let y=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(u-f)/y,this.z=(h-c)/y,this.w=Math.acos((l+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Ls.prototype.isVector4=!0;class Ps extends $o{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Ls(0,0,e,t),this.scissorTest=!1,this.viewport=new Ls(0,0,e,t),this.texture=new Rs(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:oi,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Ps.prototype.isWebGLRenderTarget=!0;class Is extends Ps{constructor(e,t,n){super(e,t);const r=this.texture;this.texture=[];for(let e=0;e<n;e++)this.texture[e]=r.clone()}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}Is.prototype.isWebGLMultipleRenderTargets=!0;class Os extends Ps{constructor(e,t,n={}){super(e,t,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}Os.prototype.isWebGLMultisampleRenderTarget=!0;class Ns{constructor(e=0,t=0,n=0,r=1){this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}static slerpFlat(e,t,n,r,i,o,s){let a=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[o+0],d=i[o+1],p=i[o+2],f=i[o+3];if(0===s)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===s)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||a!==h||l!==d||c!==p){let e=1-s;const t=a*h+l*d+c*p+u*f,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,t*n);e=Math.sin(e*o)/i,s=Math.sin(s*o)/i}const i=s*n;if(a=a*e+h*i,l=l*e+d*i,c=c*e+p*i,u=u*e+f*i,e===1-s){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,o){const s=n[r],a=n[r+1],l=n[r+2],c=n[r+3],u=i[o],h=i[o+1],d=i[o+2],p=i[o+3];return e[t]=s*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-s*d,e[t+2]=l*p+c*d+s*h-a*u,e[t+3]=c*p-s*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,i=e._z,o=e._order,s=Math.cos,a=Math.sin,l=s(n/2),c=s(r/2),u=s(i/2),h=a(n/2),d=a(r/2),p=a(i/2);switch(o){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],s=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=n+s+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(i-l)*e,this._z=(o-r)*e}else if(n>s&&n>u){const e=2*Math.sqrt(1+n-s-u);this._w=(c-a)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(i+l)/e}else if(s>u){const e=2*Math.sqrt(1+s-n-u);this._w=(i-l)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-n-s);this._w=(o-r)/e,this._x=(i+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(os(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,o=e._w,s=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+o*s+r*l-i*a,this._y=r*c+o*a+i*s-n*l,this._z=i*c+o*l+n*a-r*s,this._w=o*c-n*s-r*a-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let s=o*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const a=1-s*s;if(a<=Number.EPSILON){const e=1-t;return this._w=e*o+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,s),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Ns.prototype.isQuaternion=!0;class ks{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Bs.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Bs.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,s=e.z,a=e.w,l=a*t+o*r-s*n,c=a*n+s*t-i*r,u=a*r+i*n-o*t,h=-i*t-o*n-s*r;return this.x=l*a+h*-i+c*-s-u*-o,this.y=c*a+h*-o+u*-i-l*-s,this.z=u*a+h*-s+l*-o-c*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,o=t.x,s=t.y,a=t.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Ds.copy(this).projectOnVector(e),this.sub(Ds)}reflect(e){return this.sub(Ds.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(os(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}ks.prototype.isVector3=!0;const Ds=new ks,Bs=new Ns;class Us{constructor(e=new ks(1/0,1/0,1/0),t=new ks(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=e.length;a<l;a+=3){const l=e[a],c=e[a+1],u=e[a+2];l<t&&(t=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(t,n,r),this.max.set(i,o,s),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=e.count;a<l;a++){const l=e.getX(a),c=e.getY(a),u=e.getZ(a);l<t&&(t=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(t,n,r),this.max.set(i,o,s),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Fs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const t=n.attributes.position;for(let n=0,r=t.count;n<r;n++)Fs.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(Fs)}else null===n.boundingBox&&n.computeBoundingBox(),Hs.copy(n.boundingBox),Hs.applyMatrix4(e.matrixWorld),this.union(Hs);const r=e.children;for(let e=0,n=r.length;e<n;e++)this.expandByObject(r[e],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Fs),Fs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Xs),Ys.subVectors(this.max,Xs),Gs.subVectors(e.a,Xs),Vs.subVectors(e.b,Xs),js.subVectors(e.c,Xs),Ws.subVectors(Vs,Gs),qs.subVectors(js,Vs),Ks.subVectors(Gs,js);let t=[0,-Ws.z,Ws.y,0,-qs.z,qs.y,0,-Ks.z,Ks.y,Ws.z,0,-Ws.x,qs.z,0,-qs.x,Ks.z,0,-Ks.x,-Ws.y,Ws.x,0,-qs.y,qs.x,0,-Ks.y,Ks.x,0];return!!Qs(t,Gs,Vs,js,Ys)&&(t=[1,0,0,0,1,0,0,0,1],!!Qs(t,Gs,Vs,js,Ys)&&(Js.crossVectors(Ws,qs),t=[Js.x,Js.y,Js.z],Qs(t,Gs,Vs,js,Ys)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Fs.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Fs).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(zs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),zs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),zs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),zs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),zs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),zs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),zs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),zs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(zs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Us.prototype.isBox3=!0;const zs=[new ks,new ks,new ks,new ks,new ks,new ks,new ks,new ks],Fs=new ks,Hs=new Us,Gs=new ks,Vs=new ks,js=new ks,Ws=new ks,qs=new ks,Ks=new ks,Xs=new ks,Ys=new ks,Js=new ks,Zs=new ks;function Qs(e,t,n,r,i){for(let o=0,s=e.length-3;o<=s;o+=3){Zs.fromArray(e,o);const s=i.x*Math.abs(Zs.x)+i.y*Math.abs(Zs.y)+i.z*Math.abs(Zs.z),a=t.dot(Zs),l=n.dot(Zs),c=r.dot(Zs);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>s)return!1}return!0}const $s=new Us,ea=new ks,ta=new ks,na=new ks;class ra{constructor(e=new ks,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):$s.setFromPoints(e).getCenter(n);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){na.subVectors(e,this.center);const t=na.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.add(na.multiplyScalar(n/e)),this.radius+=n}return this}union(e){return!0===this.center.equals(e.center)?ta.set(0,0,1).multiplyScalar(e.radius):ta.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(ea.copy(e.center).add(ta)),this.expandByPoint(ea.copy(e.center).sub(ta)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ia=new ks,oa=new ks,sa=new ks,aa=new ks,la=new ks,ca=new ks,ua=new ks;class ha{constructor(e=new ks,t=new ks(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ia)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ia.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ia.copy(this.direction).multiplyScalar(t).add(this.origin),ia.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){oa.copy(e).add(t).multiplyScalar(.5),sa.copy(t).sub(e).normalize(),aa.copy(this.origin).sub(oa);const i=.5*e.distanceTo(t),o=-this.direction.dot(sa),s=aa.dot(this.direction),a=-aa.dot(sa),l=aa.lengthSq(),c=Math.abs(1-o*o);let u,h,d,p;if(c>0)if(u=o*a-s,h=o*s-a,p=i*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+o*h+2*s)+h*(o*u+h+2*a)+l}else h=i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-o*i+s)),h=u>0?-i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+l):(u=Math.max(0,-(o*i+s)),h=u>0?i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l);else h=o>0?-i:i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(sa).multiplyScalar(h).add(oa),d}intersectSphere(e,t){ia.subVectors(e.center,this.origin);const n=ia.dot(this.direction),r=ia.dot(ia)-n*n,i=e.radius*e.radius;if(r>i)return null;const o=Math.sqrt(i-r),s=n-o,a=n+o;return s<0&&a<0?null:s<0?this.at(a,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,o,s,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),u>=0?(s=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(s=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),n>a||s>r?null:((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,ia)}intersectTriangle(e,t,n,r,i){la.subVectors(t,e),ca.subVectors(n,e),ua.crossVectors(la,ca);let o,s=this.direction.dot(ua);if(s>0){if(r)return null;o=1}else{if(!(s<0))return null;o=-1,s=-s}aa.subVectors(this.origin,e);const a=o*this.direction.dot(ca.crossVectors(aa,ca));if(a<0)return null;const l=o*this.direction.dot(la.cross(aa));if(l<0)return null;if(a+l>s)return null;const c=-o*aa.dot(ua);return c<0?null:this.at(c/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class da{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,i,o,s,a,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new da).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/pa.setFromMatrixColumn(e,0).length(),i=1/pa.setFromMatrixColumn(e,1).length(),o=1/pa.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=o*c,n=o*u,r=s*c,i=s*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-s*a,t[2]=i-e*l,t[6]=r+n*l,t[10]=o*a}else if("YXZ"===e.order){const e=a*c,n=a*u,r=l*c,i=l*u;t[0]=e+i*s,t[4]=r*s-n,t[8]=o*l,t[1]=o*u,t[5]=o*c,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=o*a}else if("ZXY"===e.order){const e=a*c,n=a*u,r=l*c,i=l*u;t[0]=e-i*s,t[4]=-o*u,t[8]=r+n*s,t[1]=n+r*s,t[5]=o*c,t[9]=i-e*s,t[2]=-o*l,t[6]=s,t[10]=o*a}else if("ZYX"===e.order){const e=o*c,n=o*u,r=s*c,i=s*u;t[0]=a*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=a*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=s*a,t[10]=o*a}else if("YZX"===e.order){const e=o*a,n=o*l,r=s*a,i=s*l;t[0]=a*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=o*c,t[9]=-s*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=o*a,n=o*l,r=s*a,i=s*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=o*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=s*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ma,e,ga)}lookAt(e,t,n){const r=this.elements;return _a.subVectors(e,t),0===_a.lengthSq()&&(_a.z=1),_a.normalize(),ya.crossVectors(n,_a),0===ya.lengthSq()&&(1===Math.abs(n.z)?_a.x+=1e-4:_a.z+=1e-4,_a.normalize(),ya.crossVectors(n,_a)),ya.normalize(),va.crossVectors(_a,ya),r[0]=ya.x,r[4]=va.x,r[8]=_a.x,r[1]=ya.y,r[5]=va.y,r[9]=_a.y,r[2]=ya.z,r[6]=va.z,r[10]=_a.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],y=n[3],v=n[7],_=n[11],w=n[15],b=r[0],x=r[4],E=r[8],S=r[12],M=r[1],T=r[5],A=r[9],R=r[13],C=r[2],L=r[6],P=r[10],I=r[14],O=r[3],N=r[7],k=r[11],D=r[15];return i[0]=o*b+s*M+a*C+l*O,i[4]=o*x+s*T+a*L+l*N,i[8]=o*E+s*A+a*P+l*k,i[12]=o*S+s*R+a*I+l*D,i[1]=c*b+u*M+h*C+d*O,i[5]=c*x+u*T+h*L+d*N,i[9]=c*E+u*A+h*P+d*k,i[13]=c*S+u*R+h*I+d*D,i[2]=p*b+f*M+m*C+g*O,i[6]=p*x+f*T+m*L+g*N,i[10]=p*E+f*A+m*P+g*k,i[14]=p*S+f*R+m*I+g*D,i[3]=y*b+v*M+_*C+w*O,i[7]=y*x+v*T+_*L+w*N,i[11]=y*E+v*A+_*P+w*k,i[15]=y*S+v*R+_*I+w*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],s=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*a*u-r*l*u-i*s*h+n*l*h+r*s*d-n*a*d)+e[7]*(+t*a*d-t*l*h+i*o*h-r*o*d+r*l*c-i*a*c)+e[11]*(+t*l*u-t*s*d-i*o*u+n*o*d+i*s*c-n*l*c)+e[15]*(-r*s*c-t*a*u+t*s*h+r*o*u-n*o*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],y=u*m*l-f*h*l+f*a*d-s*m*d-u*a*g+s*h*g,v=p*h*l-c*m*l-p*a*d+o*m*d+c*a*g-o*h*g,_=c*f*l-p*u*l+p*s*d-o*f*d-c*s*g+o*u*g,w=p*u*a-c*f*a-p*s*h+o*f*h+c*s*m-o*u*m,b=t*y+n*v+r*_+i*w;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/b;return e[0]=y*x,e[1]=(f*h*i-u*m*i-f*r*d+n*m*d+u*r*g-n*h*g)*x,e[2]=(s*m*i-f*a*i+f*r*l-n*m*l-s*r*g+n*a*g)*x,e[3]=(u*a*i-s*h*i-u*r*l+n*h*l+s*r*d-n*a*d)*x,e[4]=v*x,e[5]=(c*m*i-p*h*i+p*r*d-t*m*d-c*r*g+t*h*g)*x,e[6]=(p*a*i-o*m*i-p*r*l+t*m*l+o*r*g-t*a*g)*x,e[7]=(o*h*i-c*a*i+c*r*l-t*h*l-o*r*d+t*a*d)*x,e[8]=_*x,e[9]=(p*u*i-c*f*i-p*n*d+t*f*d+c*n*g-t*u*g)*x,e[10]=(o*f*i-p*s*i+p*n*l-t*f*l-o*n*g+t*s*g)*x,e[11]=(c*s*i-o*u*i-c*n*l+t*u*l+o*n*d-t*s*d)*x,e[12]=w*x,e[13]=(c*f*r-p*u*r+p*n*h-t*f*h-c*n*m+t*u*m)*x,e[14]=(p*s*r-o*f*r-p*n*a+t*f*a+o*n*m-t*s*m)*x,e[15]=(o*u*r-c*s*r+c*n*a-t*u*a-o*n*h+t*s*h)*x,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,s=e.y,a=e.z,l=i*o,c=i*s;return this.set(l*o+n,l*s-r*a,l*a+r*s,0,l*s+r*a,c*s+n,c*a-r*o,0,l*a-r*s,c*a+r*o,i*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,o=t._y,s=t._z,a=t._w,l=i+i,c=o+o,u=s+s,h=i*l,d=i*c,p=i*u,f=o*c,m=o*u,g=s*u,y=a*l,v=a*c,_=a*u,w=n.x,b=n.y,x=n.z;return r[0]=(1-(f+g))*w,r[1]=(d+_)*w,r[2]=(p-v)*w,r[3]=0,r[4]=(d-_)*b,r[5]=(1-(h+g))*b,r[6]=(m+y)*b,r[7]=0,r[8]=(p+v)*x,r[9]=(m-y)*x,r[10]=(1-(h+f))*x,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=pa.set(r[0],r[1],r[2]).length();const o=pa.set(r[4],r[5],r[6]).length(),s=pa.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],fa.copy(this);const a=1/i,l=1/o,c=1/s;return fa.elements[0]*=a,fa.elements[1]*=a,fa.elements[2]*=a,fa.elements[4]*=l,fa.elements[5]*=l,fa.elements[6]*=l,fa.elements[8]*=c,fa.elements[9]*=c,fa.elements[10]*=c,t.setFromRotationMatrix(fa),n.x=i,n.y=o,n.z=s,this}makePerspective(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const s=this.elements,a=2*i/(t-e),l=2*i/(n-r),c=(t+e)/(t-e),u=(n+r)/(n-r),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return s[0]=a,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(e,t,n,r,i,o){const s=this.elements,a=1/(t-e),l=1/(n-r),c=1/(o-i),u=(t+e)*a,h=(n+r)*l,d=(o+i)*c;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}da.prototype.isMatrix4=!0;const pa=new ks,fa=new da,ma=new ks(0,0,0),ga=new ks(1,1,1),ya=new ks,va=new ks,_a=new ks,wa=new da,ba=new Ns;class xa{constructor(e=0,t=0,n=0,r=xa.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],o=r[4],s=r[8],a=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(os(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-os(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(os(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-os(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(os(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-os(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return wa.makeRotationFromQuaternion(e),this.setFromRotationMatrix(wa,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return ba.setFromEuler(this),this.setFromQuaternion(ba,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new ks(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}xa.prototype.isEuler=!0,xa.DefaultOrder="XYZ",xa.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ea{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Sa=0;const Ma=new ks,Ta=new Ns,Aa=new da,Ra=new ks,Ca=new ks,La=new ks,Pa=new Ns,Ia=new ks(1,0,0),Oa=new ks(0,1,0),Na=new ks(0,0,1),ka={type:"added"},Da={type:"removed"};class Ba extends $o{constructor(){super(),Object.defineProperty(this,"id",{value:Sa++}),this.uuid=is(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ba.DefaultUp.clone();const e=new ks,t=new xa,n=new Ns,r=new ks(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new da},normalMatrix:{value:new ps}}),this.matrix=new da,this.matrixWorld=new da,this.matrixAutoUpdate=Ba.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ea,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ta.setFromAxisAngle(e,t),this.quaternion.multiply(Ta),this}rotateOnWorldAxis(e,t){return Ta.setFromAxisAngle(e,t),this.quaternion.premultiply(Ta),this}rotateX(e){return this.rotateOnAxis(Ia,e)}rotateY(e){return this.rotateOnAxis(Oa,e)}rotateZ(e){return this.rotateOnAxis(Na,e)}translateOnAxis(e,t){return Ma.copy(e).applyQuaternion(this.quaternion),this.position.add(Ma.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ia,e)}translateY(e){return this.translateOnAxis(Oa,e)}translateZ(e){return this.translateOnAxis(Na,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Aa.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Ra.copy(e):Ra.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Ca.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Aa.lookAt(Ca,Ra,this.up):Aa.lookAt(Ra,Ca,this.up),this.quaternion.setFromRotationMatrix(Aa),r&&(Aa.extractRotation(r.matrixWorld),Ta.setFromRotationMatrix(Aa),this.quaternion.premultiply(Ta.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ka)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Da)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Da)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Aa.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Aa.multiply(e.parent.matrixWorld)),e.applyMatrix4(Aa),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ca,e,La),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ca,Pa,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=o(e.geometries),r=o(e.materials),i=o(e.textures),s=o(e.images),a=o(e.shapes),l=o(e.skeletons),c=o(e.animations);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=r,n;function o(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}Ba.DefaultUp=new ks(0,1,0),Ba.DefaultMatrixAutoUpdate=!0,Ba.prototype.isObject3D=!0;const Ua=new ks,za=new ks,Fa=new ks,Ha=new ks,Ga=new ks,Va=new ks,ja=new ks,Wa=new ks,qa=new ks,Ka=new ks;class Xa{constructor(e=new ks,t=new ks,n=new ks){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ua.subVectors(e,t),r.cross(Ua);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Ua.subVectors(r,t),za.subVectors(n,t),Fa.subVectors(e,t);const o=Ua.dot(Ua),s=Ua.dot(za),a=Ua.dot(Fa),l=za.dot(za),c=za.dot(Fa),u=o*l-s*s;if(0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*a-s*c)*h,p=(o*c-s*a)*h;return i.set(1-d-p,p,d)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ha),Ha.x>=0&&Ha.y>=0&&Ha.x+Ha.y<=1}static getUV(e,t,n,r,i,o,s,a){return this.getBarycoord(e,t,n,r,Ha),a.set(0,0),a.addScaledVector(i,Ha.x),a.addScaledVector(o,Ha.y),a.addScaledVector(s,Ha.z),a}static isFrontFacing(e,t,n,r){return Ua.subVectors(n,t),za.subVectors(e,t),Ua.cross(za).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ua.subVectors(this.c,this.b),za.subVectors(this.a,this.b),.5*Ua.cross(za).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Xa.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Xa.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,i){return Xa.getUV(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Xa.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Xa.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let o,s;Ga.subVectors(r,n),Va.subVectors(i,n),Wa.subVectors(e,n);const a=Ga.dot(Wa),l=Va.dot(Wa);if(a<=0&&l<=0)return t.copy(n);qa.subVectors(e,r);const c=Ga.dot(qa),u=Va.dot(qa);if(c>=0&&u<=c)return t.copy(r);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return o=a/(a-c),t.copy(n).addScaledVector(Ga,o);Ka.subVectors(e,i);const d=Ga.dot(Ka),p=Va.dot(Ka);if(p>=0&&d<=p)return t.copy(i);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return s=l/(l-p),t.copy(n).addScaledVector(Va,s);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return ja.subVectors(i,r),s=(u-c)/(u-c+(d-p)),t.copy(r).addScaledVector(ja,s);const g=1/(m+f+h);return o=f*g,s=h*g,t.copy(n).addScaledVector(Ga,o).addScaledVector(Va,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Ya=0;class Ja extends $o{constructor(){super(),Object.defineProperty(this,"id",{value:Ya++}),this.uuid=is(),this.name="",this.type="Material",this.fog=!0,this.blending=sr,this.side=er,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=wr,this.blendDst=br,this.blendEquation=hr,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Lr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Fo,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=To,this.stencilZFail=To,this.stencilZPass=To,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.alphaWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===rr;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==sr&&(n.blending=this.blending),this.side!==er&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.alphaWrite=this.alphaWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.alphaWrite=e.alphaWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Ja.prototype.isMaterial=!0;class Za extends Ja{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Ss(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Za.prototype.isMeshBasicMaterial=!0;const Qa=new ks,$a=new ds;class el{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=Ho,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new Ss),t[n++]=i.r,t[n++]=i.g,t[n++]=i.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new ds),t[n++]=i.x,t[n++]=i.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new ks),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new Ls),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n++]=i.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)$a.fromBufferAttribute(this,t),$a.applyMatrix3(e),this.setXY(t,$a.x,$a.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Qa.fromBufferAttribute(this,t),Qa.applyMatrix3(e),this.setXYZ(t,Qa.x,Qa.y,Qa.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Qa.x=this.getX(t),Qa.y=this.getY(t),Qa.z=this.getZ(t),Qa.applyMatrix4(e),this.setXYZ(t,Qa.x,Qa.y,Qa.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Qa.x=this.getX(t),Qa.y=this.getY(t),Qa.z=this.getZ(t),Qa.applyNormalMatrix(e),this.setXYZ(t,Qa.x,Qa.y,Qa.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Qa.x=this.getX(t),Qa.y=this.getY(t),Qa.z=this.getZ(t),Qa.transformDirection(e),this.setXYZ(t,Qa.x,Qa.y,Qa.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Ho&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}el.prototype.isBufferAttribute=!0;class tl extends el{constructor(e,t,n){super(new Int8Array(e),t,n)}}class nl extends el{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class rl extends el{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class il extends el{constructor(e,t,n){super(new Int16Array(e),t,n)}}class ol extends el{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class sl extends el{constructor(e,t,n){super(new Int32Array(e),t,n)}}class al extends el{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class ll extends el{constructor(e,t,n){super(new Uint16Array(e),t,n)}}ll.prototype.isFloat16BufferAttribute=!0;class cl extends el{constructor(e,t,n){super(new Float32Array(e),t,n)}}class ul extends el{constructor(e,t,n){super(new Float64Array(e),t,n)}}let hl=0;const dl=new da,pl=new Ba,fl=new ks,ml=new Us,gl=new Us,yl=new ks;class vl extends $o{constructor(){super(),Object.defineProperty(this,"id",{value:hl++}),this.uuid=is(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(fs(e)?al:ol)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new ps).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return dl.makeRotationFromQuaternion(e),this.applyMatrix4(dl),this}rotateX(e){return dl.makeRotationX(e),this.applyMatrix4(dl),this}rotateY(e){return dl.makeRotationY(e),this.applyMatrix4(dl),this}rotateZ(e){return dl.makeRotationZ(e),this.applyMatrix4(dl),this}translate(e,t,n){return dl.makeTranslation(e,t,n),this.applyMatrix4(dl),this}scale(e,t,n){return dl.makeScale(e,t,n),this.applyMatrix4(dl),this}lookAt(e){return pl.lookAt(e),pl.updateMatrix(),this.applyMatrix4(pl.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(fl).negate(),this.translate(fl.x,fl.y,fl.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new cl(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Us);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ks(-1/0,-1/0,-1/0),new ks(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];ml.setFromBufferAttribute(n),this.morphTargetsRelative?(yl.addVectors(this.boundingBox.min,ml.min),this.boundingBox.expandByPoint(yl),yl.addVectors(this.boundingBox.max,ml.max),this.boundingBox.expandByPoint(yl)):(this.boundingBox.expandByPoint(ml.min),this.boundingBox.expandByPoint(ml.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ra);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ks,1/0);if(e){const n=this.boundingSphere.center;if(ml.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];gl.setFromBufferAttribute(n),this.morphTargetsRelative?(yl.addVectors(ml.min,gl.min),ml.expandByPoint(yl),yl.addVectors(ml.max,gl.max),ml.expandByPoint(yl)):(ml.expandByPoint(gl.min),ml.expandByPoint(gl.max))}ml.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)yl.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(yl));if(t)for(let i=0,o=t.length;i<o;i++){const o=t[i],s=this.morphTargetsRelative;for(let t=0,i=o.count;t<i;t++)yl.fromBufferAttribute(o,t),s&&(fl.fromBufferAttribute(e,t),yl.add(fl)),r=Math.max(r,n.distanceToSquared(yl))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,i=t.normal.array,o=t.uv.array,s=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new el(new Float32Array(4*s),4));const a=t.tangent.array,l=[],c=[];for(let e=0;e<s;e++)l[e]=new ks,c[e]=new ks;const u=new ks,h=new ks,d=new ks,p=new ds,f=new ds,m=new ds,g=new ks,y=new ks;function v(e,t,n){u.fromArray(r,3*e),h.fromArray(r,3*t),d.fromArray(r,3*n),p.fromArray(o,2*e),f.fromArray(o,2*t),m.fromArray(o,2*n),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const i=1/(f.x*m.y-m.x*f.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(i),y.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[n].add(g),c[e].add(y),c[t].add(y),c[n].add(y))}let _=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(let e=0,t=_.length;e<t;++e){const t=_[e],r=t.start;for(let e=r,i=r+t.count;e<i;e+=3)v(n[e+0],n[e+1],n[e+2])}const w=new ks,b=new ks,x=new ks,E=new ks;function S(e){x.fromArray(i,3*e),E.copy(x);const t=l[e];w.copy(t),w.sub(x.multiplyScalar(x.dot(t))).normalize(),b.crossVectors(E,t);const n=b.dot(c[e])<0?-1:1;a[4*e]=w.x,a[4*e+1]=w.y,a[4*e+2]=w.z,a[4*e+3]=n}for(let e=0,t=_.length;e<t;++e){const t=_[e],r=t.start;for(let e=r,i=r+t.count;e<i;e+=3)S(n[e+0]),S(n[e+1]),S(n[e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new el(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new ks,i=new ks,o=new ks,s=new ks,a=new ks,l=new ks,c=new ks,u=new ks;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,p),o.fromBufferAttribute(t,f),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),s.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),s.add(c),a.add(c),l.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,s=t.count;e<s;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),o.fromBufferAttribute(t,e+2),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const i=n[r].array,o=e.attributes[r],s=o.array,a=o.itemSize*t,l=Math.min(s.length,i.length-a);for(let e=0,t=a;e<l;e++,t++)i[t]=s[e]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)yl.fromBufferAttribute(e,t),yl.normalize(),e.setXYZ(t,yl.x,yl.y,yl.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r);let s=0,a=0;for(let i=0,l=t.length;i<l;i++){s=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*r;for(let e=0;e<r;e++)o[a++]=n[s++]}return new el(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vl,n=this.index.array,r=this.attributes;for(const i in r){const o=e(r[i],n);t.setAttribute(i,o)}const i=this.morphAttributes;for(const r in i){const o=[],s=i[r];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);o.push(r)}t.morphAttributes[r]=o}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let e=0,n=o.length;e<n;e++){const n=o[e];t.addGroup(n.start,n.count,n.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const r=n[t];e.data.attributes[t]=r.toJSON(e.data)}const r={};let i=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],o=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];o.push(r.toJSON(e.data))}o.length>0&&(r[t]=o,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const e in r){const n=r[e];this.setAttribute(e,n.clone(t))}const i=e.morphAttributes;for(const e in i){const n=[],r=i[e];for(let e=0,i=r.length;e<i;e++)n.push(r[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let e=0,t=o.length;e<t;e++){const t=o[e];this.addGroup(t.start,t.count,t.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}vl.prototype.isBufferGeometry=!0;const _l=new da,wl=new ha,bl=new ra,xl=new ks,El=new ks,Sl=new ks,Ml=new ks,Tl=new ks,Al=new ks,Rl=new ks,Cl=new ks,Ll=new ks,Pl=new ds,Il=new ds,Ol=new ds,Nl=new ks,kl=new ks;class Dl extends Ba{constructor(e=new vl,t=new Za){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),bl.copy(n.boundingSphere),bl.applyMatrix4(i),!1===e.ray.intersectsSphere(bl))return;if(_l.copy(i).invert(),wl.copy(e.ray).applyMatrix4(_l),null!==n.boundingBox&&!1===wl.intersectsBox(n.boundingBox))return;let o;if(n.isBufferGeometry){const i=n.index,s=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==i)if(Array.isArray(r))for(let n=0,p=h.length;n<p;n++){const p=h[n],f=r[p.materialIndex];for(let n=Math.max(p.start,d.start),r=Math.min(i.count,Math.min(p.start+p.count,d.start+d.count));n<r;n+=3){const r=i.getX(n),h=i.getX(n+1),d=i.getX(n+2);o=Bl(this,f,e,wl,s,a,l,c,u,r,h,d),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=p.materialIndex,t.push(o))}}else for(let n=Math.max(0,d.start),h=Math.min(i.count,d.start+d.count);n<h;n+=3){const h=i.getX(n),d=i.getX(n+1),p=i.getX(n+2);o=Bl(this,r,e,wl,s,a,l,c,u,h,d,p),o&&(o.faceIndex=Math.floor(n/3),t.push(o))}else if(void 0!==s)if(Array.isArray(r))for(let n=0,i=h.length;n<i;n++){const i=h[n],p=r[i.materialIndex];for(let n=Math.max(i.start,d.start),r=Math.min(s.count,Math.min(i.start+i.count,d.start+d.count));n<r;n+=3)o=Bl(this,p,e,wl,s,a,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=i.materialIndex,t.push(o))}else for(let n=Math.max(0,d.start),i=Math.min(s.count,d.start+d.count);n<i;n+=3)o=Bl(this,r,e,wl,s,a,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),t.push(o))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Bl(e,t,n,r,i,o,s,a,l,c,u,h){xl.fromBufferAttribute(i,c),El.fromBufferAttribute(i,u),Sl.fromBufferAttribute(i,h);const d=e.morphTargetInfluences;if(o&&d){Rl.set(0,0,0),Cl.set(0,0,0),Ll.set(0,0,0);for(let e=0,t=o.length;e<t;e++){const t=d[e],n=o[e];0!==t&&(Ml.fromBufferAttribute(n,c),Tl.fromBufferAttribute(n,u),Al.fromBufferAttribute(n,h),s?(Rl.addScaledVector(Ml,t),Cl.addScaledVector(Tl,t),Ll.addScaledVector(Al,t)):(Rl.addScaledVector(Ml.sub(xl),t),Cl.addScaledVector(Tl.sub(El),t),Ll.addScaledVector(Al.sub(Sl),t)))}xl.add(Rl),El.add(Cl),Sl.add(Ll)}e.isSkinnedMesh&&(e.boneTransform(c,xl),e.boneTransform(u,El),e.boneTransform(h,Sl));const p=function(e,t,n,r,i,o,s,a){let l;if(l=t.side===tr?r.intersectTriangle(s,o,i,!0,a):r.intersectTriangle(i,o,s,t.side!==nr,a),null===l)return null;kl.copy(a),kl.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(kl);return c<n.near||c>n.far?null:{distance:c,point:kl.clone(),object:e}}(e,t,n,r,xl,El,Sl,Nl);if(p){a&&(Pl.fromBufferAttribute(a,c),Il.fromBufferAttribute(a,u),Ol.fromBufferAttribute(a,h),p.uv=Xa.getUV(Nl,xl,El,Sl,Pl,Il,Ol,new ds)),l&&(Pl.fromBufferAttribute(l,c),Il.fromBufferAttribute(l,u),Ol.fromBufferAttribute(l,h),p.uv2=Xa.getUV(Nl,xl,El,Sl,Pl,Il,Ol,new ds));const e={a:c,b:u,c:h,normal:new ks,materialIndex:0};Xa.getNormal(xl,El,Sl,e.normal),p.face=e}return p}Dl.prototype.isMesh=!0;class Ul extends vl{constructor(e=1,t=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const s=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,r,i,o,p,f,m,g,y){const v=o/m,_=p/g,w=o/2,b=p/2,x=f/2,E=m+1,S=g+1;let M=0,T=0;const A=new ks;for(let o=0;o<S;o++){const s=o*_-b;for(let a=0;a<E;a++){const h=a*v-w;A[e]=h*r,A[t]=s*i,A[n]=x,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(a/m),u.push(1-o/g),M+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=h+t+E*e,r=h+t+E*(e+1),i=h+(t+1)+E*(e+1),o=h+(t+1)+E*e;a.push(n,r,o),a.push(r,i,o),T+=6}s.addGroup(d,T,y),d+=T,h+=M}p("z","y","x",-1,-1,n,t,e,o,i,0),p("z","y","x",1,-1,n,t,-e,o,i,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new cl(l,3)),this.setAttribute("normal",new cl(c,3)),this.setAttribute("uv",new cl(u,2))}static fromJSON(e){return new Ul(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function zl(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Fl(e){const t={};for(let n=0;n<e.length;n++){const r=zl(e[n]);for(const e in r)t[e]=r[e]}return t}const Hl={clone:zl,merge:Fl};class Gl extends Ja{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=zl(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}Gl.prototype.isShaderMaterial=!0;class Vl extends Ba{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new da,this.projectionMatrix=new da,this.projectionMatrixInverse=new da}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Vl.prototype.isCamera=!0;class jl extends Vl{constructor(e=50,t=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*rs*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*ns*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*rs*Math.atan(Math.tan(.5*ns*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*ns*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const e=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/e,t-=o.offsetY*n/s,r*=o.width/e,n*=o.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}jl.prototype.isPerspectiveCamera=!0;const Wl=90;class ql extends Ba{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new jl(Wl,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new ks(1,0,0)),this.add(r);const i=new jl(Wl,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new ks(-1,0,0)),this.add(i);const o=new jl(Wl,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new ks(0,1,0)),this.add(o);const s=new jl(Wl,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new ks(0,-1,0)),this.add(s);const a=new jl(Wl,1,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new ks(0,0,1)),this.add(a);const l=new jl(Wl,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new ks(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,o,s,a,l]=this.children,c=e.xr.enabled,u=e.getRenderTarget();e.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,a),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=c,n.texture.needsPMREMUpdate=!0}}class Kl extends Rs{constructor(e,t,n,r,i,o,s,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:Wr,n,r,i,o,s,a,l,c),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Kl.prototype.isCubeTexture=!0;class Xl extends Ps{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),super(e,e,t),t=t||{},this.texture=new Kl(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:oi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=xi,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new Ul(5,5,5),s=new Gl({name:"CubemapFromEquirect",uniforms:zl(n),vertexShader:r,fragmentShader:i,side:tr,blending:or});s.uniforms.tEquirect.value=t;const a=new Dl(o,s),l=t.minFilter;return t.minFilter===li&&(t.minFilter=oi),new ql(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(i)}}Xl.prototype.isWebGLCubeRenderTarget=!0;const Yl=new ks,Jl=new ks,Zl=new ps;class Ql{constructor(e=new ks(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Yl.subVectors(n,t).cross(Jl.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Yl),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Zl.getNormalMatrix(e),r=this.coplanarPoint(Yl).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Ql.prototype.isPlane=!0;const $l=new ra,ec=new ks;class tc{constructor(e=new Ql,t=new Ql,n=new Ql,r=new Ql,i=new Ql,o=new Ql){this.planes=[e,t,n,r,i,o]}set(e,t,n,r,i,o){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],y=n[14],v=n[15];return t[0].setComponents(s-r,u-a,f-h,v-m).normalize(),t[1].setComponents(s+r,u+a,f+h,v+m).normalize(),t[2].setComponents(s+i,u+l,f+d,v+g).normalize(),t[3].setComponents(s-i,u-l,f-d,v-g).normalize(),t[4].setComponents(s-o,u-c,f-p,v-y).normalize(),t[5].setComponents(s+o,u+c,f+p,v+y).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),$l.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere($l)}intersectsSprite(e){return $l.center.set(0,0,0),$l.radius=.7071067811865476,$l.applyMatrix4(e.matrixWorld),this.intersectsSphere($l)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(ec.x=r.normal.x>0?e.max.x:e.min.x,ec.y=r.normal.y>0?e.max.y:e.min.y,ec.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ec)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function nc(){let e=null,t=!1,n=null,r=null;function i(t,o){n(t,o),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function rc(e,t){const n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){const e=r.get(t);return void((!e||e.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const o=r.get(t);void 0===o?r.set(t,function(t,r){const i=t.array,o=t.usage,s=e.createBuffer();e.bindBuffer(r,s),e.bufferData(r,i,o),t.onUploadCallback();let a=5126;return i instanceof Float32Array?a=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?a=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):a=5123:i instanceof Int16Array?a=5122:i instanceof Uint32Array?a=5125:i instanceof Int32Array?a=5124:i instanceof Int8Array?a=5120:(i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&(a=5121),{buffer:s,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(function(t,r,i){const o=r.array,s=r.updateRange;e.bindBuffer(i,t),-1===s.count?e.bufferSubData(i,0,o):(n?e.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o,s.offset,s.count):e.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o.subarray(s.offset,s.offset+s.count)),s.count=-1)}(o.buffer,t,i),o.version=t.version)}}}class ic extends vl{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,o=t/2,s=Math.floor(n),a=Math.floor(r),l=s+1,c=a+1,u=e/s,h=t/a,d=[],p=[],f=[],m=[];for(let e=0;e<c;e++){const t=e*h-o;for(let n=0;n<l;n++){const r=n*u-i;p.push(r,-t,0),f.push(0,0,1),m.push(n/s),m.push(1-e/a)}}for(let e=0;e<a;e++)for(let t=0;t<s;t++){const n=t+l*e,r=t+l*(e+1),i=t+1+l*(e+1),o=t+1+l*e;d.push(n,r,o),d.push(r,i,o)}this.setIndex(d),this.setAttribute("position",new cl(p,3)),this.setAttribute("normal",new cl(f,3)),this.setAttribute("uv",new cl(m,2))}static fromJSON(e){return new ic(e.width,e.height,e.widthSegments,e.heightSegments)}}const oc={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},sc={common:{diffuse:{value:new Ss(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ps},uv2Transform:{value:new ps},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ds(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ss(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ss(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ps}},sprite:{diffuse:{value:new Ss(16777215)},opacity:{value:1},center:{value:new ds(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ps}}},ac={basic:{uniforms:Fl([sc.common,sc.specularmap,sc.envmap,sc.aomap,sc.lightmap,sc.fog]),vertexShader:oc.meshbasic_vert,fragmentShader:oc.meshbasic_frag},lambert:{uniforms:Fl([sc.common,sc.specularmap,sc.envmap,sc.aomap,sc.lightmap,sc.emissivemap,sc.fog,sc.lights,{emissive:{value:new Ss(0)}}]),vertexShader:oc.meshlambert_vert,fragmentShader:oc.meshlambert_frag},phong:{uniforms:Fl([sc.common,sc.specularmap,sc.envmap,sc.aomap,sc.lightmap,sc.emissivemap,sc.bumpmap,sc.normalmap,sc.displacementmap,sc.fog,sc.lights,{emissive:{value:new Ss(0)},specular:{value:new Ss(1118481)},shininess:{value:30}}]),vertexShader:oc.meshphong_vert,fragmentShader:oc.meshphong_frag},standard:{uniforms:Fl([sc.common,sc.envmap,sc.aomap,sc.lightmap,sc.emissivemap,sc.bumpmap,sc.normalmap,sc.displacementmap,sc.roughnessmap,sc.metalnessmap,sc.fog,sc.lights,{emissive:{value:new Ss(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:oc.meshphysical_vert,fragmentShader:oc.meshphysical_frag},toon:{uniforms:Fl([sc.common,sc.aomap,sc.lightmap,sc.emissivemap,sc.bumpmap,sc.normalmap,sc.displacementmap,sc.gradientmap,sc.fog,sc.lights,{emissive:{value:new Ss(0)}}]),vertexShader:oc.meshtoon_vert,fragmentShader:oc.meshtoon_frag},matcap:{uniforms:Fl([sc.common,sc.bumpmap,sc.normalmap,sc.displacementmap,sc.fog,{matcap:{value:null}}]),vertexShader:oc.meshmatcap_vert,fragmentShader:oc.meshmatcap_frag},points:{uniforms:Fl([sc.points,sc.fog]),vertexShader:oc.points_vert,fragmentShader:oc.points_frag},dashed:{uniforms:Fl([sc.common,sc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:oc.linedashed_vert,fragmentShader:oc.linedashed_frag},depth:{uniforms:Fl([sc.common,sc.displacementmap]),vertexShader:oc.depth_vert,fragmentShader:oc.depth_frag},normal:{uniforms:Fl([sc.common,sc.bumpmap,sc.normalmap,sc.displacementmap,{opacity:{value:1}}]),vertexShader:oc.meshnormal_vert,fragmentShader:oc.meshnormal_frag},sprite:{uniforms:Fl([sc.sprite,sc.fog]),vertexShader:oc.sprite_vert,fragmentShader:oc.sprite_frag},background:{uniforms:{uvTransform:{value:new ps},t2D:{value:null}},vertexShader:oc.background_vert,fragmentShader:oc.background_frag},cube:{uniforms:Fl([sc.envmap,{opacity:{value:1}}]),vertexShader:oc.cube_vert,fragmentShader:oc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:oc.equirect_vert,fragmentShader:oc.equirect_frag},distanceRGBA:{uniforms:Fl([sc.common,sc.displacementmap,{referencePosition:{value:new ks},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:oc.distanceRGBA_vert,fragmentShader:oc.distanceRGBA_frag},shadow:{uniforms:Fl([sc.lights,sc.fog,{color:{value:new Ss(0)},opacity:{value:1}}]),vertexShader:oc.shadow_vert,fragmentShader:oc.shadow_frag}};function lc(e,t,n,r,i,o){const s=new Ss(0);let a,l,c=!0===i?0:1,u=null,h=0,d=null;function p(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,o)}return{getClearColor:function(){return s},setClearColor:function(e,t=1){s.set(e),c=t,p(s,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,p(s,c)},render:function(n,i){let o=!1,f=!0===i.isScene?i.background:null;f&&f.isTexture&&(f=t.get(f));const m=e.xr,g=m.getSession&&m.getSession();g&&"additive"===g.environmentBlendMode&&(f=null),null===f?p(s,c):f&&f.isColor&&(p(f,1),o=!0),(e.autoClear||o)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),f&&(f.isCubeTexture||f.mapping===Yr)?(void 0===l&&(l=new Dl(new Ul(1,1,1),new Gl({name:"BackgroundCubeMaterial",uniforms:zl(ac.cube.uniforms),vertexShader:ac.cube.vertexShader,fragmentShader:ac.cube.fragmentShader,side:tr,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=f,l.material.uniforms.flipEnvMap.value=f.isCubeTexture&&!1===f.isRenderTargetTexture?-1:1,u===f&&h===f.version&&d===e.toneMapping||(l.material.needsUpdate=!0,u=f,h=f.version,d=e.toneMapping),n.unshift(l,l.geometry,l.material,0,0,null)):f&&f.isTexture&&(void 0===a&&(a=new Dl(new ic(2,2),new Gl({name:"BackgroundMaterial",uniforms:zl(ac.background.uniforms),vertexShader:ac.background.vertexShader,fragmentShader:ac.background.fragmentShader,side:er,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),a.material.uniforms.uvTransform.value.copy(f.matrix),u===f&&h===f.version&&d===e.toneMapping||(a.material.needsUpdate=!0,u=f,h=f.version,d=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function cc(e,t,n,r){const i=e.getParameter(34921),o=r.isWebGL2?null:t.get("OES_vertex_array_object"),s=r.isWebGL2||null!==o,a={},l=d(null);let c=l;function u(t){return r.isWebGL2?e.bindVertexArray(t):o.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function d(e){const t=[],n=[],r=[];for(let e=0;e<i;e++)t[e]=0,n[e]=0,r[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){const e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function f(e){m(e,0)}function m(n,i){const o=c.newAttributes,s=c.enabledAttributes,a=c.attributeDivisors;o[n]=1,0===s[n]&&(e.enableVertexAttribArray(n),s[n]=1),a[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),a[n]=i)}function g(){const t=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,i,o,s,a){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,o,s,a):e.vertexAttribIPointer(t,n,i,s,a)}function v(){_(),c!==l&&(c=l,u(c.object))}function _(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,v,_){let w=!1;if(s){const t=function(t,n,i){const s=!0===i.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[s];return void 0===u&&(u=d(r.isWebGL2?e.createVertexArray():o.createVertexArrayOES()),c[s]=u),u}(v,h,l);c!==t&&(c=t,u(c.object)),w=function(e,t){const n=c.attributes,r=e.attributes;let i=0;for(const e in r){const t=n[e],o=r[e];if(void 0===t)return!0;if(t.attribute!==o)return!0;if(t.data!==o.data)return!0;i++}return c.attributesNum!==i||c.index!==t}(v,_),w&&function(e,t){const n={},r=e.attributes;let i=0;for(const e in r){const t=r[e],o={};o.attribute=t,t.data&&(o.data=t.data),n[e]=o,i++}c.attributes=n,c.attributesNum=i,c.index=t}(v,_)}else{const e=!0===l.wireframe;c.geometry===v.id&&c.program===h.id&&c.wireframe===e||(c.geometry=v.id,c.program=h.id,c.wireframe=e,w=!0)}!0===i.isInstancedMesh&&(w=!0),null!==_&&n.update(_,34963),w&&(function(i,o,s,a){if(!1===r.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();const l=a.attributes,c=s.getAttributes(),u=o.defaultAttributeValues;for(const t in c){const r=c[t];if(r.location>=0){let o=l[t];if(void 0===o&&("instanceMatrix"===t&&i.instanceMatrix&&(o=i.instanceMatrix),"instanceColor"===t&&i.instanceColor&&(o=i.instanceColor)),void 0!==o){const t=o.normalized,s=o.itemSize,l=n.get(o);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,l=n.stride,d=o.offset;if(n&&n.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)m(r.location+e,n.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<r.locationSize;e++)f(r.location+e);e.bindBuffer(34962,c);for(let e=0;e<r.locationSize;e++)y(r.location+e,s/r.locationSize,u,t,l*h,(d+s/r.locationSize*e)*h)}else{if(o.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)m(r.location+e,o.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let e=0;e<r.locationSize;e++)f(r.location+e);e.bindBuffer(34962,c);for(let e=0;e<r.locationSize;e++)y(r.location+e,s/r.locationSize,u,t,s*h,s/r.locationSize*e*h)}}else if(void 0!==u){const n=u[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(r.location,n);break;case 3:e.vertexAttrib3fv(r.location,n);break;case 4:e.vertexAttrib4fv(r.location,n);break;default:e.vertexAttrib1fv(r.location,n)}}}}g()}(i,l,h,v),null!==_&&e.bindBuffer(34963,n.get(_).buffer))},reset:v,resetDefaultState:_,dispose:function(){v();for(const e in a){const t=a[e];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const n=a[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)h(r[e].object),delete r[e];delete n[e.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function uc(e,t,n,r){const i=r.isWebGL2;let o;this.setMode=function(e){o=e},this.render=function(t,r){e.drawArrays(o,t,r),n.update(r,o,1)},this.renderInstances=function(r,s,a){if(0===a)return;let l,c;if(i)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](o,r,s,a),n.update(s,o,a)}}function hc(e,t,n){let r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let s=void 0!==n.precision?n.precision:"highp";const a=i(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=o||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),y=e.getParameter(36349),v=h>0,_=o||t.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:v,floatFragmentTextures:_,floatVertexTextures:v&&_,maxSamples:o?e.getParameter(36183):0}}function dc(e){const t=this;let n=null,r=0,i=!1,o=!1;const s=new Ql,a=new ps,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function u(e,n,r,i){const o=null!==e?e.length:0;let c=null;if(0!==o){if(c=l.value,!0!==i||null===c){const t=r+4*o,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,n=r;t!==o;++t,n+=4)s.copy(e[t]).applyMatrix4(i,a),s.normal.toArray(c,n),c[n+3]=s.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,o){const s=0!==e.length||t||0!==r||i;return i=t,n=u(e,o,0),r=e.length,s},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(t,s,a){const h=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows,f=e.get(t);if(!i||null===h||0===h.length||o&&!p)o?u(null):c();else{const e=o?0:r,t=4*e;let i=f.clippingState||null;l.value=i,i=u(h,s,t,a);for(let e=0;e!==t;++e)i[e]=n[e];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function pc(e){let t=new WeakMap;function n(e,t){return t===Kr?e.mapping=Wr:t===Xr&&(e.mapping=qr),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const o=i.mapping;if(o===Kr||o===Xr){if(t.has(i))return n(t.get(i).texture,i.mapping);{const o=i.image;if(o&&o.height>0){const s=new Xl(o.height/2);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}ac.physical={uniforms:Fl([ac.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ds(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Ss(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ds},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ss(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ss(1,1,1)},specularColorMap:{value:null}}]),vertexShader:oc.meshphysical_vert,fragmentShader:oc.meshphysical_frag};class fc extends Vl{constructor(e=-1,t=1,n=1,r=-1,i=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,o=n+e,s=r+t,a=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,o=i+e*this.view.width,s-=t*this.view.offsetY,a=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}fc.prototype.isOrthographicCamera=!0;class mc extends Gl{constructor(e){super(e),this.type="RawShaderMaterial"}}mc.prototype.isRawShaderMaterial=!0;const gc=Math.pow(2,8),yc=[.125,.215,.35,.446,.526,.582],vc=5+yc.length,_c=new fc,{_lodPlanes:wc,_sizeLods:bc,_sigmas:xc}=Cc(),Ec=new Ss;let Sc=null;const Mc=(1+Math.sqrt(5))/2,Tc=1/Mc,Ac=[new ks(1,1,1),new ks(-1,1,1),new ks(1,1,-1),new ks(-1,1,-1),new ks(0,Mc,Tc),new ks(0,Mc,-Tc),new ks(Tc,0,Mc),new ks(-Tc,0,Mc),new ks(Mc,Tc,0),new ks(-Mc,Tc,0)];class Rc{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(e){const t=new Float32Array(20),n=new ks(0,1,0);return new mc({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:or,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Sc=this._renderer.getRenderTarget();const i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Oc(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Ic(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<wc.length;e++)wc[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Sc),e.scissorTest=!1,Pc(e,0,0,e.width,e.height)}_fromTexture(e,t){Sc=this._renderer.getRenderTarget();const n=t||this._allocateTargets(e);return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(e){const t={magFilter:oi,minFilter:oi,generateMipmaps:!1,type:yi,format:xi,encoding:_o,depthBuffer:!1},n=Lc(t);return n.depthBuffer=!e,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=Lc(t)),n}_compileMaterial(e){const t=new Dl(wc[0],e);this._renderer.compile(t,_c)}_sceneToCubeUV(e,t,n,r){const i=new jl(90,1,t,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(Ec),a.toneMapping=Ur,a.autoClear=!1;const u=new Za({name:"PMREM.Background",side:tr,depthWrite:!1,depthTest:!1}),h=new Dl(new Ul,u);let d=!1;const p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy(Ec),d=!0);for(let t=0;t<6;t++){const n=t%3;0===n?(i.up.set(0,o[t],0),i.lookAt(s[t],0,0)):1===n?(i.up.set(0,0,o[t]),i.lookAt(0,s[t],0)):(i.up.set(0,o[t],0),i.lookAt(0,0,s[t])),Pc(r,n*gc,t>2?gc:0,gc,gc),a.setRenderTarget(r),d&&a.render(h,i),a.render(e,i)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Wr||e.mapping===qr;r?(null===this._cubemapShader&&(this._cubemapShader=Oc()),this._cubemapShader.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=Ic());const i=r?this._cubemapShader:this._equirectShader,o=new Dl(wc[0],i),s=i.uniforms;s.envMap.value=e,r||s.texelSize.value.set(1/e.image.width,1/e.image.height),Pc(t,0,0,3*gc,2*gc),n.setRenderTarget(t),n.render(o,_c)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let t=1;t<vc;t++){const n=Math.sqrt(xc[t]*xc[t]-xc[t-1]*xc[t-1]),r=Ac[(t-1)%Ac.length];this._blur(e,t-1,t,n,r)}t.autoClear=n}_blur(e,t,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,o,s){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new Dl(wc[r],l),u=l.uniforms,h=bc[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,p=i/d,f=isFinite(i)?1+Math.floor(3*p):20;f>20&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<20;++e){const t=e/p,n=Math.exp(-t*t/2);m.push(n),0===e?g+=n:e<f&&(g+=2*n)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===o,s&&(u.poleAxis.value=s),u.dTheta.value=d,u.mipInt.value=8-n;const y=bc[r];Pc(t,3*Math.max(0,gc-2*y),(0===r?0:2*gc)+2*y*(r>4?r-8+4:0),3*y,2*y),a.setRenderTarget(t),a.render(c,_c)}}function Cc(){const e=[],t=[],n=[];let r=8;for(let i=0;i<vc;i++){const o=Math.pow(2,r);t.push(o);let s=1/o;i>4?s=yc[i-8+4-1]:0===i&&(s=0),n.push(s);const a=1/(o-1),l=-a/2,c=1+a/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,d=6,p=3,f=2,m=1,g=new Float32Array(p*d*h),y=new Float32Array(f*d*h),v=new Float32Array(m*d*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];g.set(r,p*d*e),y.set(u,f*d*e);const i=[e,e,e,e,e,e];v.set(i,m*d*e)}const _=new vl;_.setAttribute("position",new el(g,p)),_.setAttribute("uv",new el(y,f)),_.setAttribute("faceIndex",new el(v,m)),e.push(_),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function Lc(e){const t=new Ps(3*gc,3*gc,e);return t.texture.mapping=Yr,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Pc(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function Ic(){const e=new ds(1,1);return new mc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:or,depthTest:!1,depthWrite:!1})}function Oc(){return new mc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:or,depthTest:!1,depthWrite:!1})}function Nc(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping,s=o===Kr||o===Xr,a=o===Wr||o===qr;if(s||a){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let r=t.get(i);return null===n&&(n=new Rc(e)),r=s?n.fromEquirectangular(i,r):n.fromCubemap(i,r),t.set(i,r),r.texture}if(t.has(i))return t.get(i).texture;{const o=i.image;if(s&&o&&o.height>0||a&&o&&function(e){let t=0;for(let n=0;n<6;n++)void 0!==e[n]&&t++;return 6===t}(o)){null===n&&(n=new Rc(e));const o=s?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,o),i.addEventListener("dispose",r),o.texture}return null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function kc(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Dc(e,t,n,r){const i={},o=new WeakMap;function s(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const e in a.attributes)t.remove(a.attributes[e]);a.removeEventListener("dispose",s),delete i[a.id];const l=o.get(a);l&&(t.remove(l),o.delete(a)),r.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],r=e.index,i=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],o=e[t+2];n.push(r,i,i,o,o,r)}}else{const e=i.array;s=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}const a=new(fs(n)?al:ol)(n,1);a.version=s;const l=o.get(e);l&&t.remove(l),o.set(e,a)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,n.memory.geometries++),t},update:function(e){const n=e.attributes;for(const e in n)t.update(n[e],34962);const r=e.morphAttributes;for(const e in r){const n=r[e];for(let e=0,r=n.length;e<r;e++)t.update(n[e],34962)}},getWireframeAttribute:function(e){const t=o.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return o.get(e)}}}function Bc(e,t,n,r){const i=r.isWebGL2;let o,s,a;this.setMode=function(e){o=e},this.setIndex=function(e){s=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(o,r,s,t*a),n.update(r,o,1)},this.renderInstances=function(r,l,c){if(0===c)return;let u,h;if(i)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](o,l,s,r*a,c),n.update(l,o,c)}}function Uc(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}class zc extends Rs{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=ei,this.minFilter=ei,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Fc(e,t){return e[0]-t[0]}function Hc(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Gc(e,t){let n=1;const r=t.isInterleavedBufferAttribute?t.data.array:t.array;r instanceof Int8Array?n=127:r instanceof Int16Array?n=32767:r instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),e.divideScalar(n)}function Vc(e,t,n){const r={},i=new Float32Array(8),o=new WeakMap,s=new ks,a=[];for(let e=0;e<8;e++)a[e]=[e,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===t.isWebGL2){const r=c.morphAttributes.position.length;let i=o.get(c);if(void 0===i||i.count!==r){void 0!==i&&i.texture.dispose();const e=void 0!==c.morphAttributes.normal,n=c.morphAttributes.position,a=c.morphAttributes.normal||[],l=!0===e?2:1;let u=c.attributes.position.count*l,h=1;u>t.maxTextureSize&&(h=Math.ceil(u/t.maxTextureSize),u=t.maxTextureSize);const d=new Float32Array(u*h*4*r),p=new zc(d,u,h,r);p.format=xi,p.type=gi,p.needsUpdate=!0;const f=4*l;for(let t=0;t<r;t++){const r=n[t],i=a[t],o=u*h*4*t;for(let t=0;t<r.count;t++){s.fromBufferAttribute(r,t),!0===r.normalized&&Gc(s,r);const n=t*f;d[o+n+0]=s.x,d[o+n+1]=s.y,d[o+n+2]=s.z,d[o+n+3]=0,!0===e&&(s.fromBufferAttribute(i,t),!0===i.normalized&&Gc(s,i),d[o+n+4]=s.x,d[o+n+5]=s.y,d[o+n+6]=s.z,d[o+n+7]=0)}}function m(){p.dispose(),o.delete(c),c.removeEventListener("dispose",m)}i={count:r,texture:p,size:new ds(u,h)},o.set(c,i),c.addEventListener("dispose",m)}let a=0;for(let e=0;e<d.length;e++)a+=d[e];const l=c.morphTargetsRelative?1:1-a;h.getUniforms().setValue(e,"morphTargetBaseInfluence",l),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",i.texture,n),h.getUniforms().setValue(e,"morphTargetsTextureSize",i.size)}else{const t=void 0===d?0:d.length;let n=r[c.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];r[c.id]=n}for(let e=0;e<t;e++){const t=n[e];t[0]=e,t[1]=d[e]}n.sort(Hc);for(let e=0;e<8;e++)e<t&&n[e][1]?(a[e][0]=n[e][0],a[e][1]=n[e][1]):(a[e][0]=Number.MAX_SAFE_INTEGER,a[e][1]=0);a.sort(Fc);const o=c.morphAttributes.position,s=c.morphAttributes.normal;let l=0;for(let e=0;e<8;e++){const t=a[e],n=t[0],r=t[1];n!==Number.MAX_SAFE_INTEGER&&r?(o&&c.getAttribute("morphTarget"+e)!==o[n]&&c.setAttribute("morphTarget"+e,o[n]),s&&c.getAttribute("morphNormal"+e)!==s[n]&&c.setAttribute("morphNormal"+e,s[n]),i[e]=r,l+=r):(o&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),s&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),i[e]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function jc(e,t,n,r){let i=new WeakMap;function o(e){const t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){const s=r.render.frame,a=e.geometry,l=t.get(e,a);return i.get(l)!==s&&(t.update(l),i.set(l,s)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",o)&&e.addEventListener("dispose",o),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}zc.prototype.isDataTexture2DArray=!0;class Wc extends Rs{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=ei,this.minFilter=ei,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Wc.prototype.isDataTexture3D=!0;const qc=new Rs,Kc=new zc,Xc=new Wc,Yc=new Kl,Jc=[],Zc=[],Qc=new Float32Array(16),$c=new Float32Array(9),eu=new Float32Array(4);function tu(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let o=Jc[i];if(void 0===o&&(o=new Float32Array(i),Jc[i]=o),0!==t){r.toArray(o,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(o,i)}return o}function nu(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ru(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function iu(e,t){let n=Zc[t];void 0===n&&(n=new Int32Array(t),Zc[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function ou(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function su(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(nu(n,t))return;e.uniform2fv(this.addr,t),ru(n,t)}}function au(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(nu(n,t))return;e.uniform3fv(this.addr,t),ru(n,t)}}function lu(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(nu(n,t))return;e.uniform4fv(this.addr,t),ru(n,t)}}function cu(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(nu(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),ru(n,t)}else{if(nu(n,r))return;eu.set(r),e.uniformMatrix2fv(this.addr,!1,eu),ru(n,r)}}function uu(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(nu(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),ru(n,t)}else{if(nu(n,r))return;$c.set(r),e.uniformMatrix3fv(this.addr,!1,$c),ru(n,r)}}function hu(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(nu(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),ru(n,t)}else{if(nu(n,r))return;Qc.set(r),e.uniformMatrix4fv(this.addr,!1,Qc),ru(n,r)}}function du(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function pu(e,t){const n=this.cache;nu(n,t)||(e.uniform2iv(this.addr,t),ru(n,t))}function fu(e,t){const n=this.cache;nu(n,t)||(e.uniform3iv(this.addr,t),ru(n,t))}function mu(e,t){const n=this.cache;nu(n,t)||(e.uniform4iv(this.addr,t),ru(n,t))}function gu(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function yu(e,t){const n=this.cache;nu(n,t)||(e.uniform2uiv(this.addr,t),ru(n,t))}function vu(e,t){const n=this.cache;nu(n,t)||(e.uniform3uiv(this.addr,t),ru(n,t))}function _u(e,t){const n=this.cache;nu(n,t)||(e.uniform4uiv(this.addr,t),ru(n,t))}function wu(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||qc,i)}function bu(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Xc,i)}function xu(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Yc,i)}function Eu(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Kc,i)}function Su(e,t){e.uniform1fv(this.addr,t)}function Mu(e,t){const n=tu(t,this.size,2);e.uniform2fv(this.addr,n)}function Tu(e,t){const n=tu(t,this.size,3);e.uniform3fv(this.addr,n)}function Au(e,t){const n=tu(t,this.size,4);e.uniform4fv(this.addr,n)}function Ru(e,t){const n=tu(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Cu(e,t){const n=tu(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Lu(e,t){const n=tu(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Pu(e,t){e.uniform1iv(this.addr,t)}function Iu(e,t){e.uniform2iv(this.addr,t)}function Ou(e,t){e.uniform3iv(this.addr,t)}function Nu(e,t){e.uniform4iv(this.addr,t)}function ku(e,t){e.uniform1uiv(this.addr,t)}function Du(e,t){e.uniform2uiv(this.addr,t)}function Bu(e,t){e.uniform3uiv(this.addr,t)}function Uu(e,t){e.uniform4uiv(this.addr,t)}function zu(e,t,n){const r=t.length,i=iu(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.safeSetTexture2D(t[e]||qc,i[e])}function Fu(e,t,n){const r=t.length,i=iu(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.setTexture3D(t[e]||Xc,i[e])}function Hu(e,t,n){const r=t.length,i=iu(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.safeSetTextureCube(t[e]||Yc,i[e])}function Gu(e,t,n){const r=t.length,i=iu(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.setTexture2DArray(t[e]||Kc,i[e])}function Vu(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return ou;case 35664:return su;case 35665:return au;case 35666:return lu;case 35674:return cu;case 35675:return uu;case 35676:return hu;case 5124:case 35670:return du;case 35667:case 35671:return pu;case 35668:case 35672:return fu;case 35669:case 35673:return mu;case 5125:return gu;case 36294:return yu;case 36295:return vu;case 36296:return _u;case 35678:case 36198:case 36298:case 36306:case 35682:return wu;case 35679:case 36299:case 36307:return bu;case 35680:case 36300:case 36308:case 36293:return xu;case 36289:case 36303:case 36311:case 36292:return Eu}}(t.type)}function ju(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Su;case 35664:return Mu;case 35665:return Tu;case 35666:return Au;case 35674:return Ru;case 35675:return Cu;case 35676:return Lu;case 5124:case 35670:return Pu;case 35667:case 35671:return Iu;case 35668:case 35672:return Ou;case 35669:case 35673:return Nu;case 5125:return ku;case 36294:return Du;case 36295:return Bu;case 36296:return Uu;case 35678:case 36198:case 36298:case 36306:case 35682:return zu;case 35679:case 36299:case 36307:return Fu;case 35680:case 36300:case 36308:case 36293:return Hu;case 36289:case 36303:case 36311:case 36292:return Gu}}(t.type)}function Wu(e){this.id=e,this.seq=[],this.map={}}ju.prototype.updateCache=function(e){const t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),ru(t,e)},Wu.prototype.setValue=function(e,t,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(e,t[o.id],n)}};const qu=/(\w+)(\])?(\[|\.)?/g;function Ku(e,t){e.seq.push(t),e.map[t.id]=t}function Xu(e,t,n){const r=e.name,i=r.length;for(qu.lastIndex=0;;){const o=qu.exec(r),s=qu.lastIndex;let a=o[1];const l="]"===o[2],c=o[3];if(l&&(a|=0),void 0===c||"["===c&&s+2===i){Ku(n,void 0===c?new Vu(a,e,t):new ju(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new Wu(a),Ku(n,e)),n=e}}}function Yu(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);Xu(n,e.getUniformLocation(t,n.name),this)}}function Ju(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Yu.prototype.setValue=function(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Yu.prototype.setOptional=function(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)},Yu.upload=function(e,t,n,r){for(let i=0,o=t.length;i!==o;++i){const o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},Yu.seqWithValue=function(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n};let Zu=0;function Qu(e,t,n){const r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":n.toUpperCase()+"\n\n"+i+"\n\n"+function(e){const t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(e.getShaderSource(t))}function $u(e,t){const n=function(e){switch(e){case _o:return["Linear","( value )"];case wo:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function eh(e,t){let n;switch(t){case zr:n="Linear";break;case Fr:n="Reinhard";break;case Hr:n="OptimizedCineon";break;case Gr:n="ACESFilmic";break;case Vr:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function th(e){return""!==e}function nh(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function rh(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const ih=/^[ \t]*#include +<([\w\d./]+)>/gm;function oh(e){return e.replace(ih,sh)}function sh(e,t){const n=oc[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return oh(n)}const ah=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,lh=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ch(e){return e.replace(lh,hh).replace(ah,uh)}function uh(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),hh(0,t,n,r)}function hh(e,t,n,r){let i="";for(let e=parseInt(t);e<parseInt(n);e++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function dh(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function ph(e,t,n,r){const i=e.getContext(),o=n.defines;let s=n.vertexShader,a=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Zn?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===Qn?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===$n&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Wr:case qr:t="ENVMAP_TYPE_CUBE";break;case Yr:case Jr:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case qr:case Jr:t="ENVMAP_MODE_REFRACTION"}return t}(n),h=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case kr:t="ENVMAP_BLENDING_MULTIPLY";break;case Dr:t="ENVMAP_BLENDING_MIX";break;case Br:t="ENVMAP_BLENDING_ADD"}return t}(n),d=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(th).join("\n")}(n),p=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(o),f=i.createProgram();let m,g,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(m=[p].filter(th).join("\n"),m.length>0&&(m+="\n"),g=[d,p].filter(th).join("\n"),g.length>0&&(g+="\n")):(m=[dh(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(th).join("\n"),g=[d,dh(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ur?"#define TONE_MAPPING":"",n.toneMapping!==Ur?oc.tonemapping_pars_fragment:"",n.toneMapping!==Ur?eh("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.alphaWrite?"":"#define OPAQUE",oc.encodings_pars_fragment,$u("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(th).join("\n")),s=oh(s),s=nh(s,n),s=rh(s,n),a=oh(a),a=nh(a,n),a=rh(a,n),s=ch(s),a=ch(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in",n.glslVersion===Zo?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Zo?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const v=y+g+a,_=Ju(i,35633,y+m+s),w=Ju(i,35632,v);if(i.attachShader(f,_),i.attachShader(f,w),void 0!==n.index0AttributeName?i.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(f,0,"position"),i.linkProgram(f),e.debug.checkShaderErrors){const e=i.getProgramInfoLog(f).trim(),t=i.getShaderInfoLog(_).trim(),n=i.getShaderInfoLog(w).trim();let r=!0,o=!0;if(!1===i.getProgramParameter(f,35714)){r=!1;const t=Qu(i,_,"vertex"),n=Qu(i,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(f,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+n)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):""!==t&&""!==n||(o=!1);o&&(this.diagnostics={runnable:r,programLog:e,vertexShader:{log:t,prefix:m},fragmentShader:{log:n,prefix:g}})}let b,x;return i.deleteShader(_),i.deleteShader(w),this.getUniforms=function(){return void 0===b&&(b=new Yu(i,f)),b},this.getAttributes=function(){return void 0===x&&(x=function(e,t){const n={},r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),o=r.name;let s=1;35674===r.type&&(s=2),35675===r.type&&(s=3),35676===r.type&&(s=4),n[o]={type:r.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(i,f)),x},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(f),this.program=void 0},this.name=n.shaderName,this.id=Zu++,this.cacheKey=t,this.usedTimes=1,this.program=f,this.vertexShader=_,this.fragmentShader=w,this}let fh=0;class mh{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(i)&&(o.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new gh;t.set(e,n)}return t.get(e)}}class gh{constructor(){this.id=fh++,this.usedTimes=0}}function yh(e,t,n,r,i,o,s){const a=new Ea,l=new mh,c=[],u=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.floatVertexTextures,p=i.maxVertexUniforms,f=i.vertexTextures;let m=i.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(o,a,c,y,v){const _=y.fog,w=o.isMeshStandardMaterial?y.environment:null,b=(o.isMeshStandardMaterial?n:t).get(o.envMap||w),x=g[o.type],E=v.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(d)return 1024;{const e=p,n=Math.floor((e-20)/4),r=Math.min(n,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}}(v):0;let S,M,T,A;if(null!==o.precision&&(m=i.getMaxPrecision(o.precision),m!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",m,"instead.")),x){const e=ac[x];S=e.vertexShader,M=e.fragmentShader}else S=o.vertexShader,M=o.fragmentShader,l.update(o),T=l.getVertexShaderID(o),A=l.getFragmentShaderID(o);const R=e.getRenderTarget(),C=o.alphaTest>0,L=o.clearcoat>0;return{isWebGL2:u,shaderID:x,shaderName:o.type,vertexShader:S,fragmentShader:M,defines:o.defines,customVertexShaderID:T,customFragmentShaderID:A,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:m,instancing:!0===v.isInstancedMesh,instancingColor:!0===v.isInstancedMesh&&null!==v.instanceColor,supportsVertexTextures:f,outputEncoding:null===R?e.outputEncoding:!0===R.isXRRenderTarget?R.texture.encoding:_o,map:!!o.map,matcap:!!o.matcap,envMap:!!b,envMapMode:b&&b.mapping,envMapCubeUV:!!b&&(b.mapping===Yr||b.mapping===Jr),lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===So,tangentSpaceNormalMap:o.normalMapType===Eo,decodeVideoTexture:!!o.map&&!0===o.map.isVideoTexture&&o.map.encoding===wo,clearcoat:L,clearcoatMap:L&&!!o.clearcoatMap,clearcoatRoughnessMap:L&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:L&&!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,alphaMap:!!o.alphaMap,alphaTest:C,alphaWrite:o.alphaWrite||o.transparent,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!v.geometry&&!!v.geometry.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!v.geometry&&!!v.geometry.attributes.color&&4===v.geometry.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.displacementMap||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheenColorMap||o.sheenRoughnessMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap||!o.displacementMap),fog:!!_,useFog:o.fog,fogExp2:_&&_.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===v.isSkinnedMesh&&E>0,maxBones:E,useVertexTexture:d,morphTargets:!!v.geometry&&!!v.geometry.morphAttributes.position,morphNormals:!!v.geometry&&!!v.geometry.morphAttributes.normal,morphTargetsCount:v.geometry&&v.geometry.morphAttributes.position?v.geometry.morphAttributes.position.length:0,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:o.toneMapped?e.toneMapping:Ur,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===nr,flipSided:o.side===tr,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.maxBones),e.push(t.morphTargetsCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.alphaWrite)}(n,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0),t.supportsVertexTextures&&a.enable(1),t.instancing&&a.enable(2),t.instancingColor&&a.enable(3),t.map&&a.enable(4),t.matcap&&a.enable(5),t.envMap&&a.enable(6),t.envMapCubeUV&&a.enable(7),t.lightMap&&a.enable(8),t.aoMap&&a.enable(9),t.emissiveMap&&a.enable(10),t.bumpMap&&a.enable(11),t.normalMap&&a.enable(12),t.objectSpaceNormalMap&&a.enable(13),t.tangentSpaceNormalMap&&a.enable(14),t.clearcoat&&a.enable(15),t.clearcoatMap&&a.enable(16),t.clearcoatRoughnessMap&&a.enable(17),t.clearcoatNormalMap&&a.enable(18),t.displacementMap&&a.enable(19),t.specularMap&&a.enable(20),t.roughnessMap&&a.enable(21),t.metalnessMap&&a.enable(22),t.gradientMap&&a.enable(23),t.alphaMap&&a.enable(24),t.alphaTest&&a.enable(25),t.vertexColors&&a.enable(26),t.vertexAlphas&&a.enable(27),t.vertexUvs&&a.enable(28),t.vertexTangents&&a.enable(29),t.uvsVertexOnly&&a.enable(30),t.fog&&a.enable(31),e.push(a.mask),a.disableAll(),t.useFog&&a.enable(0),t.flatShading&&a.enable(1),t.logarithmicDepthBuffer&&a.enable(2),t.skinning&&a.enable(3),t.useVertexTexture&&a.enable(4),t.morphTargets&&a.enable(5),t.morphNormals&&a.enable(6),t.premultipliedAlpha&&a.enable(7),t.shadowMapEnabled&&a.enable(8),t.physicallyCorrectLights&&a.enable(9),t.doubleSided&&a.enable(10),t.flipSided&&a.enable(11),t.depthPacking&&a.enable(12),t.dithering&&a.enable(13),t.specularIntensityMap&&a.enable(14),t.specularColorMap&&a.enable(15),t.transmission&&a.enable(16),t.transmissionMap&&a.enable(17),t.thicknessMap&&a.enable(18),t.sheen&&a.enable(19),t.sheenColorMap&&a.enable(20),t.sheenRoughnessMap&&a.enable(21),t.decodeVideoTexture&&a.enable(22),e.push(a.mask)}(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=g[e.type];let n;if(t){const e=ac[t];n=Hl.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,t=c.length;e<t;e++){const t=c[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new ph(e,n,t,o),c.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function vh(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function _h(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function wh(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function bh(){const e=[];let t=0;const n=[],r=[],i=[];function o(n,r,i,o,s,a){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:a},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=s,l.group=a),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,s,a,l,c){const u=o(e,t,s,a,l,c);s.transmission>0?r.push(u):!0===s.transparent?i.push(u):n.push(u)},unshift:function(e,t,s,a,l,c){const u=o(e,t,s,a,l,c);s.transmission>0?r.unshift(u):!0===s.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||_h),r.length>1&&r.sort(t||wh),i.length>1&&i.sort(t||wh)}}}function xh(){let e=new WeakMap;return{get:function(t,n){let r;return!1===e.has(t)?(r=new bh,e.set(t,[r])):n>=e.get(t).length?(r=new bh,e.get(t).push(r)):r=e.get(t)[n],r},dispose:function(){e=new WeakMap}}}function Eh(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new ks,color:new Ss};break;case"SpotLight":n={position:new ks,direction:new ks,color:new Ss,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ks,color:new Ss,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ks,skyColor:new Ss,groundColor:new Ss};break;case"RectAreaLight":n={color:new Ss,position:new ks,halfWidth:new ks,halfHeight:new ks}}return e[t.id]=n,n}}}let Sh=0;function Mh(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Th(e,t){const n=new Eh,r=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ds};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ds,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)i.probe.push(new ks);const o=new ks,s=new da,a=new da;return{setup:function(o,s){let a=0,l=0,c=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0;o.sort(Mh);const v=!0!==s?Math.PI:1;for(let e=0,t=o.length;e<t;e++){const t=o[e],s=t.color,_=t.intensity,w=t.distance,b=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=s.r*_*v,l+=s.g*_*v,c+=s.b*_*v;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],_);else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*v),t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,i.directionalShadow[u]=n,i.directionalShadowMap[u]=b,i.directionalShadowMatrix[u]=t.shadow.matrix,m++}i.directional[u]=e,u++}else if(t.isSpotLight){const e=n.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(s).multiplyScalar(_*v),e.distance=w,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,i.spotShadow[d]=n,i.spotShadowMap[d]=b,i.spotShadowMatrix[d]=t.shadow.matrix,y++}i.spot[d]=e,d++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(s).multiplyScalar(_),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[p]=e,p++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*v),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,i.pointShadow[h]=n,i.pointShadowMap[h]=b,i.pointShadowMatrix[h]=t.shadow.matrix,g++}i.point[h]=e,h++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(_*v),e.groundColor.copy(t.groundColor).multiplyScalar(_*v),i.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=sc.LTC_FLOAT_1,i.rectAreaLTC2=sc.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=sc.LTC_HALF_1,i.rectAreaLTC2=sc.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=a,i.ambient[1]=l,i.ambient[2]=c;const _=i.hash;_.directionalLength===u&&_.pointLength===h&&_.spotLength===d&&_.rectAreaLength===p&&_.hemiLength===f&&_.numDirectionalShadows===m&&_.numPointShadows===g&&_.numSpotShadows===y||(i.directional.length=u,i.spot.length=d,i.rectArea.length=p,i.point.length=h,i.hemi.length=f,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotShadowMatrix.length=y,_.directionalLength=u,_.pointLength=h,_.spotLength=d,_.rectAreaLength=p,_.hemiLength=f,_.numDirectionalShadows=m,_.numPointShadows=g,_.numSpotShadows=y,i.version=Sh++)},setupView:function(e,t){let n=0,r=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){const d=e[t];if(d.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),n++}else if(d.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),a.identity(),s.copy(d.matrixWorld),s.premultiply(h),a.extractRotation(s),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(d.isPointLight){const e=i.point[r];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),r++}else if(d.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),e.direction.normalize(),u++}}},state:i}}function Ah(e,t){const n=new Th(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Rh(e,t){let n=new WeakMap;return{get:function(r,i=0){let o;return!1===n.has(r)?(o=new Ah(e,t),n.set(r,[o])):i>=n.get(r).length?(o=new Ah(e,t),n.get(r).push(o)):o=n.get(r)[i],o},dispose:function(){n=new WeakMap}}}class Ch extends Ja{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=bo,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Ch.prototype.isMeshDepthMaterial=!0;class Lh extends Ja{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ks,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Ph(e,t,n){let r=new tc;const i=new ds,o=new ds,s=new Ls,a=new Ch({depthPacking:xo}),l=new Lh,c={},u=n.maxTextureSize,h={0:tr,1:er,2:nr},d=new Gl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ds},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new vl;f.setAttribute("position",new el(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Dl(f,d),g=this;function y(n,r){const i=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,m,null)}function v(t,n,r,i,o,s,u){let d=null;const p=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(d=void 0!==p?p:!0===i.isPointLight?l:a,e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0){const e=d.uuid,t=r.uuid;let n=c[e];void 0===n&&(n={},c[e]=n);let i=n[t];void 0===i&&(i=d.clone(),n[t]=i),d=i}return d.visible=r.visible,d.wireframe=r.wireframe,d.side=u===$n?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:h[r.side],d.alphaMap=r.alphaMap,d.alphaTest=r.alphaTest,d.clipShadows=r.clipShadows,d.clippingPlanes=r.clippingPlanes,d.clipIntersection=r.clipIntersection,d.displacementMap=r.displacementMap,d.displacementScale=r.displacementScale,d.displacementBias=r.displacementBias,d.wireframeLinewidth=r.wireframeLinewidth,d.linewidth=r.linewidth,!0===i.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(i.matrixWorld),d.nearDistance=o,d.farDistance=s),d}function _(n,i,o,s,a){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===$n)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=t.update(n),i=n.material;if(Array.isArray(i)){const t=r.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=i[c.materialIndex];if(u&&u.visible){const t=v(n,0,u,s,o.near,o.far,a);e.renderBufferDirect(o,null,r,t,n,c)}}}else if(i.visible){const t=v(n,0,i,s,o.near,o.far,a);e.renderBufferDirect(o,null,r,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)_(l[e],i,o,s,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Zn,this.render=function(t,n,a){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(or),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=t.length;l<c;l++){const c=t[l],h=c.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;i.copy(h.mapSize);const p=h.getFrameExtents();if(i.multiply(p),o.copy(h.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(o.x=Math.floor(u/p.x),i.x=o.x*p.x,h.mapSize.x=o.x),i.y>u&&(o.y=Math.floor(u/p.y),i.y=o.y*p.y,h.mapSize.y=o.y)),null===h.map&&!h.isPointLightShadow&&this.type===$n){const e={minFilter:oi,magFilter:oi,format:xi};h.map=new Ps(i.x,i.y,e),h.map.texture.name=c.name+".shadowMap",h.mapPass=new Ps(i.x,i.y,e),h.camera.updateProjectionMatrix()}if(null===h.map){const e={minFilter:ei,magFilter:ei,format:xi};h.map=new Ps(i.x,i.y,e),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}e.setRenderTarget(h.map),e.clear();const f=h.getViewportCount();for(let e=0;e<f;e++){const t=h.getViewport(e);s.set(o.x*t.x,o.y*t.y,o.x*t.z,o.y*t.w),d.viewport(s),h.updateMatrices(c,e),r=h.getFrustum(),_(n,a,h.camera,c,this.type)}h.isPointLightShadow||this.type!==$n||y(h,a),h.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(l,c,h)}}function Ih(e,t,n){const r=n.isWebGL2,i=new function(){let t=!1;const n=new Ls;let r=null;const i=new Ls(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,s,a){!0===a&&(t*=s,r*=s,o*=s),n.set(t,r,o,s),!1===i.equals(n)&&(e.clearColor(t,r,o,s),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){let t=!1,n=null,r=null,i=null;return{setTest:function(e){e?U(2929):z(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case Ar:e.depthFunc(512);break;case Rr:e.depthFunc(519);break;case Cr:e.depthFunc(513);break;case Lr:e.depthFunc(515);break;case Pr:e.depthFunc(514);break;case Ir:e.depthFunc(518);break;case Or:e.depthFunc(516);break;case Nr:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},s=new function(){let t=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null;return{setTest:function(e){t||(e?U(2960):z(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,s){r===t&&i===n&&o===s||(e.stencilFunc(t,n,s),r=t,i=n,o=s)},setOp:function(t,n,r){s===t&&a===n&&l===r||(e.stencilOp(t,n,r),s=t,a=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null}}};let a={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,f=null,m=null,g=null,y=null,v=null,_=null,w=!1,b=null,x=null,E=null,S=null,M=null;const T=e.getParameter(35661);let A=!1,R=0;const C=e.getParameter(7938);-1!==C.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(C)[1]),A=R>=1):-1!==C.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(C)[1]),A=R>=2);let L=null,P={};const I=e.getParameter(3088),O=e.getParameter(2978),N=(new Ls).fromArray(I),k=(new Ls).fromArray(O);function D(t,n,r){const i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<r;t++)e.texImage2D(n+t,0,6408,1,1,0,6408,5121,i);return o}const B={};function U(t){!0!==a[t]&&(e.enable(t),a[t]=!0)}function z(t){!1!==a[t]&&(e.disable(t),a[t]=!1)}B[3553]=D(3553,3553,1),B[34067]=D(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),s.setClear(0),U(2929),o.setFunc(Lr),V(!1),j(Kn),U(2884),G(or);const F={[hr]:32774,[dr]:32778,[pr]:32779};if(r)F[fr]=32775,F[mr]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(F[fr]=e.MIN_EXT,F[mr]=e.MAX_EXT)}const H={[gr]:0,[yr]:1,[vr]:768,[wr]:770,[Tr]:776,[Sr]:774,[xr]:772,[_r]:769,[br]:771,[Mr]:775,[Er]:773};function G(t,n,r,i,o,s,a,l){if(t!==or){if(!1===d&&(U(3042),d=!0),t===ur)o=o||n,s=s||r,a=a||i,n===f&&o===y||(e.blendEquationSeparate(F[n],F[o]),f=n,y=o),r===m&&i===g&&s===v&&a===_||(e.blendFuncSeparate(H[r],H[i],H[s],H[a]),m=r,g=i,v=s,_=a),p=t,w=null;else if(t!==p||l!==w){if(f===hr&&y===hr||(e.blendEquation(32774),f=hr,y=hr),l)switch(t){case sr:e.blendFuncSeparate(1,771,1,771);break;case ar:e.blendFunc(1,1);break;case lr:e.blendFuncSeparate(0,769,0,1);break;case cr:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case sr:e.blendFuncSeparate(770,771,1,771);break;case ar:e.blendFunc(770,1);break;case lr:e.blendFuncSeparate(0,769,0,1);break;case cr:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}m=null,g=null,v=null,_=null,p=t,w=l}}else!0===d&&(z(3042),d=!1)}function V(t){b!==t&&(t?e.frontFace(2304):e.frontFace(2305),b=t)}function j(t){t!==qn?(U(2884),t!==x&&(t===Kn?e.cullFace(1029):t===Xn?e.cullFace(1028):e.cullFace(1032))):z(2884),x=t}function W(t,n,r){t?(U(32823),S===n&&M===r||(e.polygonOffset(n,r),S=n,M=r)):z(32823)}function q(t){void 0===t&&(t=33984+T-1),L!==t&&(e.activeTexture(t),L=t)}return{buffers:{color:i,depth:o,stencil:s},enable:U,disable:z,bindFramebuffer:function(t,n){return l[t]!==n&&(e.bindFramebuffer(t,n),l[t]=n,r&&(36009===t&&(l[36160]=n),36160===t&&(l[36009]=n)),!0)},drawBuffers:function(r,i){let o=u,s=!1;if(r)if(o=c.get(i),void 0===o&&(o=[],c.set(i,o)),r.isWebGLMultipleRenderTargets){const e=r.texture;if(o.length!==e.length||36064!==o[0]){for(let t=0,n=e.length;t<n;t++)o[t]=36064+t;o.length=e.length,s=!0}}else 36064!==o[0]&&(o[0]=36064,s=!0);else 1029!==o[0]&&(o[0]=1029,s=!0);s&&(n.isWebGL2?e.drawBuffers(o):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(o))},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:G,setMaterial:function(e,t){e.side===nr?z(2884):U(2884);let n=e.side===tr;t&&(n=!n),V(n),e.blending===sr&&!1===e.transparent?G(or):G(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),o.setFunc(e.depthFunc),o.setTest(e.depthTest),o.setMask(e.depthWrite),i.setMask(e.colorWrite);const r=e.stencilWrite;s.setTest(r),r&&(s.setMask(e.stencilWriteMask),s.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),s.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),W(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?U(32926):z(32926)},setFlipSided:V,setCullFace:j,setLineWidth:function(t){t!==E&&(A&&e.lineWidth(t),E=t)},setPolygonOffset:W,setScissorTest:function(e){e?U(3089):z(3089)},activeTexture:q,bindTexture:function(t,n){null===L&&q();let r=P[L];void 0===r&&(r={type:void 0,texture:void 0},P[L]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||B[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=P[L];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===k.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),k.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===r&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),a={},L=null,P={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,f=null,m=null,g=null,y=null,v=null,_=null,w=!1,b=null,x=null,E=null,S=null,M=null,N.set(0,0,e.canvas.width,e.canvas.height),k.set(0,0,e.canvas.width,e.canvas.height),i.reset(),o.reset(),s.reset()}}}function Oh(e,t,n,r,i,o,s){const a=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,u=i.maxTextureSize,h=i.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):void 0,p=new WeakMap;let f,m=!1;try{m="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function g(e,t){return m?new OffscreenCanvas(e,t):ys("canvas")}function y(e,t,n,r){let i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const r=t?us:Math.floor,o=r(i*e.width),s=r(i*e.height);void 0===f&&(f=g(o,s));const a=n?g(o,s):f;return a.width=o,a.height=s,a.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return ls(e.width)&&ls(e.height)}function _(e,t){return e.generateMipmaps&&t&&e.minFilter!==ei&&e.minFilter!==oi}function w(t){e.generateMipmap(t)}function b(n,r,i,o,s=!1){if(!1===a)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=r;return 6403===r&&(5126===i&&(l=33326),5131===i&&(l=33325),5121===i&&(l=33321)),33319===r&&(5126===i&&(l=33328),5131===i&&(l=33327),5121===i&&(l=33323)),6408===r&&(5126===i&&(l=34836),5131===i&&(l=34842),5121===i&&(l=o===wo&&!1===s?35907:32856),32819===i&&(l=32854),32820===i&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||t.get("EXT_color_buffer_float"),l}function x(e,t,n){return!0===_(e,n)||e.isFramebufferTexture&&e.minFilter!==ei&&e.minFilter!==oi?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function E(e){return e===ei||e===ti||e===ri?9728:9729}function S(t){const n=t.target;n.removeEventListener("dispose",S),function(t){const n=r.get(t);void 0!==n.__webglInit&&(e.deleteTexture(n.__webglTexture),r.remove(t))}(n),n.isVideoTexture&&p.delete(n),s.memory.textures--}function M(t){const n=t.target;n.removeEventListener("dispose",M),function(t){const n=t.texture,i=r.get(t),o=r.get(n);if(t){if(void 0!==o.__webglTexture&&(e.deleteTexture(o.__webglTexture),s.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(i.__webglFramebuffer[t]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[t]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(let t=0,i=n.length;t<i;t++){const i=r.get(n[t]);i.__webglTexture&&(e.deleteTexture(i.__webglTexture),s.memory.textures--),r.remove(n[t])}r.remove(n),r.remove(t)}}(n)}let T=0;function A(e,t){const i=r.get(e);if(e.isVideoTexture&&function(e){const t=s.render.frame;p.get(e)!==t&&(p.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){const n=e.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void O(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function R(t,i){const s=r.get(t);t.version>0&&s.__version!==t.version?function(t,r,i){if(6!==r.image.length)return;I(t,r),n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);const s=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),l=r.image[0]&&r.image[0].isDataTexture,u=[];for(let e=0;e<6;e++)u[e]=s||l?l?r.image[e].image:r.image[e]:y(r.image[e],!1,!0,c),u[e]=U(r,u[e]);const h=u[0],d=v(h)||a,p=o.convert(r.format,r.encoding),f=o.convert(r.type),m=b(r.internalFormat,p,f,r.encoding),g=a&&!0!==r.isVideoTexture,E=void 0===t.__version;let S,M=x(r,h,d);if(P(34067,r,d),s){g&&E&&n.texStorage2D(34067,M,m,h.width,h.height);for(let e=0;e<6;e++){S=u[e].mipmaps;for(let t=0;t<S.length;t++){const i=S[t];r.format!==xi?null!==p?g?n.compressedTexSubImage2D(34069+e,t,0,0,i.width,i.height,p,i.data):n.compressedTexImage2D(34069+e,t,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?n.texSubImage2D(34069+e,t,0,0,i.width,i.height,p,f,i.data):n.texImage2D(34069+e,t,m,i.width,i.height,0,p,f,i.data)}}}else{S=r.mipmaps,g&&E&&(S.length>0&&M++,n.texStorage2D(34067,M,m,u[0].width,u[0].height));for(let e=0;e<6;e++)if(l){g?n.texSubImage2D(34069+e,0,0,0,u[e].width,u[e].height,p,f,u[e].data):n.texImage2D(34069+e,0,m,u[e].width,u[e].height,0,p,f,u[e].data);for(let t=0;t<S.length;t++){const r=S[t].image[e].image;g?n.texSubImage2D(34069+e,t+1,0,0,r.width,r.height,p,f,r.data):n.texImage2D(34069+e,t+1,m,r.width,r.height,0,p,f,r.data)}}else{g?n.texSubImage2D(34069+e,0,0,0,p,f,u[e]):n.texImage2D(34069+e,0,m,p,f,u[e]);for(let t=0;t<S.length;t++){const r=S[t];g?n.texSubImage2D(34069+e,t+1,0,0,p,f,r.image[e]):n.texImage2D(34069+e,t+1,m,p,f,r.image[e])}}}_(r,d)&&w(34067),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(s,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,s.__webglTexture))}const C={[Zr]:10497,[Qr]:33071,[$r]:33648},L={[ei]:9728,[ti]:9984,[ri]:9986,[oi]:9729,[si]:9985,[li]:9987};function P(n,o,s){if(s?(e.texParameteri(n,10242,C[o.wrapS]),e.texParameteri(n,10243,C[o.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,C[o.wrapR]),e.texParameteri(n,10240,L[o.magFilter]),e.texParameteri(n,10241,L[o.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS===Qr&&o.wrapT===Qr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,E(o.magFilter)),e.texParameteri(n,10241,E(o.minFilter)),o.minFilter!==ei&&o.minFilter!==oi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const s=t.get("EXT_texture_filter_anisotropic");if(o.type===gi&&!1===t.has("OES_texture_float_linear"))return;if(!1===a&&o.type===yi&&!1===t.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function I(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",S),t.__webglTexture=e.createTexture(),s.memory.textures++)}function O(t,r,i){let s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),I(t,r),n.activeTexture(33984+i),n.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);const l=function(e){return!a&&(e.wrapS!==Qr||e.wrapT!==Qr||e.minFilter!==ei&&e.minFilter!==oi)}(r)&&!1===v(r.image);let c=y(r.image,l,!1,u);c=U(r,c);const h=v(c)||a,d=o.convert(r.format,r.encoding);let p,f=o.convert(r.type),m=b(r.internalFormat,d,f,r.encoding,r.isVideoTexture);P(s,r,h);const g=r.mipmaps,E=a&&!0!==r.isVideoTexture,S=void 0===t.__version,M=x(r,c,h);if(r.isDepthTexture)m=6402,a?m=r.type===gi?36012:r.type===mi?33190:r.type===wi?35056:33189:r.type===gi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===Mi&&6402===m&&r.type!==pi&&r.type!==mi&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=pi,f=o.convert(r.type)),r.format===Ti&&6402===m&&(m=34041,r.type!==wi&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=wi,f=o.convert(r.type))),E&&S?n.texStorage2D(3553,1,m,c.width,c.height):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,null);else if(r.isDataTexture)if(g.length>0&&h){E&&S&&n.texStorage2D(3553,M,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],E?n.texSubImage2D(3553,0,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,e,m,p.width,p.height,0,d,f,p.data);r.generateMipmaps=!1}else E?(S&&n.texStorage2D(3553,M,m,c.width,c.height),n.texSubImage2D(3553,0,0,0,c.width,c.height,d,f,c.data)):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,c.data);else if(r.isCompressedTexture){E&&S&&n.texStorage2D(3553,M,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],r.format!==xi?null!==d?E?n.compressedTexSubImage2D(3553,e,0,0,p.width,p.height,d,p.data):n.compressedTexImage2D(3553,e,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?n.texSubImage2D(3553,e,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,e,m,p.width,p.height,0,d,f,p.data)}else if(r.isDataTexture2DArray)E?(S&&n.texStorage3D(35866,M,m,c.width,c.height,c.depth),n.texSubImage3D(35866,0,0,0,0,c.width,c.height,c.depth,d,f,c.data)):n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,d,f,c.data);else if(r.isDataTexture3D)E?(S&&n.texStorage3D(32879,M,m,c.width,c.height,c.depth),n.texSubImage3D(32879,0,0,0,0,c.width,c.height,c.depth,d,f,c.data)):n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,d,f,c.data);else if(r.isFramebufferTexture)E&&S?n.texStorage2D(3553,M,m,c.width,c.height):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,null);else if(g.length>0&&h){E&&S&&n.texStorage2D(3553,M,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],E?n.texSubImage2D(3553,e,0,0,d,f,p):n.texImage2D(3553,e,m,d,f,p);r.generateMipmaps=!1}else E?(S&&n.texStorage2D(3553,M,m,c.width,c.height),n.texSubImage2D(3553,0,0,0,d,f,c)):n.texImage2D(3553,0,m,d,f,c);_(r,h)&&w(s),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function N(t,i,s,a,l){const c=o.convert(s.format,s.encoding),u=o.convert(s.type),h=b(s.internalFormat,c,u,s.encoding);r.get(i).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(l,0,h,i.width,i.height,0,c,u,null)),n.bindFramebuffer(36160,t),i.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,a,l,r.get(s).__webglTexture,0,B(i)):e.framebufferTexture2D(36160,a,l,r.get(s).__webglTexture,0),n.bindFramebuffer(36160,null)}function k(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r||n.useRenderToTexture){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===gi?i=36012:t.type===mi&&(i=33190));const r=B(n);n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,r,i,n.width,n.height):e.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){const i=B(n);r&&n.useRenderbuffer?e.renderbufferStorageMultisample(36161,i,35056,n.width,n.height):n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,i,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,i=o.convert(t.format,t.encoding),s=o.convert(t.type),a=b(t.internalFormat,i,s,t.encoding),l=B(n);r&&n.useRenderbuffer?e.renderbufferStorageMultisample(36161,l,a,n.width,n.height):n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,l,a,n.width,n.height):e.renderbufferStorage(36161,a,n.width,n.height)}e.bindRenderbuffer(36161,null)}function D(t){const i=r.get(t),o=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),A(i.depthTexture,0);const o=r.get(i.depthTexture).__webglTexture,s=B(i);if(i.depthTexture.format===Mi)i.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,o,0,s):e.framebufferTexture2D(36160,36096,3553,o,0);else{if(i.depthTexture.format!==Ti)throw new Error("Unknown depthTexture format");i.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,o,0,s):e.framebufferTexture2D(36160,33306,3553,o,0)}}(i.__webglFramebuffer,t)}else if(o){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(36160,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=e.createRenderbuffer(),k(i.__webglDepthbuffer[r],t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),k(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function B(e){return a&&(e.useRenderbuffer||e.useRenderToTexture)?Math.min(h,e.samples):0}function U(e,n){const r=e.encoding,i=e.format,o=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===Qo||r!==_o&&(r===wo?!1===a?!0===t.has("EXT_sRGB")&&i===xi?(e.format=Qo,e.minFilter=oi,e.generateMipmaps=!1):n=Ts.sRGBToLinear(n):i===xi&&o===ui||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",r)),n}let z=!1,F=!1;this.allocateTextureUnit=function(){const e=T;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=A,this.setTexture2DArray=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?O(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?O(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=R,this.rebindTextures=function(e,t,n){const i=r.get(e);void 0!==t&&N(i.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&D(e)},this.setupRenderTarget=function(t){const l=t.texture,c=r.get(t),u=r.get(l);t.addEventListener("dispose",M),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=l.version,s.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=l.isDataTexture3D||l.isDataTexture2DArray,f=v(t)||a;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else if(c.__webglFramebuffer=e.createFramebuffer(),d)if(i.drawBuffers){const n=t.texture;for(let t=0,i=n.length;t<i;t++){const i=r.get(n[t]);void 0===i.__webglTexture&&(i.__webglTexture=e.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(t.useRenderbuffer)if(a){c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const r=o.convert(l.format,l.encoding),i=o.convert(l.type),s=b(l.internalFormat,r,i,l.encoding),a=B(t);e.renderbufferStorageMultisample(36161,a,s,t.width,t.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),k(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(34067,u.__webglTexture),P(34067,l,f);for(let e=0;e<6;e++)N(c.__webglFramebuffer[e],t,l,36064,34069+e);_(l,f)&&w(34067),n.unbindTexture()}else if(d){const e=t.texture;for(let i=0,o=e.length;i<o;i++){const o=e[i],s=r.get(o);n.bindTexture(3553,s.__webglTexture),P(3553,o,f),N(c.__webglFramebuffer,t,o,36064+i,3553),_(o,f)&&w(3553)}n.unbindTexture()}else{let e=3553;p&&(a?e=l.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(e,u.__webglTexture),P(e,l,f),N(c.__webglFramebuffer,t,l,36064,e),_(l,f)&&w(e),n.unbindTexture()}t.depthBuffer&&D(t)},this.updateRenderTargetMipmap=function(e){const t=v(e)||a,i=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let o=0,s=i.length;o<s;o++){const s=i[o];if(_(s,t)){const t=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(s).__webglTexture;n.bindTexture(t,i),w(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.useRenderbuffer)if(a){const i=t.width,o=t.height;let s=16384;const a=[36064],l=t.stencilBuffer?33306:36096;t.depthBuffer&&a.push(l),t.ignoreDepthForMultisampleCopy||(t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024));const c=r.get(t);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer),t.ignoreDepthForMultisampleCopy&&(e.invalidateFramebuffer(36008,[l]),e.invalidateFramebuffer(36009,[l])),e.blitFramebuffer(0,0,i,o,0,0,i,o,s,9728),e.invalidateFramebuffer(36008,a),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=D,this.setupFrameBufferTexture=N,this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),R(e,t)}}function Nh(e,t,n){const r=n.isWebGL2;return{convert:function(e,n=null){let i;if(e===ui)return 5121;if(e===vi)return 32819;if(e===_i)return 32820;if(e===hi)return 5120;if(e===di)return 5122;if(e===pi)return 5123;if(e===fi)return 5124;if(e===mi)return 5125;if(e===gi)return 5126;if(e===yi)return r?5131:(i=t.get("OES_texture_half_float"),null!==i?i.HALF_FLOAT_OES:null);if(e===bi)return 6406;if(e===xi)return 6408;if(e===Ei)return 6409;if(e===Si)return 6410;if(e===Mi)return 6402;if(e===Ti)return 34041;if(e===Ai)return 6403;if(e===Qo)return i=t.get("EXT_sRGB"),null!==i?i.SRGB_ALPHA_EXT:null;if(e===Ri)return 36244;if(e===Ci)return 33319;if(e===Li)return 33320;if(e===Pi)return 36249;if(e===Ii||e===Oi||e===Ni||e===ki)if(n===wo){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(e===Ii)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===Oi)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Ni)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===ki)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(e===Ii)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Oi)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Ni)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===ki)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===Di||e===Bi||e===Ui||e===zi){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(e===Di)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Bi)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ui)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===zi)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===Fi)return i=t.get("WEBGL_compressed_texture_etc1"),null!==i?i.COMPRESSED_RGB_ETC1_WEBGL:null;if(e===Hi||e===Gi){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(e===Hi)return n===wo?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===Gi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(e===Vi||e===ji||e===Wi||e===qi||e===Ki||e===Xi||e===Yi||e===Ji||e===Zi||e===Qi||e===$i||e===eo||e===to||e===no){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(e===Vi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===ji)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===Wi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===qi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===Ki)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===Xi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Yi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Ji)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Zi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Qi)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===$i)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===eo)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===to)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===no)return n===wo?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===ro){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(e===ro)return n===wo?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}return e===wi?r?34042:(i=t.get("WEBGL_depth_texture"),null!==i?i.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Lh.prototype.isMeshDistanceMaterial=!0;class kh extends jl{constructor(e=[]){super(),this.cameras=e}}kh.prototype.isArrayCamera=!0;class Dh extends Ba{constructor(){super(),this.type="Group"}}Dh.prototype.isGroup=!0;const Bh={type:"move"};class Uh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Dh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Dh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ks,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ks),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Dh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ks,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ks),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,o=null;const s=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==s&&(r=t.getPose(e.targetRaySpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Bh))),l&&e.hand){o=!0;for(const r of e.hand.values()){const e=t.getJointPose(r,n);if(void 0===l.joints[r.jointName]){const e=new Dh;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[r.jointName]=e,l.add(e)}const i=l.joints[r.jointName];null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),a=.02,c=.005;l.inputState.pinching&&s>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));return null!==s&&(s.visible=null!==r),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==o),this}}class zh extends Rs{constructor(e,t,n,r,i,o,s,a,l,c){if((c=void 0!==c?c:Mi)!==Mi&&c!==Ti)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Mi&&(n=pi),void 0===n&&c===Ti&&(n=wi),super(null,r,i,o,s,a,c,n,l),this.image={width:e,height:t},this.magFilter=void 0!==s?s:ei,this.minFilter=void 0!==a?a:ei,this.flipY=!1,this.generateMipmaps=!1}}zh.prototype.isDepthTexture=!0;class Fh extends $o{constructor(e,t){super();const n=this;let r=null,i=1,o=null,s="local-floor";const a=e.extensions.has("WEBGL_multisampled_render_to_texture");let l=null,c=null,u=null,h=null,d=!1,p=null;const f=t.getContextAttributes();let m=null,g=null;const y=[],v=new Map,_=new jl;_.layers.enable(1),_.viewport=new Ls;const w=new jl;w.layers.enable(2),w.viewport=new Ls;const b=[_,w],x=new kh;x.layers.enable(1),x.layers.enable(2);let E=null,S=null;function M(e){const t=v.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function T(){v.forEach((function(e,t){e.disconnect(t)})),v.clear(),E=null,S=null,e.setRenderTarget(m),h=null,u=null,c=null,r=null,g=null,I.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function A(e){const t=r.inputSources;for(let e=0;e<y.length;e++)v.set(t[e],y[e]);for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=v.get(n);r&&(r.dispatchEvent({type:"disconnected",data:n}),v.delete(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t],r=v.get(n);r&&r.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=y[e];return void 0===t&&(t=new Uh,y[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=y[e];return void 0===t&&(t=new Uh,y[e]=t),t.getGripSpace()},this.getHand=function(e){let t=y[e];return void 0===t&&(t=new Uh,y[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(l){if(r=l,null!==r){if(m=e.getRenderTarget(),r.addEventListener("select",M),r.addEventListener("selectstart",M),r.addEventListener("selectend",M),r.addEventListener("squeeze",M),r.addEventListener("squeezestart",M),r.addEventListener("squeezeend",M),r.addEventListener("end",T),r.addEventListener("inputsourceschange",A),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2){const n={antialias:void 0!==r.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:h}),g=new Ps(h.framebufferWidth,h.framebufferHeight,{format:xi,type:ui,encoding:e.outputEncoding})}else{d=f.antialias;let n=null,o=null,s=null;f.depth&&(s=f.stencil?35056:33190,n=f.stencil?Ti:Mi,o=f.stencil?wi:pi);const l={colorFormat:e.outputEncoding===wo?35907:32856,depthFormat:s,scaleFactor:i};c=new XRWebGLBinding(r,t),u=c.createProjectionLayer(l),r.updateRenderState({layers:[u]}),g=d?new Os(u.textureWidth,u.textureHeight,{format:xi,type:ui,depthTexture:new zh(u.textureWidth,u.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,useRenderToTexture:a,encoding:e.outputEncoding}):new Ps(u.textureWidth,u.textureHeight,{format:xi,type:ui,depthTexture:new zh(u.textureWidth,u.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,encoding:e.outputEncoding})}g.isXRRenderTarget=!0,this.setFoveation(1),o=await r.requestReferenceSpace(s),I.setContext(r),I.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const R=new ks,C=new ks;function L(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;x.near=w.near=_.near=e.near,x.far=w.far=_.far=e.far,E===x.near&&S===x.far||(r.updateRenderState({depthNear:x.near,depthFar:x.far}),E=x.near,S=x.far);const t=e.parent,n=x.cameras;L(x,t);for(let e=0;e<n.length;e++)L(n[e],t);x.matrixWorld.decompose(x.position,x.quaternion,x.scale),e.position.copy(x.position),e.quaternion.copy(x.quaternion),e.scale.copy(x.scale),e.matrix.copy(x.matrix),e.matrixWorld.copy(x.matrixWorld);const i=e.children;for(let e=0,t=i.length;e<t;e++)i[e].updateMatrixWorld(!0);2===n.length?function(e,t,n){R.setFromMatrixPosition(t.matrixWorld),C.setFromMatrixPosition(n.matrixWorld);const r=R.distanceTo(C),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,s=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(o[8]+1)/o[0],d=s*u,p=s*h,f=r/(-u+h),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=s+f,y=a+f,v=d-m,_=p+(r-m),w=l*a/y*g,b=c*a/y*g;e.projectionMatrix.makePerspective(v,_,w,b,g,y)}(x,_,w):x.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return x},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(e){null!==u&&(u.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)};let P=null;const I=new nc;I.setAnimationLoop((function(t,n){if(l=n.getViewerPose(o),p=n,null!==l){const t=l.views;null!==h&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let n=!1;t.length!==x.cameras.length&&(x.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r];let o=null;if(null!==h)o=h.getViewport(i);else{const t=c.getViewSubImage(u,i);o=t.viewport,0===r&&(e.setRenderTargetTextures(g,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}const s=b[r];s.matrix.fromArray(i.transform.matrix),s.projectionMatrix.fromArray(i.projectionMatrix),s.viewport.set(o.x,o.y,o.width,o.height),0===r&&x.matrix.copy(s.matrix),!0===n&&x.cameras.push(s)}}const i=r.inputSources;for(let e=0;e<y.length;e++){const t=y[e],r=i[e];t.update(r,n,o)}P&&P(t,n),p=null})),this.setAnimationLoop=function(e){P=e},this.dispose=function(){}}}function Hh(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap),n.alphaTest>0&&(t.alphaTest.value=n.alphaTest);const r=e.get(n).envMap;let i,o;r&&(t.envMap.value=r,t.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,t.reflectivity.value=n.reflectivity,t.ior.value=n.ior,t.refractionRatio.value=n.refractionRatio),n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?i=n.map:n.specularMap?i=n.specularMap:n.displacementMap?i=n.displacementMap:n.normalMap?i=n.normalMap:n.bumpMap?i=n.bumpMap:n.roughnessMap?i=n.roughnessMap:n.metalnessMap?i=n.metalnessMap:n.alphaMap?i=n.alphaMap:n.emissiveMap?i=n.emissiveMap:n.clearcoatMap?i=n.clearcoatMap:n.clearcoatNormalMap?i=n.clearcoatNormalMap:n.clearcoatRoughnessMap?i=n.clearcoatRoughnessMap:n.specularIntensityMap?i=n.specularIntensityMap:n.specularColorMap?i=n.specularColorMap:n.transmissionMap?i=n.transmissionMap:n.thicknessMap?i=n.thicknessMap:n.sheenColorMap?i=n.sheenColorMap:n.sheenRoughnessMap&&(i=n.sheenRoughnessMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uv2Transform.value.copy(o.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===tr&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===tr&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,o,s){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===tr&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===tr&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===tr&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===tr&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t,r){n(e,t),e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===tr&&e.clearcoatNormalScale.value.negate())),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,r,s):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===tr&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===tr&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===tr&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===tr&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){let i;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,o):r.isSpriteMaterial?function(e,t){let n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Gh(e={}){const t=void 0!==e.canvas?e.canvas:function(){const e=ys("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h=null,d=null;const p=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=_o,this.physicallyCorrectLights=!1,this.toneMapping=Ur,this.toneMappingExposure=1;const m=this;let g=!1,y=0,v=0,_=null,w=-1,b=null;const x=new Ls,E=new Ls;let S=null,M=t.width,T=t.height,A=1,R=null,C=null;const L=new Ls(0,0,M,T),P=new Ls(0,0,M,T);let I=!1;const O=new tc;let N=!1,k=!1,D=null;const B=new da,U=new ks,z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function F(){return null===_?A:1}let H,G,V,j,W,q,K,X,Y,J,Z,Q,$,ee,te,ne,re,ie,oe,se,ae,le,ce,ue=n;function he(e,n){for(let r=0;r<e.length;r++){const i=e[r],o=t.getContext(i,n);if(null!==o)return o}return null}try{const e={alpha:!0,depth:i,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Vn}`),t.addEventListener("webglcontextlost",fe,!1),t.addEventListener("webglcontextrestored",me,!1),null===ue){const t=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&t.shift(),ue=he(t,e),null===ue)throw he(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ue.getShaderPrecisionFormat&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function de(){H=new kc(ue),G=new hc(ue,H,e),H.init(G),le=new Nh(ue,H,G),V=new Ih(ue,H,G),j=new Uc(ue),W=new vh,q=new Oh(ue,H,V,W,G,le,j),K=new pc(m),X=new Nc(m),Y=new rc(ue,G),ce=new cc(ue,H,Y,G),J=new Dc(ue,Y,j,ce),Z=new jc(ue,J,Y,j),oe=new Vc(ue,G,q),ne=new dc(W),Q=new yh(m,K,X,H,G,ce,ne),$=new Hh(W),ee=new xh,te=new Rh(H,G),ie=new lc(m,K,V,Z,r,a),re=new Ph(m,Z,G),se=new uc(ue,H,j,G),ae=new Bc(ue,H,j,G),j.programs=Q.programs,m.capabilities=G,m.extensions=H,m.properties=W,m.renderLists=ee,m.shadowMap=re,m.state=V,m.info=j}de();const pe=new Fh(m,ue);function fe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function me(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const e=j.autoReset,t=re.enabled,n=re.autoUpdate,r=re.needsUpdate,i=re.type;de(),j.autoReset=e,re.enabled=t,re.autoUpdate=n,re.needsUpdate=r,re.type=i}function ge(e){const t=e.target;t.removeEventListener("dispose",ge),function(e){(function(e){const t=W.get(e).programs;void 0!==t&&(t.forEach((function(e){Q.releaseProgram(e)})),e.isShaderMaterial&&Q.releaseShaderCache(e))})(e),W.remove(e)}(t)}this.xr=pe,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){const e=H.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=H.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return A},this.setPixelRatio=function(e){void 0!==e&&(A=e,this.setSize(M,T,!1))},this.getSize=function(e){return e.set(M,T)},this.setSize=function(e,n,r){pe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(M=e,T=n,t.width=Math.floor(e*A),t.height=Math.floor(n*A),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(M*A,T*A).floor()},this.setDrawingBufferSize=function(e,n,r){M=e,T=n,A=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(x)},this.getViewport=function(e){return e.copy(L)},this.setViewport=function(e,t,n,r){e.isVector4?L.set(e.x,e.y,e.z,e.w):L.set(e,t,n,r),V.viewport(x.copy(L).multiplyScalar(A).floor())},this.getScissor=function(e){return e.copy(P)},this.setScissor=function(e,t,n,r){e.isVector4?P.set(e.x,e.y,e.z,e.w):P.set(e,t,n,r),V.scissor(E.copy(P).multiplyScalar(A).floor())},this.getScissorTest=function(){return I},this.setScissorTest=function(e){V.setScissorTest(I=e)},this.setOpaqueSort=function(e){R=e},this.setTransparentSort=function(e){C=e},this.getClearColor=function(e){return e.copy(ie.getClearColor())},this.setClearColor=function(){ie.setClearColor.apply(ie,arguments)},this.getClearAlpha=function(){return ie.getClearAlpha()},this.setClearAlpha=function(){ie.setClearAlpha.apply(ie,arguments)},this.clear=function(e,t,n){let r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),ue.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",fe,!1),t.removeEventListener("webglcontextrestored",me,!1),ee.dispose(),te.dispose(),W.dispose(),K.dispose(),X.dispose(),Z.dispose(),ce.dispose(),Q.dispose(),pe.dispose(),pe.removeEventListener("sessionstart",ve),pe.removeEventListener("sessionend",_e),D&&(D.dispose(),D=null),we.stop()},this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=z);const s=i.isMesh&&i.matrixWorld.determinant()<0,a=function(e,t,n,r,i){!0!==t.isScene&&(t=z),q.resetTextureUnits();const o=t.fog,s=r.isMeshStandardMaterial?t.environment:null,a=null===_?m.outputEncoding:!0===_.isXRRenderTarget?_.texture.encoding:_o,l=(r.isMeshStandardMaterial?X:K).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,f=n.morphAttributes.position?n.morphAttributes.position.length:0,g=r.toneMapped?m.toneMapping:Ur,y=W.get(r),v=d.state.lights;if(!0===N&&(!0===k||e!==b)){const t=e===b&&r.id===w;ne.setState(r,e,t)}let x=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==v.state.version||y.outputEncoding!==a||i.isInstancedMesh&&!1===y.instancing?x=!0:i.isInstancedMesh||!0!==y.instancing?i.isSkinnedMesh&&!1===y.skinning?x=!0:i.isSkinnedMesh||!0!==y.skinning?y.envMap!==l||r.fog&&y.fog!==o?x=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===ne.numPlanes&&y.numIntersection===ne.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==h||y.morphNormals!==p||y.toneMapping!==g||!0===G.isWebGL2&&y.morphTargetsCount!==f)&&(x=!0):x=!0:x=!0:x=!0:(x=!0,y.__version=r.version);let E=y.currentProgram;!0===x&&(E=Me(r,t,i));let S=!1,M=!1,R=!1;const C=E.getUniforms(),L=y.uniforms;if(V.useProgram(E.program)&&(S=!0,M=!0,R=!0),r.id!==w&&(w=r.id,M=!0),S||b!==e){if(C.setValue(ue,"projectionMatrix",e.projectionMatrix),G.logarithmicDepthBuffer&&C.setValue(ue,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),b!==e&&(b=e,M=!0,R=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const t=C.map.cameraPosition;void 0!==t&&t.setValue(ue,U.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&C.setValue(ue,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&C.setValue(ue,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){C.setOptional(ue,i,"bindMatrix"),C.setOptional(ue,i,"bindMatrixInverse");const e=i.skeleton;e&&(G.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),C.setValue(ue,"boneTexture",e.boneTexture,q),C.setValue(ue,"boneTextureSize",e.boneTextureSize)):C.setOptional(ue,e,"boneMatrices"))}var P,I;return!n||void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||oe.update(i,n,r,E),(M||y.receiveShadow!==i.receiveShadow)&&(y.receiveShadow=i.receiveShadow,C.setValue(ue,"receiveShadow",i.receiveShadow)),M&&(C.setValue(ue,"toneMappingExposure",m.toneMappingExposure),y.needsLights&&(I=R,(P=L).ambientLightColor.needsUpdate=I,P.lightProbe.needsUpdate=I,P.directionalLights.needsUpdate=I,P.directionalLightShadows.needsUpdate=I,P.pointLights.needsUpdate=I,P.pointLightShadows.needsUpdate=I,P.spotLights.needsUpdate=I,P.spotLightShadows.needsUpdate=I,P.rectAreaLights.needsUpdate=I,P.hemisphereLights.needsUpdate=I),o&&r.fog&&$.refreshFogUniforms(L,o),$.refreshMaterialUniforms(L,r,A,T,D),Yu.upload(ue,y.uniformsList,L,q)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Yu.upload(ue,y.uniformsList,L,q),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&C.setValue(ue,"center",i.center),C.setValue(ue,"modelViewMatrix",i.modelViewMatrix),C.setValue(ue,"normalMatrix",i.normalMatrix),C.setValue(ue,"modelMatrix",i.matrixWorld),E}(e,t,n,r,i);V.setMaterial(r,s);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===r.wireframe&&(l=J.getWireframeAttribute(n),h=2),ce.setup(i,r,a,n,l);let p=se;null!==l&&(u=Y.get(l),p=ae,p.setIndex(u));const f=null!==l?l.count:c.count,g=n.drawRange.start*h,y=n.drawRange.count*h,v=null!==o?o.start*h:0,x=null!==o?o.count*h:1/0,E=Math.max(g,v),S=Math.min(f,g+y,v+x)-1,M=Math.max(0,S-E+1);if(0!==M){if(i.isMesh)!0===r.wireframe?(V.setLineWidth(r.wireframeLinewidth*F()),p.setMode(1)):p.setMode(4);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),V.setLineWidth(e*F()),i.isLineSegments?p.setMode(1):i.isLineLoop?p.setMode(2):p.setMode(3)}else i.isPoints?p.setMode(0):i.isSprite&&p.setMode(4);if(i.isInstancedMesh)p.renderInstances(E,M,i.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);p.renderInstances(E,M,e)}else p.render(E,M)}},this.compile=function(e,t){d=te.get(e),d.init(),f.push(d),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(m.physicallyCorrectLights),e.traverse((function(t){const n=t.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++)Me(n[r],e,t);else Me(n,e,t)})),f.pop(),d=null};let ye=null;function ve(){we.stop()}function _e(){we.start()}const we=new nc;function be(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||O.intersectsSprite(e)){r&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);const t=Z.update(e),i=e.material;i.visible&&h.push(e,t,i,n,U.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==j.render.frame&&(e.skeleton.update(),e.skeleton.frame=j.render.frame),!e.frustumCulled||O.intersectsObject(e))){r&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);const t=Z.update(e),i=e.material;if(Array.isArray(i)){const r=t.groups;for(let o=0,s=r.length;o<s;o++){const s=r[o],a=i[s.materialIndex];a&&a.visible&&h.push(e,t,a,n,U.z,s)}}else i.visible&&h.push(e,t,i,n,U.z,null)}const i=e.children;for(let e=0,o=i.length;e<o;e++)be(i[e],t,n,r)}function xe(e,t,n,r){const i=e.opaque,o=e.transmissive,a=e.transparent;d.setupLightsView(n),o.length>0&&function(e,t,n){if(null===D){const e=!0===s&&!0===G.isWebGL2;D=new(e?Os:Ps)(1024,1024,{generateMipmaps:!0,type:null!==le.convert(yi)?yi:ui,minFilter:li,magFilter:ei,wrapS:Qr,wrapT:Qr,useRenderToTexture:H.has("WEBGL_multisampled_render_to_texture")})}const r=m.getRenderTarget();m.setRenderTarget(D),m.clear();const i=m.toneMapping;m.toneMapping=Ur,Ee(e,t,n),m.toneMapping=i,q.updateMultisampleRenderTarget(D),q.updateRenderTargetMipmap(D),m.setRenderTarget(r)}(i,t,n),r&&V.viewport(x.copy(r)),i.length>0&&Ee(i,t,n),o.length>0&&Ee(o,t,n),a.length>0&&Ee(a,t,n)}function Ee(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,o=e.length;i<o;i++){const o=e[i],s=o.object,a=o.geometry,l=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&Se(s,t,n,a,l,c)}}function Se(e,t,n,r,i,o){e.onBeforeRender(m,t,n,r,i,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(m,t,n,r,e,o),!0===i.transparent&&i.side===nr?(i.side=tr,i.needsUpdate=!0,m.renderBufferDirect(n,t,r,i,e,o),i.side=er,i.needsUpdate=!0,m.renderBufferDirect(n,t,r,i,e,o),i.side=nr):m.renderBufferDirect(n,t,r,i,e,o),e.onAfterRender(m,t,n,r,i,o)}function Me(e,t,n){!0!==t.isScene&&(t=z);const r=W.get(e),i=d.state.lights,o=d.state.shadowsArray,s=i.state.version,a=Q.getParameters(e,i.state,o,t,n),l=Q.getProgramCacheKey(a);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?X:K).get(e.envMap||r.environment),void 0===c&&(e.addEventListener("dispose",ge),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===s)return Te(e,a),u}else a.uniforms=Q.getUniforms(e),e.onBuild(n,a,m),e.onBeforeCompile(a,m),u=Q.acquireProgram(a,l),c.set(l,u),r.uniforms=a.uniforms;const h=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=ne.uniform),Te(e,a),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const p=u.getUniforms(),f=Yu.seqWithValue(p.seq,h);return r.currentProgram=u,r.uniformsList=f,u}function Te(e,t){const n=W.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}we.setAnimationLoop((function(e){ye&&ye(e)})),"undefined"!=typeof window&&we.setContext(window),this.setAnimationLoop=function(e){ye=e,pe.setAnimationLoop(e),null===e?we.stop():we.start()},pe.addEventListener("sessionstart",ve),pe.addEventListener("sessionend",_e),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===pe.enabled&&!0===pe.isPresenting&&(!0===pe.cameraAutoUpdate&&pe.updateCamera(t),t=pe.getCamera()),!0===e.isScene&&e.onBeforeRender(m,e,t,_),d=te.get(e,f.length),d.init(),f.push(d),B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),O.setFromProjectionMatrix(B),k=this.localClippingEnabled,N=ne.init(this.clippingPlanes,k,t),h=ee.get(e,p.length),h.init(),p.push(h),be(e,t,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(R,C),!0===N&&ne.beginShadows();const n=d.state.shadowsArray;if(re.render(n,e,t),!0===N&&ne.endShadows(),!0===this.info.autoReset&&this.info.reset(),ie.render(h,e),d.setupLights(m.physicallyCorrectLights),t.isArrayCamera){const n=t.cameras;for(let t=0,r=n.length;t<r;t++){const r=n[t];xe(h,e,r,r.viewport)}}else xe(h,e,t);null!==_&&(q.updateMultisampleRenderTarget(_),q.updateRenderTargetMipmap(_)),!0===e.isScene&&e.onAfterRender(m,e,t),V.buffers.depth.setTest(!0),V.buffers.depth.setMask(!0),V.buffers.color.setMask(!0),V.setPolygonOffset(!1),ce.resetDefaultState(),w=-1,b=null,f.pop(),d=f.length>0?f[f.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(e,t,n){W.get(e.texture).__webglTexture=t,W.get(e.depthTexture).__webglTexture=n;const r=W.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||e.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),e.useRenderToTexture=!1,e.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(e,t){const n=W.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,n=0){_=e,y=t,v=n;let r=!0;if(e){const t=W.get(e);void 0!==t.__useDefaultFramebuffer?(V.bindFramebuffer(36160,null),r=!1):void 0===t.__webglFramebuffer?q.setupRenderTarget(e):t.__hasExternalTextures&&q.rebindTextures(e,W.get(e.texture).__webglTexture,W.get(e.depthTexture).__webglTexture)}let i=null,o=!1,s=!1;if(e){const n=e.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(s=!0);const r=W.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=r[t],o=!0):i=e.useRenderbuffer?W.get(e).__webglMultisampledFramebuffer:r,x.copy(e.viewport),E.copy(e.scissor),S=e.scissorTest}else x.copy(L).multiplyScalar(A).floor(),E.copy(P).multiplyScalar(A).floor(),S=I;if(V.bindFramebuffer(36160,i)&&G.drawBuffers&&r&&V.drawBuffers(e,i),V.viewport(x),V.scissor(E),V.setScissorTest(S),o){const r=W.get(e.texture);ue.framebufferTexture2D(36160,36064,34069+t,r.__webglTexture,n)}else if(s){const r=W.get(e.texture),i=t||0;ue.framebufferTextureLayer(36160,36064,r.__webglTexture,n||0,i)}w=-1},this.readRenderTargetPixels=function(e,t,n,r,i,o,s){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=W.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){V.bindFramebuffer(36160,a);try{const s=e.texture,a=s.format,l=s.type;if(a!==xi&&le.convert(a)!==ue.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===yi&&(H.has("EXT_color_buffer_half_float")||G.isWebGL2&&H.has("EXT_color_buffer_float"));if(!(l===ui||le.convert(l)===ue.getParameter(35738)||l===gi&&(G.isWebGL2||H.has("OES_texture_float")||H.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ue.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ue.readPixels(t,n,r,i,le.convert(a),le.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const e=null!==_?W.get(_).__webglFramebuffer:null;V.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t,n=0){if(!0!==t.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r);q.setTexture2D(t,0),ue.copyTexSubImage2D(3553,n,0,0,e.x,e.y,i,o),V.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r=0){const i=t.image.width,o=t.image.height,s=le.convert(n.format),a=le.convert(n.type);q.setTexture2D(n,0),ue.pixelStorei(37440,n.flipY),ue.pixelStorei(37441,n.premultiplyAlpha),ue.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ue.texSubImage2D(3553,r,e.x,e.y,i,o,s,a,t.image.data):t.isCompressedTexture?ue.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,s,t.mipmaps[0].data):ue.texSubImage2D(3553,r,e.x,e.y,s,a,t.image),0===r&&n.generateMipmaps&&ue.generateMipmap(3553),V.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r,i=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=le.convert(r.format),c=le.convert(r.type);let u;if(r.isDataTexture3D)q.setTexture3D(r,0),u=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");q.setTexture2DArray(r,0),u=35866}ue.pixelStorei(37440,r.flipY),ue.pixelStorei(37441,r.premultiplyAlpha),ue.pixelStorei(3317,r.unpackAlignment);const h=ue.getParameter(3314),d=ue.getParameter(32878),p=ue.getParameter(3316),f=ue.getParameter(3315),g=ue.getParameter(32877),y=n.isCompressedTexture?n.mipmaps[0]:n.image;ue.pixelStorei(3314,y.width),ue.pixelStorei(32878,y.height),ue.pixelStorei(3316,e.min.x),ue.pixelStorei(3315,e.min.y),ue.pixelStorei(32877,e.min.z),n.isDataTexture||n.isDataTexture3D?ue.texSubImage3D(u,i,t.x,t.y,t.z,o,s,a,l,c,y.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ue.compressedTexSubImage3D(u,i,t.x,t.y,t.z,o,s,a,l,y.data)):ue.texSubImage3D(u,i,t.x,t.y,t.z,o,s,a,l,c,y),ue.pixelStorei(3314,h),ue.pixelStorei(32878,d),ue.pixelStorei(3316,p),ue.pixelStorei(3315,f),ue.pixelStorei(32877,g),0===i&&r.generateMipmaps&&ue.generateMipmap(u),V.unbindTexture()},this.initTexture=function(e){q.setTexture2D(e,0),V.unbindTexture()},this.resetState=function(){y=0,v=0,_=null,V.reset(),ce.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Gh.prototype.isWebGLRenderer=!0;class Vh extends Gh{}Vh.prototype.isWebGL1Renderer=!0;class jh{constructor(e,t=25e-5){this.name="",this.color=new Ss(e),this.density=t}clone(){return new jh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}jh.prototype.isFogExp2=!0;class Wh{constructor(e,t=1,n=1e3){this.name="",this.color=new Ss(e),this.near=t,this.far=n}clone(){return new Wh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Wh.prototype.isFog=!0;class qh extends Ba{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}qh.prototype.isScene=!0;class Kh{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Ho,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=is()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=is()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=is()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Kh.prototype.isInterleavedBuffer=!0;const Xh=new ks;class Yh{constructor(e,t,n,r=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Xh.x=this.getX(t),Xh.y=this.getY(t),Xh.z=this.getZ(t),Xh.applyMatrix4(e),this.setXYZ(t,Xh.x,Xh.y,Xh.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Xh.x=this.getX(t),Xh.y=this.getY(t),Xh.z=this.getZ(t),Xh.applyNormalMatrix(e),this.setXYZ(t,Xh.x,Xh.y,Xh.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Xh.x=this.getX(t),Xh.y=this.getY(t),Xh.z=this.getZ(t),Xh.transformDirection(e),this.setXYZ(t,Xh.x,Xh.y,Xh.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new el(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Yh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Yh.prototype.isInterleavedBufferAttribute=!0;class Jh extends Ja{constructor(e){super(),this.type="SpriteMaterial",this.color=new Ss(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Zh;Jh.prototype.isSpriteMaterial=!0;const Qh=new ks,$h=new ks,ed=new ks,td=new ds,nd=new ds,rd=new da,id=new ks,od=new ks,sd=new ks,ad=new ds,ld=new ds,cd=new ds;class ud extends Ba{constructor(e){if(super(),this.type="Sprite",void 0===Zh){Zh=new vl;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new Kh(e,5);Zh.setIndex([0,1,2,0,2,3]),Zh.setAttribute("position",new Yh(t,3,0,!1)),Zh.setAttribute("uv",new Yh(t,2,3,!1))}this.geometry=Zh,this.material=void 0!==e?e:new Jh,this.center=new ds(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),$h.setFromMatrixScale(this.matrixWorld),rd.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ed.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&$h.multiplyScalar(-ed.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const o=this.center;hd(id.set(-.5,-.5,0),ed,o,$h,r,i),hd(od.set(.5,-.5,0),ed,o,$h,r,i),hd(sd.set(.5,.5,0),ed,o,$h,r,i),ad.set(0,0),ld.set(1,0),cd.set(1,1);let s=e.ray.intersectTriangle(id,od,sd,!1,Qh);if(null===s&&(hd(od.set(-.5,.5,0),ed,o,$h,r,i),ld.set(0,1),s=e.ray.intersectTriangle(id,sd,od,!1,Qh),null===s))return;const a=e.ray.origin.distanceTo(Qh);a<e.near||a>e.far||t.push({distance:a,point:Qh.clone(),uv:Xa.getUV(Qh,id,od,sd,ad,ld,cd,new ds),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function hd(e,t,n,r,i,o){td.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(nd.x=o*td.x-i*td.y,nd.y=i*td.x+o*td.y):nd.copy(td),e.copy(t),e.x+=nd.x,e.y+=nd.y,e.applyMatrix4(rd)}ud.prototype.isSprite=!0;const dd=new ks,pd=new ks;class fd extends Ba{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let e=0,n=t.length;e<n;e++){const n=t[e];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const n=this.levels;let r;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){dd.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(dd);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){dd.setFromMatrixPosition(e.matrixWorld),pd.setFromMatrixPosition(this.matrixWorld);const n=dd.distanceTo(pd)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let e=0,r=n.length;e<r;e++){const r=n[e];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}const md=new ks,gd=new Ls,yd=new Ls,vd=new ks,_d=new da;class wd extends Dl{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new da,this.bindMatrixInverse=new da}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ls,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;gd.fromBufferAttribute(r.attributes.skinIndex,e),yd.fromBufferAttribute(r.attributes.skinWeight,e),md.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const r=yd.getComponent(e);if(0!==r){const i=gd.getComponent(e);_d.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(vd.copy(md).applyMatrix4(_d),r)}}return t.applyMatrix4(this.bindMatrixInverse)}}wd.prototype.isSkinnedMesh=!0;class bd extends Ba{constructor(){super(),this.type="Bone"}}bd.prototype.isBone=!0;class xd extends Rs{constructor(e=null,t=1,n=1,r,i,o,s,a,l=ei,c=ei,u,h){super(null,o,s,a,l,c,r,i,u,h),this.image={data:e,width:t,height:n},this.magFilter=l,this.minFilter=c,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}xd.prototype.isDataTexture=!0;const Ed=new da,Sd=new da;class Md{constructor(e=[],t=[]){this.uuid=is(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new da)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new da;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,i=e.length;r<i;r++){const i=e[r]?e[r].matrixWorld:Sd;Ed.multiplyMatrices(i,t[r]),Ed.toArray(n,16*r)}null!==r&&(r.needsUpdate=!0)}clone(){return new Md(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=cs(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new xd(t,e,e,xi,gi);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let i=t[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new bd),this.bones.push(i),this.boneInverses.push((new da).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const o=n[r];e.boneInverses.push(o.toArray())}return e}}class Td extends el{constructor(e,t,n,r=1){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Td.prototype.isInstancedBufferAttribute=!0;const Ad=new da,Rd=new da,Cd=[],Ld=new Dl;class Pd extends Dl{constructor(e,t,n){super(e,t),this.instanceMatrix=new Td(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Ld.geometry=this.geometry,Ld.material=this.material,void 0!==Ld.material)for(let i=0;i<r;i++){this.getMatrixAt(i,Ad),Rd.multiplyMatrices(n,Ad),Ld.matrixWorld=Rd,Ld.raycast(e,Cd);for(let e=0,n=Cd.length;e<n;e++){const n=Cd[e];n.instanceId=i,n.object=this,t.push(n)}Cd.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Td(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Pd.prototype.isInstancedMesh=!0;class Id extends Ja{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Ss(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}Id.prototype.isLineBasicMaterial=!0;const Od=new ks,Nd=new ks,kd=new da,Dd=new ha,Bd=new ra;class Ud extends Ba{constructor(e=new vl,t=new Id){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)Od.fromBufferAttribute(t,e-1),Nd.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Od.distanceTo(Nd);e.setAttribute("lineDistance",new cl(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Bd.copy(n.boundingSphere),Bd.applyMatrix4(r),Bd.radius+=i,!1===e.ray.intersectsSphere(Bd))return;kd.copy(r).invert(),Dd.copy(e.ray).applyMatrix4(kd);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s,l=new ks,c=new ks,u=new ks,h=new ks,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const r=n.index,i=n.attributes.position;if(null!==r)for(let n=Math.max(0,o.start),s=Math.min(r.count,o.start+o.count)-1;n<s;n+=d){const o=r.getX(n),s=r.getX(n+1);if(l.fromBufferAttribute(i,o),c.fromBufferAttribute(i,s),Dd.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const d=e.ray.origin.distanceTo(h);d<e.near||d>e.far||t.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}else for(let n=Math.max(0,o.start),r=Math.min(i.count,o.start+o.count)-1;n<r;n+=d){if(l.fromBufferAttribute(i,n),c.fromBufferAttribute(i,n+1),Dd.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(h);r<e.near||r>e.far||t.push({distance:r,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Ud.prototype.isLine=!0;const zd=new ks,Fd=new ks;class Hd extends Ud{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)zd.fromBufferAttribute(t,e),Fd.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+zd.distanceTo(Fd);e.setAttribute("lineDistance",new cl(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Hd.prototype.isLineSegments=!0;class Gd extends Ud{constructor(e,t){super(e,t),this.type="LineLoop"}}Gd.prototype.isLineLoop=!0;class Vd extends Ja{constructor(e){super(),this.type="PointsMaterial",this.color=new Ss(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Vd.prototype.isPointsMaterial=!0;const jd=new da,Wd=new ha,qd=new ra,Kd=new ks;class Xd extends Ba{constructor(e=new vl,t=new Vd){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),qd.copy(n.boundingSphere),qd.applyMatrix4(r),qd.radius+=i,!1===e.ray.intersectsSphere(qd))return;jd.copy(r).invert(),Wd.copy(e.ray).applyMatrix4(jd);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s;if(n.isBufferGeometry){const i=n.index,s=n.attributes.position;if(null!==i)for(let n=Math.max(0,o.start),l=Math.min(i.count,o.start+o.count);n<l;n++){const o=i.getX(n);Kd.fromBufferAttribute(s,o),Yd(Kd,o,a,r,e,t,this)}else for(let n=Math.max(0,o.start),i=Math.min(s.count,o.start+o.count);n<i;n++)Kd.fromBufferAttribute(s,n),Yd(Kd,n,a,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Yd(e,t,n,r,i,o,s){const a=Wd.distanceSqToPoint(e);if(a<n){const n=new ks;Wd.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;o.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,object:s})}}Xd.prototype.isPoints=!0;class Jd extends Rs{constructor(e,t,n,r,i,o,s,a,l){super(e,t,n,r,i,o,s,a,l),this.minFilter=void 0!==o?o:oi,this.magFilter=void 0!==i?i:oi,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Jd.prototype.isVideoTexture=!0;class Zd extends Rs{constructor(e,t,n){super({width:e,height:t}),this.format=n,this.magFilter=ei,this.minFilter=ei,this.generateMipmaps=!1,this.needsUpdate=!0}}Zd.prototype.isFramebufferTexture=!0;class Qd extends Rs{constructor(e,t,n,r,i,o,s,a,l,c,u,h){super(null,o,s,a,l,c,r,i,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Qd.prototype.isCompressedTexture=!0;class $d extends Rs{constructor(e,t,n,r,i,o,s,a,l){super(e,t,n,r,i,o,s,a,l),this.needsUpdate=!0}}$d.prototype.isCanvasTexture=!0;class ep extends vl{constructor(e=1,t=8,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],o=[],s=[],a=[],l=new ks,c=new ds;o.push(0,0,0),s.push(0,0,1),a.push(.5,.5);for(let i=0,u=3;i<=t;i++,u+=3){const h=n+i/t*r;l.x=e*Math.cos(h),l.y=e*Math.sin(h),o.push(l.x,l.y,l.z),s.push(0,0,1),c.x=(o[u]/e+1)/2,c.y=(o[u+1]/e+1)/2,a.push(c.x,c.y)}for(let e=1;e<=t;e++)i.push(e,e+1,0);this.setIndex(i),this.setAttribute("position",new cl(o,3)),this.setAttribute("normal",new cl(s,3)),this.setAttribute("uv",new cl(a,2))}static fromJSON(e){return new ep(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class tp extends vl{constructor(e=1,t=1,n=1,r=8,i=1,o=!1,s=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=n/2;let g=0;function y(n){const i=p,o=new ds,f=new ks;let y=0;const v=!0===n?e:t,_=!0===n?1:-1;for(let e=1;e<=r;e++)u.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),p++;const w=p;for(let e=0;e<=r;e++){const t=e/r*a+s,n=Math.cos(t),i=Math.sin(t);f.x=v*i,f.y=m*_,f.z=v*n,u.push(f.x,f.y,f.z),h.push(0,_,0),o.x=.5*n+.5,o.y=.5*i*_+.5,d.push(o.x,o.y),p++}for(let e=0;e<r;e++){const t=i+e,r=w+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),y+=3}l.addGroup(g,y,!0===n?1:2),g+=y}!function(){const o=new ks,y=new ks;let v=0;const _=(t-e)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,v=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*a+s,l=Math.sin(i),f=Math.cos(i);y.x=v*l,y.y=-g*n+m,y.z=v*f,u.push(y.x,y.y,y.z),o.set(l,_,f).normalize(),h.push(o.x,o.y,o.z),d.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<r;e++)for(let t=0;t<i;t++){const n=f[t][e],r=f[t+1][e],i=f[t+1][e+1],o=f[t][e+1];c.push(n,r,o),c.push(r,i,o),v+=6}l.addGroup(g,v,0),g+=v}(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new cl(u,3)),this.setAttribute("normal",new cl(h,3)),this.setAttribute("uv",new cl(d,2))}static fromJSON(e){return new tp(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class np extends tp{constructor(e=1,t=1,n=8,r=1,i=!1,o=0,s=2*Math.PI){super(0,e,t,n,r,i,o,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:s}}static fromJSON(e){return new np(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class rp extends vl{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],o=[];function s(e,t,n,r){const i=r+1,o=[];for(let r=0;r<=i;r++){o[r]=[];const s=e.clone().lerp(n,r/i),a=t.clone().lerp(n,r/i),l=i-r;for(let e=0;e<=l;e++)o[r][e]=0===e&&r===i?s:s.clone().lerp(a,e/l)}for(let e=0;e<i;e++)for(let t=0;t<2*(i-e)-1;t++){const n=Math.floor(t/2);t%2==0?(a(o[e][n+1]),a(o[e+1][n]),a(o[e][n])):(a(o[e][n+1]),a(o[e+1][n+1]),a(o[e+1][n]))}}function a(e){i.push(e.x,e.y,e.z)}function l(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function c(e,t,n,r){r<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}!function(e){const n=new ks,r=new ks,i=new ks;for(let o=0;o<t.length;o+=3)l(t[o+0],n),l(t[o+1],r),l(t[o+2],i),s(n,r,i,e)}(r),function(e){const t=new ks;for(let n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){const e=new ks;for(let n=0;n<i.length;n+=3){e.x=i[n+0],e.y=i[n+1],e.z=i[n+2];const r=u(e)/2/Math.PI+.5,s=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);o.push(r,1-s)}var t;(function(){const e=new ks,t=new ks,n=new ks,r=new ks,s=new ds,a=new ds,l=new ds;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),s.set(o[d+0],o[d+1]),a.set(o[d+2],o[d+3]),l.set(o[d+4],o[d+5]),r.copy(e).add(t).add(n).divideScalar(3);const p=u(r);c(s,d+0,e,p),c(a,d+2,t,p),c(l,d+4,n,p)}})(),function(){for(let e=0;e<o.length;e+=6){const t=o[e+0],n=o[e+2],r=o[e+4],i=Math.max(t,n,r),s=Math.min(t,n,r);i>.9&&s<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),r<.2&&(o[e+4]+=1))}}()}(),this.setAttribute("position",new cl(i,3)),this.setAttribute("normal",new cl(i.slice(),3)),this.setAttribute("uv",new cl(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new rp(e.vertices,e.indices,e.radius,e.details)}}class ip extends rp{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ip(e.radius,e.detail)}}const op=new ks,sp=new ks,ap=new ks,lp=new Xa;class cp extends vl{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,r=Math.pow(10,n),i=Math.cos(ns*t),o=e.getIndex(),s=e.getAttribute("position"),a=o?o.count:s.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let e=0;e<a;e+=3){o?(l[0]=o.getX(e),l[1]=o.getX(e+1),l[2]=o.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:a}=lp;if(t.fromBufferAttribute(s,l[0]),n.fromBufferAttribute(s,l[1]),a.fromBufferAttribute(s,l[2]),lp.getNormal(ap),u[0]=`${Math.round(t.x*r)},${Math.round(t.y*r)},${Math.round(t.z*r)}`,u[1]=`${Math.round(n.x*r)},${Math.round(n.y*r)},${Math.round(n.z*r)}`,u[2]=`${Math.round(a.x*r)},${Math.round(a.y*r)},${Math.round(a.z*r)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=u[e],r=u[t],o=lp[c[e]],s=lp[c[t]],a=`${n}_${r}`,p=`${r}_${n}`;p in h&&h[p]?(ap.dot(h[p].normal)<=i&&(d.push(o.x,o.y,o.z),d.push(s.x,s.y,s.z)),h[p]=null):a in h||(h[a]={index0:l[e],index1:l[t],normal:ap.clone()})}}for(const e in h)if(h[e]){const{index0:t,index1:n}=h[e];op.fromBufferAttribute(s,t),sp.fromBufferAttribute(s,n),d.push(op.x,op.y,op.z),d.push(sp.x,sp.y,sp.z)}this.setAttribute("position",new cl(d,3))}}}class up{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const i=n.length;let o;o=t||e*n[i-1];let s,a=0,l=i-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),s=n[r]-o,s<0)a=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(i-1);const c=n[r];return(r+(o-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const o=this.getPoint(r),s=this.getPoint(i),a=t||(o.isVector2?new ds:new ks);return a.copy(s).sub(o).normalize(),a}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new ks,r=[],i=[],o=[],s=new ks,a=new da;for(let t=0;t<=e;t++){const n=t/e;r[t]=this.getTangentAt(n,new ks)}i[0]=new ks,o[0]=new ks;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),o[0].crossVectors(r[0],i[0]);for(let t=1;t<=e;t++){if(i[t]=i[t-1].clone(),o[t]=o[t-1].clone(),s.crossVectors(r[t-1],r[t]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos(os(r[t-1].dot(r[t]),-1,1));i[t].applyMatrix4(a.makeRotationAxis(s,e))}o[t].crossVectors(r[t],i[t])}if(!0===t){let t=Math.acos(os(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(a.makeRotationAxis(r[n],t*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class hp extends up{constructor(e=0,t=0,n=1,r=1,i=0,o=2*Math.PI,s=!1,a=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=s,this.aRotation=a}getPoint(e,t){const n=t||new ds,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);const s=this.aStartAngle+e*i;let a=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,r=l-this.aY;a=n*e-r*t+this.aX,l=n*t+r*e+this.aY}return n.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}hp.prototype.isEllipseCurve=!0;class dp extends hp{constructor(e,t,n,r,i,o){super(e,t,n,n,r,i,o),this.type="ArcCurve"}}function pp(){let e=0,t=0,n=0,r=0;function i(i,o,s,a){e=i,t=s,n=-3*i+3*o-2*s-a,r=2*i-2*o+s+a}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,s,a){let l=(t-e)/o-(n-e)/(o+s)+(n-t)/s,c=(n-t)/s-(r-t)/(s+a)+(r-n)/a;l*=s,c*=s,i(t,n,l,c)},calc:function(i){const o=i*i;return e+t*i+n*o+r*(o*i)}}}dp.prototype.isArcCurve=!0;const fp=new ks,mp=new pp,gp=new pp,yp=new pp;class vp extends up{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new ks){const n=t,r=this.points,i=r.length,o=(i-(this.closed?0:1))*e;let s,a,l=Math.floor(o),c=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?s=r[(l-1)%i]:(fp.subVectors(r[0],r[1]).add(r[0]),s=fp);const u=r[l%i],h=r[(l+1)%i];if(this.closed||l+2<i?a=r[(l+2)%i]:(fp.subVectors(r[i-1],r[i-2]).add(r[i-1]),a=fp),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(u),e),n=Math.pow(u.distanceToSquared(h),e),r=Math.pow(h.distanceToSquared(a),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),mp.initNonuniformCatmullRom(s.x,u.x,h.x,a.x,t,n,r),gp.initNonuniformCatmullRom(s.y,u.y,h.y,a.y,t,n,r),yp.initNonuniformCatmullRom(s.z,u.z,h.z,a.z,t,n,r)}else"catmullrom"===this.curveType&&(mp.initCatmullRom(s.x,u.x,h.x,a.x,this.tension),gp.initCatmullRom(s.y,u.y,h.y,a.y,this.tension),yp.initCatmullRom(s.z,u.z,h.z,a.z,this.tension));return n.set(mp.calc(c),gp.calc(c),yp.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new ks).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _p(e,t,n,r,i){const o=.5*(r-t),s=.5*(i-n),a=e*e;return(2*n-2*r+o+s)*(e*a)+(-3*n+3*r-2*o-s)*a+o*e+n}function wp(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function bp(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}vp.prototype.isCatmullRomCurve3=!0;class xp extends up{constructor(e=new ds,t=new ds,n=new ds,r=new ds){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ds){const n=t,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(bp(e,r.x,i.x,o.x,s.x),bp(e,r.y,i.y,o.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}xp.prototype.isCubicBezierCurve=!0;class Ep extends up{constructor(e=new ks,t=new ks,n=new ks,r=new ks){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ks){const n=t,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(bp(e,r.x,i.x,o.x,s.x),bp(e,r.y,i.y,o.y,s.y),bp(e,r.z,i.z,o.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Ep.prototype.isCubicBezierCurve3=!0;class Sp extends up{constructor(e=new ds,t=new ds){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ds){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new ds;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Sp.prototype.isLineCurve=!0;class Mp extends up{constructor(e=new ks,t=new ks){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new ks){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Tp extends up{constructor(e=new ds,t=new ds,n=new ds){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ds){const n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(wp(e,r.x,i.x,o.x),wp(e,r.y,i.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Tp.prototype.isQuadraticBezierCurve=!0;class Ap extends up{constructor(e=new ks,t=new ks,n=new ks){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ks){const n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(wp(e,r.x,i.x,o.x),wp(e,r.y,i.y,o.y),wp(e,r.z,i.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ap.prototype.isQuadraticBezierCurve3=!0;class Rp extends up{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new ds){const n=t,r=this.points,i=(r.length-1)*e,o=Math.floor(i),s=i-o,a=r[0===o?o:o-1],l=r[o],c=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(_p(s,a.x,l.x,c.x,u.x),_p(s,a.y,l.y,c.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new ds).fromArray(n))}return this}}Rp.prototype.isSplineCurve=!0;var Cp=Object.freeze({__proto__:null,ArcCurve:dp,CatmullRomCurve3:vp,CubicBezierCurve:xp,CubicBezierCurve3:Ep,EllipseCurve:hp,LineCurve:Sp,LineCurve3:Mp,QuadraticBezierCurve:Tp,QuadraticBezierCurve3:Ap,SplineCurve:Rp});class Lp extends up{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Sp(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const e=r[i]-n,o=this.curves[i],s=o.getLength(),a=0===s?0:1-e/s;return o.getPointAt(a,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],s=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,a=o.getPoints(s);for(let e=0;e<a.length;e++){const r=a[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new Cp[n.type]).fromJSON(n))}return this}}class Pp extends Lp{constructor(e){super(),this.type="Path",this.currentPoint=new ds,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Sp(this.currentPoint.clone(),new ds(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const i=new Tp(this.currentPoint.clone(),new ds(e,t),new ds(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,o){const s=new xp(this.currentPoint.clone(),new ds(e,t),new ds(n,r),new ds(i,o));return this.curves.push(s),this.currentPoint.set(i,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Rp(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,o){const s=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+s,t+a,n,r,i,o),this}absarc(e,t,n,r,i,o){return this.absellipse(e,t,n,n,r,i,o),this}ellipse(e,t,n,r,i,o,s,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,o,s,a),this}absellipse(e,t,n,r,i,o,s,a){const l=new hp(e,t,n,r,i,o,s,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ip extends Pp{constructor(e){super(e),this.uuid=is(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new Pp).fromJSON(n))}return this}}function Op(e,t,n,r,i){let o,s;if(i===function(e,t,n,r){let i=0;for(let o=t,s=n-r;o<n;o+=r)i+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)s=ef(o,e[o],e[o+1],s);else for(o=n-r;o>=t;o-=r)s=ef(o,e[o],e[o+1],s);return s&&Xp(s,s.next)&&(tf(s),s=s.next),s}function Np(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!Xp(r,r.next)&&0!==Kp(r.prev,r,r.next))r=r.next;else{if(tf(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function kp(e,t,n,r,i,o,s){if(!e)return;!s&&o&&function(e,t,n,r){let i=e;do{null===i.z&&(i.z=Vp(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n,r,i,o,s,a,l,c=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,r=n,a=0,t=0;t<c&&(a++,r=r.nextZ,r);t++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1)}(i)}(e,r,i,o);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,o?Bp(e,r,i,o):Dp(e))t.push(a.i/n),t.push(e.i/n),t.push(l.i/n),tf(e),e=l.next,c=l.next;else if((e=l)===c){s?1===s?kp(e=Up(Np(e),t,n),t,n,r,i,o,2):2===s&&zp(e,t,n,r,i,o):kp(Np(e),t,n,r,i,o,1);break}}function Dp(e){const t=e.prev,n=e,r=e.next;if(Kp(t,n,r)>=0)return!1;let i=e.next.next;for(;i!==e.prev;){if(Wp(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Kp(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Bp(e,t,n,r){const i=e.prev,o=e,s=e.next;if(Kp(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,u=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=Vp(a,l,t,n,r),d=Vp(c,u,t,n,r);let p=e.prevZ,f=e.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&Wp(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Kp(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&Wp(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Kp(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&Wp(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Kp(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&Wp(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Kp(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Up(e,t,n){let r=e;do{const i=r.prev,o=r.next.next;!Xp(i,o)&&Yp(i,r,r.next,o)&&Qp(i,o)&&Qp(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),tf(r),tf(r.next),r=e=o),r=r.next}while(r!==e);return Np(r)}function zp(e,t,n,r,i,o){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&qp(s,e)){let a=$p(s,e);return s=Np(s,s.next),a=Np(a,a.next),kp(s,t,n,r,i,o),void kp(a,t,n,r,i,o)}e=e.next}s=s.next}while(s!==e)}function Fp(e,t){return e.x-t.x}function Hp(e,t){if(t=function(e,t){let n=t;const r=e.x,i=e.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>s){if(s=e,e===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!o)return null;if(r===s)return o;const a=o,l=o.x,c=o.y;let u,h=1/0;n=o;do{r>=n.x&&n.x>=l&&r!==n.x&&Wp(i<c?r:s,i,l,c,i<c?s:r,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(r-n.x),Qp(n,e)&&(u<h||u===h&&(n.x>o.x||n.x===o.x&&Gp(o,n)))&&(o=n,h=u)),n=n.next}while(n!==a);return o}(e,t),t){const n=$p(t,e);Np(t,t.next),Np(n,n.next)}}function Gp(e,t){return Kp(e.prev,e,t.prev)<0&&Kp(t.next,e,e.next)<0}function Vp(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function jp(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Wp(e,t,n,r,i,o,s,a){return(i-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(r-a)-(n-s)*(t-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function qp(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Yp(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Qp(e,t)&&Qp(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Kp(e.prev,e,t.prev)||Kp(e,t.prev,t))||Xp(e,t)&&Kp(e.prev,e,e.next)>0&&Kp(t.prev,t,t.next)>0)}function Kp(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Xp(e,t){return e.x===t.x&&e.y===t.y}function Yp(e,t,n,r){const i=Zp(Kp(e,t,n)),o=Zp(Kp(e,t,r)),s=Zp(Kp(n,r,e)),a=Zp(Kp(n,r,t));return i!==o&&s!==a||!(0!==i||!Jp(e,n,t))||!(0!==o||!Jp(e,r,t))||!(0!==s||!Jp(n,e,r))||!(0!==a||!Jp(n,t,r))}function Jp(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Zp(e){return e>0?1:e<0?-1:0}function Qp(e,t){return Kp(e.prev,e,e.next)<0?Kp(e,t,e.next)>=0&&Kp(e,e.prev,t)>=0:Kp(e,t,e.prev)<0||Kp(e,e.next,t)<0}function $p(e,t){const n=new nf(e.i,e.x,e.y),r=new nf(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function ef(e,t,n,r){const i=new nf(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function tf(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function nf(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class rf{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}static isClockWise(e){return rf.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];of(e),sf(n,e);let o=e.length;t.forEach(of);for(let e=0;e<t.length;e++)r.push(o),o+=t[e].length,sf(n,t[e]);const s=function(e,t,n=2){const r=t&&t.length,i=r?t[0]*n:e.length;let o=Op(e,0,i,n,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,c,u,h,d,p;if(r&&(o=function(e,t,n,r){const i=[];let o,s,a,l,c;for(o=0,s=t.length;o<s;o++)a=t[o]*r,l=o<s-1?t[o+1]*r:e.length,c=Op(e,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(jp(c));for(i.sort(Fp),o=0;o<i.length;o++)Hp(i[o],n),n=Np(n,n.next);return n}(e,t,o,n)),e.length>80*n){a=c=e[0],l=u=e[1];for(let t=n;t<i;t+=n)h=e[t],d=e[t+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?1/p:0}return kp(o,s,n,a,l,p),s}(n,r);for(let e=0;e<s.length;e+=3)i.push(s.slice(e,e+3));return i}}function of(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function sf(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class af extends vl{constructor(e=new Ip([new ds(.5,.5),new ds(-.5,.5),new ds(-.5,-.5),new ds(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let t=0,n=e.length;t<n;t++)o(e[t]);function o(e){const o=[],s=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1;let l=void 0!==t.depth?t.depth:1,c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:lf;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let g,y,v,_,w,b=!1;f&&(g=f.getSpacedPoints(a),b=!0,c=!1,y=f.computeFrenetFrames(a,!1),v=new ks,_=new ks,w=new ks),c||(p=0,u=0,h=0,d=0);const x=e.extractPoints(s);let E=x.shape;const S=x.holes;if(!rf.isClockWise(E)){E=E.reverse();for(let e=0,t=S.length;e<t;e++){const t=S[e];rf.isClockWise(t)&&(S[e]=t.reverse())}}const M=rf.triangulateShape(E,S),T=E;for(let e=0,t=S.length;e<t;e++){const t=S[e];E=E.concat(t)}function A(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const R=E.length,C=M.length;function L(e,t,n){let r,i,o;const s=e.x-t.x,a=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=s*s+a*a,h=s*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-a/h,f=t.y+s/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(s*c-a*l);r=p+s*m-e.x,i=f+a*m-e.y;const g=r*r+i*i;if(g<=2)return new ds(r,i);o=Math.sqrt(g/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(r=-a,i=s,o=Math.sqrt(u)):(r=s,i=a,o=Math.sqrt(u/2))}return new ds(r/o,i/o)}const P=[];for(let e=0,t=T.length,n=t-1,r=e+1;e<t;e++,n++,r++)n===t&&(n=0),r===t&&(r=0),P[e]=L(T[e],T[n],T[r]);const I=[];let O,N=P.concat();for(let e=0,t=S.length;e<t;e++){const t=S[e];O=[];for(let e=0,n=t.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),O[e]=L(t[e],t[r],t[i]);I.push(O),N=N.concat(O)}for(let e=0;e<p;e++){const t=e/p,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=T.length;e<t;e++){const t=A(T[e],P[e],r);B(t.x,t.y,-n)}for(let e=0,t=S.length;e<t;e++){const t=S[e];O=I[e];for(let e=0,i=t.length;e<i;e++){const i=A(t[e],O[e],r);B(i.x,i.y,-n)}}}const k=h+d;for(let e=0;e<R;e++){const t=c?A(E[e],N[e],k):E[e];b?(_.copy(y.normals[0]).multiplyScalar(t.x),v.copy(y.binormals[0]).multiplyScalar(t.y),w.copy(g[0]).add(_).add(v),B(w.x,w.y,w.z)):B(t.x,t.y,0)}for(let e=1;e<=a;e++)for(let t=0;t<R;t++){const n=c?A(E[t],N[t],k):E[t];b?(_.copy(y.normals[e]).multiplyScalar(n.x),v.copy(y.binormals[e]).multiplyScalar(n.y),w.copy(g[e]).add(_).add(v),B(w.x,w.y,w.z)):B(n.x,n.y,l/a*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=T.length;e<t;e++){const t=A(T[e],P[e],r);B(t.x,t.y,l+n)}for(let e=0,t=S.length;e<t;e++){const t=S[e];O=I[e];for(let e=0,i=t.length;e<i;e++){const i=A(t[e],O[e],r);b?B(i.x,i.y+g[a-1].y,g[a-1].x+n):B(i.x,i.y,l+n)}}}function D(e,t){let n=e.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,n=a+2*p;e<n;e++){const n=R*e,o=R*(e+1);z(t+r+n,t+i+n,t+i+o,t+r+o)}}}function B(e,t,n){o.push(e),o.push(t),o.push(n)}function U(e,t,i){F(e),F(t),F(i);const o=r.length/3,s=m.generateTopUV(n,r,o-3,o-2,o-1);H(s[0]),H(s[1]),H(s[2])}function z(e,t,i,o){F(e),F(t),F(o),F(t),F(i),F(o);const s=r.length/3,a=m.generateSideWallUV(n,r,s-6,s-3,s-2,s-1);H(a[0]),H(a[1]),H(a[3]),H(a[1]),H(a[2]),H(a[3])}function F(e){r.push(o[3*e+0]),r.push(o[3*e+1]),r.push(o[3*e+2])}function H(e){i.push(e.x),i.push(e.y)}!function(){const e=r.length/3;if(c){let e=0,t=R*e;for(let e=0;e<C;e++){const n=M[e];U(n[2]+t,n[1]+t,n[0]+t)}e=a+2*p,t=R*e;for(let e=0;e<C;e++){const n=M[e];U(n[0]+t,n[1]+t,n[2]+t)}}else{for(let e=0;e<C;e++){const t=M[e];U(t[2],t[1],t[0])}for(let e=0;e<C;e++){const t=M[e];U(t[0]+R*a,t[1]+R*a,t[2]+R*a)}}n.addGroup(e,r.length/3-e,0)}(),function(){const e=r.length/3;let t=0;D(T,t),t+=T.length;for(let e=0,n=S.length;e<n;e++){const n=S[e];D(n,t),t+=n.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new cl(r,3)),this.setAttribute("uv",new cl(i,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let t=0,r=e.length;t<r;t++){const r=e[t];n.shapes.push(r.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const i=t[e.shapes[r]];n.push(i)}const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new Cp[r.type]).fromJSON(r)),new af(n,e.options)}}const lf={generateTopUV:function(e,t,n,r,i){const o=t[3*n],s=t[3*n+1],a=t[3*r],l=t[3*r+1],c=t[3*i],u=t[3*i+1];return[new ds(o,s),new ds(a,l),new ds(c,u)]},generateSideWallUV:function(e,t,n,r,i,o){const s=t[3*n],a=t[3*n+1],l=t[3*n+2],c=t[3*r],u=t[3*r+1],h=t[3*r+2],d=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*o],g=t[3*o+1],y=t[3*o+2];return Math.abs(a-u)<Math.abs(s-c)?[new ds(s,1-l),new ds(c,1-h),new ds(d,1-f),new ds(m,1-y)]:[new ds(a,1-l),new ds(u,1-h),new ds(p,1-f),new ds(g,1-y)]}};class cf extends rp{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new cf(e.radius,e.detail)}}class uf extends vl{constructor(e=[new ds(0,.5),new ds(.5,0),new ds(0,-.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=os(r,0,2*Math.PI);const i=[],o=[],s=[],a=[],l=[],c=1/t,u=new ks,h=new ds,d=new ks,p=new ks,f=new ks;let m=0,g=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(f.x,f.y,f.z);break;default:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),a.push(d.x,d.y,d.z),f.copy(p)}for(let i=0;i<=t;i++){const d=n+i*c*r,p=Math.sin(d),f=Math.cos(d);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*p,u.y=e[n].y,u.z=e[n].x*f,o.push(u.x,u.y,u.z),h.x=i/t,h.y=n/(e.length-1),s.push(h.x,h.y);const r=a[3*n+0]*p,c=a[3*n+1],d=a[3*n+0]*f;l.push(r,c,d)}}for(let n=0;n<t;n++)for(let t=0;t<e.length-1;t++){const r=t+n*e.length,o=r,s=r+e.length,a=r+e.length+1,l=r+1;i.push(o,s,l),i.push(a,l,s)}this.setIndex(i),this.setAttribute("position",new cl(o,3)),this.setAttribute("uv",new cl(s,2)),this.setAttribute("normal",new cl(l,3))}static fromJSON(e){return new uf(e.points,e.segments,e.phiStart,e.phiLength)}}class hf extends rp{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new hf(e.radius,e.detail)}}class df extends vl{constructor(e=.5,t=1,n=8,r=1,i=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},n=Math.max(3,n);const s=[],a=[],l=[],c=[];let u=e;const h=(t-e)/(r=Math.max(1,r)),d=new ks,p=new ds;for(let e=0;e<=r;e++){for(let e=0;e<=n;e++){const r=i+e/n*o;d.x=u*Math.cos(r),d.y=u*Math.sin(r),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let e=0;e<r;e++){const t=e*(n+1);for(let e=0;e<n;e++){const r=e+t,i=r,o=r+n+1,a=r+n+2,l=r+1;s.push(i,o,l),s.push(o,a,l)}}this.setIndex(s),this.setAttribute("position",new cl(a,3)),this.setAttribute("normal",new cl(l,3)),this.setAttribute("uv",new cl(c,2))}static fromJSON(e){return new df(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class pf extends vl{constructor(e=new Ip([new ds(0,.5),new ds(-.5,-.5),new ds(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],o=[];let s=0,a=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(s,a,t),s+=a,a=0;function l(e){const s=r.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===rf.isClockWise(c)&&(c=c.reverse());for(let e=0,t=u.length;e<t;e++){const t=u[e];!0===rf.isClockWise(t)&&(u[e]=t.reverse())}const h=rf.triangulateShape(c,u);for(let e=0,t=u.length;e<t;e++){const t=u[e];c=c.concat(t)}for(let e=0,t=c.length;e<t;e++){const t=c[e];r.push(t.x,t.y,0),i.push(0,0,1),o.push(t.x,t.y)}for(let e=0,t=h.length;e<t;e++){const t=h[e],r=t[0]+s,i=t[1]+s,o=t[2]+s;n.push(r,i,o),a+=3}}this.setIndex(n),this.setAttribute("position",new cl(r,3)),this.setAttribute("normal",new cl(i,3)),this.setAttribute("uv",new cl(o,2))}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const i=t[e.shapes[r]];n.push(i)}return new pf(n,e.curveSegments)}}class ff extends vl{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,o=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(o+s,Math.PI);let l=0;const c=[],u=new ks,h=new ks,d=[],p=[],f=[],m=[];for(let d=0;d<=n;d++){const g=[],y=d/n;let v=0;0==d&&0==o?v=.5/t:d==n&&a==Math.PI&&(v=-.5/t);for(let n=0;n<=t;n++){const a=n/t;u.x=-e*Math.cos(r+a*i)*Math.sin(o+y*s),u.y=e*Math.cos(o+y*s),u.z=e*Math.sin(r+a*i)*Math.sin(o+y*s),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(a+v,1-y),g.push(l++)}c.push(g)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){const t=c[e][r+1],i=c[e][r],s=c[e+1][r],l=c[e+1][r+1];(0!==e||o>0)&&d.push(t,i,l),(e!==n-1||a<Math.PI)&&d.push(i,s,l)}this.setIndex(d),this.setAttribute("position",new cl(p,3)),this.setAttribute("normal",new cl(f,3)),this.setAttribute("uv",new cl(m,2))}static fromJSON(e){return new ff(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class mf extends rp{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new mf(e.radius,e.detail)}}class gf extends vl{constructor(e=1,t=.4,n=8,r=6,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const o=[],s=[],a=[],l=[],c=new ks,u=new ks,h=new ks;for(let o=0;o<=n;o++)for(let d=0;d<=r;d++){const p=d/r*i,f=o/n*Math.PI*2;u.x=(e+t*Math.cos(f))*Math.cos(p),u.y=(e+t*Math.cos(f))*Math.sin(p),u.z=t*Math.sin(f),s.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(d/r),l.push(o/n)}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){const n=(r+1)*e+t-1,i=(r+1)*(e-1)+t-1,s=(r+1)*(e-1)+t,a=(r+1)*e+t;o.push(n,i,a),o.push(i,s,a)}this.setIndex(o),this.setAttribute("position",new cl(s,3)),this.setAttribute("normal",new cl(a,3)),this.setAttribute("uv",new cl(l,2))}static fromJSON(e){return new gf(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class yf extends vl{constructor(e=1,t=.4,n=64,r=8,i=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},n=Math.floor(n),r=Math.floor(r);const s=[],a=[],l=[],c=[],u=new ks,h=new ks,d=new ks,p=new ks,f=new ks,m=new ks,g=new ks;for(let s=0;s<=n;++s){const v=s/n*i*Math.PI*2;y(v,i,o,e,d),y(v+.01,i,o,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=r;++e){const i=e/r*Math.PI*2,o=-t*Math.cos(i),p=t*Math.sin(i);u.x=d.x+(o*g.x+p*f.x),u.y=d.y+(o*g.y+p*f.y),u.z=d.z+(o*g.z+p*f.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(s/n),c.push(e/r)}}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),o=(r+1)*e+t,a=(r+1)*(e-1)+t;s.push(n,i,a),s.push(i,o,a)}function y(e,t,n,r,i){const o=Math.cos(e),s=Math.sin(e),a=n/t*e,l=Math.cos(a);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*s*.5,i.z=r*Math.sin(a)*.5}this.setIndex(s),this.setAttribute("position",new cl(a,3)),this.setAttribute("normal",new cl(l,3)),this.setAttribute("uv",new cl(c,2))}static fromJSON(e){return new yf(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class vf extends vl{constructor(e=new Ap(new ks(-1,-1,0),new ks(-1,1,0),new ks(1,1,0)),t=64,n=1,r=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const s=new ks,a=new ks,l=new ds;let c=new ks;const u=[],h=[],d=[],p=[];function f(i){c=e.getPointAt(i/t,c);const l=o.normals[i],d=o.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),o=-Math.cos(t);a.x=o*l.x+i*d.x,a.y=o*l.y+i*d.y,a.z=o*l.z+i*d.z,a.normalize(),h.push(a.x,a.y,a.z),s.x=c.x+n*a.x,s.y=c.y+n*a.y,s.z=c.z+n*a.z,u.push(s.x,s.y,s.z)}}!function(){for(let e=0;e<t;e++)f(e);f(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)l.x=e/t,l.y=n/r,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),o=(r+1)*e+t,s=(r+1)*(e-1)+t;p.push(n,i,s),p.push(i,o,s)}}()}(),this.setIndex(p),this.setAttribute("position",new cl(u,3)),this.setAttribute("normal",new cl(h,3)),this.setAttribute("uv",new cl(d,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new vf((new Cp[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class _f extends vl{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new ks,i=new ks;if(null!==e.index){const o=e.attributes.position,s=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let a=0;a<3;a++){const l=s.getX(e+a),c=s.getX(e+(a+1)%3);r.fromBufferAttribute(o,l),i.fromBufferAttribute(o,c),!0===wf(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const o=e.attributes.position;for(let e=0,s=o.count/3;e<s;e++)for(let s=0;s<3;s++){const a=3*e+s,l=3*e+(s+1)%3;r.fromBufferAttribute(o,a),i.fromBufferAttribute(o,l),!0===wf(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new cl(t,3))}}}function wf(e,t,n){const r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r,i),!0)}var bf=Object.freeze({__proto__:null,BoxGeometry:Ul,BoxBufferGeometry:Ul,CircleGeometry:ep,CircleBufferGeometry:ep,ConeGeometry:np,ConeBufferGeometry:np,CylinderGeometry:tp,CylinderBufferGeometry:tp,DodecahedronGeometry:ip,DodecahedronBufferGeometry:ip,EdgesGeometry:cp,ExtrudeGeometry:af,ExtrudeBufferGeometry:af,IcosahedronGeometry:cf,IcosahedronBufferGeometry:cf,LatheGeometry:uf,LatheBufferGeometry:uf,OctahedronGeometry:hf,OctahedronBufferGeometry:hf,PlaneGeometry:ic,PlaneBufferGeometry:ic,PolyhedronGeometry:rp,PolyhedronBufferGeometry:rp,RingGeometry:df,RingBufferGeometry:df,ShapeGeometry:pf,ShapeBufferGeometry:pf,SphereGeometry:ff,SphereBufferGeometry:ff,TetrahedronGeometry:mf,TetrahedronBufferGeometry:mf,TorusGeometry:gf,TorusBufferGeometry:gf,TorusKnotGeometry:yf,TorusKnotBufferGeometry:yf,TubeGeometry:vf,TubeBufferGeometry:vf,WireframeGeometry:_f});class xf extends Ja{constructor(e){super(),this.type="ShadowMaterial",this.color=new Ss(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}xf.prototype.isShadowMaterial=!0;class Ef extends Ja{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ss(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ss(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Eo,this.normalScale=new ds(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Ef.prototype.isMeshStandardMaterial=!0;class Sf extends Ef{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ds(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return os(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new Ss(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ss(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ss(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}Sf.prototype.isMeshPhysicalMaterial=!0;class Mf extends Ja{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Ss(16777215),this.specular=new Ss(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ss(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Eo,this.normalScale=new ds(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Mf.prototype.isMeshPhongMaterial=!0;class Tf extends Ja{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ss(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ss(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Eo,this.normalScale=new ds(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Tf.prototype.isMeshToonMaterial=!0;class Af extends Ja{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Eo,this.normalScale=new ds(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Af.prototype.isMeshNormalMaterial=!0;class Rf extends Ja{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Ss(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ss(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Rf.prototype.isMeshLambertMaterial=!0;class Cf extends Ja{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ss(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Eo,this.normalScale=new ds(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}Cf.prototype.isMeshMatcapMaterial=!0;class Lf extends Id{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}Lf.prototype.isLineDashedMaterial=!0;var Pf=Object.freeze({__proto__:null,ShadowMaterial:xf,SpriteMaterial:Jh,RawShaderMaterial:mc,ShaderMaterial:Gl,PointsMaterial:Vd,MeshPhysicalMaterial:Sf,MeshStandardMaterial:Ef,MeshPhongMaterial:Mf,MeshToonMaterial:Tf,MeshNormalMaterial:Af,MeshLambertMaterial:Rf,MeshDepthMaterial:Ch,MeshDistanceMaterial:Lh,MeshBasicMaterial:Za,MeshMatcapMaterial:Cf,LineDashedMaterial:Lf,LineBasicMaterial:Id,Material:Ja});const If={arraySlice:function(e,t,n){return If.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){const r=e.length,i=new e.constructor(r);for(let o=0,s=0;s!==r;++o){const r=n[o]*t;for(let n=0;n!==t;++n)i[s++]=e[r+n]}return i},flattenJSON:function(e,t,n,r){let i=1,o=e[0];for(;void 0!==o&&void 0===o[r];)o=e[i++];if(void 0===o)return;let s=o[r];if(void 0!==s)if(Array.isArray(s))do{s=o[r],void 0!==s&&(t.push(o.time),n.push.apply(n,s)),o=e[i++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[r],void 0!==s&&(t.push(o.time),s.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{s=o[r],void 0!==s&&(t.push(o.time),n.push(s)),o=e[i++]}while(void 0!==o)},subclip:function(e,t,n,r,i=30){const o=e.clone();o.name=t;const s=[];for(let e=0;e<o.tracks.length;++e){const t=o.tracks[e],a=t.getValueSize(),l=[],c=[];for(let e=0;e<t.times.length;++e){const o=t.times[e]*i;if(!(o<n||o>=r)){l.push(t.times[e]);for(let n=0;n<a;++n)c.push(t.values[e*a+n])}}0!==l.length&&(t.times=If.convertArray(l,t.times.constructor),t.values=If.convertArray(c,t.values.constructor),s.push(t))}o.tracks=s;let a=1/0;for(let e=0;e<o.tracks.length;++e)a>o.tracks[e].times[0]&&(a=o.tracks[e].times[0]);for(let e=0;e<o.tracks.length;++e)o.tracks[e].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(e,t=0,n=e,r=30){r<=0&&(r=30);const i=n.tracks.length,o=t/r;for(let t=0;t<i;++t){const r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)continue;const s=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===s)continue;let a=0;const l=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=r.times.length-1;let d;if(o<=r.times[0]){const e=a,t=l-a;d=If.arraySlice(r.values,e,t)}else if(o>=r.times[h]){const e=h*l+a,t=e+l-a;d=If.arraySlice(r.values,e,t)}else{const e=r.createInterpolant(),t=a,n=l-a;e.evaluate(o),d=If.arraySlice(e.resultBuffer,t,n)}"quaternion"===i&&(new Ns).fromArray(d).normalize().conjugate().toArray(d);const p=s.times.length;for(let e=0;e<p;++e){const t=e*u+c;if("quaternion"===i)Ns.multiplyQuaternionsFlat(s.values,t,d,0,s.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)s.values[t+n]-=d[n]}}}return e.blendMode=mo,e}};class Of{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let o;n:{r:if(!(e<r)){for(let o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=i)break e;{const s=t[1];e<s&&(n=2,i=s);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===o)break;if(r=i,i=t[--n-1],e>=i)break t}o=n,n=0}}for(;n<o;){const r=n+o>>>1;e<t[r]?o=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e)t[e]=n[i+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Of.prototype.beforeStart_=Of.prototype.copySampleValue_,Of.prototype.afterEnd_=Of.prototype.copySampleValue_;class Nf extends Of{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:uo,endingEnd:uo}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,o=e+1,s=r[i],a=r[o];if(void 0===s)switch(this.getSettings_().endingStart){case ho:i=e,s=2*t-n;break;case po:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case ho:o=e,a=2*n-t;break;case po:o=1,a=n+r[1]-r[0];break;default:o=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(a-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let e=0;e!==s;++e)i[e]=g*o[c+e]+y*o[l+e]+v*o[a+e]+_*o[u+e];return i}}class kf extends Of{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,c=(n-t)/(r-t),u=1-c;for(let e=0;e!==s;++e)i[e]=o[l+e]*u+o[a+e]*c;return i}}class Df extends Of{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Bf{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=If.convertArray(t,this.TimeBufferType),this.values=If.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:If.convertArray(e.times,Array),values:If.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Df(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new kf(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Nf(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ao:t=this.InterpolantFactoryMethodDiscrete;break;case lo:t=this.InterpolantFactoryMethodLinear;break;case co:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ao;case this.InterpolantFactoryMethodLinear:return lo;case this.InterpolantFactoryMethodSmooth:return co}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const e=this.getValueSize();this.times=If.arraySlice(n,i,o),this.values=If.arraySlice(this.values,i*e,o*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let t=0;t!==i;t++){const r=n[t];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,r),e=!1;break}if(null!==o&&o>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,r,o),e=!1;break}o=r}if(void 0!==r&&If.isTypedArray(r))for(let t=0,n=r.length;t!==n;++t){const n=r[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e}optimize(){const e=If.arraySlice(this.times),t=If.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===co,i=e.length-1;let o=1;for(let s=1;s<i;++s){let i=!1;const a=e[s];if(a!==e[s+1]&&(1!==s||a!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,o=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[o+s]){i=!0;break}}}if(i){if(s!==o){e[o]=e[s];const r=s*n,i=o*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++o}}if(i>0){e[o]=e[i];for(let e=i*n,r=o*n,s=0;s!==n;++s)t[r+s]=t[e+s];++o}return o!==e.length?(this.times=If.arraySlice(e,0,o),this.values=If.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=If.arraySlice(this.times,0),t=If.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Bf.prototype.TimeBufferType=Float32Array,Bf.prototype.ValueBufferType=Float32Array,Bf.prototype.DefaultInterpolation=lo;class Uf extends Bf{}Uf.prototype.ValueTypeName="bool",Uf.prototype.ValueBufferType=Array,Uf.prototype.DefaultInterpolation=ao,Uf.prototype.InterpolantFactoryMethodLinear=void 0,Uf.prototype.InterpolantFactoryMethodSmooth=void 0;class zf extends Bf{}zf.prototype.ValueTypeName="color";class Ff extends Bf{}Ff.prototype.ValueTypeName="number";class Hf extends Of{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=(n-t)/(r-t);let l=e*s;for(let e=l+s;l!==e;l+=4)Ns.slerpFlat(i,0,o,l-s,o,l,a);return i}}class Gf extends Bf{InterpolantFactoryMethodLinear(e){return new Hf(this.times,this.values,this.getValueSize(),e)}}Gf.prototype.ValueTypeName="quaternion",Gf.prototype.DefaultInterpolation=lo,Gf.prototype.InterpolantFactoryMethodSmooth=void 0;class Vf extends Bf{}Vf.prototype.ValueTypeName="string",Vf.prototype.ValueBufferType=Array,Vf.prototype.DefaultInterpolation=ao,Vf.prototype.InterpolantFactoryMethodLinear=void 0,Vf.prototype.InterpolantFactoryMethodSmooth=void 0;class jf extends Bf{}jf.prototype.ValueTypeName="vector";class Wf{constructor(e,t=-1,n,r=fo){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=is(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let e=0,i=n.length;e!==i;++e)t.push(qf(n[e]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,r=n.length;e!==r;++e)t.push(Bf.toJSON(n[e]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,o=[];for(let e=0;e<i;e++){let s=[],a=[];s.push((e+i-1)%i,e,(e+1)%i),a.push(0,1,0);const l=If.getKeyframeOrder(s);s=If.sortedArray(s,1,l),a=If.sortedArray(a,1,l),r||0!==s[0]||(s.push(i),a.push(a[0])),o.push(new Ff(".morphTargetInfluences["+t[e].name+"]",s,a).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){const n=e[t],o=n.name.match(i);if(o&&o.length>1){const e=o[1];let t=r[e];t||(r[e]=t=[]),t.push(n)}}const o=[];for(const e in r)o.push(this.CreateFromMorphTargetSequence(e,r[e],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const o=[],s=[];If.flattenJSON(n,o,s,r),0!==o.length&&i.push(new e(t,o,s))}},r=[],i=e.name||"default",o=e.fps||30,s=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const i=l[e].keys;if(i&&0!==i.length)if(i[0].morphTargets){const e={};let t;for(t=0;t<i.length;t++)if(i[t].morphTargets)for(let n=0;n<i[t].morphTargets.length;n++)e[i[t].morphTargets[n]]=-1;for(const n in e){const e=[],o=[];for(let r=0;r!==i[t].morphTargets.length;++r){const r=i[t];e.push(r.time),o.push(r.morphTarget===n?1:0)}r.push(new Ff(".morphTargetInfluence["+n+"]",e,o))}a=e.length*(o||1)}else{const o=".bones["+t[e].name+"]";n(jf,o+".position",i,"pos",r),n(Gf,o+".quaternion",i,"rot",r),n(jf,o+".scale",i,"scl",r)}}return 0===r.length?null:new this(i,a,r,s)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function qf(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ff;case"vector":case"vector2":case"vector3":case"vector4":return jf;case"color":return zf;case"quaternion":return Gf;case"bool":case"boolean":return Uf;case"string":return Vf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];If.flattenJSON(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Kf={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Xf{constructor(e,t,n){const r=this;let i,o=!1,s=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===o&&void 0!==r.onStart&&r.onStart(e,s,a),o=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const Yf=new Xf;class Jf{constructor(e){this.manager=void 0!==e?e:Yf,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Zf={};class Qf extends Jf{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=Kf.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==Zf[e])return void Zf[e].push({onLoad:t,onProgress:n,onError:r});Zf[e]=[],Zf[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,a=this.responseType;fetch(o).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body.getReader)return t;const n=Zf[e],r=t.body.getReader(),i=t.headers.get("Content-Length"),o=i?parseInt(i):0,s=0!==o;let a=0;const l=new ReadableStream({start(e){!function t(){r.read().then((({done:r,value:i})=>{if(r)e.close();else{a+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:a,total:o});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(i),t()}}))}()}});return new Response(l)}throw Error(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,s)));case"json":return e.json();default:if(void 0===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((e=>r.decode(e)))}}})).then((t=>{Kf.add(e,t);const n=Zf[e];delete Zf[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}})).catch((t=>{const n=Zf[e];if(void 0===n)throw this.manager.itemError(e),t;delete Zf[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class $f extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new Qf(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Wf.parse(e[n]);t.push(r)}return t}}class em extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=this,o=[],s=new Qd,a=new Qf(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const n=i.parse(e,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=oi),s.image=o,s.format=n.format,s.needsUpdate=!0,t&&t(s))}),n,r)}if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)c(t);else a.load(e,(function(e){const n=i.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){o[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)o[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),o[t].format=n.format,o[t].width=n.width,o[t].height=n.height}s.image=o}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=oi),s.format=n.format,s.needsUpdate=!0,t&&t(s)}),n,r);return s}}class tm extends Jf{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=Kf.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;const s=ys("img");function a(){c(),Kf.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){s.removeEventListener("load",a,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",a,!1),s.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(e),s.src=e,s}}class nm extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=new Kl,o=new tm(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let s=0;function a(n){o.load(e[n],(function(e){i.images[n]=e,s++,6===s&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(let t=0;t<e.length;++t)a(t);return i}}class rm extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new xd,s=new Qf(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(e,(function(e){const n=i.parse(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Qr,o.wrapT=void 0!==n.wrapT?n.wrapT:Qr,o.magFilter=void 0!==n.magFilter?n.magFilter:oi,o.minFilter=void 0!==n.minFilter?n.minFilter:oi,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=li),1===n.mipmapCount&&(o.minFilter=oi),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,t&&t(o,n))}),n,r),o}}class im extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=new Rs,o=new tm(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}class om extends Ba{constructor(e,t=1){super(),this.type="Light",this.color=new Ss(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}om.prototype.isLight=!0;class sm extends om{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(Ba.DefaultUp),this.updateMatrix(),this.groundColor=new Ss(t)}copy(e){return om.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}sm.prototype.isHemisphereLight=!0;const am=new da,lm=new ks,cm=new ks;class um{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ds(512,512),this.map=null,this.mapPass=null,this.matrix=new da,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tc,this._frameExtents=new ds(1,1),this._viewportCount=1,this._viewports=[new Ls(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;lm.setFromMatrixPosition(e.matrixWorld),t.position.copy(lm),cm.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(cm),t.updateMatrixWorld(),am.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(am),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class hm extends um{constructor(){super(new jl(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=2*rs*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}hm.prototype.isSpotLightShadow=!0;class dm extends om{constructor(e,t,n=0,r=Math.PI/3,i=0,o=1){super(e,t),this.type="SpotLight",this.position.copy(Ba.DefaultUp),this.updateMatrix(),this.target=new Ba,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.shadow=new hm}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}dm.prototype.isSpotLight=!0;const pm=new da,fm=new ks,mm=new ks;class gm extends um{constructor(){super(new jl(90,1,.5,500)),this._frameExtents=new ds(4,2),this._viewportCount=6,this._viewports=[new Ls(2,1,1,1),new Ls(0,1,1,1),new Ls(3,1,1,1),new Ls(1,1,1,1),new Ls(3,0,1,1),new Ls(1,0,1,1)],this._cubeDirections=[new ks(1,0,0),new ks(-1,0,0),new ks(0,0,1),new ks(0,0,-1),new ks(0,1,0),new ks(0,-1,0)],this._cubeUps=[new ks(0,1,0),new ks(0,1,0),new ks(0,1,0),new ks(0,1,0),new ks(0,0,1),new ks(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),fm.setFromMatrixPosition(e.matrixWorld),n.position.copy(fm),mm.copy(n.position),mm.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(mm),n.updateMatrixWorld(),r.makeTranslation(-fm.x,-fm.y,-fm.z),pm.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pm)}}gm.prototype.isPointLightShadow=!0;class ym extends om{constructor(e,t,n=0,r=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new gm}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}ym.prototype.isPointLight=!0;class vm extends um{constructor(){super(new fc(-5,5,5,-5,.5,500))}}vm.prototype.isDirectionalLightShadow=!0;class _m extends om{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Ba.DefaultUp),this.updateMatrix(),this.target=new Ba,this.shadow=new vm}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}_m.prototype.isDirectionalLight=!0;class wm extends om{constructor(e,t){super(e,t),this.type="AmbientLight"}}wm.prototype.isAmbientLight=!0;class bm extends om{constructor(e,t,n=10,r=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}bm.prototype.isRectAreaLight=!0;class xm{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ks)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*i*1.092548),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],n*i*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*i),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],.858086*n*i),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}xm.prototype.isSphericalHarmonics3=!0;class Em extends om{constructor(e=new xm,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Em.prototype.isLightProbe=!0;class Sm extends Jf{constructor(e){super(e),this.textures={}}load(e,t,n,r){const i=this,o=new Qf(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const r=new Pf[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Ss).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.alphaWrite&&(r.alphaWrite=e.alphaWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const t in e.uniforms){const i=e.uniforms[t];switch(r.uniforms[t]={},i.type){case"t":r.uniforms[t].value=n(i.value);break;case"c":r.uniforms[t].value=(new Ss).setHex(i.value);break;case"v2":r.uniforms[t].value=(new ds).fromArray(i.value);break;case"v3":r.uniforms[t].value=(new ks).fromArray(i.value);break;case"v4":r.uniforms[t].value=(new Ls).fromArray(i.value);break;case"m3":r.uniforms[t].value=(new ps).fromArray(i.value);break;case"m4":r.uniforms[t].value=(new da).fromArray(i.value);break;default:r.uniforms[t].value=i.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const t in e.extensions)r.extensions[t]=e.extensions[t];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new ds).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new ds).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}}class Mm{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Tm extends vl{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Tm.prototype.isInstancedBufferGeometry=!0;class Am extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new Qf(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}parse(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const i=e.interleavedBuffers[r],o=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),s=gs(i.type,o),a=new Kh(s,i.stride);return a.uuid=i.uuid,t[r]=a,a}const i=e.isInstancedBufferGeometry?new Tm:new vl,o=e.data.index;if(void 0!==o){const e=gs(o.type,o.array);i.setIndex(new el(e,1))}const s=e.data.attributes;for(const t in s){const n=s[t];let o;if(n.isInterleavedBufferAttribute){const t=r(e.data,n.data);o=new Yh(t,n.itemSize,n.offset,n.normalized)}else{const e=gs(n.type,n.array);o=new(n.isInstancedBufferAttribute?Td:el)(e,n.itemSize,n.normalized)}void 0!==n.name&&(o.name=n.name),void 0!==n.usage&&o.setUsage(n.usage),void 0!==n.updateRange&&(o.updateRange.offset=n.updateRange.offset,o.updateRange.count=n.updateRange.count),i.setAttribute(t,o)}const a=e.data.morphAttributes;if(a)for(const t in a){const n=a[t],o=[];for(let t=0,i=n.length;t<i;t++){const i=n[t];let s;if(i.isInterleavedBufferAttribute){const t=r(e.data,i.data);s=new Yh(t,i.itemSize,i.offset,i.normalized)}else{const e=gs(i.type,i.array);s=new el(e,i.itemSize,i.normalized)}void 0!==i.name&&(s.name=i.name),o.push(s)}i.morphAttributes[t]=o}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let e=0,t=l.length;e!==t;++e){const t=l[e];i.addGroup(t.start,t.count,t.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new ks;void 0!==c.center&&e.fromArray(c.center),i.boundingSphere=new ra(e,c.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}class Rm extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=this,o=""===this.path?Mm.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const s=new Qf(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){let o=null;try{o=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}const s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}async loadAsync(e,t){const n=""===this.path?Mm.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new Qf(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(e,t),o=JSON.parse(i),s=o.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(o)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),s=this.parseTextures(e.textures,o),a=this.parseMaterials(e.materials,s),l=this.parseObject(e.object,i,a,s,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in o)if(o[t]instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,i),s=this.parseMaterials(e.materials,o),a=this.parseObject(e.object,r,s,o,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new Ip).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(let t=0,i=e.length;t<i;t++){const i=(new Md).fromJSON(e[t],r);n[i.uuid]=i}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new Am;for(let i=0,o=e.length;i<o;i++){let o;const s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:s.type in bf?o=bf[s.type].fromJSON(s,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${s.type}"`)}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const i=new Sm;i.setTextures(t);for(let t=0,o=e.length;t<o;t++){const o=e[t];if("MultiMaterial"===o.type){const e=[];for(let t=0;t<o.materials.length;t++){const r=o.materials[t];void 0===n[r.uuid]&&(n[r.uuid]=i.parse(r)),e.push(n[r.uuid])}r[o.uuid]=e}else void 0===n[o.uuid]&&(n[o.uuid]=i.parse(o)),r[o.uuid]=n[o.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const r=e[n],i=Wf.parse(r);t[i.uuid]=i}return t}parseImages(e,t){const n=this,r={};let i;function o(e){if("string"==typeof e){const t=e;return function(e){return n.manager.itemStart(e),i.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:gs(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new Xf(t);i=new tm(n),i.setCrossOrigin(this.crossOrigin);for(let t=0,n=e.length;t<n;t++){const n=e[t],i=n.url;if(Array.isArray(i)){r[n.uuid]=[];for(let e=0,t=i.length;e<t;e++){const t=o(i[e]);null!==t&&(t instanceof HTMLImageElement?r[n.uuid].push(t):r[n.uuid].push(new xd(t.data,t.width,t.height)))}}else{const e=o(n.url);null!==e&&(r[n.uuid]=e)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function i(e){if("string"==typeof e){const n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(i)}return e.data?{data:gs(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){r=new tm(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],o=r.url;if(Array.isArray(o)){n[r.uuid]=[];for(let e=0,t=o.length;e<t;e++){const t=o[e],s=await i(t);null!==s&&(s instanceof HTMLImageElement?n[r.uuid].push(s):n[r.uuid].push(new xd(s.data,s.width,s.height)))}}else{const e=await i(r.url);null!==e&&(n[r.uuid]=e)}}}return n}parseTextures(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const r={};if(void 0!==e)for(let i=0,o=e.length;i<o;i++){const o=e[i];let s;void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const a=t[o.image];Array.isArray(a)?(s=new Kl(a),6===a.length&&(s.needsUpdate=!0)):(s=a&&a.data?new xd(a.data,a.width,a.height):new Rs(a),a&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,Cm)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],Lm),s.wrapT=n(o.wrap[1],Lm)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,Pm)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,Pm)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),void 0!==o.userData&&(s.userData=o.userData),r[o.uuid]=s}return r}parseObject(e,t,n,r,i){let o,s,a;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function u(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":o=new qh,void 0!==e.background&&(Number.isInteger(e.background)?o.background=new Ss(e.background):o.background=u(e.background)),void 0!==e.environment&&(o.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new Wh(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new jh(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new jl(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new fc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new wm(e.color,e.intensity);break;case"DirectionalLight":o=new _m(e.color,e.intensity);break;case"PointLight":o=new ym(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new bm(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new dm(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new sm(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new Em).fromJSON(e);break;case"SkinnedMesh":s=l(e.geometry),a=c(e.material),o=new wd(s,a),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":s=l(e.geometry),a=c(e.material),o=new Dl(s,a);break;case"InstancedMesh":s=l(e.geometry),a=c(e.material);const t=e.count,n=e.instanceMatrix,r=e.instanceColor;o=new Pd(s,a,t),o.instanceMatrix=new Td(new Float32Array(n.array),16),void 0!==r&&(o.instanceColor=new Td(new Float32Array(r.array),r.itemSize));break;case"LOD":o=new fd;break;case"Line":o=new Ud(l(e.geometry),c(e.material));break;case"LineLoop":o=new Gd(l(e.geometry),c(e.material));break;case"LineSegments":o=new Hd(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new Xd(l(e.geometry),c(e.material));break;case"Sprite":o=new ud(c(e.material));break;case"Group":o=new Dh;break;case"Bone":o=new bd;break;default:o=new Ba}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const s=e.children;for(let e=0;e<s.length;e++)o.add(this.parseObject(s[e],t,n,r,i))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];o.animations.push(i[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=o.getObjectByProperty("uuid",n.object);void 0!==r&&o.addLevel(r,n.distance)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const Cm={UVMapping:jr,CubeReflectionMapping:Wr,CubeRefractionMapping:qr,EquirectangularReflectionMapping:Kr,EquirectangularRefractionMapping:Xr,CubeUVReflectionMapping:Yr,CubeUVRefractionMapping:Jr},Lm={RepeatWrapping:Zr,ClampToEdgeWrapping:Qr,MirroredRepeatWrapping:$r},Pm={NearestFilter:ei,NearestMipmapNearestFilter:ti,NearestMipmapLinearFilter:ri,LinearFilter:oi,LinearMipmapNearestFilter:si,LinearMipmapLinearFilter:li};class Im extends Jf{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=Kf.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,fetch(e,s).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){Kf.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}let Om;Im.prototype.isImageBitmapLoader=!0;const Nm={getContext:function(){return void 0===Om&&(Om=new(window.AudioContext||window.webkitAudioContext)),Om},setContext:function(e){Om=e}};class km extends Jf{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new Qf(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{const e=n.slice(0);Nm.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}}class Dm extends Em{constructor(e,t,n=1){super(void 0,n);const r=(new Ss).set(e),i=(new Ss).set(t),o=new ks(r.r,r.g,r.b),s=new ks(i.r,i.g,i.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(a),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(l)}}Dm.prototype.isHemisphereLightProbe=!0;class Bm extends Em{constructor(e,t=1){super(void 0,t);const n=(new Ss).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}Bm.prototype.isAmbientLightProbe=!0;const Um=new da,zm=new da,Fm=new da;class Hm{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new jl,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new jl,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Fm.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(ns*t.fov*.5)/t.zoom;let o,s;zm.elements[12]=-n,Um.elements[12]=n,o=-i*t.aspect+r,s=i*t.aspect+r,Fm.elements[0]=2*t.near/(s-o),Fm.elements[8]=(s+o)/(s-o),this.cameraL.projectionMatrix.copy(Fm),o=-i*t.aspect-r,s=i*t.aspect-r,Fm.elements[0]=2*t.near/(s-o),Fm.elements[8]=(s+o)/(s-o),this.cameraR.projectionMatrix.copy(Fm)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(zm),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Um)}}class Gm{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Vm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Vm();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Vm(){return("undefined"==typeof performance?Date:performance).now()}const jm=new ks,Wm=new Ns,qm=new ks,Km=new ks;class Xm extends Ba{constructor(){super(),this.type="AudioListener",this.context=Nm.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Gm}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(jm,Wm,qm),Km.set(0,0,-1).applyQuaternion(Wm),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(jm.x,e),t.positionY.linearRampToValueAtTime(jm.y,e),t.positionZ.linearRampToValueAtTime(jm.z,e),t.forwardX.linearRampToValueAtTime(Km.x,e),t.forwardY.linearRampToValueAtTime(Km.y,e),t.forwardZ.linearRampToValueAtTime(Km.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(jm.x,jm.y,jm.z),t.setOrientation(Km.x,Km.y,Km.z,n.x,n.y,n.z)}}class Ym extends Ba{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Jm=new ks,Zm=new Ns,Qm=new ks,$m=new ks;class eg extends Ym{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Jm,Zm,Qm),$m.set(0,0,1).applyQuaternion(Zm);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Jm.x,e),t.positionY.linearRampToValueAtTime(Jm.y,e),t.positionZ.linearRampToValueAtTime(Jm.z,e),t.orientationX.linearRampToValueAtTime($m.x,e),t.orientationY.linearRampToValueAtTime($m.y,e),t.orientationZ.linearRampToValueAtTime($m.z,e)}else t.setPosition(Jm.x,Jm.y,Jm.z),t.setOrientation($m.x,$m.y,$m.z)}}class tg{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class ng{constructor(e,t,n){let r,i,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let e=0;e!==r;++e)n[i+e]=n[e];o=t}else{o+=t;const e=t/o;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if(n[e]!==n[e+t]){s.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let e=n,i=r;e!==i;++e)t[e]=t[r+e%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let r=0;r!==i;++r)e[t+r]=e[n+r]}_slerp(e,t,n,r){Ns.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const o=this._workIndex*i;Ns.multiplyQuaternionsFlat(e,o,e,t,e,n),Ns.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,i){const o=1-r;for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]*o+e[n+s]*r}}_lerpAdditive(e,t,n,r,i){for(let o=0;o!==i;++o){const i=t+o;e[i]=e[i]+e[n+o]*r}}}const rg=new RegExp("[\\[\\]\\.:\\/]","g"),ig="[^\\[\\]\\.:\\/]",og="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",sg=/((?:WC+[\/:])*)/.source.replace("WC",ig),ag=/(WCOD+)?/.source.replace("WCOD",og),lg=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ig),cg=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ig),ug=new RegExp("^"+sg+ag+lg+cg+"$"),hg=["material","materials","bones"];class dg{constructor(e,t,n){this.path=t,this.parsedPath=n||dg.parseTrackName(t),this.node=dg.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new dg.Composite(e,t,n):new dg(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(rg,"")}static parseTrackName(e){const t=ug.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==hg.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const o=n(i.children);if(o)return o}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=dg.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const o=e[r];if(void 0===o){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}dg.Composite=class{constructor(e,t,n){const r=n||dg.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},dg.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},dg.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},dg.prototype.GetterByBindingType=[dg.prototype._getValue_direct,dg.prototype._getValue_array,dg.prototype._getValue_arrayElement,dg.prototype._getValue_toArray],dg.prototype.SetterByBindingTypeAndVersioning=[[dg.prototype._setValue_direct,dg.prototype._setValue_direct_setNeedsUpdate,dg.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[dg.prototype._setValue_array,dg.prototype._setValue_array_setNeedsUpdate,dg.prototype._setValue_array_setMatrixWorldNeedsUpdate],[dg.prototype._setValue_arrayElement,dg.prototype._setValue_arrayElement_setNeedsUpdate,dg.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[dg.prototype._setValue_fromArray,dg.prototype._setValue_fromArray_setNeedsUpdate,dg.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class pg{constructor(){this.uuid=is(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length;let s,a=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=a++,t[h]=d,e.push(u);for(let e=0,t=o;e!==t;++e)i[e].push(new dg(u,n[e],r[e]))}else if(d<l){s=e[d];const a=--l,c=e[a];t[c.uuid]=d,e[d]=c,t[h]=a,e[a]=u;for(let e=0,t=o;e!==t;++e){const t=i[e],o=t[a];let s=t[d];t[d]=o,void 0===s&&(s=new dg(u,n[e],r[e])),t[a]=s}}else e[d]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o],a=s.uuid,l=t[a];if(void 0!==l&&l>=i){const o=i++,c=e[o];t[c.uuid]=l,e[l]=c,t[a]=o,e[o]=s;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[o],i=t[l];t[l]=r,t[o]=i}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,o=e.length;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<i){const s=--i,a=e[s],c=--o,u=e[c];t[a.uuid]=l,e[l]=a,t[u.uuid]=s,e[s]=u,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[s],i=t[c];t[l]=r,t[s]=i,t.pop()}}else{const i=--o,s=e[i];i>0&&(t[s.uuid]=l),e[l]=s,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[l]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const i=this._bindings;if(void 0!==r)return i[r];const o=this._paths,s=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[e]=r,o.push(e),s.push(t),i.push(u);for(let n=c,r=a.length;n!==r;++n){const r=a[n];u[n]=new dg(r,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,i=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s];t[e[s]]=n,o[n]=a,o.pop(),i[n]=i[s],i.pop(),r[n]=r[s],r.pop()}}}pg.prototype.isAnimationObjectGroup=!0;class fg{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,o=i.length,s=new Array(o),a={endingStart:uo,endingEnd:uo};for(let e=0;e!==o;++e){const t=i[e].createInterpolant(null);s[e]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=oo,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,r=e._clip.duration,i=r/n,o=n/r;e.warp(1,i,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,o=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=i,a[1]=i+n,l[0]=e/o,l[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;if(r<0||0===n)return;this._startTime=null,t=n*r}t*=this._updateTimeScale(e);const o=this._updateTime(t),s=this._updateWeight(e);if(s>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===mo)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(o),t[n].accumulateAdditive(s);else for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(o),t[n].accumulate(r,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const o=n===so;if(0===e)return-1===i?r:o&&1==(1&i)?t-r:r;if(n===io){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){const t=e<0;this._setEndings(t,!t,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1==(1&i))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=ho,r.endingEnd=ho):(r.endingStart=e?this.zeroSlopeAtStart?ho:uo:po,r.endingEnd=t?this.zeroSlopeAtEnd?ho:uo:po)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const s=o.parameterPositions,a=o.sampleValues;return s[0]=i,a[0]=t,s[1]=i+e,a[1]=n,this}}class mg extends $o{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,s=e._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let e=0;e!==i;++e){const i=r[e],l=i.name;let u=c[l];if(void 0!==u)++u.referenceCount,o[e]=u;else{if(u=o[e],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,l));continue}const r=t&&t._propertyBindings[e].binding.parsedPath;u=new ng(dg.create(n,l,r),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,a,l),o[e]=u}s[e].resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{const t=o.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,o=this._actionsByClip,s=o[i],a=s.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null,delete s.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete o[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,s=o[r],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete s[i],0===Object.keys(s).length&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new kf(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let o="string"==typeof e?Wf.findByName(r,e):e;const s=null!==o?o.uuid:e,a=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:fo),void 0!==a){const e=a.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;l=a.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new fg(this,o,t,n);return this._bindAction(c,l),this._addInactiveAction(c,s,i),c}existingAction(e,t){const n=t||this._root,r=n.uuid,i="string"==typeof e?Wf.findByName(n,e):e,o=i?i.uuid:e,s=this._actionsByClip[o];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1;for(let s=0;s!==n;++s)t[s]._update(r,e,i,o);const s=this._bindings,a=this._nActiveBindings;for(let e=0;e!==a;++e)s[e].apply(o);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,o=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,t[i]=o,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const e in n){const r=n[e].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const e in r){const t=r[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}mg.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class gg{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new gg(void 0===this.value.clone?this.value:this.value.clone())}}class yg extends Kh{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}yg.prototype.isInstancedInterleavedBuffer=!0;class vg{constructor(e,t,n,r,i){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}vg.prototype.isGLBufferAttribute=!0;class _g{constructor(e,t,n=0,r=1/0){this.ray=new ha(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Ea,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return bg(e,this,n,t),n.sort(wg),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)bg(e[r],this,n,t);return n.sort(wg),n}}function wg(e,t){return e.distance-t.distance}function bg(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)bg(r[e],t,n,!0)}}class xg{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(os(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Eg{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const Sg=new ds;class Mg{constructor(e=new ds(1/0,1/0),t=new ds(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Sg.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Sg.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Mg.prototype.isBox2=!0;const Tg=new ks,Ag=new ks;class Rg{constructor(e=new ks,t=new ks){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Tg.subVectors(e,this.start),Ag.subVectors(this.end,this.start);const n=Ag.dot(Ag);let r=Ag.dot(Tg)/n;return t&&(r=os(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Cg=new ks;class Lg extends Ba{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new vl,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,n=32;e<n;e++,t++){const i=e/n*Math.PI*2,o=t/n*Math.PI*2;r.push(Math.cos(i),Math.sin(i),1,Math.cos(o),Math.sin(o),1)}n.setAttribute("position",new cl(r,3));const i=new Id({fog:!1,toneMapped:!1});this.cone=new Hd(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Cg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Cg),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Pg=new ks,Ig=new da,Og=new da;class Ng extends Hd{constructor(e){const t=kg(e),n=new vl,r=[],i=[],o=new Ss(0,0,1),s=new Ss(0,1,0);for(let e=0;e<t.length;e++){const n=t[e];n.parent&&n.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(s.r,s.g,s.b))}n.setAttribute("position",new cl(r,3)),n.setAttribute("color",new cl(i,3)),super(n,new Id({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Og.copy(this.root.matrixWorld).invert();for(let e=0,n=0;e<t.length;e++){const i=t[e];i.parent&&i.parent.isBone&&(Ig.multiplyMatrices(Og,i.matrixWorld),Pg.setFromMatrixPosition(Ig),r.setXYZ(n,Pg.x,Pg.y,Pg.z),Ig.multiplyMatrices(Og,i.parent.matrixWorld),Pg.setFromMatrixPosition(Ig),r.setXYZ(n+1,Pg.x,Pg.y,Pg.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function kg(e){const t=[];e&&e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,kg(e.children[n]));return t}class Dg extends Dl{constructor(e,t,n){super(new ff(t,4,2),new Za({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Bg=new ks,Ug=new Ss,zg=new Ss;class Fg extends Ba{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new hf(t);r.rotateY(.5*Math.PI),this.material=new Za({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new el(o,3)),this.add(new Dl(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Ug.copy(this.light.color),zg.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?Ug:zg;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(Bg.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Hg extends Hd{constructor(e=10,t=10,n=4473924,r=8947848){n=new Ss(n),r=new Ss(r);const i=t/2,o=e/t,s=e/2,a=[],l=[];for(let e=0,c=0,u=-s;e<=t;e++,u+=o){a.push(-s,0,u,s,0,u),a.push(u,0,-s,u,0,s);const t=e===i?n:r;t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3}const c=new vl;c.setAttribute("position",new cl(a,3)),c.setAttribute("color",new cl(l,3)),super(c,new Id({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Gg extends Hd{constructor(e=10,t=16,n=8,r=64,i=4473924,o=8947848){i=new Ss(i),o=new Ss(o);const s=[],a=[];for(let n=0;n<=t;n++){const r=n/t*(2*Math.PI),l=Math.sin(r)*e,c=Math.cos(r)*e;s.push(0,0,0),s.push(l,0,c);const u=1&n?i:o;a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(let t=0;t<=n;t++){const l=1&t?i:o,c=e-e/n*t;for(let e=0;e<r;e++){let t=e/r*(2*Math.PI),n=Math.sin(t)*c,i=Math.cos(t)*c;s.push(n,0,i),a.push(l.r,l.g,l.b),t=(e+1)/r*(2*Math.PI),n=Math.sin(t)*c,i=Math.cos(t)*c,s.push(n,0,i),a.push(l.r,l.g,l.b)}}const l=new vl;l.setAttribute("position",new cl(s,3)),l.setAttribute("color",new cl(a,3)),super(l,new Id({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const Vg=new ks,jg=new ks,Wg=new ks;class qg extends Ba{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let r=new vl;r.setAttribute("position",new cl([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new Id({fog:!1,toneMapped:!1});this.lightPlane=new Ud(r,i),this.add(this.lightPlane),r=new vl,r.setAttribute("position",new cl([0,0,0,0,0,1],3)),this.targetLine=new Ud(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Vg.setFromMatrixPosition(this.light.matrixWorld),jg.setFromMatrixPosition(this.light.target.matrixWorld),Wg.subVectors(jg,Vg),this.lightPlane.lookAt(jg),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(jg),this.targetLine.scale.z=Wg.length()}}const Kg=new ks,Xg=new Vl;class Yg extends Hd{constructor(e){const t=new vl,n=new Id({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={},s=new Ss(16755200),a=new Ss(16711680),l=new Ss(43775),c=new Ss(16777215),u=new Ss(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(r.length/3-1)}h("n1","n2",s),h("n2","n4",s),h("n4","n3",s),h("n3","n1",s),h("f1","f2",s),h("f2","f4",s),h("f4","f3",s),h("f3","f1",s),h("n1","f1",s),h("n2","f2",s),h("n3","f3",s),h("n4","f4",s),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.setAttribute("position",new cl(r,3)),t.setAttribute("color",new cl(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const e=this.geometry,t=this.pointMap;Xg.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Jg("c",t,e,Xg,0,0,-1),Jg("t",t,e,Xg,0,0,1),Jg("n1",t,e,Xg,-1,-1,-1),Jg("n2",t,e,Xg,1,-1,-1),Jg("n3",t,e,Xg,-1,1,-1),Jg("n4",t,e,Xg,1,1,-1),Jg("f1",t,e,Xg,-1,-1,1),Jg("f2",t,e,Xg,1,-1,1),Jg("f3",t,e,Xg,-1,1,1),Jg("f4",t,e,Xg,1,1,1),Jg("u1",t,e,Xg,.7,1.1,-1),Jg("u2",t,e,Xg,-.7,1.1,-1),Jg("u3",t,e,Xg,0,2,-1),Jg("cf1",t,e,Xg,-1,0,1),Jg("cf2",t,e,Xg,1,0,1),Jg("cf3",t,e,Xg,0,-1,1),Jg("cf4",t,e,Xg,0,1,1),Jg("cn1",t,e,Xg,-1,0,-1),Jg("cn2",t,e,Xg,1,0,-1),Jg("cn3",t,e,Xg,0,-1,-1),Jg("cn4",t,e,Xg,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Jg(e,t,n,r,i,o,s){Kg.set(i,o,s).unproject(r);const a=t[e];if(void 0!==a){const e=n.getAttribute("position");for(let t=0,n=a.length;t<n;t++)e.setXYZ(a[t],Kg.x,Kg.y,Kg.z)}}const Zg=new Us;class Qg extends Hd{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new vl;i.setIndex(new el(n,1)),i.setAttribute("position",new el(r,3)),super(i,new Id({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Zg.setFromObject(this.object),Zg.isEmpty())return;const t=Zg.min,n=Zg.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return Hd.prototype.copy.call(this,e),this.object=e.object,this}}class $g extends Hd{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new vl;r.setIndex(new el(n,1)),r.setAttribute("position",new cl([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new Id({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class ey extends Ud{constructor(e,t=1,n=16776960){const r=n,i=new vl;i.setAttribute("position",new cl([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),super(i,new Id({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=new vl;o.setAttribute("position",new cl([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Dl(o,new Za({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?tr:er,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const ty=new ks;let ny,ry;class iy extends Ba{constructor(e=new ks(0,0,1),t=new ks(0,0,0),n=1,r=16776960,i=.2*n,o=.2*i){super(),this.type="ArrowHelper",void 0===ny&&(ny=new vl,ny.setAttribute("position",new cl([0,0,0,0,1,0],3)),ry=new tp(0,.5,1,5,1),ry.translate(0,-.5,0)),this.position.copy(t),this.line=new Ud(ny,new Id({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Dl(ry,new Za({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{ty.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(ty,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class oy extends Hd{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new vl;n.setAttribute("position",new cl(t,3)),n.setAttribute("color",new cl([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new Id({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Ss,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class sy{constructor(){this.type="ShapePath",this.color=new Ss,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Pp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,o){return this.currentPath.bezierCurveTo(e,t,n,r,i,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],i=new Ip;i.curves=r.curves,t.push(i)}return t}function r(e,t){const n=t.length;let r=!1;for(let i=n-1,o=0;o<n;i=o++){let n=t[i],s=t[o],a=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[o],a=-a,s=t[i],l=-l),e.y<n.y||e.y>s.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-a*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x)return!0}}return r}const i=rf.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);let s,a,l;const c=[];if(1===o.length)return a=o[0],l=new Ip,l.curves=a.curves,c.push(l),c;let u=!i(o[0].getPoints());u=e?!u:u;const h=[],d=[];let p,f,m=[],g=0;d[g]=void 0,m[g]=[];for(let t=0,n=o.length;t<n;t++)a=o[t],p=a.getPoints(),s=i(p),s=e?!s:s,s?(!u&&d[g]&&g++,d[g]={s:new Ip,p},d[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:p[0]});if(!d[0])return n(o);if(d.length>1){let e=!1;const t=[];for(let e=0,t=d.length;e<t;e++)h[e]=[];for(let n=0,i=d.length;n<i;n++){const i=m[n];for(let o=0;o<i.length;o++){const s=i[o];let a=!0;for(let i=0;i<d.length;i++)r(s.p,d[i].p)&&(n!==i&&t.push({froms:n,tos:i,hole:o}),a?(a=!1,h[i].push(s)):e=!0);a&&h[n].push(s)}}t.length>0&&(e||(m=h))}for(let e=0,t=d.length;e<t;e++){l=d[e].s,c.push(l),f=m[e];for(let e=0,t=f.length;e<t;e++)l.holes.push(f[e].h)}return c}}const ay=new Float32Array(1),ly=new Int32Array(ay.buffer);class cy{static toHalfFloat(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),ay[0]=e;const t=ly[0];let n=t>>16&32768,r=t>>12&2047;const i=t>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&t,n):i<113?(r|=2048,n|=(r>>114-i)+(r>>113-i&1),n):(n|=i-112<<10|r>>1,n+=1&r,n)}}const uy=0,hy=1,dy=0,py=1,fy=2;function my(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function gy(e=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function yy(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Xd(e,t)}function vy(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ud(e)}function _y(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Xd(e,t)}function wy(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Vd(e)}function by(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Vd(e)}function xy(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Vd(e)}function Ey(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ks(e,t,n)}function Sy(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new el(e,t).setUsage(Go)}function My(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new tl(e,t)}function Ty(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new nl(e,t)}function Ay(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new rl(e,t)}function Ry(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new il(e,t)}function Cy(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ol(e,t)}function Ly(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new sl(e,t)}function Py(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new al(e,t)}function Iy(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new cl(e,t)}function Oy(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new ul(e,t)}function Ny(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new oy(e)}function ky(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Qg(e,t)}function Dy(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Hd(new cp(e.geometry),new Id({color:void 0!==t?t:16777215}))}function By(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Hd(new _f(e.geometry),new Id({color:void 0!==t?t:16777215}))}function Uy(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Qf(e)}function zy(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new rm(e)}function Fy(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Xl(e,n)}function Hy(){console.error("THREE.CanvasRenderer has been removed")}function Gy(){console.error("THREE.JSONLoader has been removed.")}up.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(up.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Pp.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},Hg.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ng.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Jf.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Mm.extractUrlBase(e)},Jf.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Mg.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},Mg.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Mg.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Mg.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Us.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Us.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Us.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Us.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Us.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},ra.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},tc.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Rg.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},ps.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},ps.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ps.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ps.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ps.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ps.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},da.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},da.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},da.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ks).setFromMatrixColumn(this,3)},da.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},da.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},da.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},da.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},da.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},da.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},da.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},da.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},da.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},da.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},da.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},da.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},da.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},da.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},da.prototype.makeFrustum=function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)},da.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Ql.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ns.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Ns.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},ha.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},ha.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},ha.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Xa.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Xa.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Xa.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Xa.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Xa.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Xa.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Xa.getBarycoord(e,t,n,r,i)},Xa.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Xa.getNormal(e,t,n,r)},Ip.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Ip.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new af(this,e)},Ip.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new pf(this,e)},ds.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},ds.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},ds.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ks.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ks.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ks.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},ks.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},ks.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},ks.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},ks.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},ks.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},ks.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ls.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Ls.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ba.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Ba.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Ba.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Ba.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Ba.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Ba.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Dl.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Dl.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),go},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),wd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},jl.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(om.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(el.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Go},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Go)}}}),el.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Go:Ho),this},el.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},el.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},vl.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},vl.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new el(arguments[1],arguments[2])))},vl.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},vl.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},vl.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},vl.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},vl.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(vl.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Kh.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Go:Ho),this},Kh.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},af.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},af.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},af.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},qh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},gg.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Ja.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ss}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===rr}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Gl.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Gh.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},Gh.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},Gh.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Gh.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Gh.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Gh.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Gh.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Gh.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Gh.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Gh.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Gh.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Gh.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Gh.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Gh.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Gh.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},Gh.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Gh.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Gh.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Gh.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Gh.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Gh.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Gh.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Gh.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Gh.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Gh.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Gh.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?wo:_o}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(Ph.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ps.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Ym.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new km).load(e,(function(e){t.setBuffer(e)})),this},tg.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ql.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},ql.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},Ts.crossOrigin=void 0,Ts.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new im;i.setCrossOrigin(this.crossOrigin);const o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},Ts.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new nm;i.setCrossOrigin(this.crossOrigin);const o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},Ts.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ts.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Vy={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function jy(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function Wy(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new vl}function qy(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new vl}function Ky(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function Xy(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function Yy(){console.error("THREE.ImmediateRenderObject has been removed.")}function Jy(e,t=!1){const n=null!==e[0].index,r=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),o={},s={},a=e[0].morphTargetsRelative,l=new vl;let c=0;for(let u=0;u<e.length;++u){const h=e[u];let d=0;if(n!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const e in h.attributes){if(!r.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[e]&&(o[e]=[]),o[e].push(h.attributes[e]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const e in h.morphAttributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===s[e]&&(s[e]=[]),s[e].push(h.morphAttributes[e])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(h.userData),t){let e;if(n)e=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;e=h.attributes.position.count}l.addGroup(c,e,u),c+=e}}if(n){let t=0;const n=[];for(let r=0;r<e.length;++r){const i=e[r].index;for(let e=0;e<i.count;++e)n.push(i.getX(e)+t);t+=e[r].attributes.position.count}l.setIndex(n)}for(const e in o){const t=Zy(o[e]);if(!t)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" attribute."),null;l.setAttribute(e,t)}for(const e in s){const t=s[e][0].length;if(0===t)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[e]=[];for(let n=0;n<t;++n){const t=[];for(let r=0;r<s[e].length;++r)t.push(s[e][r][n]);const r=Zy(t);if(!r)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" morphAttribute."),null;l.morphAttributes[e].push(r)}}return l}function Zy(e){let t,n,r,i=0;for(let o=0;o<e.length;++o){const s=e[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===r&&(r=s.normalized),r!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=s.array.length}const o=new t(i);let s=0;for(let t=0;t<e.length;++t)o.set(e[t].array,s),s+=e[t].array.length;return new el(o,n,r)}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Vn}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Vn);var Qy={};const $y=t=>{var n;switch(t.type){case"ShapeGeometry":var r=new Ip;t.shapeArgs.forEach((e=>r[e.draw](...e.drawArgs))),(n={args:t.args,geometry:new pf(r)}).edges=new cp(n.geometry);break;case"ExtrudeGeometry":r=new Ip,t.shapeArgs.forEach((e=>r[e.draw](...e.drawArgs))),(n={geometry:new af(r,t.extrudeSettings)}).edges=new cp(n.geometry);break;case"ParametricGeometry":const o=new vl;o.setAttribute("position",new el(t.attributes.position.array,t.attributes.position.itemSize,t.attributes.position.Boolean)),o.setAttribute("normal",new el(t.attributes.normal.array,t.attributes.normal.itemSize,t.attributes.normal.Boolean)),o.setAttribute("uv",new el(t.attributes.uv.array,t.attributes.uv.itemSize,t.attributes.uv.Boolean)),o.setIndex(new el(t.index.array,t.index.itemSize,t.index.Boolean)),(n={geometry:o}).edges=new cp(n.geometry);break;default:if(Qy.hasOwnProperty(t.type)){var i=!1;Qy[t.type].forEach((e=>{if(e.args.length===t.args.length){var r=!0;for(let n=0;n<e.args.length;n++)e.args[n]===t.args[n]||(r=!1);r&&(i=!0,(n=e).count++,n.instances=[])}})),i||((n={args:t.args,geometry:new e[t.type](...t.args),count:1}).edges=new cp(n.geometry),Qy[t.type].push(n))}else Qy[t.type]=[],(n={args:t.args,geometry:new e[t.type](...t.args),count:1}).edges=new cp(n.geometry),Qy[t.type].push(n)}return n},ev=new Worker(new URL(n.p+n.u(482),n.b)),tv=(e,t,n,r)=>{ev.postMessage({img:e,id:t,type:n,location:r,currentRoom:AM.room})},nv=new im,rv=e=>new Promise((t=>nv.load(e,t))),iv="rgb(255,0,0)",ov="rgb(0,255,235)",sv=new Za({color:"white",opacity:.85,transparent:!0}),av=new Id({color:"black",onBeforeCompile:e=>{e.vertexShader=`\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ${e.vertexShader}\n`.replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),lv=new Id({color:ov}),cv=new Id({color:"red"}),uv=new Id({color:"black"}),hv=new Id({color:ov,onBeforeCompile:e=>{e.vertexShader=`\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ${e.vertexShader}\n`.replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),dv=new Id({color:iv,onBeforeCompile:e=>{e.vertexShader=`\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ${e.vertexShader}\n`.replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),pv=new Za({color:iv,side:nr}),fv=new Za({color:ov,side:nr}),mv={ghost:sv,whiteFull:new Za({color:"white",side:nr}),blackFull:new Za({color:"black",side:nr}),redFull:pv,redLineLone:cv,redLine:dv,cyanFull:fv,cyanLine:hv,red:iv,cyan:ov,blackLine:av,hatchingMaterial:0,blackColor:new Ss("rgb(0, 0, 0)"),whiteColor:new Ss("rgb(255, 255, 255)"),blackLineLone:uv,cyanLineLone:lv,redColor:new Ss(iv),cyanColor:new Ss(ov)};var gv=n(8687);const yv={},vv=document.getElementById("connectInfo"),_v=(e,t)=>{vv.innerHTML="",yv[e]=t;var n="";for(const e in yv)n+=`${e} - ${yv[e]}<br>`;vv.innerHTML=n},wv=gv.gql`
  query getProfiles($artists: [String!]!) {
    holder(where: { address: { _in: $artists } }) {
      alias
      address
      description
      discord
      dns
      email
      ethereum
      facebook
      flag
      github
      gitlab
      inserted_at
      instagram
      last_metadata_update
      logo
      medium
      reddit
      slack
      support
      telegram
      twitter
      tzdomain
      website
    }
  }
`,bv={};async function xv(e,t){const n=[];return e.forEach((e=>{bv.hasOwnProperty(e)||n.push(e)})),await(0,gv.request)("https://data.objkt.com/v3/graphql",wv,{artists:n}).then((e=>{e&&(e.hasOwnProperty("holder")&&e.holder.forEach((e=>bv[e.address]=e)),t&&e.tzprofiles[0].alias&&eT(e.tzprofiles[0].alias))})).catch((e=>{console.log("tzProfiles is currently unable to provide detailed user information.")}))}const Ev=gv.gql`
  query getUserGenerators($userId: String, $take: Int) {
    user(id: $userId) {
      generativeTokens(take: $take) {
        name
        id
        slug
        thumbnailUri
      }
    }
  }
`,Sv=gv.gql`
  query GetObjktsByHolderPaged(
    $limit: Int!
    $offset: Int!
    $where: token_holder_bool_exp = {}
    $order_by: [token_holder_order_by!] = {}
  ) {
    token_holder(
      limit: $limit
      offset: $offset
      where: $where
      order_by: $order_by
    ) {
      token {
        ...TokenDefault
        __typename
        fa {
          collection_type
          contract
          name
        }
      }
      __typename
      holder {
        alias
      }
    }
  }

  fragment TokenDefault on token {
    pk
    token_id
    artifact_uri
    description
    display_uri
    thumbnail_uri
    timestamp
    name
    creators {
      creator_address
    }
    attributes {
      attribute {
        id
        name
        type
        value
        __typename
      }
      __typename
    }
    __typename
  }
`,Mv=gv.gql`
  query getUserGenCollection($generativeTokenId: Float) {
    generativeToken(id: $generativeTokenId) {
      entireCollection {
        id
        name
        metadata
      }
    }
  }
`;var Tv,Av=0,Rv={},Cv={};const Lv=(e,t)=>{Tv=e,(0,gv.request)("https://data.objkt.com/v3/graphql",Sv,JSON.parse(((e,t,n)=>`\n    {\n        "where": {\n          "holder_address": {\n            "_eq": "${e}"\n          },\n          "quantity": {\n            "_gt": 0\n          },\n          "token": {\n            "fa": {\n              "live": {\n                "_eq": true\n              }\n            }\n          }\n        },\n        "order_by": {\n          "last_incremented_at": "desc"\n        },\n        "limit": 500,\n        "offset": "${t}"\n      }`)(e,Av))).then((e=>{if(e.token_holder.forEach((e=>{if(e.token.hasOwnProperty("creators")&&e.token.creators[0]){var t=e.token.creators[0].creator_address;Cv.hasOwnProperty(t)?Cv[t].push(e.token):Cv[t]=[e.token],Rv.hasOwnProperty(t)||(Rv[t]=e.token.creators[0].alias),tM[JSON.stringify(e.token.pk)]=e.token}})),500===e.token_holder.length)Av+=500,setTimeout((()=>{Lv(Tv)}),1e3);else{var n=[],r=[];for(const e in Cv)n.push(Cv[e][0]),r.push(e);xv(r).then((e=>{kv(Cv,n,t)})),_v("OBJKT tokens retrieval","")}})).catch((e=>{console.log("Failed to retrieve your OBJKT tokens"),console.log(e),_v("OBJKT tokens retrieval","")}))};var Pv={},Iv=[];const Ov=(e,t)=>{(0,gv.request)("https://data.objkt.com/v3/graphql",((e,t)=>gv.gql`
query getArtistCreations {
  token_creator(offset: ${e}, where: {creator_address: {_eq: ${t}}, token: {fa: {contract: {_nin: ["KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE","KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi"]}}}}) {
    token {
       pk
    token_id
    artifact_uri
    description
    display_uri
    thumbnail_uri
    timestamp
    name
    creators {
      creator_address
    }
    attributes {
      attribute {
        id
        name
        type
        value
        __typename
      }
      __typename
    }
    __typename
         fa {
          collection_type
          contract
          name
        }
      creators {
        creator_address
      }
    }
  }
}
`)(e,t)).then((n=>{if(n.token_creator.forEach((e=>{const t=e.token.fa.name+"-"+e.token.fa.contract;Pv.hasOwnProperty(t)||(Pv[t]=[]),Pv[t].push(e.token)})),500===n.token_creator.length)setTimeout((()=>{Ov(e+1,t)}),1e3);else for(const e in Pv){const t=document.createElement("div");t.className="gentkProfiles";const n=Pv[e][0],r=new Image;r.className="thumbnail",r.src="https://assets.objkt.media/file/assets-003/"+n.fa.contract+"/"+n.token_id+"/thumb288",n.display_uri||(r.style.width="200px",r.style.imageRendering="pixelated",r.src=n.artifact_uri),r.onerror=e=>{r.src="/notfound.png"},r.style.cursor="pointer",r.addEventListener("click",(()=>{const t=Nv(Pv[e]);n.DOMelements={gallery:t},dP(n)})),r&&t.appendChild(r);const i=document.createElement("div");i.className="artThumbTitle";const o=document.createElement("div");o.className="artistNames",o.innerText=n.fa.name,i.appendChild(o),t.appendChild(i),Iv.push(t)}_v("Personal creations retrieval","")})).catch((e=>{console.log("Failed to retrieve your OBJKT tokens"),console.log(e),_v("Personal creations retrieval","")}))},Nv=e=>{var t=[];return e.forEach((e=>{const n=e.fa.contract+e.token_id,r=document.createElement("li");r.className="gentkCell";const i=document.createElement("div");var o="";i.className="thumbTitle";const s=new Image;s.className="thumbnail",e.hasOwnProperty("metadata")&&(s.src="https://gateway.fxhash.xyz/ipfs/"+e.metadata.thumbnailUri.replace("ipfs://",""),s.style.cursor="pointer",e.metadata.displayUri.replace("ipfs://",""));var a="https://objkt.com/asset/"+e.fa.contract+"/"+e.token_id;e.url=a,e.hasOwnProperty("name")&&(o=e.name,s.src="https://assets.objkt.media/file/assets-003/"+e.fa.contract+"/"+e.token_id+"/thumb288",e.display_uri||(s.style.width="200px",s.style.imageRendering="pixelated",s.src=e.artifact_uri),s.onerror=e=>{s.src="/notfound.png"},s.style.cursor="pointer");var l="<div style='font-size:10px'>Check token on <a target='_blank' href='"+a+"'>OBJKT</a> </div>";i.innerHTML=o+"<br>"+l,tM[n]=e,s.addEventListener("click",(()=>{Bv(e,n)})),r.appendChild(s),r.appendChild(i),t.push(r)})),t},kv=(e,t)=>{var n=0;t.forEach((t=>{n++,setTimeout((()=>{const n=new Image;n.className="thumbnail",n.src="https://assets.objkt.media/file/assets-003/"+t.fa.contract+"/"+t.token_id+"/thumb288",n.style.cursor="pointer",t.display_uri||(n.style.width="200px",n.style.imageRendering="pixelated",n.src=t.artifact_uri),n.onerror=e=>{n.src="/notfound.png"},n.addEventListener("click",(()=>{const n=Dv(e,t);t.DOMelements={gallery:n},dP(t)})),Uv(bv[t.creators[0].creator_address],n)}),50*n)}))},Dv=(e,t)=>{var n=e[t.creators[0].creator_address];const r=[];return n.forEach((e=>{const t=e.pk,n=document.createElement("li");n.className="gentkCell";const i=document.createElement("div");var o="";i.className="thumbTitle";const s=new Image;s.className="thumbnail",e.hasOwnProperty("metadata")&&(s.src="https://gateway.fxhash.xyz/ipfs/"+e.metadata.thumbnailUri.replace("ipfs://",""),s.style.cursor="pointer",e.metadata.displayUri.replace("ipfs://",""));var a="https://objkt.com/asset/"+e.fa.contract+"/"+e.token_id;e.url=a,e.hasOwnProperty("name")&&(o=e.name,s.src="https://assets.objkt.media/file/assets-003/"+e.fa.contract+"/"+e.token_id+"/thumb288",e.display_uri||(s.style.width="200px",s.style.imageRendering="pixelated",s.src=e.artifact_uri),s.onerror=e=>{s.src="/notfound.png"},s.style.cursor="pointer");var l="<div style='font-size:10px'>Check token on <a target='_blank' href='"+a+"'>OBJKT</a> </div>";i.innerHTML=o+"<br>"+l,s.addEventListener("click",(()=>{Bv(e,t)})),n.appendChild(s),n.appendChild(i),r.push(n)})),r},Bv=(e,t)=>{var n;mP(),n=e.display_uri?"https://assets.objkt.media/file/assets-003/"+e.display_uri.replace("ipfs://","")+"/display":e.artifact_uri,tv(n,{id:t},"objkt")};function Uv(e,t){const n=document.createElement("div");if(n.className="gentkProfiles",t&&n.appendChild(t),e&&(e.twitter||e.alias||e.logo)){e.alias||(e.alias="");const t=document.createElement("div");t.className="artThumbTitle";const i=e.twitter?`@${e.twitter}`:"",o=document.createElement("div");o.className="artistNames";var r=e.alias.length<50?e.alias:e.alias.substring(0,50)+"";if(o.innerHTML=`<span>${r}</span>\n  <span><a href="${e.twitter}" target="_blank">${i.replace("https://twitter.com/","")}</a></span>`,e.logo&&e.logo.indexOf("ipfs")>-1)try{const n=document.createElement("img");n.className="profilePic",n.src=e.logo,n.addEventListener("error",(t=>{e.alias&&console.log("%c The profile picture of |"+e.alias+"| cannot be found.","font-weight:bold"),n.style.display="none"})),t.appendChild(n)}catch(e){console.log("failed getting image")}t.appendChild(o),n.appendChild(t)}nM.push(n)}var zv={};const Fv=e=>{fetch(`https://api.opensea.io/api/v1/collections?asset_owner=${e}&offset=0&limit=300`,{method:"GET",headers:{Accept:"application/json"}}).then((e=>e.json())).then((t=>{t.forEach((t=>{var n,r="";t.primary_asset_contracts.forEach((e=>r+=e.name+" ")),(n=new Image).className="thumbnail",n.style.width="200px",n.style.height="200px",n.style.objectFit="cover",t.image_url&&(n.src=t.banner_image_url),n.addEventListener("error",(()=>n.src="./missing.png"));const i=t.slug;n.addEventListener("click",(()=>{((e,t)=>{zv.hasOwnProperty(t)?dP(zv[t]):fetch(`https://api.opensea.io/api/v1/assets?owner=${e}&collection_slug=${t}&order_direction=desc&limit=50&include_orders=false`,{method:"GET",headers:{Accept:"application/json","X-API-KEY":"a73d594a3303471a82688d0b300ac6a0"}}).then((e=>e.json())).then((e=>{zv[t]={data:[]},e.assets.forEach((e=>{tM[JSON.stringify(e.id)]=e,zv[t].data.push(e)})),(e=>{var t=zv[e].data;const n=[];t.forEach((e=>{const t=e.id,r=document.createElement("li");r.className="gentkCell";const i=document.createElement("div"),o=e.name;i.className="thumbTitle";const s=new Image;s.className="thumbnail",s.src=e.image_url,e.image_url;const a=e.permalink;s.style.cursor="pointer";var l="<div style='font-size:10px'>Check token on <a target='_blank' href='"+a+"'>OpenSea</a> </div>";i.innerHTML=o+"<br>"+l,s.addEventListener("click",(()=>{((e,t)=>{mP(),tv(e.image_url,{id:t,objkt:e},"openSea")})(e,t)})),r.appendChild(s),r.appendChild(i),n.push(r)})),zv[e].DOMelements={gallery:n}})(t),dP(zv[t])})).catch((e=>console.error(e)))})(e,i)})),Uv({name:r,twitter:t.twitter_username,logo:null},n)})),_v("OpenSea tokens retrieval","")})).catch((e=>{console.log("Failed to retrieve your OpenSea tokens"),console.log(e),_v("OpenSea tokens retrieval","")}))};var Hv,Gv,Vv;function jv(e){return Object.keys(e)}!function(e){e.transfer_request="transfer_request",e.sign_payload_request="sign_payload_request"}(Hv||(Hv={})),function(e){e.transfer="transfer",e.sign_payload_json="sign_payload_json",e.sign_payload_raw="sign_payload_raw"}(Gv||(Gv={})),function(e){e.PENDING="pending",e.RESOLVED="resolved",e.REJECTED="rejected"}(Vv||(Vv={}));const Wv=()=>{throw new Error("ExposedPromise not initialized yet.")};class qv{constructor(){this._resolve=Wv,this._reject=Wv,this._status=Vv.PENDING,this._promise=new Promise(((e,t)=>{this._resolve=t=>{this.isSettled()||(this._promiseResult=t,e(t),this._status=Vv.RESOLVED)},this._reject=e=>{this.isSettled()||(this._promiseError=e,t(e),this._status=Vv.REJECTED)}}))}get promise(){return this._promise}get resolve(){return this._resolve}get reject(){return this._reject}get status(){return this._status}get promiseResult(){return this._promiseResult}get promiseError(){return this._promiseError}static resolve(e){const t=new qv;return t.resolve(e),t}static reject(e){const t=new qv;return t.reject(e),t}isPending(){return this.status===Vv.PENDING}isResolved(){return this.status===Vv.RESOLVED}isRejected(){return this.status===Vv.REJECTED}isSettled(){return this.isResolved()||this.isRejected()}}var Kv=n(8334),Xv=n(450),Yv=n(1416),Jv=n(6249),Zv=n(1322),Qv=n(1050),$v=n(3683),e_=n(8764).Buffer,t_=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function n_(e){return e_.from(e).toString("hex")}function r_(e){return t_(this,void 0,void 0,(function*(){return n_("string"==typeof e?(0,Zv.hash)((0,Jv.cv)(e),32):(0,Zv.hash)(e,32))}))}function i_(e){return t_(this,void 0,void 0,(function*(){return(0,Qv._w)((0,Zv.hash)((0,Jv.cv)(e),32))}))}function o_(e,t){return t_(this,void 0,void 0,(function*(){const n=e_.from((0,Yv.randomBytes)(24));return n_(e_.concat([n,e_.from((0,Xv.secretBox)(t,n,e_.from(e,"utf8")))]))}))}function s_(e,t){return t_(this,void 0,void 0,(function*(){const n=e.slice(0,24),r=e.slice(24),i=(0,Xv.openSecretBox)(t,n,r);if(!i)throw new Error("Decryption failed");return e_.from(i).toString("utf8")}))}function a_(e,t,n){return t_(this,void 0,void 0,(function*(){const r=(0,Qv.zh)(e_.from(n)),i=(0,Qv.SH)(e_.from(t)),o="string"==typeof e?(0,Jv.cv)(e):e,s=o.slice(0,32),a=o.slice(32),l=new Zv.BLAKE2b(24).update(s,32).update(i,32).digest(),c=(0,Xv.openBox)(s,r,l,a);if(!c)throw new Error("Decryption failed");return e_.from(c).toString()}))}function l_(e,t){return`@${e}:${t}`}var c_,u_,h_,d_,p_,f_,m_,g_,y_,v_,__,w_,b_,x_,E_=n(8764).Buffer;function S_(){return e=this,t=void 0,r=function*(){const e=(0,Yv.randomBytes)(16);return[e.slice(0,4),e.slice(4,6),e.slice(6,8),e.slice(8,10),e.slice(10,16)].map((function(e){return E_.from(e).toString("hex")})).join("-")},new((n=void 0)||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}));var e,t,n,r}(x_=c_||(c_={})).BlockchainRequest="blockchain_request",x_.PermissionRequest="permission_request",x_.SignPayloadRequest="sign_payload_request",x_.OperationRequest="operation_request",x_.BroadcastRequest="broadcast_request",x_.BlockchainResponse="blockchain_response",x_.PermissionResponse="permission_response",x_.SignPayloadResponse="sign_payload_response",x_.OperationResponse="operation_response",x_.BroadcastResponse="broadcast_response",x_.Acknowledge="acknowledge",x_.Disconnect="disconnect",x_.Error="error",function(e){e.SIGN="sign",e.OPERATION_REQUEST="operation_request",e.ENCRYPT="encrypt",e.THRESHOLD="threshold"}(u_||(u_={})),function(e){e.MAINNET="mainnet",e.GHOSTNET="ghostnet",e.MONDAYNET="mondaynet",e.DAILYNET="dailynet",e.DELPHINET="delphinet",e.EDONET="edonet",e.FLORENCENET="florencenet",e.GRANADANET="granadanet",e.HANGZHOUNET="hangzhounet",e.ITHACANET="ithacanet",e.JAKARTANET="jakartanet",e.KATHMANDUNET="kathmandunet",e.CUSTOM="custom"}(h_||(h_={})),function(e){e.ENDORSEMENT="endorsement",e.SEED_NONCE_REVELATION="seed_nonce_revelation",e.DOUBLE_ENDORSEMENT_EVIDENCE="double_endorsement_evidence",e.DOUBLE_BAKING_EVIDENCE="double_baking_evidence",e.ACTIVATE_ACCOUNT="activate_account",e.PROPOSALS="proposals",e.BALLOT="ballot",e.REVEAL="reveal",e.TRANSACTION="transaction",e.ORIGINATION="origination",e.DELEGATION="delegation"}(d_||(d_={})),function(e){e.WEBSITE="website",e.EXTENSION="extension",e.P2P="p2p"}(p_||(p_={})),function(e){e.BACKGROUND="toBackground",e.PAGE="toPage",e.EXTENSION="toExtension"}(f_||(f_={})),(b_=m_||(m_={})).BROADCAST_ERROR="BROADCAST_ERROR",b_.NETWORK_NOT_SUPPORTED="NETWORK_NOT_SUPPORTED",b_.NO_ADDRESS_ERROR="NO_ADDRESS_ERROR",b_.NO_PRIVATE_KEY_FOUND_ERROR="NO_PRIVATE_KEY_FOUND_ERROR",b_.NOT_GRANTED_ERROR="NOT_GRANTED_ERROR",b_.PARAMETERS_INVALID_ERROR="PARAMETERS_INVALID_ERROR",b_.TOO_MANY_OPERATIONS="TOO_MANY_OPERATIONS",b_.TRANSACTION_INVALID_ERROR="TRANSACTION_INVALID_ERROR",b_.SIGNATURE_TYPE_NOT_SUPPORTED="SIGNATURE_TYPE_NOT_SUPPORTED",b_.ABORTED_ERROR="ABORTED_ERROR",b_.UNKNOWN_ERROR="UNKNOWN_ERROR",(w_=g_||(g_={})).NOT_CONNECTED="NOT_CONNECTED",w_.CONNECTING="CONNECTING",w_.CONNECTED="CONNECTED",function(e){e.CHROME_MESSAGE="chrome_message",e.POST_MESSAGE="post_message",e.LEDGER="ledger",e.P2P="p2p"}(y_||(y_={})),(__=v_||(v_={})).TRANSPORT_P2P_PEERS_DAPP="beacon:communication-peers-dapp",__.TRANSPORT_P2P_PEERS_WALLET="beacon:communication-peers-wallet",__.TRANSPORT_POSTMESSAGE_PEERS_DAPP="beacon:postmessage-peers-dapp",__.TRANSPORT_POSTMESSAGE_PEERS_WALLET="beacon:postmessage-peers-wallet",__.ACCOUNTS="beacon:accounts",__.ACTIVE_ACCOUNT="beacon:active-account",__.BEACON_SDK_SECRET_SEED="beacon:sdk-secret-seed",__.APP_METADATA_LIST="beacon:app-metadata-list",__.PERMISSION_LIST="beacon:permissions",__.BEACON_SDK_VERSION="beacon:sdk_version",__.MATRIX_PRESERVED_STATE="beacon:sdk-matrix-preserved-state",__.MATRIX_PEER_ROOM_IDS="beacon:matrix-peer-rooms",__.MATRIX_SELECTED_NODE="beacon:matrix-selected-node",__.MULTI_NODE_SETUP_DONE="beacon:multi-node-setup";const M_={[v_.TRANSPORT_P2P_PEERS_DAPP]:[],[v_.TRANSPORT_P2P_PEERS_WALLET]:[],[v_.TRANSPORT_POSTMESSAGE_PEERS_DAPP]:[],[v_.TRANSPORT_POSTMESSAGE_PEERS_WALLET]:[],[v_.ACCOUNTS]:[],[v_.ACTIVE_ACCOUNT]:void 0,[v_.BEACON_SDK_SECRET_SEED]:void 0,[v_.APP_METADATA_LIST]:[],[v_.PERMISSION_LIST]:[],[v_.BEACON_SDK_VERSION]:void 0,[v_.MATRIX_PRESERVED_STATE]:{},[v_.MATRIX_PEER_ROOM_IDS]:{},[v_.MATRIX_SELECTED_NODE]:void 0,[v_.MULTI_NODE_SETUP_DONE]:void 0};var T_,A_;!function(e){e.RAW="raw",e.OPERATION="operation",e.MICHELINE="micheline"}(T_||(T_={})),function(e){e.LIGHT="light",e.DARK="dark"}(A_||(A_={}));const R_=[e=>{}];let C_={postMessage:(e,t)=>{console.log("GOT MOCK POST MESSAGE",e),R_.forEach((t=>{t({data:e})}))},addEventListener:(e,t)=>{R_.push(t)},removeEventListener:(e,t)=>{R_.splice(R_.indexOf((e=>e===t)),1)},location:{origin:"*"}};try{"undefined"!=typeof window&&(C_=window)}catch(e){console.log(`not defined: ${e}`)}var L_=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},P_=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class I_{constructor(e,t){this.storage=e,this.storageKey=t}getAll(){return P_(this,void 0,void 0,(function*(){return this.storage.get(this.storageKey)}))}getOne(e){return P_(this,void 0,void 0,(function*(){return(yield this.storage.get(this.storageKey)).find(e)}))}addOne(e,t,n=!0){return P_(this,void 0,void 0,(function*(){const r=yield this.storage.get(this.storageKey);if(r.some(t)){if(n)for(let n=0;n<r.length;n++)t(r[n])&&(r[n]=e)}else r.push(e);return this.storage.set(this.storageKey,r)}))}remove(e){return P_(this,void 0,void 0,(function*(){const t=(yield this.storage.get(this.storageKey)).filter((t=>!e(t)));return this.storage.set(this.storageKey,t)}))}removeAll(){return P_(this,void 0,void 0,(function*(){return this.storage.delete(this.storageKey)}))}}var O_=n(8764).Buffer;const N_=(e,t)=>{return n=void 0,r=void 0,o=function*(){const n=[e,t.type];t.name&&n.push(`name:${t.name}`),t.rpcUrl&&n.push(`rpc:${t.rpcUrl}`);const r=O_.from((0,Zv.hash)((0,Jv.cv)(n.join("-")),10));return Kv.encode(r)},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{l(o.next(e))}catch(e){t(e)}}function a(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(s,a)}l((o=o.apply(n,r||[])).next())}));var n,r,i,o};var k_=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class D_{constructor(e){this.storageManager=new I_(e,v_.ACCOUNTS)}getAccounts(){return k_(this,void 0,void 0,(function*(){return this.storageManager.getAll()}))}getAccount(e){return k_(this,void 0,void 0,(function*(){return this.storageManager.getOne((t=>t.accountIdentifier===e))}))}addAccount(e){return k_(this,void 0,void 0,(function*(){return this.storageManager.addOne(e,(t=>t.accountIdentifier===e.accountIdentifier))}))}removeAccount(e){return k_(this,void 0,void 0,(function*(){return this.storageManager.remove((t=>t.accountIdentifier===e))}))}removeAccounts(e){return k_(this,void 0,void 0,(function*(){return this.storageManager.remove((t=>e.includes(t.accountIdentifier)))}))}removeAllAccounts(){return k_(this,void 0,void 0,(function*(){return this.storageManager.removeAll()}))}hasPermission(e){return k_(this,void 0,void 0,(function*(){return class{static hasPermission(e,t,n){return r=this,i=void 0,s=function*(){switch(e.type){case c_.PermissionRequest:case c_.BroadcastRequest:return!0;case c_.OperationRequest:{const n=yield N_(e.sourceAddress,e.network),r=yield t(n);return!!r&&r.scopes.includes(u_.OPERATION_REQUEST)}case c_.SignPayloadRequest:{const t=(yield n()).filter((t=>t.address===e.sourceAddress));return 0!==t.length&&t.some((e=>e.scopes.includes(u_.SIGN)))}default:throw new Error("Message not handled")}},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(s.next(e))}catch(e){t(e)}}function a(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,a)}l((s=s.apply(r,i||[])).next())}));var r,i,o,s}}.hasPermission(e,this.getAccount.bind(this),this.getAccounts.bind(this))}))}}var B_=n(8764).Buffer;const U_=e=>{return t=void 0,n=void 0,i=function*(){const t=B_.from((0,Zv.hash)(B_.from(e,"hex"),5));return Kv.encode(t)},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i};let z_=!!C_.beaconSdkDebugEnabled;z_&&console.log("[BEACON]: Debug mode is ON (turned on either by the developer or a browser extension)");class F_{constructor(e){this.name=e}debug(e,...t){H_.debug(this.name,e,t)}log(e,...t){H_.log(this.name,e,t)}warn(e,...t){H_.warn(this.name,e,t)}error(e,...t){H_.error(this.name,e,t)}}new F_("");let H_=new class{constructor(){}debug(e,t,...n){this._log("debug",e,t,n)}log(e,t,...n){this._log("log",e,t,n)}warn(e,t,...n){this._log("warn",e,t,n)}error(e,t,...n){this._log("error",e,t,n)}_log(e,t,n,r=[]){if(!z_)return;let i=`[BEACON] ${(new Date).toISOString()} [${t}](${n})`,o=r;switch(r[0]&&"string"==typeof r[0]&&(i+=` ${r[0]}`,o=r.slice(1)),e){case"error":console.group(i),console.error(...o);break;case"warn":console.group(i),console.warn(...o);break;case"debug":console.groupCollapsed(i),console.debug(...o);break;default:console.group(i),console.log(...o)}console.groupEnd()}};var G_=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const V_=new F_("Client");class j_{constructor(e,t){this.name="BeaconError",this.title="Error",this.message=`[${e}]:${t}`,this.description=t}get fullDescription(){return{description:this.description}}static getError(e,t){switch(e){case m_.BROADCAST_ERROR:return new W_;case m_.NETWORK_NOT_SUPPORTED:return new q_;case m_.NO_ADDRESS_ERROR:return new K_;case m_.NO_PRIVATE_KEY_FOUND_ERROR:return new X_;case m_.NOT_GRANTED_ERROR:return new Y_;case m_.PARAMETERS_INVALID_ERROR:return new J_;case m_.TOO_MANY_OPERATIONS:return new Z_;case m_.TRANSACTION_INVALID_ERROR:return new Q_(t);case m_.SIGNATURE_TYPE_NOT_SUPPORTED:return new ww;case m_.ABORTED_ERROR:return new uw;case m_.UNKNOWN_ERROR:return new $_}}}class W_ extends j_{constructor(){super(m_.BROADCAST_ERROR,"The transaction could not be broadcast to the network. Please try again."),this.name="BroadcastBeaconError",this.title="Broadcast Error"}}class q_ extends j_{constructor(){super(m_.NETWORK_NOT_SUPPORTED,"The wallet does not support this network. Please select another one."),this.name="NetworkNotSupportedBeaconError",this.title="Network Error"}}class K_ extends j_{constructor(){super(m_.NO_ADDRESS_ERROR,"The wallet does not have an account set up. Please make sure to set up your wallet and try again."),this.name="NoAddressBeaconError",this.title="No Address"}}class X_ extends j_{constructor(){super(m_.NO_PRIVATE_KEY_FOUND_ERROR,"The account you are trying to interact with is not available. Please make sure to add the account to your wallet and try again."),this.name="NoPrivateKeyBeaconError",this.title="Account Not Found"}}class Y_ extends j_{constructor(){super(m_.NOT_GRANTED_ERROR,"You do not have the necessary permissions to perform this action. Please initiate another permission request and give the necessary permissions."),this.name="NotGrantedBeaconError",this.title="Permission Not Granted"}}class J_ extends j_{constructor(){super(m_.PARAMETERS_INVALID_ERROR,"Some of the parameters you provided are invalid and the request could not be completed. Please check your inputs and try again."),this.name="ParametersInvalidBeaconError",this.title="Parameters Invalid"}}class Z_ extends j_{constructor(){super(m_.TOO_MANY_OPERATIONS,"The request contains too many transactions. Please include fewer operations and try again."),this.name="TooManyOperationsBeaconError",this.title="Too Many Operations"}}class Q_ extends j_{constructor(e){super(m_.TRANSACTION_INVALID_ERROR,"The transaction is invalid and the node did not accept it."),this.data=e,this.name="TransactionInvalidBeaconError",this.title="Transaction Invalid",this.data=e}get fullDescription(){return{description:this.description,data:JSON.stringify(this.data,void 0,2)}}}class $_ extends j_{constructor(){super(m_.UNKNOWN_ERROR,"An unknown error occured. Please try again or report it to a developer."),this.name="UnknownBeaconError",this.title="Error"}}var ew=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const tw=new F_("Transport");class nw{constructor(e,t,n){this.type=y_.POST_MESSAGE,this._isConnected=g_.NOT_CONNECTED,this.listeners=[],this.name=e,this.client=t,this.peerManager=n}get connectionStatus(){return this._isConnected}static isAvailable(){return ew(this,void 0,void 0,(function*(){return Promise.resolve(!1)}))}connect(){return ew(this,void 0,void 0,(function*(){tw.log("connect"),this._isConnected=g_.CONNECTED}))}disconnect(){return ew(this,void 0,void 0,(function*(){tw.log("disconnect"),this._isConnected=g_.NOT_CONNECTED}))}send(e,t){return ew(this,void 0,void 0,(function*(){if(t)return this.client.sendMessage(e,t);{const t=(yield this.getPeers()).map((t=>this.client.sendMessage(e,t)));return(yield Promise.all(t))[0]}}))}addListener(e){return ew(this,void 0,void 0,(function*(){tw.debug("addListener"),this.listeners.push(e)}))}removeListener(e){return ew(this,void 0,void 0,(function*(){tw.log("removeListener"),this.listeners=this.listeners.filter((t=>t!==e))}))}getPeers(){return ew(this,void 0,void 0,(function*(){return this.peerManager.getPeers()}))}addPeer(e,t=!0){return ew(this,void 0,void 0,(function*(){tw.log("addPeer","adding peer",e),yield this.peerManager.addPeer(e),yield this.listen(e.publicKey)}))}removePeer(e){return ew(this,void 0,void 0,(function*(){tw.log("removePeer","removing peer",e),yield this.peerManager.removePeer(e.publicKey),this.client&&(yield this.client.unsubscribeFromEncryptedMessage(e.publicKey))}))}removeAllPeers(){return ew(this,void 0,void 0,(function*(){tw.log("removeAllPeers"),yield this.peerManager.removeAllPeers(),this.client&&(yield this.client.unsubscribeFromEncryptedMessages())}))}notifyListeners(e,t){return ew(this,void 0,void 0,(function*(){0===this.listeners.length?tw.warn("notifyListeners","0 listeners notified!",this):tw.log("notifyListeners",`Notifying ${this.listeners.length} listeners`,this),this.listeners.forEach((n=>{n(e,t)}))}))}}var rw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class iw{constructor(e){this.prefix=e}static isSupported(){return rw(this,void 0,void 0,(function*(){return Promise.resolve(Boolean("undefined"!=typeof window)&&Boolean(window.localStorage))}))}get(e){return rw(this,void 0,void 0,(function*(){const t=localStorage.getItem(this.getPrefixedKey(e));if(!t)return"object"==typeof M_[e]?JSON.parse(JSON.stringify(M_[e])):M_[e];try{return JSON.parse(t)}catch(e){return t}}))}set(e,t){return rw(this,void 0,void 0,(function*(){return"string"==typeof t?localStorage.setItem(this.getPrefixedKey(e),t):localStorage.setItem(this.getPrefixedKey(e),JSON.stringify(t))}))}delete(e){return rw(this,void 0,void 0,(function*(){return Promise.resolve(localStorage.removeItem(this.getPrefixedKey(e)))}))}getPrefixedKey(e){return this.prefix?`${this.prefix}-${e}`:e}}new F_("STORAGE");var ow=n(8764).Buffer,sw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class aw{serialize(e){return sw(this,void 0,void 0,(function*(){const t=JSON.stringify(e);return Kv.encode(ow.from(t))}))}deserialize(e){return sw(this,void 0,void 0,(function*(){if("string"!=typeof e)throw new Error("Encoded payload needs to be a string");return JSON.parse(Kv.decode(e).toString())}))}}var lw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class cw{constructor(e){this.storageManager=new I_(e,v_.APP_METADATA_LIST)}getAppMetadataList(){return lw(this,void 0,void 0,(function*(){return this.storageManager.getAll()}))}getAppMetadata(e){return lw(this,void 0,void 0,(function*(){return this.storageManager.getOne((t=>t.senderId===e))}))}addAppMetadata(e){return lw(this,void 0,void 0,(function*(){return this.storageManager.addOne(e,(t=>t.senderId===e.senderId))}))}removeAppMetadata(e){return lw(this,void 0,void 0,(function*(){return this.storageManager.remove((t=>t.senderId===e))}))}removeAppMetadatas(e){return lw(this,void 0,void 0,(function*(){return this.storageManager.remove((t=>e.includes(t.senderId)))}))}removeAllAppMetadata(){return lw(this,void 0,void 0,(function*(){return this.storageManager.removeAll()}))}}class uw extends j_{constructor(){super(m_.ABORTED_ERROR,"The action was aborted by the user."),this.name="UnknownBeaconError",this.title="Aborted"}}var hw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class dw{constructor(e,t){this.storageManager=new I_(e,t)}hasPeer(e){return hw(this,void 0,void 0,(function*(){return!!(yield this.getPeer(e))}))}getPeers(){return hw(this,void 0,void 0,(function*(){return this.storageManager.getAll()}))}getPeer(e){return hw(this,void 0,void 0,(function*(){return this.storageManager.getOne((t=>t.publicKey===e))}))}addPeer(e){return hw(this,void 0,void 0,(function*(){return this.storageManager.addOne(e,(t=>t.publicKey===e.publicKey))}))}removePeer(e){return hw(this,void 0,void 0,(function*(){return this.storageManager.remove((t=>t.publicKey===e))}))}removePeers(e){return hw(this,void 0,void 0,(function*(){return this.storageManager.remove((t=>e.includes(t.publicKey)))}))}removeAllPeers(){return hw(this,void 0,void 0,(function*(){return this.storageManager.removeAll()}))}}var pw=n(4826),fw=n(8764).Buffer,mw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class gw{constructor(e){this.keyPair=e}getPublicKey(){return mw(this,void 0,void 0,(function*(){return n_(this.keyPair.publicKey)}))}getPublicKeyHash(){return mw(this,void 0,void 0,(function*(){return r_(this.keyPair.publicKey)}))}createCryptoBoxServer(e,t){return mw(this,void 0,void 0,(function*(){return(0,pw.serverSessionKeys)({publicKey:(0,Qv.SH)(t.publicKey),secretKey:(0,Qv.zh)(t.secretKey)},(0,Qv.SH)(fw.from(e,"hex")))}))}createCryptoBoxClient(e,t){return mw(this,void 0,void 0,(function*(){return(0,pw.clientSessionKeys)({publicKey:(0,Qv.SH)(t.publicKey),secretKey:(0,Qv.zh)(t.secretKey)},(0,Qv.SH)(fw.from(e,"hex")))}))}encryptMessageAsymmetric(e,t){return mw(this,void 0,void 0,(function*(){return function(e,t){return t_(this,void 0,void 0,(function*(){const n=(0,Qv.SH)(e_.from(t)),r=(0,Xv.generateKeyPair)(),i=new Zv.BLAKE2b(24).update(r.publicKey,32).update(n,32).digest(),o="string"==typeof e?(0,Jv.cv)(e):e,s=(0,Xv.box)(n,r.secretKey,i,o);return n_((0,$v.z)(r.publicKey,s))}))}(t,fw.from(e,"hex"))}))}}var yw=n(8764).Buffer,vw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class _w extends gw{constructor(e,t){super(t),this.name=e,this.init().catch(console.error)}start(){return vw(this,void 0,void 0,(function*(){yield Promise.resolve()}))}getPairingRequestInfo(){return vw(this,void 0,void 0,(function*(){return{id:yield S_(),type:"postmessage-pairing-request",name:this.name,version:"3",publicKey:yield this.getPublicKey()}}))}getPairingResponseInfo(e){return vw(this,void 0,void 0,(function*(){return{id:e.id,type:"postmessage-pairing-response",name:this.name,version:e.version,publicKey:yield this.getPublicKey()}}))}unsubscribeFromEncryptedMessage(e){return vw(this,void 0,void 0,(function*(){this.activeListeners.get(e)&&this.activeListeners.delete(e)}))}unsubscribeFromEncryptedMessages(){return vw(this,void 0,void 0,(function*(){this.activeListeners.clear()}))}decryptMessage(e,t){return vw(this,void 0,void 0,(function*(){const n=yield this.createCryptoBoxServer(e,this.keyPair),r=yw.from(t,"hex");if(r.length>=40)try{return yield s_(r,n.receive)}catch(e){}throw new Error("Could not decrypt message")}))}encryptMessage(e,t){return vw(this,void 0,void 0,(function*(){const n=yield this.createCryptoBoxClient(e,this.keyPair);return o_(t,n.send)}))}}class ww extends j_{constructor(){super(m_.SIGNATURE_TYPE_NOT_SUPPORTED,"The wallet is not able to sign payloads of this type."),this.name="SignatureTypeNotSupportedBeaconError",this.title="Signature Type Not Supported"}}var bw,xw=n(9669),Ew=n.n(xw);!function(e){e.TEXT="m.text"}(bw||(bw={}));class Sw{constructor(e,t,n,r){this.type=e,this.sender=t,this.content=n,this.timestamp=r}static from(e){if(Tw(e))return new Sw(e.content.msgtype,e.sender,e.content.body,e.origin_server_ts)}}const Mw=e=>"m.room.message"===e.type,Tw=e=>Mw(e)&&e.content instanceof Object&&"msgtype"in e.content&&e.content.msgtype===bw.TEXT;var Aw;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JOINED=1]="JOINED",e[e.INVITED=2]="INVITED",e[e.LEFT=3]="LEFT"}(Aw||(Aw={}));class Rw{constructor(e,t=Aw.UNKNOWN,n=[],r=[]){this.id=e,this.status=t,this.members=n,this.messages=r}static fromSync(e){var t,n,r;if(!e)return[];function i(e,t){return Object.entries(e).map((([e,n])=>t(e,n)))}return[...i(null!==(t=e.join)&&void 0!==t?t:{},Rw.fromJoined),...i(null!==(n=e.invite)&&void 0!==n?n:{},Rw.fromInvited),...i(null!==(r=e.leave)&&void 0!==r?r:{},Rw.fromLeft)]}static from(e,t){return"string"==typeof e?new Rw(e,t||Aw.UNKNOWN):void 0!==t?new Rw(e.id,t,e.members,e.messages):e}static merge(e,t){return t&&t.id===e.id?new Rw(e.id,e.status,[...t.members,...e.members].filter(((e,t,n)=>n.indexOf(e)===t)),[...t.messages,...e.messages]):Rw.from(e)}static fromJoined(e,t){const n=[...t.state.events,...t.timeline.events],r=Rw.getMembersFromEvents(n),i=Rw.getMessagesFromEvents(n);return new Rw(e,Aw.JOINED,r,i)}static fromInvited(e,t){const n=Rw.getMembersFromEvents(t.invite_state.events);return new Rw(e,Aw.INVITED,n)}static fromLeft(e,t){const n=[...t.state.events,...t.timeline.events],r=Rw.getMembersFromEvents(n),i=Rw.getMessagesFromEvents(n);return new Rw(e,Aw.LEFT,r,i)}static getMembersFromEvents(e){return Rw.getUniqueEvents(e.filter((e=>(e=>"m.room.create"===e.type&&e.content instanceof Object&&"creator"in e.content)(e)||(e=>"m.room.member"===e.type&&e.content instanceof Object&&"membership"in e.content&&"join"===e.content.membership)(e)))).map((e=>e.sender)).filter(((e,t,n)=>n.indexOf(e)===t))}static getMessagesFromEvents(e){return Rw.getUniqueEvents(e.filter(Mw)).map((e=>Sw.from(e))).filter(Boolean)}static getUniqueEvents(e){const t={},n=[];return e.forEach(((e,r)=>{const i=e.event_id;void 0!==i&&i in t||(void 0!==i&&(t[i]=r),n.push(e))})),n}}var Cw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Lw=["syncToken","rooms"];class Pw{constructor(e){this.storage=e,this.state={isRunning:!1,userId:void 0,deviceId:void 0,txnNo:0,accessToken:void 0,syncToken:void 0,pollingTimeout:void 0,pollingRetries:0,rooms:{}},this.onStateChangedListeners=new Map,this.waitReadyPromise=new Promise(((e,t)=>Cw(this,void 0,void 0,(function*(){try{yield this.initFromStorage(),e()}catch(e){t(e)}}))))}get(e){return this.state[e]}getRoom(e){const t=Rw.from(e,Aw.UNKNOWN);return this.state.rooms[t.id]||t}update(e){return Cw(this,void 0,void 0,(function*(){yield this.waitReady();const t=Object.assign({},this.state);this.setState(e),this.updateStorage(e),this.notifyListeners(t,this.state,e)}))}onStateChanged(e,...t){t.length>0?t.forEach((t=>{this.onStateChangedListeners.set(t,e)})):this.onStateChangedListeners.set("all",e)}waitReady(){return Cw(this,void 0,void 0,(function*(){return this.waitReadyPromise}))}initFromStorage(){return Cw(this,void 0,void 0,(function*(){const e=yield this.storage.get(v_.MATRIX_PRESERVED_STATE);this.setState(e)}))}prepareData(e){const t=["rooms"].some((t=>void 0!==e[t]))?JSON.parse(JSON.stringify(e)):e;return Object.values(t.rooms||{}).forEach((e=>{e.messages=[]})),t}updateStorage(e){if(Object.entries(e).filter((([e,t])=>Lw.includes(e)&&Boolean(t))).length>0){const e={};Lw.forEach((t=>{e[t]=this.state[t]})),this.storage.set(v_.MATRIX_PRESERVED_STATE,this.prepareData(e))}}setState(e){this.state={isRunning:e.isRunning||this.state.isRunning,userId:e.userId||this.state.userId,deviceId:e.deviceId||this.state.deviceId,txnNo:e.txnNo||this.state.txnNo,accessToken:e.accessToken||this.state.accessToken,syncToken:e.syncToken||this.state.syncToken,pollingTimeout:e.pollingTimeout||this.state.pollingTimeout,pollingRetries:e.pollingRetries||this.state.pollingRetries,rooms:this.mergeRooms(this.state.rooms,e.rooms)}}mergeRooms(e,t){if(!t)return e;const n=Array.isArray(t)?t:Object.values(t),r=Object.assign({},e);return n.forEach((t=>{r[t.id]=Rw.merge(t,e[t.id])})),r}notifyListeners(e,t,n){const r=this.onStateChangedListeners.get("all");r&&r(e,t,n),jv(n).filter((e=>void 0!==n[e])).forEach((r=>{const i=this.onStateChangedListeners.get(r);i&&i(e,t,n)}))}}var Iw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Ow=new F_("MatrixHttpClient");class Nw{constructor(e){this.baseUrl=e,this.cancelTokenSource=Ew().CancelToken.source()}get(e,t,n){return Iw(this,void 0,void 0,(function*(){return this.send("GET",e,n,t)}))}post(e,t,n,r){return Iw(this,void 0,void 0,(function*(){return this.send("POST",e,n,r,t)}))}put(e,t,n,r){return Iw(this,void 0,void 0,(function*(){return this.send("PUT",e,n,r,t)}))}cancelAllRequests(){return Iw(this,void 0,void 0,(function*(){return this.cancelTokenSource.cancel("Manually cancelled")}))}send(e,t,n,r,i){return Iw(this,void 0,void 0,(function*(){const o=n?this.getHeaders(n):void 0,s=r?this.getParams(r):void 0;let a;try{a=yield Ew().request({method:e,url:t,baseURL:this.apiUrl("/_matrix/client/r0"),headers:o,data:i,params:s,cancelToken:this.cancelTokenSource.token})}catch(e){const t=e;throw Ow.error("send",t.code,t.message,t.response.data),e.response.data}return a.data}))}getHeaders(e){const t={},n=[];if(e.accessToken&&n.push(["Authorization",`Bearer ${e.accessToken}`]),0!==n.length){for(const[e,r]of n)t[e]=r;return t}}getParams(e){if(!e)return;const t=Object.assign(e,{});return jv(t).forEach((e=>void 0===t[e]&&delete t[e])),t}apiUrl(...e){return[this.baseUrl.endsWith("/")?this.baseUrl.substr(0,this.baseUrl.length-1):this.baseUrl,...e.map((e=>e.startsWith("/")?e.substr(1):e))].join("/")}}var kw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class Dw{constructor(e){this.httpClient=e}createRoom(e,t={}){return kw(this,void 0,void 0,(function*(){return this.httpClient.post("/createRoom",t,{accessToken:e})}))}inviteToRoom(e,t,n){return kw(this,void 0,void 0,(function*(){return n.status!==Aw.JOINED&&n.status!==Aw.UNKNOWN?Promise.reject(`User is not a member of room ${n.id}.`):this.httpClient.post(`/rooms/${encodeURIComponent(n.id)}/invite`,{user_id:t},{accessToken:e})}))}joinRoom(e,t){return kw(this,void 0,void 0,(function*(){return t.status===Aw.JOINED?Promise.resolve({room_id:t.id}):this.httpClient.post(`/rooms/${encodeURIComponent(t.id)}/join`,{},{accessToken:e})}))}getJoinedRooms(e){return kw(this,void 0,void 0,(function*(){return this.httpClient.get("/joined_rooms",void 0,{accessToken:e})}))}}class Bw{constructor(e){this.httpClient=e}login(e,t,n){return r=this,i=void 0,s=function*(){return this.httpClient.post("/login",{type:"m.login.password",identifier:{type:"m.id.user",user:e},password:t,device_id:n})},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(s.next(e))}catch(e){t(e)}}function a(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,a)}l((s=s.apply(r,i||[])).next())}));var r,i,o,s}}var Uw,zw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class Fw{constructor(e){this.httpClient=e,this.cachedPromises=new Map}sync(e,t){return zw(this,void 0,void 0,(function*(){return this.withCache("sync",(()=>this.httpClient.get("/sync",{timeout:t?t.pollingTimeout:void 0,since:t?t.syncToken:void 0},{accessToken:e})))}))}sendMessage(e,t,n,r){return zw(this,void 0,void 0,(function*(){return new Promise(((i,o)=>this.scheduleEvent({accessToken:e,roomId:t,type:"m.room.message",content:n,txnId:r,onSuccess:i,onError:o})))}))}scheduleEvent(e){this.sendEvent(e)}sendEvent(e){return zw(this,void 0,void 0,(function*(){const{roomId:t,type:n,txnId:r,content:i,accessToken:o}=e;try{const s=yield this.httpClient.put(`/rooms/${encodeURIComponent(t)}/send/${n}/${encodeURIComponent(r)}`,i,{accessToken:o});e.onSuccess(s)}catch(t){e.onError(t)}}))}withCache(e,t){let n=this.cachedPromises.get(e);return n||(n=t().finally((()=>{this.cachedPromises.delete(e)})),this.cachedPromises.set(e,n)),n}}!function(e){e.INVITE="invite",e.MESSAGE="message"}(Uw||(Uw={}));class Hw extends class{constructor(){this.events={}}on(e,t){return"object"!=typeof this.events[e]&&(this.events[e]=[]),this.events[e].push(t),()=>this.removeListener(e,t)}removeListener(e,t){if("object"!=typeof this.events[e])return;if(!t)return void(this.events[e]=[]);const n=this.events[e].indexOf(t);n>-1&&this.events[e].splice(n,1)}removeAllListeners(){Object.keys(this.events).forEach((e=>this.events[e].splice(0,this.events[e].length)))}emit(e,...t){"object"==typeof this.events[e]&&[...this.events[e]].forEach((e=>e.apply(this,t)))}once(e,t){const n=this.on(e,((...e)=>{n(),t.apply(this,e)}));return n}}{constructor(){super(...arguments),this.eventEmitProviders=new Map([[Uw.INVITE,()=>[this.isInvite,this.emitInvite.bind(this)]],[Uw.MESSAGE,()=>[this.isMessage,this.emitMessage.bind(this)]]])}onStateChanged(e,t,n){for(const e of jv(Uw))this.emitIfEvent(Uw[e],n)}emitIfEvent(e,t){const n=this.eventEmitProviders.get(e);if(n){const[r,i]=n();r(t)&&i(e,t)}}emitClientEvent(e,t,n){this.emit(e,{type:e,content:t,timestamp:n})}isInvite(e){return!!e.rooms&&e.rooms.some((e=>e.status===Aw.INVITED))}emitInvite(e,t){t.rooms.filter((e=>e.status===Aw.INVITED)).map((e=>[e.id,e.members])).forEach((([t,n])=>{this.emitClientEvent(e,{roomId:t,members:n})}))}isMessage(e){return!!e.rooms&&e.rooms.some((e=>e.messages.length>0))}emitMessage(e,t){t.rooms.filter((e=>e.messages.length>0)).map((e=>e.messages.map((t=>[e.id,t,t.timestamp])))).reduce(((e,t)=>e.concat(t)),[]).forEach((([t,n,r])=>{this.emitClientEvent(e,{roomId:t,message:n},r)}))}}var Gw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Vw=new F_("MatrixClient");class jw{constructor(e,t,n,r,i,o){this.store=e,this.eventEmitter=t,this.userService=n,this.roomService=r,this.eventService=i,this.httpClient=o,this.isActive=!0,this._isReady=new qv,this.store.onStateChanged(((e,t,n)=>{this.eventEmitter.onStateChanged(e,t,n)}),"rooms")}static create(e){const t=new Pw(e.storage),n=new Hw,r=new Nw(e.baseUrl),i=new Bw(r),o=new Dw(r),s=new Fw(r);return new jw(t,n,i,o,s,r)}get joinedRooms(){return new Promise((e=>Gw(this,void 0,void 0,(function*(){yield this.isConnected(),e(Object.values(this.store.get("rooms")).filter((e=>e.status===Aw.JOINED)))}))))}get invitedRooms(){return new Promise((e=>Gw(this,void 0,void 0,(function*(){yield this.isConnected(),e(Object.values(this.store.get("rooms")).filter((e=>e.status===Aw.INVITED)))}))))}get leftRooms(){return new Promise((e=>Gw(this,void 0,void 0,(function*(){yield this.isConnected(),e(Object.values(this.store.get("rooms")).filter((e=>e.status===Aw.LEFT)))}))))}start(e){return Gw(this,void 0,void 0,(function*(){const t=yield this.userService.login(e.id,e.password,e.deviceId);yield this.store.update({accessToken:t.access_token});const n=new Promise(((e,t)=>Gw(this,void 0,void 0,(function*(){yield this.poll(0,(t=>Gw(this,void 0,void 0,(function*(){this.store.get("isRunning")||e(),yield this.store.update({isRunning:!0,syncToken:t.next_batch,pollingTimeout:3e4,pollingRetries:0,rooms:Rw.fromSync(t.rooms)})}))),(e=>Gw(this,void 0,void 0,(function*(){this.store.get("isRunning")||t(e),yield this.store.update({isRunning:!1,pollingRetries:this.store.get("pollingRetries")+1})}))))}))));return n.then((()=>{this._isReady.resolve()})).catch(console.error),n}))}isConnected(){return Gw(this,void 0,void 0,(function*(){return this._isReady.promise}))}stop(){return Gw(this,void 0,void 0,(function*(){return Vw.log("MATRIX CLIENT STOPPED"),this.isActive=!1,this._isReady=new qv,this.httpClient.cancelAllRequests()}))}subscribe(e,t){this.eventEmitter.on(e,t)}unsubscribe(e,t){t&&this.eventEmitter.removeListener(e,t)}unsubscribeAll(e){this.eventEmitter.removeListener(e)}getRoomById(e){return Gw(this,void 0,void 0,(function*(){return yield this.isConnected(),this.store.getRoom(e)}))}createTrustedPrivateRoom(...e){return Gw(this,void 0,void 0,(function*(){return yield this.isConnected(),this.requiresAuthorization("createRoom",(t=>Gw(this,void 0,void 0,(function*(){return(yield this.roomService.createRoom(t,{room_version:"5",invite:e,preset:"public_chat",is_direct:!0})).room_id}))))}))}inviteToRooms(e,...t){return Gw(this,void 0,void 0,(function*(){yield this.isConnected(),yield this.requiresAuthorization("invite",(n=>Promise.all(t.map((t=>{const r=this.store.getRoom(t);this.roomService.inviteToRoom(n,e,r).catch((e=>Vw.warn("inviteToRooms",e)))})))))}))}joinRooms(...e){return Gw(this,void 0,void 0,(function*(){yield this.isConnected(),yield this.requiresAuthorization("join",(t=>Promise.all(e.map((e=>{const n=this.store.getRoom(e);return this.roomService.joinRoom(t,n)})))))}))}sendTextMessage(e,t){return Gw(this,void 0,void 0,(function*(){yield this.isConnected(),yield this.requiresAuthorization("send",(n=>Gw(this,void 0,void 0,(function*(){const r=yield this.createTxnId();return this.eventService.sendMessage(n,e,{msgtype:"m.text",body:t},r)}))))}))}poll(e,t,n){return Gw(this,void 0,void 0,(function*(){const r=this.store,i=this.sync.bind(this),o=(s,a)=>Gw(this,void 0,void 0,(function*(){let l=0;try{const n=yield i();t(n)}catch(e){n(e),l=r.get("pollingRetries"),this.isActive&&Vw.log(`Retry syncing... ${l} retries so far`)}finally{this.isActive?setTimeout((()=>Gw(this,void 0,void 0,(function*(){yield o(s,a)}))),l>3?5e3+e:e):a(new Error("Syncing stopped manually."))}}));return new Promise(o)}))}sync(){return Gw(this,void 0,void 0,(function*(){return this.requiresAuthorization("sync",(e=>Gw(this,void 0,void 0,(function*(){return this.eventService.sync(e,{pollingTimeout:this.store.get("pollingTimeout"),syncToken:this.store.get("syncToken")})}))))}))}requiresAuthorization(e,t){return Gw(this,void 0,void 0,(function*(){const n=this.store.get("accessToken");return n?t(n):Promise.reject(`${e} requires authorization but no access token has been provided.`)}))}createTxnId(){return Gw(this,void 0,void 0,(function*(){const e=(new Date).getTime(),t=this.store.get("txnNo");return yield this.store.update({txnNo:t+1}),`m${e}.${t}`}))}}var Ww=n(8764).Buffer,qw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Kw=new F_("P2PCommunicationClient"),Xw=["beacon-node-1.diamond.papers.tech","beacon-node-1.sky.papers.tech","beacon-node-2.sky.papers.tech","beacon-node-1.hope.papers.tech","beacon-node-1.hope-2.papers.tech","beacon-node-1.hope-3.papers.tech","beacon-node-1.hope-4.papers.tech","beacon-node-1.hope-5.papers.tech"];class Yw extends gw{constructor(e,t,n,r,i,o,s){super(t),this.name=e,this.replicationCount=n,this.storage=r,this.iconUrl=o,this.appUrl=s,this.client=new qv,this.activeListeners=new Map,this.ignoredRooms=[],this.loginCounter=0,Kw.log("constructor","P2PCommunicationClient created");const a=i.length>0?i:Xw;this.ENABLED_RELAY_SERVERS=a}getPairingRequestInfo(){return qw(this,void 0,void 0,(function*(){const e={id:yield S_(),type:"p2p-pairing-request",name:this.name,version:"3",publicKey:yield this.getPublicKey(),relayServer:yield this.getRelayServer()};return this.iconUrl&&(e.icon=this.iconUrl),this.appUrl&&(e.appUrl=this.appUrl),e}))}getPairingResponseInfo(e){return qw(this,void 0,void 0,(function*(){const t={id:e.id,type:"p2p-pairing-response",name:this.name,version:e.version,publicKey:yield this.getPublicKey(),relayServer:yield this.getRelayServer()};return this.iconUrl&&(t.icon=this.iconUrl),this.appUrl&&(t.appUrl=this.appUrl),t}))}getRelayServer(){return qw(this,void 0,void 0,(function*(){if(this.relayServer)return this.relayServer.promise;this.relayServer=new qv;const e=yield this.storage.get(v_.MATRIX_SELECTED_NODE);if(e&&e.length>0)return this.relayServer.resolve(e),e;const t=[...this.ENABLED_RELAY_SERVERS];for(;t.length>0;){const e=Math.floor(Math.random()*t.length),n=t[e];try{return yield Ew().get(`https://${n}/_matrix/client/versions`),this.storage.set(v_.MATRIX_SELECTED_NODE,n).catch((e=>Kw.log(e))),this.relayServer.resolve(n),n}catch(r){Kw.log(`Ignoring server "${n}", trying another one...`),t.splice(e,1)}}throw this.relayServer.reject("No matrix server reachable!"),new Error("No matrix server reachable!")}))}tryJoinRooms(e,t=1){return qw(this,void 0,void 0,(function*(){try{yield(yield this.client.promise).joinRooms(e)}catch(n){t<=10&&"M_FORBIDDEN"===n.errcode?(Kw.log("Retrying to join...",n),setTimeout((()=>qw(this,void 0,void 0,(function*(){yield this.tryJoinRooms(e,t+1)}))),200)):Kw.log(`Failed to join after ${t} tries.`,n)}}))}start(){var e;return qw(this,void 0,void 0,(function*(){Kw.log("start","starting client"),Kw.log("start","connecting to server");const t=yield this.getRelayServer(),n=jw.create({baseUrl:`https://${t}`,storage:this.storage});this.initialListener=e=>qw(this,void 0,void 0,(function*(){this.initialEvent&&this.initialEvent.timestamp&&e&&e.timestamp?this.initialEvent.timestamp<e.timestamp&&(this.initialEvent=e):this.initialEvent=e})),n.subscribe(Uw.MESSAGE,this.initialListener),n.subscribe(Uw.INVITE,(e=>qw(this,void 0,void 0,(function*(){let t;1===e.content.members.length&&(t=e.content.members[0]),yield this.tryJoinRooms(e.content.roomId),t&&(yield this.updateRelayServer(t),yield this.updatePeerRoom(t,e.content.roomId))}))));const r=`login:${Math.floor(Date.now()/1e3/300)}`;Kw.log("start",`login ${r}, ${yield this.getPublicKeyHash()} on ${t}`);const i=(0,Zv.hash)((0,Jv.cv)(r),32),o=null!==(e=this.keyPair.secretKey)&&void 0!==e?e:this.keyPair.privateKey,s=(0,Qv.Xx)(o,i);try{yield n.start({id:yield this.getPublicKeyHash(),password:`ed:${n_(s)}:${yield this.getPublicKey()}`,deviceId:n_(this.keyPair.publicKey)})}catch(e){if(Kw.error("start","Could not log in, retrying"),yield this.reset(),this.loginCounter<=this.ENABLED_RELAY_SERVERS.length)return this.loginCounter++,void this.start();throw Kw.error("start","Tried to log in to every known beacon node, but no login was successful."),new Error("Could not connect to any beacon nodes. Try again later.")}Kw.log("start","login successful, client is ready"),this.client.resolve(n)}))}stop(){return qw(this,void 0,void 0,(function*(){Kw.log("stop","stopping client"),this.client.isResolved()&&(yield(yield this.client.promise).stop().catch((e=>Kw.error(e)))),yield this.reset()}))}reset(){return qw(this,void 0,void 0,(function*(){Kw.log("reset","resetting connection"),yield this.storage.delete(v_.MATRIX_PEER_ROOM_IDS).catch((e=>Kw.log(e))),yield this.storage.delete(v_.MATRIX_PRESERVED_STATE).catch((e=>Kw.log(e))),yield this.storage.delete(v_.MATRIX_SELECTED_NODE).catch((e=>Kw.log(e))),this.relayServer=void 0,this.client=new qv,this.initialEvent=void 0,this.initialListener=void 0}))}listenForEncryptedMessage(e,t){return qw(this,void 0,void 0,(function*(){if(this.activeListeners.has(e))return;Kw.log("listenForEncryptedMessage",`start listening for encrypted messages from publicKey ${e}`);const n=yield this.createCryptoBoxServer(e,this.keyPair),r=r=>qw(this,void 0,void 0,(function*(){if(this.isTextMessage(r.content)&&(yield this.isSender(r,e))){let i;yield this.updateRelayServer(r.content.message.sender),yield this.updatePeerRoom(r.content.message.sender,r.content.roomId);try{i=Ww.from(r.content.message.content,"hex")}catch(e){}if(i&&i.length>=40)try{const r=yield s_(i,n.receive);Kw.log("listenForEncryptedMessage",`received a message from ${e}`,r),t(r)}catch(e){}}}));this.activeListeners.set(e,r),(yield this.client.promise).subscribe(Uw.MESSAGE,r);const i=this.initialEvent;i&&i.timestamp&&(new Date).getTime()-i.timestamp<3e5?(Kw.log("listenForEncryptedMessage","Handling previous event"),yield r(i)):Kw.log("listenForEncryptedMessage","No previous event found");const o=this.initialListener;o&&(yield this.client.promise).unsubscribe(Uw.MESSAGE,o),this.initialListener=void 0,this.initialEvent=void 0}))}unsubscribeFromEncryptedMessage(e){return qw(this,void 0,void 0,(function*(){const t=this.activeListeners.get(e);t&&((yield this.client.promise).unsubscribe(Uw.MESSAGE,t),this.activeListeners.delete(e))}))}unsubscribeFromEncryptedMessages(){return qw(this,void 0,void 0,(function*(){(yield this.client.promise).unsubscribeAll(Uw.MESSAGE),this.activeListeners.clear()}))}sendMessage(e,t){return qw(this,void 0,void 0,(function*(){const n=yield this.createCryptoBoxClient(t.publicKey,this.keyPair),r=l_(yield r_(Ww.from(t.publicKey,"hex")),t.relayServer),i=yield this.getRelevantRoom(r);yield this.waitForJoin(i);const o=yield o_(e,n.send);Kw.log("sendMessage","sending encrypted message",t.publicKey,i,e),(yield this.client.promise).sendTextMessage(i,o).catch((e=>qw(this,void 0,void 0,(function*(){if("M_FORBIDDEN"===e.errcode){Kw.log("sendMessage","M_FORBIDDEN",i,e),yield this.deleteRoomIdFromRooms(i);const t=yield this.getRelevantRoom(r);Kw.log("sendMessage","Old room deleted, new room created",t),(yield this.client.promise).sendTextMessage(t,o).catch((e=>qw(this,void 0,void 0,(function*(){Kw.log("sendMessage","inner error",t,e)}))))}else Kw.log("sendMessage","unexpected error",e)}))))}))}updatePeerRoom(e,t){return qw(this,void 0,void 0,(function*(){Kw.log("updatePeerRoom",e,t);const n=e.split(":");if(n.length<2||!n[0].startsWith("@"))throw new Error("Invalid sender");const r=yield this.storage.get(v_.MATRIX_PEER_ROOM_IDS),i=r[e];i===t&&Kw.debug("updatePeerRoom","rooms are the same, not updating"),Kw.debug("updatePeerRoom","current room",i,"new room",t),i&&i[1]&&(Kw.log("updatePeerRoom",`adding room "${i[1]}" to ignored array`),this.ignoredRooms.push(i[1])),r[e]=t,yield this.storage.set(v_.MATRIX_PEER_ROOM_IDS,r)}))}deleteRoomIdFromRooms(e){return qw(this,void 0,void 0,(function*(){const t=yield this.storage.get(v_.MATRIX_PEER_ROOM_IDS),n=Object.entries(t).filter((t=>t[1]!==e)).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t[0]]:t[1]})),{});yield this.storage.set(v_.MATRIX_PEER_ROOM_IDS,n),this.ignoredRooms.push(e)}))}listenForChannelOpening(e){return qw(this,void 0,void 0,(function*(){Kw.debug("listenForChannelOpening"),(yield this.client.promise).subscribe(Uw.MESSAGE,(t=>qw(this,void 0,void 0,(function*(){if(this.isTextMessage(t.content)&&(yield this.isChannelOpenMessage(t.content))){Kw.log("listenForChannelOpening","channel opening received, trying to decrypt",JSON.stringify(t)),yield this.updateRelayServer(t.content.message.sender),yield this.updatePeerRoom(t.content.message.sender,t.content.roomId);const n=t.content.message.content.split(":"),r=Ww.from(n[n.length-1],"hex");if(r.length>=40)try{const t=JSON.parse(yield a_(r,this.keyPair.publicKey,this.keyPair.secretKey));Kw.log("listenForChannelOpening","channel opening received and decrypted",JSON.stringify(t)),e(Object.assign(Object.assign({},t),{senderId:yield U_(t.publicKey)}))}catch(e){}}}))))}))}waitForJoin(e,t=0){return qw(this,void 0,void 0,(function*(){const n=yield(yield this.client.promise).getRoomById(e);if(Kw.log("waitForJoin",`Currently ${n.members.length} members, we need at least 2`),!(n.members.length>=2||0===n.members.length)){if(t<=200)return Kw.log(`Waiting for join... Try: ${t}`),new Promise((n=>{setTimeout((()=>qw(this,void 0,void 0,(function*(){n(this.waitForJoin(e,t+1))}))),100*(t>50?10:1))}));throw new Error(`No one joined after ${t} tries.`)}}))}sendPairingResponse(e){return qw(this,void 0,void 0,(function*(){Kw.log("sendPairingResponse");const t=l_(yield r_(Ww.from(e.publicKey,"hex")),e.relayServer),n=yield(yield this.client.promise).createTrustedPrivateRoom(t);Kw.debug("sendPairingResponse",`Connecting to room "${n}"`),yield this.updatePeerRoom(t,n),yield this.waitForJoin(n),Kw.debug("sendPairingResponse","Successfully joined room.");const r=void 0===e.version?yield this.getPublicKey():JSON.stringify(yield this.getPairingResponseInfo(e));Kw.debug("sendPairingResponse","Sending pairing response",r);const i=yield this.encryptMessageAsymmetric(e.publicKey,r),o=["@channel-open",t,i].join(":");(yield this.client.promise).sendTextMessage(n,o).catch((e=>qw(this,void 0,void 0,(function*(){if("M_FORBIDDEN"===e.errcode){Kw.log("sendPairingResponse","M_FORBIDDEN",n,e),yield this.deleteRoomIdFromRooms(n);const r=yield this.getRelevantRoom(t);Kw.log("sendPairingResponse","Old room deleted, new room created",r),(yield this.client.promise).sendTextMessage(r,o).catch((e=>qw(this,void 0,void 0,(function*(){Kw.log("sendPairingResponse","inner error",r,e)}))))}else Kw.log("sendPairingResponse","unexpected error",e)}))))}))}isTextMessage(e){return e.message.type===bw.TEXT}updateRelayServer(e){return qw(this,void 0,void 0,(function*(){Kw.log("updateRelayServer",e);const t=e.split(":");if(t.length<2||!t[0].startsWith("@"))throw new Error("Invalid sender");const n=t.shift(),r=t.join(":"),i=localStorage.getItem("beacon:communication-peers-dapp")?new dw(this.storage,v_.TRANSPORT_P2P_PEERS_DAPP):new dw(this.storage,v_.TRANSPORT_P2P_PEERS_WALLET),o=(yield i.getPeers()).map((e=>qw(this,void 0,void 0,(function*(){`@${yield r_(Ww.from(e.publicKey,"hex"))}`===n&&e.relayServer!==r&&(e.relayServer=r,yield i.addPeer(e))}))));yield Promise.all(o)}))}isChannelOpenMessage(e){return qw(this,void 0,void 0,(function*(){return e.message.content.startsWith(`@channel-open:@${yield r_(Ww.from(yield this.getPublicKey(),"hex"))}`)}))}isSender(e,t){return qw(this,void 0,void 0,(function*(){return e.content.message.sender.startsWith(`@${yield r_(Ww.from(t,"hex"))}`)}))}getRelevantRoom(e){return qw(this,void 0,void 0,(function*(){const t=yield this.storage.get(v_.MATRIX_PEER_ROOM_IDS);let n=t[e];if(!n){Kw.log("getRelevantRoom",`No room found for peer ${e}, checking joined ones.`);const r=yield this.getRelevantJoinedRoom(e);n=r.id,t[e]=r.id,yield this.storage.set(v_.MATRIX_PEER_ROOM_IDS,t)}return Kw.log("getRelevantRoom",`Using room ${n}`),n}))}getRelevantJoinedRoom(e){return qw(this,void 0,void 0,(function*(){const t=yield(yield this.client.promise).joinedRooms;Kw.log("checking joined rooms",t,e);const n=t.filter((e=>!this.ignoredRooms.some((t=>e.id===t)))).filter((t=>t.members.some((t=>t===e))));let r;if(0===n.length||this.ignoredRooms.length>0){Kw.log("getRelevantJoinedRoom","no relevant rooms found, creating new one");const t=yield(yield this.client.promise).createTrustedPrivateRoom(e);r=yield(yield this.client.promise).getRoomById(t),Kw.log("getRelevantJoinedRoom",`waiting for other party to join room: ${r.id}`),yield this.waitForJoin(t),Kw.log("getRelevantJoinedRoom",`new room created and peer invited: ${r.id}`)}else r=n[0],Kw.log("getRelevantJoinedRoom",`channel already open, reusing room ${r.id}`);return r}))}}var Jw=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Zw=new F_("P2PTransport");class Qw extends nw{constructor(e,t,n,r,i,o,s){super(e,new Yw(e,t,1,n,r,o,s),new dw(n,i)),this.type=y_.P2P}static isAvailable(){return Jw(this,void 0,void 0,(function*(){return Promise.resolve(!0)}))}connect(){const e=Object.create(null,{connect:{get:()=>super.connect}});return Jw(this,void 0,void 0,(function*(){if(this._isConnected!==g_.NOT_CONNECTED)return;Zw.log("connect"),this._isConnected=g_.CONNECTING,yield this.client.start();const t=yield this.getPeers();if(t.length>0){Zw.log("connect",`connecting to ${t.length} peers`);const e=t.map((e=>Jw(this,void 0,void 0,(function*(){return this.listen(e.publicKey)}))));Promise.all(e).catch((e=>Zw.error("connect",e)))}return yield this.startOpenChannelListener(),e.connect.call(this)}))}disconnect(){const e=Object.create(null,{disconnect:{get:()=>super.disconnect}});return Jw(this,void 0,void 0,(function*(){return yield this.client.stop(),e.disconnect.call(this)}))}startOpenChannelListener(){return Jw(this,void 0,void 0,(function*(){}))}getPairingRequestInfo(){return Jw(this,void 0,void 0,(function*(){return this.client.getPairingRequestInfo()}))}listen(e){return Jw(this,void 0,void 0,(function*(){yield this.client.listenForEncryptedMessage(e,(t=>{const n={origin:p_.P2P,id:e};this.notifyListeners(t,n).catch((e=>{throw e}))})).catch((e=>{throw e}))}))}}var $w=n(8764).Buffer,eb=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class tb extends _w{constructor(){super(...arguments),this.activeListeners=new Map}init(){return eb(this,void 0,void 0,(function*(){this.subscribeToMessages().catch(console.error)}))}listenForEncryptedMessage(e,t){return eb(this,void 0,void 0,(function*(){this.activeListeners.has(e)||this.activeListeners.set(e,((n,r)=>eb(this,void 0,void 0,(function*(){try{const i=yield this.decryptMessage(e,n.encryptedPayload);t(i,r)}catch(e){}}))))}))}sendMessage(e,t){var n;return eb(this,void 0,void 0,(function*(){const r=yield this.encryptMessage(t.publicKey,e),i=null===(n=t)||void 0===n?void 0:n.extensionId,o={target:f_.EXTENSION,encryptedPayload:r,targetId:i};C_.postMessage(o,C_.location.origin)}))}listenForChannelOpening(e){return eb(this,void 0,void 0,(function*(){C_.addEventListener("message",(t=>eb(this,void 0,void 0,(function*(){var n,r;if(t.source!==C_||t.origin!==C_.location.origin)return;const i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.message;if(i&&i.target===f_.PAGE&&(yield this.isChannelOpenMessage(i))){const n=$w.from(i.payload,"hex");if(n.length>=40)try{const i=JSON.parse(yield a_(n,this.keyPair.publicKey,this.keyPair.secretKey));e(Object.assign(Object.assign({},i),{senderId:yield U_(i.publicKey),extensionId:null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.sender.id}))}catch(e){}}}))))}))}sendPairingRequest(e){return eb(this,void 0,void 0,(function*(){const t={target:f_.EXTENSION,payload:yield(new aw).serialize(yield this.getPairingRequestInfo()),targetId:e};C_.postMessage(t,C_.location.origin)}))}isChannelOpenMessage(e){return eb(this,void 0,void 0,(function*(){return"object"==typeof e&&e.hasOwnProperty("payload")}))}subscribeToMessages(){return eb(this,void 0,void 0,(function*(){C_.addEventListener("message",(e=>{if(e.source===C_&&e.origin===C_.location.origin&&"object"==typeof e&&e){const t=e.data;t.message&&t.message.target===f_.PAGE&&this.activeListeners.forEach((e=>{e(t.message,{origin:p_.EXTENSION,id:t.sender.id||""})}))}}))}))}}var nb=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const rb=new F_("PostMessageTransport");let ib,ob,sb=!1;class ab extends nw{constructor(e,t,n,r){super(e,new tb(e,t),new dw(n,r)),this.type=y_.POST_MESSAGE}static isAvailable(){return nb(this,void 0,void 0,(function*(){return new Promise((e=>{const t=n=>{const r=n.data;r&&"pong"===r.payload&&(e(!0),C_.removeEventListener("message",t))};C_.addEventListener("message",t);const n={target:f_.EXTENSION,payload:"ping"};C_.postMessage(n,C_.location.origin)}))}))}static getAvailableExtensions(){return nb(this,void 0,void 0,(function*(){return ib||ob||(ob=[],ib=new Promise((e=>{ab.listenForExtensions(),setTimeout((()=>{e(null!=ob?ob:[])}),1e3)})).finally((()=>{ib=void 0})),ib)}))}static listenForExtensions(){if(sb)return;C_.addEventListener("message",(e=>{if(e.source!==C_||e.origin!==C_.location.origin)return;const t=e.data,n=t.sender;var r;t&&"pong"===t.payload&&n&&(rb.log("getAvailableExtensions",`extension "${n.name}" is available`,n),r=n,ob||(ob=[]),ob.some((e=>e.id===r.id))||(ob.push(r),C_.postMessage("extensionsUpdated",C_.location.origin)))}));const e={target:f_.EXTENSION,payload:"ping"};C_.postMessage(e,C_.location.origin),sb=!0}connect(){const e=Object.create(null,{connect:{get:()=>super.connect}});return nb(this,void 0,void 0,(function*(){if(rb.log("connect"),this._isConnected!==g_.NOT_CONNECTED)return;this._isConnected=g_.CONNECTING;const t=yield this.getPeers();if(t.length>0){rb.log("connect",`connecting to ${t.length} peers`);const e=t.map((e=>nb(this,void 0,void 0,(function*(){return this.listen(e.publicKey)}))));Promise.all(e).catch((e=>rb.error("connect",e)))}yield this.startOpenChannelListener(),yield e.connect.call(this)}))}startOpenChannelListener(){return nb(this,void 0,void 0,(function*(){}))}getPairingRequestInfo(){return nb(this,void 0,void 0,(function*(){return this.client.getPairingRequestInfo()}))}listen(e){return nb(this,void 0,void 0,(function*(){rb.log("listen",e),yield this.client.listenForEncryptedMessage(e,((e,t)=>{const n={origin:p_.EXTENSION,id:t.id};this.notifyListeners(e,n).catch((e=>{throw e}))})).catch((e=>{throw e}))}))}}const lb=":host {\n  --animation-duration: 300ms;\n  all: initial;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes fadeOut {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n\n.animated {\n  animation-duration: var(--animation-duration);\n  animation-fill-mode: both;\n}\n\n.fadeIn {\n  animation-name: fadeIn;\n}\n\n.fadeOut {\n  animation-name: fadeOut;\n}\n\n.beacon-modal__wrapper {\n  position: relative;\n  top: 0;\n  display: inline-block;\n  z-index: 2147483000;\n  max-width: 500px;\n  width: 80%;\n  padding: 24px;\n}\n\n@media (min-height: 700px) {\n  .beacon-modal__wrapper {\n    top: 50%;\n    transform: translateY(-50%);\n  }\n}\n\n.theme__light .beacon-modal__base,\n.theme__light .beacon-modal__close__wrapper {\n  background: #fff;\n}\n\n.theme__dark .beacon-modal__base,\n.theme__dark .beacon-modal__close__wrapper {\n  background: #27334c;\n}\n\n.beacon-modal__base,\n.beacon-modal__close__wrapper {\n  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.1);\n}\n\n.beacon-modal__base {\n  margin: 0 auto;\n  border-radius: 32px;\n  overflow: hidden;\n}\n\n.beacon-modal__header {\n  padding: 16px 0;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.beacon-modal__headerLogo {\n  width: 100%;\n  max-width: 320px;\n  margin: 20px auto;\n  height: 100%;\n}\n\na,\nbutton {\n  cursor: pointer;\n}\n\n.beacon-modal__close__wrapper {\n  position: absolute;\n  top: 44px;\n  right: 24px;\n  z-index: 10000;\n  cursor: pointer;\n  border-radius: 100%;\n}\n\n.beacon-modal__close__icon {\n  width: 16px;\n  height: 16px;\n  position: relative;\n  top: 0;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transform: rotate(45deg);\n  margin: 8px;\n}\n\n.beacon-modal__close__line1 {\n  position: absolute;\n  width: 90%;\n}\n\n.beacon-modal__close__line2 {\n  position: absolute;\n  width: 90%;\n  transform: rotate(90deg);\n}\n\n.theme__light .beacon-modal__close__line2,\n.theme__light .beacon-modal__close__line1 {\n  border: 1px solid #000;\n}\n\n.theme__dark .beacon-modal__close__line2,\n.theme__dark .beacon-modal__close__line1 {\n  border: 1px solid #fff;\n}\n\n.beacon-alert__base {\n  position: fixed;\n  overflow-y: scroll;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 2147482999;\n  background-color: rgb(17 17 17 / 0.84);\n  text-align: center;\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n  font-family: Roboto, Helvetica, sans-serif;\n}\n\n.beacon-alert__base::-webkit-scrollbar {\n  display: none;\n}\n\n.beacon-alert__title {\n  text-align: center;\n}\n\n.beacon-alert__text,\n.beacon-alert__title {\n  margin: 0 auto;\n  padding: 0 0 24px;\n}\n\n.margin__bottom {\n  margin-bottom: 16px;\n}\n\n.beacon-alert__title {\n  font-size: 18px;\n}\n\n.theme__light .beacon-alert__title {\n  color: #3b3d40;\n}\n\n.theme__dark .beacon-alert__title,\n.theme__dark .beacon-alert__text {\n  color: #7c99d6;\n}\n\n.beacon-alert__text {\n  color: #000;\n  font-size: 14px;\n}\n\n.beacon-modal__button,\n.beacon-modal__button--outline {\n  height: 36px;\n  font-size: 14px;\n  letter-spacing: 0.84px;\n  margin-bottom: 4px;\n  margin-inline-end: 2px;\n  margin-inline-start: 2px;\n  margin-left: 2px;\n  margin-right: 2px;\n  margin-top: 4px;\n  padding-inline-end: 15.4px;\n  padding-inline-start: 15.4px;\n  padding-left: 15.4px;\n  padding-right: 15.4px;\n  overflow-wrap: break-word;\n  pointer-events: auto;\n  text-align: center;\n  border-radius: 4px;\n  border: 2px solid #3880ff;\n}\n\n.beacon-modal__button {\n  background: #3880ff;\n  color: #fff;\n}\n\n.beacon-modal__button--outline {\n  background: #fff;\n  color: #444444;\n  border: 1px solid #444444;\n}\n\n.beacon-alert__image {\n  width: 200px;\n  height: 200px;\n  box-sizing: border-box;\n  box-shadow: 0 10px 20px 0 rgba(17, 17, 17, 0.12);\n  border: 1px solid rgba(17, 17, 17, 0.04);\n  border-radius: 16px;\n}\n.connect__btn {\n  margin: 24px 0;\n  width: 100%;\n}\n\n#beacon-modal__content {\n  padding: 24px;\n}\n\n#beacon-switch {\n  margin-top: 24px;\n}\n\n#beacon-title {\n  margin: 0 0 24px;\n}\n\na {\n  text-decoration: none;\n}\n\npre {\n  white-space: pre-wrap; /* css-3 */\n  white-space: -moz-pre-wrap; /* Mozilla, since 1999 */\n  white-space: -pre-wrap; /* Opera 4-6 */\n  white-space: -o-pre-wrap; /* Opera 7 */\n  word-wrap: break-word; /* Internet Explorer 5.5+ */\n  padding: 16px;\n  background: #ececec;\n  line-height: 1.25rem;\n}\n",cb="#beacon-main-text {\n  display: initial;\n}\n.beacon-selection__container {\n  padding: 16px 16px 0;\n}\n.beacon-selection__list {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  text-decoration: none;\n  padding-bottom: 12px;\n  align-items: center;\n}\n.beacon-list__title {\n  text-align: left;\n  font-size: 12px;\n}\n.beacon-list__wrapper:nth-child(-n + 3) {\n  padding: 0 0 1rem;\n}\n.theme__light .beacon-list__title {\n  color: #7c828b;\n}\n.theme__dark .beacon-list__title,\n.theme__dark #beacon--disclaimer {\n  color: #7c99d6;\n}\n\n.beacon-selection__name {\n  font-size: 1rem;\n  font-weight: 600;\n  text-align: left;\n}\n.theme__light .beacon-selection__name,\n.theme__light .beacon--selection__name__lg {\n  color: #3b3d40;\n}\n.theme__dark .beacon-selection__name,\n.theme__dark .beacon--selection__name__lg {\n  color: #6183ff;\n}\n.beacon-selection__img {\n  width: 48px;\n  height: 48px;\n  box-shadow: 0 4px 12px 0 rgba(17, 17, 17, 0.24);\n  border-radius: 16px;\n  background-color: #fff;\n}\n.beacon--selection__name__lg {\n  font-size: 1.5rem;\n  font-weight: 600;\n  text-align: center;\n  padding: 1rem 0;\n}\n.beacon--selected__container {\n  padding: 2rem 0 0;\n}\n#beacon--qr__copy__container {\n  height: 0;\n}\n#beacon--qr__copy {\n  display: none;\n  position: relative;\n  margin-top: auto;\n  margin-left: auto;\n  margin-right: auto;\n}\n#beacon--qr__container {\n  margin-left: auto;\n  margin-right: auto;\n}\n#beacon--qr__container:hover #beacon--qr__copy {\n  display: block;\n}\n\n.disabled p {\n  text-align: left;\n  margin: 0;\n  font-size: 10px;\n  font-weight: 300;\n  opacity: 0.48;\n}\n\n#beacon--disclaimer {\n  text-align: left;\n  padding-top: 24px;\n  font-size: 0.875rem;\n}\n.progress-line,\n.progress-line:before {\n  height: 3px;\n  width: -webkit-fill-available;\n  margin-left: -24px;\n  margin-right: -24px;\n}\n.progress-line {\n  background-color: #a7c4f7;\n  display: -webkit-flex;\n  display: flex;\n}\n.progress-line:before {\n  background-color: #3880ff;\n  content: '';\n  -webkit-animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n  animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n}\n@-webkit-keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n@keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n",ub=(e,t)=>t.test(e.navigator.userAgent),hb=e=>((e,t)=>e.matchMedia("(any-pointer:coarse)").matches)(e),db=e=>ub(e,/iPhone|iPod/i)||(e=>!!ub(e,/iPad/i)||!(!ub(e,/Macintosh/i)||!hb(e)))(e),pb=e=>ub(e,/android|sink/i);var fb=n(6192);const mb=new F_("QR"),gb=(e,t)=>`${e}?type=tzip10&data=${t}`;var yb=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let vb=[{key:"galleon_desktop",name:"Galleon",shortName:"Galleon",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAN6ElEQVR4Ad3BC3SW9X3A8e/v/7yX3IAQCLdwhyCKGlARRBRorbdZaWu1lx27Xlydp+txW1vtXLs2nh0723o6e13VdhU7dahzFdGCchOEAAICohAScg/kfnnzXvI+z/P/7U0lPVlGIIE31O3zEYaZqoI2OerlTLfqzzJGJnmJ7rxAOJiFVZP0bTJkJKJOoEGUanGkFMdvhxGICMNNSDNVhY62IBnBpSpcD+5SVRagZINyRiIKUilGSnDZJMZ5lYycWhFhOAhpoloBfv6Vat0vqdXbUB1DOohYEXbiOE+JJJ/GjO0QEdJFOEdquyQRdz8WDsj9av1FDCeRTjHBXx1vbPnhpIJd9SJ3cK6Es6SqqI0tU899BOtfzvkkEhcn9KgY7yFxciOcA+EsWK87Dxv7kfr2TkD4UxFTK478tQRG/U5EOBvCEKgqfjK2QrR7FaqT+YAQE3wiltR7c0aMijFEDoOkWoF6oW/gJ54EcvkgUXtZKCC3fLf4W+uKH3yonSFwGAS11vG73V9i7TcBwweR6gTr+5/+bvHfbC5+8JF6BsnhDDQRDagXexrkc3zACeSgwU8X33//tuLvPVzNIDichlrfqO3+jar/Gf7vCKsjnywu/vbrxQ8+VM8ZOAxAVfGT7Q+j/j0MM5vsRpwAaRS2vr+y+MFvvVD84PfaOQ3DAGyy689F9RsMIzfSRndLA1UvPkW6CYy3rn0x2R3P4jQMp6Be9wVY95cMM7ezDT/RRe3a1cSO15B26hcFSD6qqgzE0I/aSMB6sadAszlPrO9R/uSPGQ5qvbvUi6xkAIZ+1NevonYh51nr/t207HmT4aC+9zP14yM4BUMf6sfHqe99hz+R8qd+hnoeaadaoL77gOpq+jOcpKokE7EHUB3FeeDFuvBiXfQVb6in9vfPMxzUevdGI9dNoh/DSWqTEwKOfJnzpOLZx/DicfqrfvEp3K5O0k41MyvD+bqq0pehl9/1V6hmch50lr1L/WsvcSpeLErVC79hOKj1v4StG0UfhhS10YBauYvzQK1P6eM/BFUGUv/6SySajpN2qiPVjvgsfRhS1Pc+jGoB50Ht2tVEq49xOup5VD73a4aD+v6dqkovo6rg2ds4DxJNJ6h6/jcMRuO214nVVZN2yiKiHZM5ydDUKCp6M+fB0V//CD/ZzWCoKlX/+STpp0aN3sRJhrwRc1AKGGZNJZtofXsnQ9G0YyPxEzWknWNWqCo9jNrkYlCGkxfrouzJnzBUqkrNmv8g3VTtYminhwEpYphVPPsYyfZWzkbD1nW4kQ7SS6fjB3JJMVh7AcOo8+gh6l9fw9myrsuJTWtJK1VRnzmkGIWpDBP1fUof/yGoci6Ob3wZVEknC1NJMaDjGSY1Lz9DtKaCcxVvqKf93X2kk7H+eFIMMJJhEG+oo+qFVaTL8U1rSSdfdQQpBtUQw+DoE49g3STp0rxrK148Sro4jgmRYgBLmjW88Xva3tlLOlk3SVPJJtJGxJJiEBMjjdxIO+VP/Zzh0LjtddLFT7oxUgxoK2lUvupnuF2dDIf29/aT7GglHZxQqJUUA1LHIFlrUQbWdmA3Ddte438TQAABBBAQ+hAGRZWW3dtIB1XqSQkI5phil3AG1lruL/457ZEY//T3dzE+P4/+wmPGMf87P+Z/EFKEPxAQThIwoRA9ir79I1BlMMKjx3LuBEHKSQlgvEP4nFYy6fL14l+wbssuetz02fv4yuc/zp133EAoGKCXk5FFtPYYg9Xd2kCPcN54BkVh5OyLOGdCVIKRSlICSOgtSDKQxuZ27v2HR9l76Ci9ovEE3//FM6x6fh1f/PTNfPKjy8jOyiQ0egxNJZtpKtnCcJj9hXsxwSBDYa3ltS17eOfdMv72nk9hjCFlHzLBJyUgSd2pjrioBuln85v7eOCfH6elrZNTOdHUykM/+S3/8thzXL98ITcsX8hVf/lNUEvTzq2k0+zP30vB9R9nMKxV9h8qY/2W3bz82nYaW9rpUd/QwsP/eA/BYHibiNAjQDQRkVGh7ar+Mk5qaGrl+z99hpc37GAwYt3d/Ne6bfxu3TYcY5hXOJWrE1nMz4iRDi9E80luOMYFFauZUjCO/DG55ORk4WDw1CcSidLY0k5VbQOHj1ax/1AZXfEE/b28sYSW9ghfu/v29ZwkpNhE+9+p+o80NrXx62de4ZkXXyfhuvQwIiiKtSACRgQFVJXTcUS5e0wr8zPjnItn23PZGMmhPxFSBFRRhkJa4k2HJ9ZVH3NJCZCy6ulnV+8+WPf998pqnDmzp3PNVQvooVZRAd9TMsLg++C6EAg6gI+Ig7VKIGA4VlVHWUUNyvt8FX7Zksfn89qYGkpyNkrcsTiXXc0NpIhQXllLWUUNiKBKijJUin2+rvqYy0kBepi5tT4n1o8ckXPTpq07sYAqgyICapUZUydx3bLFiCrGMRyrqqO0vIpfteQhDJ1y0pad/IEqs2ZM5vrlV4EqIhBLJDlaXkV9YzOO46CqnEnCDf4bfQgnTbtk5U3BUPIV0kGVGVMLuGDWNKwq8USCnXvfIel6pI0qmeEQhbOmM3H8GHzf8j5FRFCrBEMhPN9HfZduV/HV7nzj1R2LKys300s4KTD/MpnmjNsryHzOgghY35I/ZjSTC8YzJncUoVCIZLKb7KxsFl5xCQcOHKa5rR0siAHHOPjWJxwOknQ9GpvbqKiqIxKNImI4WyKCquK7HggEwyFCJkA4y3xiz8YXX6QPoY+pl3/01hDe7xgEVSU/L5eLLyok6Bh6iDE0t7RRU3eC5tZOPM8lEAzSQ1XpTwQEwfU8Ao7D+Pw8ZkwrYGRODmotCBw6coza442ICOfG7Kn0Wei9vVbpI0AfsUT1S8HgxI3iyIc4BccYFi6Yx6gR2YDQ3NLG9p37SHo+p+IEAqgqA1EFRXEcBwVONLVyoqmVXgJ87o5b6IrGiMYSHK2opryiBkQYIk3GE1/z3t2g9CP0M6Xo2gvDgex9QJgeqswtnMGMKZPwrWXX3ndoj3QhAoKgpKiipN81VxbR1NbJ4aMVqCqFM6cyZ8YURAxbS/bSGY0xGKr+qvLwlL9gx6/oT+jv9tuZVRa7LxDg4aWLFpCdmUEymcQ4BmsVARQLOCjvM6KoVUSEHj5wtKySmvoGEGGoFLhpxVW8d7SSqtrj9DU2L5eii+bQnXQZNSKbg++VU11/nIEI1HZ1ZRcdP/J8K6cgnMLd93zFXLH42nVHSyuv64onKK+qpbyiBjEGVeVMHCMUzpzOtMnjQZWE67HzrYMkkknOJOA4rLxxGZve3ENrewd9BRyHlTcu5/mXNyACqHLpRYVcueASXt24jboTTfTj+9Z+pGLfuk0MQBjAvKU35yei/i4xZjrnKBwKseSKS8nMCHO4rJJj1XWcSu7IHK67djFr1m2h23XpS4DbbrmONes20+169LrmyiKq6hoZm5dLwYSxbN25j/bOLnq4ycR9Eqn4QWVlJQMRTmPCrI9cnJMbeAMYTTqoMrdwJrOnFVBaUU3psWp6zZ09nakFE1i/pYT+FFh54wq2vLmTjkiMXpdfOpdorJvDZRX0EOCaxZeRGQ6xedvbj3eM9b5c+8oaTsfhNLrajjVOnFH4hu9zBxAmRQRUwXoWtRaL4DgGYRBEaG5tp7SimrGjc7l64Xyam9tZumgB8XiCHXsO0J8RuO3mFWx+8y06IlF6zb+oEAEOHi6nr6ra4zQ2Na1+4tEHvvjIfd9QzkAYhE996atXjcoZvTZgzGirihEwThAERC1J1wUMxoAxhtb2CAcOHSHpeigDK5iQzyf+7MOsWr2GjkiU/jJCIT56wzJe3bCNrlicXpfOLSQUNLx18Aj9+RL87fjM6BdKtm7wGARhkBbfcvvFTfWda0TMdE5DVckbNZKii+cQCgYQMZRVVFNWWYuI0CM7K4PlS66gsamV3fsPAUJ/UyaO4/KiC1mzfiu+tfS6/JILAGXPwVL6s+r+oK3KfrOtZaNlkIQhmHHhsnwysp52DNcxWKoUzpzKzOlTCAUcfN+SSCTZsmMPvlr6U4VrFy3A8z127DlIX1cvLKKto4t3S8vpJxpL2rtDGa3/Xrl7N0MhDFHBkmtNOJH5dSPmQSDMIMyYMomL5syksyvKm7vexqpyKuPGjmbpwgVs27WPxpY2eglw04eXcuhIOVW1x+lL0d3GDd159MBLRzgLwtm4/XYmVMcvzEqYn5qA+yFOIRQMsGRhEVkZGVTU1PFeaQWIcCrhYJAVS6+kIxJh++4DiPBHeaNGsGLpItZv3k4kGuOPNNDRnbTFMXPiJy0H9nicJeEc5M6YQzB/zq0jfa9YkPkoFM0rZNL4fJKux/bd+4l3dzOQjFCIa6+6DBQ273iLpOvxR6osvryIzIwQm7a/RR/xOP5j3SbwUPPuVxo5R0IaBJYslWmJSTd+8uZFX92xd//19Q1NDgNRZea0ycydPZ3uZJI3Svbheh59TRw3lsWXXULJ3gMcb2zhfVLneYEnWqIj/jWyIHmC554jHYR0Gnkr4yc0TM4MmDska9StjsoSgaAIzJs7m4IJ+QhCeVUtpeVVIEJf2VkZLF+ykKamVnbtP0RKXbdNvOIkEi90BXI2NB98zSPNhGGSPXEiubnTRnzuMx9bNH3yxCtWPbN2XkNL50zEFACjQTMBA7jhcCiy8sblDR0dsepX168/4pnAft/rLIn62aXthzcr/1/kXng15OQzadZCcifPkbyCQpORP5fr77qLd8rKgHmcb/8N3VaULP16cD8AAAAASUVORK5CYII=",deepLink:"galleon://"},{key:"umami_desktop",name:"Umami",shortName:"Umami",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAANSklEQVR4Ae3BC1RVZaLA8f+39z4HgQXiJBmgLWpEHRXFQhHMiJGsMTR5zJjL8Iosb2KOaRpZ4gulScXedWOIAequtGmC1mAjjSmWYyRpoGiTiEp6xgxWJ5QAOY/9XbhLW3DcoFQ+6/fjF7/4eRN0k5TSExgLhAD9AA+urCbgOFAB7BBCNNINgoskpQwBFgFxgDtXp2agAMgUQlRwEQQXIKXsCawHkgClsrKSwsJCSktLqampobGxESklV4IQAk9PTwIDAwkPDyc2Npbg4GBa6UAusFAIcYouCLogpRwIFAFBu3fvJjU1lZKSEtooioKfnx9eXl4IIbgSpJQ0NDTw1Vdfoes6baKioli7di2hoaG0OgRMFEIcpBOCTkgpBwIfSin7rFq1ivT0dHRdJyYmhuTkZKKiovD29uZqcPr0aUpKSsjJyWHTpk0oisKyZctYunQpQoivgTuFEFUYEBiQUvYEPpVSBs2aNYucnByCgoLIy8sjIiKCq9nHH3/MjBkzOHToEMnJyWRnZyOEOASMFEKcwoWCsfVA0KpVq8jJyWHMmDGUlZURERHB1S4iIoKysjLGjBlDTk4Oq1atolUQsB4DCi6klCFA0u7du0lPTycoKIhNmzbh4+PDtcLHx4dNmzYRFBREeno6u3fvplWSlDIEFxrnWwQoqamp6LpOXl4ePj4+uNKrPkP/9J/Ib2tR+g9Hvfe/kKe/wfF6BkhJByYz6p1xKIPDwHYGe/YS0HXOIxSUXwejjn8QVA2kxP7nJ8F2BkNCIHrdiDJyPMqA22jPx8eHvLw87rjjDlJTU9m2bZsCLAIepB2NdqSUnkBcZWUlJSUlTJw4kYiICDqwncH+0qM4PyrkHOfWtxCBQ1AG3Y785iv08u24cn6wEXP6X1EGhyF6B+DYsA4jzg/A+VEBpvkvIfrcjHbfTOx56ei7P6BTbz+POnYypj8+C+YenBMREUFMTAxFRUVUVlYSHBwcJ6X0FEI0cpZCR2MB98LCQtokJyfjyrE5D+dHhXQgdeyvPAYOO6Y5mQjPnpzHYcP+9Ezkfw6jTXkUbfJsOqP/+1Na5v8Wx9+zEH63YE57A/O6f6COmQSaCSPOHe9if3EBrpKTk2lTWFhIK3dgLO0odBRCq9LSUhRFISoqClfqyPFgMuNKHvsCx4ZMhG8A2py1GJGnrdhWPICsPY42Yzna7+fTqeZGHH9ZQcu8u3DueBfl18MwPZaFW045ptlrUEKjwcOL9pw73kWv+oz2oqKiUBSF0tJSzgqhHY2O+tGqpqYGPz8/vL296cBhR/jfinZ/Co6/PY8rR+HLKCGRqGMmIf/9KY5Nr+FK1lmwpcVjXvkW2rTHEb39sWcvAYcdI/I/h7GvT8Hxv39CvScRNTIe9d7pqPdOB92JtFSjWw4h6yxw2oowmWnP29sbPz8/jh49yln9aEejIw9aNTY24uXlhStHfjrq5Dlof5iP8+Mi5IkjdKDr2J+ZgzmzGC1pObrlEHrFh7iStcexPXE/piX5qPckIvoNwL4+BfnNV3RGfn0Mx+sZON74E8qAESghd6EMDkPcOgT15oF0xcvLi8bGRs7yoB0FA1JKhBC4kk3fYc9aDOYemOY9B4qKK/ltLfanZ4LDjjk1G+XWoRiR9XXYlsThLHkbZXAY5ue2ot5xPxckdfSDe3C8tR7b8j/QkjiElsQh2B4dj23lVPQDn+BKCIGUEiMK3aSX/RNnydsog0ai/f4RjOiHKrA/MwfcPDAt34DoNwBDtjPYn5+H/cUFCM2EadGrmNNeR/jdQnfIBiv6kUr08u04S/5Kdyj8APbsJciTNWhTHkUJHoMR565i7C8vRHj/CvOqvyECB9MZ59aNtDzyW/TPtqGE3o3bi9sx/fdTiBv86DYp6Q6FH6KpAXvmbHA6MC16FeHbFyPObW9hf2khwvtXuGUUoAwJpzOy9ji29GnYn5qBPPkl6oQk3LI+wTT/RZRBoVwqCj+QXr0X+6tPIHr2xrwkHzy8MOLcuhF7ZgqYe2BesRE1eipdcZa9T8u8KOzPzkVaqlHvSsD8dBFur+xEe/AJlEEjQdXonKA7NDqh6zrnUVTac27dgOgXhDY5BfPjr2FbnQh2G66cHxch67/G9HgOprnPoAy8HXt2GtjOYEh34vzwHZwfvoMyZDRq9FTUsN+hJcyDhHnQ3IheXYF+ZD/ScghZZ0HW10HjacTNA3Gl6zqd0ehEfX09rsSNfXHleH01orc/6h33Y1r4P9jXPQROB670z8uwLfodptQ/o949DeU3o7A/90f06r10RT/wCfqBT7CbUlGGjUEdEYUyZDTK4NEowWO4GPX19ZhMJoxodKK2tpa6ujp8fX05R42IwbEhE3Qn39N17M/NQ3h4oY6eAItexb4+BRx2XMk6C7YnJqM9+DjapNmY17yHY1M2jo3rofk7umRvQd+zDX3PNv6fmztKv4EI/1sRvv7Q0xfR60bUsZNpr66ujtraWgICAjCi0AkpJcXFxbQnAvqjTU7hPA4btqdnopeXoIbfh/nJfOjhgSGHDUfeKmxpsciTR9Hun43by/9CvXsaqBoXraUZvboC50cFON55CcdfliOPHsBVcXExUko6o9CFrKwsXGmJT6JNfQxMbnRga8H21Aycpf9AuS0K8+oChG8AndE/L6Nl/jgcbzyFcPfE9HAmbi99hBo9FUxmusXkhjb1MbTEJ3GVlZVFVzS6sHPnTgoKCoiLi+N7QqBNeRT13uno5R8iv/0akHzvzHe0UfoPx+3lf+Hc/QGy9hhISWf0w/tQhkYg/G7BNPcZtAefQN+1GdnUQNcEoteNKCPuQvTsjauCggJ27txJVzQuYPbs2dx2220EBgbSnujZG/WueLpk7oEaEUN3CR9f1Hum82PU1NQwe/ZsLkThAurq6oiOjqa6upprRXV1NdHR0dTV1XFOjx49MKJwEQ4fPszIkSPJzc1F13WuVrquk5uby6hRozh8+DDtBQQEYETjItXX1zNz5kzWrFlDUlIS48aNY8CAAXh5eSGE4EqQUtLQ0EBVVRVbt24lNzeXgwcPYuT222/HiEY3HTx4kMWLF3O5nDhxAqvVytChQ/kxYmJiMKLwMzBo0CAiIyMxovAzsHr1ahRFwYjCdW7KlCnEx8fz+eefY0ThOjZ69GhycnI4deoUKSkpGNG4Tt13331s2LABk8lEfHw8R44cwYjGdcbX15f09HQeeughmpqaiI+P5/3336d///4Y0bgO3HDDDYwePZrY2FgeeOABPD09qaioIDExkf3799Omb9++GNG4AqKjo0lJSSEkJAR3d3e60qdPH3x9fTlx4gRGPD098fb25pyqqioyMzPJzc3F4XBwTmhoKEY0LiMhBC+88AJz586lzZdffonVaqUrVquVzkgpsVgsWCwWysvL2bJlC7t27UJKiauJEydiROMyWrBgAXPnzmXPnj0kJSVRWVnJ5TB06FDGjh2LEY3LxN3dnbS0NE6ePMn48eOxWq1cLhkZGQghMKJwmYSFhdGrVy9yc3OxWq34+/uzb98+9u3bh7+/P5dKYmIikyZNYu/evRhRuEz69OlDm5qaGtpER0cTHBxMcHAw0dHRXAqRkZFkZWVhtVqZM2cORjQuE4vFQptBgwbRpqioiM2bN9OmqKiIn1pCQgL5+fkIIUhISODYsWMY0TAghOCnVlZWxsmTJ0lKSuLZZ5/l+PHjTJgwgZ9aQEAAGRkZTJ8+nYaGBhISEigpKaFfv34Y0eioiVaenp781Ox2O4sXLyYvL4/t27fz8MMPs2XLFpxOJz+GEIK+ffsSFhZGXFwccXFxuLm5sWvXLqZPn05VVRVtPDw8OKuJdjQ6Ok6rwMBAvvjiC35q+fn53HTTTWRkZLB582ZaWlpobm7mx/Dw8MBsNnPOvn37WLduHW+++Sa6rnNOYGAgZ1loR6OjClqFh4dTXFzMpbBmzRree+89Zs2axYgRI3B3d6crw4cPx+FwcODAAVxJKWlubsZisVBeXs6WLVvYu3cvRsLDwzmrgnY0OtoBNMfGxrovX76cS2X//v088sgjXIwTJ05gtVoZOXIkP0ZsbCytmoEdtKPQjhCiESgIDg4mKiqK60VkZCTDhg2j1btCiO9oR+F8mYC+du1aVFXlWqeqKmvXrqWVBDJxoeBCCFEB5IaGhrJs2TKudWlpaYwaNYpW+UKIz3ChYGwhcGjp0qUkJydzrUpKSmLZsmW0OgwswICCASHEKWCiEOLr7OxsVq5ciaqqXCtUVWX58uW89tprKIpSC8QIIeoxoNKJlStXfrNixYoiIcQ9kZGRN0yYMIHq6mpqamq4nBYuXEhzczOvvPIKFyMyMpKNGzcybdo0hBCHgfFCiC/ohOACpJQ9gfVAEqBUVlZSWFhIaWkpR48epampCSkll8qePXuor69n3LhxuBJC4OHhQWBgIOHh4cTGxjJs2DBaSSAfWCCEqKcLgoskpRwBLAJiAXeuTs3Au0CmEOIzLoKgm6SUnsCdwHCgH+DBldUEWIAKYIcQ4jt+8YtfXKz/A/OhBgM5KLZoAAAAAElFTkSuQmCC",deepLink:"umami://"}],_b=[{key:"spire_chrome",id:"gpfndedineagiepkpinficbcbbgjoenn",name:"Spire",shortName:"Spire",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAIIElEQVR4Ae3Ba5BeZWEA4Oc9u9kkJGHZkIQkLhQziQmVBpJwOTDg7saKEIQwnYq2/WWnUjuxHTOOgbYq77ZqSVGrtZliae2P/gE74zQIodoZEmwrR6pQlTYJ0DWNuWAChBBIyN7exsGZL2e/3Xy3Xf3RPI+zzvr/LfgFyGMKCMPHX/JT7eec75RUxJD8nAVTKI/JKe1YjquxEsuwCHOPH/phm9ER5yy8fAQv4yCeww/wHezGcBGDqRJMgTymaejD+3AjFhvHC09+SRodtijfaAIH8CgexI4ihiGTLJhEeUzn4Q58CG9Vw7MP/po0OmL5b2xVhx/hPny5iOGoSRJMgjymmfgwNmGeOowOnfD0F5eQRq36yIBs2ix1OoR7saWI4YQWBS3IYwrowxasMLGEo3gK/4UfDXz9d+ce+t79HydZsPp3PrPk1vtfxBK8HatxLoKJ7cQGbC9i0KygSXlM0/EpbESbagl78QAewneLGAZVbMTnvWkT7vUzeUwduBK34b24CEG1YXwOdxcxnNSEoAl5TAvwAPpUS3gS9+CRIoYh43sYN3vTNtxsHHlMHViHu3AVgmqP4f1FDIc1KGhQHtMSPIIVqu3GXXioiGHUxGZhAAu86UUswTETyGPKsB6bsUy1nXhPEcOABgQNyGNagn/BEmXD+BI+WcTwmtquxJPKrsUTashjmo0/we+jXdkA3lXEMKBOQZ3ymBbgcaxQdgQfKGLYqn6bsFnZH+HP1CmP6TZ8BV3KdqKniOGwOrSpQx7TdGzFFcr24sYihsc15hNYqmwU/6BO+3b07+rujd/EOnSqmI813b3xwX07+kfUkKkhjyngU+hVthfvLmL4vsbMwRrVrkCnBhQxPI0b8GNla9Gfx6SWTG192KjsCG4tYtilcZdinmpdWKlBRQy7sB5HlH0UfWrInEEe00xsQZuKYXygiOH7mvOrJtarCUUMT+O3MayiHVvymGY6g8yZfRgrlP1lEcNWzesxsT5NKmL4J2xRdgk2OIPMBPKYunCnst24W/POxWoTW43zNO8TeF7Zx/KYOk0gM7EP4nwVCXcVMbymeavQZWKdWKVJRQzHsAlJxQLcYQKZceQxTcPvKfs2HtKatWrr1ZqteFLZh/KY2o0jM761uFhFwr1FDKNa06O2Pi0oYhjFPUgqlqDXODJj5DE55XZl/4ttWtOFy9V2OeZqzTbsVXa7cWSqteNGZQ8UMQxpzRXoVNscrNGCIoZB/KOydXlMbcbIVFuOxSoSvq51PerXo3VbkVS8BcuNkal2jbKj+K7WBPSq31oErfkPvKrsamNkql2q7HtFDINaMxeXqd9KnK8FRQwn8bSylcbIVFum7L+17irMVr9ZuFLrnlG21BiZ0+QxBSxWNqB1PRrXq3V7lC3OYwpOkykL6FJ2WGsCejVuLYLWHFI2F8FpMtVmKntda+Zjpca9HfO1ZlBZZozM1LsaMzVuJq42xTLVTiibpTU9mterNR3KRo2RKUs4omy+5mVYq3l9yDRvgbKXkZwmc5oihoQDypZo3gW4RPMuwQWad7GyA0UMyWky1Z5T9sual2OG5s1ArnmXKnveGJlqzyhbk8fUoTl9WterCXlM07FK2Q+Mkan2hLJOXKFxbejVuj60adyVOFfZd4yRqbYbB1QE3KJxC7Fc65ZjocatR1CxH7uNkak2jH9W9v48pmkacy06tK4D12pAHlMH3qtsWxHDiDEyYxQxOOWryn4J6zTmnSZPn8bcjIuUfdU4MuN7DHtUBHwsjylTnzZcb/L0oE0d8pgy3ImgYgA7jCMzjiKGIfy1smtxq/osxttMnrdhsfqsx1XK7itiGDaOzMTux0sqAu7JY5qttneg3eRpx3VqyGOagz9HUHEIf2MCmQkUMRzBZmXL0a+2PpNvrdr+FEuV3VvEcNQEMmf2V9il7A/ymNabWDuuM/muR7sJ5DHdhg3KdmKLM8icQRHDCWzAiIp2/H0e02XGdyGWmnxL0W0ceUyr8BW0qxjGhiKGE84gU9t2/IWyLjyUx7RCtR60mXxtuM4YeUwrsBVdyj6H7WrI1FDEkPBxbFd2Eb6Rx3SZsl5T551Ok8e0Ct/Ehcoew91FDGppU4d9O/pHunvjo7gF81R04n3dvXH3vh39uzANmzHX1JiN+zCax3QbvoYLlO3Ee4oYXlWHNnXat6P/9e7e+ChuQZeKmfj17t7YdeTZh38ydOzgnQimxnmzFq/52pqPHrgTn8UsZQO4qYhhvzq1acC+Hf1Hunvjw3g35qnIcI00+puvPPvIDFMnXNjX/1uzFq3pQaZsJ24qYhjQgEyDihgG0IPtxji299/mmGKv7nl8jmqPoaeIYUCDMk0oYjiEm/BZjDgljQw6tvffTbVjP/62NDLoZ4axGeuKGA5rQqZJRQwnsQk3YNcbL/+Pk6/sMdVOvrLHyVf2OGUnbsBdRQwnNSmYBHlMM/d/69Mb9//rZzaNDh3vNIWy9hlHu3s+uXnx9X/4hSKGE1oUTKKLb/ri/ENP/d2GwVf33zF84qVFJlH7jK4XOjq7vyylLccPPXPYJAmmwII1H+x44+Xn140Onbj9jRd33zj8xpEuTWibcd6R6Z0XfaN9ZteDM+Yu23boqb8dNMmCKfSWd/yx0eGT04ZeO3j56wefytPwyV8ZOv7israO2RekkcFFieCUQAptHQdHBl/7ybRz5j0X2qf/cNai1cW02Qv/M2ufMbT/W582VYJfgEXXfCQMHXshS2nET4XQZtqchaMHn/hCctZZZ/08/R8wPGmSSU1PIgAAAABJRU5ErkJggg==",link:"https://spirewallet.com/"},{key:"temple_chrome",id:"ookjlbkiijinhpmnjffcofjonbfbgaoc",name:"Temple Wallet",shortName:"Temple",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAGbElEQVR4Ae3B32/ddR3H8efr/f1+z2m7dT1n3Vp+De22EsxmxARvCNDGhBvDj3/AaxdMJEpIUAOJxl8IXJnFGyNX3i3BiEG9ELIqZNSLmRBYYD+7CS3tuv5Y23N6es7n87Zd2uULxAXDt2cmnseDjo6Ojo6Ojo6Ojo7/S6Jgje/sGdTdu1+2ewZvwwQSMsAEJjCBBCYwwAQSMoEJDDCBBCYwgQmJN3XLH79JwUSBGt/dO4jzmqrlQ/bQEJhAQgaYwAQmkMAEBphAQiYwgQEmkMAEJjAhsYxU1eArLQpkFKTx5MAg0mskOuTLTVgLFErsBO6lYEZRTN8i0SESgQmfq1M4MUrBUoqS6E2xTgIBc6twWy8bfLkJszWukfgUgZMj1okN6iujQ3vYNAI8R4FSCiLTCaQGoozA51cRmxotwvFLEBxChOAQHYJDiHhwCA7RIUQIDsEBRweqZF/qBxPr7vfLj6Xa+4cWBUkpSOkXU/W1Z28fRzwIgloTmgFKKezuJnn4IAiQQIDENQIkJECsEwgQ+L+WCK9fxCeX0Z29rNsJ3Au8RUFSipTYGOJBNkj4QgMNpEjAQA+YwAQSmMAAE0jIBCYwwAQS2ttD+NM5/PQc3NnLNWIUeIuCGEVKdJxEkBgkgoUGn8uuMvSWiKeukDNCgYwiJTpBYg0SQSL8aoP/RnhtApyPSY98leTRg+Tc71ceSymIUaDSDy/WSTROIkgMVlvQinwW8Z3LhGPv49Mr5OmWHejOXeTsBN1LQYyimY0pMZQIJYKlBp+FBnaAwE/P8xmMUpCUginVceBZJAiR8Oo5MKHUIDVIDUoJ9pUBdFeVLRroQdUu4pk5bHQfG/zSVcKJD1EpgVICpQSVzCmnH1CQlKKZTiA1CLEcT07jy2uQJZAaZAalBB2s4HN1RJU83bUbPzMPDgioduFTy1BOoZxAOXVKdiR78tzvKIhRsOyJM3VCHI/jU/jCKh9jQkN9qDuDpTVYDeTZcBVfWsOnV9ig3hKqdLHJcT+SPXnuNxQoZRuEv33wbVbW9pEZeTZcfZSe7HFCxB18ro56etmi4d0g8LPz6NadbEge+uJL4ZWzx3DmSj+Y+AcFS9kGXS+vvgu8C5G8tRcH52jFx3Fng8/W0R29bNFAD6p0Ec8sYA/sY4P27aqUfj75F7aJ0U7BTxLiVYJDK+IzK3yShqv4uXlyRuLkw8Y2Mdqo9PSFFi1/g1aE4LDYgFqLPBuu4str+MwKm/qBw2wTo91CHCM4tCK0HJ9ZIU8HqyDhZxfIGWWbGO3WiscJEYJDiPjUCnna240qZeK5eXJG2CZGu0U/SStepRUhOD65xCfpYBU/v8B10oh/9IixDYw2K/1ssuXB3/AQ8VbE51dhpUmeHajgy018psamfuAw28C4GVpxjOAQIgTHJ5fI04EqkvDzC+SMsg1SbgL1ZL32tVtAYoN2d5OnPd2oUsbPL8B9t7NpBPgVBTParPG9vU95rfmMbutFBypouAr93XyMQPsrxAsL5Iz49KNGwYw2ajw1+BSpvUBm+EyNG9GBCiw38cs1rhH9wGEKZrTJ2vdv/bIye0FZgjLDZ2vciPZXQODnF7hOjFIwo11SO02W1MkMsgTmV7kR9XejvjJ+YZGcEQpmtEnppx82yOwEpQQyw+stWAvciPZXiBOL4GwZ8cuPGQVKaadSMob4OhJEJ/z+DHSlKDPoLZE8cAd0p2zRUAXeuQyzNRjsYV0/cBh4m4IYbaTMjitLkMBPzRLfu4KfmiVOLEK9hV+pk6ehPpCIE4vkjFIgo51SGwfq8Z/T+GKDa7pTbKgP3PGZGnnq70Z9ZfzCIteJEQqU0EY/+fNceOb2cNpn66+T6FUSe9UO7XkQKBMc1gI2XAUJJJDwj1bwS4sk990BEkgDP3r67hd//Pz7TgFS2qz80uIxctbu4RFC/Abu+HyAWgt2ZmzRUB/x1Cx+pY729rCuH3QYeJsCGDdbM4zRjNCM0Az41DJ5+kIfSPjEIjmjFCTlZmvG47iDA9EJf72ITk5DapAIMoNEhPEpfLoGBkg9FCTlZmvFkx79Ku67fHIZ5huQGaSGMoMdGSTCP1omzNbAdBT4JQUxbrLSc1MtmuENv7QEM3U+pRGgGdl0FHiifPSKU5CU/wE+ufI8l2t/JzH+I2eW6L8t/3rO6ejo6Ojo6Ojo6Ojo+Jz+DTK0Yr9D+W0JAAAAAElFTkSuQmCC",link:"https://templewallet.com/"}],wb=[{key:"kukai_web",name:"Kukai Wallet",shortName:"Kukai",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAHNklEQVR4Ae3BbWyUhQEA4Ofevg0f7d0RsAllEJSpQVy1K3SQIQro2HRoVIymS/Zj6w8xfk6NWzRzoJkO48d0MUaTZv6yMRFNxM2EIX4wIthSUJERgrCmjHZWCXdXapsWbgk/iLbvlXuPsgHjeZx11ln/1xJiaGjMV+NazMU0lDs1DKADm7GmuSnRqUgJRWhozF+AR7EMoVPbIFbjoeamxOeOI+E4Ghrzy/EMxjq99OGe5qbEi0ZQZgQNjfk/4HGETj8hltbUrRi3fevKdQooU0BDY345Hnf6u6ymbkXX9q0rt4gQiNDQmL8Azzhz/LGhMf9dEQLRHsVYZ46x+L0IgSEaGvPVWObMs6yhMV9tiNBw1yJ0EiQSVJ1D9WQmTmDsGEf19XPgIJ1ddH9JPu9kCHEtXvINoeHmGkXl5cyppb6Oiy8iWWlE2Rw7dtLSRus2BgaMprl4yTeEhptmFIwfz9VXsWQxyUpFSyWZV8+8enI9rF3P2+vo7TUaphkiNFy5IowZwyWzSCbZ287edsdcMZ+Gm0glnZBkJcuu40eLeOU1PtjomPOmM+Ncsjk+/Yy+fsUoN0SoBOfP4L7bSacds6mFtev56Y+ZXWtUpZIs/wX13+cva/nJlfxgtmMyGZ56nt17xBaKacwY7ruddNq3zKtnXr2TanYts2sNk05z3+3c8yD9/WIJxXTJLNJpJ+RQL51dZHOOSiWpnkzFeCVLp7lkFi1bxRKKadw4Jen+inc30NrGvv0iTZ3CnDoWLaBqktjGjRNbKKb2DrH0HOLV13lvA4ePGNG+/ezbz5q/snABt9xIZYWitXeILRBTewd/36QoO3fxwMO88z6Hjyja4SO88z4PPMzOXYqycTPtHWILlODFP/PxdiPa8jGPPc3BjJIdzPDY02z52Ii2fcoLTUoSKMHhw3T8S0E7d/HsCwwOOmGDgzz7Ajt3KWjffo4cUZJACcrLWThfpJ5DPPcig4NGzeAgz71IzyGRLv8h5eVKEijBnFoqK0V69XUOZhQlnSKVVJSDGV59XaRUkjm1ShIqQX2dSN1f8d4GI0qnuGEp8+pJJR2VzbGphTfeIpNV0HsbuO4aqiYZpr6OD1vEFogpkeB7s0R6dwOHjyjo/BmsWsmSxaSSjkklWbKYVSs5f4aCDh/h3Q0iXXwRiYTYAjFVnUNlhUitbQpKp7j/TlJJBaWS3H8n6ZSCWttESlZSdY7YAjFVTxbpUC/79ivohqWkko4rleSGpQrat59DvSJVTxZbIKaJE0Tq7DKiefWKNq/eiDq7RJo4QWyBmMaOESmbU1AqSSqpaKkkqaSCsjmRxo4RW+C/IJFwygrE1NcvUiqpoEyWbE7RsjmyOQWlkiL19YstENOBgyJVTzaiTS2KtqnFiKoni3TgoNgCMXV2iVQxnqlTFPTGW2Rzjiub4423FDR1ChXjRersElsgpu4v6Tkk0pw6BWWyPPknsjkFZbI8+ScyWQXNqRMp10P3l2ILxJTPs32HSIsWUBYoaPcefv071q4nm3NMNsfa9fxmBbv3KKgsYNECkT77B/m82EIlaGljXr1hqiaxcAHvvK+gTJaXX+HlV0glHZXNKcrCBVRNEqmlTUkCJWjdRk+PSLfcyIS0omRzZHOKMiHNLTeKlM3Ruk1JAiUYGOC9jSJVVnDXrYShUROG3HUrlRUifbCRgQElCZSgLGDqFAXNvJC7byMMnbAw5O7bmHmhgqZ+hyBQkkAJljdSW2NEsy/lwXuZkFayCWkevJfZlxpRbQ23NSpJIKbp05g/V1FmXsgTj3DlFZQFilYWcOUVPPEIMy9UlPlzmT5NbKGYpk8TS2UFjT/numt4dwOtbezbL9LUKcypY9ECqiaJbfo02jvEEorp66+VpGoSN1/PzddzqJfOLrI5R6WSVE+mYrwT8vXXYgvF9MkOMhnSaSWrGM/5M4yqTIZPdogtEFN/P089TybjWz7awiNPsGWbk2bLNh55go+2+JZMhqeep79fbKES7N7Drx6k5mJSSfb8k73tjtq5i8vn87ObSCWNimyOV17jg42O2rmL86Yz41yyOT79jL5+JQkNN6AIff20tIn0wUZat3L1VSxZTLJSSXI9rF3P2+vo7fUte9vZ2y6uAUOEhuswCnp7Wf0mb77NnFrq65g1k1TSiLI5duykpY3WbQwMGE0dhggNtxm/NEoGBviwhQ9bSCSoOofqyUycwNgxjurr58BBOrvo/pJ83smy2RCh4dbgeYRGWT7PF9180e1/YRBrDBEYorkp0YnVzjyrm5sSnYYIRPst+pw5+vCQCGUibN+68kBN3YqvsNSZ4Y7mpsTfRChTwPatK1tr6laMw2VOb6uamxKrFFBmBNu3rlxXU7fi37gKodNLH+5obkqsMoKEIjQ05i/Ao1iG0KltEKvxUHNT4nPHkRBDQ2O+GtdiLqah3KlhAB3YjDXNTYlOZ5111llF+A8aUDCF69BprwAAAABJRU5ErkJggg==",links:{mainnet:"https://wallet.kukai.app",ghostnet:"https://ghostnet.kukai.app",mondaynet:"https://dailynet.kukai.app",delphinet:"https://testnet.kukai.app",edonet:"https://edonet.kukai.app",florencenet:"https://florencenet.kukai.app",granadanet:"https://granadanet.kukai.app",hangzhounet:"https://hangzhounet.kukai.app",ithacanet:"https://ithacanet.kukai.app",jakartanet:"https://jakartanet.kukai.app",kathmandunet:"https://kathmandunet.kukai.app"}}],bb=[{key:"airgap_ios",name:"AirGap Wallet",shortName:"AirGap",color:"rgb(4, 235, 204)",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAALT0lEQVR4AeXBCXiU9Z3A8e/vfd+5kskBARYIkAsCSIRyRe5AKbhQ8CqWemGpVnF1qVKPrdoSrSiW6qq0lhZXu7UrskVQSq0VpAIGwxGgHAE5RBMIgUAyk8xkMjOZ+e/zZh9cauXNTMjx7MPnI0qpRkC4PCkDEEDj8hTVuMxpXOY02om3xsfix1/jlumP4qmu48saAiHumv1TFj/2Kp7qOtqLQRsLhxp549U/8x8vvY2vth7TkUNljBwziAsdO3KCnUWl7Cwq5U+rP+KO+ddx8x3TsNtttCWDNhKNRPnjW5tZ9twqTp88xxcUIMKXiQZKKUQEf12AlxatYOVr73PPgzcyY9Z4NE2jLeiFhYULAaGVNDZGWLdqM4/8y0usXbkJf12A84J9u1Je+M/MnjSCPrqdC3Xt1okrhmRz5FA5NWdrMfnrAnz4l538Ze3HJKUkkNOvF5qm0YqUQSs5frSCdX/YxDsrN1F91ssXFARzu1L5/dFUT87FyoRvDGP85KGsX1fM8hfXcPRgGSLC58dO8eP5L/PiohVc952JzLxxAr0zu9MaDFpIKcXBfcfZvH4XG9/bzpHSMkSELyjwj8rgzK0j8YzNBEVMRISpM0czZcYoPtq4h9d/vY4dRQcQEc6eruGVF9ew/IXVDLwyi0nTRjLhG8Ppf0UGCC1iEKNoNMqxwyfYs/0TSj4uZXvRAWrO1SIimEQEUyTZSc2MQZyd9TUCmZ1AAYq4iQjjJw9l/OShfHr4BKt+/wHvrt5CrcePiHBo/2cc2v8ZL//sv+nSLZWR4/IYPmogw/IHkNm3JyJCLAya8Unp57z09Bvs3naIQH0QEeE8EcEUdTuondiXmin98Y7JQmlCE8VXqo1GiEd2bi8efvJ2Fvz4Vor+uof164rZtL4Ef10AEeFclZf31hTx3poilFIkJrkYmj+Aex+ezYC8TKwYWAjUB5k3+ym8NT5MIkITpQjmdKVubBbe8dnUDeuNEmK2xF9JgT2JBNGIh2HTKZg6nIKpw4k0RigpPsiWD3ax9cO/8enhk4gIIkK9r4GijXv4W8lh3i1eijspgYsxsFBSXIq3xocp3D0ZX34GvhG9qR2VQaiLG5SiJf4a9pF5di/9dCeCYBLAEP5BZzGY60pjhiOVC+mGTv64PPLH5fHDhXCmsprizfvYufUAO7aWcrriHD5vPTu3ljLx6hFcjIGFqsoazit7Yhq1I3rzBaW4FFXRCFVRP7FYHfSwPLkPd7q6cjHdunfmmm8XcM23C9j5cSl33fhTTGcqa7CiYcHr8XFeJMVJRyr0nSJWKalulKJJrdeHFQ0Lfl8DTaKKcKcEOtKpaJhGFLHo3CWZaDSKyVdbjxUNC746PyZRikiKk46Ub0vAQIhFUkoiIjTx+xuwomGhIRDCpOwGEYdBR+mmGSxLyiBWdrsNh9OOKRgIYcXAQsAfxKQS7CACKOI1yeZmiiOZJNFpic6aznR7KqmaTjwS3S481XUE6huwYmAhEGjA1JhoB6WIR4JovJmSxUxHKh0h0e3CU11HQ0MIKxoWQsFGTMppgFLE49dJfZjpSKWj2OwGpnAwjBUNC4H6BkzKaQNFzHJ0O7e40uhIDocdUyAQxIqGBb+/AVPEZSMeo2xuhI6V6HZiqvc3YEXDQjAQwhR12vj/xuGyYwo2hLGiYaEhEMQUddmIR3HYh6JjOZ0OTIH6IFY0LAQCQUxRp0E8jkVC/FfgHB0pIdGJKRBowIqGhXCoEZOyG8Tr7roy3gnW0FHsdgNTONSIFQMLkcYoJmVoxKteRbnO8ykFNjdTHckki855OvBdVxdcotFWdEPHFI1EsWJgQSmFKaoLLbUp7GNT2MeFbnd25p6EbrQlTdcwKYUlDQsiNNGiitY00HDR1qLRKCYRLGlY0G06JglFaE1/CnqI0rYawxFMuk3HioEFl8tBqCGMVh+iNW0J+7nec5Q7XF1wi8bFuEVnmC0BAyFefl8AU0KCEysGFpJT3XhrfOjeBlrb2qCXtUEvzemr23krNYfBRgLx8Hp8mJJTErGiYaFzWjIme5UPhA5xNBLiW55jNKKIR1VlDaa0rilY0bDQPb0LJvsJD4LQUY5GQuwO1xMrpRQV5VWYuqd3wYqGhcycHjQJNeIo99CRFLE7WX6GQH0DpozsHljRsNA/L5MmIiTuq6CjZOt2htkSiNW+kqNomoYpd1AGVjQsfG1Ef5RSmJJ2lNERsjQ7q1NyMBBitWPrAUxKKYaMyMWKgYXUzknkXpHBkYNlJG8+iqirUUJcrrYnMceZRrKmc56GIPwfAYR/lCQ6I+2J2BBiFY0qNm/YhanfwD506pyMFYNmFEwdzpGDZeg1AZI/Po53TBaxusOVxvLkTIT2U7xlL+fOeBGBgqnDaY5GM6bfMA6lFKZuK3aBEBMBFrnTEdrXG6/8GRFQSjH9hnE0R6MZmTk9GTF2ECZ30XHce08RC7do/JNmoz3tLTlM0cY9mEaMHURW33SaoxGDO+dfj1IKBHr9fCOxqFNRDjU20G4UPPfE64gISinu+sENxEIjBleNy2NUwWBMrv2n6LLuALG4p/Zz/CpKe/jjqs3s23UU0+iJgxk5dhCxMIjRQ0/MYfaUR4g0Run5/Id4x+cQTnFi5cOwj4Fn9/MtZydSRScWugiDDRffdKSgI8TCU13H80++jkk3NB4snEOsDGKU3a8Xc+6ZyWtL30H3Buiz6H2OLbkWlMJKeTTMC/VniFe+4eLdTrmkaQbNWfSjV/DW+DDddvcMsvv1IlYacZj3wCyy+/fClLzhMF3X7KWtbG8McG9tGc1Zs2IjG9Ztw5TVL515P5xFPDTiYLMbLH55PnaHDQTSn91A4qEztJXVwRrqVZSLKd37Kc8+/ltEBJvD4JmX/xW73UY8NOLUt39vHnv2TpRSSChC9v1vYT/toy2EUdSpCF+lsuIc989dQigYRinFj57+HrkDM4iXRgvMnDWB2+bNwGRU+ek3byW26npaW2/NTjfNxpdVn/Uy76anOHvag+mmO6dx3exJtIRGCz3w+C1MuXYUJntZDbnfW4HjVB2tRYBnk9IR/l5FeRVzry+k7Fglpq9PH8mDC+fQUhotJCI8/eJ9TJgyDJO9vIb+t/2O5F0niJ0CFKAAhQAacKXhZFVKNjc507jQjq0HuHXGY5Qfr8Q0umAwz/xyPpomtJTBJdANneeWL+DR+b9g/dpi9JoAOXe9SdXtV1ExbyxRm8ZXydBsrEjNZoiRgPC/BLCJAILO3wuFwvzq53/gd8vWoaIKU8HVw/nZsvux2QwuhcEl0g2dxb+cT1bfdJb/+2qUUnT97TZSNnzCyYe+jmd8DijFhZ5ypzPa5iYWWz7YzZKF/8mJz07TRGDuvddw78PfQdOES2XQCkSEeQtmkT92ED954FdUlFVhP+Eha/5q/CN6c+q+8dQN6QmKJr10O83Zt/sIv1i8ku0f7UdEMHVPT6Pw+Xnkj82jteiFhYULAaEV9OjVlRtunkxjJMKB3ceIKoX9VC2d395L8p4Kwj2SCaan8l1nGpm6g69SUnyQpx55haVPr6CivAoRQdc1bvn+NJb8ZgGZOT1pRcqglTlddn7w6M1cf9Mknn/y92x6vwQRIXH75+Rs+4zAlT2xLVsAmUlc6PSpczx89wvsLTmCiCAiKKUYN3koC35yK1l902kLBm2kT1YPXnjtIXZvP8TSZ95k9/ZDiAiu/adwVHghsxcXqjx5jn27jiIiKKUYPDyX+/5tNiPHDKItGbSxofkDeHVNIds+2s+rS9/G6/HRf1AmX9ZvQG/652XidruYe9+1jJk4hPZg0E6uGpfHVePyuJgEt4sV7z1De9O4zGlc5gxAAVEuT+p/ABopEAN9AKm/AAAAAElFTkSuQmCC",universalLink:"https://wallet.airgap.it",deepLink:"airgap-wallet://"},{key:"naan_ios",name:"Naan Wallet",shortName:"Naan",color:"rgb(129, 100, 100)",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAZfElEQVR4Ad3Be5BeZ33Y8e/veZ5zznvd+0VaaVfWfSVLtiUbY4PBBsaUy0CCE0JDadopCdBJ2iQ0w0ynSSedyaQzzaTJtJlJ/oBShoRJS2nTlNImxNg4gSBsLNuydZdWu5J2tau9vfvezznP8yuvPLJLhtYr22khn4/8yscarpnG0mitStluiBYsJndS8GUsDRmoWsltJB2vSCYikZOO74gJGVEwIlJGoiAejw9G0IjUd6XolSiyaAyZ74giCJkJmsWCxuCcqjGqKmLwqM8QzVSjrrVOjQhWYiWFPFc6BpxxKsYjJqgYi+0mGvwGIQkaJMJqot0cjeNMS5GobadstFAvJbxLteva6tsBDVZL1XGNRdWVvJWosyJ5XhdfNQwSiwYrmW8QF61keZCcTDyR5KISdz1YFQTJrGAUcagR1oYNy3uQ9Z2xWZnE1Cdy0xhT3xwRbQ4IaT/4kiU4UAMYBIPQExACSEBsRjBNpVDLKa6JGbgurrQYU5lHhufQgUtWRy8E37+ekStO9LtE8SqpR1wQsJrnuUqwGseWTrtOREIICWnS0aTVpVhflzjpx+WtZVkLHcn7DP2dWJJiJKHUFtOxmDQzrWIQkyLQhciKqhHj1ajMH4rszNuU2ftDWLgDOlsEhO+yhhuU71I2wwAGFMhjoAzpGGygLIIBw8tU8UL5qpitz2J2HAvhtsfVbzuptqPGBBUfyL2RzJlQ7AqmXNZ2pyUmcwxKzHoJ1jttKu0Wbt2komVhsB3LUB5LppkQCmKDiisUJc86YiIrGlKh2xzAPfX3nXvm70J9F98lwv8PFppTRs5PoeffZwTUVi8qd/2+Zvd8TszAauLikGapwUVK16uLihqHNqVugjhYL2Xa7Hix9x38eVeQRExuxcuGaDkRUSvWOOlKR8RYwQWH/OXHnP3i50Vm3gXpID9ghHRQmHvQmqf/HiKp2sln1IvmWYq1ESY2SEFIsxa5dwiO3Cv2wYO/FEU4CT6VXIxEhViMFfHWS+pVMCtbhD/4A+GZj4Iv8gPPF+DiO5TTDwRue8yHcoPIY50B4+mmHXwOTmJciDHGODGSSqVUoiAFcZmVXHNJQ26cub7XyGe/Clffwg8bXXiTMZ/5qomX9ucGyTQVmxlxGkmxkGBCWwTERFEqSbGAEKRbSqRl2uKDiNX6DpHP/jE0Jvmh1dpm5LP/1bCy2wcnbRckK1YkUielUh+FomBsFNGVVDpRapzPxKgTtFkVPvcFaG/lh157i+H3vwD1PpMjziOduGtatMVbFSOFSEBE8kysqFhjxPLlX4fVg/yNsbbfyh//KyQXa1UIuSCIOCNONWCMiBgkhFQMFx+Ekx/hr0EpVkZKnoFSoBwHYqv05EFopkKtbbneNDS6htednv7bmNP/KWP/o8aAESNiFae5kUxUjLOEFBeFP/k1EYTXgQDjfZ7psZSdQzlDJY8Rvq+gioiAQq1jmFmNOLMUcaXmUOV1of7Pfi3P9z1hIpMFCRJlRu3bjn4qMV6NEETsifcbOf4xXiMjcGA85T0HW9y/o0NORkeFgQRE4GrLsjZ+gOt5QjWrMev7aN/xdhZDhXh9nv4CbO3zHNqaMj2WogrXmw5VXhORzojYgbOiW05GwWO8weV0RFB8biWKjn2C12jHYM7b97YZKXsutyNmd9zHnqOHERGe+6M/QlD2PPIeqtUSqvDof/4T3vTuBymVCtRLjmfOn+N2U6cYGXqGSoGH97d5w1SXxy8UOXc94rUwfOsTWTjyJZWAulQc4kUtAkt7hWv38ipFVnloT5s7J1JCUE7LBHsfeQ+VSpGe4ANh6iBH7t6PtQZQLp+b5fCb7qZUKhDSBtUdQ+w9vI/nvvU0924H4WUDxcCPHmpyeiniq2dKdHLh1RCuHxUWDoiZOGmswbjcYiQRZ0+/FxBehb5C4MNHG9w1keK9crayjzsfeYRKpUhPSOucPD3DXUf3Ya0BFN9Zop5njG8dADJMlAEZW+67nYnJbZxd5fuaHsv4yD11hsueV0ki98J7rcQkPhIDiYRgQWce4FUYLnk+fLTBWMXjg3KmtIcj734TRjaADmiTuSvzTG4fxNk6mtdAN5idX2fXbSOEdIV0Yx4IvMiz9wMPk/dtpdYJ9NQ7Oaq8ZLAY+PCRBhN9Oa+Ghpm35sFIFgwmSzwqLWdk4Si3aKAY+Im7mlSTgA/Ko9cKTAz3I5KTNWqktUVW11a4+uwM5SgAns7qEqo5Z791Gt1oYSIHQVk9eY50owGqiEk5+uPvZXFkmp4vLTX4xMUVvrlQ56ZCpPzYnU3Gq55bJbJ0REwzyeNMDHgxcm0X5APcgsQpjxxuUkkCPV++CNsiZeJN9wOOqFImb7X56pePs3OkgisN0BOVivzZZ/6Y5PoipS3bQCqYyJHW6pz+91+ktbiM73S5fvwZ9j74VmbbCWvtjM/vGeDHGh3SPHBTwSkfONykEgdujS8Ll6eRIMZ5h2X5MLfo4X1thsuenr+4ooyXChz40feBCEiJkOV8/avPsa1TY2DvHsABRRC41nbsPbSHFyXU5xZ49rc/Q2nLKMngALY4zvgbpimVEkr3P8w+tQwuNPjHxvBfZtb4rUtrNLs5PdUk8N6DLYxwS0SvHbZeMCE4VBenuQX7xzIOjKf0zG5A3Q6w7859lCe28iJDbXmd1fWMidE+Slu2cINEXHj0W+jqOuP3voGe9tIi/bunuOuffIzb3v8wttAPdifY3YDjO8sZXyj0ccfcBt9R5R9MlvmiBkqx46apwZwj27rcCtWlg0ENJs0zUV3ewyZFVnnbnjY9rTRwKt7JgSHLtoce5KaNi6c4/vwieyqw6wM/So+GQP3SOdaLgxy8707EWsBQHBvDxIOM3fshbDIJlAADMgxmhPv27eXJkHFxaIChZsb+uQ1+I4r4zVNLzK93yHyg5807O5RjZfNWd3fTTOz9Rz5ZjM3jPy/S3sIm3DOZsm80o+d4e4i9D9zPvgfvB7Hc1LU5Fy5ucPTuaQqDgyCCiJD0x5w4s8K9D91LUh4CuwPIgYC4YcQOg+kHIkBAClTLFT75lh9heeYiP1V1/POJAlN9CXOdnN+9vM7PtboMNDPu7k9wBmZWIzYnaObv+7SLTBCR+nY2wRq4e3uXnit10Klpdu+eAATsTtAGhEVmLtTYtXs7/XumwAwDBQgLQIF2SygWE9AuEMBsgTAPYQ3MVsACyssSen7hPR8mdGb40qd/j1+sKKVWxtpIkf5mRrko5D5weCLlL2cLtDPhlYi0txqXOxO7ZgXSPjZhz3BGJQn0rAzsZmxsgBcpICD9BE24PLfC1I4xXmRBymDGaLXBZi3ai4tAgLDIDWYrkIHWAEVDG/V1NO9w0+joVsa3T/O5sTGWp/rY4ZWP1lI+UYh4uL9AElliqxwYT9mcvBhH3X4j1AeAiE2YHk/puVpX0uooleU5XqItemYudeiPQOo1btAaN0gfy6s5w31F2svL3KBNCEuAAbMNiOgJ7Q2az38NcY7vIUOsA4dfqPN7oxU+v7XML+/o4/NXa9w0PZaxSUZCbdiEkA6xCdbAjsGcno3KBGZjjUK1yku0Rk+7sUF+fZG4WuUG7YJu0NNNqxT6qnRWV3mJ1iAsARakBAimOELljr8FOP6qr3zoUzz2s7/A9Y6llXrwgScqMTdt7cspRspmCO0BY0yjj00YLXsSp/To8HY6iwv0793DS7QJ2sWnDXyzQWd5hZeE64CnUCghxrF25Ro3qW9AuARhnpvEOJAC3ysHXWN0ZIDhsWkm3/k+HrUxX1/u8pZmRlClxwhM9OVshtCpmuBDiU0Yq3p6luoZwxNbac9fRYzhe+gKPmuTtzvE/X28zENYZGxsBOscC0s11HtAERMAD2EWXz9L6Db5/jyE6+DnQOtsHR9C+7ZzZGuVT06PYkS4aazq2RwtGkQSNmGg6Omp5Y5yKaGybYK4r4+XaJvglzHGI9Zg4piXhA6EJZK4DbbIyJvfglgLuoHvNNi4OMflP30CW6hjYsv3l4CUQdtofoFkoMjOvTv59kwXVb7HYDGwGSI+MYJ1bEI5VnokijHGEPX1oSHwooD6BkKDEHJsqUxrYYGbVFtAG/x5kvIg/eUC8/MrIBVsoZ/lZ09Rn5tHyYCM/yMziu/Wqc9eIWQ1hu+4nZ2HDnJ8xaHKS0qxshkhdKxRhM2IjNIjqhgjDB85ihgBrZG3ryHWICIYA6NHj9K3axeQ4tuLiFFelLLztiK15VUW5pZQNSBltr/9rez5ifciUuL/Lka5jdn/8ThiDC6B2971TqYOHOSkjqO8KLbKZhgTYwRhU4QbXN7B+wBBAQEEV0hYfvYUs195jJC2KESOer0FCLYQUTt/idr5S8x+5TEKSZOkuoXRcsSJ5y7SEw/dRTx4F5hBkBLgQRtA4K9ypTFu//jPYhOHiRTjYOK+e7nrkQ9wymxDlU1TVYwS2Iw0F3rGyobFxVXSTsoN0oeGmOXjL9CcX8RFgdHhPi7PLQERSD/liW089Wv/lsLQAEjO9NEjXDy1QNxqcvnyEmgdZBTMJGAhrKD5BfCnQFt8D3GI2wlEgAetYZMOLhLu/JH3c9pM0M3ZpKDGSMjZhGZq6CnGhu7KIs4I7XaXnrztGZzezdg9d7D70E6uXV+n2+ygqoAFIu755X/E0OH9IP0ICW94/09y+TvPszq7wOrKMoRlXiIxIinoBvjnydYv8bIMsRakyMs8i8f+HPEph97/Pk6mQ2xOITci2mUTVluGmzonvs1wIszNLtITVScYv/8BBg/soVweotPoMlYwnDt3lR5X2Un/vjcSlctABBJRLpe448d/ho0TJ7j4/AWajQXQNW6QhKzZYO3MBdZOncHEV0HbgII/Tb5xjNXnj5Oub/DtX/0tVJXxew9j4xZxLLzjI+9GEuEVCV2jSItNWGpYbhofjLj27HN0mh1ukCLY27HFKZA+Jg+8mYXT52iuNfA+AApmF9g7wU4BBvCMb9vC9oc/TNTY4NSJGdrNqxCWgISoMsn814+R1hvYuAS6yA1mJ65UpjK1lSuPfZO+XVO0FpZ4kQGEoaEqD77/Tl6JYJoGqnU2YaVpaWdCz0S/49qZM5TjiNXVOmgbsGB2gtnO6Pg4zbzIiEk5c3oOtAHkIEUgAQL4GfBn2blvC9UDDzFYLXPy2QvUNxbAzwLC/p/6EKNHDoEUQVMISyAVcIeJ+yZoLVynvbRMeWIcpAoyCFh64sTySpS+dQNujU0ICjOrETcNlpX8haeZv3wdtA14XqItjr7vPl74b/+d0O7SaLQgrPKyAORovgr+LLt2D2GruykXi8ycnuPKlXnA44qjmHgIMNygNdAVICZrDHDwp3+SI7/0cfJ2B4i46blnZvjT//g0ryRovOqC9q0ZyAHHKzi1GHFwPKVn//YK37m6xOCWNdI0Iy7UQIZ4UUalBGMPvRF78RRng3L03hJoFaQICD6tYyMDePDnmNyym5XyEebOPU1nvcHxa2sMlSwDsWLjhOLYGLaQoH4ZsULUvw18HXQDVyzRbLZ5/vhZXjg2w6VzGzhjeQVZO+9bd3lIGrFEDcgGeAWXViNqbUN/MZBEhmrVsXWwzPlzVzh4ewK2HzCErIXQ5q4H7+Bbf/oCkwMVZmYW2LnTgp0EBBuXqJ19jrXT55l690NktROMbXmQkZGHOXPqSUJ6meXUsdCo07k2T3txger4GJVtE/Tv3kWeWzqtBldm50nnZyltLHD7WMxjswM4Y3ll8QYhaZg82KBamWcTgsKTlxNu2lFssZ4qWatLlnUhLNFjIkdr4RrNK/P0s0G706WxusHGxgb4K4CCDFCfvcrKc6cJWU5hpATawBjDgQOjHJqusGNvBRtqDO6fIh4YoO/QNL4Yc+35F8i6TbqdDrevPMU7h1Z54LaE00tF0lzYDNX+OaNGnVELDM7A2kE24bmFhLsnuwwWA30Fy5Uzx9n50MOcPjnL4TsdaAGIMUmJZ/7lv+HOX/woV+odhsuDnD15iTvv3k/ELKCMv/FuRo4cxJUGgRLoOkgfmAmSwVXikJL3C0k1x2bXOXRkKy8rgpQ4sTLLaOM8rUx46nLC5g1cEmsxzhRVZPQ8m+QDPHq2iPKiXWaZufMzJCIsL29AuA5hCVcosvuD76G8dSvTB3dzbXWDqa3DHH/qDHmeAUrUN05heAxw3KAd0DpQALsfkZi80eLb/+K3KY4N015a4WWBnsn73sxiC75+vkgnFzZNhs85Z9WI7aKMnuYWzKxGPHs1oacQGQozT1GIHbMXrpJlOaBE1WHG7z0KJgEKHLlnP3NLGZPjgxx/8gz1RhvUgvQBMS8J1wEPUgU7RfW2Sfp3TTF4YA/FsRGQEkgVpEzPwGCVk34HL1yLuTXjp6woxpucYLac4BY9dr7AwoalZ0clcP3YY2wbG+DpJ8/ifQAixA4hpkyPiHDPvXew0u6nv1zi0unLfOOLX2H+L77B2slTvCyHcJ2etJZTnhjnvl//FNWpCSABikAMCD0hKKfmuii3RsOW57zmah+8+1MFQqlm+ObHISRsUlDhwkrEnpGMYqSMRCnnLsyzbd80585fpXP6BP3bt2Gc42UpY1unCW6A9fUVqiP9rHaFuROnmf/qnxCL0rh8hcrkGIjDFkcwrgmk2DgGHEhMjyrMzi7yh595nLXLdUSEzUuWg3/Pr2sguDiLNHVJFsL400auPsQtaKaG//BMhQ/e1WS45DlcrHH+G1+hdOB+asURvv67n2PX7gmG77yD6tQU4EFrjI6OUMkmaDKLv2awt+9nbXWK2a4jSSLWTs5io6tYm5DEEDQn7bao11dYurpEtbuGWV/hiWeVTh4hItyaiackSnziRe3Db/ilAiZDdX1cmH0btyj1wumlmPGqZ6AYGIo9ZmmG9VZG9dBR1rxj7vEnMGvLiDEUBktg+okqfZRKNcbGKwwmGVP7d5CZBBPHoErIA51Wi4vPvkB44Rj+4mkGF89w0F7HbDT4sxcSmqnj1Tn6GTE7noqNUfvAG34hCT6X3JeXnHnqZwDhFuVBOLUY0zPRn1OMhDFpoAsX6KY5fmI3jdIwXZuQq6dcApEU8ECGKxVwUYmhoUFGRvsZHRtgdGwAayA5/yT7yl1GikI5thy/mvDlkyXameHVEd/17/skEm14k6nTPAf1KoxeUt3+dZErb+NVCArfmClw7nrE2/e2mRzIGSlbRlgmtJa5cs3TvjrEeSlzrGuQSh/FaoVCKSaODWkGeZoyFAcKeRvWl6g2rrGjKPRcq1seO1fkSs3xWiiTXxMduCoh16CKM7lVNV6c8Rrkgd+x/OHbeA2WGpY/PF5hx2DOvVMddgzmGIGpfgvUgBrE3NBdD3SuB1TBWaEUG4wIN2lRuFJzPHU54fxyhCqvWeCB3zE2qISA8bG6NIrUWFX1OeT7Hjdu4hvC/Jt5jWbXHLNrFfqLgf2jGTuHM7ZWPZFVbkqcIXGG/13mhaWGZWbVcXYpYqVleb0o254I+d4/x+WaR0atWHWxQ0UjNZojUeS9ffc/Jf93XwN1vA5qbcO35xK+PZfgDAwUPQPFQDlWIqv0ZF5opcJ6x7DeNmReeP1JFty7/llB4mAwmmNVrcdJJ+CjoMbEiE8Q3XYiyBv/tei3PsXrLA+w3LQsNy3/r6m86TeN3/a8CZHiRH0IaluRGu2gVq1aE2kWcjSLlPDO30B2PMrfGJNfE33Hb4pPtJvngFHrUc1EjbiCOhWVbqreoFnuFV/MNPydj8L40/yQU8aeCeGDH8VHmVev3gY13UxtEMXkatLcabPZIojRKN1QrNU8dDTvROvB//QjysQ3+CGluuWY6scf8d2+tSzLVcVolDU0F9V2u0EnL6i9f/oTzpiEPG2KjRPEe2IMkYswlLvK9JfEtEswfzdg+OEQxNzxGfUf/LjTaj0S1OBVQlutLWq3mxE01jxLsXcf/Dnri4aiTyiQgYoaY8RaIdWAaOKtmX5Mza7HNVzdJ9Lczg8w1dFnxT3yCRPe+mkJSRYQtRLUaa4iRk3mVUxJu7HXXLtq7zryD61FiSNDKY3IrRfvIRglOKcGwYqgoXI14+gXVLc/oXhrZG07hAI/EEwz6K7/qfLwr3h9169aHZ2JcBrEahBFQ1tDMEowWgixdqJMWzbTTHN1cZqDFV0vQh5HmLxA0EwrxknikW7iCZmi0kGsDSa77Zve7/qmtxpF9spRYf6NhJmjyOLtUJ8ETfjrlUH5KrrlpMrkMyKTxzK//Um8a1sXwAbNQ6oSvJpiokkH9a6krbyr3id0krbWXa5R6snzgGvHQRPvJaqjjSoUxRB1E9qdDkkxIU0NNvKI6SNkKcZ3lDiIkyS1ZvpYnh865vO2GOvF2k5RdWWb92s7nDYmRGrjSmcU1x5CW/3QrYKWoFmEPAZ13CA5uBTKHZAmxHWkVCMU1yQUl4X+axnleTGDl0WGrvhQauKtii1q5FKiONc0bWOCaG4SIh+r913NWmhANUu7hBChcVdrLle3kdOWTH3JqxsobdN6tkLa6Uo1Q9MiqDqpypCa3FPqNggVq92QiwYrVkviQ1vFBokDquolt5mKtSKm1Ay+cC5w27mcgCMT5wwSRWR5JkE9AhgDISggCKCioAbVgAgY47DGachyvCpeHCpWjaYYa9RaJZcM52ONg9GuCSBGNU1ArHoJWiBWWp48LmspGtQNU6dJW5NGpq0oI6r0acVV9X8BXChrJiNQKxUAAAAASUVORK5CYII=",universalLink:"https://naanwallet.com",deepLink:"naan://"},{key:"autonomy-app",name:"Autonomy: Digital Art Wallet",shortName:"Autonomy",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAIPElEQVR4AeXBe2yNdwPA8e/vdw5VdGmxJsV0SiKaLC5L3GLuySLZTObSLKOtS8XQHdritNWn+lTbHWXVRlyaoUhZOtFISJhLJAhxi6nJrOJadVDM5XC0nOd9+4dkked3ejunXu/5fITxXwQwSYCTBDhJgJMEOEmAkwQ4SYCTBDgrrejWrVtUVVVRzzAMDMPgXd26daNnz560FiutpLa2lhkzZvDq1StiY2ORUmJm1apVlJSUEBoaSmuw0kqKiopITU3lt99+48svvyQyMhIzgwcPJicnh/z8fFqDpBXcu3ePiooKxo0bh6Zp6LqOymeffUZdXR1//fUXrUHSCrKzs9E0jXrdunUjKiqKY8eOoZKRkUF2djatQeJn58+f56OPPqJXr168lZyczJo1a/B4PJjp3LkzQ4cOZe/evfibxI8Mw+Cnn34iNTWVf2vXrh3fffcdmzdvRmXu3Lls3ryZ2tpa/EniR2VlZYwfP56QkBDeNXnyZA4ePMiTJ08wY7VamT9/PoWFhfiTxE9evnxJWVkZcXFxqKSlpZGbm4vK2LFj+fPPP3E6nfiLxE/y8/NJTk5GSolKv379ePnyJX///Tcqmqah6zr+IvGD27dvc/v2bYYNG0ZDMjIyyM7ORiUqKopOnTpx9uxZ/EHiB7quo2kajfHxxx8zcOBADhw4gIrdbsfhcGAYBr4m8bETJ07Qo0cPPvnkExprwYIFbNy4kbq6Osx07NiRCRMmsGPHDnxN4kMej4eff/6ZlJQUmqJNmzYkJCSwbt06VKZNm0Z5eTkulwtfkvhQSUkJMTExBAcH01Tjx4/nzJkz1NTUYEYIwZIlS3A4HPiSxEeePn3K/v37mTJlCiqHDx+muLgYlYyMDLKzs1EZNGgQDx484Pr16/iKxEfy8vJITU1FCIGZuro65s+fT1JSElVVVZjp06cPQUFBXLx4ERVN08jKysJXJD5w9epVnj17xoABA1BZu3YtV65cweVysXTpUlTS0tLIzc1FJSIigujoaI4cOYIvSHxA13U0TUPlwYMH6LrOWzt37uTEiROYCQ0NZcyYMezevRsVm83G2rVref36NS0laaGDBw/Sr18/wsPDUcnIyOCff/7hLcMwsNlseDwezMyaNYvS0lLcbjdmgoKCiI+Pp7i4mJaStMDr169Zv349iYmJqFy4cIFffvmFd507d44tW7ZgxmKx8OOPP1JQUIDKhAkTOH78OI8ePaIlJC2wYcMGZs6cSdu2bVFZtGgRb968wUxaWhpPnjzBzMiRI6msrKS6uhqVZcuWsWLFClpC0kwPHz7k5MmTfPXVV6js2rWLo0ePonL//n10XUdF0zR0XUclOjoaKSWXLl2iuSTNtGLFCpYtW4aK2+1m8eLFeNOhQwfu3r3LlStXMPPpp58SHh7O6dOnUUlPTycnJ4fmkjTDpUuXsFgs9O3bF5XVq1dz48YNvLHb7RQVFaHrOipLly5l5cqVGIaBmbCwMEaNGkV5eTnNIWmGnJwc0tPTUblz5w55eXl4ExkZSXJyMl26dGHIkCHs27cPMx06dGDixImUlpaiMnv2bLZv347b7aapJE20Z88eRowYQVhYGCp2ux2Xy4U3DoeD4OBg6v3www9s2rSJ2tpazHz//ffs2bMHl8uFGYvFgs1mo6CggKaSNMGrV6/YunUrc+bMQeXUqVOUlpbizfDhw5k6dSpvWa1W5s2bR1FREWaEECxevBiHw4HKyJEjqayspLq6mqaQNEFhYSGJiYlYLBbMGIaBzWbDMAxUpJSsWbMGIQT/Nm7cOCoqKnA6nZgZNGgQ9+/f58aNG6hkZmaSlZVFU0gayel0cvnyZUaPHo3Ktm3bOH36NN7ExcXx+eefYyYzMxNd11HJzMwkKysLlcjISCIiIjh16hSNZaWRdF0nMzMTlefPn5OWloY3UkrGjBnDoUOHqOfxeHjL4/FQ7+bNm5SUlBAeHk49j8fDWx6Ph0ePHnHs2DG++OILzCxZsoTY2FjKysqQUtIQK41w9uxZOnXqRM+ePVHJzc2luroabxISEqjndDoRQiCEoJ4QAiEE9WJjYxFC8Pz5c4QQCCGoJ4RACEFcXBx9+vRBpX379kyePJlt27YRHx9PQ6w0wDAMHA4HW7ZsQeXatWsUFBTgTVRUFIWFhQQFBeFvMTExxMTEMGnSJEJCQvBG0oCdO3fy9ddf07FjR1RSUlJwu914k5+fT1BQEK1BCIHdbicvL4+GSLx48eIFu3fvZvr06agcOXKE8vJyvBk1ahTffvstrWngwIE8ffqUq1ev4o3Ei5UrV5KSkoIQAjNv3rxh4cKFeGOxWCgoKOB90DQNXdfxRqJw8+ZN7t69y5AhQ1ApLi6moqICb2bNmkX//v15H8LDw+nfvz+///47KlYUdF1H13VUHj9+jKZpeBMSEkJ6ejput5v3JSEhgWnTpjF69GjatGnDu6yY8Hg8OJ1Ounbtisry5cupqanBm2fPnhEZGcn7FhYWhsvlIjQ0lHdJTEgpiY+PZ+PGjZi5fPky69ev50Nht9sJDQ3FjERhypQpnDx5kqqqKt6VlJREXV0dH4Lu3buTmJiIisSLvLw8UlNT+be9e/dy4MABPhTLly8nODgYFYkXXbt2ZcSIEfz666/Uq62tJSkpiQ9FdHQ08fHxeCNpwOzZsykvL6empoaioiIqKyv5UOTm5mKxWPDGSgOEEOTk5LBgwQL279/Ph2LYsGF88803NMRKI/Tu3ZuhQ4fyxx9/EBERwf86IQSrVq2iMaw0ks1mw2az8f9GEuAkAU4S4CQBThLgJAFOEuAkAe4/IW7lge8FkmkAAAAASUVORK5CYII=",universalLink:"https://autonomy.io/apps/tezos",deepLink:"autonomy-tezos://"},{key:"temple_ios",name:"Temple Wallet",shortName:"Temple",color:"",logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAIAElEQVR4AeXB3W9b9RnA8e/znHOcOGliO3aiUkLfCyNDLdIkShtKIu2GiwlVbNP2d3C7m11Mu9jlNG2X7AJpm5i0MSGtEpu0ZKhMoxUVsJVBm5emaUtI7DiB+Pjl93uGXRzaDBGGT10kfz4CGD1M6XFKj1N6nNLjlB6n9Dilxyk9LiRBx8cizn7nARChRQAREED4hIAAAiJCiwAiIIAILQKIgHCbCAgg8KtfL7KyWiUpIQk5MRpy7uwQheceQIZSoAICqCAqIAIKiIAKCKACIqACAqICKiACCoiACoiAAipcXdjixd9fJylKAk6Mhpz7boaRwQBWt9jJjN0JX8Bomz6dJ0lKh06MhZz7fpaRwQBUsLUKX4mxO4OpyQJJUjo09VCKkYEAVCBQKMZ8FSLsTuDIwUHG96VJSkiHZpbqEAiI0GQ1B1t12JOipdLA1ipsEz4htAi3CRhNAsJnhNsCRR8fAwMEpifzvPjSdZIQ0qG3P6xTqsFIWkBosWKM7EnRUnP4vyyAN3AG3sAZeA/OwBt4A2eYN3AG3sAZeAPvkbFBZHwIGR2gafp0gRdfuk4SQjrkDV5brvHsI2laRGA9hv3DtGT60FMPghmfy/hixRj/zofY3DoyNkDT1GSepIQkYPZajWcfHQABRLD1KsJn5NE8IgIKiIAKCKACIqACAqICKiACCohApYG/eAt7rwgn94HAkUODjO9Lc/1GhU4pCZhZqEEgoAoqUHdQabDN+D8Z2wYjJNePv7xGmwDTkwWSoCTg7Q9qlKpAIBAIqGLlmG3C7oTbzADhTvLICNQ9rFVom57MkwQlAd7g79eqEAioQCBQrrHN+FL8Wyu4VxfZKTh7jOhn05BP0zY1WSAJSkJm52NQgUBBBdussk3YnYfGC+9gl1f5Mo4eGmR8X5pOKQmZmY8hEFCBQKDhoepoMXanIAeG8XPr4DxfxLht+qkCnQpJyNs3apRiIzeotHjD/3kOUgEEAoFAoBAI9AXot/YiuX7upA+P4K6UsMUN5GiWJlvdwr9xE8IAIkUihVCxSHGlmE6FJMQbvDZf5dnjg+ANf2kF26xCoBApEiqECn0BcjQHqxXI9bPNQI7lQMC/XyQ4mqVJ9qTw7xYhpUgqwFIhpJTnXynxm9l1OqUkaOZqBQz8GzexYkyL8JlAkENZJBVgxZid5FAGUgH2folt/SEyNgAIIBjw/Mtr/GJ2nSSEJOiv727x5qvLUIohUAiA0CDw9KeFb0zkoC/AnEG5CnUPqYA2CRU9lMXPl8EZhELTan4Py//5CCLHC29V+OU/NklKSIL+dbPKE6/wKc+dBlPKyiklcgZmYGDFGNk7SIvQIsdycLWELW4gR7I0/TPo5+wLq9wLSpd8XPNcWIzBeXAGzmOrW2wzWuRYDkTwV0q0nTk5gqpwLyhdNHOlAs7AGTiDlS3aRGjRAxlIKXalRFsuE3FiYph7Qemi2asVcB6cB2dYMYa6o8n4VKTowSy2UAZntE2fznMvKF10frFKrebBeXAenMdWtthJjmWxuseWNmibOpXnXlC6aKtuXFiqgjNwBg2PffAxLcY2OZIDAX+lRNuZkyOoCklTumx2PsacYc5jzrAbH7GTHsggqQCbW6ctl404MTFM0pQum1mogfPgDLxhqxWoOu4SCnIwgy2UwXnapk7nSZrSZa8v16jVPDgPzkPDYzc/AuEOghzJQt1jS5u0TZ/OkzSly7bqxoUbNXAGzsB5bHmTnfRIFlSwuXXazjyZR1VIUkiXjaaV0eMFgskxEAEB6QvBAGGb7B+GSPFz6+i3D9CUy0ScmBjmzXfKJEXpotG0cu57WR5OeSSfRgpppDAAmT4Q7hYqciCDLW6AN9qmJvMkSemS0QHl3A9yPLY3wkoxeGM3cjgLDYdd36Rt+nSBJCldoALnfjjCY3tTECkiYMWYuxj/Qw9nQQSbW6ftzJMjqApJUbrAG6T6FIkUCRVCxVYr7EYeGoJI8fNl2nLZFMcnhkmK0iWzS3UIFcIAQoVSzK5CRfZnsKUNcAZCy/RknqQoXTJzrQaRQqQQKbZRBW9sEz6XHs5A3WPLm7RNTRZISkiXzM7HECqIgADlKo2fX4RIIQogHRJMjqMTee4kh7Lwt2vYQhk5kAGBp5/Moyp4b3RK6ZJbm473Sg6JFDZq+H+vYeUqtlGDrTqST2NrW+wk40MQBfiFMggtI7mI498cJglKF83Mx1gpxl/6ALzRJKEih7MQCFaMsZrjLqEi+4expU1wRpMB05MFkhAAP6ZL1jcbVK6WuVgyLm7AxXXj8ZMFgv4QvIEzNJ9GhlMgAiIgAuUqNreOPpxDMv2IQFwzfveHZToV0kXnF6ucp83T9PgTDU7tD8AbGNitj5EHh7iTHMzArGALZWR/hqanT+VRFbw3OqHcZzPvV6DuoeGh4fA3NtlJxocgUmxxg7aRbMTxiWE6pdxnM3MxNBw0PDQ8rGxh1QZ3CQR5aAh/fRO80Tb1VIFOhdxnry9VqVU9kQBmsFGj/qNZCBVCRUKFVAD9AThP/afnIVRKVWPmj2U6pdxnW3XjwlIVGh5KMbZQhqqDqoOqw6oOnIe4AXUPdU9xo8EzL61z6VadTilfAzMLVSjG2HwZvLGT1R3W8DQVY+OZlze49GGDJIR8Dfz2ckz9lgcMFFAPaqAeVEAFVECFPy3WeWvNkZSQr4HLJcdPSnzKAKNblB6n9Dilxyk9TulxSo9TepzS4/4Lz8MqhS9ENeQAAAAASUVORK5CYII=",universalLink:"https://templewallet.com",deepLink:"temple://"}];const xb=()=>vb,Eb=()=>_b,Sb=()=>wb,Mb=()=>bb,Tb=new aw,Ab=["ookjlbkiijinhpmnjffcofjonbfbgaoc","gpfndedineagiepkpinficbcbbgjoenn"];var Rb,Cb;!function(e){e[e.DESKTOP=0]="DESKTOP",e[e.IOS=1]="IOS",e[e.ANDROID=2]="ANDROID"}(Rb||(Rb={})),function(e){e.IOS="ios",e.ANDROID="android",e.EXTENSION="extension",e.DESKTOP="desktop",e.WEB="web"}(Cb||(Cb={}));class Lb{static getPlatfrom(){return yb(this,void 0,void 0,(function*(){return pb(window)?Rb.ANDROID:db(window)?Rb.IOS:Rb.DESKTOP}))}static getPairingInfo(e,t,n,r){return yb(this,void 0,void 0,(function*(){const i=null!=r?r:yield Lb.getPlatfrom(),o=e.p2pSyncCode,s=e.postmessageSyncCode,a=e.preferredNetwork;switch(i){case Rb.DESKTOP:return Lb.getDesktopPairingAlert(o,t,s,n,a);case Rb.IOS:return Lb.getIOSPairingAlert(o,t,a);case Rb.ANDROID:return Lb.getAndroidPairingAlert(o,t,a);default:throw new Error("platform unknown")}}))}static getDesktopPairingAlert(e,t,n,r,i){return yb(this,void 0,void 0,(function*(){const o=yield ab.getAvailableExtensions();o.forEach((e=>{const t=Ab.indexOf(e.id);t>=0&&Ab.splice(t,1)}));const s=[];return Eb().length>0&&s.push({title:"Browser Extensions",type:Cb.EXTENSION,wallets:[...o.map((e=>{var r,i,o,s,a;const l=Eb().find((t=>t.id===e.id));return{key:null!==(r=null==l?void 0:l.key)&&void 0!==r?r:e.id,name:null!==(i=e.name)&&void 0!==i?i:null==l?void 0:l.name,logo:null!==(o=e.iconUrl)&&void 0!==o?o:null==l?void 0:l.logo,shortName:null!==(s=e.shortName)&&void 0!==s?s:null==l?void 0:l.shortName,color:null!==(a=e.color)&&void 0!==a?a:null==l?void 0:l.color,enabled:!0,clicked:!1,clickHandler(){return yb(this,void 0,void 0,(function*(){if(!this.clicked){if(this.clicked=!0,n){const t=yield Tb.serialize(yield n()),r={target:f_.EXTENSION,payload:t,targetId:e.id};C_.postMessage(r,C_.location.origin)}t(Cb.EXTENSION,this)}}))}}})),...Eb().filter((e=>Ab.some((t=>t===e.id)))).map((e=>({key:e.key,name:e.name,shortName:e.shortName,color:e.color,logo:e.logo,enabled:!1,clickHandler:()=>{window.open(e.link,"_blank")}})))].sort(((e,t)=>e.key.localeCompare(t.key)))}),xb().length>0&&s.push({title:"Desktop & Web Wallets",type:Cb.DESKTOP,wallets:[...xb().map((n=>({key:n.key,name:n.name,shortName:n.shortName,color:n.color,logo:n.logo,enabled:!0,clicked:!1,clickHandler(){return yb(this,void 0,void 0,(function*(){if(this.clicked)return;this.clicked=!0;const r=yield Tb.serialize(yield e()),i=gb(n.deepLink,r);window.open(i,"_blank"),t(Cb.DESKTOP,this,!0)}))}}))),...yield Lb.getWebList(e,t,i)].sort(((e,t)=>e.key.localeCompare(t.key)))}),Mb().length>0&&s.push({title:"Mobile Wallets",type:Cb.IOS,wallets:[...Mb().map((n=>({key:n.key,name:n.name,shortName:n.shortName,color:n.color,logo:n.logo,enabled:!0,clicked:!1,clickHandler(){return yb(this,void 0,void 0,(function*(){if(this.clicked)return;this.clicked=!0;const n=yield Tb.serialize(yield e());r(n),t(Cb.IOS,this,!0)}))}})))].sort(((e,t)=>e.key.localeCompare(t.key)))}),{walletLists:s,buttons:[]}}))}static getIOSPairingAlert(e,t,n){return yb(this,void 0,void 0,(function*(){return{walletLists:[{title:"Mobile Wallets",type:Cb.IOS,wallets:Mb().map((n=>({key:n.key,name:n.name,shortName:n.shortName,color:n.color,logo:n.logo,enabled:!0,clicked:!1,clickHandler(){var r;return yb(this,void 0,void 0,(function*(){if(this.clicked)return;this.clicked=!0;const i=yield Tb.serialize(yield e()),o=gb(null!==(r=n.deepLink)&&void 0!==r?r:n.universalLink,i),s=document.createElement("a");s.setAttribute("href",o),s.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})),t(Cb.IOS,this,!0)}))}}))).sort(((e,t)=>e.key.localeCompare(t.key)))},{title:"Web Wallets",type:Cb.WEB,wallets:[...yield Lb.getWebList(e,t,n)].sort(((e,t)=>e.key.localeCompare(t.key)))}],buttons:[]}}))}static getAndroidPairingAlert(e,t,n){return yb(this,void 0,void 0,(function*(){return{walletLists:[{title:"Web Wallets",type:Cb.WEB,wallets:[...yield Lb.getWebList(e,t,n)].sort(((e,t)=>e.key.localeCompare(t.key)))}],buttons:[{title:"Mobile Wallets",text:"Connect Wallet",clickHandler:()=>yb(this,void 0,void 0,(function*(){const n=yield Tb.serialize(yield e()),r=gb("tezos://",n);window.open(r,"_blank"),t(Cb.ANDROID)}))}]}}))}static getWebList(e,t,n){return yb(this,void 0,void 0,(function*(){return Sb().map((r=>({key:r.key,name:r.name,shortName:r.shortName,color:r.color,logo:r.logo,enabled:!0,clicked:!1,clickHandler(){if(this.clicked)return;this.clicked=!0;const i=window.open("","_blank");e().then((e=>Tb.serialize(e))).then((e=>{var o;const s=gb(null!==(o=r.links[n])&&void 0!==o?o:r.links[h_.MAINNET],e);i?i.location.href=s:window.open(s,"_blank"),t(Cb.WEB,this,!0)})).catch((e=>{console.error(e)}))}}))).sort(((e,t)=>e.key.localeCompare(t.key)))}))}}const Pb=(e,t,n,r)=>{const i=document.createElement(e);return t.length>0&&i.classList.add(...t.filter((e=>!!e)).map((e=>kb(e)))),n.forEach((e=>{i.setAttribute(kb(e[0]),kb(e[1]))})),"object"==typeof r&&Array.isArray(r)?r.filter((e=>!!e)).forEach((e=>{i.appendChild(e)})):"string"==typeof r&&(i.innerText=r),i},Ib=(e,t,n)=>{const r=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.length>0&&r.classList.add(...e.filter((e=>!!e))),t.forEach((e=>{r.setAttribute(kb(e[0]),kb(e[1]))})),"object"==typeof n&&Array.isArray(n)&&n.filter((e=>!!e)).forEach((e=>{r.appendChild(e)})),r},Ob=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","path");return e.forEach((e=>{t.setAttribute(kb(e[0]),kb(e[1]))})),t},Nb=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","g");return e.filter((e=>!!e)).forEach((e=>{t.appendChild(e)})),t},kb=e=>{const t=document.createElement("div");return t.innerText=e,t.innerHTML},Db=e=>{e.innerHTML=""};var Bb=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Ub=new F_("Alert"),zb=new aw,Fb=(e,t,n)=>Bb(void 0,void 0,void 0,(function*(){const r=()=>Bb(void 0,void 0,void 0,(function*(){return Lb.getPairingInfo(n,((e,t,n)=>Bb(void 0,void 0,void 0,(function*(){n||(yield Jb())}))),(()=>Bb(void 0,void 0,void 0,(function*(){b()}))))})),i=yield r(),o=t.getElementById("pairing-container");if(!o)throw new Error("container not found");const s=document.createElement("span");o.appendChild(s),i.buttons.forEach((e=>Bb(void 0,void 0,void 0,(function*(){const n=yield S_(),r=Pb("div",["beacon-list__title"],[],e.title),i=Pb("button",["beacon-modal__button","connect__btn"],[],e.text),o=document.createElement("a");o.id=`button_${n}`,o.appendChild(r),o.appendChild(i),s.appendChild(o);const a=t.getElementById(o.id);a&&a.addEventListener("click",(()=>Bb(void 0,void 0,void 0,(function*(){e.clickHandler()}))))}))));const a=document.createElement("span");o.appendChild(a);const l=e=>{Db(a),e.forEach((e=>{const n=document.createElement("div");n.classList.add("beacon-list__wrapper"),a.appendChild(n),n.appendChild(Pb("div",["beacon-list__title"],[],e.title));const r=document.createElement("span");n.appendChild(r),e.wallets.forEach((n=>Bb(void 0,void 0,void 0,(function*(){((e,n,r)=>{const i=`Open in ${r.name}`,o=r.key,s=r.logo?Pb("div",[],[],[Pb("img",["beacon-selection__img"],[["src",r.logo]],"")]):Ib(["beacon-selection__img","svg-inline--fa","fa-wallet","fa-w-16"],[["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","wallet"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 512 512"],["style","enable-background:new 0 0 512 512;"],["xml:space","preserve"]],[Ob([["d","M376.2,181H152.9c-5.2,0-9.4-4.2-9.4-9.4s4.2-9.4,9.4-9.4h225c5.2,0,9.4-4.2,9.4-9.4c0-15.5-12.6-28.1-28.1-28.1H143.5c-20.7,0-37.5,16.8-37.5,37.5v187.5c0,20.7,16.8,37.5,37.5,37.5h232.7c16.4,0,29.8-12.6,29.8-28.1v-150C406,193.6,392.7,181,376.2,181z M349.8,302.9c-10.4,0-18.8-8.4-18.8-18.8s8.4-18.8,18.8-18.8s18.8,8.4,18.8,18.8S360.1,302.9,349.8,302.9z"]])]),a=Pb("div",["beacon-selection__name"],[],[Pb("span",[],[],r.name),r.enabled?void 0:Pb("p",[],[],"Not installed")]),l=Pb("a",["beacon-selection__list",r.enabled?"":"disabled"],[["tabindex","0"],["id",`wallet_${o}`],["alt",i],["target","_blank"]],[a,s]),c=document.createElement("span");c.appendChild(l),e.appendChild(c);const u=t.getElementById(`wallet_${o}`),h=e=>Bb(void 0,void 0,void 0,(function*(){if(e&&"Enter"!==e.key)return;r.clickHandler();const i=t.getElementById("beacon-modal__content");i&&n!==Cb.EXTENSION&&n!==Cb.IOS&&(Db(i),i.appendChild(Pb("p",["beacon-alert__title"],[],"Establishing Connection..")),i.appendChild(Pb("div",["progress-line"],[["id","beacon-toast-loader"]],"")),i.appendChild(Pb("div",["beacon--selected__container"],[],[...r.logo?[Pb("img",["beacon-selection__img"],[["src",r.logo]],""),Pb("img",["beacon--selection__name__lg"],[],r.name)]:[]])))}));u&&(u.addEventListener("click",(()=>h())),u.addEventListener("keydown",h))})(r,e.type,n)}))))}))};l(i.walletLists);const c=e=>Bb(void 0,void 0,void 0,(function*(){if("extensionsUpdated"===e.data){const e=yield r();l(e.walletLists)}}));let u;u=t=>{t.data===`closeAlert-${e}`&&(C_.removeEventListener("message",c),C_.removeEventListener("message",u))},C_.addEventListener("message",c),C_.addEventListener("message",u);const h=t.getElementById("beacon--qr__container"),d=t.getElementById("beacon--qr__copy"),p=t.getElementById("beacon-title"),f=pb(window)?"android":db(window)?"ios":"desktop",m=t.getElementById("beacon-main-text"),g=t.getElementById("pairing-container"),y=t.getElementById("beacon--switch__container"),v=()=>Bb(void 0,void 0,void 0,(function*(){const e=n?yield zb.serialize(yield n.p2pSyncCode()):"";navigator.clipboard.writeText(e).then((()=>{d&&(d.innerText="Copied"),Ub.log("Copying to clipboard was successful!")}),(e=>{Ub.error("Could not copy text to clipboard: ",e)}))}));let _=!1;let w=!1;const b=()=>{(e=>{Bb(void 0,void 0,void 0,(function*(){const r=t.getElementById("beacon-switch");if(r&&(r.innerText="none"===e?"Pair wallet on same device":"Pair wallet on another device"),m&&g&&y&&d&&h&&p)switch(m.style.display="none",p.style.textAlign="center",g.style.display="none",y.style.display="initial",e){case"ios":case"android":g.style.display="initial";break;case"desktop":g.style.display="initial",p.style.textAlign="left",m.style.display="none",y.style.display="initial";break;default:if(!_){_=!0;const e=yield zb.serialize(yield n.p2pSyncCode()),t=((e,t)=>{const n=fb(0,"L");e.length>500&&mb.warn("getQrData",'The size of the payload in the QR code is quite long and some devices might not be able to scan it anymore. To reduce the QR size, try using a shorter "name", "appUrl" and "iconUrl"');try{return n.addData(e),n.make(),n.createSvgTag()}catch(e){throw console.error("error",e),e}})(gb("tezos://",e)),r=t.replace("<svg",'<svg class="beacon-alert__image"');h.insertAdjacentHTML("afterbegin",r),d&&d.addEventListener("click",v),h&&h.addEventListener("click",v)}m.style.display="initial"}}))})(w?"none":f),w=!w};b();{const e=t.getElementById("beacon-switch");e&&e.addEventListener("click",b)}}));let Hb=A_.LIGHT;const Gb=e=>{Hb=e},Vb=()=>Hb,jb=(e,t,n,r)=>Pb("div",["beacon-alert__base","animated","fadeIn"],[["id",`beacon-alert-modal-${e}`]],[Pb("div",["beacon-modal__wrapper"],[],[Pb("div",["beacon-modal__header"],[],[Ib([],[["xmlns","http://www.w3.org/2000/svg"],["id","Guides"],["x","0"],["y","0"],["version","1.1"],["viewBox","0 0 179.2 43"],["xml:space","preserve"],["width","140"],["height","40"]],[Pb("style",[],[],".st0 {\n                    fill: #3880ff;\n                  }\n                  .st1 {\n                    fill: #fff;\n                  }"),Ob([["d","M45 19v.9c0 .3-.2 7.5-3.4 13.2-3.3 5.6-9.4 9.3-9.7 9.5l-.8.4-1.3-.8-7.6-4.4c-.5-.3-.9-.6-1.4-.9-.4-.3-.7-.5-1.1-.8-.8-.7-1.5-1.4-2.1-2.2-.9-1.1-1.6-2.4-2.1-3.7-.9-2.3-1.3-4.8-1.2-7.5.8-.4 1.6-.6 2.4-.6h.6c-.2 2.4.1 4.6.8 6.6 1 2.8 2.9 5.1 5.5 6.6l7.4 4.3c.2-.1.4-.2.6-.4 1.9-1.3 5.3-4.1 7.3-7.6 2.2-3.9 2.8-8.9 3-10.8L38.8 19c.3-1 .4-2.1.5-3.2L45 19z"],["class","st0"]]),Ob([["d","M36.3 4.1v10.3c0 .5 0 1.1-.1 1.6s-.1.9-.2 1.3c-.2 1-.5 2-.9 3-.5 1.3-1.3 2.6-2.2 3.7-1.5 1.9-3.5 3.6-5.9 4.8-.9-.6-1.6-1.3-2-2.4 2.1-1 3.9-2.3 5.2-4 1.9-2.3 3-5.1 3-8.1V5.9l-.6-.3c-2-1-6.1-2.6-10.1-2.6-4.5 0-9.1 2-10.9 2.9v3.6c-1 .3-2 .7-3 1.1V4.1l.8-.4C9.7 3.5 16 0 22.5 0s12.8 3.5 13.1 3.6l.7.5z"],["class","st0"]]),Ob([["d","M10.5 16.5l-7.4 4.3v.7c.2 2.1.9 6.5 2.9 10 2.2 3.9 6.2 6.9 7.9 8l3.1-1.8c.8.7 1.6 1.4 2.5 2L13.8 43l-.8-.5c-.3-.2-6.4-3.9-9.7-9.5C.1 27.4 0 20.2 0 19.9V19l1.3-.8L9 13.9c.5-.3.9-.5 1.4-.7.4-.2.8-.4 1.3-.5 1-.4 2-.6 3-.7 1.4-.2 2.9-.2 4.3 0 2.4.3 4.8 1.2 7.1 2.7 0 1-.4 2-1 2.9-1.9-1.3-4-2.2-6-2.5-3.1-.6-6-.1-8.6 1.4z"],["class","st0"]]),Nb([Ob([["d","M73.9 23c.9 1 1.3 2.3 1.3 3.7 0 1.9-.6 3.4-1.9 4.5-1.3 1.1-3.1 1.7-5.5 1.7h-8.6v-23h8.4c2.3 0 4.1.5 5.3 1.5 1.2 1 1.8 2.4 1.8 4.2 0 1.5-.4 2.7-1.2 3.6-.8.9-1.8 1.5-3.1 1.8 1.5.3 2.6 1 3.5 2zm-11.7-3h5c1.5 0 2.6-.3 3.4-1 .8-.7 1.2-1.6 1.2-2.8 0-1.2-.4-2.1-1.1-2.8-.8-.7-1.9-1-3.5-1h-4.8V20zm8.7 9.4c.9-.7 1.3-1.7 1.3-3s-.4-2.3-1.3-3c-.9-.7-2.1-1.1-3.7-1.1h-5v8.2h5c1.6-.1 2.8-.4 3.7-1.1zM95.3 24.6H81c.1 2.1.6 3.6 1.7 4.6s2.4 1.5 4 1.5c1.4 0 2.6-.4 3.6-1.1 1-.7 1.6-1.7 1.8-2.9h3.2c-.2 1.2-.7 2.4-1.5 3.3-.8 1-1.7 1.7-2.9 2.3-1.2.5-2.6.8-4.1.8-1.7 0-3.2-.4-4.6-1.1-1.3-.7-2.4-1.8-3.1-3.2-.8-1.4-1.1-3-1.1-4.9 0-1.9.4-3.5 1.1-4.9.8-1.4 1.8-2.5 3.1-3.2 1.3-.7 2.9-1.1 4.6-1.1 1.7 0 3.3.4 4.6 1.1 1.3.7 2.3 1.7 3 3 .7 1.2 1 2.6 1 4.1.1.7 0 1.2-.1 1.7zm-3.5-4.8c-.5-.9-1.2-1.6-2.1-2-.9-.4-1.8-.7-2.8-.7-1.6 0-3 .5-4.1 1.5-1.1 1-1.7 2.5-1.8 4.5h11.5c0-1.3-.2-2.4-.7-3.3zM111.2 16c1.2.9 2.1 2 2.5 3.5V15h3v18h-3v-4.6c-.5 1.5-1.3 2.6-2.5 3.5-1.2.9-2.7 1.3-4.4 1.3-1.6 0-3-.4-4.3-1.1-1.2-.7-2.2-1.8-2.9-3.2-.7-1.4-1.1-3-1.1-4.9 0-1.9.4-3.5 1.1-4.9.7-1.4 1.7-2.5 2.9-3.2 1.2-.7 2.7-1.1 4.3-1.1 1.7-.1 3.1.4 4.4 1.2zm-8 3.1c-1.1 1.2-1.7 2.8-1.7 4.8 0 2.1.5 3.7 1.7 4.8 1.1 1.2 2.6 1.8 4.4 1.8 1.2 0 2.2-.3 3.2-.8.9-.5 1.7-1.3 2.2-2.3.5-1 .8-2.1.8-3.5 0-1.3-.3-2.5-.8-3.5s-1.2-1.8-2.2-2.3c-.9-.5-2-.8-3.2-.8-1.9.1-3.3.7-4.4 1.8zM135 16.6c1.5 1.2 2.4 2.9 2.8 4.9h-3.1c-.2-1.3-.8-2.3-1.8-3-1-.7-2.2-1.1-3.6-1.1-1 0-2 .2-2.9.7-.9.5-1.6 1.2-2.1 2.2-.5 1-.8 2.2-.8 3.7s.3 2.7.8 3.7 1.2 1.7 2.1 2.2c.9.5 1.8.7 2.9.7 1.4 0 2.6-.4 3.6-1.1 1-.7 1.6-1.8 1.8-3h3.1c-.3 2.1-1.3 3.7-2.8 4.9-1.5 1.2-3.4 1.8-5.7 1.8-1.7 0-3.2-.4-4.6-1.1-1.3-.7-2.4-1.8-3.1-3.2-.8-1.4-1.1-3-1.1-4.9 0-1.9.4-3.5 1.1-4.9.8-1.4 1.8-2.5 3.1-3.2 1.3-.7 2.9-1.1 4.6-1.1 2.3-.1 4.2.6 5.7 1.8zM154.5 15.9c1.4.7 2.4 1.8 3.2 3.2.8 1.4 1.2 3 1.2 4.9 0 1.9-.4 3.5-1.2 4.9-.8 1.4-1.8 2.4-3.2 3.2-1.4.7-2.9 1.1-4.6 1.1-1.7 0-3.3-.4-4.6-1.1-1.4-.7-2.4-1.8-3.2-3.2-.8-1.4-1.2-3-1.2-4.9 0-1.9.4-3.5 1.2-4.9.8-1.4 1.9-2.5 3.2-3.2 1.4-.7 2.9-1.1 4.6-1.1 1.7-.1 3.2.3 4.6 1.1zm-7.6 2.2c-.9.5-1.6 1.2-2.2 2.2-.6 1-.8 2.2-.8 3.7 0 1.4.3 2.7.8 3.6.6 1 1.3 1.7 2.2 2.2.9.5 1.9.7 3 .7s2.1-.2 3-.7c.9-.5 1.6-1.2 2.2-2.2.6-1 .8-2.2.8-3.6 0-1.5-.3-2.7-.8-3.7-.6-1-1.3-1.7-2.2-2.2-.9-.5-1.9-.7-3-.7s-2.1.2-3 .7zM177.3 16.7c1.3 1.3 1.9 3.3 1.9 5.8v10.4h-3V22.8c0-1.8-.5-3.2-1.4-4.1-.9-1-2.2-1.4-3.7-1.4-1.6 0-2.9.5-3.9 1.6s-1.5 2.6-1.5 4.6V33h-3V15h3v4.3c.5-1.5 1.3-2.6 2.4-3.4 1.2-.8 2.5-1.2 4-1.2 2.2 0 3.9.6 5.2 2z"],["class","st1"]])])]),Pb("div",["beacon-modal__close__wrapper"],[["id",`beacon-alert-${e}-close`]],[Pb("div",["beacon-modal__close__icon"],[],[Pb("div",["beacon-modal__close__line1"],[],[]),Pb("div",["beacon-modal__close__line2"],[],[])])])]),Pb("div",["beacon-modal__base"],[],[Pb("div",[],[["id","beacon-modal__content"]],[Pb("div",[],[],[Pb("p",["beacon-alert__title"],[],t),...r,Pb("div",["beacon-action__container"],[],n)])])])])]);var Wb=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let qb,Kb;"undefined"!=typeof window&&void 0!==window.document&&(Kb=window.document);const Xb={},Yb=e=>(C_.postMessage(`closeAlert-${e}`),new Promise((t=>{var n;const r=Kb.getElementById(`beacon-alert-wrapper-${e}`);if(!r)return t();const i=null===(n=r.shadowRoot)||void 0===n?void 0:n.getElementById(`beacon-alert-modal-${e}`);if(i){const n=300,o=Xb[e];o&&(clearTimeout(o),Xb[e]=void 0),i.className=i.className.replace("fadeIn","fadeOut"),window.setTimeout((()=>{const e=r.parentNode;e&&e.removeChild(r),qb&&qb.focus(),t()}),n)}else t()}))),Jb=()=>Wb(void 0,void 0,void 0,(function*(){return new Promise((e=>Wb(void 0,void 0,void 0,(function*(){const t=Kb.querySelectorAll('[id^="beacon-alert-wrapper-"]');if(t.length>0){const n=[];t.forEach((e=>Wb(void 0,void 0,void 0,(function*(){n.push(e.id.split("-")[3])})))),yield Promise.all(n.map(Yb)),e()}else e()}))))})),Zb=e=>Wb(void 0,void 0,void 0,(function*(){var t,n;const r=e.body,i=e.data,o=e.title,s=e.timer,a=e.pairingPayload,l=e.disclaimerText,c=e.closeButtonCallback;yield Jb();const u=(yield S_()).split("-").join(""),h=Kb.createElement("div");h.setAttribute("id",`beacon-alert-wrapper-${u}`);const d=h.attachShadow({mode:"open"}),p=Kb.createElement("div");p.setAttribute("tabindex","0"),d.appendChild(p);const f=[...null!==(n=null===(t=e.buttons)||void 0===t?void 0:t.map((e=>{var t,n;return{text:e.text,actionCallback:null!==(t=e.actionCallback)&&void 0!==t?t:()=>Promise.resolve(),style:null!==(n=e.style)&&void 0!==n?n:"outline"}})))&&void 0!==n?n:[]];let m=a?"string"==typeof r?Pb("div",[],[["id","beacon--qr__container"]],[Pb("div",[],[["id","beacon--qr__copy__container"]],[Pb("button",["beacon-modal__button--outline"],[["id","beacon--qr__copy"]],"Copy")])]):Pb("span",[],[],""):Pb("span",[],[],null!=r?r:"");i&&(m=Pb("span",[],[],[m,Pb("pre",[],[["style","text-align: left"]],i)]));const{style:g,html:y}=((e,t,n,r,i)=>{const o=n,s=r.map(((t,n)=>Pb("button",["beacon-modal__button"+("outline"===t.style?"--outline":"")],[["id",`beacon-alert-${e}-${n}`]],t.text)));let a=lb;i&&(a+=cb);const l=Pb("span",[],[],o),c=i?((e,t,n,r)=>jb(e,t,n,[Pb("span",[],[["id","pairing-container"]],""),Pb("div",["beacon-alert__text"],[["id","beacon-main-text"]],[Pb("p",["beacon-list__title"],[["id","beacon-title"]],[document.createTextNode("Scan QR code with a Beacon-compatible wallet."),Pb("a",[],[["href","https://docs.walletbeacon.io/supported-wallets"],["target","_blank"]],"Learn more"),...r])]),Pb("div",[],[["id","beacon--switch__container"]],[Pb("button",["beacon-modal__button--outline"],[["id","beacon-switch"]],"")]),Pb("div",[],[["id","beacon--disclaimer"]],"")]))(e,[l],s,[t]):((e,t,n,r)=>jb(e,t,n,[Pb("div",["beacon-alert__text"],[["id","beacon-main-text"]],r)]))(e,[l],s,[t]);return{style:a,html:c}})(u,m,o,f,!!(null==a?void 0:a.p2pSyncCode));p.appendChild(y);const v=Kb.createElement("style");v.textContent=g,d.appendChild(v),s&&(Xb[u]=window.setTimeout((()=>Wb(void 0,void 0,void 0,(function*(){yield Yb(u)}))),s)),Kb.body.prepend(h);const _=d.getElementById(`beacon-alert-${u}-close`),w=()=>Wb(void 0,void 0,void 0,(function*(){c&&c(),yield Yb(u)}));if(l){const e=d.getElementById("beacon--disclaimer");e&&(e.innerText=l)}const b=Vb(),x=d.getElementById(`beacon-alert-modal-${u}`);x&&(x.classList.add(`theme__${b}`),x.addEventListener("click",w));const E=d.querySelectorAll(".beacon-modal__wrapper");return E.length>0&&E[0].addEventListener("click",(e=>{e.stopPropagation()})),qb=Kb.activeElement,p.focus(),f.forEach(((e,t)=>{const n=d.getElementById(`beacon-alert-${u}-${t}`);n&&n.addEventListener("click",(()=>Wb(void 0,void 0,void 0,(function*(){yield Yb(u),e.actionCallback&&(yield e.actionCallback())}))))})),_&&_.addEventListener("click",(()=>Wb(void 0,void 0,void 0,(function*(){yield w()})))),window.addEventListener("keydown",(e=>Wb(void 0,void 0,void 0,(function*(){"Escape"===e.key&&(yield w())})))),a&&(yield Fb(u,d,a)),u})),Qb=":host {\n  --animation-duration: 300ms;\n  all: initial;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes fadeOut {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n\n.animated {\n  animation-duration: var(--animation-duration);\n  animation-fill-mode: both;\n}\n\n.fadeIn {\n  animation-name: fadeIn;\n}\n\n.fadeOut {\n  animation-name: fadeOut;\n}\n\n.beacon-toast__base {\n  position: fixed;\n  top: 16px;\n  right: 16px;\n  z-index: 2147483000;\n  margin: 0 auto;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.1);\n  flex-direction: column;\n}\n@media (max-width: 576px) {\n  .beacon-toast__base {\n    top: 8px;\n    right: 8px;\n    left: 8px;\n  }\n  .beacon-toast__wallet__outer {\n    flex-wrap: wrap;\n  }\n  .beacon-toast__wallet__link {\n    display: flex;\n    margin-left: 12px !important;\n  }\n}\n\n.theme__light.beacon-toast__base {\n  background: #fff;\n}\n\n.theme__dark.beacon-toast__base {\n  background: #27334c;\n}\n\n.theme__dark p {\n  color: #6183ff;\n}\n\na {\n  text-decoration: none;\n  color: #3880ff;\n}\n\na svg {\n  width: 12px;\n  margin-left: 2px;\n}\n\na:visited {\n  color: #3880ff;\n}\n\nhr {\n  height: 1px;\n  color: rgba(0, 0, 0, 0.12);\n  background-color: rgba(0, 0, 0, 0.12);\n  border: none;\n  width: 100%;\n  margin: 0;\n  display: none;\n}\n\n.show {\n  display: block !important;\n}\n\n.hide {\n  display: none !important;\n}\n\n#beacon-toast-list {\n  display: none;\n}\n\n.beacon-toast__upside_down {\n  transform: rotate(180deg);\n}\n\n.beacon-toast__content {\n  justify-content: space-between;\n  min-height: 56px;\n  height: 0;\n}\n\n.beacon-toast__action__item,\n.beacon-toast__powered a,\n.beacon-toast__wallet__container,\n#beacon-text,\n.beacon-toast__action__item p,\n.beacon-toast__wallet__outer {\n  align-items: center;\n}\n\n.beacon-toast__content,\n.beacon-toast__base,\n.beacon-toast__action__item,\n.beacon-toast__powered a,\n#beacon-text,\n.beacon-toast__wallet__container,\n.beacon-toast__wallet__outer {\n  display: flex;\n}\n\n.beacon-toast__content,\n.beacon-toast__action__item,\n.beacon-toast__powered a {\n  padding: 0 16px;\n  font-family: Roboto, Helvetica, sans-serif;\n}\n\n#beacon-text strong {\n  display: contents;\n}\n.beacon-toast__wallet__link {\n  margin-left: 8px;\n}\n.beacon-toast__wallet__link svg {\n  margin-left: 4px;\n}\n.beacon-toast__powered a {\n  margin: 4px 0 12px;\n  font-size: 12px;\n  opacity: 0.64;\n}\n\n.beacon-toast__powered svg {\n  width: 20px;\n  height: 20px;\n  margin: 0 2px 0 4px;\n}\n\n.beacon-toast__action__item {\n  font-size: 14px;\n  max-width: 40ch;\n}\n\n.beacon-toast__action__item p {\n  margin-right: 8px;\n}\n\n.beacon-toast__action__item__subtitle,\n.beacon-toast__powered a {\n  min-width: 88px;\n  color: rgba(0, 0, 0, 0.54);\n}\n\n.theme__dark .beacon-toast__powered a {\n  color: #7c99d6;\n}\n\n.beacon-toast__content__img {\n  width: 24px;\n  height: 24px;\n  margin-right: 4px;\n  image-rendering: -moz-crisp-edges; /* Firefox */\n  image-rendering: -o-crisp-edges; /* Opera */\n  image-rendering: -webkit-optimize-contrast; /* Webkit (non-standard naming) */\n  image-rendering: crisp-edges;\n  -ms-interpolation-mode: nearest-neighbor; /* IE (non-standard property) */\n}\n\n.beacon-toast__more {\n  width: 14px;\n  transition: transform 0.5s;\n}\n\na,\n.beacon-toast__more {\n  cursor: pointer;\n}\n\na:hover {\n  opacity: 0.64;\n}\n\n.theme__dark .beacon-toast__more {\n  color: #7c99d6;\n}\n\n.beacon-toast__more--action {\n  margin: 8px 0;\n}\n\n#beacon-text {\n  padding-right: 24px;\n}\n\n#beacon-text-content {\n  display: flex;\n  align-items: center;\n}\n\n.progress-line,\n.progress-line:before {\n  height: 3px;\n  width: 100%;\n  margin: 0;\n}\n.progress-line {\n  background-color: #a7c4f7;\n  display: -webkit-flex;\n  display: flex;\n}\n.progress-line:before {\n  background-color: #3880ff;\n  content: '';\n  -webkit-animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n  animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n}\n@-webkit-keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n@keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n";var $b=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let ex,tx,nx,rx;"undefined"!=typeof window&&void 0!==window.document&&(ex=window.document);const ix=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},ox=e=>{var t,n;const r=null===(t=null==rx?void 0:rx.walletInfo)||void 0===t?void 0:t.icon,i=null===(n=null==rx?void 0:rx.walletInfo)||void 0===n?void 0:n.name;let o;const s=Pb("strong",[],[],null!=i?i:"Wallet");o=r?Pb("span",["beacon-toast__wallet__container"],[],[Pb("img",["beacon-toast__content__img"],[["src",r]],""),s]):s;const a=e.split("{{wallet}}");if(1===a.length)return[Pb("span",[],[],e)];{const e=[];for(let t=0;t<a.length;t++)e.push(Pb("span",[],[],a[t])),t<a.length-1&&e.push(o);return e}},sx=()=>new Promise((e=>{var t;rx=void 0;const n=ex.getElementById("beacon-toast-wrapper");if(!n)return e();const r=null===(t=n.shadowRoot)||void 0===t?void 0:t.getElementById("beacon-toast");if(r){const t=300;tx&&(clearTimeout(tx),tx=void 0),r.className=r.className.replace("fadeIn","fadeOut"),window.setTimeout((()=>{const t=n.parentNode;t&&t.removeChild(n),e()}),t)}else e()})),ax=(e,t,n)=>{const r=e.getElementById(t);return r&&r.addEventListener("click",(()=>$b(void 0,void 0,void 0,(function*(){yield n(r)})))),r},lx=(e,t)=>{const n=e.getElementById(t);n&&(n.classList.remove("hide"),n.classList.add("show"))},cx=(e,t)=>{const n=e.getElementById(t);n&&(n.classList.add("hide"),n.classList.remove("show"))},ux=e=>{lx(e,"beacon-toast-button-close"),cx(e,"beacon-toast-button-expand")},hx=e=>{const t=e.getElementById("beacon-toast-button-expand"),n=e.getElementById("beacon-toast-list");t&&n&&(t.classList.remove("beacon-toast__upside_down"),n.classList.add("hide"),n.classList.remove("show"))},dx=e=>{const t=e.getElementById("beacon-toast-button-expand"),n=e.getElementById("beacon-toast-list");t&&n&&(t.classList.add("beacon-toast__upside_down"),n.classList.remove("hide"),n.classList.add("show"))},px=e=>{const t=e.getElementById("beacon-toast-button-expand"),n=e.getElementById("beacon-toast-list");t&&n&&(t.classList.contains("beacon-toast__upside_down")?hx(e):dx(e))},fx=(e,t,n)=>$b(void 0,void 0,void 0,(function*(){const r=t.actions;if(r&&r.length>0){const t=r.map((e=>$b(void 0,void 0,void 0,(function*(){return t=e,$b(void 0,void 0,void 0,(function*(){const{text:e,isBold:n,actionText:r,actionLogo:i,actionCallback:o}=t,s=yield S_(),a=ex.createElement("div");a.classList.add("beacon-toast__action__item"),ix(a);const l=e=>Pb("strong",[],[],e);if(o){e.length>0&&a.appendChild(Pb("p",[],[],e));const t=Pb("span",[],[],[Pb("span",[],[],r),i&&"external"===i?Ib(["svg-inline--fa","fa-external-link-alt","fa-w-16"],[["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","external-link-alt"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 512 512"]],[Ob([["fill","currentColor"],["d","M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"]])]):void 0]);a.appendChild(Pb("p",[],[],[Pb("a",[],[["id",s]],[n?l([t]):t])]))}else if(r){e.length>0&&a.appendChild(Pb("p",["beacon-toast__action__item__subtitle"],[],e));const t=Pb("span",[],[],r);a.appendChild(Pb("p",[],[],[n?l([t]):t]))}else{const t=Pb("p",[],[],e);a.appendChild(n?l([t]):t)}return o&&a.addEventListener("click",o),a}));var t}))));(yield Promise.all(t)).forEach((e=>n.appendChild(e)));const i=ex.createElement("small");i.classList.add("beacon-toast__powered"),i.appendChild(Pb("a",[],[["href","https://walletbeacon.io"],["target","_blank"]],[document.createTextNode("powered by"),Ib([],[["id","f63e95a9-fd19-4487-bc1a-09eb2f066704"],["data-name","Guides"],["xmlns","http://www.w3.org/2000/svg"],["width","65"],["height","65"],["viewBox","0 0 65 65"]],[Pb("title",[],[],"beacon_logo"),Ob([["fill","currentColor"],["d","M59.66,29.52v1.06c0,.37-.18,9.07-4.11,15.88S44.16,57.75,43.84,57.93l-.91.54-1.61-.93-9.19-5.3a14.68,14.68,0,0,1-1.63-1.06h0a14.09,14.09,0,0,1-1.29-1,17.63,17.63,0,0,1-2.56-2.7,18.58,18.58,0,0,1-2.56-4.51,21.53,21.53,0,0,1-1.5-9,6.21,6.21,0,0,1,2.93-.73c.25,0,.49,0,.74,0a18.29,18.29,0,0,0,1,7.93,15.06,15.06,0,0,0,6.67,8l8.93,5.16c.2-.13.43-.3.68-.48,2.26-1.6,6.42-4.92,8.86-9.13C55.12,39.94,55.8,34,56,31.57l-3.79-2.19a23,23,0,0,0,.6-3.83Z"]]),Ob([["fill","currentColor"],["d","M49.22,11.43V23.89c0,.65,0,1.3-.1,1.94v0c-.06.55-.13,1.1-.24,1.63A18,18,0,0,1,47.82,31a19.11,19.11,0,0,1-2.62,4.49,21.37,21.37,0,0,1-7.07,5.8,6.08,6.08,0,0,1-2.42-2.84A18.1,18.1,0,0,0,42,33.7h0a15.12,15.12,0,0,0,3.58-9.81V13.6c-.21-.11-.47-.21-.74-.35-2.52-1.16-7.47-3.1-12.36-3.1-5.42,0-11,2.4-13.08,3.45V18a22.54,22.54,0,0,0-3.63,1.38V11.43l.92-.52c.33-.18,8-4.38,15.79-4.38s15.48,4.2,15.8,4.38Z"]]),Ob([["fill","currentColor"],["d","M18,26.4,9,31.55q0,.35.06.78a31.63,31.63,0,0,0,3.49,12.28c2.71,4.71,7.55,8.3,9.53,9.64l3.79-2.19a23.33,23.33,0,0,0,3,2.44l-6.88,4-.92-.54c-.31-.18-7.75-4.69-11.68-11.5S5.36,30.92,5.35,30.56V29.49L7,28.55l9.17-5.29c.57-.32,1.14-.61,1.72-.87a13.46,13.46,0,0,1,1.55-.61A17.52,17.52,0,0,1,23,20.91a19.2,19.2,0,0,1,5.19,0,21.49,21.49,0,0,1,8.55,3.24,6.29,6.29,0,0,1-1.25,3.51,17.9,17.9,0,0,0-7.3-3.06A15.14,15.14,0,0,0,18,26.4Z"]])]),document.createTextNode("Beacon")])),n.appendChild(i),(e=>{lx(e,"beacon-toast-button-expand"),cx(e,"beacon-toast-button-close")})(e)}else ux(e),hx(e)})),mx=e=>$b(void 0,void 0,void 0,(function*(){rx=e;const t=e.timer,n=ex.createElement("div");n.setAttribute("id","beacon-toast-wrapper");const r=n.attachShadow({mode:"open"}),i=ex.createElement("div"),{style:o,html:s}=(e=>{const t=e.body,n=ox(t),r=(e=>Pb("div",["beacon-toast__base","animated","fadeIn"],[["id","beacon-toast"]],[Pb("div",["beacon-toast__content"],[],[Pb("span",[],[["id","beacon-text"]],[Pb("p",[],[["id","beacon-text-content"]],e),Pb("a",["beacon-toast__wallet__link"],[["id","beacon-open-wallet"]],[Pb("span",[],[],"Open"),Ib(["svg-inline--fa","fa-external-link-alt","fa-w-16"],[["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","external-link-alt"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 512 512"]],[Ob([["fill","currentColor"],["d","M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"]])])])]),Ib(["beacon-toast__more","svg-inline--fa","fa-angle-down","fa-w-10"],[["id","beacon-toast-button-expand"],["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","angle-down"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 320 512"]],[Ob([["fill","currentColor"],["d","M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"]])]),Ib(["beacon-toast__more","svg-inline--fa","fa-times","fa-w-10"],[["id","beacon-toast-button-close"],["aria-hidden","true"],["focusable","false"],["data-prefix","fal"],["data-icon","times"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 320 512"]],[Ob([["fill","currentColor"],["d","M193.94 256L296.5 153.44l21.15-21.15c3.12-3.12 3.12-8.19 0-11.31l-22.63-22.63c-3.12-3.12-8.19-3.12-11.31 0L160 222.06 36.29 98.34c-3.12-3.12-8.19-3.12-11.31 0L2.34 120.97c-3.12 3.12-3.12 8.19 0 11.31L126.06 256 2.34 379.71c-3.12 3.12-3.12 8.19 0 11.31l22.63 22.63c3.12 3.12 8.19 3.12 11.31 0L160 289.94 262.56 392.5l21.15 21.15c3.12 3.12 8.19 3.12 11.31 0l22.63-22.63c3.12-3.12 3.12-8.19 0-11.31L193.94 256z"]])])]),Pb("div",["progress-line"],[["id","beacon-toast-loader"]],""),Pb("hr",["hide"],[["id","beacon-toast-loader-placeholder"]],""),Pb("div",["beacon-toast__more--action"],[["id","beacon-toast-list"]],"")]))([Pb("span",["beacon-toast__wallet__outer"],[],n)]);return{style:Qb,html:r}})(e);i.appendChild(s);const a=ex.createElement("style");a.textContent=o,r.appendChild(i),r.appendChild(a),t&&(tx=window.setTimeout((()=>$b(void 0,void 0,void 0,(function*(){yield sx()}))),t)),ex.body.prepend(n);const l=Vb(),c=r.getElementById("beacon-toast");c&&c.classList.add(`theme__${l}`);const u=r.getElementById("beacon-toast-list");u&&(yield fx(r,e,u));const h=r.getElementById("beacon-open-wallet");h&&(e.openWalletAction?h.addEventListener("click",(()=>{e.openWalletAction&&e.openWalletAction()})):h.classList.add("hide")),"loading"===rx.state&&(nx=window.setTimeout((()=>$b(void 0,void 0,void 0,(function*(){const e=r.getElementById("beacon-toast-button-expand");e&&!e.classList.contains("beacon-toast__upside_down")&&px(r)}))),5e3)),ax(r,"beacon-toast-button-done",(()=>$b(void 0,void 0,void 0,(function*(){yield sx()}))));const d=ax(r,"beacon-toast-button-close",(()=>$b(void 0,void 0,void 0,(function*(){yield sx()}))));d&&"loading"===rx.state&&d.classList.add("hide"),ax(r,"beacon-toast-button-expand",(()=>$b(void 0,void 0,void 0,(function*(){px(r)}))))})),gx=e=>$b(void 0,void 0,void 0,(function*(){var t;if(nx&&clearTimeout(nx),ex.getElementById("beacon-toast-wrapper")?e.forceNew?(yield sx(),yield mx(e)):yield(e=>$b(void 0,void 0,void 0,(function*(){rx=Object.assign(Object.assign({},rx),e);const t=e.timer,n=ex.getElementById("beacon-toast-wrapper");if(!n)return;const r=n.shadowRoot;if(!r)return;const i=r.getElementById("beacon-toast-list");i&&(ix(i),yield fx(r,e,i)),"loading"===rx.state&&(nx=window.setTimeout((()=>$b(void 0,void 0,void 0,(function*(){const e=r.getElementById("beacon-toast-button-expand");e&&!e.classList.contains("beacon-toast__upside_down")&&px(r)}))),5e3));const o=r.getElementById("beacon-text-content");o&&(ix(o),o.appendChild(Pb("span",["beacon-toast__wallet__outer"],[],ox(e.body))));const s=r.getElementById("beacon-open-wallet");s&&(e.openWalletAction?(s.classList.remove("hide"),s.addEventListener("click",(()=>{e.openWalletAction&&e.openWalletAction()}))):s.classList.add("hide")),t&&(tx=window.setTimeout((()=>$b(void 0,void 0,void 0,(function*(){yield sx()}))),t));const a=r.getElementById("beacon-toast-button-done");a&&a.addEventListener("click",(()=>$b(void 0,void 0,void 0,(function*(){yield sx()}))))})))(e):yield mx(e),rx&&"finished"===rx.state){const e=null===(t=ex.getElementById("beacon-toast-wrapper"))||void 0===t?void 0:t.shadowRoot;e&&((e=>{cx(e,"beacon-toast-loader"),lx(e,"beacon-toast-loader-placeholder")})(e),ux(e),dx(e))}})),yx=e=>e.length>=12?`${e.substr(0,5)}...${e.substr(-5)}`:e;var vx=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const _x=new F_("BeaconEvents"),wx=5e3;var bx;!function(e){e.PERMISSION_REQUEST_SENT="PERMISSION_REQUEST_SENT",e.PERMISSION_REQUEST_SUCCESS="PERMISSION_REQUEST_SUCCESS",e.PERMISSION_REQUEST_ERROR="PERMISSION_REQUEST_ERROR",e.OPERATION_REQUEST_SENT="OPERATION_REQUEST_SENT",e.OPERATION_REQUEST_SUCCESS="OPERATION_REQUEST_SUCCESS",e.OPERATION_REQUEST_ERROR="OPERATION_REQUEST_ERROR",e.SIGN_REQUEST_SENT="SIGN_REQUEST_SENT",e.SIGN_REQUEST_SUCCESS="SIGN_REQUEST_SUCCESS",e.SIGN_REQUEST_ERROR="SIGN_REQUEST_ERROR",e.BROADCAST_REQUEST_SENT="BROADCAST_REQUEST_SENT",e.BROADCAST_REQUEST_SUCCESS="BROADCAST_REQUEST_SUCCESS",e.BROADCAST_REQUEST_ERROR="BROADCAST_REQUEST_ERROR",e.ACKNOWLEDGE_RECEIVED="ACKNOWLEDGE_RECEIVED",e.LOCAL_RATE_LIMIT_REACHED="LOCAL_RATE_LIMIT_REACHED",e.NO_PERMISSIONS="NO_PERMISSIONS",e.ACTIVE_ACCOUNT_SET="ACTIVE_ACCOUNT_SET",e.ACTIVE_TRANSPORT_SET="ACTIVE_TRANSPORT_SET",e.SHOW_PREPARE="SHOW_PREPARE",e.HIDE_UI="HIDE_UI",e.PAIR_INIT="PAIR_INIT",e.PAIR_SUCCESS="PAIR_SUCCESS",e.CHANNEL_CLOSED="CHANNEL_CLOSED",e.INTERNAL_ERROR="INTERNAL_ERROR",e.UNKNOWN="UNKNOWN"}(bx||(bx={}));const xx=e=>vx(void 0,void 0,void 0,(function*(){let t;const n=[];if(e.walletInfo.deeplink&&("web"===e.walletInfo.type||"mobile"===e.walletInfo.type&&hb(window)||"desktop"===e.walletInfo.type&&!hb(window))){const n=e.walletInfo.deeplink;t=()=>vx(void 0,void 0,void 0,(function*(){const e=document.createElement("a");e.setAttribute("href",n),e.setAttribute("target","_blank"),e.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))}))}n.push({text:"No answer from your wallet received yet. Please make sure the wallet is open.",isBold:!0}),n.push({text:"Did you make a mistake?",actionText:"Cancel Request",actionCallback:()=>vx(void 0,void 0,void 0,(function*(){yield sx()}))}),n.push({text:"Wallet not receiving request?",actionText:"Reset Connection",actionCallback:()=>vx(void 0,void 0,void 0,(function*(){yield sx();const t=e.extraInfo.resetCallback;t&&(_x.log("showSentToast","resetCallback invoked"),yield t())}))}),gx({body:"Request sent to {{wallet}}",walletInfo:e.walletInfo,state:"loading",actions:n,openWalletAction:t}).catch((e=>console.error(e)))})),Ex=(e,t)=>vx(void 0,void 0,void 0,(function*(){const n=e.errorResponse.errorType?j_.getError(e.errorResponse.errorType,e.errorResponse.errorData):new $_,r=[{text:n.title,isBold:!0},{text:n.description}];e.errorResponse.errorType===m_.TRANSACTION_INVALID_ERROR&&e.errorResponse.errorData&&r.push({text:"",actionText:"Show Details",actionCallback:()=>vx(void 0,void 0,void 0,(function*(){yield sx(),yield Zb({title:n.title,body:n.fullDescription.description,data:n.fullDescription.data,buttons:t})}))}),yield gx({body:"{{wallet}} has returned an error",timer:e.errorResponse.errorType===m_.ABORTED_ERROR?wx:void 0,state:"finished",walletInfo:e.walletInfo,actions:r})})),Sx=()=>()=>vx(void 0,void 0,void 0,(function*(){})),Mx={[bx.PERMISSION_REQUEST_SENT]:xx,[bx.PERMISSION_REQUEST_SUCCESS]:e=>vx(void 0,void 0,void 0,(function*(){const{output:t}=e;yield gx({body:"{{wallet}} has granted permission",timer:wx,walletInfo:e.walletInfo,state:"finished",actions:[{text:"Address",actionText:yx(t.address),isBold:!0},{text:"Network",actionText:`${t.network.type}`},{text:"Permissions",actionText:t.scopes.join(", ")}]})})),[bx.PERMISSION_REQUEST_ERROR]:Ex,[bx.OPERATION_REQUEST_SENT]:xx,[bx.OPERATION_REQUEST_SUCCESS]:e=>vx(void 0,void 0,void 0,(function*(){const{account:t,output:n,blockExplorer:r}=e;yield gx({body:"{{wallet}} successfully submitted operation",timer:wx,state:"finished",walletInfo:e.walletInfo,actions:[{text:yx(n.transactionHash),isBold:!0,actionText:"Open Blockexplorer",actionLogo:"external",actionCallback:()=>vx(void 0,void 0,void 0,(function*(){const e=yield r.getTransactionLink(n.transactionHash,t.network);window.open(e,"_blank"),yield sx()}))}]})})),[bx.OPERATION_REQUEST_ERROR]:Ex,[bx.SIGN_REQUEST_SENT]:xx,[bx.SIGN_REQUEST_SUCCESS]:e=>vx(void 0,void 0,void 0,(function*(){const t=e.output;yield gx({body:"{{wallet}} successfully signed payload",timer:wx,state:"finished",walletInfo:e.walletInfo,actions:[{text:`Signature: ${yx(t.signature)}`,actionText:"Copy to clipboard",actionCallback:()=>vx(void 0,void 0,void 0,(function*(){navigator.clipboard.writeText(t.signature).then((()=>{_x.log("showSignSuccessAlert","Copying to clipboard was successful!")}),(e=>{_x.error("showSignSuccessAlert","Could not copy text to clipboard: ",e)})),yield sx()}))}]})})),[bx.SIGN_REQUEST_ERROR]:Ex,[bx.BROADCAST_REQUEST_SENT]:xx,[bx.BROADCAST_REQUEST_SUCCESS]:e=>vx(void 0,void 0,void 0,(function*(){const{network:t,output:n,blockExplorer:r}=e;yield gx({body:"{{wallet}} successfully injected operation",timer:wx,state:"finished",walletInfo:e.walletInfo,actions:[{text:yx(n.transactionHash),isBold:!0,actionText:"Open Blockexplorer",actionLogo:"external",actionCallback:()=>vx(void 0,void 0,void 0,(function*(){const e=yield r.getTransactionLink(n.transactionHash,t);window.open(e,"_blank"),yield sx()}))}]})})),[bx.BROADCAST_REQUEST_ERROR]:Ex,[bx.ACKNOWLEDGE_RECEIVED]:e=>vx(void 0,void 0,void 0,(function*(){gx({body:"Awaiting confirmation in {{wallet}}",state:"acknowledge",walletInfo:e.walletInfo}).catch((e=>console.error(e)))})),[bx.LOCAL_RATE_LIMIT_REACHED]:()=>vx(void 0,void 0,void 0,(function*(){Zb({title:"Error",body:"Rate limit reached. Please slow down",buttons:[{text:"Done",style:"outline"}],timer:3e3}).catch((e=>console.error(e)))})),[bx.NO_PERMISSIONS]:()=>vx(void 0,void 0,void 0,(function*(){yield Zb({title:"No Permission",body:"Please allow the wallet to handle this type of request."})})),[bx.ACTIVE_ACCOUNT_SET]:Sx(),[bx.ACTIVE_TRANSPORT_SET]:Sx(),[bx.SHOW_PREPARE]:e=>vx(void 0,void 0,void 0,(function*(){const t=e.walletInfo?"Preparing Request for {{wallet}}...":"Preparing Request...";gx({body:t,state:"prepare",walletInfo:e.walletInfo}).catch((e=>console.error(e)))})),[bx.HIDE_UI]:e=>vx(void 0,void 0,void 0,(function*(){e?(e.includes("alert")&&Jb(),e.includes("toast")&&sx()):sx()})),[bx.PAIR_INIT]:e=>vx(void 0,void 0,void 0,(function*(){const t={title:"Choose your preferred wallet",body:"<p></p>",pairingPayload:{p2pSyncCode:e.p2pPeerInfo,postmessageSyncCode:e.postmessagePeerInfo,preferredNetwork:e.preferredNetwork},closeButtonCallback:e.abortedHandler,disclaimerText:e.disclaimerText};yield Zb(t)})),[bx.PAIR_SUCCESS]:()=>vx(void 0,void 0,void 0,(function*(){yield Jb()})),[bx.CHANNEL_CLOSED]:()=>vx(void 0,void 0,void 0,(function*(){yield Zb({title:"Channel closed",body:"Your peer has closed the connection.",buttons:[{text:"Done",style:"outline"}],timer:1500})})),[bx.INTERNAL_ERROR]:e=>vx(void 0,void 0,void 0,(function*(){var t;const n=[...null!==(t=e.buttons)&&void 0!==t?t:[]];n.push({text:"Done",style:"outline"});const r={title:"Internal Error",body:e.text,buttons:n};yield Zb(r)})),[bx.UNKNOWN]:Sx()};class Tx{constructor(e={},t){this.callbackMap={[bx.PERMISSION_REQUEST_SENT]:[Mx.PERMISSION_REQUEST_SENT],[bx.PERMISSION_REQUEST_SUCCESS]:[Mx.PERMISSION_REQUEST_SUCCESS],[bx.PERMISSION_REQUEST_ERROR]:[Mx.PERMISSION_REQUEST_ERROR],[bx.OPERATION_REQUEST_SENT]:[Mx.OPERATION_REQUEST_SENT],[bx.OPERATION_REQUEST_SUCCESS]:[Mx.OPERATION_REQUEST_SUCCESS],[bx.OPERATION_REQUEST_ERROR]:[Mx.OPERATION_REQUEST_ERROR],[bx.SIGN_REQUEST_SENT]:[Mx.SIGN_REQUEST_SENT],[bx.SIGN_REQUEST_SUCCESS]:[Mx.SIGN_REQUEST_SUCCESS],[bx.SIGN_REQUEST_ERROR]:[Mx.SIGN_REQUEST_ERROR],[bx.BROADCAST_REQUEST_SENT]:[Mx.BROADCAST_REQUEST_SENT],[bx.BROADCAST_REQUEST_SUCCESS]:[Mx.BROADCAST_REQUEST_SUCCESS],[bx.BROADCAST_REQUEST_ERROR]:[Mx.BROADCAST_REQUEST_ERROR],[bx.ACKNOWLEDGE_RECEIVED]:[Mx.ACKNOWLEDGE_RECEIVED],[bx.LOCAL_RATE_LIMIT_REACHED]:[Mx.LOCAL_RATE_LIMIT_REACHED],[bx.NO_PERMISSIONS]:[Mx.NO_PERMISSIONS],[bx.ACTIVE_ACCOUNT_SET]:[Mx.ACTIVE_ACCOUNT_SET],[bx.ACTIVE_TRANSPORT_SET]:[Mx.ACTIVE_TRANSPORT_SET],[bx.SHOW_PREPARE]:[Mx.SHOW_PREPARE],[bx.HIDE_UI]:[Mx.HIDE_UI],[bx.PAIR_INIT]:[Mx.PAIR_INIT],[bx.PAIR_SUCCESS]:[Mx.PAIR_SUCCESS],[bx.CHANNEL_CLOSED]:[Mx.CHANNEL_CLOSED],[bx.INTERNAL_ERROR]:[Mx.INTERNAL_ERROR],[bx.UNKNOWN]:[Mx.UNKNOWN]},t&&this.setAllHandlers(),this.overrideDefaults(e)}on(e,t){return vx(this,void 0,void 0,(function*(){const n=this.callbackMap[e]||[];n.push(t),this.callbackMap[e]=n}))}emit(e,t,n){return vx(this,void 0,void 0,(function*(){const r=this.callbackMap[e];r&&r.length>0&&r.forEach((r=>vx(this,void 0,void 0,(function*(){try{yield r(t,n)}catch(t){_x.error(`error handling event ${e}`,t)}}))))}))}overrideDefaults(e){Object.keys(e).forEach((t=>{const n=t,r=e[n];r&&(this.callbackMap[n]=[r.handler])}))}setAllHandlers(e){Object.keys(this.callbackMap).forEach((t=>{const n=t;this.callbackMap[n]=[],e?this.callbackMap[n].push(e):this.callbackMap[n].push(((...e)=>{_x.log(t,...e)}))}))}}const Ax={[c_.BlockchainRequest]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.BlockchainResponse]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.PermissionRequest]:{sent:bx.PERMISSION_REQUEST_SENT,success:bx.PERMISSION_REQUEST_SUCCESS,error:bx.PERMISSION_REQUEST_ERROR},[c_.PermissionResponse]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.OperationRequest]:{sent:bx.OPERATION_REQUEST_SENT,success:bx.OPERATION_REQUEST_SUCCESS,error:bx.OPERATION_REQUEST_ERROR},[c_.OperationResponse]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.SignPayloadRequest]:{sent:bx.SIGN_REQUEST_SENT,success:bx.SIGN_REQUEST_SUCCESS,error:bx.SIGN_REQUEST_ERROR},[c_.SignPayloadResponse]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.BroadcastRequest]:{sent:bx.BROADCAST_REQUEST_SENT,success:bx.BROADCAST_REQUEST_SUCCESS,error:bx.BROADCAST_REQUEST_ERROR},[c_.BroadcastResponse]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.Acknowledge]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.Disconnect]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN},[c_.Error]:{sent:bx.UNKNOWN,success:bx.UNKNOWN,error:bx.UNKNOWN}};var Rx=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class Cx extends class{constructor(e){this.rpcUrls=e}getLinkForNetwork(e){return t=this,n=void 0,i=function*(){return this.rpcUrls[e.type]},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}}{constructor(e={[h_.MAINNET]:"https://tzkt.io",[h_.GHOSTNET]:"https://ghostnet.tzkt.io",[h_.MONDAYNET]:"https://mondaynet.tzkt.io",[h_.DAILYNET]:"https://dailynet.tzkt.io",[h_.DELPHINET]:"https://delphinet.tzkt.io",[h_.EDONET]:"https://edonet.tzkt.io",[h_.FLORENCENET]:"https://florencenet.tzkt.io",[h_.GRANADANET]:"https://granadanet.tzkt.io",[h_.HANGZHOUNET]:"https://hangzhounet.tzkt.io",[h_.ITHACANET]:"https://ithacanet.tzkt.io",[h_.JAKARTANET]:"https://jakartanet.tzkt.io",[h_.KATHMANDUNET]:"https://kathmandunet.tzkt.io",[h_.CUSTOM]:"https://kathmandunet.tzkt.io"}){super(e),this.rpcUrls=e}getAddressLink(e,t){return Rx(this,void 0,void 0,(function*(){return`${yield this.getLinkForNetwork(t)}/${e}`}))}getTransactionLink(e,t){return Rx(this,void 0,void 0,(function*(){return`${yield this.getLinkForNetwork(t)}/${e}`}))}}var Lx=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Px=new F_("DappPostMessageTransport");class Ix extends ab{constructor(e,t,n){super(e,t,n,v_.TRANSPORT_POSTMESSAGE_PEERS_DAPP)}startOpenChannelListener(){return Lx(this,void 0,void 0,(function*(){return this.client.listenForChannelOpening((e=>Lx(this,void 0,void 0,(function*(){Px.log("connect","received PostMessagePairingResponse",e),yield this.addPeer(e),this._isConnected=g_.CONNECTED,this.newPeerListener&&(this.newPeerListener(e),this.newPeerListener=void 0)}))))}))}listenForNewPeer(e){return Lx(this,void 0,void 0,(function*(){Px.log("listenForNewPeer"),this.newPeerListener=e}))}stopListeningForNewPeers(){return Lx(this,void 0,void 0,(function*(){Px.log("stopListeningForNewPeers"),this.newPeerListener=void 0}))}}var Ox=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Nx=new F_("DappP2PTransport");class kx extends Qw{constructor(e,t,n,r,i,o){super(e,t,n,r,v_.TRANSPORT_P2P_PEERS_DAPP,i,o)}startOpenChannelListener(){return Ox(this,void 0,void 0,(function*(){return this.client.listenForChannelOpening((e=>Ox(this,void 0,void 0,(function*(){Nx.log("listenForNewPeer","new publicKey",e.publicKey),yield this.addPeer(e),this._isConnected=g_.CONNECTED,this.newPeerListener&&(this.newPeerListener(e),this.newPeerListener=void 0)}))))}))}listenForNewPeer(e){return Ox(this,void 0,void 0,(function*(){Nx.log("listenForNewPeer"),this.newPeerListener=e}))}stopListeningForNewPeers(){return Ox(this,void 0,void 0,(function*(){Nx.log("stopListeningForNewPeers"),this.newPeerListener=void 0}))}}var Dx=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Bx=new F_("DAppClient");class Ux extends class extends class{constructor(e){if(this._beaconId=new qv,this._keyPair=new qv,!e.name)throw new Error("Name not set");if(!e.storage)throw new Error("Storage not set");this.name=e.name,this.iconUrl=e.iconUrl,this.appUrl=e.appUrl,this.storage=e.storage,C_.beaconCreatedClientInstance?console.error("[BEACON] It looks like you created multiple Beacon SDK Client instances. This can lead to problems. Only create one instance and re-use it everywhere."):C_.beaconCreatedClientInstance=!0,this.initSDK().catch(console.error)}get beaconId(){return this._beaconId.promise}get keyPair(){return this._keyPair.promise}destroy(){return L_(this,void 0,void 0,(function*(){yield this.removeBeaconEntriesFromStorage(),C_.beaconCreatedClientInstance=!1}))}initSDK(){return L_(this,void 0,void 0,(function*(){return this.storage.set(v_.BEACON_SDK_VERSION,"3.2.0").catch(console.error),this.loadOrCreateBeaconSecret().catch(console.error),this.keyPair.then((e=>{this._beaconId.resolve(n_(e.publicKey))}))}))}removeBeaconEntriesFromStorage(){return L_(this,void 0,void 0,(function*(){const e=Object.values(v_);yield Promise.all(e.map((e=>this.storage.delete(e))))}))}loadOrCreateBeaconSecret(){return L_(this,void 0,void 0,(function*(){const e=yield this.storage.get(v_.BEACON_SDK_SECRET_SEED);if(e&&"string"==typeof e)this._keyPair.resolve(yield i_(e));else{const e=yield S_();yield this.storage.set(v_.BEACON_SDK_SECRET_SEED,e),this._keyPair.resolve(yield i_(e))}}))}}{constructor(e){var t;super(e),this.rateLimit=2,this.rateLimitWindowInSeconds=5,this.requestCounter=[],this._transport=new qv,this.accountManager=new D_(e.storage),this.matrixNodes=null!==(t=e.matrixNodes)&&void 0!==t?t:[],this.handleResponse=(e,t)=>{throw new Error(`not overwritten${JSON.stringify(e)} - ${JSON.stringify(t)}`)}}get transport(){return this._transport.promise}get connectionStatus(){var e,t;return null!==(t=null===(e=this._transport.promiseResult)||void 0===e?void 0:e.connectionStatus)&&void 0!==t?t:g_.NOT_CONNECTED}get ready(){return this.transport.then((()=>{}))}getAccounts(){return G_(this,void 0,void 0,(function*(){return this.accountManager.getAccounts()}))}getAccount(e){return G_(this,void 0,void 0,(function*(){return this.accountManager.getAccount(e)}))}removeAccount(e){return G_(this,void 0,void 0,(function*(){return this.accountManager.removeAccount(e)}))}removeAllAccounts(){return G_(this,void 0,void 0,(function*(){return this.accountManager.removeAllAccounts()}))}addRequestAndCheckIfRateLimited(){return G_(this,void 0,void 0,(function*(){const e=(new Date).getTime();return this.requestCounter=this.requestCounter.filter((t=>t+1e3*this.rateLimitWindowInSeconds>e)),this.requestCounter.push(e),this.requestCounter.length>this.rateLimit}))}init(e){return G_(this,void 0,void 0,(function*(){return this._transport.status===Vv.RESOLVED?(yield this.transport).type:(yield this.setTransport(e),e.type)}))}getOwnAppMetadata(){return G_(this,void 0,void 0,(function*(){return{senderId:yield U_(yield this.beaconId),name:this.name,icon:this.iconUrl}}))}getPeers(){return G_(this,void 0,void 0,(function*(){return(yield this.transport).getPeers()}))}addPeer(e){return G_(this,void 0,void 0,(function*(){return(yield this.transport).addPeer(e)}))}destroy(){const e=Object.create(null,{destroy:{get:()=>super.destroy}});return G_(this,void 0,void 0,(function*(){this._transport.status===Vv.RESOLVED&&(yield(yield this.transport).disconnect()),yield e.destroy.call(this)}))}setTransport(e){return G_(this,void 0,void 0,(function*(){e?this._transport.isSettled()?this._transport=qv.resolve(e):this._transport.resolve(e):this._transport.isSettled()&&(this._transport=new qv)}))}addListener(e){return G_(this,void 0,void 0,(function*(){e.addListener(((e,t)=>G_(this,void 0,void 0,(function*(){if("string"==typeof e){const n=yield(new aw).deserialize(e);this.handleResponse(n,t)}})))).catch((e=>V_.error("addListener",e)))}))}sendDisconnectToPeer(e,t){return G_(this,void 0,void 0,(function*(){const n={id:yield S_(),version:e.version,senderId:yield U_(yield this.beaconId),type:c_.Disconnect},r=yield(new aw).serialize(n),i=null!=t?t:yield this.transport;yield i.send(r,e)}))}}{constructor(e){var t,n,r,i;super(Object.assign({storage:e&&e.storage?e.storage:new iw},e)),this.events=new Tx,this.openRequests=new Map,this._activeAccount=new qv,this._activePeer=new qv,this.blockchains=new Map,this.events=new Tx(e.eventHandlers,null!==(t=e.disableDefaultEvents)&&void 0!==t&&t),this.blockExplorer=null!==(n=e.blockExplorer)&&void 0!==n?n:new Cx,this.preferredNetwork=null!==(r=e.preferredNetwork)&&void 0!==r?r:h_.MAINNET,Gb(null!==(i=e.colorMode)&&void 0!==i?i:A_.LIGHT),this.disclaimerText=e.disclaimerText,this.appMetadataManager=new cw(this.storage),this.activeAccountLoaded=this.storage.get(v_.ACTIVE_ACCOUNT).then((e=>Dx(this,void 0,void 0,(function*(){e?yield this.setActiveAccount(yield this.accountManager.getAccount(e)):yield this.setActiveAccount(void 0)})))).catch((e=>Dx(this,void 0,void 0,(function*(){yield this.setActiveAccount(void 0),console.error(e)})))),this.handleResponse=(e,t)=>Dx(this,void 0,void 0,(function*(){var n,r;const i=this.openRequests.get(e.id);if(Bx.log("handleResponse","Received message",e,t),"3"===e.version){const r=e;if(i&&r.message.type===c_.Acknowledge)Bx.log(`acknowledge message received for ${e.id}`),console.timeLog(e.id,"acknowledge"),this.events.emit(bx.ACKNOWLEDGE_RECEIVED,{message:r.message,extraInfo:{},walletInfo:yield this.getWalletInfo()}).catch(console.error);else if(i){const n=r.message.blockchainData.appMetadata;r.message.type===c_.PermissionResponse&&n&&(yield this.appMetadataManager.addAppMetadata(n)),console.timeLog(r.id,"response"),console.timeEnd(r.id),r.message.type===c_.Error?i.reject(r.message):i.resolve({message:e,connectionInfo:t}),this.openRequests.delete(r.id)}else if(r.message.type===c_.Disconnect){const r=t.origin===p_.P2P?this.p2pTransport:null!==(n=this.postMessageTransport)&&void 0!==n?n:yield this.transport;if(r){const t=(yield r.getPeers()).find((t=>t.senderId===e.senderId));t?(yield r.removePeer(t),yield this.removeAccountsForPeers([t]),yield this.events.emit(bx.CHANNEL_CLOSED)):Bx.error("handleDisconnect","cannot find peer for sender ID",e.senderId)}}else Bx.error("handleResponse","no request found for id ",e.id)}else{const n=e;if(i&&n.type===c_.Acknowledge)Bx.log(`acknowledge message received for ${e.id}`),console.timeLog(e.id,"acknowledge"),this.events.emit(bx.ACKNOWLEDGE_RECEIVED,{message:n,extraInfo:{},walletInfo:yield this.getWalletInfo()}).catch(console.error);else if(i)n.type===c_.PermissionResponse&&n.appMetadata&&(yield this.appMetadataManager.addAppMetadata(n.appMetadata)),console.timeLog(n.id,"response"),console.timeEnd(n.id),n.type===c_.Error||e.errorType?i.reject(n):i.resolve({message:e,connectionInfo:t}),this.openRequests.delete(n.id);else if(n.type===c_.Disconnect||e.typedMessage.type===c_.Disconnect){const n=t.origin===p_.P2P?this.p2pTransport:null!==(r=this.postMessageTransport)&&void 0!==r?r:yield this.transport;if(n){const t=(yield n.getPeers()).find((t=>t.senderId===e.senderId));t?(yield n.removePeer(t),yield this.removeAccountsForPeers([t]),yield this.events.emit(bx.CHANNEL_CLOSED)):Bx.error("handleDisconnect","cannot find peer for sender ID",e.senderId)}}else Bx.error("handleResponse","no request found for id ",e.id)}}))}initInternalTransports(){return Dx(this,void 0,void 0,(function*(){const e=yield this.keyPair;this.postMessageTransport||this.p2pTransport||(this.postMessageTransport=new Ix(this.name,e,this.storage),yield this.addListener(this.postMessageTransport),this.p2pTransport=new kx(this.name,e,this.storage,this.matrixNodes,this.iconUrl,this.appUrl),yield this.addListener(this.p2pTransport))}))}init(e){const t=Object.create(null,{init:{get:()=>super.init}});return Dx(this,void 0,void 0,(function*(){if(this._initPromise)return this._initPromise;try{yield this.activeAccountLoaded}catch(e){}return this._initPromise=new Promise((n=>Dx(this,void 0,void 0,(function*(){if(e)yield this.addListener(e),n(yield t.init.call(this,e));else if(this._transport.isSettled())yield(yield this.transport).connect(),n(yield t.init.call(this,yield this.transport));else{const e=yield this.getActiveAccount(),r=()=>{this.postMessageTransport&&this.postMessageTransport.stopListeningForNewPeers().catch(console.error),this.p2pTransport&&this.p2pTransport.stopListeningForNewPeers().catch(console.error)};if(yield this.initInternalTransports(),!this.postMessageTransport||!this.p2pTransport)return;if(this.postMessageTransport.connect().then().catch(console.error),e&&e.origin){const r=e.origin.type;r===p_.EXTENSION?n(yield t.init.call(this,this.postMessageTransport)):r===p_.P2P&&n(yield t.init.call(this,this.p2pTransport))}else{const e=this.p2pTransport,t=this.postMessageTransport;t.listenForNewPeer((e=>{Bx.log("init","postmessage transport peer connected",e),this.events.emit(bx.PAIR_SUCCESS,e).catch((e=>console.warn(e))),this.setActivePeer(e).catch(console.error),this.setTransport(this.postMessageTransport).catch(console.error),r(),n(y_.POST_MESSAGE)})).catch(console.error),e.listenForNewPeer((e=>{Bx.log("init","p2p transport peer connected",e),this.events.emit(bx.PAIR_SUCCESS,e).catch((e=>console.warn(e))),this.setActivePeer(e).catch(console.error),this.setTransport(this.p2pTransport).catch(console.error),r(),n(y_.P2P)})).catch(console.error),ab.getAvailableExtensions().then((()=>Dx(this,void 0,void 0,(function*(){this.events.emit(bx.PAIR_INIT,{p2pPeerInfo:()=>(e.connect().then().catch(console.error),e.getPairingRequestInfo()),postmessagePeerInfo:()=>t.getPairingRequestInfo(),preferredNetwork:this.preferredNetwork,abortedHandler:()=>{this._initPromise=void 0},disclaimerText:this.disclaimerText}).catch((e=>console.warn(e)))})))).catch((e=>{this._initPromise=void 0,console.error(e)}))}}})))),this._initPromise}))}getActiveAccount(){return Dx(this,void 0,void 0,(function*(){return this._activeAccount.promise}))}setActiveAccount(e){return Dx(this,void 0,void 0,(function*(){if(this._activeAccount.isSettled()?this._activeAccount=qv.resolve(e):this._activeAccount.resolve(e),e){const t=e.origin.type;yield this.initInternalTransports(),t===p_.EXTENSION?yield this.setTransport(this.postMessageTransport):t===p_.P2P&&(yield this.setTransport(this.p2pTransport));const n=yield this.getPeer(e);yield this.setActivePeer(n)}else yield this.setActivePeer(void 0),yield this.setTransport(void 0);yield this.storage.set(v_.ACTIVE_ACCOUNT,e?e.accountIdentifier:void 0),yield this.events.emit(bx.ACTIVE_ACCOUNT_SET,e)}))}clearActiveAccount(){return this.setActiveAccount()}setColorMode(e){return Dx(this,void 0,void 0,(function*(){return Gb(e)}))}getColorMode(){return Dx(this,void 0,void 0,(function*(){return Vb()}))}getAppMetadata(){return Dx(this,void 0,void 0,(function*(){return this.getOwnAppMetadata()}))}showPrepare(){return Dx(this,void 0,void 0,(function*(){const e=yield(()=>Dx(this,void 0,void 0,(function*(){try{return yield this.getWalletInfo()}catch(e){return}})))();yield this.events.emit(bx.SHOW_PREPARE,{walletInfo:e})}))}hideUI(e){return Dx(this,void 0,void 0,(function*(){yield this.events.emit(bx.HIDE_UI,e)}))}removeAccount(e){const t=Object.create(null,{removeAccount:{get:()=>super.removeAccount}});return Dx(this,void 0,void 0,(function*(){const n=t.removeAccount.call(this,e),r=yield this.getActiveAccount();return r&&r.accountIdentifier===e&&(yield this.setActiveAccount(void 0)),n}))}removeAllAccounts(){const e=Object.create(null,{removeAllAccounts:{get:()=>super.removeAllAccounts}});return Dx(this,void 0,void 0,(function*(){yield e.removeAllAccounts.call(this),yield this.setActiveAccount(void 0)}))}removePeer(e,t=!1){return Dx(this,void 0,void 0,(function*(){const n=yield this.transport,r=n.removePeer(e);return yield this.removeAccountsForPeers([e]),t&&(yield this.sendDisconnectToPeer(e,n)),r}))}removeAllPeers(e=!1){return Dx(this,void 0,void 0,(function*(){const t=yield this.transport,n=yield t.getPeers(),r=t.removeAllPeers();if(yield this.removeAccountsForPeers(n),e){const e=n.map((e=>this.sendDisconnectToPeer(e,t)));yield Promise.all(e)}return r}))}subscribeToEvent(e,t){return Dx(this,void 0,void 0,(function*(){yield this.events.on(e,t)}))}checkPermissions(e){return Dx(this,void 0,void 0,(function*(){if(e===c_.PermissionRequest)return!0;const t=yield this.getActiveAccount();if(!t)throw yield this.sendInternalError("No active account set!");const n=t.scopes;switch(e){case c_.OperationRequest:return n.includes(u_.OPERATION_REQUEST);case c_.SignPayloadRequest:return n.includes(u_.SIGN);case c_.BroadcastRequest:return!0;default:return!1}}))}addBlockchain(e){this.blockchains.set(e.identifier,e),e.getWalletLists().then((e=>{var t,n,r,i;i=e.desktopList,vb=i,r=e.extensionList,_b=r,n=e.webList,wb=n,t=e.iOSList,bb=t}))}removeBlockchain(e){this.blockchains.delete(e)}permissionRequest(e){return Dx(this,void 0,void 0,(function*(){console.log("PERMISSION REQUEST");const t=this.blockchains.get(e.blockchainIdentifier);if(!t)throw new Error(`Blockchain "${e.blockchainIdentifier}" not supported by dAppClient`);const n=Object.assign(Object.assign({},e),{type:c_.PermissionRequest,blockchainData:Object.assign(Object.assign({},e.blockchainData),{appMetadata:yield this.getOwnAppMetadata()})});console.log("REQUESTION PERMIMISSION V3","xxx",n);const{message:r,connectionInfo:i}=yield this.makeRequestV3(n).catch((e=>Dx(this,void 0,void 0,(function*(){throw new Error("TODO")}))));console.log("RESPONSE V3",r,i);const o=yield t.getAccountInfosFromPermissionResponse(r.message),s={accountIdentifier:o[0].accountId,senderId:r.senderId,origin:{type:i.origin,id:i.id},address:o[0].address,publicKey:o[0].publicKey,scopes:r.message.blockchainData.scopes,connectedAt:(new Date).getTime(),chainData:r.message.blockchainData};return yield this.accountManager.addAccount(s),yield this.setActiveAccount(s),yield t.handleResponse({request:n,account:s,output:r,blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),yield this.notifySuccess(n,{account:s,output:{address:o[0].address,network:{type:h_.MAINNET},scopes:[u_.OPERATION_REQUEST]},blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),r.message}))}request(e){return Dx(this,void 0,void 0,(function*(){console.log("REQUEST",e);const t=this.blockchains.get(e.blockchainIdentifier);if(!t)throw new Error(`Blockchain "${t}" not supported by dAppClient`);yield t.validateRequest(e);const n=yield this.getActiveAccount();if(!n)throw yield this.sendInternalError("No active account!");const r=Object.assign(Object.assign({},e),{type:c_.BlockchainRequest,accountId:n.accountIdentifier}),{message:i,connectionInfo:o}=yield this.makeRequestV3(r).catch((e=>Dx(this,void 0,void 0,(function*(){throw console.error(e),new Error("TODO")}))));return yield t.handleResponse({request:r,account:n,output:i,blockExplorer:this.blockExplorer,connectionContext:o,walletInfo:yield this.getWalletInfo()}),i.message}))}requestPermissions(e){return Dx(this,void 0,void 0,(function*(){const t={appMetadata:yield this.getOwnAppMetadata(),type:c_.PermissionRequest,network:e&&e.network?e.network:{type:h_.MAINNET},scopes:e&&e.scopes?e.scopes:[u_.OPERATION_REQUEST,u_.SIGN]},{message:n,connectionInfo:r}=yield this.makeRequest(t).catch((e=>Dx(this,void 0,void 0,(function*(){throw yield this.handleRequestError(t,e)})))),i=n.publicKey||n.pubkey||n.pubKey,o=yield function(e){return t_(this,void 0,void 0,(function*(){const t={edpk:{length:54,prefix:e_.from(new Uint8Array([6,161,159]))},sppk:{length:55,prefix:e_.from(new Uint8Array([6,161,161]))},p2pk:{length:55,prefix:e_.from(new Uint8Array([6,161,164]))}};let n,r;if(64===e.length)n=t.edpk.prefix,r=e;else{const i=Object.entries(t);for(let t=0;t<i.length;t++){const[o,s]=i[t];if(e.startsWith(o)&&e.length===s.length){n=s.prefix;const t=Kv.decode(e);r=t.slice(o.length,t.length).toString("hex");break}}}if(!n||!r)throw new Error(`invalid publicKey: ${e}`);const i=(0,Zv.hash)(e_.from(r,"hex"),20);return Kv.encode(e_.concat([n,e_.from(i)]))}))}(i),s={accountIdentifier:yield N_(o,n.network),senderId:n.senderId,origin:{type:r.origin,id:r.id},address:o,publicKey:i,network:n.network,scopes:n.scopes,threshold:n.threshold,connectedAt:(new Date).getTime()};yield this.accountManager.addAccount(s),yield this.setActiveAccount(s);const a=Object.assign(Object.assign({},n),{address:o,accountInfo:s});return yield this.notifySuccess(t,{account:s,output:a,blockExplorer:this.blockExplorer,connectionContext:r,walletInfo:yield this.getWalletInfo()}),a}))}requestSignPayload(e){return Dx(this,void 0,void 0,(function*(){if(!e.payload)throw yield this.sendInternalError("Payload must be provided");const t=yield this.getActiveAccount();if(!t)throw yield this.sendInternalError("No active account!");const n=e.payload;if("string"!=typeof n)throw new Error("Payload must be a string");const r=(()=>{switch(e.signingType){case T_.OPERATION:if(!n.startsWith("03"))throw new Error('When using signing type "OPERATION", the payload must start with prefix "03"');return T_.OPERATION;case T_.MICHELINE:if(!n.startsWith("05"))throw new Error('When using signing type "MICHELINE", the payload must start with prefix "05"');return T_.MICHELINE;case T_.RAW:default:return T_.RAW}})(),i={type:c_.SignPayloadRequest,signingType:r,payload:n,sourceAddress:e.sourceAddress||t.address},{message:o,connectionInfo:s}=yield this.makeRequest(i).catch((e=>Dx(this,void 0,void 0,(function*(){throw yield this.handleRequestError(i,e)}))));return yield this.notifySuccess(i,{account:t,output:o,connectionContext:s,walletInfo:yield this.getWalletInfo()}),o}))}requestOperation(e){return Dx(this,void 0,void 0,(function*(){if(!e.operationDetails)throw yield this.sendInternalError("Operation details must be provided");const t=yield this.getActiveAccount();if(!t)throw yield this.sendInternalError("No active account!");const n={type:c_.OperationRequest,network:t.network||{type:h_.MAINNET},operationDetails:e.operationDetails,sourceAddress:t.address||""},{message:r,connectionInfo:i}=yield this.makeRequest(n).catch((e=>Dx(this,void 0,void 0,(function*(){throw yield this.handleRequestError(n,e)}))));return yield this.notifySuccess(n,{account:t,output:r,blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),r}))}requestBroadcast(e){return Dx(this,void 0,void 0,(function*(){if(!e.signedTransaction)throw yield this.sendInternalError("Signed transaction must be provided");const t=e.network||{type:h_.MAINNET},n={type:c_.BroadcastRequest,network:t,signedTransaction:e.signedTransaction},{message:r,connectionInfo:i}=yield this.makeRequest(n).catch((e=>Dx(this,void 0,void 0,(function*(){throw yield this.handleRequestError(n,e)}))));return yield this.notifySuccess(n,{network:t,output:r,blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),r}))}setActivePeer(e){return Dx(this,void 0,void 0,(function*(){this._activePeer.isSettled()?this._activePeer=qv.resolve(e):this._activePeer.resolve(e),e&&(yield this.initInternalTransports(),"postmessage-pairing-response"===e.type?yield this.setTransport(this.postMessageTransport):"p2p-pairing-response"===e.type&&(yield this.setTransport(this.p2pTransport)))}))}setTransport(e){const t=Object.create(null,{setTransport:{get:()=>super.setTransport}});return Dx(this,void 0,void 0,(function*(){e||(this._initPromise=void 0);const n=t.setTransport.call(this,e);return yield this.events.emit(bx.ACTIVE_TRANSPORT_SET,e),n}))}sendInternalError(e){return Dx(this,void 0,void 0,(function*(){throw yield this.events.emit(bx.INTERNAL_ERROR,{text:e}),new Error(e)}))}removeAccountsForPeers(e){return Dx(this,void 0,void 0,(function*(){const t=yield this.accountManager.getAccounts(),n=e.map((e=>e.senderId)),r=t.filter((e=>n.includes(e.senderId))).map((e=>e.accountIdentifier));yield this.accountManager.removeAccounts(r);const i=yield this.getActiveAccount();i&&r.includes(i.accountIdentifier)&&(yield this.setActiveAccount(void 0))}))}handleRequestError(e,t){return Dx(this,void 0,void 0,(function*(){if(Bx.error("handleRequestError","error response",t),t.errorType){const n=[];if(t.errorType===m_.NO_PRIVATE_KEY_FOUND_ERROR){const t=()=>Dx(this,void 0,void 0,(function*(){const t=e;let n;if(t.sourceAddress&&t.network){const e=yield N_(t.sourceAddress,t.network);n=yield this.getAccount(e),n&&(yield this.removeAccount(n.accountIdentifier))}}));n.push({text:"Remove account",actionCallback:t})}const r=yield this.getPeer(),i=yield this.getActiveAccount();throw e.type===c_.PermissionRequest&&void 0===(yield this.getActiveAccount())&&(this._initPromise=void 0,this.postMessageTransport=void 0,this.p2pTransport=void 0,yield this.setTransport(),yield this.setActivePeer()),this.events.emit(Ax[e.type].error,{errorResponse:t,walletInfo:yield this.getWalletInfo(r,i)},n).catch((e=>Bx.error("handleRequestError",e))),j_.getError(t.errorType,t.errorData)}throw t}))}notifySuccess(e,t){return Dx(this,void 0,void 0,(function*(){this.events.emit(Ax[e.type].success,t).catch((e=>console.warn(e)))}))}getWalletInfo(e,t){var n,r;return Dx(this,void 0,void 0,(function*(){const i=t||(yield this.getActiveAccount()),o=e||(yield this.getPeer(i));let s;i&&(s=yield this.appMetadataManager.getAppMetadata(i.senderId));const a=o;s||(s={name:a.name,icon:a.icon});const l=(e,t)=>!(!e||!t)&&e.toLowerCase()===t.toLowerCase();let c,u;if(Mb().find((e=>l(e.name,null==s?void 0:s.name)))?(c=Mb().find((e=>l(e.name,null==s?void 0:s.name))),u="mobile"):Sb().find((e=>l(e.name,null==s?void 0:s.name)))?(c=Sb().find((e=>l(e.name,null==s?void 0:s.name))),u="web"):xb().find((e=>l(e.name,null==s?void 0:s.name)))?(c=xb().find((e=>l(e.name,null==s?void 0:s.name))),u="desktop"):Eb().find((e=>l(e.name,null==s?void 0:s.name)))&&(c=Eb().find((e=>l(e.name,null==s?void 0:s.name))),u="extension"),c){let e;return c.hasOwnProperty("links")?e=c.links[null!==(n=null==i?void 0:i.network.type)&&void 0!==n?n:this.preferredNetwork]:c.hasOwnProperty("deepLink")&&(e=c.deepLink),{name:s.name,icon:null!==(r=s.icon)&&void 0!==r?r:c.logo,deeplink:e,type:u}}return s}))}getPeer(e){var t,n,r,i;return Dx(this,void 0,void 0,(function*(){let o;if(e){Bx.log("getPeer","We have an account",e);const s=[...null!==(n=yield null===(t=this.postMessageTransport)||void 0===t?void 0:t.getPeers())&&void 0!==n?n:[],...null!==(i=yield null===(r=this.p2pTransport)||void 0===r?void 0:r.getPeers())&&void 0!==i?i:[]];Bx.log("getPeer","Found peers",s,e),o=s.find((t=>t.senderId===e.senderId)),o||(o=s.find((t=>t.extensionId===e.origin.id)))}else o=yield this._activePeer.promise,Bx.log("getPeer","Active peer",o);if(!o)throw new Error("No matching peer found.");return o}))}makeRequest(e){var t;return Dx(this,void 0,void 0,(function*(){const n=yield S_();if(console.time(n),Bx.log("makeRequest","starting"),yield this.init(),console.timeLog(n,"init done"),Bx.log("makeRequest","after init"),yield this.addRequestAndCheckIfRateLimited())throw this.events.emit(bx.LOCAL_RATE_LIMIT_REACHED).catch((e=>console.warn(e))),new Error("rate limit reached");if(!(yield this.checkPermissions(e.type)))throw this.events.emit(bx.NO_PERMISSIONS).catch((e=>console.warn(e))),new Error("No permissions to send this request to wallet!");if(!this.beaconId)throw yield this.sendInternalError("BeaconID not defined");const r=Object.assign({id:n,version:"2",senderId:yield U_(yield this.beaconId)},e),i=new qv;this.addOpenRequest(r.id,i);const o=yield(new aw).serialize(r),s=yield this.getActiveAccount(),a=yield this.getPeer(s),l=yield this.getWalletInfo(a,s);Bx.log("makeRequest","sending message",r),console.timeLog(n,"sending");try{yield(yield this.transport).send(o,a)}catch(e){throw this.events.emit(bx.INTERNAL_ERROR,{text:"Unable to send message. If this problem persists, please reset the connection and pair your wallet again.",buttons:[{text:"Reset Connection",actionCallback:()=>Dx(this,void 0,void 0,(function*(){yield sx(),this.disconnect()}))}]}),console.timeLog(n,"send error"),e}return console.timeLog(n,"sent"),this.events.emit(Ax[e.type].sent,{walletInfo:Object.assign(Object.assign({},l),{name:null!==(t=l.name)&&void 0!==t?t:"Wallet"}),extraInfo:{resetCallback:()=>Dx(this,void 0,void 0,(function*(){this.disconnect()}))}}).catch((e=>console.warn(e))),i.promise}))}makeRequestV3(e){var t;return Dx(this,void 0,void 0,(function*(){const n=yield S_();if(console.time(n),Bx.log("makeRequest","starting"),yield this.init(),console.timeLog(n,"init done"),Bx.log("makeRequest","after init"),yield this.addRequestAndCheckIfRateLimited())throw this.events.emit(bx.LOCAL_RATE_LIMIT_REACHED).catch((e=>console.warn(e))),new Error("rate limit reached");if(!this.beaconId)throw yield this.sendInternalError("BeaconID not defined");const r={id:n,version:"3",senderId:yield U_(yield this.beaconId),message:e},i=new qv;this.addOpenRequest(r.id,i);const o=yield(new aw).serialize(r),s=yield this.getActiveAccount(),a=yield this.getPeer(s),l=yield this.getWalletInfo(a,s);Bx.log("makeRequest","sending message",r),console.timeLog(n,"sending");try{yield(yield this.transport).send(o,a)}catch(e){throw this.events.emit(bx.INTERNAL_ERROR,{text:"Unable to send message. If this problem persists, please reset the connection and pair your wallet again.",buttons:[{text:"Reset Connection",actionCallback:()=>Dx(this,void 0,void 0,(function*(){yield sx(),this.disconnect()}))}]}),console.timeLog(n,"send error"),e}console.timeLog(n,"sent");const c=e.type;return this.events.emit(Ax[c].sent,{walletInfo:Object.assign(Object.assign({},l),{name:null!==(t=l.name)&&void 0!==t?t:"Wallet"}),extraInfo:{resetCallback:()=>Dx(this,void 0,void 0,(function*(){this.disconnect()}))}}).catch((e=>console.warn(e))),i.promise}))}disconnect(){return Dx(this,void 0,void 0,(function*(){this.postMessageTransport=void 0,this.p2pTransport=void 0,yield Promise.all([this.clearActiveAccount(),(yield this.transport).disconnect()])}))}addOpenRequest(e,t){Bx.log("addOpenRequest",this.name,`adding request ${e} and waiting for answer`),this.openRequests.set(e,t)}}new F_("IncomingRequestInterceptor"),new F_("OutgoingResponseInterceptor"),new F_("WalletClient");const zx=()=>{let e="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";return"oo"+Array(49).fill(0).map((t=>e[Math.random()*e.length|0])).join("")},Fx=()=>(window.testBox=Gx,window.testRoom=Vx,window.testFirstPerson=Wx,window.testItem=jx,console.log("No wallet synced. Testing enabled.")),Hx=()=>{window.testBox=null,window.testBox=()=>console.log("Unsync your wallet to enable testing"),window.testRoom=null,window.testRoom=()=>console.log("Unsync your wallet to enable testing"),window.testFirstPerson=null,window.testFirstPerson=()=>console.log("Unsync your wallet to enable testing"),window.testItem=null,window.testItem=()=>console.log("Unsync your wallet to enable testing")},Gx=(e,t)=>{t||(t=zx());var n=1.75*window.innerHeight;return CM.postMessage({side:n,skyurl:e,hash:t}),console.info("Loading test skybox")},Vx=(e,t,n)=>{t||(t=zx()),RM.postMessage({figuresUrl:e,hash:t,type:"world",tag:{room:!0},name:n})},jx=(e,t,n)=>{t||(t=zx()),RM.postMessage({figuresUrl:e,hash:t,type:"world",tag:{item:!0},name:n})},Wx=(e,t,n)=>{t||(t=zx()),RM.postMessage({figuresUrl:e,hash:t,type:"firstPerson",tag:{firstPerson:!0},name:n})};var qx,Kx=document.getElementById("walletSync"),Xx=document.getElementById("walletDetail"),Yx=document.getElementById("tezWallet"),Jx=document.getElementById("ethWallet"),Zx="";window.localStorage,Xx.style.display="none";const Qx=()=>{var e=document.getElementById("walletDetail");"none"===e.style.display?(e.style.display="grid",e.style.zIndex=9999):(e.style.display="none",e.style.zIndex=-50)};document.getElementById("signin").addEventListener("click",Qx);const $x=e=>{document.getElementById("helper").style.display="none",xv([e]).then((()=>{var t=bv[e];if(t){t.prevLoad="{}",Kx.innerHTML=`<div id="alias">${t.alias}</div><div class="profilePic" style="background-image: url('${t.logo}');" ></div>`,Yx.innerHTML=`<div class="walletPics" style="background-image: url('${t.logo}'); min-width:${.08*window.innerHeight}px;min-height:${.08*window.innerHeight}px;max-width:100px;max-height:100px;" ></div><br><div style="1px solid rgb(200 200 200);border-radius: 5%;">${t.alias}</div><br><br>`;const e=document.createElement("div");e.style="font-family:monospace;border:1px solid red;passing:2px;",e.innerText="Unsync Tezos wallet",e.addEventListener("click",tE),Yx.appendChild(e),window.location.search||eT(t.alias)}else Kx.innerHTML="<div style='font-size:12px'>CONNECTION ERROR</div>";r["Identit"].fin=window.performance.now()}))};async function eE(){Hx(),Kx.innerHTML="<div style='font-size:12px'>LOADING PROFILE...</div>";const e=await qx.requestPermissions();Zx=e.address,Qx(),$x(e.address),rM(),iM(e.address),Yx.removeEventListener("click",eE),Yx.addEventListener("click",tE)}async function tE(){window.confirm("Unsynchronize your Tezos wallet?")&&(await qx.clearActiveAccount(),Kx.innerHTML="<div style='font-size:12px;font-family: Arial, Helvetica, sans-serif;border:1px solid black;    display: flex;align-items: center;padding:5px;'>WALLET SYNC</div>",Yx.innerText="Click here to sync your Tezos wallet",Yx.removeEventListener("click",tE),Qx(),Fx(),setTimeout((()=>{Yx.addEventListener("click",eE)}),250))}var nE=localStorage.getItem("ethGalleryAccount");nE&&(Jx.innerHTML="<div style='padding:10%'>Your Ethereum gallery wallet is "+nE+"</div>",Fv(nE));const rE=async()=>{try{var e=0;if(await ethereum.request({method:"eth_requestAccounts"}),(e=await ethereum.request({method:"eth_accounts"}))&&Hx(),Jx.removeEventListener("click",rE),1===e.length)Jx.innerHTML="<div style='padding:10%'>Your Ethereum gallery wallet is "+e[0]+"</div>",nE=e[0],localStorage.setItem("ethGalleryAccount",e[0]),Fv(nE);else if(e.length>1){const t=document.createElement("div");t.innerText="Please choose an Ethereum gallery wallet in the list below",Jx.style.overflow="auto",Jx.appendChild(t),e.forEach((e=>{var t=document.createElement("div");t.innerText=e,t.style="font-size:9px;border:1px solid red",t.addEventListener("click",(()=>{nE=e,Jx.innerHTML="",Jx.innerHTML="<div style='padding:10%'>Your Ethereum gallery wallet is "+e+"</div>",Fv(e),localStorage.setItem("ethGalleryAccount",e)})),Jx.appendChild(t)}))}}catch(e){console.error(e)}};document.getElementById("synclessnotif").addEventListener("click",(()=>window.open("https://observablehq.com/@anaglyph-ic/personalised-anaver-se-entry-generator?collection=@anaglyph-ic/starting-with-the-anaver-se","_blank"))),Jx.addEventListener("click",rE);const iE=1.25,oE=65535,sE=Math.pow(2,-24);class aE{constructor(){}}function lE(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function cE(e){let t=-1,n=-1/0;for(let r=0;r<3;r++){const i=e[r+3]-e[r];i>n&&(n=i,t=r)}return t}function uE(e,t){t.set(e)}function hE(e,t,n){let r,i;for(let o=0;o<3;o++){const s=o+3;r=e[o],i=t[o],n[o]=r<i?r:i,r=e[s],i=t[s],n[s]=r>i?r:i}}function dE(e,t,n){for(let r=0;r<3;r++){const i=t[e+2*r],o=t[e+2*r+1],s=i-o,a=i+o;s<n[r]&&(n[r]=s),a>n[r+3]&&(n[r+3]=a)}}function pE(e){const t=e[3]-e[0],n=e[4]-e[1],r=e[5]-e[2];return 2*(t*n+n*r+r*t)}function fE(e,t,n,r,i=null){let o=1/0,s=1/0,a=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0;const y=null!==i;for(let r=6*t,i=6*(t+n);r<i;r+=6){const t=e[r+0],n=e[r+1],i=t-n,v=t+n;i<o&&(o=i),v>l&&(l=v),y&&t<h&&(h=t),y&&t>f&&(f=t);const _=e[r+2],w=e[r+3],b=_-w,x=_+w;b<s&&(s=b),x>c&&(c=x),y&&_<d&&(d=_),y&&_>m&&(m=_);const E=e[r+4],S=e[r+5],M=E-S,T=E+S;M<a&&(a=M),T>u&&(u=T),y&&E<p&&(p=E),y&&E>g&&(g=E)}r[0]=o,r[1]=s,r[2]=a,r[3]=l,r[4]=c,r[5]=u,y&&(i[0]=h,i[1]=d,i[2]=p,i[3]=f,i[4]=m,i[5]=g)}const mE=(e,t)=>e.candidate-t.candidate,gE=new Array(32).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),yE=new Float32Array(6);class vE{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,r=-1/0;for(let i=0,o=e.length;i<o;i++){const o=e[i][t];n=o<n?o:n,r=o>r?o:r}this.min=n,this.max=r}setFromPoints(e,t){let n=1/0,r=-1/0;for(let i=0,o=t.length;i<o;i++){const o=t[i],s=e.dot(o);n=s<n?s:n,r=s>r?s:r}this.min=n,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}}vE.prototype.setFromBox=function(){const e=new ks;return function(t,n){const r=n.min,i=n.max;let o=1/0,s=-1/0;for(let n=0;n<=1;n++)for(let a=0;a<=1;a++)for(let l=0;l<=1;l++){e.x=r.x*n+i.x*(1-n),e.y=r.y*a+i.y*(1-a),e.z=r.z*l+i.z*(1-l);const c=t.dot(e);o=Math.min(c,o),s=Math.max(c,s)}this.min=o,this.max=s}}(),new vE;const _E=function(){const e=new ks,t=new ks,n=new ks;return function(r,i,o){const s=r.start,a=e,l=i.start,c=t;n.subVectors(s,l),e.subVectors(r.end,i.start),t.subVectors(i.end,i.start);const u=n.dot(c),h=c.dot(a),d=c.dot(c),p=n.dot(a),f=a.dot(a)*d-h*h;let m,g;m=0!==f?(u*h-p*d)/f:0,g=(u+m*h)/d,o.x=m,o.y=g}}(),wE=function(){const e=new ds,t=new ks,n=new ks;return function(r,i,o,s){_E(r,i,e);let a=e.x,l=e.y;if(a>=0&&a<=1&&l>=0&&l<=1)return r.at(a,o),void i.at(l,s);if(a>=0&&a<=1)return l<0?i.at(0,s):i.at(1,s),void r.closestPointToPoint(s,!0,o);if(l>=0&&l<=1)return a<0?r.at(0,o):r.at(1,o),void i.closestPointToPoint(o,!0,s);{let e,c;e=a<0?r.start:r.end,c=l<0?i.start:i.end;const u=t,h=n;return r.closestPointToPoint(c,!0,t),i.closestPointToPoint(e,!0,n),u.distanceToSquared(c)<=h.distanceToSquared(e)?(o.copy(u),void s.copy(c)):(o.copy(e),void s.copy(h))}}}(),bE=function(){const e=new ks,t=new ks,n=new Ql,r=new Rg;return function(i,o){const{radius:s,center:a}=i,{a:l,b:c,c:u}=o;if(r.start=l,r.end=c,r.closestPointToPoint(a,!0,e).distanceTo(a)<=s)return!0;if(r.start=l,r.end=u,r.closestPointToPoint(a,!0,e).distanceTo(a)<=s)return!0;if(r.start=c,r.end=u,r.closestPointToPoint(a,!0,e).distanceTo(a)<=s)return!0;const h=o.getPlane(n);if(Math.abs(h.distanceToPoint(a))<=s){const e=h.projectPoint(a,t);if(o.containsPoint(e))return!0}return!1}}();class xE extends Xa{constructor(...e){super(...e),this.isSeparatingAxisTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new ks)),this.satBounds=new Array(4).fill().map((()=>new vE)),this.points=[this.a,this.b,this.c],this.sphere=new ra,this.plane=new Ql,this.needsUpdate=!1}intersectsSphere(e){return bE(e,this)}update(){const e=this.a,t=this.b,n=this.c,r=this.points,i=this.satAxes,o=this.satBounds,s=i[0],a=o[0];this.getNormal(s),a.setFromPoints(s,r);const l=i[1],c=o[1];l.subVectors(e,t),c.setFromPoints(l,r);const u=i[2],h=o[2];u.subVectors(t,n),h.setFromPoints(u,r);const d=i[3],p=o[3];d.subVectors(n,e),p.setFromPoints(d,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(s,e),this.needsUpdate=!1}}xE.prototype.closestPointToSegment=function(){const e=new ks,t=new ks,n=new Rg;return function(r,i=null,o=null){const{start:s,end:a}=r,l=this.points;let c,u=1/0;for(let s=0;s<3;s++){const a=(s+1)%3;n.start.copy(l[s]),n.end.copy(l[a]),wE(n,r,e,t),c=e.distanceToSquared(t),c<u&&(u=c,i&&i.copy(e),o&&o.copy(t))}return this.closestPointToPoint(s,e),c=s.distanceToSquared(e),c<u&&(u=c,i&&i.copy(e),o&&o.copy(s)),this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<u&&(u=c,i&&i.copy(e),o&&o.copy(a)),Math.sqrt(u)}}(),xE.prototype.intersectsTriangle=function(){const e=new xE,t=new Array(3),n=new Array(3),r=new vE,i=new vE,o=new ks,s=new ks,a=new ks,l=new ks,c=new Rg,u=new Rg,h=new Rg;return function(d,p=null){this.needsUpdate&&this.update(),d.isSeparatingAxisTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);const f=this.satBounds,m=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(let e=0;e<4;e++){const t=f[e],i=m[e];if(r.setFromPoints(i,n),t.isSeparated(r))return!1}const g=d.satBounds,y=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let e=0;e<4;e++){const n=g[e],i=y[e];if(r.setFromPoints(i,t),n.isSeparated(r))return!1}for(let e=0;e<4;e++){const s=m[e];for(let e=0;e<4;e++){const a=y[e];if(o.crossVectors(s,a),r.setFromPoints(o,t),i.setFromPoints(o,n),r.isSeparated(i))return!1}}if(p){const e=this.plane,t=d.plane;if(Math.abs(e.normal.dot(t.normal))>1-1e-10)console.warn("SeparatingAxisTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0);else{const n=this.points;let r=!1;for(let e=0;e<3;e++){const i=n[e],o=n[(e+1)%3];if(c.start.copy(i),c.end.copy(o),t.intersectLine(c,r?u.start:u.end)){if(r)break;r=!0}}const i=d.points;let o=!1;for(let t=0;t<3;t++){const n=i[t],r=i[(t+1)%3];if(c.start.copy(n),c.end.copy(r),e.intersectLine(c,o?h.start:h.end)){if(o)break;o=!0}}if(u.delta(s),h.delta(a),s.dot(a)<0){let e=h.start;h.start=h.end,h.end=e}l.subVectors(u.start,h.start),l.dot(s)>0?p.start.copy(u.start):p.start.copy(h.start),l.subVectors(u.end,h.end),l.dot(s)<0?p.end.copy(u.end):p.end.copy(h.end)}}return!0}}(),xE.prototype.distanceToPoint=function(){const e=new ks;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),xE.prototype.distanceToTriangle=function(){const e=new ks,t=new ks,n=["a","b","c"],r=new Rg,i=new Rg;return function(o,s=null,a=null){const l=s||a?r:null;if(this.intersectsTriangle(o,l))return(s||a)&&(s&&l.getCenter(s),a&&l.getCenter(a)),0;let c=1/0;for(let t=0;t<3;t++){let r;const i=n[t],l=o[i];this.closestPointToPoint(l,e),r=l.distanceToSquared(e),r<c&&(c=r,s&&s.copy(e),a&&a.copy(l));const u=this[i];o.closestPointToPoint(u,e),r=u.distanceToSquared(e),r<c&&(c=r,s&&s.copy(u),a&&a.copy(e))}for(let l=0;l<3;l++){const u=n[l],h=n[(l+1)%3];r.set(this[u],this[h]);for(let l=0;l<3;l++){const u=n[l],h=n[(l+1)%3];i.set(o[u],o[h]),wE(r,i,e,t);const d=e.distanceToSquared(t);d<c&&(c=d,s&&s.copy(e),a&&a.copy(t))}}return Math.sqrt(c)}}();class EE extends Us{constructor(...e){super(...e),this.isOrientedBox=!0,this.matrix=new da,this.invMatrix=new da,this.points=new Array(8).fill().map((()=>new ks)),this.satAxes=new Array(3).fill().map((()=>new ks)),this.satBounds=new Array(3).fill().map((()=>new vE)),this.alignedSatBounds=new Array(3).fill().map((()=>new vE)),this.needsUpdate=!1}set(e,t,n){super.set(e,t),this.matrix=n,this.needsUpdate=!0}copy(e){super.copy(e),this.matrix.copy(e.matrix),this.needsUpdate=!0}}EE.prototype.update=function(){const e=this.matrix,t=this.min,n=this.max,r=this.points;for(let i=0;i<=1;i++)for(let o=0;o<=1;o++)for(let s=0;s<=1;s++){const a=r[1*i|2*o|4*s];a.x=i?n.x:t.x,a.y=o?n.y:t.y,a.z=s?n.z:t.z,a.applyMatrix4(e)}const i=this.satBounds,o=this.satAxes,s=r[0];for(let e=0;e<3;e++){const t=o[e],n=i[e],a=r[1<<e];t.subVectors(s,a),n.setFromPoints(t,r)}const a=this.alignedSatBounds;a[0].setFromPointsField(r,"x"),a[1].setFromPointsField(r,"y"),a[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},EE.prototype.intersectsBox=function(){const e=new vE;return function(t){this.needsUpdate&&this.update();const n=t.min,r=t.max,i=this.satBounds,o=this.satAxes,s=this.alignedSatBounds;if(e.min=n.x,e.max=r.x,s[0].isSeparated(e))return!1;if(e.min=n.y,e.max=r.y,s[1].isSeparated(e))return!1;if(e.min=n.z,e.max=r.z,s[2].isSeparated(e))return!1;for(let n=0;n<3;n++){const r=o[n],s=i[n];if(e.setFromBox(r,t),s.isSeparated(e))return!1}return!0}}(),EE.prototype.intersectsTriangle=function(){const e=new xE,t=new Array(3),n=new vE,r=new vE,i=new ks;return function(o){this.needsUpdate&&this.update(),o.isSeparatingAxisTriangle?o.needsUpdate&&o.update():(e.copy(o),e.update(),o=e);const s=this.satBounds,a=this.satAxes;t[0]=o.a,t[1]=o.b,t[2]=o.c;for(let e=0;e<3;e++){const r=s[e],i=a[e];if(n.setFromPoints(i,t),r.isSeparated(n))return!1}const l=o.satBounds,c=o.satAxes,u=this.points;for(let e=0;e<3;e++){const t=l[e],r=c[e];if(n.setFromPoints(r,u),t.isSeparated(n))return!1}for(let e=0;e<3;e++){const o=a[e];for(let e=0;e<4;e++){const s=c[e];if(i.crossVectors(o,s),n.setFromPoints(i,t),r.setFromPoints(i,u),n.isSeparated(r))return!1}}return!0}}(),EE.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},EE.prototype.distanceToPoint=function(){const e=new ks;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),EE.prototype.distanceToBox=function(){const e=["x","y","z"],t=new Array(12).fill().map((()=>new Rg)),n=new Array(12).fill().map((()=>new Rg)),r=new ks,i=new ks;return function(o,s=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(a||l)&&(o.getCenter(i),this.closestPointToPoint(i,r),o.closestPointToPoint(r,i),a&&a.copy(r),l&&l.copy(i)),0;const c=s*s,u=o.min,h=o.max,d=this.points;let p=1/0;for(let e=0;e<8;e++){const t=d[e];i.copy(t).clamp(u,h);const n=t.distanceToSquared(i);if(n<p&&(p=n,a&&a.copy(t),l&&l.copy(i),n<c))return Math.sqrt(n)}let f=0;for(let r=0;r<3;r++)for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){const s=(r+1)%3,a=(r+2)%3,l=1<<r|i<<s|o<<a,c=d[i<<s|o<<a],p=d[l];t[f].set(c,p);const m=e[r],g=e[s],y=e[a],v=n[f],_=v.start,w=v.end;_[m]=u[m],_[g]=i?u[g]:h[g],_[y]=o?u[y]:h[g],w[m]=h[m],w[g]=i?u[g]:h[g],w[y]=o?u[y]:h[g],f++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++){i.x=e?h.x:u.x,i.y=t?h.y:u.y,i.z=n?h.z:u.z,this.closestPointToPoint(i,r);const o=i.distanceToSquared(r);if(o<p&&(p=o,a&&a.copy(r),l&&l.copy(i),o<c))return Math.sqrt(o)}for(let e=0;e<12;e++){const o=t[e];for(let e=0;e<12;e++){const t=n[e];wE(o,t,r,i);const s=r.distanceToSquared(i);if(s<p&&(p=s,a&&a.copy(r),l&&l.copy(i),s<c))return Math.sqrt(s)}}return Math.sqrt(p)}}();const SE=new ks,ME=new ks,TE=new ks,AE=new ds,RE=new ds,CE=new ds,LE=new ks;function PE(e,t,n,r,i){const o=3*r,s=e.index.getX(o),a=e.index.getX(o+1),l=e.index.getX(o+2),c=function(e,t,n,r,i,o,s){SE.fromBufferAttribute(t,r),ME.fromBufferAttribute(t,i),TE.fromBufferAttribute(t,o);const a=function(e,t,n,r,i,o){let s;return s=o===tr?e.intersectTriangle(r,n,t,!0,i):e.intersectTriangle(t,n,r,o!==nr,i),null===s?null:{distance:e.origin.distanceTo(i),point:i.clone()}}(e,SE,ME,TE,LE,s);if(a){n&&(AE.fromBufferAttribute(n,r),RE.fromBufferAttribute(n,i),CE.fromBufferAttribute(n,o),a.uv=Xa.getUV(LE,SE,ME,TE,AE,RE,CE,new ds));const e={a:r,b:i,c:o,normal:new ks,materialIndex:0};Xa.getNormal(SE,ME,TE,e.normal),a.face=e,a.faceIndex=r}return a}(n,e.attributes.position,e.attributes.uv,s,a,l,t);return c?(c.faceIndex=r,i&&i.push(c),c):null}function IE(e,t,n){return null===e?null:(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(n.ray.origin),e.object=t,e.distance<n.near||e.distance>n.far?null:e)}function OE(e,t,n,r){const i=e.a,o=e.b,s=e.c;let a=t,l=t+1,c=t+2;n&&(a=n.getX(t),l=n.getX(t+1),c=n.getX(t+2)),i.x=r.getX(a),i.y=r.getY(a),i.z=r.getZ(a),o.x=r.getX(l),o.y=r.getY(l),o.z=r.getZ(l),s.x=r.getX(c),s.y=r.getY(c),s.z=r.getZ(c)}function NE(e,t,n,r,i,o,s){const a=n.index,l=n.attributes.position;for(let n=e,c=t+e;n<c;n++)if(OE(s,3*n,a,l),s.needsUpdate=!0,r(s,n,i,o))return!0;return!1}class kE{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}function DE(e,t){return 65535===t[e+15]}function BE(e,t){return t[e+6]}function UE(e,t){return t[e+14]}function zE(e){return e+8}function FE(e,t){return t[e+6]}const HE=new Us,GE=new ks,VE=["x","y","z"];function jE(e,t,n,r,i){let o=2*e,s=ZE,a=QE,l=$E;if(DE(o,a))!function(e,t,n,r,i,o){for(let s=r,a=r+i;s<a;s++)PE(e,t,n,s,o)}(t,n,r,BE(e,l),UE(o,a),i);else{const o=zE(e);XE(o,s,r,GE)&&jE(o,t,n,r,i);const a=FE(e,l);XE(a,s,r,GE)&&jE(a,t,n,r,i)}}function WE(e,t,n,r){let i=2*e,o=ZE,s=QE,a=$E;if(DE(i,s))return function(e,t,n,r,i){let o=1/0,s=null;for(let a=r,l=r+i;a<l;a++){const r=PE(e,t,n,a);r&&r.distance<o&&(s=r,o=r.distance)}return s}(t,n,r,BE(e,a),UE(i,s));{const i=function(e,t){return t[e+7]}(e,a),s=VE[i],l=r.direction[s]>=0;let c,u;l?(c=zE(e),u=FE(e,a)):(c=FE(e,a),u=zE(e));const h=XE(c,o,r,GE)?WE(c,t,n,r):null;if(h){const e=h.point[s];if(l?e<=o[u+i]:e>=o[u+i+3])return h}const d=XE(u,o,r,GE)?WE(u,t,n,r):null;return h&&d?h.distance<=d.distance?h:d:h||d||null}}const qE=function(){let e,t;const n=[],r=new kE((()=>new Us));return function(...o){e=r.getPrimitive(),t=r.getPrimitive(),n.push(e,t);const s=i(...o);r.releasePrimitive(e),r.releasePrimitive(t),n.pop(),n.pop();const a=n.length;return a>0&&(t=n[a-1],e=n[a-2]),s};function i(n,r,o,s,a=null,l=0,c=0){function u(e){let t=2*e,n=QE,r=$E;for(;!DE(t,n);)t=2*(e=zE(e));return BE(e,r)}function h(e){let t=2*e,n=QE,r=$E;for(;!DE(t,n);)t=2*(e=FE(e,r));return BE(e,r)+UE(t,n)}let d=2*n,p=ZE,f=QE,m=$E;if(DE(d,f)){const t=BE(n,m),r=UE(d,f);return lE(n,p,e),s(t,r,!1,c,l+n,e)}{const d=zE(n),g=FE(n,m);let y,v,_,w,b=d,x=g;if(a&&(_=e,w=t,lE(b,p,_),lE(x,p,w),y=a(_),v=a(w),v<y)){b=g,x=d;const e=y;y=v,v=e,_=w}_||(_=e,lE(b,p,_));const E=o(_,DE(2*b,f),y,c+1,l+b);let S;if(2===E){const e=u(b);S=s(e,h(b)-e,!0,c+1,l+b,_)}else S=E&&i(b,r,o,s,a,l,c+1);if(S)return!0;w=t,lE(x,p,w);const M=o(w,DE(2*x,f),v,c+1,l+x);let T;if(2===M){const e=u(x);T=s(e,h(x)-e,!0,c+1,l+x,w)}else T=M&&i(x,r,o,s,a,l,c+1);return!!T}}}(),KE=function(){const e=new xE,t=new xE,n=new da,r=new EE,i=new EE;return function o(s,a,l,c,u=null){let h=2*s,d=ZE,p=QE,f=$E;if(null===u&&(l.boundingBox||l.computeBoundingBox(),r.set(l.boundingBox.min,l.boundingBox.max,c),u=r),!DE(h,p)){const e=s+8,t=f[s+6];return lE(e,d,HE),u.intersectsBox(HE)&&o(e,a,l,c,u)?!0:(lE(t,d,HE),!(!u.intersectsBox(HE)||!o(t,a,l,c,u)))}{const r=a,o=r.index,u=r.attributes.position,m=l.index,g=l.attributes.position,y=BE(s,f),v=UE(h,p);if(n.copy(c).invert(),l.boundsTree)return lE(s,d,i),i.matrix.copy(n),i.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:e=>i.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(c),e.b.applyMatrix4(c),e.c.applyMatrix4(c),e.needsUpdate=!0;for(let n=3*y,r=3*(v+y);n<r;n+=3)if(OE(t,n,o,u),t.needsUpdate=!0,e.intersectsTriangle(t))return!0;return!1}});for(let r=3*y,i=v+3*y;r<i;r+=3){OE(e,r,o,u),e.a.applyMatrix4(n),e.b.applyMatrix4(n),e.c.applyMatrix4(n),e.needsUpdate=!0;for(let n=0,r=m.count;n<r;n+=3)if(OE(t,n,m,g),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}}}();function XE(e,t,n,r){return lE(e,t,HE),n.intersectBox(HE,r)}const YE=[];let JE,ZE,QE,$E;function eS(e){JE&&YE.push(JE),JE=e,ZE=new Float32Array(e),QE=new Uint16Array(e),$E=new Uint32Array(e)}function tS(){JE=null,ZE=null,QE=null,$E=null,YE.length&&eS(YE.pop())}const nS=Symbol("skip tree generation"),rS=new Us,iS=new Us,oS=new da,sS=new EE,aS=new EE,lS=new ks,cS=new ks,uS=new ks,hS=new ks,dS=new ks,pS=new Us,fS=new kE((()=>new xE));class mS{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),mS.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});t={cloneBuffers:!0,...t};const n=e.geometry,r=e._roots,i=n.getIndex();let o;return o=t.cloneBuffers?{roots:r.map((e=>e.slice())),index:i.array.slice()}:{roots:r,index:i.array},o}static deserialize(e,t,n={}){if("boolean"==typeof n)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),mS.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});n={setIndex:!0,...n};const{index:r,roots:i}=e,o=new mS(t,{...n,[nS]:!0});if(o._roots=i,n.setIndex){const n=t.getIndex();if(null===n){const n=new el(e.index,1,!1);t.setIndex(n)}else n.array!==r&&(n.array.set(r),n.needsUpdate=!0)}return o}constructor(e,t={}){if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[nS]:!1},t)).useSharedArrayBuffer&&"undefined"==typeof SharedArrayBuffer)throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[nS]||(this._roots=function(e,t){const n=function(e,t){function n(e){d&&d(e/p)}function r(t,i,d,p=null,m=0){if(!f&&m>=l&&(f=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),d<=u||m>=l)return n(i),t.offset=i,t.count=d,t;const g=function(e,t,n,r,i,o){let s=-1,a=0;if(0===o)s=cE(t),-1!==s&&(a=(t[s]+t[s+3])/2);else if(1===o)s=cE(e),-1!==s&&(a=function(e,t,n,r){let i=0;for(let o=t,s=t+n;o<s;o++)i+=e[6*o+2*r];return i/n}(n,r,i,s));else if(2===o){const o=pE(e);let l=iE*i;const c=6*r,u=6*(r+i);for(let e=0;e<3;e++){const r=t[e],h=(t[e+3]-r)/32;if(i<8){const t=[...gE];t.length=i;let r=0;for(let i=c;i<u;i+=6,r++){const o=t[r];o.candidate=n[i+2*e],o.count=0;const{bounds:s,leftCacheBounds:a,rightCacheBounds:l}=o;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0,s[e]=1/0,s[e+3]=-1/0;dE(i,n,s)}t.sort(mE);let h=i;for(let e=0;e<h;e++){const n=t[e];for(;e+1<h&&t[e+1].candidate===n.candidate;)t.splice(e+1,1),h--}for(let r=c;r<u;r+=6){const i=n[r+2*e];for(let e=0;e<h;e++){const o=t[e];i>=o.candidate?dE(r,n,o.rightCacheBounds):(dE(r,n,o.leftCacheBounds),o.count++)}}for(let n=0;n<h;n++){const r=t[n],c=r.count,u=i-r.count,h=r.leftCacheBounds,d=r.rightCacheBounds;let p=0;0!==c&&(p=pE(h)/o);let f=0;0!==u&&(f=pE(d)/o);const m=1+iE*(p*c+f*u);m<l&&(s=e,l=m,a=r.candidate)}}else{for(let e=0;e<32;e++){const t=gE[e];t.count=0,t.candidate=r+h+e*h;const n=t.bounds;for(let e=0;e<3;e++)n[e]=1/0,n[e+3]=-1/0}for(let t=c;t<u;t+=6){let i=~~((n[t+2*e]-r)/h);i>=32&&(i=31);const o=gE[i];o.count++,dE(t,n,o.bounds)}const t=gE[31];uE(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){const t=gE[e],n=gE[e+1];hE(t.bounds,n.rightCacheBounds,t.rightCacheBounds)}let d=0;for(let t=0;t<31;t++){const n=gE[t],r=n.count,c=n.bounds,u=gE[t+1].rightCacheBounds;0!==r&&(0===d?uE(c,yE):hE(c,yE,yE)),d+=r;let h=0,p=0;0!==d&&(h=pE(yE)/o);const f=i-d;0!==f&&(p=pE(u)/o);const m=1+iE*(h*d+p*f);m<l&&(s=e,l=m,a=n.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${o} used.`);return{axis:s,pos:a}}(t.boundingData,p,s,i,d,h);if(-1===g.axis)return n(i),t.offset=i,t.count=d,t;const y=function(e,t,n,r,i){let o=n,s=n+r-1;const a=i.pos,l=2*i.axis;for(;;){for(;o<=s&&t[6*o+l]<a;)o++;for(;o<=s&&t[6*s+l]>=a;)s--;if(!(o<s))return o;for(let n=0;n<3;n++){let r=e[3*o+n];e[3*o+n]=e[3*s+n],e[3*s+n]=r;let i=t[6*o+2*n+0];t[6*o+2*n+0]=t[6*s+2*n+0],t[6*s+2*n+0]=i;let a=t[6*o+2*n+1];t[6*o+2*n+1]=t[6*s+2*n+1],t[6*s+2*n+1]=a}o++,s--}}(a,s,i,d,g);if(y===i||y===i+d)n(i),t.offset=i,t.count=d;else{t.splitAxis=g.axis;const e=new aE,n=i,a=y-i;t.left=e,e.boundingData=new Float32Array(6),fE(s,n,a,e.boundingData,o),r(e,n,a,o,m+1);const l=new aE,c=y,u=d-a;t.right=l,l.boundingData=new Float32Array(6),fE(s,c,u,l.boundingData,o),r(l,c,u,o,m+1)}return t}!function(e,t){if(!e.index){const n=e.attributes.position.count,r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;let i;i=n>65535?new Uint32Array(new r(4*n)):new Uint16Array(new r(2*n)),e.setIndex(new el(i,1));for(let e=0;e<n;e++)i[e]=e}}(e,t);const i=new Float32Array(6),o=new Float32Array(6),s=function(e,t){const n=e.attributes.position,r=n.array,i=e.index.array,o=i.length/3,s=new Float32Array(6*o),a=n.offset||0;let l=3;n.isInterleavedBufferAttribute&&(l=n.data.stride);for(let e=0;e<o;e++){const n=3*e,o=6*e,c=i[n+0]*l+a,u=i[n+1]*l+a,h=i[n+2]*l+a;for(let e=0;e<3;e++){const n=r[c+e],i=r[u+e],a=r[h+e];let l=n;i<l&&(l=i),a<l&&(l=a);let d=n;i>d&&(d=i),a>d&&(d=a);const p=(d-l)/2,f=2*e;s[o+f+0]=l+p,s[o+f+1]=p+(Math.abs(l)+p)*sE,l<t[e]&&(t[e]=l),d>t[e+3]&&(t[e+3]=d)}}return s}(e,i),a=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,h=t.strategy,d=t.onProgress,p=e.index.count/3;let f=!1;const m=[],g=function(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];const t=[],n=new Set;for(const t of e.groups)n.add(t.start),n.add(t.start+t.count);const r=Array.from(n.values()).sort(((e,t)=>e-t));for(let e=0;e<r.length-1;e++){const n=r[e],i=r[e+1];t.push({offset:n/3,count:(i-n)/3})}return t}(e);if(1===g.length){const e=g[0],t=new aE;t.boundingData=i,function(e,t,n,r){let i=1/0,o=1/0,s=1/0,a=-1/0,l=-1/0,c=-1/0;for(let r=6*t,u=6*(t+n);r<u;r+=6){const t=e[r+0];t<i&&(i=t),t>a&&(a=t);const n=e[r+2];n<o&&(o=n),n>l&&(l=n);const u=e[r+4];u<s&&(s=u),u>c&&(c=u)}r[0]=i,r[1]=o,r[2]=s,r[3]=a,r[4]=l,r[5]=c}(s,e.offset,e.count,o),r(t,e.offset,e.count,o),m.push(t)}else for(let e of g){const t=new aE;t.boundingData=new Float32Array(6),fE(s,e.offset,e.count,t.boundingData,o),r(t,e.offset,e.count,o),m.push(t)}return m}(e,t);let r,i,o;const s=[],a=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let e=0;e<n.length;e++){const t=n[e],u=new a(32*l(t));r=new Float32Array(u),i=new Uint32Array(u),o=new Uint16Array(u),c(0,t),s.push(u)}return s;function l(e){return e.count?1:1+l(e.left)+l(e.right)}function c(e,t){const n=e/4,s=e/2,a=!!t.count,l=t.boundingData;for(let e=0;e<6;e++)r[n+e]=l[e];if(a){const r=t.offset,a=t.count;return i[n+6]=r,o[s+14]=a,o[s+15]=oE,e+32}{const r=t.left,o=t.right,s=t.splitAxis;let a;if(a=c(e+32,r),a/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return i[n+6]=a/4,a=c(a,o),i[n+7]=s,a}}}(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Us))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));const t=this.geometry,n=t.index.array,r=t.attributes.position,i=r.array,o=r.offset||0;let s,a,l,c,u=3;r.isInterleavedBufferAttribute&&(u=r.data.stride);let h=0;const d=this._roots;for(let e=0,t=d.length;e<t;e++)s=d[e],a=new Uint32Array(s),l=new Uint16Array(s),c=new Float32Array(s),p(0,h),h+=s.byteLength;function p(t,r,s=!1){const h=2*t;if(l[h+15]===oE){const e=a[t+6];let r=1/0,s=1/0,d=1/0,p=-1/0,f=-1/0,m=-1/0;for(let t=3*e,a=3*(e+l[h+14]);t<a;t++){const e=n[t]*u+o,a=i[e+0],l=i[e+1],c=i[e+2];a<r&&(r=a),a>p&&(p=a),l<s&&(s=l),l>f&&(f=l),c<d&&(d=c),c>m&&(m=c)}return(c[t+0]!==r||c[t+1]!==s||c[t+2]!==d||c[t+3]!==p||c[t+4]!==f||c[t+5]!==m)&&(c[t+0]=r,c[t+1]=s,c[t+2]=d,c[t+3]=p,c[t+4]=f,c[t+5]=m,!0)}{const n=t+8,i=a[t+6],o=n+r,l=i+r;let u=s,h=!1,d=!1;e?u||(h=e.has(o),d=e.has(l),u=!h&&!d):(h=!0,d=!0);const f=u||d;let m=!1;(u||h)&&(m=p(n,r,u));let g=!1;f&&(g=p(i,r,u));const y=m||g;if(y)for(let e=0;e<3;e++){const r=n+e,o=i+e,s=c[r],a=c[r+3],l=c[o],u=c[o+3];c[t+e]=s<l?s:l,c[t+e+3]=a>u?a:u}return y}}}traverse(e,t=0){const n=this._roots[t],r=new Uint32Array(n),i=new Uint16Array(n);!function t(o,s=0){const a=2*o,l=i[a+15]===oE;if(l){const t=r[o+6],c=i[a+14];e(s,l,new Float32Array(n,4*o,6),t,c)}else{const i=o+8,a=r[o+6],c=r[o+7];e(s,l,new Float32Array(n,4*o,6),c)||(t(i,s+1),t(a,s+1))}}(0)}raycast(e,t=er){const n=this._roots,r=this.geometry,i=[],o=t.isMaterial,s=Array.isArray(t),a=r.groups,l=o?t.side:t;for(let o=0,c=n.length;o<c;o++){const c=s?t[a[o].materialIndex].side:l,u=i.length;if(eS(n[o]),jE(0,r,c,e,i),tS(),s){const e=a[o].materialIndex;for(let t=u,n=i.length;t<n;t++)i[t].face.materialIndex=e}}return i}raycastFirst(e,t=er){const n=this._roots,r=this.geometry,i=t.isMaterial,o=Array.isArray(t);let s=null;const a=r.groups,l=i?t.side:t;for(let i=0,c=n.length;i<c;i++){const c=o?t[a[i].materialIndex].side:l;eS(n[i]);const u=WE(0,r,c,e);tS(),null!=u&&(null==s||u.distance<s.distance)&&(s=u,o&&(u.face.materialIndex=a[i].materialIndex))}return s}intersectsGeometry(e,t){const n=this.geometry;let r=!1;for(const i of this._roots)if(eS(i),r=KE(0,n,e,t),tS(),r)break;return r}shapecast(e,t,n){const r=this.geometry;if(e instanceof Function){if(t){const e=t;t=(t,n,r,i)=>{const o=3*n;return e(t,o,o+1,o+2,r,i)}}e={boundsTraverseOrder:n,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}const i=fS.getPrimitive();let{boundsTraverseOrder:o,intersectsBounds:s,intersectsRange:a,intersectsTriangle:l}=e;if(a&&l){const e=a;a=(t,n,o,s,a)=>!!e(t,n,o,s,a)||NE(t,n,r,l,o,s,i)}else a||(a=l?(e,t,n,o)=>NE(e,t,r,l,n,o,i):(e,t,n)=>n);let c=!1,u=0;for(const e of this._roots){if(eS(e),c=qE(0,r,s,a,o,u),tS(),c)break;u+=e.byteLength}return fS.releasePrimitive(i),c}bvhcast(e,t,n){let{intersectsRanges:r,intersectsTriangles:i}=n;const o=this.geometry.index,s=this.geometry.attributes.position,a=e.geometry.index,l=e.geometry.attributes.position;oS.copy(t).invert();const c=fS.getPrimitive(),u=fS.getPrimitive();if(i){function e(e,n,r,h,d,p,f,m){for(let g=r,y=r+h;g<y;g++){OE(u,3*g,a,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let t=e,r=e+n;t<r;t++)if(OE(c,3*t,o,s),c.needsUpdate=!0,i(c,u,t,g,d,p,f,m))return!0}return!1}if(r){const t=r;r=function(n,r,i,o,s,a,l,c){return!!t(n,r,i,o,s,a,l,c)||e(n,r,i,o,s,a,l,c)}}else r=e}this.getBoundingBox(iS),iS.applyMatrix4(t);const h=this.shapecast({intersectsBounds:e=>iS.intersectsBox(e),intersectsRange:(t,n,i,o,s,a)=>(rS.copy(a),rS.applyMatrix4(oS),e.shapecast({intersectsBounds:e=>rS.intersectsBox(e),intersectsRange:(e,i,a,l,c)=>r(t,n,e,i,o,s,l,c)}))});return fS.releasePrimitive(c),fS.releasePrimitive(u),h}intersectsBox(e,t){return sS.set(e.min,e.max,t),sS.needsUpdate=!0,this.shapecast({intersectsBounds:e=>sS.intersectsBox(e),intersectsTriangle:e=>sS.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,n={},r={},i=0,o=1/0){e.boundingBox||e.computeBoundingBox(),sS.set(e.boundingBox.min,e.boundingBox.max,t),sS.needsUpdate=!0;const s=this.geometry,a=s.attributes.position,l=s.index,c=e.attributes.position,u=e.index,h=fS.getPrimitive(),d=fS.getPrimitive();let p=cS,f=uS,m=null,g=null;r&&(m=hS,g=dS);let y=1/0,v=null,_=null;return oS.copy(t).invert(),aS.matrix.copy(oS),this.shapecast({boundsTraverseOrder:e=>sS.distanceToBox(e,Math.min(y,o)),intersectsBounds:(e,t,n)=>n<y&&n<o&&(t&&(aS.min.copy(e.min),aS.max.copy(e.max),aS.needsUpdate=!0),!0),intersectsRange:(n,r)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:e=>aS.distanceToBox(e,Math.min(y,o)),intersectsBounds:(e,t,n)=>n<y&&n<o,intersectsRange:(e,o)=>{for(let s=3*e,w=3*(e+o);s<w;s+=3){OE(d,s,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let e=3*n,t=3*(n+r);e<t;e+=3){OE(h,e,l,a),h.needsUpdate=!0;const t=h.distanceToTriangle(d,p,m);if(t<y&&(f.copy(p),g&&g.copy(m),y=t,v=e/3,_=s/3),t<i)return!0}}}});for(let e=0,o=u?u.count:c.count;e<o;e+=3){OE(d,e,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let t=3*n,o=3*(n+r);t<o;t+=3){OE(h,t,l,a),h.needsUpdate=!0;const n=h.distanceToTriangle(d,p,m);if(n<y&&(f.copy(p),g&&g.copy(m),y=n,v=t/3,_=e/3),n<i)return!0}}}}),fS.releasePrimitive(h),fS.releasePrimitive(d),y===1/0?null:(n.point?n.point.copy(f):n.point=f.clone(),n.distance=y,n.faceIndex=v,r&&(r.point?r.point.copy(g):r.point=g.clone(),r.point.applyMatrix4(oS),f.applyMatrix4(oS),r.distance=f.sub(r.point).length(),r.faceIndex=_),n)}closestPointToPoint(e,t={},n=0,r=1/0){const i=n*n,o=r*r;let s=1/0,a=null;if(this.shapecast({boundsTraverseOrder:t=>(lS.copy(e).clamp(t.min,t.max),lS.distanceToSquared(e)),intersectsBounds:(e,t,n)=>n<s&&n<o,intersectsTriangle:(t,n)=>{t.closestPointToPoint(e,lS);const r=e.distanceToSquared(lS);return r<s&&(cS.copy(lS),s=r,a=n),r<i}}),s===1/0)return null;const l=Math.sqrt(s);return t.point?t.point.copy(cS):t.point=cS.clone(),t.distance=l,t.faceIndex=a,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach((t=>{lE(0,new Float32Array(t),pS),e.union(pS)})),e}}const gS=mS.prototype.raycast;mS.prototype.raycast=function(...e){if(e[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');const[t,n,r,i]=e;return gS.call(this,r,t.material).forEach((e=>{(e=IE(e,t,n))&&i.push(e)})),i}return gS.apply(this,e)};const yS=mS.prototype.raycastFirst;mS.prototype.raycastFirst=function(...e){if(e[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');const[t,n,r]=e;return IE(yS.call(this,r,t.material),t,n)}return yS.apply(this,e)};const vS=mS.prototype.closestPointToPoint;mS.prototype.closestPointToPoint=function(...e){if(e[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),e.unshift();const t=e[1],n={};return e[1]=n,vS.apply(this,e),t&&t.copy(n.point),n.distance}return vS.apply(this,e)};const _S=mS.prototype.closestPointToGeometry;mS.prototype.closestPointToGeometry=function(...e){const t=e[2],n=e[3];if(t&&t.isVector3||n&&n.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');const r={},i={},o=e[1];return e[2]=r,e[3]=i,_S.apply(this,e),t&&t.copy(r.point),n&&n.copy(i.point).applyMatrix4(o),r.distance}return _S.apply(this,e)};const wS=mS.prototype.refit;var bS,xS;mS.prototype.refit=function(...e){const t=e[0],n=e[1];if(n&&(n instanceof Set||Array.isArray(n))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');const e=new Set;n.forEach((t=>e.add(t))),t&&t.forEach((t=>e.add(t))),wS.call(this,e)}else wS.apply(this,e)},["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach((e=>{const t=mS.prototype[e];mS.prototype[e]=function(...n){return(null===n[0]||n[0].isMesh)&&(n.shift(),console.warn(`MeshBVH: The function signature for "${e}" has changed and no longer takes Mesh. See docs for new signature.`)),t.apply(this,n)}}));const ES=()=>{if(bS){const t=[];var e=[];if(tI.children.forEach((t=>{t.children.forEach((t=>{if(t.material===mv.whiteFull){t.updateMatrixWorld(!0);var n=t.geometry.clone();n.applyMatrix4(t.matrixWorld);for(const e in n.attributes)"position"!==e&&n.deleteAttribute(e);n.index&&(n=n.toNonIndexed()),n.userData.groupMerged=!0,e.push(n)}}))})),e.length>0){const n=Jy(e,!1);n.userData.groupMerged=!0,t.push(n)}t.push(xS.geometry),t.forEach((e=>{for(const t in e.attributes)"position"!==t&&e.deleteAttribute(t);e.index=null}));const n=Jy(t,!1);n.boundsTree=new mS(n,{lazyGeneration:!0}),(bS=new Dl(n,mv.whiteFull)).name="collider",bS.visible=!1}},SS={},MS={};(()=>{const e=[];[[1,1],[1,2],[1,3],[1,4],[1,6],[1,8],[1,10],[1,12],[1,16],[2,2],[2,3],[2,4],[2,6],[2,8],[2,10]].forEach((t=>{const n=`B${t[0]}x${t[1]}`;SS[n]={geometry:{type:"BoxGeometry",args:[t[0],t[1],1.25]},name:n,lines:!0,hatch:!0};var r=document.createElement("div");r.innerText=n,r.style=`width:${20*t[0]}px;height:${20*t[1]}px;padding:5px;border:1px solid black;margin:10px`,r.addEventListener("click",(()=>{TS([SS[n]]),mP()})),e.push(r)})),MS.Blocks=e})(),(()=>{const e=[];for(let n=1;n<=10;n+=1){const r=`T${n}x${n}`;SS[r]={geometry:{type:"BoxGeometry",args:[n,n,.1]},name:r,lines:!0,hatch:!0},(t=document.createElement("div")).innerText=r,t.style=`width:${20*n}px;height:${20*n}px;padding:5px;border:1px solid black;margin:10px`,t.addEventListener("click",(()=>{TS([SS[r]]),mP()})),e.push(t)}for(let n=1;n<=12;n+=1){const r=`T1x${n}`;SS[r]={geometry:{type:"BoxGeometry",args:[n,1,.1]},name:r,lines:!0,hatch:!0},(t=document.createElement("div")).innerText=r,t.style=`width:${20*n}px;height:20px;padding:5px;border:1px solid black;margin:10px`,t.addEventListener("click",(()=>{TS([SS[r]]),mP()})),e.push(t)}for(let n=1;n<=16;n+=1){const r=`T2x${n}`;var t;SS[r]={geometry:{type:"BoxGeometry",args:[n,2,.1]},name:r,lines:!0,hatch:!0},(t=document.createElement("div")).innerText=r,t.style=`width:${20*n}px;height:40px;padding:5px;border:1px solid black;margin:10px`,t.addEventListener("click",(()=>{TS([SS[r]]),mP()})),e.push(t)}[6,8,10,12].forEach((t=>{const n=`T4x${t}`;SS[n]={geometry:{type:"BoxGeometry",args:[t,4,.1]},name:n,lines:!0,hatch:!0};var r=document.createElement("div");r.innerText=n,r.style=`width:${20*t}px;height:80px;padding:5px;border:1px solid black;margin:10px`,r.addEventListener("click",(()=>{TS([SS[n]]),mP()})),e.push(r)})),[8,10,12,14,16].forEach((t=>{const n=`T6x${t}`;SS[n]={geometry:{type:"BoxGeometry",args:[t,6,.1]},name:n,lines:!0,hatch:!0};var r=document.createElement("div");r.innerText=n,r.style=`width:${20*t}px;height:120px;padding:5px;border:1px solid black;margin:10px`,r.addEventListener("click",(()=>{TS([SS[n]]),mP()})),e.push(r)})),MS.Tiles=e})();const TS=t=>{const n=new Dh;n.position.y+=.5,n.position.z-=4,t.forEach((t=>{const r=new e[t.geometry.type](...t.geometry.args),i=new Dl(r,mv.ghost),o=new cp(r),s=new Hd(o,mv.blackLineLone);t.tokenType="block",n.userData=t,n.add(i,s)})),nI.add(n)},AS={metadata:"https://broadcast.modular-station.com/api/nowplaying/modular_station",stream:"https://broadcast.modular-station.com/radio/8000/radio.aac"},RS=new Audio,CS=document.getElementById("audio-radio");CS.addEventListener("touchstart",(()=>{CS.style.display="none"}));const LS=document.getElementById("radio-name"),PS=document.getElementById("track-name"),IS=document.getElementById("radio-play");var OS=!1;IS.addEventListener("click",(()=>{OS?(RS.pause(),OS=!1,IS.innerHTML='<img  style="width:15px;height:15px" src="play.svg">'):(RS.play(),OS=!0,IS.innerHTML='<img  style="width:15px;height:15px" src="stop.svg">')}));const NS=e=>{fetch(e.metadata).then((e=>e.json())).then((t=>{LS.innerText=t.station.name+" - ",PS.innerText=" "+t.now_playing.song.text,e.src!=e.stream&&(OS||(RS.src=e.stream))})).catch((e=>{}))};var kS,DS=!1,BS=0,US=0;const zS=window.localStorage,FS=e=>{(0,gv.request)("https://api.fxhash.xyz/graphql","query checkRoom($objktId: Float) {\n        room:objkt(id: $objktId) {\n          metadata\n          owner {\n            id\n            name\n          }\n          issuer {\n            author {\n              id\n              name\n            }\n          }\n        }\n      }",{objktId:parseInt(e.room)}).then((n=>{lM(),US=0,AM.gallery=[],e.gallery.forEach((e=>{"block"!=e.tokenType&&"sculpture"!=e.tokenType&&US++})),e.hasOwnProperty("DOMthumb")&&(document.querySelector('meta[name="og:image"]').setAttribute("content",e.DOMthumb.src),document.querySelector('meta[name="twitter:image"]').setAttribute("content",e.DOMthumb.src)),(0,t.setCast)(!0);var r=n.room;tI.clear(),r.issuer.author.id;var i="";r.owner.name&&(i=r.owner.name.toUpperCase()+"'S "),r.metadata.hasOwnProperty("attributes")&&Array.isArray(r.metadata.attributes)&&r.metadata.attributes.forEach((e=>{"name"===e.name.toLowerCase()&&(i+=e.value)}));var o=r.metadata.artifactUri.slice(7,r.metadata.artifactUri.indexOf("?fxhash="));r.type="world",r.tag={room:!0},r.figuresUrl="https://gateway.fxhash.xyz/ipfs/"+o+"/figures.js",kM(r,e.room,r.metadata.iterationHash,i),_v("Gallery room retrieval",""),HS(e),e.hasOwnProperty("collection")&&e.collection&&(BS=e.collection,xv([e.collection]).then((()=>{BS=bv[e.collection].alias})).catch((e=>{console.log(e)})))})).catch((e=>{console.log(e),_v("Gallery room retrieval","")}))},HS=e=>{(0,gv.request)("https://api.fxhash.xyz/graphql","query checkRoom($objktId: Float) {\n      skybox:objkt(id: $objktId) {\n          metadata\n          owner {\n            id\n            name\n          }\n          issuer {\n            author {\n              id\n              name\n            }\n          }\n        }\n      }",{objktId:parseInt(e.skybox)}).then((t=>{var n=t.skybox;if(t.skybox){n.issuer.author.id;{var r="https://gateway.fxhash.xyz/ipfs/"+n.metadata.artifactUri.slice(7,n.metadata.artifactUri.indexOf("?fxhash="))+"/skybox.js",i=1.75*window.innerHeight;const e=n.metadata.iterationHash;CM.postMessage({side:i,skyurl:r,hash:e})}}e.gallery.length>0&&GS(e),_v("Gallery skybox retrieval","")})).catch((t=>{_v("Gallery skybox retrieval",""),e.gallery.length>0&&GS(e)}))},GS=t=>{const n={objkt:[],openSea:[],block:[],sculpture:[]};t.gallery.forEach((e=>n[e.tokenType].push(e))),n.objkt.length>0&&(e=>{const t={};var n=0;e.forEach((e=>{if(n++,"number"==typeof e.objktMetaData.token_id&&(e.objktMetaData.token_id=JSON.stringify(e.objktMetaData.token_id)),n<500){var r=e.objktMetaData.contract+e.objktMetaData.token_id;t.hasOwnProperty(r)||(t[r]=`{\n          token_id: { _eq: ${JSON.stringify(e.objktMetaData.token_id)} },\n          fa_contract: { _eq: ${JSON.stringify(e.objktMetaData.contract)} },\n        }`)}}));const r=[];for(const e in t)r.push(t[e]);const i=`query{\n    token(where: {_or:[${r}]}) {\n      description\n      display_uri\n      metadata\n      mime\n      name\n      thumbnail_uri\n      timestamp\n      creators{\n        creator_address\n      }\n      fa{\n        contract\n      }\n      token_id\n    }\n  }`;(0,gv.request)("https://data.objkt.com/v3/graphql",i).then((t=>{var n=[];e.forEach((e=>{t.token.forEach((t=>{if(t.fa.contract===e.objktMetaData.contract&&t.token_id===e.objktMetaData.token_id)if(t.hasOwnProperty("creators")&&t.creators[0]&&n.push(t.creators[0].creator_address),t.display_uri){const n="https://assets.objkt.media/file/assets-003/"+t.display_uri.replace("ipfs://","")+"/display",r={position:e.position,rotation:e.rotation,scale:e.scale},i="https://objkt.com/asset/"+t.fa.contract+"/"+t.token_id;t.url=i,"Versum Items"===t.fa.name&&(t.url="https://versum.xyz/token/versum/"+t.token_id);const o=t.fa.contract+JSON.stringify(t.token_id);tM[o]=t,tv(n,{id:o},"objkt",r)}else console.log("%c [objkt.com] The token ["+t.name+"] was minted without a proper metadata capture.","font-weight:bold;")}))})),xv(n)})).catch((e=>{console.log(e)}))})(n.objkt),n.block.length>0&&(t=>{t.forEach((t=>{var n=new Dh;const r=new e[t.block.geometry.type](...t.block.geometry.args),i=new Dl(r,mv.whiteFull),o=new cp(r),s=new Hd(o,mv.blackLineLone);n.add(i,s),n.position.set(mM(t.position.x),mM(t.position.y),mM(t.position.z)),n.rotation.set(mM(t.rotation.x),mM(t.rotation.y),mM(t.rotation.z)),n.scale.set(mM(t.scale.x),mM(t.scale.y),mM(t.scale.z)),tI.attach(n),ES()}))})(n.block),n.sculpture.length>0&&VS(n.sculpture);for(let e=0;e<n.openSea.length;e++)setTimeout((()=>{var t;t=n.openSea[e],fetch(`https://api.opensea.io/api/v1/asset/${t.openSeaMetaData.asset_contract_address}/${t.openSeaMetaData.token_id}/?include_orders=false`,{method:"GET"}).then((e=>e.json())).then((e=>{const n=e.image_url;tM[e.id]=e;const r={position:t.position,rotation:t.rotation,scale:t.scale};var i={id:e.id,objkt:{asset_contract:{address:""},token_id:""}};i.objkt.asset_contract.address=t.openSeaMetaData.asset_contract_address,i.objkt.token_id=t.openSeaMetaData.token_id,tv(n,i,"openSea",r)})).catch((e=>console.error(e)))}),600*e);if(t.hasOwnProperty("audioguide")){r="https://assets.objkt.media/file/assets-003/"+t.artifact.replace("ipfs://","")+"/artifact/"+t.audioguide.mainTrack,i=t.name,RS.pause(),clearInterval(kS),RS.src=r,LS.innerText=i,PS.innerText="Gallery audioguide",DS=!0,setTimeout((()=>{OS=!0,IS.innerHTML='<img  style="width:15px;height:15px" src="stop.svg">',RS.play().catch((e=>{OS=!1,IS.innerHTML='<img  style="width:15px;height:15px" src="play.svg">'}))}),1500)}var r,i},VS=e=>{e.forEach((e=>{(0,gv.request)("https://api.fxhash.xyz/graphql",`query {\n        objkt(id: ${e.fxMetaData.objktid}) {\n          metadata\n          owner {\n            id\n            name\n          }\n          issuer {\n            author {\n              id\n              name\n            }\n          }\n        }\n      }`).then((t=>{const n=t.objkt;n.type="world",n.tag={world:!0,item:!0};var r=n.metadata.artifactUri.slice(7,n.metadata.artifactUri.indexOf("?fxhash="));n.figuresUrl="https://gateway.fxhash.xyz/ipfs/"+r+"/figures.js";const i={position:e.position,rotation:e.rotation,scale:e.scale};kM(n,e.fxMetaData.objktid,n.metadata.iterationHash,n.metadata.name,i)}))}))},jS={room:540571,skybox:527345,gallery:[{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"2"},position:{x:"-30.0000",y:"1.5000",z:"2.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"3"},position:{x:"-30.0000",y:"1.5000",z:"-1.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"1"},position:{x:"-32.0000",y:"8.5000",z:"0.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"3.8000",y:"3.8000",z:"3.8000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"4"},position:{x:"-30.0000",y:"1.5000",z:"-4.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"0"},position:{x:"-30.0000",y:"1.5000",z:"5.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"5"},position:{x:"-19.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"6"},position:{x:"-15.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"7"},position:{x:"-11.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"8"},position:{x:"-7.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"27435"},position:{x:"-42.0000",y:"8.5000",z:"38.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"3.1000",y:"3.1000",z:"3.1000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1043411"},position:{x:"38.0000",y:"15.5000",z:"0.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"2.6000",y:"2.6000",z:"2.6000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1CUPoajzwiYQN8gfueuktNbAQS5jJ4Jf7V",token_id:"6"},position:{x:"0.0000",y:"5.5000",z:"-85.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"6.4000",y:"6.4000",z:"6.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"926697"},position:{x:"-90.0025",y:"1.4774",z:"36.0496"},rotation:{x:"-2.7139",y:"1.5572",z:"2.7139"},scale:{x:"2.1000",y:"2.1000",z:"2.1000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"25128"},position:{x:"-71.0000",y:"15.5000",z:"-60.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"2.9000",y:"2.9000",z:"2.9000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"669579"},position:{x:"110.0000",y:"32.5000",z:"-9.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"1.5000",y:"1.5000",z:"1.5000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1C3dCG9XMnP7iT7tUDs55ebr43wfF3TV7k",token_id:"0"},position:{x:"116.0000",y:"7.5000",z:"-29.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"6.8000",y:"6.8000",z:"6.8000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1RncKS9P56FhSDradukH9SjMSobqE8zpLV",token_id:"1"},position:{x:"97.0000",y:"15.5000",z:"38.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"3.9000",y:"3.9000",z:"3.9000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"541252"},position:{x:"-3.3699",y:"15.4139",z:"103.5790"},rotation:{x:"-3.0723",y:"1.1603",z:"3.0780"},scale:{x:"2.6000",y:"2.6000",z:"2.6000"}}],name:"ANAVER.SE TUTORIAL",collection:"tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"};var WS=!1;const qS=window.localStorage,KS=()=>{WS=!0,setTimeout((()=>{qS.setItem("finishedTutorial",!0)}),18e4,5)},XS={},YS={getUserTokens:gv.gql`
    query UserCollection(
      $id: String!
      $take: Int
      $skip: Int
      $sort: ObjktsSortInput
      $filters: ObjktFilter
    ) {
      user(id: $id) {
        id
        name
        objkts(take: $take, skip: $skip, sort: $sort, filters: $filters) {
          id
          slug
          metadata
          createdAt
          __typename
        }
        __typename
      }
    }
  `,generateGallery:gv.gql`
    query generateGallery($generativeTokenId: Float) {
      generativeToken(id: $generativeTokenId) {
        entireCollection {
          metadata
          owner {
            name
          }
          id
          generationHash
        }
        author {
          id
        }
      }
    }
  `,getAllTokens:gv.gql`
    {
      user(id: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9") {
        generativeTokens(take: 50) {
          id
          name
          balance
          slug
          tags
          metadata
          author {
            id
          }
        }
      }
    }
  `},JS=()=>{const e={room:[],fp:[],sky:[]};for(const t in XS)XS[t].tag.hasOwnProperty("room")&&e.room.push(XS[t]);if(kM({type:"skybox",skyboxUrl:"./initial_skybox.js"},0,zx(),"",!0,!1),e.room.length>0){const t=e.room[parseInt(Math.random()*e.room.length)];r["Choix alatoire"].fin=performance.now(),kM(t,0,zx(),"")}},ZS=()=>{const e=document.getElementsByClassName("galleryFilterCheckbox"),t=[];var n,r=document.getElementsByClassName("gentkCell");for(let n=0;n<e.length;n++)e[n].checked&&t.push(e[n]["data-name"]);if(t.length>0){n=e[0]["data-name"].slug;for(let e=0;e<r.length;e++)r[e].style.display="none"}else for(let e=0;e<r.length;e++)r[e].style.display="inline-block";var i={};XS[n].collection.forEach((e=>i[e.completeName]={})),t.forEach((e=>{"Owner"===e.feature?XS[n].collection.forEach((t=>{t.owner.name===e.key&&(document.getElementById(t.completeName).style.display="inline-block")})):XS[n].collection.forEach((t=>{t.metadata.attributes.forEach((n=>{n.name===e.feature&&("string"==typeof n.value?n.value:JSON.stringify(n.value))===e.key&&Array.isArray(t.metadata.attributes)&&t.metadata.attributes.forEach((e=>{"Name"!==e.name&&"name"!==e.name||(document.getElementById(t.completeName).style.display="inline-block")}))}))}))}))},QS=e=>{e.DOMelements.gallery.length>0?dP(e):(e=>{uP(e),(0,gv.request)("https://api.fxhash.xyz/graphql",YS.generateGallery,{generativeTokenId:e.id}).then((t=>{e.collection=t.generativeToken.entireCollection,e.collection.forEach((t=>((e,t)=>{const n=t.generationHash,r=t.id,i=document.createElement("li");i.className="gentkCell";const o=document.createElement("div");var s="";t.owner.name&&(s=t.owner.name.toUpperCase()+"'S "),o.className="iterNameDiv",t.metadata.hasOwnProperty("attributes")&&Array.isArray(t.metadata.attributes)&&t.metadata.attributes.forEach((e=>{"name"===e.name.toLowerCase()&&(s+=e.value)}));const a="<div style='font-size:10px'>Check gentk on <a target='_blank' href='https://www.fxhash.xyz/gentk/slug/"+e.slug+"-"+t.metadata.name.slice(t.metadata.name.lastIndexOf("#")+1)+"'>fxhash</a></div>";var l="<div style='font-size:10px;font-style: italic;' id='"+(e.slug+t.metadata.iterationHash)+"'></div>";o.innerHTML=s+"<br>"+a+l,t.completeName=s;const c=new Image;c.className="thumbnail",c.src="https://gateway.fxhash.xyz/ipfs/"+t.metadata.thumbnailUri.replace("ipfs://",""),c.onerror=e=>{c.src="/notfound.png"},c.style.cursor="pointer",c.addEventListener("click",(()=>{mP(),kM(e,r,n,s)})),i.id=s,i.appendChild(c),i.appendChild(o),e.DOMelements.gallery.push(i),((e,t,n)=>{e.hasOwnProperty("filters")||(e.filters={}),t&&(e.filters.hasOwnProperty("Owner")?e.filters.Owner.hasOwnProperty(t)?e.filters.Owner[t]++:e.filters.Owner[t]=1:e.filters.Owner={}),n&&n.length>0&&n.forEach((t=>{e.filters.hasOwnProperty(t.name)?e.filters[t.name].hasOwnProperty(t.value)?e.filters[t.name][t.value]++:e.filters[t.name][t.value]=1:e.filters[t.name]={}}))})(e,t.owner.name,t.metadata.attributes)})(e,t))),(e=>{const t=[],n=e.slug;for(const i in e.filters){var r=document.createElement("div");r.innerHTML="<hr>"+i+" ("+Object.keys(e.filters[i]).length+")",r.style.cursor="pointer";const o=document.createElement("ul");o.style.display="none",o.style.listStyle="none";for(const t in e.filters[i]){const r=document.createElement("li"),s=document.createElement("input");s.type="checkbox",s.className="galleryFilterCheckbox",s["data-name"]={feature:i,key:t,slug:n},s.name=t+" ("+e.filters[i][t]+")";const a=document.createElement("label");a.innerText=t+" ("+e.filters[i][t]+")",a.for=t+" ("+e.filters[i][t]+")",s.addEventListener("change",ZS),r.appendChild(s),r.appendChild(a),o.appendChild(r)}r.addEventListener("click",(()=>{"none"===o.style.display?o.style.display="block":o.style.display="none"})),t.push(r,o)}e.DOMelements.filters=t})(e),dP(e)}))})(e)},$S={},eM=[],tM={};var nM=[];const rM=()=>nM=[],iM=e=>{Lv(e),Ov(0,e),(e=>{(0,gv.request)("https://api.fxhash.xyz/graphql",Ev,{userId:e,take:50}).then((e=>{e.user.generativeTokens.forEach((e=>{e.fa={},e.fa.contract=e.id<=10964?"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE":"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi";const t=document.createElement("div");t.className="gentkProfiles";const n=new Image;n.className="thumbnail",n.src="https://gateway.fxhash.xyz/ipfs/"+e.thumbnailUri.replace("ipfs://",""),n.style.cursor="pointer",n.addEventListener("click",(()=>{var t;document.getElementById("galleryMainWindow").innerHTML="Loading collection...",t=e,(0,gv.request)("https://api.fxhash.xyz/graphql",Mv,{generativeTokenId:t.id}).then((e=>{var n=[];e.generativeToken.entireCollection.forEach((e=>{const r=e.id;e.fa={contract:t.fa.contract},e.token_id=r;const i=document.createElement("li");i.className="gentkCell";const o=document.createElement("div");var s=e.metadata.name;o.className="thumbTitle";const a=new Image;a.className="thumbnail",a.src="https://gateway.fxhash.xyz/ipfs/"+e.metadata.thumbnailUri.replace("ipfs://",""),a.style.cursor="pointer",o.innerHTML=s,a.addEventListener("click",(()=>{tM[JSON.stringify(e.id)]=e;const t="https://gateway.fxhash.xyz/ipfs/"+e.metadata.displayUri.replace("ipfs://","");mP(),tv(t,{id:r},"objkt")})),i.appendChild(a),i.appendChild(o),n.push(i)})),t.DOMelements={gallery:n},dP(t)}))})),n&&t.appendChild(n);const r=document.createElement("div");r.className="artThumbTitle";const i=document.createElement("div");i.className="artistNames",i.innerText=e.name,r.appendChild(i),t.appendChild(r),Iv.push(t)}))}))})(e),e&&(0,gv.request)("https://api.fxhash.xyz/graphql",YS.getUserTokens,{id:e,take:50,skip:0,filters:{searchQuery_eq:"anaverse anaglyphic"}}).then((e=>{if(e.user){var t="";e.user.name&&(t=e.user.name,document.title=t.toUpperCase()+"'S ANAVER.SE"),e.user.objkts.forEach((e=>{e.metadata.hasOwnProperty("tags")&&e.metadata.tags.forEach((t=>{"anaverse"===t&&($S[e.slug]=e),"skybox"===t&&($S[e.slug].type="skybox")}))}));for(const e in $S){const t=$S[e];t.generatorSlug=t.slug.substring(0,t.slug.lastIndexOf("-")),XS.hasOwnProperty(t.generatorSlug)&&(t.generatorID=XS[t.generatorSlug].id)}((e,t,n,r)=>{for(const r in e){const a=e[r],l=a.hasOwnProperty("fa")?a.fa.contract+a.token_id:a.id,c=document.createElement("li");c.className="gentkCell",c.style.marginTop="10px";const u=document.createElement("div");var i="";u.className="thumbTitle";const h=new Image;var o;h.className="thumbnail",a.hasOwnProperty("metadata")&&(a.metadata.hasOwnProperty("attributes")&&Array.isArray(a.metadata.attributes)&&a.metadata.attributes.forEach((e=>{"name"===e.name.toLowerCase()&&(i=n.toUpperCase()+"'s "+e.value)})),h.src="https://gateway.fxhash.xyz/ipfs/"+a.metadata.thumbnailUri.replace("ipfs://",""),h.style.cursor="pointer",a.metadata.displayUri.replace("ipfs://","")),""===i&&(i=a.metadata.name),a.hasOwnProperty("name")&&(i=n.toUpperCase()+"'s "+a.name,o="https://objkt.com/asset/"+a.fa.contract+"/"+a.token_id,a.url=o,"fxhash: Genesis"===a.fa.name?(h.src="https://gateway.fxhash.xyz/ipfs/"+a.thumbnail_uri.replace("ipfs://",""),h.onerror=e=>{h.src="/notfound.png"},h.style.cursor="pointer"):"Versum Items"===a.fa.name?o="https://versum.xyz/token/versum/"+a.token_id:a.thumbnail_uri&&(h.src="https://cloudflare-ipfs.com/ipfs/"+a.thumbnail_uri.replace("ipfs://",""),h.onerror=e=>{h.src="/notfound.png"}),h.style.cursor="pointer");var s="<div style='font-size:10px'>Check token on <a target='_blank' href='"+o+"'>OBJKT</a> </div>";a.hasOwnProperty("generatorID")&&(s="<div style='font-size:10px'>Check token on <a target='_blank' href='"+(o="https://www.fxhash.xyz/gentk/"+a.id)+"'>fx(hash)</a> </div>"),a.slug,a.metadata.iterationHash,u.innerHTML=i+"<br>"+s,a.completeName=i;const d=()=>{mP(),kM(XS[r.slice(0,r.lastIndexOf("-"))],l,a.metadata.iterationHash,e[r].completeName)};h.addEventListener("click",d),c.appendChild(h),c.appendChild(u),t.push(c)}})($S,eM,t),_v("personal native anaver.se tokens retrieval","")}})).catch((e=>{_v("personal native anaver.se tokens retrieval",""),console.log("Error : the request to retrieve your native anaver.se tokens failed"),console.log(e)}))},oM=e=>{if(sM.innerHTML="",e){var t=.05*window.innerWidth;let n=t,r=t,i="multiply";const o=Fn("svg").attr("width",n*e.length).attr("height",r).attr("viewBox",`0 0 ${n*e.length} ${r}`).attr("xmlns","http://www.w3.org/2000/svg").style("cursor","pointer");o.append("text").attr("font-family","sans-serif").attr("x",n*e.length*.5+.1*n).attr("y",.95*r).attr("fill","rgb(0,255,235)").attr("font-size",1.2*n).attr("font-weight","bolder").attr("text-anchor","middle").style("mix-blend-mode",i).text(e),o.append("text").attr("font-family","sans-serif").attr("x",n*e.length*.5+.05*n).attr("y",.95*r).attr("fill","rgb(255,0,0)").attr("font-size",1.2*n).attr("font-weight","bolder").attr("text-anchor","middle").style("mix-blend-mode",i).text(e),sM.style.left=window.innerWidth/2-n*e.length/2+"px",sM.style.top=window.innerHeight/2-t/2+"px",sM.appendChild(o.node())}},sM=document.getElementById("info");var aM=0,lM=()=>aM=0,cM=2.5,uM=new ic(cM,cM),hM=new Ul(2.6,2.6,.05),dM=new cp(new Ul(2.65,2.65,.15)),pM=new Ul(2.65,.05,.15),fM=new Ul(.05,2.65,.15);const mM=e=>Number(e)?Number(e):Number("-"+e.substring(1)),gM=e=>{const t=document.getElementById("worldItemTooltip");[{name:"scale",extent:[.01,10],start:1,step:"0.01",threetype:"scale",axis:"all"},{name:"X position",extent:[-5,5],start:0,step:"0.01",threetype:"position",axis:"x"},{name:"Y position",extent:[-5,5],start:0,step:"0.01",threetype:"position",axis:"y"},{name:"Z position",extent:[-10,-1],start:0,step:"0.01",threetype:"position",axis:"z"},{name:"X rotation",extent:[-Math.PI,Math.PI],start:0,step:"0.01",threetype:"rotation",axis:"x"},{name:"Y rotation",extent:[-Math.PI,Math.PI],start:0,step:"0.01",threetype:"rotation",axis:"y"},{name:"Z rotation",extent:[-Math.PI,Math.PI],start:0,step:"0.01",threetype:"rotation",axis:"z"}].forEach((n=>{let r=document.createElement("div");r.className="worldTooltipDivs";let i=document.createElement("input"),o=document.createElement("input"),s=document.createElement("span");s.draggable=!1,i.style.pointerEvents="all",i.type="range",i.value=n.start,i.step=n.step,i.min=n.extent[0],i.max=n.extent[1],o.step=n.step,o.type="number",o.style="width:50px;pointer-events: all;margin: auto;",i.value=n.start,o.value=i.value,s.addEventListener("click",(()=>{i.value=n.start,"all"===n.axis?e[n.threetype].set(n.start,n.start,n.start):e[n.threetype][n.axis]=n.start})),o.addEventListener("input",(()=>{i.value=o.value,"all"===n.axis?e[n.threetype].set(i.value,i.value,i.value):e[n.threetype][n.axis]=i.value})),i.addEventListener("input",(()=>{o.value=i.value,"all"===n.axis?e[n.threetype].set(i.value,i.value,i.value):e[n.threetype][n.axis]=i.value})),s.innerText=n.name,s.className="worldTooltipLabel",r.appendChild(i),r.appendChild(o),r.appendChild(s),t.appendChild(r),r.addEventListener("dragstart",(e=>e.preventDefault()))}));const n=document.createElement("div");n.innerText=bP?"Grid snapping is toggled":"Grid snapping is untoggled",n.className="worldTooltipLabel",n.style="width: 200px;margin: auto;",n.addEventListener("click",(()=>{wP(),n.innerText=bP?"Grid snapping is toggled":"Grid snapping is untoggled"})),t.appendChild(document.createElement("br")),t.appendChild(n),t.appendChild(document.createElement("br"));const r=document.createElement("div");r.innerHTML="Use <b>H</b> to hang this item where it is.",t.appendChild(r),t.style.display="block"};var yM;ev.onmessage=e=>{e.data[1].hasOwnProperty("id")&&((e,t,n,r)=>{aM++,oM("LOADING PIECE "+aM+(US>0?"/"+US:""));var i=new Dh;rv(e).then((e=>{e.magFilter=ei;var o,s,a,l,c,u,h=new Za({map:e,transparent:!0,opacity:.45});if(e.image.height===e.image.width)o=new Dl(uM,h),(s=new Dl(hM,mv.ghost)).position.set(0,0,-.05),(dM=new Hd(dM,mv.blackLineLone)).position.set(0,0,0),(l=new Dl(pM,mv.ghost)).position.set(0,1.3,0),(a=new Dl(pM,mv.ghost)).position.set(0,-1.3,0),(c=new Dl(fM,mv.ghost)).position.set(-1.3,0,0),(u=new Dl(fM,mv.ghost)).position.set(1.3,0,0);else if(e.image.height>e.image.width){var d=cM*(e.image.width/e.image.height);o=new Dl(new ic(d,cM),h),(s=new Dl(new Ul(d+.1,2.6,.05),mv.ghost)).position.set(0,0,-.05),(dM=new Hd(new cp(new Ul(d+.15,2.65,.15)),mv.blackLineLone)).position.set(0,0,0),(l=new Dl(new Ul(d+.15,.05,.15),mv.ghost)).position.set(0,1.3,0),(a=new Dl(new Ul(d+.15,.05,.15),mv.ghost)).position.set(0,-1.3,0),(c=new Dl(fM,mv.ghost)).position.set(-(d/2+.05),0,0),(u=new Dl(fM,mv.ghost)).position.set(d/2+.05,0,0)}else{var p=cM*(e.image.height/e.image.width);o=new Dl(new ic(cM,p),h),(s=new Dl(new Ul(2.6,p+.1,.05),mv.hatchingMaterial)).position.set(0,0,-.05),(dM=new Hd(new cp(new Ul(2.65,p+.15,.15)),mv.blackLineLone)).position.set(0,0,0),(l=new Dl(pM,mv.ghost)).position.set(0,p/2+.05,0),(a=new Dl(pM,mv.ghost)).position.set(0,-(p/2+.05),0),(c=new Dl(new Ul(.05,p+.15,.15),mv.ghost)).position.set(-1.3,0,0),(u=new Dl(new Ul(.05,p+.15,.15),mv.ghost)).position.set(1.3,0,0)}switch(o.position.set(0,0,0),i.add(s,l,a,c,u,o),i.position.z=-4,o.userData.isWorldItem=!0,t&&(o.userData.objktID=t.id),i.position.y+=.5,t&&(i.userData.tokenType=n,i.userData.id=t.id),n){case"openSea":i.userData.openSeaMetaData={asset_contract_address:t.objkt.asset_contract.address,token_id:t.objkt.token_id};break;case"objkt":i.userData.objktMetaData={contract:tM[t.id].fa.contract,token_id:tM[t.id].token_id}}r?(i.children.forEach((e=>{"Mesh"===e.type&&("PlaneGeometry"===e.geometry.type?(e.material.opacity=1,e.material.transparent=!1):e.material=mv.whiteFull)})),i.position.set(mM(r.position.x),mM(r.position.y),mM(r.position.z)),i.rotation.set(mM(r.rotation.x),mM(r.rotation.y),mM(r.rotation.z)),i.scale.set(mM(r.scale.x),mM(r.scale.y),mM(r.scale.z)),tI.attach(i),ES()):(gM(i),nI.add(i)),setTimeout((()=>{oM()}),2e3)}))})(...e.data)};var vM,_M,wM,bM,xM=0,EM=0;const SM=(e,t)=>{Qy={},e.forEach((e=>$y(e.geometry))),EM=0;for(const e in Qy)Qy[e].forEach((e=>{if("BoxGeometry"===e.geometry.type)e.count++,qM||(e.count=Math.floor(2*e.count)),EM+=e.count,e.instanceNum=0,e.instancedMesh={isBox:!0,parameters:e.args};else if(e.count>1){e.count++,qM||(e.count=Math.floor(2*e.count+2)),e.instancedMesh=new Pd(e.geometry,mv.whiteFull,e.count),e.instancedMesh.geometry.center(),e.instancedMesh.instanceMatrix.needsUpdate=!0,e.instancedMesh.userData,t.push(e.instancedMesh),e.instanceNum=0;var n=new cp(e.instancedMesh.geometry),r=(new Tm).copy(n);r.center(),r.instanceCount=1/0;var i=qM?mv.blackLine:mv.redLine;if(i.needsUpdate=!0,e.instanceEdges=new Hd(r,i),e.instanceEdges.frustumCulled=!1,e.instanceEdges.userData.Params={pos:[],rot:[],scale:[]},!qM){var o=new cp(e.instancedMesh.geometry),s=(new Tm).copy(o);s.center(),s.instanceCount=1/0,e.instanceEdgesCyan=new Hd(s,mv.cyanLine),mv.cyanLine.needsUpdate=!0,e.instanceEdges.frustumCulled=!1,e.instanceEdges.userData.ParamsCyan={pos:[],rot:[],scale:[]}}}else e.instanceNum=-1}));if(EM>0){yM=new Pd(new Ul(1,1,1),mv.whiteFull,EM);var n=new cp(yM.geometry),r=(new Tm).copy(n);r.center(),r.instanceCount=1/0;var i,o=qM?mv.blackLine:mv.redLine;(vM=new Hd(r,o)).frustumCulled=!1,wM={pos:[],rot:[],scale:[]},qM||((i=(new Tm).copy(n)).center(),i.instanceCount=1/0,(_M=new Hd(i,mv.cyanLine)).frustumCulled=!1,bM={pos:[],rot:[],scale:[]}),xM=0}e.forEach((e=>{var n=$y(e.geometry);if(e.hasOwnProperty("parentGroup")&&(n.instanceNum=-1),e.hasOwnProperty("position")&&(e.pos=e.position),e.hasOwnProperty("rotation")&&(e.rot=e.position),e.attributes){const t=new vl;t.setAttribute("position",new el(e.attributes.positions,3)),n.geometry=t,n.edges=new cp(t),n.instanceNum=-1}n.instanceNum>-1||"BoxGeometry"===n.geometry.type&&!e.hasOwnProperty("parentGroup")?((({pos:e,rot:t,scale:n,mesh:r,i,fig:o,lines:s,count:a})=>{r.hasOwnProperty("isBox")&&(wM.pos.push(e.x,e.y,e.z),qM||(a=EM,bM.pos.push(e.x-.35,e.y-.05,e.z+.35)),n?(n.x=n.x*r.parameters[0],n.y=n.y*r.parameters[1],n.z=n.z*r.parameters[2]):((n=new ks(1,1,1)).x=r.parameters[0],n.y=r.parameters[1],n.z=r.parameters[2]),wM.scale.push(n.x,n.y,n.z),qM||bM.scale.push(n.x,n.y,n.z),(r=yM).isBox=!0,i=++xM);var l=new ks(e.x,e.y,e.z);const c=new xa(0,0,0,"XYZ"),u=new Ns;var h=new ks(1,1,1);n&&(h=new ks(n.x,n.y,n.z)),t&&c.set(t.x,t.y,t.z);const d=new da;var p;(u.setFromEuler(c),d.compose(l,u,h),o.hatch||o.full)&&(r.setMatrixAt(i,d),o.hatch&&(r.setColorAt(i,mv.whiteColor),qM||(l.x-=.35,l.y-=.05,l.z+=.35,(p=new da).compose(l,u,h),r.setMatrixAt(Math.floor(a/2+i),p),r.setColorAt(Math.floor(a/2+i),mv.whiteColor))),o.full&&(qM?r.setColorAt(i,mv.blackColor):(r.setColorAt(i,mv.redColor),l.x-=.35,l.y-=.05,l.z+=.35,(p=new da).compose(l,u,h),r.setMatrixAt(a/2+i,p),r.setColorAt(a/2+i,mv.cyanColor))));r.hasOwnProperty("isBox")||(s.userData.Params.pos.push(e.x,e.y,e.z),s.userData.Params.rot.push(u.x,u.y,u.z,u.w),s.userData.Params.scale.push(h.x,h.y,h.z),qM||(s.userData.ParamsCyan.pos.push(e.x-.35,e.y-.05,e.z+.35),s.userData.ParamsCyan.rot.push(u.x,u.y,u.z,u.w),s.userData.ParamsCyan.scale.push(h.x,h.y,h.z))),r.hasOwnProperty("isBox")&&(wM.rot.push(u.x,u.y,u.z,u.w),qM||bM.rot.push(u.x,u.y,u.z,u.w))})({pos:e.pos,rot:e.rot,scale:e.scale,mesh:n.instancedMesh,i:n.instanceNum,fig:e,lines:n.instanceEdges,count:n.count}),n.instanceNum++):((e,t,n)=>{var r;(e.hatch||e.full||e.lines)&&(n&&(r=function(e,t,n,r){var i=[],o=!!t&&mv.whiteFull;if(qM){if(o=n?mv.blackFull:o,n||t){var s=new Dl(e.geometry,o);s.userData.color="black",i.push(s)}r&&((r=new Hd(e.edges,mv.blackLineLone)).userData.color="black",i.push(r))}else{if(n||t){o=n?mv.redFull:o;var a=new Dl(e.geometry,o);a.userData.color="red",o=n?mv.cyanFull:o;var l=new Dl(e.geometry,o);l.userData.color="cyan",i.push(a,l)}if(r){var c=new Hd(e.edges,mv.redLineLone);c.userData.color="red";var u=new Hd(e.edges,mv.cyanLineLone);u.userData.color="cyan",i.push(c,u)}}return i}(n,e.hatch,e.full,e.lines)),r.forEach((n=>{e.hasOwnProperty("uncentered")&&e.uncentered||n.geometry.center(),n.position.set(e.pos.x,e.pos.y,e.pos.z),"cyan"===n.userData.color&&(n.position.x-=.35,n.position.y-=.05,n.position.z+=.35),e.hasOwnProperty("rot")&&n.rotation.set(e.rot.x,e.rot.y,e.rot.z),e.hasOwnProperty("scale")&&n.scale.set(e.scale.x,e.scale.y,e.scale.z),e.hasOwnProperty("parentGroup")?MM[e.parentGroup].add(n):t.push(n)})))})(e,t,n)})),yM&&r&&(r.setAttribute("instT",new Td(new Float32Array(wM.pos),3)),r.setAttribute("instR",new Td(new Float32Array(wM.rot),4)),r.setAttribute("instS",new Td(new Float32Array(wM.scale),3)),t.push(yM,vM),qM||(i.setAttribute("instT",new Td(new Float32Array(bM.pos),3)),i.setAttribute("instR",new Td(new Float32Array(bM.rot),4)),i.setAttribute("instS",new Td(new Float32Array(bM.scale),3)),t.push(_M)),yM.instanceColor&&(yM.instanceColor.needsUpdate=!0));for(const e in Qy)Qy[e].forEach((e=>{e.hasOwnProperty("instanceMesh")&&(e.instanceMesh.instanceColor.needsUpdate=!0),e.hasOwnProperty("instanceEdges")&&(e.instanceEdges.geometry.setAttribute("instT",new Td(new Float32Array(e.instanceEdges.userData.Params.pos),3)),e.instanceEdges.geometry.setAttribute("instR",new Td(new Float32Array(e.instanceEdges.userData.Params.rot),4)),e.instanceEdges.geometry.setAttribute("instS",new Td(new Float32Array(e.instanceEdges.userData.Params.scale),3)),t.push(e.instanceEdges),qM||(e.instanceEdgesCyan.geometry.setAttribute("instT",new Td(new Float32Array(e.instanceEdges.userData.ParamsCyan.pos),3)),e.instanceEdgesCyan.geometry.setAttribute("instR",new Td(new Float32Array(e.instanceEdges.userData.ParamsCyan.rot),4)),e.instanceEdgesCyan.geometry.setAttribute("instS",new Td(new Float32Array(e.instanceEdges.userData.ParamsCyan.scale),3)),t.push(e.instanceEdgesCyan)))}))};var MM={};const TM=(e,t,n,r,i)=>{const o=[];var s=[];(e=>{if(MM={},e)for(const n in e){var t=e[n];MM[n]=new Dh,t.hasOwnProperty("pos")&&MM[n].position.set(t.pos.x,t.pos.y,t.pos.z),t.hasOwnProperty("rot")&&MM[n].rotation.set(t.rot.x,t.rot.y,t.rot.z)}})(r),SM(t,o);for(const e in MM){var a=MM[e];(new Us).setFromObject(a).getCenter(a.position).multiplyScalar(-1),o.push(a)}var l=new Dh;l.userData.color="red","roomGroup"===e.name?(function(){for(let n=0;n<o.length;n++)if("roomGroup"===e.name){if(o[n].isGroup||o[n].isLineSegments){if(o[n].isGroup){var t=[];o[n].updateWorldMatrix(!1,!0),o[n].children.forEach((e=>{if(e.material===mv.whiteFull){e.updateMatrixWorld(!0);var n=e.geometry.clone();n.applyMatrix4(e.matrixWorld);for(const e in n.attributes)"position"!==e&&n.deleteAttribute(e);(n=n.toNonIndexed()).index=null,t.push(n)}}));const e=Jy(t,!1);e.userData.groupMerged=!0,s.push(e)}}else o[n].userData.groupMerged=!1,s.push(o[n]);l.add(o[n])}}(),(e=>{const t=[];e.forEach((e=>{if(e.userData.groupMerged)t.push(e);else if(e.isInstancedMesh){var n=qM?e.instanceMatrix.count:Math.floor(e.instanceMatrix.count/2);for(let o=0;o<n;o++){i=e.geometry.clone();var r=new da;e.getMatrixAt(o,r),i.applyMatrix4(r);for(const e in i.attributes)"position"!==e&&i.deleteAttribute(e);(i=i.toNonIndexed()).index=null,t.push(i)}}else{var i;e.updateMatrixWorld(!0),(i=e.geometry.clone()).applyMatrix4(e.matrixWorld);for(const e in i.attributes)"position"!==e&&i.deleteAttribute(e);(i=i.toNonIndexed()).index=null,t.push(i)}}));const n=Jy(t,!1);n.boundsTree=new mS(n,{lazyGeneration:!0}),xS=new Dl(n,mv.whiteFull),(bS=new Dl(n,mv.cyanFull)).name="collider",bS.material.wireframe=!1,bS.visible=!1})(s)):o.forEach((e=>l.add(e)));var c=!1;if(l.userData.fxMetaData={genid:i.genid,hash:i.hash,objktid:i.objktid},"movingGroup"===e.name)if(i.loc){e=tI;const t=i.loc;l.position.set(mM(t.position.x),mM(t.position.y),mM(t.position.z)),l.rotation.set(mM(t.rotation.x),mM(t.rotation.y),mM(t.rotation.z)),l.scale.set(mM(t.scale.x),mM(t.scale.y),mM(t.scale.z)),c=!0,tI.attach(l),ES()}else l.userData.tokenType="sculpture",l.position.z-=4;c||e.add(l),setTimeout((()=>{oM()}),1500),console.log("%cLoading new anaver.se native content.","font-weight:bolder;text-decoration:underline")};var AM={room:0,skybox:0,gallery:[]};const RM=new Worker(new URL(n.p+n.u(861),n.b));var CM;"undefined"!=typeof OffscreenCanvas?CM=new Worker(new URL(n.p+n.u(608),n.b)):setTimeout((()=>{console.log("This browser does not support offscreen canvas."),nT()}),250);var LM=!0;const PM=["PAINTING THE SKIES","CALLING THE UNIVERSE","SHUFFLING THE COSMOS","GENERATING INFINITY"],IM=["CHANGING LOCATION","GOING SOMEWHERE ELSE","PLANNING ESCAPE","BEAM ME UP SCOTTY","VERSING ANA","GENERATING VERTICES","INSTANCIATING MESHES","UNFRIENDING GPU"],OM=e=>e[Math.floor(Math.random()*e.length)],NM=(e,t)=>{const n=t.toUpperCase();"firstPerson"===e?(document.getElementById("firstPersonLegendR").innerText=n,document.getElementById("firstPersonLegendG").innerText=n):"room"===e&&(document.getElementById("roomLegendR").innerText=n,document.getElementById("roomLegendG").innerText=n)},kM=(e,t,n,i,o)=>{if(e)if(e.hasOwnProperty("tag")&&e.tag.room&&(AM.room=t,AM.gallery=[]),"skybox"===e.type){AM.skybox=t;var s=1.75*window.innerHeight,a=e.skyboxUrl;oM(OM(PM)),"undefined"!=typeof OffscreenCanvas&&CM.postMessage({side:s,skyurl:a,hash:n})}else{var l;e.hasOwnProperty("tag")&&(l=e.tag),0===r["Tlchargement premier espace"]["dbut"]&&(r["Tlchargement premier espace"]["dbut"]=performance.now()),l.room&&oM(OM(IM)),RM.postMessage({figuresUrl:e.figuresUrl,hash:n,type:e.type,tag:l,name:i,loc:o,genid:e.id,objktid:t})}};var DM={},BM=0;"undefined"!=typeof OffscreenCanvas&&(CM.onmessage=e=>{6==++BM?(DM[e.data.pos]=e.data.imagedata,uI(DM,e.data.side),DM={},BM=0):DM[e.data.pos]=e.data.imagedata}),RM.onmessage=function(e){const t=e.data;switch(t.type){case"firstPerson":if(QP.clear(),TM(QP,t.figures,0,t.groups,t),QP.scale.set(.1,.1,.1),t.features.hasOwnProperty("fpLoc")){const e=t.features.fpLoc;QP.rotation.set(e.rot.x,e.rot.y,e.rot.z),QP.position.set(e.pos.x,e.pos.y,e.pos.z)}else QP.position.set(.1,-.11,-.1),QP.rotation.y=-Math.PI/2;"string"==typeof e.data.name&&NM(t.type,e.data.name);break;case"world":t.tag.room?(aI&&(aI.moveSpeed=100),tI.clear(),eI.clear(),LM&&(LM=!1,r["Tlchargement premier espace"].fin=performance.now(),r["Cration Monde"]["dbut"]=performance.now()),sI.position.x=0,sI.position.y=100,sI.position.z=0,t.features,"string"==typeof e.data.name&&NM("room",e.data.name),eI.clear(),TM(eI,t.figures,0,t.groups,t),qM||(eI.children[0].position.z=.1)):t.tag.item&&TM(nI,t.figures,0,t.groups,t)}};const UM=document.getElementById("titleG"),zM=document.getElementById("titleR"),FM=document.getElementById("landingTitle"),HM=document.getElementById("hider"),GM=(document.getElementById("titleG"),document.getElementById("titleG"),document.getElementById("enter")),VM=document.getElementById("enterG"),jM=document.getElementById("enterR"),WM=document.getElementById("tips");var qM=!0,KM=document.getElementById("perfMode"),XM="";const YM=window.localStorage;document.getElementById("tutorial").addEventListener("click",(()=>{FS(jS),setTimeout((()=>{JM()}),400)})),WM.children[0].innerText="Use the Chrome web browser (or another chromium-based user agent) to get the best results.";const JM=()=>{VM.innerText="ENTER TUTORIAL",jM.innerText="ENTER TUTORIAL",GM.addEventListener("click",KS),nT()};YM.getItem("mode")?"monochrome"===YM.getItem("mode")?qM=!0:(qM=!1,KM.innerText="anaglyphic mode activated"):YM.setItem("mode","monochrome"),KM.addEventListener("click",(()=>{qM?(YM.setItem("mode","anaglyphic"),qM=!1,KM.innerText="anaglyphic mode activated",QP.clear(),eI.clear(),FS(AM),KM.style.pointerEvents="none",KM.style.cursor="none"):(YM.setItem("mode","monochrome"),qM=!0,KM.innerText="monochrome mode activated")}));const ZM=()=>{DS&&(RS.play(),OS=!0,IS.innerHTML='<img  style="width:15px;height:15px" src="stop.svg">');const e=window.location.search,t=new URLSearchParams(e);0!==Zx.length||t.has("wallet")||iM("tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"),aI.lock(),rI(),HM.style.animation="hide .8s linear forwards",setTimeout((()=>{HM.style.display="none"}),1e3)};GM.addEventListener("click",ZM);var QM=!1,$M=1;document.body.addEventListener("touchstart",(()=>{document.body.requestFullscreen(),$M=2,document.getElementById("barcode").addEventListener("click",lI)})),document.getElementById("helper").addEventListener("touchstart",(()=>{document.getElementById("helper").style.display="none"})),GM.addEventListener("touchstart",(()=>{QM||(QM=!0,iT(),setTimeout((()=>{ZM()}),2e3))}));const eT=(e,t)=>{XM=e,document.getElementById("walletSync").style.animation="reveal .8s linear forwards",e&&(t?(UM.innerHTML=e+"<br>x<br>ANAVER.SE",zM.innerHTML=e+"<br>x<br>ANAVER.SE",document.title=e+" x ANAVER.SE"):(UM.innerHTML=e.toUpperCase()+"'S<br>ANAVER.SE",zM.innerHTML=e.toUpperCase()+"'S<br>ANAVER.SE",document.title=e.toUpperCase()+"'S ANAVER.SE")),document.getElementById("barcode").style.animation="reveal .8s linear forwards",FM.style.animation="reveal .8s linear forwards"};var tT=!1;const nT=()=>{tT||(tT=!0,rT()||(GM.style.display="flex",GM.style.animation="reveal .5s linear forwards"),GM.style.pointerEvents="all",zn("#barrouge").transition().duration(500).attr("transform","translate(-2,0)"),zn("#barcyan").transition().duration(500).attr("transform","translate(2,0)"),UM.style.animation="shift .5s linear forwards",zM.style.animation="unshift .5s linear forwards",document.getElementById("enterR").style.animation="unshift .5s linear forwards",document.getElementById("enterG").style.animation="shift .5s linear forwards",r["Cration Monde"].fin=performance.now(),r["Total ANAVER.SE"].fin=performance.now(),setTimeout((()=>{horlogesLog()}),2500))},rT=()=>{if(window.innerWidth<window.innerHeight)return!0},iT=()=>{"landscape-primary"===screen.orientation.type&&screen.orientation.lock("landscape-primary"),FM.style.display="flex",GM.style.display="flex",document.getElementById("mobile-control").style.display="block";const e=document.getElementById("loader-button"),t=document.getElementById("gallery-button"),n=document.getElementById("hang-button");e.style.width=.05*window.innerWidth+"px",e.style.height=.05*window.innerWidth+"px",t.style.width=.05*window.innerWidth+"px",t.style.height=.05*window.innerWidth+"px",n.style.width=.05*window.innerWidth+"px",n.style.height=.05*window.innerWidth+"px"},oT={KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi19:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi18:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi17:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi16:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi15:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi14:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi13:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi12:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi11:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi10:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi9:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi8:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi7:!0,KT1QxtxxoXwvVEPFhe4CaSrdj1DCaLYYrxuU0:!0};var sT=gv.gql`
  {
    token_tag(where: { tag: { name: { _eq: "anaverse-gallery" } } }) {
      token {
        creators {
          creator_address
        }
        fa_contract
        token_id
        artifact_uri
        thumbnail_uri
        holders {
          holder_address
        }
      }
    }
  }
`;const aT=[],lT=window.location.search,cT=new URLSearchParams(lT),uT=e=>{let t,n=e.length;for(;0!=n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},hT=new Worker(new URL(n.p+n.u(321),n.b));var dT=[];const pT={},fT=e=>{xv(e).then((()=>{for(const n in pT){var e=bv[n];if(e){if(e.twitter||e.alias||e.logo){const n=document.createElement("div");n.className="artThumbTitle";const r=e.twitter?`@${e.twitter}`:"",i=document.createElement("div");i.className="artistNames";var t="";if(e.alias&&(t=e.alias.length<50?e.alias:e.alias.substring(0,50)+""),i.innerHTML=`<span>${t}</span>\n      <span><a href="${e.twitter}" target="_blank">${r.replace("https://twitter.com/","")}</a></span>`,e.logo){if(e.logo.indexOf("ipfs")>-1){const t=document.createElement("img");t.className="profilePic",t.src=e.logo,t.addEventListener("error",(()=>t.style.display="none")),n.appendChild(t)}n.appendChild(i),e.DOM=n}}pT[n]=e}}}))};var mT=!0;const gT=window.localStorage;hT.onmessage=e=>{switch(e.data.type){case"remote":!function(e){var t=0,n=e.data,r=new Image(200);r.src="https://assets.objkt.media/file/assets-003/"+n.thumbnail.replace("ipfs://","")+"/thumbnail",r.className="thumbnail",r.onerror=()=>{n.DOMthumb=""},n.DOMthumb=r,oT.hasOwnProperty(n.contract+n.id)?n.template=!0:n.template=!1,aT.push(n),cT.get("gallery")&&cT.get("galc")===n.contract&&cT.get("galid")===n.id&&(t=n),t?(FS(t),eT()):mT&&cT.get("autogalgen")&&(mT=!1,wT(cT.get("autogalgen"),cT.get("autogalid"))),function(){aT.forEach((e=>{pT.hasOwnProperty(e.curator)||(pT[e.curator]=!0)}));var e=[];for(const t in pT)e.push(t);fT(e)}()}(e);break;case"local":!function(e){var t=JSON.parse(gT.getItem("localGalleries"));t?(t.push(e.data),gT.setItem("localGalleries",JSON.stringify(t))):gT.setItem("localGalleries",JSON.stringify([e.data])),mP(),pP(XS),mP()}(e)}r["Galleries Natives"].fin=window.performance.now()};var yT=[];function vT(e,t,n){1===t&&(yT=[]),fetch(e+"/"+t).then((e=>e.json())).then((r=>{if(r.curatedTokens.forEach((e=>yT.push(e))),yT.length<r.curatedTokensConnection.aggregate.count)vT(e,t+1,n);else{var i=[];aT.forEach((e=>{e.gallery.length>9&&e.template&&i.push(e)}));var o=i[Math.floor(Math.random()*i.length)];const e={};Object.assign(e,o);for(let t=0;t<e.gallery.length;t++)"block"!=e.gallery[t].tokenType&&"sculpture"!=e.gallery[t].tokenType&&(yT[t]?(e.gallery[t].tokenType="objkt",e.gallery[t].objktMetaData={contract:yT[t].contract,token_id:JSON.stringify(yT[t].tokenId)}):e.gallery[t]=!1);var s=[];e.gallery.forEach((e=>e?s.push(e):0)),e.gallery=s,e.collection="OBJKT's Gems - "+n,e.contract="",e.curator="tz1LaqjdBZvJ2drBq8Zp9jF3HGhfqjHZm9Ny",FS(e)}}))}var _T=[];const wT=(e,t)=>{switch(e){case"objkt":eT("objkt.com",!0),vT(n="https://back.objkt.com/api/v1/cms/curation/tokens/"+t,1,t);break;case"versum":eT("versum",!0);var n="https://versum.xyz/api/anaverse/boards/"+t;fetch(n).then((e=>e.json())).then((e=>{_T=[...e.tokens];var t=[];aT.forEach((e=>{e.gallery.length>=_T.length&&e.template&&t.push(e)}));var n=t[Math.floor(Math.random()*t.length)];const r={};Object.assign(r,n),r.gallery.forEach((e=>{e.hasOwnProperty("objktMetaData")&&(e.objktMetaData={})}));for(let e=0;e<r.gallery.length;e++)"block"!=r.gallery[e].tokenType&&"sculpture"!=r.gallery[e].tokenType&&(_T[e]?(r.gallery[e].tokenType="objkt",r.gallery[e].objktMetaData={contract:_T[e].contract,token_id:JSON.stringify(_T[e].tokenId)}):r.gallery[e]=!1);var i=[];r.gallery.forEach((e=>e?i.push(e):0)),r.gallery=i,r.collection="Versum boards - "+e.info.title,r.contract="",r.curator=e.info.user.name,FS(r)}))}},bT=[];var xT=[];function ET(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ST(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var MT,TT,AT,RT,CT,LT,PT,IT,OT,NT,kT,DT,BT,UT={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},zT={duration:.5,overwrite:!1,delay:0},FT=1e8,HT=1e-8,GT=2*Math.PI,VT=GT/4,jT=0,WT=Math.sqrt,qT=Math.cos,KT=Math.sin,XT=function(e){return"string"==typeof e},YT=function(e){return"function"==typeof e},JT=function(e){return"number"==typeof e},ZT=function(e){return void 0===e},QT=function(e){return"object"==typeof e},$T=function(e){return!1!==e},eA=function(){return"undefined"!=typeof window},tA=function(e){return YT(e)||XT(e)},nA="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},rA=Array.isArray,iA=/(?:-?\.?\d|\.)+/gi,oA=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,sA=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,aA=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,lA=/[+-]=-?[.\d]+/,cA=/[^,'"\[\]\s]+/gi,uA=/[\d.+\-=]+(?:e[-+]\d*)*/i,hA={},dA={},pA=function(e){return(dA=UA(e,hA))&&SC},fA=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},mA=function(e,t){return!t&&console.warn(e)},gA=function(e,t){return e&&(hA[e]=t)&&dA&&(dA[e]=t)||hA},yA=function(){return 0},vA={},_A=[],wA={},bA={},xA={},EA=30,SA=[],MA="",TA=function(e){var t,n,r=e[0];if(QT(r)||YT(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(n=SA.length;n--&&!SA[n].targetTest(r););t=SA[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new YR(e[n],t)))||e.splice(n,1);return e},AA=function(e){return e._gsap||TA(fR(e))[0]._gsap},RA=function(e,t,n){return(n=e[t])&&YT(n)?e[t]():ZT(n)&&e.getAttribute&&e.getAttribute(t)||n},CA=function(e,t){return(e=e.split(",")).forEach(t)||e},LA=function(e){return Math.round(1e5*e)/1e5||0},PA=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},IA=function(){var e,t,n=_A.length,r=_A.slice(0);for(wA={},_A.length=0,e=0;e<n;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},OA=function(e,t,n,r){_A.length&&IA(),e.render(t,n,r),_A.length&&IA()},NA=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(cA).length<2?t:XT(e)?e.trim():e},kA=function(e){return e},DA=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},BA=function(e,t){for(var n in t)n in e||"duration"===n||"ease"===n||(e[n]=t[n])},UA=function(e,t){for(var n in t)e[n]=t[n];return e},zA=function e(t,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(t[r]=QT(n[r])?e(t[r]||(t[r]={}),n[r]):n[r]);return t},FA=function(e,t){var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},HA=function(e){var t=e.parent||TT,n=e.keyframes?BA:DA;if($T(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},GA=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=t._prev,o=t._next;i?i._next=o:e[n]===t&&(e[n]=o),o?o._prev=i:e[r]===t&&(e[r]=i),t._next=t._prev=t.parent=null},VA=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},jA=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},WA=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},qA=function e(t){return!t||t._ts&&e(t.parent)},KA=function(e){return e._repeat?XA(e._tTime,e=e.duration()+e._rDelay)*e:0},XA=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},YA=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},JA=function(e){return e._end=LA(e._start+(e._tDur/Math.abs(e._ts||e._rts||HT)||0))},ZA=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=LA(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),JA(e),n._dirty||jA(n,e)),e},QA=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=YA(e.rawTime(),t),(!t._dur||uR(0,t.totalDuration(),n)-t._tTime>HT)&&t.render(n,!0)),jA(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},$A=function(e,t,n,r){return t.parent&&VA(t),t._start=LA((JT(n)?n:n||e!==TT?aR(e,n,t):e._time)+t._delay),t._end=LA(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),function(e,t,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var o,s=e[r];if(i)for(o=t[i];s&&s[i]>o;)s=s._prev;s?(t._next=s._next,s._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=s,t.parent=t._dp=e}(e,t,"_first","_last",e._sort?"_start":0),rR(t)||(e._recent=t),r||QA(e,t),e},eR=function(e,t){return(hA.ScrollTrigger||fA("scrollTrigger",t))&&hA.ScrollTrigger.create(t,e)},tR=function(e,t,n,r){return nC(e,t),e._initted?!n&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&PT!==DR.frame?(_A.push(e),e._lazy=[t,r],1):void 0:1},nR=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},rR=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},iR=function(e,t,n,r){var i=e._repeat,o=LA(t)||0,s=e._tTime/e._tDur;return s&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=i?i<0?1e10:LA(o*(i+1)+e._rDelay*i):o,s&&!r?ZA(e,e._tTime=e._tDur*s):e.parent&&JA(e),n||jA(e.parent,e),e},oR=function(e){return e instanceof ZR?jA(e):iR(e,e._dur)},sR={_start:0,endTime:yA,totalDuration:yA},aR=function e(t,n,r){var i,o,s,a=t.labels,l=t._recent||sR,c=t.duration()>=FT?l.endTime(!1):t._dur;return XT(n)&&(isNaN(n)||n in a)?(o=n.charAt(0),s="%"===n.substr(-1),i=n.indexOf("="),"<"===o||">"===o?(i>=0&&(n=n.replace(/=/,"")),("<"===o?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(s?(i<0?l:r).totalDuration()/100:1)):i<0?(n in a||(a[n]=c),a[n]):(o=parseFloat(n.charAt(i-1)+n.substr(i+1)),s&&r&&(o=o/100*(rA(r)?r[0]:r).totalDuration()),i>1?e(t,n.substr(0,i-1),r)+o:c+o)):null==n?c:+n},lR=function(e,t,n){var r,i,o=JT(t[1]),s=(o?2:1)+(e<2?0:1),a=t[s];if(o&&(a.duration=t[1]),a.parent=n,e){for(r=a,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=$T(i.vars.inherit)&&i.parent;a.immediateRender=$T(r.immediateRender),e<2?a.runBackwards=1:a.startAt=t[s-1]}return new sC(t[0],a,t[s+1])},cR=function(e,t){return e||0===e?t(e):t},uR=function(e,t,n){return n<e?e:n>t?t:n},hR=function(e){if("string"!=typeof e)return"";var t=uA.exec(e);return t?e.substr(t.index+t[0].length):""},dR=[].slice,pR=function(e,t){return e&&QT(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&QT(e[0]))&&!e.nodeType&&e!==AT},fR=function(e,t,n){return!XT(e)||n||!RT&&BR()?rA(e)?function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var r;return XT(e)&&!t||pR(e,1)?(r=n).push.apply(r,fR(e)):n.push(e)}))||n}(e,n):pR(e)?dR.call(e,0):e?[e]:[]:dR.call((t||CT).querySelectorAll(e),0)},mR=function(e){return e.sort((function(){return.5-Math.random()}))},gR=function(e){if(YT(e))return e;var t=QT(e)?e:{each:e},n=jR(t.ease),r=t.from||0,i=parseFloat(t.base)||0,o={},s=r>0&&r<1,a=isNaN(r)||s,l=t.axis,c=r,u=r;return XT(r)?c=u={center:.5,edges:.5,end:1}[r]||0:!s&&a&&(c=r[0],u=r[1]),function(e,s,h){var d,p,f,m,g,y,v,_,w,b=(h||t).length,x=o[b];if(!x){if(!(w="auto"===t.grid?0:(t.grid||[1,FT])[1])){for(v=-FT;v<(v=h[w++].getBoundingClientRect().left)&&w<b;);w--}for(x=o[b]=[],d=a?Math.min(w,b)*c-.5:r%w,p=a?b*u/w-.5:r/w|0,v=0,_=FT,y=0;y<b;y++)f=y%w-d,m=p-(y/w|0),x[y]=g=l?Math.abs("y"===l?m:f):WT(f*f+m*m),g>v&&(v=g),g<_&&(_=g);"random"===r&&mR(x),x.max=v-_,x.min=_,x.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(w>b?b-1:l?"y"===l?b/w:w:Math.max(w,b/w))||0)*("edges"===r?-1:1),x.b=b<0?i-b:i,x.u=hR(t.amount||t.each)||0,n=n&&b<0?GR(n):n}return b=(x[e]-x.min)/x.max||0,LA(x.b+(n?n(b):b)*x.v)+x.u}},yR=function(e){var t=e<1?Math.pow(10,(e+"").length-2):1;return function(n){var r=Math.round(parseFloat(n)/e)*e*t;return(r-r%1)/t+(JT(n)?0:hR(n))}},vR=function(e,t){var n,r,i=rA(e);return!i&&QT(e)&&(n=i=e.radius||FT,e.values?(e=fR(e.values),(r=!JT(e[0]))&&(n*=n)):e=yR(e.increment)),cR(t,i?YT(e)?function(t){return r=e(t),Math.abs(r-t)<=n?r:t}:function(t){for(var i,o,s=parseFloat(r?t.x:t),a=parseFloat(r?t.y:0),l=FT,c=0,u=e.length;u--;)(i=r?(i=e[u].x-s)*i+(o=e[u].y-a)*o:Math.abs(e[u]-s))<l&&(l=i,c=u);return c=!n||l<=n?e[c]:t,r||c===t||JT(t)?c:c+hR(t)}:yR(e))},_R=function(e,t,n,r){return cR(rA(e)?!t:!0===n?!!(n=0):!r,(function(){return rA(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r}))},wR=function(e,t,n){return cR(n,(function(n){return e[~~t(n)]}))},bR=function(e){for(var t,n,r,i,o=0,s="";~(t=e.indexOf("random(",o));)r=e.indexOf(")",t),i="["===e.charAt(t+7),n=e.substr(t+7,r-t-7).match(i?cA:iA),s+=e.substr(o,t-o)+_R(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),o=r+1;return s+e.substr(o,e.length-o)},xR=function(e,t,n,r,i){var o=t-e,s=r-n;return cR(i,(function(t){return n+((t-e)/o*s||0)}))},ER=function(e,t,n){var r,i,o,s=e.labels,a=FT;for(r in s)(i=s[r]-t)<0==!!n&&i&&a>(i=Math.abs(i))&&(o=r,a=i);return o},SR=function(e,t,n){var r,i,o=e.vars,s=o[t];if(s)return r=o[t+"Params"],i=o.callbackScope||e,n&&_A.length&&IA(),r?s.apply(i,r):s.call(i)},MR=function(e){return VA(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&SR(e,"onInterrupt"),e},TR=function(e){var t=(e=!e.name&&e.default||e).name,n=YT(e),r=t&&!n&&e.init?function(){this._props=[]}:e,i={init:yA,render:mC,add:eC,kill:yC,modifier:gC,rawVars:0},o={targetTest:0,get:0,getSetter:hC,aliases:{},register:0};if(BR(),e!==r){if(bA[t])return;DA(r,DA(FA(e,i),o)),UA(r.prototype,UA(i,FA(e,o))),bA[r.prop=t]=r,e.targetTest&&(SA.push(r),vA[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}gA(t,r),e.register&&e.register(SC,r,wC)},AR=255,RR={aqua:[0,AR,AR],lime:[0,AR,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,AR],navy:[0,0,128],white:[AR,AR,AR],olive:[128,128,0],yellow:[AR,AR,0],orange:[AR,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[AR,0,0],pink:[AR,192,203],cyan:[0,AR,AR],transparent:[AR,AR,AR,0]},CR=function(e,t,n){return(6*(e=e<0?e+1:e>1?e-1:e)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*AR+.5|0},LR=function(e,t,n){var r,i,o,s,a,l,c,u,h,d,p=e?JT(e)?[e>>16,e>>8&AR,e&AR]:0:RR.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),RR[e])p=RR[e];else if("#"===e.charAt(0)){if(e.length<6&&(r=e.charAt(1),i=e.charAt(2),o=e.charAt(3),e="#"+r+r+i+i+o+o+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&AR,p&AR,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&AR,e&AR]}else if("hsl"===e.substr(0,3))if(p=d=e.match(iA),t){if(~e.indexOf("="))return p=e.match(oA),n&&p.length<4&&(p[3]=1),p}else s=+p[0]%360/360,a=+p[1]/100,r=2*(l=+p[2]/100)-(i=l<=.5?l*(a+1):l+a-l*a),p.length>3&&(p[3]*=1),p[0]=CR(s+1/3,r,i),p[1]=CR(s,r,i),p[2]=CR(s-1/3,r,i);else p=e.match(iA)||RR.transparent;p=p.map(Number)}return t&&!d&&(r=p[0]/AR,i=p[1]/AR,o=p[2]/AR,l=((c=Math.max(r,i,o))+(u=Math.min(r,i,o)))/2,c===u?s=a=0:(h=c-u,a=l>.5?h/(2-c-u):h/(c+u),s=c===r?(i-o)/h+(i<o?6:0):c===i?(o-r)/h+2:(r-i)/h+4,s*=60),p[0]=~~(s+.5),p[1]=~~(100*a+.5),p[2]=~~(100*l+.5)),n&&p.length<4&&(p[3]=1),p},PR=function(e){var t=[],n=[],r=-1;return e.split(OR).forEach((function(e){var i=e.match(sA)||[];t.push.apply(t,i),n.push(r+=i.length+1)})),t.c=n,t},IR=function(e,t,n){var r,i,o,s,a="",l=(e+a).match(OR),c=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map((function(e){return(e=LR(e,t,1))&&c+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(o=PR(e),(r=n.c).join(a)!==o.c.join(a)))for(s=(i=e.replace(OR,"1").split(sA)).length-1;u<s;u++)a+=i[u]+(~r.indexOf(u)?l.shift()||c+"0,0,0,0)":(o.length?o:l.length?l:n).shift());if(!i)for(s=(i=e.split(OR)).length-1;u<s;u++)a+=i[u]+l[u];return a+i[s]},OR=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in RR)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),NR=/hsl[a]?\(/,kR=function(e){var t,n=e.join(" ");if(OR.lastIndex=0,OR.test(n))return t=NR.test(n),e[1]=IR(e[1],t),e[0]=IR(e[0],t,PR(e[1])),!0},DR=function(){var e,t,n,r,i,o,s=Date.now,a=500,l=33,c=s(),u=c,h=1e3/240,d=h,p=[],f=function n(f){var m,g,y,v,_=s()-u,w=!0===f;if(_>a&&(c+=_-l),((m=(y=(u+=_)-c)-d)>0||w)&&(v=++r.frame,i=y-1e3*r.time,r.time=y/=1e3,d+=m+(m>=h?4:h-m),g=1),w||(e=t(n)),g)for(o=0;o<p.length;o++)p[o](y,i,v,f)};return r={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(e){return i/(1e3/(e||60))},wake:function(){LT&&(!RT&&eA()&&(AT=RT=window,CT=AT.document||{},hA.gsap=SC,(AT.gsapVersions||(AT.gsapVersions=[])).push(SC.version),pA(dA||AT.GreenSockGlobals||!AT.gsap&&AT||{}),n=AT.requestAnimationFrame),e&&r.sleep(),t=n||function(e){return setTimeout(e,d-1e3*r.time+1|0)},OT=1,f(2))},sleep:function(){(n?AT.cancelAnimationFrame:clearTimeout)(e),OT=0,t=yA},lagSmoothing:function(e,t){a=e||1e8,l=Math.min(t,a,0)},fps:function(e){h=1e3/(e||240),d=1e3*r.time+h},add:function(e){p.indexOf(e)<0&&p.push(e),BR()},remove:function(e){var t;~(t=p.indexOf(e))&&p.splice(t,1)&&o>=t&&o--},_listeners:p}}(),BR=function(){return!OT&&DR.wake()},UR={},zR=/^[\d.\-M][\d.\-,\s]/,FR=/["']/g,HR=function(e){for(var t,n,r,i={},o=e.substr(1,e.length-3).split(":"),s=o[0],a=1,l=o.length;a<l;a++)n=o[a],t=a!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,t),i[s]=isNaN(r)?r.replace(FR,"").trim():+r,s=n.substr(t+1).trim();return i},GR=function(e){return function(t){return 1-e(1-t)}},VR=function e(t,n){for(var r,i=t._first;i;)i instanceof ZR?e(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?e(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},jR=function(e,t){return e&&(YT(e)?e:UR[e]||function(e){var t,n,r,i,o=(e+"").split("("),s=UR[o[0]];return s&&o.length>1&&s.config?s.config.apply(null,~e.indexOf("{")?[HR(o[1])]:(t=e,n=t.indexOf("(")+1,r=t.indexOf(")"),i=t.indexOf("(",n),t.substring(n,~i&&i<r?t.indexOf(")",r+1):r)).split(",").map(NA)):UR._CE&&zR.test(e)?UR._CE("",e):s}(e))||t},WR=function(e,t,n,r){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===r&&(r=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,o={easeIn:t,easeOut:n,easeInOut:r};return CA(e,(function(e){for(var t in UR[e]=hA[e]=o,UR[i=e.toLowerCase()]=n,o)UR[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=UR[e+"."+t]=o[t]})),o},qR=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},KR=function e(t,n,r){var i=n>=1?n:1,o=(r||(t?.3:.45))/(n<1?n:1),s=o/GT*(Math.asin(1/i)||0),a=function(e){return 1===e?1:i*Math.pow(2,-10*e)*KT((e-s)*o)+1},l="out"===t?a:"in"===t?function(e){return 1-a(1-e)}:qR(a);return o=GT/o,l.config=function(n,r){return e(t,n,r)},l},XR=function e(t,n){void 0===n&&(n=1.70158);var r=function(e){return e?--e*e*((n+1)*e+n)+1:0},i="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:qR(r);return i.config=function(n){return e(t,n)},i};CA("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;WR(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),UR.Linear.easeNone=UR.none=UR.Linear.easeIn,WR("Elastic",KR("in"),KR("out"),KR()),NT=7.5625,DT=1/(kT=2.75),WR("Bounce",(function(e){return 1-BT(1-e)}),BT=function(e){return e<DT?NT*e*e:e<.7272727272727273?NT*Math.pow(e-1.5/kT,2)+.75:e<.9090909090909092?NT*(e-=2.25/kT)*e+.9375:NT*Math.pow(e-2.625/kT,2)+.984375}),WR("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),WR("Circ",(function(e){return-(WT(1-e*e)-1)})),WR("Sine",(function(e){return 1===e?1:1-qT(e*VT)})),WR("Back",XR("in"),XR("out"),XR()),UR.SteppedEase=UR.steps=hA.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),i=t?1:0;return function(e){return((r*uR(0,.99999999,e)|0)+i)*n}}},zT.ease=UR["quad.out"],CA("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return MA+=e+","+e+"Params,"}));var YR=function(e,t){this.id=jT++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:RA,this.set=t?t.getSetter:hC},JR=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,iR(this,+e.duration,1,1),this.data=e.data,OT||DR.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,iR(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(BR(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(ZA(this,e),!n._dp||n.parent||QA(n,this);n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&$A(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===HT||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),OA(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+KA(this))%this._dur||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+KA(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?XA(this._tTime,n)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?YA(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,WA(this.totalTime(uR(-this._delay,this._tDur,t),!0))},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(BR(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=HT)&&Math.abs(this._zTime)!==HT))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&$A(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+($T(e)?this.totalDuration():this.duration())/Math.abs(this._ts)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?YA(t.rawTime(e),this):this._tTime:this._tTime},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(t._ts||1),t=t._dp;return n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,oR(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){return arguments.length?(this._rDelay=e,oR(this)):this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(aR(this,e),$T(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,$T(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-HT))},t.eventCallback=function(e,t,n){var r=this.vars;return arguments.length>1?(t?(r[e]=t,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(e){var t=this;return new Promise((function(n){var r=YT(e)?e:kA,i=function(){var e=t.then;t.then=null,YT(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){MR(this)},e}();DA(JR.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var ZR=function(e){function t(t,n){var r;return void 0===t&&(t={}),(r=e.call(this,t)||this).labels={},r.smoothChildTiming=!!t.smoothChildTiming,r.autoRemoveChildren=!!t.autoRemoveChildren,r._sort=$T(t.sortChildren),TT&&$A(t.parent||TT,ET(r),n),t.reversed&&r.reverse(),t.paused&&r.paused(!0),t.scrollTrigger&&eR(ET(r),t.scrollTrigger),r}ST(t,e);var n=t.prototype;return n.to=function(e,t,n){return lR(0,arguments,this),this},n.from=function(e,t,n){return lR(1,arguments,this),this},n.fromTo=function(e,t,n,r){return lR(2,arguments,this),this},n.set=function(e,t,n){return t.duration=0,t.parent=this,HA(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new sC(e,t,aR(this,n),1),this},n.call=function(e,t,n){return $A(this,sC.delayedCall(0,e,t),n)},n.staggerTo=function(e,t,n,r,i,o,s){return n.duration=t,n.stagger=n.stagger||r,n.onComplete=o,n.onCompleteParams=s,n.parent=this,new sC(e,n,aR(this,i)),this},n.staggerFrom=function(e,t,n,r,i,o,s){return n.runBackwards=1,HA(n).immediateRender=$T(n.immediateRender),this.staggerTo(e,t,n,r,i,o,s)},n.staggerFromTo=function(e,t,n,r,i,o,s,a){return r.startAt=n,HA(r).immediateRender=$T(r.immediateRender),this.staggerTo(e,t,r,i,o,s,a)},n.render=function(e,t,n){var r,i,o,s,a,l,c,u,h,d,p,f,m=this._time,g=this._dirty?this.totalDuration():this._tDur,y=this._dur,v=this!==TT&&e>g-HT&&e>=0?g:e<HT?0:e,_=this._zTime<0!=e<0&&(this._initted||!y);if(v!==this._tTime||n||_){if(m!==this._time&&y&&(v+=this._time-m,e+=this._time-m),r=v,h=this._start,l=!(u=this._ts),_&&(y||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(p=this._yoyo,a=y+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*a+e,t,n);if(r=LA(v%a),v===g?(s=this._repeat,r=y):((s=~~(v/a))&&s===v/a&&(r=y,s--),r>y&&(r=y)),d=XA(this._tTime,a),!m&&this._tTime&&d!==s&&(d=s),p&&1&s&&(r=y-r,f=1),s!==d&&!this._lock){var w=p&&1&d,b=w===(p&&1&s);if(s<d&&(w=!w),m=w?0:y,this._lock=1,this.render(m||(f?0:LA(s*a)),t,!y)._lock=0,this._tTime=v,!t&&this.parent&&SR(this,"onRepeat"),this.vars.repeatRefresh&&!f&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,g=this._tDur,b&&(this._lock=2,m=w?y:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!f&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;VR(this,f)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if(!r._dur&&"isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(!r._dur&&"isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,LA(m),LA(r)),c&&(v-=r-(r=c._start))),this._tTime=v,this._time=r,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&r&&!t&&(SR(this,"onStart"),this._tTime!==v))return this;if(r>=m&&e>=0)for(i=this._first;i;){if(o=i._next,(i._act||r>=i._start)&&i._ts&&c!==i){if(i.parent!==this)return this.render(e,t,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,t,n),r!==this._time||!this._ts&&!l){c=0,o&&(v+=this._zTime=-1e-8);break}}i=o}else{i=this._last;for(var x=e<0?e:r;i;){if(o=i._prev,(i._act||x<=i._end)&&i._ts&&c!==i){if(i.parent!==this)return this.render(e,t,n);if(i.render(i._ts>0?(x-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(x-i._start)*i._ts,t,n),r!==this._time||!this._ts&&!l){c=0,o&&(v+=this._zTime=x?-1e-8:HT);break}}i=o}}if(c&&!t&&(this.pause(),c.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=h,JA(this),this.render(e,t,n);this._onUpdate&&!t&&SR(this,"onUpdate",!0),(v===g&&g>=this.totalDuration()||!v&&m)&&(h!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((e||!y)&&(v===g&&this._ts>0||!v&&this._ts<0)&&VA(this,1),t||e<0&&!m||!v&&!m&&g||(SR(this,v===g&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(e,t){var n=this;if(JT(t)||(t=aR(this,t,e)),!(e instanceof JR)){if(rA(e))return e.forEach((function(e){return n.add(e,t)})),this;if(XT(e))return this.addLabel(e,t);if(!YT(e))return this;e=sC.delayedCall(0,e)}return this!==e?$A(this,e,t):this},n.getChildren=function(e,t,n,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=-FT);for(var i=[],o=this._first;o;)o._start>=r&&(o instanceof sC?t&&i.push(o):(n&&i.push(o),e&&i.push.apply(i,o.getChildren(!0,t,n)))),o=o._next;return i},n.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},n.remove=function(e){return XT(e)?this.removeLabel(e):YT(e)?this.killTweensOf(e):(GA(this,e),e===this._recent&&(this._recent=this._last),jA(this))},n.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=LA(DR.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},n.addLabel=function(e,t){return this.labels[e]=aR(this,t),this},n.removeLabel=function(e){return delete this.labels[e],this},n.addPause=function(e,t,n){var r=sC.delayedCall(0,t||yA,n);return r.data="isPause",this._hasPause=1,$A(this,r,aR(this,e))},n.removePause=function(e){var t=this._first;for(e=aR(this,e);t;)t._start===e&&"isPause"===t.data&&VA(t),t=t._next},n.killTweensOf=function(e,t,n){for(var r=this.getTweensOf(e,n),i=r.length;i--;)QR!==r[i]&&r[i].kill(e,t);return this},n.getTweensOf=function(e,t){for(var n,r=[],i=fR(e),o=this._first,s=JT(t);o;)o instanceof sC?PA(o._targets,i)&&(s?(!QR||o._initted&&o._ts)&&o.globalTime(0)<=t&&o.globalTime(o.totalDuration())>t:!t||o.isActive())&&r.push(o):(n=o.getTweensOf(i,t)).length&&r.push.apply(r,n),o=o._next;return r},n.tweenTo=function(e,t){t=t||{};var n,r=this,i=aR(r,e),o=t,s=o.startAt,a=o.onStart,l=o.onStartParams,c=o.immediateRender,u=sC.to(r,DA({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:t.duration||Math.abs((i-(s&&"time"in s?s.time:r._time))/r.timeScale())||HT,onStart:function(){if(r.pause(),!n){var e=t.duration||Math.abs((i-(s&&"time"in s?s.time:r._time))/r.timeScale());u._dur!==e&&iR(u,e,0,1).render(u._time,!0,!0),n=1}a&&a.apply(u,l||[])}},t));return c?u.render(0):u},n.tweenFromTo=function(e,t,n){return this.tweenTo(t,DA({startAt:{time:aR(this,e)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(e){return void 0===e&&(e=this._time),ER(this,aR(this,e))},n.previousLabel=function(e){return void 0===e&&(e=this._time),ER(this,aR(this,e),1)},n.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+HT)},n.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var r,i=this._first,o=this.labels;i;)i._start>=n&&(i._start+=e,i._end+=e),i=i._next;if(t)for(r in o)o[r]>=n&&(o[r]+=e);return jA(this)},n.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},n.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),jA(this)},n.totalDuration=function(e){var t,n,r,i=0,o=this,s=o._last,a=FT;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-e:e));if(o._dirty){for(r=o.parent;s;)t=s._prev,s._dirty&&s.totalDuration(),(n=s._start)>a&&o._sort&&s._ts&&!o._lock?(o._lock=1,$A(o,s,n-s._delay,1)._lock=0):a=n,n<0&&s._ts&&(i-=n,(!r&&!o._dp||r&&r.smoothChildTiming)&&(o._start+=n/o._ts,o._time-=n,o._tTime-=n),o.shiftChildren(-n,!1,-Infinity),a=0),s._end>i&&s._ts&&(i=s._end),s=t;iR(o,o===TT&&o._time>i?o._time:i,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(e){if(TT._ts&&(OA(TT,YA(e,TT)),PT=DR.frame),DR.frame>=EA){EA+=UT.autoSleep||120;var t=TT._first;if((!t||!t._ts)&&UT.autoSleep&&DR._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||DR.sleep()}}},t}(JR);DA(ZR.prototype,{_lock:0,_hasPause:0,_forcing:0});var QR,$R=function(e,t,n,r,i,o,s){var a,l,c,u,h,d,p,f,m=new wC(this._pt,e,t,0,1,fC,null,i),g=0,y=0;for(m.b=n,m.e=r,n+="",(p=~(r+="").indexOf("random("))&&(r=bR(r)),o&&(o(f=[n,r],e,t),n=f[0],r=f[1]),l=n.match(aA)||[];a=aA.exec(r);)u=a[0],h=r.substring(g,a.index),c?c=(c+1)%5:"rgba("===h.substr(-5)&&(c=1),u!==l[y++]&&(d=parseFloat(l[y-1])||0,m._pt={_next:m._pt,p:h||1===y?h:",",s:d,c:"="===u.charAt(1)?parseFloat(u.substr(2))*("-"===u.charAt(0)?-1:1):parseFloat(u)-d,m:c&&c<4?Math.round:0},g=aA.lastIndex);return m.c=g<r.length?r.substring(g,r.length):"",m.fp=s,(lA.test(r)||p)&&(m.e=0),this._pt=m,m},eC=function(e,t,n,r,i,o,s,a,l){YT(r)&&(r=r(i||0,e,o));var c,u=e[t],h="get"!==n?n:YT(u)?l?e[t.indexOf("set")||!YT(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():u,d=YT(u)?l?cC:lC:aC;if(XT(r)&&(~r.indexOf("random(")&&(r=bR(r)),"="===r.charAt(1)&&((c=parseFloat(h)+parseFloat(r.substr(2))*("-"===r.charAt(0)?-1:1)+(hR(h)||0))||0===c)&&(r=c)),h!==r)return isNaN(h*r)||""===r?(!u&&!(t in e)&&fA(t,r),$R.call(this,e,t,h,r,d,a||UT.stringFilter,l)):(c=new wC(this._pt,e,t,+h||0,r-(h||0),"boolean"==typeof u?pC:dC,0,d),l&&(c.fp=l),s&&c.modifier(s,this,e),this._pt=c)},tC=function(e,t,n,r,i,o){var s,a,l,c;if(bA[e]&&!1!==(s=new bA[e]).init(i,s.rawVars?t[e]:function(e,t,n,r,i){if(YT(e)&&(e=rC(e,i,t,n,r)),!QT(e)||e.style&&e.nodeType||rA(e)||nA(e))return XT(e)?rC(e,i,t,n,r):e;var o,s={};for(o in e)s[o]=rC(e[o],i,t,n,r);return s}(t[e],r,i,o,n),n,r,o)&&(n._pt=a=new wC(n._pt,i,e,0,1,s.render,s,0,s.priority),n!==IT))for(l=n._ptLookup[n._targets.indexOf(i)],c=s._props.length;c--;)l[s._props[c]]=a;return s},nC=function e(t,n){var r,i,o,s,a,l,c,u,h,d,p,f,m,g=t.vars,y=g.ease,v=g.startAt,_=g.immediateRender,w=g.lazy,b=g.onUpdate,x=g.onUpdateParams,E=g.callbackScope,S=g.runBackwards,M=g.yoyoEase,T=g.keyframes,A=g.autoRevert,R=t._dur,C=t._startAt,L=t._targets,P=t.parent,I=P&&"nested"===P.data?P.parent._targets:L,O="auto"===t._overwrite&&!MT,N=t.timeline;if(N&&(!T||!y)&&(y="none"),t._ease=jR(y,zT.ease),t._yEase=M?GR(jR(!0===M?y:M,zT.ease)):0,M&&t._yoyo&&!t._repeat&&(M=t._yEase,t._yEase=t._ease,t._ease=M),t._from=!N&&!!g.runBackwards,!N){if(f=(u=L[0]?AA(L[0]).harness:0)&&g[u.prop],r=FA(g,vA),C&&C.render(-1,!0).kill(),v)if(VA(t._startAt=sC.set(L,DA({data:"isStart",overwrite:!1,parent:P,immediateRender:!0,lazy:$T(w),startAt:null,delay:0,onUpdate:b,onUpdateParams:x,callbackScope:E,stagger:0},v))),n<0&&!_&&!A&&t._startAt.render(-1,!0),_){if(n>0&&!A&&(t._startAt=0),R&&n<=0)return void(n&&(t._zTime=n))}else!1===A&&(t._startAt=0);else if(S&&R)if(C)!A&&(t._startAt=0);else if(n&&(_=!1),o=DA({overwrite:!1,data:"isFromStart",lazy:_&&$T(w),immediateRender:_,stagger:0,parent:P},r),f&&(o[u.prop]=f),VA(t._startAt=sC.set(L,o)),n<0&&t._startAt.render(-1,!0),_){if(!n)return}else e(t._startAt,HT);for(t._pt=0,w=R&&$T(w)||w&&!R,i=0;i<L.length;i++){if(c=(a=L[i])._gsap||TA(L)[i]._gsap,t._ptLookup[i]=d={},wA[c.id]&&_A.length&&IA(),p=I===L?i:I.indexOf(a),u&&!1!==(h=new u).init(a,f||r,t,p,I)&&(t._pt=s=new wC(t._pt,a,h.name,0,1,h.render,h,0,h.priority),h._props.forEach((function(e){d[e]=s})),h.priority&&(l=1)),!u||f)for(o in r)bA[o]&&(h=tC(o,r,t,p,a,I))?h.priority&&(l=1):d[o]=s=eC.call(t,a,o,"get",r[o],p,I,0,g.stringFilter);t._op&&t._op[i]&&t.kill(a,t._op[i]),O&&t._pt&&(QR=t,TT.killTweensOf(a,d,t.globalTime(0)),m=!t.parent,QR=0),t._pt&&w&&(wA[c.id]=1)}l&&_C(t),t._onInit&&t._onInit(t)}t._onUpdate=b,t._initted=(!t._op||t._pt)&&!m},rC=function(e,t,n,r,i){return YT(e)?e.call(t,n,r,i):XT(e)&&~e.indexOf("random(")?bR(e):e},iC=MA+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",oC=(iC+",id,stagger,delay,duration,paused,scrollTrigger").split(","),sC=function(e){function t(t,n,r,i){var o;"number"==typeof n&&(r.duration=n,n=r,r=null);var s,a,l,c,u,h,d,p,f=(o=e.call(this,i?n:HA(n))||this).vars,m=f.duration,g=f.delay,y=f.immediateRender,v=f.stagger,_=f.overwrite,w=f.keyframes,b=f.defaults,x=f.scrollTrigger,E=f.yoyoEase,S=n.parent||TT,M=(rA(t)||nA(t)?JT(t[0]):"length"in n)?[t]:fR(t);if(o._targets=M.length?TA(M):mA("GSAP target "+t+" not found. https://greensock.com",!UT.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=_,w||v||tA(m)||tA(g)){if(n=o.vars,(s=o.timeline=new ZR({data:"nested",defaults:b||{}})).kill(),s.parent=s._dp=ET(o),s._start=0,w)DA(s.vars.defaults,{ease:"none"}),v?M.forEach((function(e,t){return w.forEach((function(n,r){return s.to(e,n,r?">":t*v)}))})):w.forEach((function(e){return s.to(M,e,">")}));else{if(c=M.length,d=v?gR(v):yA,QT(v))for(u in v)~iC.indexOf(u)&&(p||(p={}),p[u]=v[u]);for(a=0;a<c;a++){for(u in l={},n)oC.indexOf(u)<0&&(l[u]=n[u]);l.stagger=0,E&&(l.yoyoEase=E),p&&UA(l,p),h=M[a],l.duration=+rC(m,ET(o),a,h,M),l.delay=(+rC(g,ET(o),a,h,M)||0)-o._delay,!v&&1===c&&l.delay&&(o._delay=g=l.delay,o._start+=g,l.delay=0),s.to(h,l,d(a,h,M))}s.duration()?m=g=0:o.timeline=0}m||o.duration(m=s.duration())}else o.timeline=0;return!0!==_||MT||(QR=ET(o),TT.killTweensOf(M),QR=0),$A(S,ET(o),r),n.reversed&&o.reverse(),n.paused&&o.paused(!0),(y||!m&&!w&&o._start===LA(S._time)&&$T(y)&&qA(ET(o))&&"nested"!==S.data)&&(o._tTime=-1e-8,o.render(Math.max(0,-g))),x&&eR(ET(o),x),o}ST(t,e);var n=t.prototype;return n.render=function(e,t,n){var r,i,o,s,a,l,c,u,h,d=this._time,p=this._tDur,f=this._dur,m=e>p-HT&&e>=0?p:e<HT?0:e;if(f){if(m!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(r=m,u=this.timeline,this._repeat){if(s=f+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*s+e,t,n);if(r=LA(m%s),m===p?(o=this._repeat,r=f):((o=~~(m/s))&&o===m/s&&(r=f,o--),r>f&&(r=f)),(l=this._yoyo&&1&o)&&(h=this._yEase,r=f-r),a=XA(this._tTime,s),r===d&&!n&&this._initted)return this;o!==a&&(u&&this._yEase&&VR(u,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(LA(s*o),!0).invalidate()._lock=0))}if(!this._initted){if(tR(this,e<0?e:r,n,t))return this._tTime=0,this;if(f!==this._dur)return this.render(e,t,n)}if(this._tTime=m,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(h||this._ease)(r/f),this._from&&(this.ratio=c=1-c),r&&!d&&!t&&SR(this,"onStart"),r&&!d&&!t&&(SR(this,"onStart"),this._tTime!==m))return this;for(i=this._pt;i;)i.r(c,i.d),i=i._next;u&&u.render(e<0?e:!r&&l?-1e-8:u._dur*c,t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),SR(this,"onUpdate")),this._repeat&&o!==a&&this.vars.onRepeat&&!t&&this.parent&&SR(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),(e||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&VA(this,1),t||e<0&&!d||!m&&!d||(SR(this,m===p?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var i,o,s,a=e.ratio,l=t<0||!t&&(!e._start&&nR(e)&&(e._initted||!rR(e))||(e._ts<0||e._dp._ts<0)&&!rR(e))?0:1,c=e._rDelay,u=0;if(c&&e._repeat&&(u=uR(0,e._tDur,t),o=XA(u,c),s=XA(e._tTime,c),e._yoyo&&1&o&&(l=1-l),o!==s&&(a=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==a||r||e._zTime===HT||!t&&e._zTime){if(!e._initted&&tR(e,t,r,n))return;for(s=e._zTime,e._zTime=t||(n?HT:0),n||(n=t&&!s),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=u,i=e._pt;i;)i.r(l,i.d),i=i._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!n&&SR(e,"onUpdate"),u&&e._repeat&&!n&&e.parent&&SR(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&VA(e,1),n||(SR(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},n.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?MR(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,QR&&!0!==QR.vars.overwrite)._first||MR(this),this.parent&&n!==this.timeline.totalDuration()&&iR(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,o,s,a,l,c,u=this._targets,h=e?fR(e):u,d=this._ptLookup,p=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(u,h))return"all"===t&&(this._pt=0),MR(this);for(r=this._op=this._op||[],"all"!==t&&(XT(t)&&(a={},CA(t,(function(e){return a[e]=1})),t=a),t=function(e,t){var n,r,i,o,s=e[0]?AA(e[0]).harness:0,a=s&&s.aliases;if(!a)return t;for(r in n=UA({},t),a)if(r in n)for(i=(o=a[r].split(",")).length;i--;)n[o[i]]=n[r];return n}(u,t)),c=u.length;c--;)if(~h.indexOf(u[c]))for(a in i=d[c],"all"===t?(r[c]=t,s=i,o={}):(o=r[c]=r[c]||{},s=t),s)(l=i&&i[a])&&("kill"in l.d&&!0!==l.d.kill(a)||GA(this,l,"_pt"),delete i[a]),"all"!==o&&(o[a]=1);return this._initted&&!this._pt&&p&&MR(this),this},t.to=function(e,n){return new t(e,n,arguments[2])},t.from=function(e,t){return lR(1,arguments)},t.delayedCall=function(e,n,r,i){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},t.fromTo=function(e,t,n){return lR(2,arguments)},t.set=function(e,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(e,n)},t.killTweensOf=function(e,t,n){return TT.killTweensOf(e,t,n)},t}(JR);DA(sC.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),CA("staggerTo,staggerFrom,staggerFromTo",(function(e){sC[e]=function(){var t=new ZR,n=dR.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var aC=function(e,t,n){return e[t]=n},lC=function(e,t,n){return e[t](n)},cC=function(e,t,n,r){return e[t](r.fp,n)},uC=function(e,t,n){return e.setAttribute(t,n)},hC=function(e,t){return YT(e[t])?lC:ZT(e[t])&&e.setAttribute?uC:aC},dC=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},pC=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},fC=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},mC=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},gC=function(e,t,n,r){for(var i,o=this._pt;o;)i=o._next,o.p===r&&o.modifier(e,t,n),o=i},yC=function(e){for(var t,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?GA(this,r,"_pt"):r.dep||(t=1),r=n;return!t},vC=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},_C=function(e){for(var t,n,r,i,o=e._pt;o;){for(t=o._next,n=r;n&&n.pr>o.pr;)n=n._next;(o._prev=n?n._prev:i)?o._prev._next=o:r=o,(o._next=n)?n._prev=o:i=o,o=t}e._pt=r},wC=function(){function e(e,t,n,r,i,o,s,a,l){this.t=t,this.s=r,this.c=i,this.p=n,this.r=o||dC,this.d=s||this,this.set=a||aC,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=vC,this.m=e,this.mt=n,this.tween=t},e}();CA(MA+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return vA[e]=1})),hA.TweenMax=hA.TweenLite=sC,hA.TimelineLite=hA.TimelineMax=ZR,TT=new ZR({sortChildren:!1,defaults:zT,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),UT.stringFilter=kR;var bC={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return TR(e)}))},timeline:function(e){return new ZR(e)},getTweensOf:function(e,t){return TT.getTweensOf(e,t)},getProperty:function(e,t,n,r){XT(e)&&(e=fR(e)[0]);var i=AA(e||{}).get,o=n?kA:NA;return"native"===n&&(n=""),e?t?o((bA[t]&&bA[t].get||i)(e,t,n,r)):function(t,n,r){return o((bA[t]&&bA[t].get||i)(e,t,n,r))}:e},quickSetter:function(e,t,n){if((e=fR(e)).length>1){var r=e.map((function(e){return SC.quickSetter(e,t,n)})),i=r.length;return function(e){for(var t=i;t--;)r[t](e)}}e=e[0]||{};var o=bA[t],s=AA(e),a=s.harness&&(s.harness.aliases||{})[t]||t,l=o?function(t){var r=new o;IT._pt=0,r.init(e,n?t+n:t,IT,0,[e]),r.render(1,r),IT._pt&&mC(1,IT)}:s.set(e,a);return o?l:function(t){return l(e,a,n?t+n:t,s,1)}},isTweening:function(e){return TT.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=jR(e.ease,zT.ease)),zA(zT,e||{})},config:function(e){return zA(UT,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,i=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach((function(e){return e&&!bA[e]&&!hA[e]&&mA(t+" effect requires "+e+" plugin.")})),xA[t]=function(e,t,r){return n(fR(e),DA(t||{},i),r)},o&&(ZR.prototype[t]=function(e,n,r){return this.add(xA[t](e,QT(n)?n:(r=n)&&{},this),r)})},registerEase:function(e,t){UR[e]=jR(t)},parseEase:function(e,t){return arguments.length?jR(e,t):UR},getById:function(e){return TT.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,r,i=new ZR(e);for(i.smoothChildTiming=$T(e.smoothChildTiming),TT.remove(i),i._dp=0,i._time=i._tTime=TT._time,n=TT._first;n;)r=n._next,!t&&!n._dur&&n instanceof sC&&n.vars.onComplete===n._targets[0]||$A(i,n,n._start-n._delay),n=r;return $A(TT,i,0),i},utils:{wrap:function e(t,n,r){var i=n-t;return rA(t)?wR(t,e(0,t.length),n):cR(r,(function(e){return(i+(e-t)%i)%i+t}))},wrapYoyo:function e(t,n,r){var i=n-t,o=2*i;return rA(t)?wR(t,e(0,t.length-1),n):cR(r,(function(e){return t+((e=(o+(e-t)%o)%o||0)>i?o-e:e)}))},distribute:gR,random:_R,snap:vR,normalize:function(e,t,n){return xR(e,t,0,1,n)},getUnit:hR,clamp:function(e,t,n){return cR(n,(function(n){return uR(e,t,n)}))},splitColor:LR,toArray:fR,selector:function(e){return e=fR(e)[0]||mA("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return fR(t,n.querySelectorAll?n:n===e?mA("Invalid scope")||CT.createElement("div"):e)}},mapRange:xR,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||hR(n))}},interpolate:function e(t,n,r,i){var o=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!o){var s,a,l,c,u,h=XT(t),d={};if(!0===r&&(i=1)&&(r=null),h)t={p:t},n={p:n};else if(rA(t)&&!rA(n)){for(l=[],c=t.length,u=c-2,a=1;a<c;a++)l.push(e(t[a-1],t[a]));c--,o=function(e){e*=c;var t=Math.min(u,~~e);return l[t](e-t)},r=n}else i||(t=UA(rA(t)?[]:{},t));if(!l){for(s in n)eC.call(d,t,s,"get",n[s]);o=function(e){return mC(e,d)||(h?t.p:t)}}}return cR(r,o)},shuffle:mR},install:pA,effects:xA,ticker:DR,updateRoot:ZR.updateRoot,plugins:bA,globalTimeline:TT,core:{PropTween:wC,globals:gA,Tween:sC,Timeline:ZR,Animation:JR,getCache:AA,_removeLinkedListItem:GA,suppressOverwrites:function(e){return MT=e}}};CA("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return bC[e]=sC[e]})),DR.add(ZR.updateRoot),IT=bC.to({},{duration:0});var xC=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},EC=function(e,t){return{name:e,rawVars:1,init:function(e,n,r){r._onInit=function(e){var r,i;if(XT(n)&&(r={},CA(n,(function(e){return r[e]=1})),n=r),t){for(i in r={},n)r[i]=t(n[i]);n=r}!function(e,t){var n,r,i,o=e._targets;for(n in t)for(r=o.length;r--;)(i=e._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=xC(i,n)),i&&i.modifier&&i.modifier(t[n],e,o[r],n))}(e,n)}}}},SC=bC.registerPlugin({name:"attr",init:function(e,t,n,r,i){var o,s;for(o in t)(s=this.add(e,"setAttribute",(e.getAttribute(o)||0)+"",t[o],r,i,0,0,o))&&(s.op=o),this._props.push(o)}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n])}},EC("roundProps",yR),EC("modifiers"),EC("snap",vR))||bC;sC.version=ZR.version=SC.version="3.7.0",LT=1,eA()&&BR(),UR.Power0,UR.Power1,UR.Power2,UR.Power3,UR.Power4,UR.Linear,UR.Quad,UR.Cubic,UR.Quart,UR.Quint,UR.Strong,UR.Elastic,UR.Back,UR.SteppedEase,UR.Bounce,UR.Sine,UR.Expo,UR.Circ;var MC,TC,AC,RC,CC,LC,PC,IC={},OC=180/Math.PI,NC=Math.PI/180,kC=Math.atan2,DC=/([A-Z])/g,BC=/(?:left|right|width|margin|padding|x)/i,UC=/[\s,\(]\S/,zC={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},FC=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},HC=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},GC=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},VC=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},jC=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},WC=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},qC=function(e,t,n){return e.style[t]=n},KC=function(e,t,n){return e.style.setProperty(t,n)},XC=function(e,t,n){return e._gsap[t]=n},YC=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},JC=function(e,t,n,r,i){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(i,o)},ZC=function(e,t,n,r,i){var o=e._gsap;o[t]=n,o.renderTransform(i,o)},QC="transform",$C=QC+"Origin",eL=function(e,t){var n=TC.createElementNS?TC.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):TC.createElement(e);return n.style?n:TC.createElement(e)},tL=function e(t,n,r){var i=getComputedStyle(t);return i[n]||i.getPropertyValue(n.replace(DC,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&e(t,rL(n)||n,1)||""},nL="O,Moz,ms,Ms,Webkit".split(","),rL=function(e,t,n){var r=(t||CC).style,i=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(nL[i]+e in r););return i<0?null:(3===i?"ms":i>=0?nL[i]:"")+e},iL=function(){"undefined"!=typeof window&&window.document&&(MC=window,TC=MC.document,AC=TC.documentElement,CC=eL("div")||{style:{}},eL("div"),QC=rL(QC),$C=QC+"Origin",CC.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",PC=!!rL("perspective"),RC=1)},oL=function e(t){var n,r=eL("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,o=this.nextSibling,s=this.style.cssText;if(AC.appendChild(r),r.appendChild(this),this.style.display="block",t)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(o?i.insertBefore(this,o):i.appendChild(this)),AC.removeChild(r),this.style.cssText=s,n},sL=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},aL=function(e){var t;try{t=e.getBBox()}catch(n){t=oL.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===oL||(t=oL.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+sL(e,["x","cx","x1"])||0,y:+sL(e,["y","cy","y1"])||0,width:0,height:0}},lL=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!aL(e))},cL=function(e,t){if(t){var n=e.style;t in IC&&t!==$C&&(t=QC),n.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty(t.replace(DC,"-$1").toLowerCase())):n.removeAttribute(t)}},uL=function(e,t,n,r,i,o){var s=new wC(e._pt,t,n,0,1,o?WC:jC);return e._pt=s,s.b=r,s.e=i,e._props.push(n),s},hL={deg:1,rad:1,turn:1},dL=function e(t,n,r,i){var o,s,a,l,c=parseFloat(r)||0,u=(r+"").trim().substr((c+"").length)||"px",h=CC.style,d=BC.test(n),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===i,y="%"===i;return i===u||!c||hL[i]||hL[u]?c:("px"!==u&&!g&&(c=e(t,n,r,"px")),l=t.getCTM&&lL(t),!y&&"%"!==u||!IC[n]&&!~n.indexOf("adius")?(h[d?"width":"height"]=m+(g?u:i),s=~n.indexOf("adius")||"em"===i&&t.appendChild&&!p?t:t.parentNode,l&&(s=(t.ownerSVGElement||{}).parentNode),s&&s!==TC&&s.appendChild||(s=TC.body),(a=s._gsap)&&y&&a.width&&d&&a.time===DR.time?LA(c/a.width*m):((y||"%"===u)&&(h.position=tL(t,"position")),s===t&&(h.position="static"),s.appendChild(CC),o=CC[f],s.removeChild(CC),h.position="absolute",d&&y&&((a=AA(s)).time=DR.time,a.width=s[f]),LA(g?o*c/m:o&&c?m/o*c:0))):(o=l?t.getBBox()[d?"width":"height"]:t[f],LA(y?c/o*m:c/100*o)))},pL=function(e,t,n,r){var i;return RC||iL(),t in zC&&"transform"!==t&&~(t=zC[t]).indexOf(",")&&(t=t.split(",")[0]),IC[t]&&"transform"!==t?(i=SL(e,r),i="transformOrigin"!==t?i[t]:i.svg?i.origin:ML(tL(e,$C))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=yL[t]&&yL[t](e,t,n)||tL(e,t)||RA(e,t)||("opacity"===t?1:0)),n&&!~(i+"").trim().indexOf(" ")?dL(e,t,i,n)+n:i},fL=function(e,t,n,r){if(!n||"none"===n){var i=rL(t,e,1),o=i&&tL(e,i,1);o&&o!==n?(t=i,n=o):"borderColor"===t&&(n=tL(e,"borderTopColor"))}var s,a,l,c,u,h,d,p,f,m,g,y,v=new wC(this._pt,e.style,t,0,1,fC),_=0,w=0;if(v.b=n,v.e=r,n+="","auto"==(r+="")&&(e.style[t]=r,r=tL(e,t)||r,e.style[t]=n),kR(s=[n,r]),r=s[1],l=(n=s[0]).match(sA)||[],(r.match(sA)||[]).length){for(;a=sA.exec(r);)d=a[0],f=r.substring(_,a.index),u?u=(u+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(u=1),d!==(h=l[w++]||"")&&(c=parseFloat(h)||0,g=h.substr((c+"").length),(y="="===d.charAt(1)?+(d.charAt(0)+"1"):0)&&(d=d.substr(2)),p=parseFloat(d),m=d.substr((p+"").length),_=sA.lastIndex-m.length,m||(m=m||UT.units[t]||g,_===r.length&&(r+=m,v.e+=m)),g!==m&&(c=dL(e,t,h,m)||0),v._pt={_next:v._pt,p:f||1===w?f:",",s:c,c:y?y*p:p-c,m:u&&u<4||"zIndex"===t?Math.round:0});v.c=_<r.length?r.substring(_,r.length):""}else v.r="display"===t&&"none"===r?WC:jC;return lA.test(r)&&(v.e=0),this._pt=v,v},mL={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},gL=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,r,i,o=t.t,s=o.style,a=t.u,l=o._gsap;if("all"===a||!0===a)s.cssText="",r=1;else for(i=(a=a.split(",")).length;--i>-1;)n=a[i],IC[n]&&(r=1,n="transformOrigin"===n?$C:QC),cL(o,n);r&&(cL(o,QC),l&&(l.svg&&o.removeAttribute("transform"),SL(o,1),l.uncache=1))}},yL={clearProps:function(e,t,n,r,i){if("isFromStart"!==i.data){var o=e._pt=new wC(e._pt,t,n,0,0,gL);return o.u=r,o.pr=-10,o.tween=i,e._props.push(n),1}}},vL=[1,0,0,1,0,0],_L={},wL=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},bL=function(e){var t=tL(e,QC);return wL(t)?vL:t.substr(7).match(oA).map(LA)},xL=function(e,t){var n,r,i,o,s=e._gsap||AA(e),a=e.style,l=bL(e);return s.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?vL:l:(l!==vL||e.offsetParent||e===AC||s.svg||(i=a.display,a.display="block",(n=e.parentNode)&&e.offsetParent||(o=1,r=e.nextSibling,AC.appendChild(e)),l=bL(e),i?a.display=i:cL(e,"display"),o&&(r?n.insertBefore(e,r):n?n.appendChild(e):AC.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},EL=function(e,t,n,r,i,o){var s,a,l,c=e._gsap,u=i||xL(e,!0),h=c.xOrigin||0,d=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=u[0],g=u[1],y=u[2],v=u[3],_=u[4],w=u[5],b=t.split(" "),x=parseFloat(b[0])||0,E=parseFloat(b[1])||0;n?u!==vL&&(a=m*v-g*y)&&(l=x*(-g/a)+E*(m/a)-(m*w-g*_)/a,x=x*(v/a)+E*(-y/a)+(y*w-v*_)/a,E=l):(x=(s=aL(e)).x+(~b[0].indexOf("%")?x/100*s.width:x),E=s.y+(~(b[1]||b[0]).indexOf("%")?E/100*s.height:E)),r||!1!==r&&c.smooth?(_=x-h,w=E-d,c.xOffset=p+(_*m+w*y)-_,c.yOffset=f+(_*g+w*v)-w):c.xOffset=c.yOffset=0,c.xOrigin=x,c.yOrigin=E,c.smooth=!!r,c.origin=t,c.originIsAbsolute=!!n,e.style[$C]="0px 0px",o&&(uL(o,c,"xOrigin",h,x),uL(o,c,"yOrigin",d,E),uL(o,c,"xOffset",p,c.xOffset),uL(o,c,"yOffset",f,c.yOffset)),e.setAttribute("data-svg-origin",x+" "+E)},SL=function(e,t){var n=e._gsap||new YR(e);if("x"in n&&!t&&!n.uncache)return n;var r,i,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,w,b,x,E,S,M,T,A,R,C,L,P,I,O,N,k=e.style,D=n.scaleX<0,B="px",U="deg",z=tL(e,$C)||"0";return r=i=o=l=c=u=h=d=p=0,s=a=1,n.svg=!(!e.getCTM||!lL(e)),g=xL(e,n.svg),n.svg&&(T=(!n.uncache||"0px 0px"===z)&&!t&&e.getAttribute("data-svg-origin"),EL(e,T||z,!!T||n.originIsAbsolute,!1!==n.smooth,g)),f=n.xOrigin||0,m=n.yOrigin||0,g!==vL&&(w=g[0],b=g[1],x=g[2],E=g[3],r=S=g[4],i=M=g[5],6===g.length?(s=Math.sqrt(w*w+b*b),a=Math.sqrt(E*E+x*x),l=w||b?kC(b,w)*OC:0,(h=x||E?kC(x,E)*OC+l:0)&&(a*=Math.abs(Math.cos(h*NC))),n.svg&&(r-=f-(f*w+m*x),i-=m-(f*b+m*E))):(N=g[6],I=g[7],C=g[8],L=g[9],P=g[10],O=g[11],r=g[12],i=g[13],o=g[14],c=(y=kC(N,P))*OC,y&&(T=S*(v=Math.cos(-y))+C*(_=Math.sin(-y)),A=M*v+L*_,R=N*v+P*_,C=S*-_+C*v,L=M*-_+L*v,P=N*-_+P*v,O=I*-_+O*v,S=T,M=A,N=R),u=(y=kC(-x,P))*OC,y&&(v=Math.cos(-y),O=E*(_=Math.sin(-y))+O*v,w=T=w*v-C*_,b=A=b*v-L*_,x=R=x*v-P*_),l=(y=kC(b,w))*OC,y&&(T=w*(v=Math.cos(y))+b*(_=Math.sin(y)),A=S*v+M*_,b=b*v-w*_,M=M*v-S*_,w=T,S=A),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),s=LA(Math.sqrt(w*w+b*b+x*x)),a=LA(Math.sqrt(M*M+N*N)),y=kC(S,M),h=Math.abs(y)>2e-4?y*OC:0,p=O?1/(O<0?-O:O):0),n.svg&&(T=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!wL(tL(e,QC)),T&&e.setAttribute("transform",T))),Math.abs(h)>90&&Math.abs(h)<270&&(D?(s*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,h+=h<=0?180:-180)),n.x=r-((n.xPercent=r&&(n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-r)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+B,n.y=i-((n.yPercent=i&&(n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+B,n.z=o+B,n.scaleX=LA(s),n.scaleY=LA(a),n.rotation=LA(l)+U,n.rotationX=LA(c)+U,n.rotationY=LA(u)+U,n.skewX=h+U,n.skewY=d+U,n.transformPerspective=p+B,(n.zOrigin=parseFloat(z.split(" ")[2])||0)&&(k[$C]=ML(z)),n.xOffset=n.yOffset=0,n.force3D=UT.force3D,n.renderTransform=n.svg?IL:PC?PL:AL,n.uncache=0,n},ML=function(e){return(e=e.split(" "))[0]+" "+e[1]},TL=function(e,t,n){var r=hR(t);return LA(parseFloat(t)+parseFloat(dL(e,"x",n+"px",r)))+r},AL=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,PL(e,t)},RL="0deg",CL="0px",LL=") ",PL=function(e,t){var n=t||this,r=n.xPercent,i=n.yPercent,o=n.x,s=n.y,a=n.z,l=n.rotation,c=n.rotationY,u=n.rotationX,h=n.skewX,d=n.skewY,p=n.scaleX,f=n.scaleY,m=n.transformPerspective,g=n.force3D,y=n.target,v=n.zOrigin,_="",w="auto"===g&&e&&1!==e||!0===g;if(v&&(u!==RL||c!==RL)){var b,x=parseFloat(c)*NC,E=Math.sin(x),S=Math.cos(x);x=parseFloat(u)*NC,b=Math.cos(x),o=TL(y,o,E*b*-v),s=TL(y,s,-Math.sin(x)*-v),a=TL(y,a,S*b*-v+v)}m!==CL&&(_+="perspective("+m+LL),(r||i)&&(_+="translate("+r+"%, "+i+"%) "),(w||o!==CL||s!==CL||a!==CL)&&(_+=a!==CL||w?"translate3d("+o+", "+s+", "+a+") ":"translate("+o+", "+s+LL),l!==RL&&(_+="rotate("+l+LL),c!==RL&&(_+="rotateY("+c+LL),u!==RL&&(_+="rotateX("+u+LL),h===RL&&d===RL||(_+="skew("+h+", "+d+LL),1===p&&1===f||(_+="scale("+p+", "+f+LL),y.style[QC]=_||"translate(0, 0)"},IL=function(e,t){var n,r,i,o,s,a=t||this,l=a.xPercent,c=a.yPercent,u=a.x,h=a.y,d=a.rotation,p=a.skewX,f=a.skewY,m=a.scaleX,g=a.scaleY,y=a.target,v=a.xOrigin,_=a.yOrigin,w=a.xOffset,b=a.yOffset,x=a.forceCSS,E=parseFloat(u),S=parseFloat(h);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=NC,p*=NC,n=Math.cos(d)*m,r=Math.sin(d)*m,i=Math.sin(d-p)*-g,o=Math.cos(d-p)*g,p&&(f*=NC,s=Math.tan(p-f),i*=s=Math.sqrt(1+s*s),o*=s,f&&(s=Math.tan(f),n*=s=Math.sqrt(1+s*s),r*=s)),n=LA(n),r=LA(r),i=LA(i),o=LA(o)):(n=m,o=g,r=i=0),(E&&!~(u+"").indexOf("px")||S&&!~(h+"").indexOf("px"))&&(E=dL(y,"x",u,"px"),S=dL(y,"y",h,"px")),(v||_||w||b)&&(E=LA(E+v-(v*n+_*i)+w),S=LA(S+_-(v*r+_*o)+b)),(l||c)&&(s=y.getBBox(),E=LA(E+l/100*s.width),S=LA(S+c/100*s.height)),s="matrix("+n+","+r+","+i+","+o+","+E+","+S+")",y.setAttribute("transform",s),x&&(y.style[QC]=s)},OL=function(e,t,n,r,i,o){var s,a,l=360,c=XT(i),u=parseFloat(i)*(c&&~i.indexOf("rad")?OC:1),h=o?u*o:u-r,d=r+h+"deg";return c&&("short"===(s=i.split("_")[1])&&(h%=l)!=h%180&&(h+=h<0?l:-360),"cw"===s&&h<0?h=(h+36e9)%l-~~(h/l)*l:"ccw"===s&&h>0&&(h=(h-36e9)%l-~~(h/l)*l)),e._pt=a=new wC(e._pt,t,n,r,h,HC),a.e=d,a.u="deg",e._props.push(n),a},NL=function(e,t){for(var n in t)e[n]=t[n];return e},kL=function(e,t,n){var r,i,o,s,a,l,c,u=NL({},n._gsap),h=n.style;for(i in u.svg?(o=n.getAttribute("transform"),n.setAttribute("transform",""),h[QC]=t,r=SL(n,1),cL(n,QC),n.setAttribute("transform",o)):(o=getComputedStyle(n)[QC],h[QC]=t,r=SL(n,1),h[QC]=o),IC)(o=u[i])!==(s=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(a=hR(o)!==(c=hR(s))?dL(n,i,o,c):parseFloat(o),l=parseFloat(s),e._pt=new wC(e._pt,r,i,a,l-a,FC),e._pt.u=c||0,e._props.push(i));NL(r,u)};CA("padding,margin,Width,Radius",(function(e,t){var n="Top",r="Right",i="Bottom",o="Left",s=(t<3?[n,r,i,o]:[n+o,n+r,i+r,i+o]).map((function(n){return t<2?e+n:"border"+n+e}));yL[t>1?"border"+e:e]=function(e,t,n,r,i){var o,a;if(arguments.length<4)return o=s.map((function(t){return pL(e,t,n)})),5===(a=o.join(" ")).split(o[0]).length?o[0]:a;o=(r+"").split(" "),a={},s.forEach((function(e,t){return a[e]=o[t]=o[t]||o[(t-1)/2|0]})),e.init(t,a,i)}}));var DL,BL,UL={name:"css",register:iL,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,i){var o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,w,b,x,E,S=this._props,M=e.style,T=n.vars.startAt;for(h in RC||iL(),t)if("autoRound"!==h&&(s=t[h],!bA[h]||!tC(h,t,n,r,e,i)))if(c=typeof s,u=yL[h],"function"===c&&(c=typeof(s=s.call(n,r,e,i))),"string"===c&&~s.indexOf("random(")&&(s=bR(s)),u)u(this,e,h,s,n)&&(_=1);else if("--"===h.substr(0,2))o=(getComputedStyle(e).getPropertyValue(h)+"").trim(),s+="",OR.lastIndex=0,OR.test(o)||(d=hR(o),p=hR(s)),p?d!==p&&(o=dL(e,h,o,p)+p):d&&(s+=d),this.add(M,"setProperty",o,s,r,i,0,0,h),S.push(h);else if("undefined"!==c){if(T&&h in T?(o="function"==typeof T[h]?T[h].call(n,r,e,i):T[h],h in UT.units&&!hR(o)&&(o+=UT.units[h]),"="===(o+"").charAt(1)&&(o=pL(e,h))):o=pL(e,h),l=parseFloat(o),(f="string"===c&&"="===s.charAt(1)?+(s.charAt(0)+"1"):0)&&(s=s.substr(2)),a=parseFloat(s),h in zC&&("autoAlpha"===h&&(1===l&&"hidden"===pL(e,"visibility")&&a&&(l=0),uL(this,M,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==h&&"transform"!==h&&~(h=zC[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in IC)if(g||((y=e._gsap).renderTransform&&!t.parseTransform||SL(e,t.parseTransform),v=!1!==t.smoothOrigin&&y.smooth,(g=this._pt=new wC(this._pt,M,QC,0,1,y.renderTransform,y,0,-1)).dep=1),"scale"===h)this._pt=new wC(this._pt,y,"scaleY",y.scaleY,(f?f*a:a-y.scaleY)||0),S.push("scaleY",h),h+="X";else{if("transformOrigin"===h){b=void 0,x=void 0,E=void 0,x=(b=(w=s).split(" "))[0],E=b[1]||"50%","top"!==x&&"bottom"!==x&&"left"!==E&&"right"!==E||(w=x,x=E,E=w),b[0]=mL[x]||x,b[1]=mL[E]||E,s=b.join(" "),y.svg?EL(e,s,0,v,0,this):((p=parseFloat(s.split(" ")[2])||0)!==y.zOrigin&&uL(this,y,"zOrigin",y.zOrigin,p),uL(this,M,h,ML(o),ML(s)));continue}if("svgOrigin"===h){EL(e,s,1,v,0,this);continue}if(h in _L){OL(this,y,h,l,s,f);continue}if("smoothOrigin"===h){uL(this,y,"smooth",y.smooth,s);continue}if("force3D"===h){y[h]=s;continue}if("transform"===h){kL(this,s,e);continue}}else h in M||(h=rL(h)||h);if(m||(a||0===a)&&(l||0===l)&&!UC.test(s)&&h in M)a||(a=0),(d=(o+"").substr((l+"").length))!==(p=hR(s)||(h in UT.units?UT.units[h]:d))&&(l=dL(e,h,o,p)),this._pt=new wC(this._pt,m?y:M,h,l,f?f*a:a-l,m||"px"!==p&&"zIndex"!==h||!1===t.autoRound?FC:VC),this._pt.u=p||0,d!==p&&(this._pt.b=o,this._pt.r=GC);else if(h in M)fL.call(this,e,h,o,s);else{if(!(h in e)){fA(h,s);continue}this.add(e,h,o||e[h],s,r,i)}S.push(h)}_&&_C(this)},get:pL,aliases:zC,getSetter:function(e,t,n){var r=zC[t];return r&&r.indexOf(",")<0&&(t=r),t in IC&&t!==$C&&(e._gsap.x||pL(e,"x"))?n&&LC===n?"scale"===t?YC:XC:(LC=n||{})&&("scale"===t?JC:ZC):e.style&&!ZT(e.style[t])?qC:~t.indexOf("-")?KC:hC(e,t)},core:{_removeProperty:cL,_getMatrix:xL}};SC.utils.checkPrefix=rL,BL=CA("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+(DL="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){IC[e]=1})),CA(DL,(function(e){UT.units[e]="deg",_L[e]=1})),zC[BL[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+DL,CA("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");zC[t[1]]=BL[t[0]]})),CA("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){UT.units[e]="px"})),SC.registerPlugin(UL);var zL=SC.registerPlugin(UL)||SC;zL.core.Tween;const FL=document.getElementById("objktViewer"),HL=document.getElementById("cont"),GL=new ds;let VL;const jL=new _g;let WL=!1,qL=0;jL.params={Mesh:{},Line:{threshold:.1},LOD:{},Points:{threshold:.1},Sprite:{}};const KL=e=>WL=e;var XL;HL.addEventListener("wheel",(e=>{if(VL){const n=VL.object.parent;if(n.userData.hasOwnProperty("isBlockDisplay")){var t=e.deltaY/700;zL.to(n.parent.position,{duration:.4,y:n.parent.position.y+t})}}})),HL.addEventListener("click",(function(){if(VL){const t=VL.object.parent;if(t.userData.hasOwnProperty("isBlockDisplay")&&!t.userData.focused)if(zL.to(t.position,{duration:2,z:t.position.z+.3}),t.userData.focused=!0,t.userData.item.hasOwnProperty("token")){var e=t.userData.item.token;const n="https://assets.objkt.media/file/assets-003/"+e.display_uri.replace("ipfs://","")+"/display";e.fa={contract:e.fa2_address};const r={id:e.fa2_address+e.token_id};e.url="https://objkt.com/asset/"+e.fa2_address+"/"+e.token_id,tM[r.id]=e,tv(n,r,"objkt")}else{const e=t.userData.item,n=e.display_uri;e.fa=0;const r={id:e.permalink};e.url=e.permalink,tM[r.id]=e,tv(n,r)}}aI.lock(),FL.src="",FL.style.zIndex=0,FL.style.display="none"})),"undefined"!=typeof OffscreenCanvas?XL=new Worker(new URL(n.p+n.u(600),n.b)):console.log("This browser does not support offscreen canvas.");var YL=new Map,JL=!0,ZL=999999999999;const QL=new Ul(1.5,.3,.75),$L=new cp(QL),eP=new ic(1.5,.3),tP=new Dh,nP={};"undefined"!=typeof OffscreenCanvas&&(XL.onmessage=e=>function(e){var t=new Dh;const n=new Dl(QL,mv.whiteFull),r=new Hd($L,mv.blackLineLone);n.position.set(0,0,-.3751),r.position.set(0,0,-.3751);const i=new xd(e.img.data,1e3,200);i.generateMipmaps=!0,i.flipY=!0,i.needsUpdate=!0;var o=new Za({map:i});const s=new Dl(eP,o);r.userData.isBlockPanel=1,(e.seller_address===Zx||e.artist_address===Zx||e.buyer_address===Zx)&&(n.scale.set(1.02,1.1,1),r.scale.set(1.02,1.1,1),n.material=mv.redFull),t.userData.item=e,t.userData.focused=!1,t.add(s,n,r),t.userData.isBlockDisplay=!0,nP[JSON.stringify(e.level)].add(t),oM(),t.position.y=50;var a=t.parent.children.length;zL.to(t.position,{duration:2,y:.35*a-2})}(e.data));var rP=0;function iP(e){fetch("https://livefeed-proxy.teztok.com/feed").then((e=>e.json())).then((t=>{if(rP)for(let e=0;e<250;e++){const n=t.events[e];if(!rP.has(n.level)){const e=new Map;rP.set(n.level,e)}const r=rP.get(n.level);r.set(n.id,n),rP.set(n.level,r)}else{const e=new Map;for(let n=0;n<250;n++){const r=t.events[n];if(!e.has(r.level)){const t=new Map;e.set(r.level,t)}const i=e.get(r.level);i.set(r.id,r),e.set(r.level,i)}rP=e}const n=[...rP].sort((([e,t],[n,r])=>e-n));rP=new Map(n),((e,t,n)=>{var r=0;JL&&(KL(!0),tI.add(tP),tP.position.set(e.x-2.5*t.size+5,e.y+.5,e.z),JL=!1),t.forEach(((t,n)=>{if(YL.has(n)){const e=YL.get(n);e.size!=t.size&&t.forEach(((t,n)=>{e.has(n)||(e.set(n,t),XL.postMessage(t))}))}else{if(n<ZL&&(ZL=n),YL.set(n,t),((e,t)=>{zL.to(tP.position,{duration:2,x:tP.position.x-2.55});const n=new Dh;var r=JSON.stringify(2.5*t);r=parseFloat(r),n.position.set(r,0,-5);var i=e;"number"==typeof e&&(i=JSON.stringify(i)),n.name=JSON.stringify(i),nP[i]=n;var o=(e=>{const t=e,n=document.createElement("canvas"),r=n.getContext("2d");n.width=100,n.height=100*t.length,r.fillStyle="white",r.fillRect(0,0,100,100*t.length),r.textAlign="center",r.font="bolder 90px monospace";for(let e=0;e<t.length;e++)r.fillStyle="black",e>3&&(r.fillStyle="red"),r.strokeRect(0,100*e,100,100),r.fillText(t[e],50,100*(e+1)-25);return n.toDataURL()})(i);rv(o).then((e=>{const t=new Dh;t.position.x=-1;var o=new Za({map:e}),s=i.length/10;const a=new Ul(.1,s,.1),l=new cp(a),c=new ic(.1,s),u=new Dl(c,o),h=new Dl(a,mv.whiteFull);h.position.z=-.051;const d=new Hd(l,mv.blackLineLone);d.position.z=-.051,t.add(u,h,d),t.position.set(r-1,0,-5),tP.add(t),tP.add(n)}))})(n,r),tP.children.length>5){const t=tP.children[0],n=tP.children[1];n.children.forEach((e=>{e.children.forEach((e=>{e.material.map&&e.material.dispose()}))})),zL.to(t.position,{duration:2,y:e.y+100}),zL.to(n.position,{duration:2,y:e.y+100}),setTimeout((()=>{tP.remove(t),tP.remove(n)}),2e3)}t.forEach(((e,t)=>{XL.postMessage({operation:e,feedType:"teztok"})}))}r++}))})(e,rP)}))}new Map;const oP=[];((e,t)=>{var n=document.createElement("div");n.className="galLoaderButton";var r=document.createElement("div");r.style.padding="10px",r.innerText="TezTok";const i=document.createElement("div");t.forEach((e=>i.appendChild(e))),n.addEventListener("click",(()=>{document.getElementById("galleryMainWindow").innerHTML="",document.getElementById("galleryMainWindow").append(i)})),n.appendChild(r),oP.push(n)})(0,function(){const e=[];var t=document.createElement("div");t.className="galLoaderButton";var n=document.createElement("div");return n.style.padding="10px",n.innerText="Live NFT transactions feed",n.addEventListener("click",(()=>{var e;iP(e={x:sI.position.x,y:sI.position.y,z:sI.position.z}),oM("CALLING TEZTOK"),setInterval((()=>{iP(e)}),2e4),mP()})),t.append(n),e.push(t),e}());const sP=window.localStorage,aP={highlights:'In this page, you can select and <b>load generative structures, \n    skies and items</b>. Because the anaverse is "generative", each element \n    you see in this table is a "generator", i.e. an algorithm creating multiple versions\n    of the same type of worlds. Clicking on a generator will reveal a \n    list of the different versions, or "iterations", available for the loading.',"Your collection":'This tab displays your <b>personal collection</b> if you are currently signed in. \n                      You can learn more on the different ways to <a href="https://observablehq.com/collection/@anaglyph-ic/starting-with-the-anaver-se"\n                      target="blank">securely sign in here</a>. \n                      If you are not signed in, Anaglyphic\'s personal collection will be loaded instead.\n                      To hang a painting, click first on an artist thumbnail, and then select the \n                      piece you want to hang.',"Your creations":"This tab displays your <b>personal creations</b> if you are currently signed in. \n                      If you are not signed in, Anaglyphic's personal creations will be loaded instead.\n                      To hang a painting, click first on a collection thumbnail, and then select the \n                      piece you want to hang.","Your local galleries":'This tab displays the <b>local galleries you created</b>. These galleries are only accessible\n                      on your current machine, and only as long as you do not purge your local website storage.\n                      To share a gallery with the world, you will need to learn how to <a href="https://observablehq.com/collection/@anaglyph-ic/starting-with-the-anaver-se"\n                      target="blank">export a local gallery</a>.',"Gallery builder":"Use these inputs to either save locally your current gallery or import a compatible gallery.json file.","Public galleries":"This tab displays <b>publicly accessible blockchain-indexed galleries</b>. These galleries are \n                      accessible by all users at all times. They are handcrafted by curators.","Data visualisation":"This tab displays <b>data visualisation procedures</b> available in the anaverse. The data presented \n                        in this tab is public and made to fit in a 3D environment for exploration.","Objkt Gems":'This tab displays <b>Cabline-curated OBJKT "Gems"</b>. These pieces are manually selected by Cabline, but\n                they are programmatically deployed in anaverse gallery templates.',"Versum Boards":"This tab displays <b>Versum Boards</b>. The board pieces are manually selected by board creators, but\n                    they are programmatically deployed in anaverse gallery templates.","SuperRare Spaces":"This tab displays <b>SuperRare Spaces</b> pieces lists."};var lP=document.getElementById("itemMetaData");const cP=e=>{if(xP){for(const e in tM)tM[e].focused=!1;if(e.focused=!0,e.hasOwnProperty("seaport_sell_orders")){var t="";e.hasOwnProperty("creator")&&e.creator.hasOwnProperty("user")&&e.creator.user&&e.creator.user.hasOwnProperty("username")&&(t="by "+e.creator.user.username);var n="";n=(n=BS||XM)?`From ${n}'s collection`:"",lP.style.display="block",lP.innerHTML=`<strong>${e.name}</strong> ${t}<br> <br><br><em>${e.description}</em><br><br>\n  <span style="font-size:9px;font-family:monospace;font-weight:bolder">PUSH P TO PULL THIS TOKEN - PUSH V TO HIDE THIS PANEL</span>`}else{t="","KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW"===e.fa.contract&&(e.url="https://versum.xyz/token/versum/"+e.token_id),e.hasOwnProperty("creators")&&e.creators[0]&&bv.hasOwnProperty(e.creators[0].creator_address)&&bv[e.creators[0].creator_address].alias&&(t=" by "+bv[e.creators[0].creator_address].alias),n="",BS&&(n=BS),n=n?`From ${n}'s collection`:"";var r="";e.description&&(r=e.description),lP.style.display="block",lP.innerHTML=`<strong>${e.name}</strong> ${t}<br> ${n}<br><br><em>${r}</em><br><br>\n  <span style="font-size:9px;font-family:monospace;font-weight:bolder">PUSH I TO INSPECT - P TO REMOVE - N TO GRAB - V TO HIDE THIS PANEL</span>`}}else lP.style.display="block",lP.style.width="auto",lP.innerHTML="<span style='font-size:10px;font-family:monospace;min-width:90px;'>Push V to toggle metadata</span>"},uP=e=>{const t=document.getElementById("tokens");t.innerHTML="",t.style.gridTemplateColumns="",t.appendChild(e.DOMelements.profile),t.appendChild(e.DOMelements.description);var n=document.createElement("div");n.innerText="LOADING COLLECTION ...",n.id="loadingCollection",t.appendChild(n)},hP=document.getElementById("toolback"),dP=e=>{const t=document.getElementById("tokens");if(t.style.overflow="hidden auto",t.innerHTML="",hP.innerHTML="",hP.style.display="none",hP.onclick=()=>{mP(),mP(!0)},t.style.gridTemplateColumns="",e.DOMelements.hasOwnProperty("profile")){var n=document.createElement("div");n.style.display="flex",n.appendChild(e.DOMelements.profile),n.appendChild(e.DOMelements.description),t.appendChild(n)}const r=document.createElement("DIV");r.id="filter",r.innerText="FILTER TOKENS";const i=document.createElement("ul");var o;i.style="margin: 50px;padding: 0;list-style : none",Zx&&(o=JSON.parse(sP.getItem(Zx)))&&JSON.parse(o.prevLoad);var s=30;e.DOMelements.gallery.length<30&&(s=e.DOMelements.gallery.length);for(let t=0;t<s;t++)i.appendChild(e.DOMelements.gallery[t]);if(30===s){const t=document.createElement("button");t.innerText="Display all iterations",t.addEventListener("click",(()=>{i.innerHTML="",e.DOMelements.gallery.forEach((e=>i.appendChild(e)))})),i.appendChild(t)}var a=document.createElement("div");if(a.style="display: grid;grid-template-columns: 20% 80%;",e.DOMelements.hasOwnProperty("filters"))e.DOMelements.filters.forEach((e=>{r.appendChild(e)})),a.appendChild(r);else{var l=document.createElement("div");a.appendChild(l),hP.onclick=()=>{mP(),pP(),mP()}}a.appendChild(i),t.appendChild(a)},pP=()=>{const e=document.getElementById("tokens");e.innerHTML="",e.style.gridTemplateColumns="",e.style="overflow:hidden hidden;display:grid;justify-content: left;grid-template-columns: 200px 2fr;",hP.innerHTML="";const t=document.createElement("div");t.id="galleryLeftMenu",t.style.borderRight="1px solid black";const n=document.createElement("div");n.id="galleryMainWindow",n.style.overflow="hidden auto";var r={"Your collection":{},"Your creations":{},"Your local galleries":{},"Gallery builder":{},"Public galleries":{},"Data visualisation":{},"Objkt Gems":{},"Versum Boards":{},"SuperRare Spaces":{}};for(const e in r){r[e].DOM={},r[e].DOM.title=document.createElement("div"),r[e].DOM.content=document.createElement("div");const i=document.createElement("div");i.innerText=e,i.id=e,i.className="gallerieMenuButton",i.addEventListener("click",(()=>{var t=document.getElementsByClassName("gallerieMenuButton");for(let e=0;e<t.length;e++)t[e].style.backgroundColor="transparent",t[e].style.color="black";i.style.backgroundColor="rgba(0,0,0,.8)",i.style.color="white",n.innerHTML=`<div class="helperPanel">${aP[e]}</div>`,n.appendChild(r[e].DOM.content)})),t.appendChild(i)}e.append(t,n);var i=document.createElement("div");i.className="artistList";var o=document.createElement("div");o.className="artistList";var s=document.createElement("div");s.className="artistList";var a=document.createElement("div");a.className="artistList";var l=document.createElement("div");l.className="artistList";var c=document.createElement("div");c.id="galleryBuilder",document.createElement("div").className="artistList";var u=document.createElement("div");u.className="artistList";var h=document.createElement("div");h.className="artistList";var d=document.createElement("div");d.className="artistList",oP.length>0&&(oP.forEach((e=>d.appendChild(e))),r["Data visualisation"].DOM.content=d),xT.length>0&&(xT.forEach((e=>{const t=document.createElement("div");t.className="galLoaderButton",t.style.paddingTop="40px",t.style.paddingBottom="40px",t.innerHTML=e.title+`<br><a target="_blank" style="font-size: 12px;" href="${e.connect}">Open on SuperRare</a>`,t.addEventListener("click",(()=>{n.innerHTML="";const t=document.createElement("div");t.className="artistList",e.tokens.forEach((e=>{const n=document.createElement("div");n.className="gentkProfiles";const r=new Image(198,198);r.className="thumbnail",r.src=e.thumbnailImage,r.onerror=()=>{r.src="/notfound.png"},r.style.cursor="pointer",r.addEventListener("click",(()=>{const t=e.contractAddress+e.tokenID;e.id=t,tM[t]=e;const n=e.standardImage;mP();const r={id:t,objkt:{token_id:e.tokenId,asset_contract:{address:e.contractAddress}}};tv(n,r,"openSea")})),r&&n.appendChild(r);const i=document.createElement("div");i.className="artThumbTitle";const o=document.createElement("div");o.className="artistNames",o.innerText=e.creator.username,i.appendChild(o),n.appendChild(i),t.appendChild(n)})),n.appendChild(t)})),l.appendChild(t)})),r["SuperRare Spaces"].DOM.content=l),Iv.length>0?(Iv.forEach((e=>h.appendChild(e))),r["Your creations"].DOM.content=h):document.getElementById("Your creations").style.display="none";var p=JSON.parse(sP.getItem("localGalleries"));p&&p.length>0&&p.forEach((e=>{var t=document.createElement("div");t.className="galLoaderButton";var n=document.createElement("div");n.style.border="1px dashed cyan",n.style.padding="10px",n.innerText=e.name,n.addEventListener("click",(()=>{mP(),FS(e)})),t.appendChild(n),t.appendChild((e=>{const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});var n=document.createElement("a");return n.href=URL.createObjectURL(t),n.download="gallery",n.innerText="Export gallery",n})(e)),t.appendChild(((e,t)=>{var n=document.createElement("div");n.innerText="X";var r=JSON.parse(zS.getItem("localGalleries")),i=[];return n.addEventListener("click",(()=>{r.forEach((n=>{if(n.name===e.name&&n.skybox===e.skybox&&n.room===e.room){var r=!0;for(let t=0;t<e.gallery.length;t++)e.gallery[t].objktMetaData.contract===n.gallery[t].objktMetaData.contract&&e.gallery[t].objktMetaData.token_id===n.gallery[t].objktMetaData.token_id||(r=!1);r?t&&t.remove():i.push(n)}})),zS.setItem("localGalleries",JSON.stringify(i))})),n})(e,t)),i.appendChild(t)})),r["Your local galleries"].DOM.content=i;const f=document.createElement("div");f.innerHTML=`\n<div id="galleryCreator">\n<div id="galleryCreatorForm">\n \n  <div id="galleryMetaData">\n  <b>Save your current gallery</b><br>\n  <br>Room ID: ${AM.room}\n  <br>Skybox ID: ${AM.skybox}\n  <br>Number of pieces: ${tI.children.length}\n  </div>\n  \n</div>\n</div>`;const m=document.createElement("input"),g=document.createElement("div");tI.children.length>0&&AM.room>0?(g.id="saveGallery",g.innerText="Save Gallery",g.addEventListener("click",IP),m.type="text",m.value="Enter a gallery name",m.required=!0,m.minlength=4,m.maxlength=40,m.id="galleryName",m.addEventListener("focusin",(()=>RP(1))),m.addEventListener("focusout",(()=>RP(0))),f.appendChild(m)):(g.id="saveGallery",g.innerHTML="<br>Choose an indexed room <br> and an indexed skybox to <br> get started."),f.appendChild(g),f.style="padding:5%;border:1px dashed cyan;",c.appendChild(f);const y=document.createElement("div"),v=document.createElement("div");v.innerHTML="<b>Import a gallery.json file<br> from your local device.</b><br></br>";const _=document.createElement("input");if(_.style.border="1px dashed cyan",_.style.padding="10px",_.style.margin="10px",_.style.backgroundColor="white",_.type="file",_.addEventListener("change",(e=>{hT.postMessage({type:"local",path:e.target.files[0]})})),y.appendChild(v),y.appendChild(_),y.style="padding:5%;border:1px dashed cyan;",c.appendChild(y),r["Gallery builder"].DOM.content=c,aT.length>0&&(aT.forEach((e=>{var t=document.createElement("div");t.className="galLoaderButton";var n=document.createElement("div");n.style.padding="10px",n.innerText=e.name,e.hasOwnProperty("audioguide")&&(t.style.border="2px solid cyan"),e.DOMthumb&&(e.DOMthumb.style.width="196px",t.appendChild(e.DOMthumb),e.DOMthumb.addEventListener("click",(()=>{mP(),FS(e)}))),t.appendChild(n);const r=`https://anaver.se/?gallery=1&galc=${e.contract}&galid=${e.id}`,i=document.createElement("button");i.innerText="link",i.style="background-color: white;border: 1px solid red;border-radius: 3px;margin:5px;",i.addEventListener("click",(()=>{i.innerText="Copied!",navigator.clipboard.writeText(r),setTimeout((()=>{i.innerText="link"}),1300)})),t.appendChild(i);const s=document.createElement("div");s.className="artThumbTitle",pT.hasOwnProperty(e.curator)&&pT[e.curator]&&pT[e.curator].DOM&&(s.innerHTML=pT[e.curator].DOM.innerHTML,s.style.top="0px",t.appendChild(s)),o.appendChild(t)})),r["Public galleries"].DOM.content=o),dT.length>0&&(dT.forEach((e=>{var t=document.createElement("div");t.className="galLoaderButton";var n=document.createElement("div");n.style.padding="10px",n.innerText=e.name,t.addEventListener("click",(()=>{mP(),wT("objkt",e.category)})),e.DOMthumb?t.appendChild(e.DOMthumb):t.appendChild(document.createElement("div")),t.appendChild(n),s.appendChild(t)})),r["Objkt Gems"].DOM.content=s),bT.length>0&&(bT.forEach((e=>{var t=document.createElement("div");t.className="galLoaderButton";var n=document.createElement("div");n.style.padding="10px",n.innerText=e.title,t.addEventListener("click",(()=>{mP(),wT("versum",e.id)})),e.DOMthumb&&t.appendChild(e.DOMthumb),t.appendChild(n);const r=document.createElement("div");r.className="artThumbTitle",pT.hasOwnProperty(e.curator)&&pT[e.curator]&&pT[e.curator].DOM&&(r.innerHTML=pT[e.curator].DOM.innerHTML,r.style.top="0px",t.appendChild(r)),a.appendChild(t)})),r["Versum Boards"].DOM.content=a),nM.length>0){let e=0;nM.forEach((t=>{e++,e<30&&u.appendChild(t)}));var w=document.createElement("button");w.innerText="Display the whole collection",w.addEventListener("click",(()=>{u.innerHTML="",nM.forEach((e=>u.appendChild(e)))})),u.appendChild(w),r["Your collection"].DOM.content=u}n.innerHTML=`<div class="helperPanel">${aP["Your collection"]}</div>`,n.appendChild(r["Your collection"].DOM.content)};var fP=!1;const mP=e=>{var t=document.getElementById("anavTooltip"),n=document.getElementById("tokens");fP?(window.innerWidth>window.innerHeight&&aI.lock(),n.innerHTML="",t.style.zIndex=0,t.style.display="none",fP=!1):(window.innerWidth>window.innerHeight&&aI.unlock(),e&&(hP.style.display="none",hP.innerHTML="",(()=>{const e=document.getElementById("tokens");e.innerHTML="";var t=document.createElement("div"),n=document.createElement("ul");if(n.style.listStyle="none",e.style.gridTemplateColumns="",e.style.overflow="hidden auto",e.style.display="block",Zx){n.className="tokensDiv";var r=document.createElement("div");r.innerText="Personal tokens",r.className="tokenCatTitle",r.style.cursor="pointer",r.addEventListener("click",(()=>{"block"===n.style.display?(n.style.display="inline-flex",n.style.height="220px",n.style.alignItems="flex-start",n.style.flexWrap="nowrap"):(n.style.display="block",n.style.height="",n.style.alignItems="")})),t.appendChild(r);const e=JSON.parse(sP.getItem(Zx));e&&JSON.parse(e.prevLoad),n.style.height="220px",n.style.alignItems="flex-start",n.style.flexWrap="nowrap",eM.forEach((e=>{n.append(e)}))}var i=[];for(const e in XS)i.push(XS[e]);var o=i[parseInt(Math.random()*i.length)].metadata.childrenDescription;o.length>500&&(o=o.substring(0,500)+"...");var s=document.createElement("div");s.id="highlight",s.innerHTML=`<div id='highlightDesc' class='helperPanel'>\n  ${aP.highlights}\n      </div>\n      `;var a=document.createElement("div");a.innerHTML="<div class='tokenCatTitle'>First Person - Handeld Items</div>";var l=document.createElement("div");l.className="tokensDiv";var c=document.createElement("div");c.innerHTML="<div class='tokenCatTitle'>Rooms & spaces</div>";var u=document.createElement("div");u.className="tokensDiv";var h=document.createElement("div");h.innerHTML="<div class='tokenCatTitle'>Skies and environments</div>";var d=document.createElement("div");d.className="tokensDiv";var p=document.createElement("div");p.innerHTML="<div class='tokenCatTitle'>Sculptures</div>";var f=document.createElement("div");f.className="tokensDiv";for(const e in XS){const t=XS[e];"firstPerson"===t.type?l.appendChild(t.DOMelements.profile):"world"===t.type&&t.tag.room?u.appendChild(t.DOMelements.profile):"skybox"===t.type?WS?9574===t.id&&d.appendChild(t.DOMelements.profile):d.appendChild(t.DOMelements.profile):"world"===t.type&&t.tag.item&&f.appendChild(t.DOMelements.profile)}(WS?[d]:[s,t,n,c,u,h,d,p,f,a,l]).forEach((t=>e.appendChild(t)))})()),t.style.display="grid",t.style.zIndex=48,fP=!0)},gP=new class{parse(e,t={}){const n=void 0!==t.binary&&t.binary,r=[];let i,o=0;e.traverse((function(e){if(e.isMesh){const t=e.geometry;if(!0!==t.isBufferGeometry)throw new Error("THREE.STLExporter: Geometry is not of type THREE.BufferGeometry.");const n=t.index,i=t.getAttribute("position");o+=null!==n?n.count/3:i.count/3,r.push({object3d:e,geometry:t})}}));let s=80;if(!0===n){const e=new ArrayBuffer(2*o+3*o*4*4+80+4);i=new DataView(e),i.setUint32(s,o,!0),s+=4}else i="",i+="solid exported\n";const a=new ks,l=new ks,c=new ks,u=new ks,h=new ks,d=new ks;for(let e=0,t=r.length;e<t;e++){const t=r[e].object3d,n=r[e].geometry,i=n.index,o=n.getAttribute("position");if(null!==i)for(let e=0;e<i.count;e+=3)p(i.getX(e+0),i.getX(e+1),i.getX(e+2),o,t);else for(let e=0;e<o.count;e+=3)p(e+0,e+1,e+2,o,t)}return!1===n&&(i+="endsolid exported\n"),i;function p(e,t,r,o,p){a.fromBufferAttribute(o,e),l.fromBufferAttribute(o,t),c.fromBufferAttribute(o,r),!0===p.isSkinnedMesh&&(p.boneTransform(e,a),p.boneTransform(t,l),p.boneTransform(r,c)),a.applyMatrix4(p.matrixWorld),l.applyMatrix4(p.matrixWorld),c.applyMatrix4(p.matrixWorld),function(e,t,r){u.subVectors(r,t),h.subVectors(e,t),u.cross(h).normalize(),d.copy(u).normalize(),!0===n?(i.setFloat32(s,d.x,!0),s+=4,i.setFloat32(s,d.y,!0),s+=4,i.setFloat32(s,d.z,!0),s+=4):(i+="\tfacet normal "+d.x+" "+d.y+" "+d.z+"\n",i+="\t\touter loop\n")}(a,l,c),f(a),f(l),f(c),!0===n?(i.setUint16(s,0,!0),s+=2):(i+="\t\tendloop\n",i+="\tendfacet\n")}function f(e){!0===n?(i.setFloat32(s,e.x,!0),s+=4,i.setFloat32(s,e.y,!0),s+=4,i.setFloat32(s,e.z,!0),s+=4):i+="\t\t\tvertex "+e.x+" "+e.y+" "+e.z+"\n"}}},yP=document.createElement("a");yP.style.display="none",document.body.appendChild(yP);var vP,_P=0;const wP=()=>bP=!bP;var bP=!1,xP=!0,EP=!1,SP=0;Un({minus:"-"});const MP=document.getElementById("audio-radio");MP.style.display="flex";const TP=window.localStorage;var AP=document.getElementById("helper");AP.style.display="block",AP.addEventListener("touchstart",(()=>{AP.style.display="none"}));const RP=e=>_P=e;function CP(){if(nI.children.length>0){var e=nI.children[0];e.children.forEach((e=>{("Mesh"===e.type||e.isLineSegments)&&("PlaneGeometry"===e.geometry.type?(e.material.opacity=1,e.material.transparent=!1):e.isLineSegments||(e.material=mv.whiteFull))})),tI.attach(e),ES(),nI.clear(),KL(!0),LP()}}function LP(){let e=document.getElementById("worldItemTooltip");e.innerHTML="",e.style.display="none"}const PP=document.getElementById("objktViewer");PP.style.border="1x solid black";const IP=()=>{AM.name=document.getElementById("galleryName").value,tI.children.forEach((e=>{var t={};e.userData.hasOwnProperty("tokenType")&&(t.tokenType=e.userData.tokenType,"block"===e.userData.tokenType&&(t.block=e.userData),"sculpture"===e.userData.tokenType&&(t.fxMetaData=e.userData.fxMetaData)),e.userData.hasOwnProperty("openSeaMetaData")&&(t.openSeaMetaData=e.userData.openSeaMetaData),e.userData.hasOwnProperty("objktMetaData")&&(t.objktMetaData=e.userData.objktMetaData),t.position={x:kn(".4f")(e.position.x),y:kn(".4f")(e.position.y),z:kn(".4f")(e.position.z)},t.rotation={x:kn(".4f")(e.rotation.x),y:kn(".4f")(e.rotation.y),z:kn(".4f")(e.rotation.z)},t.scale={x:kn(".4f")(e.scale.x),y:kn(".4f")(e.scale.y),z:kn(".4f")(e.scale.z)},AM.gallery.push(t),galleryCreator.style.display="none",galleryCreator.style.zIndex=-5,document.getElementById("galleryMetaData").innerHTML="",document.addEventListener("keydown",OP)}));const e=window.location.search,t=new URLSearchParams(e);t.has("wallet")?AM.collection=t.get("wallet"):AM.collection=Zx,document.addEventListener("keydown",OP);var n=JSON.parse(TP.getItem("localGalleries"));n?(n.push(AM),TP.setItem("localGalleries",JSON.stringify(n))):TP.setItem("localGalleries",JSON.stringify([AM])),_P=0,mP(),oM("GALLERY SAVED LOCALLY"),setTimeout((()=>{oM()}),1500)},OP=e=>{if(!_P)switch(e.code){case"ShiftLeft":EP?EP=!1:SP||(EP=!0,setTimeout((()=>{EP=!1}),7e3),SP=!0,setTimeout((()=>{SP=!1}),2e4));break;case"KeyB":"0.3s linear 0s 1 normal forwards running slideRight"===AP.style.animation?AP.style.animation="slideLeft .3s linear forwards":AP.style.animation="slideRight .3s linear forwards";break;case"KeyX":(()=>{const e=new qh;var t,n;eI.children[0].children.forEach((t=>{if("Mesh"===t.type){const n=t.clone();e.add(n)}else"Group"===t.type&&t.children.forEach((n=>{if("Mesh"===n.type){const n=t.clone();e.add(n)}}))})),t=gP.parse(e),n="anaverse.stl",function(e,t){yP.href=URL.createObjectURL(e),yP.download=t,yP.click()}(new Blob([t],{type:"text/plain"}),n)})();break;case"KeyL":mP(!0);break;case"KeyC":let e=document.getElementById("viseur");"block"===e.style.display?e.style.display="none":e.style.display="block";break;case"KeyK":document.body.requestFullscreen();break;case"KeyG":0===nI.children.length&&(pP(),mP());break;case"KeyN":if("none"===document.getElementById("worldItemTooltip").style.display){if(VL){let e=VL.object.parent;nI.attach(e),gM(VL.object.parent),aI.unlock()}}else LP();break;case"KeyH":CP();break;case"KeyI":var t;for(const e in tM)tM[e].focused&&(t=tM[e]);t&&(vP?(aI.lock(),PP.src="",PP.style.zIndex=0,PP.style.display="none",vP=0):(aI.unlock(),t.hasOwnProperty("permalink")?window.open(t.permalink,"_blank"):t.hasOwnProperty("fa")&&("KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW"===t.fa.contract?window.open("https://versum.xyz/token/versum/"+t.token_id,"_blank"):(PP.src=t.url,PP.style.zIndex=150,PP.style.display="block",PP.style.left="10%",PP.style.top="10%",PP.width=.8*window.innerWidth,PP.height=.8*window.innerHeight,vP=1))));break;case"KeyP":tI.children.forEach((e=>{e.userData.focused&&(tI.remove(e),ES()),e.userData.hasOwnProperty("id")&&tM[e.userData.id].focused&&(tI.remove(e),ES())}));break;case"KeyY":"flex"===MP.style.display?MP.style.display="none":MP.style.display="flex";break;case"KeyV":xP=!xP;break;case"KeyU":0===nI.children.length&&((()=>{const e=document.getElementById("tokens");e.innerHTML="",e.style.gridTemplateColumns="",e.style="overflow:hidden hidden;display:grid;justify-content: left;grid-template-columns: 200px 2fr;",hP.innerHTML="";const t=document.createElement("div");t.id="galleryLeftMenu",t.style.borderRight="1px solid black";const n=document.createElement("div");n.id="galleryMainWindow",n.style.overflow="hidden auto";for(const e in MS){MS[e].DOM={},MS[e].DOM.title=document.createElement("div"),MS[e].DOM.content=document.createElement("div");const i=document.createElement("div");i.innerText=e,i.id=e,i.className="gallerieMenuButton",i.addEventListener("click",(()=>{var t=document.getElementsByClassName("gallerieMenuButton");for(let e=0;e<t.length;e++)t[e].style.backgroundColor="transparent",t[e].style.color="black";i.style.backgroundColor="rgba(0,0,0,.8)",i.style.color="white",n.innerHTML="",n.appendChild(MS[e].DOM.title),n.appendChild(MS[e].DOM.content)})),t.appendChild(i);var r=document.createElement("div");r.className="tokensDiv",MS[e].forEach((e=>r.appendChild(e))),MS[e].DOM.content=r}e.append(t,n)})(),mP())}},NP=new xa(0,0,0,"YXZ"),kP=new ks,DP={type:"change"},BP={type:"lock"},UP={type:"unlock"},zP=Math.PI/2;function FP(e){return e>-3*zP/2&&e<-zP/2?-zP:e>-zP/2&&e<zP/2?0:e>zP/2&&e<1.5*zP?zP:e>1.5*zP||e<-3*zP/2?2*zP:void 0}var HP,GP;class VP extends $o{constructor(e,t){function n(){HP.domElement.ownerDocument.pointerLockElement===HP.domElement?(HP.dispatchEvent(BP),HP.isLocked=!0):(HP.dispatchEvent(UP),HP.isLocked=!1)}function r(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}super(),void 0===t&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),t=document.body),this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,HP=this,GP=t=>{if(!1===HP.isLocked)return;const n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;if(NP.setFromQuaternion(e.quaternion),NP.y-=.002*n,NP.x-=.002*r,NP.x=Math.max(zP-HP.maxPolarAngle,Math.min(zP-HP.minPolarAngle,NP.x)),e.quaternion.setFromEuler(NP),bP){var i=new xa(FP(NP._x),FP(NP._y),FP(NP._z),"YXZ");nI.quaternion.setFromEuler(i)}else nI.quaternion.setFromEuler(NP);HP.dispatchEvent(DP)},this.connect=function(){HP.domElement.ownerDocument.addEventListener("mousemove",GP),HP.domElement.ownerDocument.addEventListener("pointerlockchange",n),HP.domElement.ownerDocument.addEventListener("pointerlockerror",r)},this.disconnect=function(){HP.domElement.ownerDocument.removeEventListener("mousemove",GP),HP.domElement.ownerDocument.removeEventListener("pointerlockchange",n),HP.domElement.ownerDocument.removeEventListener("pointerlockerror",r)},this.dispose=function(){this.disconnect()},this.getObject=function(){return e},this.getDirection=function(){const t=new ks(0,0,-1);return function(n){return n.copy(t).applyQuaternion(e.quaternion)}}(),this.moveForward=function(t){kP.setFromMatrixColumn(e.matrix,0),kP.crossVectors(e.up,kP),e.position.addScaledVector(kP,t)},this.moveRight=function(t){kP.setFromMatrixColumn(e.matrix,0),e.position.addScaledVector(kP,t)},this.lock=()=>this.domElement.requestPointerLock(),this.unlock=()=>HP.domElement.ownerDocument.exitPointerLock(),this.connect()}}const jP=new Audio("/sound/jetpack/jetpack_start.mp3");jP.volume=1;const WP=new Audio("/sound/jetpack/jetpack_croisiere.mp3");WP.volume=1,WP.loop=!0;var qP=!0;const KP=()=>{jP.play(),qP=!0,setTimeout((()=>{qP&&WP.play()}),2e3)},XP=()=>{jP.pause(),WP.pause(),qP=!1},YP=new Audio("/sound/steps/steps.mp3");YP.volume=.1;const JP=e=>e?YP.play():YP.pause();var ZP;const QP=new Dh;QP.name="fpGroup";const $P=new Dh;$P.name="worldGroup";const eI=new Dh;eI.name="roomGroup";const tI=new Dh;tI.name="itemGroup";const nI=new Dh;var rI;nI.name="movingGroup",$P.add(eI,tI,nI);const iI=new ks;var oI,sI,aI;const lI=()=>{iI.y=0,sI.position.set(0,4,0)},cI=new nm,uI=(e,t)=>{let n=[];for(const i in e){var r=document.createElement("canvas");r.width=t,r.height=t,r.getContext("2d").putImageData(e[i],0,0),n.push(r.toDataURL())}const i=cI.load(n);i.needsUpdate=!0,i.mapping=qr,ZP.background=i,setTimeout((()=>{oM()}),1200),nT()},hI=()=>{var e=window.innerHeight,t=window.innerWidth;const n=document.getElementById("cont"),r=new Gm,i=t/e,o=new ks;document.addEventListener("keydown",OP),document.getElementById("loader-button").addEventListener("click",(()=>{mP(!0)})),document.getElementById("gallery-button").addEventListener("click",(()=>{0===nI.children.length&&(pP(XS),mP())})),document.getElementById("hang-button").addEventListener("click",CP);const s=new qh;(oI=new jl(60,i,1e-4,1e4)).position.set(0,0,.1);const a=new Gh({antialias:!0,alpha:!0});a.setClearColor(0,0),a.setSize(t,e),a.setPixelRatio(devicePixelRatio),s.background=null,QP.position.set(.1,-.11,-.1),QP.rotation.y=-Math.PI/2,s.add(QP);const l=new Gh({antialias:!0});l.setSize(t,e),l.setPixelRatio(devicePixelRatio),(sI=new jl(60,i,.1,1e4)).position.set(0,1,2),sI.lookAt(new ks(0,0,0)),ZP=new qh,$P.name="World",ZP.add($P),n.appendChild(l.domElement),l.domElement.style.position="absolute",l.domElement.style.top="0px",l.domElement.style.left="0px";var c=`rgb(${Math.floor(255*Math.random())},${Math.floor(120*Math.random())},${Math.floor(255*Math.random())})`,u=new Ss(c);ZP.background=u,n.appendChild(a.domElement),a.domElement.style.position="absolute",a.domElement.style.top="0px",a.domElement.style.left="0px",a.domElement.style.pointerEvents="none",aI=new VP(sI,l.domElement);let h=!1,d=!1,p=!1,f=!1;ZP.add(aI.getObject());var m,g,y,v=!1;document.getElementById("mobile-jetpack").addEventListener("touchstart",(e=>{v?(clearInterval(m),XP()):m=setInterval((()=>{KP(),iI.y+=3}),40),v=!v}));const _=new xa(0,0,0,"YXZ");l.domElement.addEventListener("touchstart",(e=>{for(let t=0;t<e.touches.length;t++){const n=e.touches[t];n.clientX<window.innerWidth/2&&(y=n)}})),l.domElement.addEventListener("touchmove",(e=>{for(let t=0;t<e.touches.length;t++){const n=e.touches[t];if(n.clientY>.3*window.innerHeight)if(n.clientX>window.innerWidth/2){e.preventDefault(),g&&(e.movementX=15*(n.pageX-g.pageX),e.movementY=3*(n.pageY-g.pageY));const t=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;_.setFromQuaternion(sI.quaternion),_.y-=.002*t,_.x-=.002*r,sI.quaternion.setFromEuler(_),nI.quaternion.setFromEuler(_),g=n}else e.preventDefault(),y&&(e.movementX=n.pageX-y.pageX,e.movementY=n.pageY-y.pageY),w&&(h=!1,p=!1,f=!1,d=!1,window.innerHeight,Math.abs(e.movementX)<Math.abs(e.movementY)?e.movementY>0?(h=!1,p=!1,f=!1,d=!0):(h=!0,p=!1,f=!1,d=!1):Math.abs(e.movementX)>Math.abs(e.movementY)&&(e.movementX>0?(h=!1,p=!1,f=!0,d=!1):(h=!1,p=!0,f=!1,d=!1)),y=n,w=!1)}})),l.domElement.addEventListener("touchend",(()=>{y=!1}));var w=!0;l.domElement.addEventListener("touchend",(e=>{h=!1,d=!1,p=!1,f=!1,g=!1,w=!0})),document.addEventListener("keydown",(function(e){if(!_P)switch(e.code){case"ArrowUp":case"KeyW":h=!0;break;case"ArrowLeft":case"KeyA":p=!0;break;case"ArrowDown":case"KeyS":d=!0;break;case"ArrowRight":case"KeyD":f=!0;break;case"Space":iI.y<.5&&aI.getObject().position.y>-20?iI.y+=30:(iI.y+=2,KP());break;case"KeyR":lI()}})),document.addEventListener("keyup",(function(e){switch(e.code){case"ArrowUp":case"KeyW":h=!1;break;case"ArrowLeft":case"KeyA":p=!1;break;case"ArrowDown":case"KeyS":d=!1;break;case"ArrowRight":case"KeyD":f=!1;break;case"Space":XP()}})),aI.moveSpeed=0;let b=new ks,x=new ks,E=new Us,S=new da,M=new Rg,T=new Rg(new ks,new ks(0,-1,0));var A=!1;new Za({color:"pink",side:nr}),rI=function(){if((()=>{if(WL){jL.setFromCamera(GL,sI,0,12);const e=jL.intersectObjects(tI.children);if(e)if(e.length>1){if(VL=e[0],VL.object.hasOwnProperty("userData")&&VL.distance<12)if(VL.object.userData.isWorldItem)tM.hasOwnProperty(VL.object.userData.objktID)&&cP(tM[VL.object.userData.objktID]);else if(VL.object.userData.isBlockPanel){let e=VL.object.parent;qL&&qL.material===mv.redFull&&qL.parent!=e&&(qL.material=mv.whiteFull,qL.scale.x-=.04,qL.scale.y-=.14,e.children.forEach((e=>{e.isMesh&&e.material===mv.whiteFull&&(e.material=mv.redFull,e.scale.x+=.04,e.scale.y+=.14,qL=e)}))),qL||e.children.forEach((e=>{e.isMesh&&e.material===mv.whiteFull&&(e.material=mv.redFull,e.scale.x+=.04,e.scale.y+=.14,qL=e)}))}}else document.getElementById("itemMetaData").style.display="none",VL=null,qL&&qL.material===mv.redFull&&(qL.material=mv.whiteFull,qL.scale.x-=.04,qL.scale.y-=.1,qL=null)}})(),qM)A||(eI.children.forEach((e=>{"green"===e.userData.color&&(e.clear(),eI.remove(e))})),l.renderLists.dispose(),A=!0);else{var e=sI.getWorldDirection(new ks),t=e.z>0?-1:1,n=e.x>0?1:-1;eI.children.forEach((r=>{"green"===r.userData.color&&(r.position.x=Math.abs(.2*e.x)*t,r.position.z=Math.abs(.2*e.z)*n)}))}function i(e){if(EP||(aI.getObject().position.y<8&&iI.y<0&&aI.getObject().position.y>3?iI.y=-30/$M:iI.y-=50*e/$M),iI.x-=10*iI.x*e,iI.z-=10*iI.z*e,o.z=Number(h)-Number(d),o.x=Number(f)-Number(p),o.normalize(),aI.getObject().updateMatrixWorld(),(h||d)&&(iI.z-=o.z*aI.moveSpeed*e),(p||f)&&(iI.x-=o.x*aI.moveSpeed*e),aI.moveRight(-iI.x*e),aI.moveForward(-iI.z*e),aI.getObject().position.y+=iI.y*e,bS){E.makeEmpty(),S.copy(bS.matrixWorld).invert(),M.copy(T),M.start.applyMatrix4(aI.getObject().matrixWorld).applyMatrix4(S),M.end.applyMatrix4(aI.getObject().matrixWorld).applyMatrix4(S),E.expandByPoint(M.start),E.expandByPoint(M.end),E.min.addScalar(-1),E.max.addScalar(1);var t=!1;bS.geometry.boundsTree.shapecast({intersectsBounds:e=>e.intersectsBox(E),intersectsTriangle:e=>{const n=b,r=x,i=e.closestPointToSegment(M,n,r);if(i<1){t=!0;const e=1-i,o=r.sub(n).normalize();M.start.addScaledVector(o,e),M.end.addScaledVector(o,e)}}});const e=b;e.copy(M.start).applyMatrix4(bS.matrixWorld);const n=x;n.subVectors(e,aI.getObject().position);const r=Math.max(0,n.length()-.1);n.normalize().multiplyScalar(r),t?(aI.getObject().position.add(n),JP(!!(d||h||p||f)),n.y<1&&n.y>0&&(iI.y=.01)):JP(!1)}aI.getObject().position.y<-25&&lI()}l.render(ZP,sI),a.render(s,oI),requestAnimationFrame(rI);const c=Math.min(r.getDelta(),.1);for(let e=0;e<2;e++)i(c/2);bP?nI.position.set(Math.floor(aI.getObject().position.x),Math.floor(aI.getObject().position.y),Math.floor(aI.getObject().position.z)):nI.position.set(aI.getObject().position.x,aI.getObject().position.y,aI.getObject().position.z)};const R=document.getElementById("objktViewer");window.addEventListener("resize",(()=>{e=window.innerHeight,t=window.innerWidth,sI.aspect=t/e,sI.updateProjectionMatrix(),l.setSize(t,e),l.setPixelRatio(devicePixelRatio),oI.aspect=t/e,oI.updateProjectionMatrix(),a.setSize(t,e),a.setPixelRatio(devicePixelRatio),R.style.left="10%",R.style.top="10%",R.width=.8*t,R.height=.8*e}))},dI=[];for(let e=0;e<10;e++)dI.push(new ds(4*Math.cos(.4*e)+5+2*Math.random(),3*(e-1)));const pI=new uf(dI,32,Math.PI/5,2*Math.PI-Math.PI/5),fI=(new cp(pI),new Za({side:nr,color:"white"}),[]);for(let e=0;e<10;e++)fI.push(new ds(3*Math.sin(e*Math.random()*5)+Math.random(),4*(e-1)));new uf(fI,32),new Za({side:nr,color:"black"}),r["Total ANAVER.SE"]["dbut"]=window.performance.now(),console.info("\n _______ _______ _______ _______ _______ _______     _______ _______ \n|  _  | |   | | |  _  | |  |  | |   __|_| __  | |   |   __|_|   __|_|\n|     | | | | | |     | |  |  | |   __|_|    -|-|_ _|__   | |   __|_|\n|__|__|_|_|___|_|__|__|_|____/_/|_____|_|__|__|_|_|_|_____|_|_____|_|\n                                                  \nWelcome to the anaver.se\nIf you want to learn more -> twitter.com/anaglyph_ic"),(()=>{r["Code Barre"]["dbut"]=window.performance.now();const e=document.getElementById("cont");document.getElementById("barcode")&&document.getElementById("barcode").remove();const t=Fn("svg").attr("width",200).attr("height",40).attr("id","barcode");t.style("left","10px"),t.style("top","0px"),t.style("position","absolute");var n=t.append("g").attr("id","barrouge"),i=t.append("g").attr("id","barcyan");for(let e=0;e<30;e++)i.append("rect").style("mix-blend-mode","multiply").attr("x",5*e).attr("y",.01*window.innerHeight).attr("width",Gn[e]).attr("height",40).attr("fill","rgb(0,255,235)"),n.append("rect").style("mix-blend-mode","multiply").attr("x",5*e).attr("y",.01*window.innerHeight).attr("width",Gn[e]).attr("height",40).attr("fill","rgb(255,0,0)");e.append(t.node()),r["Code Barre"].fin=window.performance.now()})(),async function(){r["Identit"]["dbut"]=window.performance.now(),qx=new Ux({name:"anaverse"});const e=await qx.getActiveAccount();e?(Hx(),Kx.innerHTML="<div style='font-size:12px'>LOADING PROFILE...</div>",Zx=e.address,$x(e.address)):(async function(){Kx.innerHTML="",Yx.addEventListener("click",eE)}(),Fx(),eT())}(),r["Liste des Jetons Natifs"]["dbut"]=window.performance.now(),(0,gv.request)("https://api.fxhash.xyz/graphql",YS.getAllTokens).then((e=>{e.user.generativeTokens.forEach((e=>{e.author.id,e.tags.forEach((t=>{"anaverse"===t&&(XS[e.slug]=e),"skybox"===t&&(XS[e.slug].type="skybox")}));var t=e.metadata.artifactUri.slice(7,e.metadata.artifactUri.indexOf("?fxhash=")),n="https://gateway.fxhash.xyz/ipfs/"+t+"/figures.js",r="https://gateway.fxhash.xyz/ipfs/"+t+"/skybox.js";e.skyboxUrl=r,e.figuresUrl=n})),_v("anaver.se native tokens retrieval",""),r["Liste des Jetons Natifs"].fin=window.performance.now(),(()=>{for(const r in XS){const i=XS[r];i.tag={},i.tags.forEach((e=>{i.tag[e]=!0,("firstPerson"===e||"world"===e||"skybox"===e)&&(i.type=e)})),i.title=i.metadata.name.replace("anaverse - ","");const o=document.createElement("DIV");o.className="gentkProfiles";const s="https://gateway.fxhash.xyz/ipfs/"+i.metadata.thumbnailUri.replace("ipfs://","");i.metadata.imgURI=s;const a=new Image;a.src=s,a.onerror=e=>{thb.src="/notfound.png"},a.className="thumbnail",a.addEventListener("click",(()=>QS(i))),o.appendChild(a);var e=document.createElement("div");e.className="thumbTitle";var t=document.createElement("A");t.href="https://www.fxhash.xyz/marketplace/generative/"+i.id,t.target="_blank",t.innerText=i.title,t.style="font-style: italic;font-weight: 100;",e.appendChild(t),o.appendChild(e);var n=document.createElement("div");n.className="gentkDesc",n.innerText=i.metadata.childrenDescription,i.filters={},i.DOMelements={profile:o,description:n,gallery:[]}}r["Choix alatoire"]["dbut"]=performance.now(),Zx&&iM(Zx),window.location.search?(()=>{eT();const e=window.location.search,t=new URLSearchParams(e);var n=!t.get("gallery")&&!t.has("autogalgen");if(t.has("tutorial"))FS(jS),setTimeout((()=>{JM()}),400);else{if(t.has("wallet")){const e=t.get("wallet");xv([e],!0),iM(e)}t.has("ethwallet")&&Fv(t.get("ethwallet"))}n&&JS()})():JS()})(),_v("anaver.se native tokens manual retrieval","")})).catch((e=>{console.log(e),_v("anaver.se native tokens retrieval","")})),hI(),r["Galleries OBJKT"]["dbut"]=window.performance.now(),fetch("https://back.objkt.com/api/v1/cms/curation/categories").then((e=>e.json())).then((e=>{e.tokenCategories.forEach((e=>{var t=e.firstTokens[Math.floor(Math.random()*e.firstTokens.length)],n=new Image(200);n.src="https://assets.objkt.media/file/assets-003/"+t.contract+"/"+t.tokenId+"/thumb288",n.className="thumbnail",n.onerror=()=>{e.DOMthumb=""},e.DOMthumb=n,dT.push(e)})),dT=uT(dT),r["Galleries OBJKT"].fin=window.performance.now()})),r["Galleries VERSUM"]["dbut"]=window.performance.now(),(e=>{for(let e=0;e<3;e++)fetch("https://versum.xyz/api/anaverse/boards?offset="+parseInt(10*e)).then((e=>e.json())).then((e=>{var t=[];e.token_lists.forEach((e=>{var n=new Image(200);e.curator=e.user.id,pT.hasOwnProperty(e.curator)||(pT[e.curator]=!0),t.push(e.user.id),e.cover_uri?n.src="https://ipfs.io/ipfs/"+e.cover_uri.replace("ipfs://",""):e.tokens.length>0&&e.tokens[0].token.formats.forEach((e=>{"preview_image_480w.jpg"===e.fileName&&(n.src="https://ipfs.io/ipfs/"+e.uri.replace("ipfs://",""))})),n.className="thumbnail",n.onerror=()=>{e.DOMthumb=""},e.DOMthumb=n,bT.push(e)})),fT(t),r["Galleries VERSUM"].fin=window.performance.now()}))})(),r["Galleries SuperRare"]={},fetch("https://superrare.com/api/v2/spaces").then((e=>e.json())).then((e=>{(xT=e.result).forEach((e=>{const t=`https://superrare.com/api/v2/spaces/${e.slug}/gallery`;e.connect=`https://superrare.com/spaces/${e.slug}/lobby`,fetch(t).then((e=>e.json())).then((t=>{e.tokens=[],t.result.galleries.forEach((t=>{t.tokens.forEach((t=>{t.fa={contract:null},t.permalink=`https://opensea.io/assets/ethereum/${t.contractAddress}/${t.tokenId}`,e.tokens.push(t)}))}))})).catch((e=>console.log("error fetching a superrare gallery")))})),uT(xT),r["Galleries SuperRare"].fin=window.performance.now()})),r["Galleries Natives"]["dbut"]=window.performance.now(),(0,gv.request)("https://data.objkt.com/v3/graphql",sT).then((e=>{var t=[];e.token_tag.forEach((e=>{const n="https://assets.objkt.media/file/assets-003/"+e.token.artifact_uri.replace("ipfs://","")+"/artifact/gallery.json";var r=!0;e.token.holders.forEach((e=>{"tz1burnburnburnburnburnburnburjAYjjX"===e.holder_address&&(r=!1)})),r&&t.push({galurl:n,contract:e.token.fa_contract,id:e.token.token_id,curator:e.token.creators[0].creator_address,thumbnail:e.token.thumbnail_uri,artifact:e.token.artifact_uri})})),hT.postMessage({type:"remote",galleryURLs:t})})),NS(AS),IS.innerHTML='<img  style="width:15px;height:15px" src="play.svg">',kS=setInterval((()=>{NS(AS)}),5e3)})()})();