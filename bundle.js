/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={8099:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7117);function i(t,e,n){return void 0===e&&(e=new Uint8Array(2)),void 0===n&&(n=0),e[n+0]=t>>>8,e[n+1]=t>>>0,e}function o(t,e,n){return void 0===e&&(e=new Uint8Array(2)),void 0===n&&(n=0),e[n+0]=t>>>0,e[n+1]=t>>>8,e}function s(t,e){return void 0===e&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function a(t,e){return void 0===e&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}function l(t,e){return void 0===e&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function c(t,e){return void 0===e&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}function u(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),e[n+0]=t>>>24,e[n+1]=t>>>16,e[n+2]=t>>>8,e[n+3]=t>>>0,e}function h(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),e[n+0]=t>>>0,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24,e}function d(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),u(t/4294967296>>>0,e,n),u(t>>>0,e,n+4),e}function p(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),h(t>>>0,e,n),h(t/4294967296>>>0,e,n+4),e}e.readInt16BE=function(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16},e.readUint16BE=function(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])>>>0},e.readInt16LE=function(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])<<16>>16},e.readUint16LE=function(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])>>>0},e.writeUint16BE=i,e.writeInt16BE=i,e.writeUint16LE=o,e.writeInt16LE=o,e.readInt32BE=s,e.readUint32BE=a,e.readInt32LE=l,e.readUint32LE=c,e.writeUint32BE=u,e.writeInt32BE=u,e.writeUint32LE=h,e.writeInt32LE=h,e.readInt64BE=function(t,e){void 0===e&&(e=0);var n=s(t,e),r=s(t,e+4);return 4294967296*n+r-4294967296*(r>>31)},e.readUint64BE=function(t,e){return void 0===e&&(e=0),4294967296*a(t,e)+a(t,e+4)},e.readInt64LE=function(t,e){void 0===e&&(e=0);var n=l(t,e);return 4294967296*l(t,e+4)+n-4294967296*(n>>31)},e.readUint64LE=function(t,e){void 0===e&&(e=0);var n=c(t,e);return 4294967296*c(t,e+4)+n},e.writeUint64BE=d,e.writeInt64BE=d,e.writeUint64LE=p,e.writeInt64LE=p,e.readUintBE=function(t,e,n){if(void 0===n&&(n=0),t%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,i=1,o=t/8+n-1;o>=n;o--)r+=e[o]*i,i*=256;return r},e.readUintLE=function(t,e,n){if(void 0===n&&(n=0),t%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,i=1,o=n;o<n+t/8;o++)r+=e[o]*i,i*=256;return r},e.writeUintBE=function(t,e,n,i){if(void 0===n&&(n=new Uint8Array(t/8)),void 0===i&&(i=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!r.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,s=t/8+i-1;s>=i;s--)n[s]=e/o&255,o*=256;return n},e.writeUintLE=function(t,e,n,i){if(void 0===n&&(n=new Uint8Array(t/8)),void 0===i&&(i=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!r.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,s=i;s<i+t/8;s++)n[s]=e/o&255,o*=256;return n},e.readFloat32BE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e)},e.readFloat32LE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e,!0)},e.readFloat64BE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e)},e.readFloat64LE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e,!0)},e.writeFloat32BE=function(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t),e},e.writeFloat32LE=function(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),e},e.writeFloat64BE=function(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t),e},e.writeFloat64LE=function(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),e}},1322:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8099),i=n(7309);e.BLOCK_SIZE=128,e.DIGEST_LENGTH=64,e.KEY_LENGTH=64,e.PERSONALIZATION_LENGTH=16,e.SALT_LENGTH=16,e.MAX_LEAF_SIZE=Math.pow(2,32)-1,e.MAX_FANOUT=255,e.MAX_MAX_DEPTH=255;var o=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),s=[[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30],[28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6],[22,16,24,0,10,4,30,26,20,28,6,12,14,2,18,8],[14,18,6,2,26,24,22,28,4,12,10,20,8,0,30,16],[18,0,10,14,4,8,20,30,28,2,22,24,12,16,6,26],[4,24,12,20,0,22,16,6,8,26,14,10,30,28,2,18],[24,10,2,30,28,26,8,20,0,14,12,6,18,4,16,22],[26,22,14,28,24,2,6,18,10,0,30,8,16,12,4,20],[12,30,28,18,22,6,0,16,24,4,26,14,2,8,20,10],[20,4,16,8,14,12,2,10,30,22,18,28,6,24,26,0],[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30],[28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6]],a=function(){function t(t,n){if(void 0===t&&(t=64),this.digestLength=t,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(o),this._buffer=new Uint8Array(e.BLOCK_SIZE),this._bufferLength=0,this._ctr=new Uint32Array(4),this._flag=new Uint32Array(4),this._lastNode=!1,this._finished=!1,this._vtmp=new Uint32Array(32),this._mtmp=new Uint32Array(32),t<1||t>e.DIGEST_LENGTH)throw new Error("blake2b: wrong digest length");n&&this.validateConfig(n);var i=0;n&&n.key&&(i=n.key.length);var s=1,a=1;n&&n.tree&&(s=n.tree.fanout,a=n.tree.maxDepth),this._state[0]^=t|i<<8|s<<16|a<<24,n&&n.tree&&(this._state[1]^=n.tree.leafSize,this._state[2]^=n.tree.nodeOffsetLowBits,this._state[3]^=n.tree.nodeOffsetHighBits,this._state[4]^=n.tree.nodeDepth|n.tree.innerDigestLength<<8,this._lastNode=n.tree.lastNode),n&&n.salt&&(this._state[8]^=r.readUint32LE(n.salt,0),this._state[9]^=r.readUint32LE(n.salt,4),this._state[10]^=r.readUint32LE(n.salt,8),this._state[11]^=r.readUint32LE(n.salt,12)),n&&n.personalization&&(this._state[12]^=r.readUint32LE(n.personalization,0),this._state[13]^=r.readUint32LE(n.personalization,4),this._state[14]^=r.readUint32LE(n.personalization,8),this._state[15]^=r.readUint32LE(n.personalization,12)),this._initialState=new Uint32Array(this._state),n&&n.key&&i>0&&(this._paddedKey=new Uint8Array(e.BLOCK_SIZE),this._paddedKey.set(n.key),this._buffer.set(this._paddedKey),this._bufferLength=e.BLOCK_SIZE)}return t.prototype.reset=function(){return this._state.set(this._initialState),this._paddedKey?(this._buffer.set(this._paddedKey),this._bufferLength=e.BLOCK_SIZE):this._bufferLength=0,i.wipe(this._ctr),i.wipe(this._flag),this._finished=!1,this},t.prototype.validateConfig=function(t){if(t.key&&t.key.length>e.KEY_LENGTH)throw new Error("blake2b: wrong key length");if(t.salt&&t.salt.length!==e.SALT_LENGTH)throw new Error("blake2b: wrong salt length");if(t.personalization&&t.personalization.length!==e.PERSONALIZATION_LENGTH)throw new Error("blake2b: wrong personalization length");if(t.tree){if(t.tree.fanout<0||t.tree.fanout>e.MAX_FANOUT)throw new Error("blake2b: wrong tree fanout");if(t.tree.maxDepth<0||t.tree.maxDepth>e.MAX_MAX_DEPTH)throw new Error("blake2b: wrong tree depth");if(t.tree.leafSize<0||t.tree.leafSize>e.MAX_LEAF_SIZE)throw new Error("blake2b: wrong leaf size");if(t.tree.innerDigestLength<0||t.tree.innerDigestLength>e.DIGEST_LENGTH)throw new Error("blake2b: wrong tree inner digest length")}},t.prototype.update=function(t,n){if(void 0===n&&(n=t.length),this._finished)throw new Error("blake2b: can't update because hash was finished.");var r=e.BLOCK_SIZE-this._bufferLength,i=0;if(0===n)return this;if(n>r){for(var o=0;o<r;o++)this._buffer[this._bufferLength+o]=t[i+o];this._processBlock(e.BLOCK_SIZE),i+=r,n-=r,this._bufferLength=0}for(;n>e.BLOCK_SIZE;){for(o=0;o<e.BLOCK_SIZE;o++)this._buffer[o]=t[i+o];this._processBlock(e.BLOCK_SIZE),i+=e.BLOCK_SIZE,n-=e.BLOCK_SIZE,this._bufferLength=0}for(o=0;o<n;o++)this._buffer[this._bufferLength+o]=t[i+o];return this._bufferLength+=n,this},t.prototype.finish=function(t){if(!this._finished){for(var n=this._bufferLength;n<e.BLOCK_SIZE;n++)this._buffer[n]=0;this._flag[0]=4294967295,this._flag[1]=4294967295,this._lastNode&&(this._flag[2]=4294967295,this._flag[3]=4294967295),this._processBlock(this._bufferLength),this._finished=!0}var i=this._buffer.subarray(0,64);for(n=0;n<16;n++)r.writeUint32LE(this._state[n],i,4*n);return t.set(i.subarray(0,t.length)),this},t.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},t.prototype.clean=function(){i.wipe(this._vtmp),i.wipe(this._mtmp),i.wipe(this._state),i.wipe(this._buffer),i.wipe(this._initialState),this._paddedKey&&i.wipe(this._paddedKey),this._bufferLength=0,i.wipe(this._ctr),i.wipe(this._flag),this._lastNode=!1,this._finished=!1},t.prototype.saveState=function(){if(this._finished)throw new Error("blake2b: cannot save finished state");return{state:new Uint32Array(this._state),buffer:new Uint8Array(this._buffer),bufferLength:this._bufferLength,ctr:new Uint32Array(this._ctr),flag:new Uint32Array(this._flag),lastNode:this._lastNode,paddedKey:this._paddedKey?new Uint8Array(this._paddedKey):void 0,initialState:new Uint32Array(this._initialState)}},t.prototype.restoreState=function(t){return this._state.set(t.state),this._buffer.set(t.buffer),this._bufferLength=t.bufferLength,this._ctr.set(t.ctr),this._flag.set(t.flag),this._lastNode=t.lastNode,this._paddedKey&&i.wipe(this._paddedKey),this._paddedKey=t.paddedKey?new Uint8Array(t.paddedKey):void 0,this._initialState.set(t.initialState),this},t.prototype.cleanSavedState=function(t){i.wipe(t.state),i.wipe(t.buffer),i.wipe(t.initialState),t.paddedKey&&i.wipe(t.paddedKey),t.bufferLength=0,i.wipe(t.ctr),i.wipe(t.flag),t.lastNode=!1},t.prototype._G=function(t,e,n,r,i,o,s,a,l,c,u,h,d){var p=t[e],f=t[o],m=t[n],g=t[s],y=t[r],v=t[a],_=t[i],w=t[l],b=65535&p,x=p>>>16,E=65535&f,S=f>>>16;x+=m>>>16,E+=65535&g,S+=g>>>16,E+=(x+=(b+=65535&m)>>>16)>>>16,b=65535&(p=65535&b|x<<16),x=p>>>16,E=65535&(f=65535&E|(S+=E>>>16)<<16),S=f>>>16,x+=c>>>16,E+=65535&u,S+=u>>>16,p=65535&(b+=65535&c)|(x+=b>>>16)<<16,b=w^=f=65535&(E+=x>>>16)|(S+=E>>>16)<<16,w=_^=p,_=b,b=65535&y,x=y>>>16,E=65535&v,S=v>>>16,x+=_>>>16,E+=65535&w,S+=w>>>16,b=(m^=y=65535&(b+=65535&_)|(x+=b>>>16)<<16)<<8|(g^=v=65535&(E+=x>>>16)|(S+=E>>>16)<<16)>>>24,m=g<<8|m>>>24,g=b,b=65535&p,x=p>>>16,E=65535&f,S=f>>>16,x+=m>>>16,E+=65535&g,S+=g>>>16,E+=(x+=(b+=65535&m)>>>16)>>>16,b=65535&(p=65535&b|x<<16),x=p>>>16,E=65535&(f=65535&E|(S+=E>>>16)<<16),S=f>>>16,x+=h>>>16,E+=65535&d,S+=d>>>16,b=(_^=p=65535&(b+=65535&h)|(x+=b>>>16)<<16)<<16|(w^=f=65535&(E+=x>>>16)|(S+=E>>>16)<<16)>>>16,_=w<<16|_>>>16,w=b,b=65535&y,x=y>>>16,E=65535&v,S=v>>>16,x+=_>>>16,E+=65535&w,S+=w>>>16,b=(g^=v=65535&(E+=(x+=(b+=65535&_)>>>16)>>>16)|(S+=E>>>16)<<16)<<1|(m^=y=65535&b|x<<16)>>>31,m=m<<1|g>>>31,g=b,t[e]=p,t[o]=f,t[n]=m,t[s]=g,t[r]=y,t[a]=v,t[i]=_,t[l]=w},t.prototype._incrementCounter=function(t){for(var e=0;e<3;e++){var n=this._ctr[e]+t;if(this._ctr[e]=n>>>0,this._ctr[e]===n)return;t=1}},t.prototype._processBlock=function(t){this._incrementCounter(t);var e=this._vtmp;e.set(this._state),e.set(o,16),e[24]^=this._ctr[0],e[25]^=this._ctr[1],e[26]^=this._ctr[2],e[27]^=this._ctr[3],e[28]^=this._flag[0],e[29]^=this._flag[1],e[30]^=this._flag[2],e[31]^=this._flag[3];for(var n=this._mtmp,i=0;i<32;i++)n[i]=r.readUint32LE(this._buffer,4*i);for(var a=0;a<12;a++)this._G(e,0,8,16,24,1,9,17,25,n[s[a][0]],n[s[a][0]+1],n[s[a][1]],n[s[a][1]+1]),this._G(e,2,10,18,26,3,11,19,27,n[s[a][2]],n[s[a][2]+1],n[s[a][3]],n[s[a][3]+1]),this._G(e,4,12,20,28,5,13,21,29,n[s[a][4]],n[s[a][4]+1],n[s[a][5]],n[s[a][5]+1]),this._G(e,6,14,22,30,7,15,23,31,n[s[a][6]],n[s[a][6]+1],n[s[a][7]],n[s[a][7]+1]),this._G(e,0,10,20,30,1,11,21,31,n[s[a][8]],n[s[a][8]+1],n[s[a][9]],n[s[a][9]+1]),this._G(e,2,12,22,24,3,13,23,25,n[s[a][10]],n[s[a][10]+1],n[s[a][11]],n[s[a][11]+1]),this._G(e,4,14,16,26,5,15,17,27,n[s[a][12]],n[s[a][12]+1],n[s[a][13]],n[s[a][13]+1]),this._G(e,6,8,18,28,7,9,19,29,n[s[a][14]],n[s[a][14]+1],n[s[a][15]],n[s[a][15]+1]);for(i=0;i<16;i++)this._state[i]^=e[i]^e[i+16]},t}();e.BLAKE2b=a,e.hash=function(t,n,r){void 0===n&&(n=e.DIGEST_LENGTH);var i=new a(n,r);i.update(t);var o=i.digest();return i.clean(),o}},3683:(t,e)=>{"use strict";e.z=function(){for(var t=0,e=0;e<arguments.length;e++)t+=arguments[e].length;var n=new Uint8Array(t),r=0;for(e=0;e<arguments.length;e++){var i=arguments[e];n.set(i,r),r+=i.length}return n}},4153:(t,e)=>{"use strict";function n(t,e){if(t.length!==e.length)return 0;for(var n=0,r=0;r<t.length;r++)n|=t[r]^e[r];return 1&n-1>>>8}Object.defineProperty(e,"__esModule",{value:!0}),e.select=function(t,e,n){return~(t-1)&e|t-1&n},e.lessOrEqual=function(t,e){return(0|t)-(0|e)-1>>>31&1},e.compare=n,e.equal=function(t,e){return 0!==t.length&&0!==e.length&&0!==n(t,e)}},1050:(t,e,n)=>{"use strict";e.zh=e.SH=e.Xx=e._w=e.aP=e.KS=e.jQ=void 0;n(1416);const r=n(3350),i=n(7309);function o(t){const e=new Float64Array(16);if(t)for(let n=0;n<t.length;n++)e[n]=t[n];return e}e.jQ=64,e.KS=64,e.aP=32,new Uint8Array(32)[0]=9;const s=o(),a=o([1]),l=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(t,e){for(let n=0;n<16;n++)t[n]=0|e[n]}function f(t){let e=1;for(let n=0;n<16;n++){let r=t[n]+e+65535;e=Math.floor(r/65536),t[n]=r-65536*e}t[0]+=e-1+37*(e-1)}function m(t,e,n){const r=~(n-1);for(let n=0;n<16;n++){const i=r&(t[n]^e[n]);t[n]^=i,e[n]^=i}}function g(t,e){const n=o(),r=o();for(let t=0;t<16;t++)r[t]=e[t];f(r),f(r),f(r);for(let t=0;t<2;t++){n[0]=r[0]-65517;for(let t=1;t<15;t++)n[t]=r[t]-65535-(n[t-1]>>16&1),n[t-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const t=n[15]>>16&1;n[14]&=65535,m(r,n,1-t)}for(let e=0;e<16;e++)t[2*e]=255&r[e],t[2*e+1]=r[e]>>8}function y(t,e){const n=new Uint8Array(32),r=new Uint8Array(32);return g(n,t),g(r,e),function(t,e){let n=0;for(let r=0;r<32;r++)n|=t[r]^e[r];return(1&n-1>>>8)-1}(n,r)}function v(t){const e=new Uint8Array(32);return g(e,t),1&e[0]}function _(t,e,n){for(let r=0;r<16;r++)t[r]=e[r]+n[r]}function w(t,e,n){for(let r=0;r<16;r++)t[r]=e[r]-n[r]}function b(t,e,n){let r,i,o=0,s=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=0,w=0,b=0,x=0,E=0,S=0,M=0,T=0,A=0,R=0,L=0,C=0,P=0,I=0,O=0,N=0,k=0,D=n[0],B=n[1],U=n[2],z=n[3],F=n[4],H=n[5],G=n[6],V=n[7],j=n[8],W=n[9],q=n[10],K=n[11],X=n[12],Y=n[13],J=n[14],Z=n[15];r=e[0],o+=r*D,s+=r*B,a+=r*U,l+=r*z,c+=r*F,u+=r*H,h+=r*G,d+=r*V,p+=r*j,f+=r*W,m+=r*q,g+=r*K,y+=r*X,v+=r*Y,_+=r*J,w+=r*Z,r=e[1],s+=r*D,a+=r*B,l+=r*U,c+=r*z,u+=r*F,h+=r*H,d+=r*G,p+=r*V,f+=r*j,m+=r*W,g+=r*q,y+=r*K,v+=r*X,_+=r*Y,w+=r*J,b+=r*Z,r=e[2],a+=r*D,l+=r*B,c+=r*U,u+=r*z,h+=r*F,d+=r*H,p+=r*G,f+=r*V,m+=r*j,g+=r*W,y+=r*q,v+=r*K,_+=r*X,w+=r*Y,b+=r*J,x+=r*Z,r=e[3],l+=r*D,c+=r*B,u+=r*U,h+=r*z,d+=r*F,p+=r*H,f+=r*G,m+=r*V,g+=r*j,y+=r*W,v+=r*q,_+=r*K,w+=r*X,b+=r*Y,x+=r*J,E+=r*Z,r=e[4],c+=r*D,u+=r*B,h+=r*U,d+=r*z,p+=r*F,f+=r*H,m+=r*G,g+=r*V,y+=r*j,v+=r*W,_+=r*q,w+=r*K,b+=r*X,x+=r*Y,E+=r*J,S+=r*Z,r=e[5],u+=r*D,h+=r*B,d+=r*U,p+=r*z,f+=r*F,m+=r*H,g+=r*G,y+=r*V,v+=r*j,_+=r*W,w+=r*q,b+=r*K,x+=r*X,E+=r*Y,S+=r*J,M+=r*Z,r=e[6],h+=r*D,d+=r*B,p+=r*U,f+=r*z,m+=r*F,g+=r*H,y+=r*G,v+=r*V,_+=r*j,w+=r*W,b+=r*q,x+=r*K,E+=r*X,S+=r*Y,M+=r*J,T+=r*Z,r=e[7],d+=r*D,p+=r*B,f+=r*U,m+=r*z,g+=r*F,y+=r*H,v+=r*G,_+=r*V,w+=r*j,b+=r*W,x+=r*q,E+=r*K,S+=r*X,M+=r*Y,T+=r*J,A+=r*Z,r=e[8],p+=r*D,f+=r*B,m+=r*U,g+=r*z,y+=r*F,v+=r*H,_+=r*G,w+=r*V,b+=r*j,x+=r*W,E+=r*q,S+=r*K,M+=r*X,T+=r*Y,A+=r*J,R+=r*Z,r=e[9],f+=r*D,m+=r*B,g+=r*U,y+=r*z,v+=r*F,_+=r*H,w+=r*G,b+=r*V,x+=r*j,E+=r*W,S+=r*q,M+=r*K,T+=r*X,A+=r*Y,R+=r*J,L+=r*Z,r=e[10],m+=r*D,g+=r*B,y+=r*U,v+=r*z,_+=r*F,w+=r*H,b+=r*G,x+=r*V,E+=r*j,S+=r*W,M+=r*q,T+=r*K,A+=r*X,R+=r*Y,L+=r*J,C+=r*Z,r=e[11],g+=r*D,y+=r*B,v+=r*U,_+=r*z,w+=r*F,b+=r*H,x+=r*G,E+=r*V,S+=r*j,M+=r*W,T+=r*q,A+=r*K,R+=r*X,L+=r*Y,C+=r*J,P+=r*Z,r=e[12],y+=r*D,v+=r*B,_+=r*U,w+=r*z,b+=r*F,x+=r*H,E+=r*G,S+=r*V,M+=r*j,T+=r*W,A+=r*q,R+=r*K,L+=r*X,C+=r*Y,P+=r*J,I+=r*Z,r=e[13],v+=r*D,_+=r*B,w+=r*U,b+=r*z,x+=r*F,E+=r*H,S+=r*G,M+=r*V,T+=r*j,A+=r*W,R+=r*q,L+=r*K,C+=r*X,P+=r*Y,I+=r*J,O+=r*Z,r=e[14],_+=r*D,w+=r*B,b+=r*U,x+=r*z,E+=r*F,S+=r*H,M+=r*G,T+=r*V,A+=r*j,R+=r*W,L+=r*q,C+=r*K,P+=r*X,I+=r*Y,O+=r*J,N+=r*Z,r=e[15],w+=r*D,b+=r*B,x+=r*U,E+=r*z,S+=r*F,M+=r*H,T+=r*G,A+=r*V,R+=r*j,L+=r*W,C+=r*q,P+=r*K,I+=r*X,O+=r*Y,N+=r*J,k+=r*Z,o+=38*b,s+=38*x,a+=38*E,l+=38*S,c+=38*M,u+=38*T,h+=38*A,d+=38*R,p+=38*L,f+=38*C,m+=38*P,g+=38*I,y+=38*O,v+=38*N,_+=38*k,i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),t[0]=o,t[1]=s,t[2]=a,t[3]=l,t[4]=c,t[5]=u,t[6]=h,t[7]=d,t[8]=p,t[9]=f,t[10]=m,t[11]=g,t[12]=y,t[13]=v,t[14]=_,t[15]=w}function x(t,e){b(t,e,e)}function E(t,e){const n=o();let r;for(r=0;r<16;r++)n[r]=e[r];for(r=253;r>=0;r--)x(n,n),2!==r&&4!==r&&b(n,n,e);for(r=0;r<16;r++)t[r]=n[r]}function S(t,e){const n=o(),r=o(),i=o(),s=o(),a=o(),l=o(),u=o(),h=o(),d=o();w(n,t[1],t[0]),w(d,e[1],e[0]),b(n,n,d),_(r,t[0],t[1]),_(d,e[0],e[1]),b(r,r,d),b(i,t[3],e[3]),b(i,i,c),b(s,t[2],e[2]),_(s,s,s),w(a,r,n),w(l,s,i),_(u,s,i),_(h,r,n),b(t[0],a,l),b(t[1],h,u),b(t[2],u,l),b(t[3],a,h)}function M(t,e,n){for(let r=0;r<4;r++)m(t[r],e[r],n)}function T(t,e){const n=o(),r=o(),i=o();E(i,e[2]),b(n,e[0],i),b(r,e[1],i),g(t,r),t[31]^=v(n)<<7}function A(t,e){const n=[o(),o(),o(),o()];p(n[0],u),p(n[1],h),p(n[2],a),b(n[3],u,h),function(t,e,n){p(t[0],s),p(t[1],a),p(t[2],a),p(t[3],s);for(let r=255;r>=0;--r){const i=n[r/8|0]>>(7&r)&1;M(t,e,i),S(e,t),S(t,t),M(t,e,i)}}(t,n,e)}e._w=function(t){if(t.length!==e.aP)throw new Error(`ed25519: seed must be ${e.aP} bytes`);const n=(0,r.hash)(t);n[0]&=248,n[31]&=127,n[31]|=64;const i=new Uint8Array(32),s=[o(),o(),o(),o()];A(s,n),T(i,s);const a=new Uint8Array(64);return a.set(t),a.set(i,32),{publicKey:i,secretKey:a}};const R=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function L(t,e){let n,r,i,o;for(r=63;r>=32;--r){for(n=0,i=r-32,o=r-12;i<o;++i)e[i]+=n-16*e[r]*R[i-(r-32)],n=Math.floor((e[i]+128)/256),e[i]-=256*n;e[i]+=n,e[r]=0}for(n=0,i=0;i<32;i++)e[i]+=n-(e[31]>>4)*R[i],n=e[i]>>8,e[i]&=255;for(i=0;i<32;i++)e[i]-=n*R[i];for(r=0;r<32;r++)e[r+1]+=e[r]>>8,t[r]=255&e[r]}function C(t){const e=new Float64Array(64);for(let n=0;n<64;n++)e[n]=t[n];for(let e=0;e<64;e++)t[e]=0;L(t,e)}e.Xx=function(t,e){const n=new Float64Array(64),i=[o(),o(),o(),o()],s=(0,r.hash)(t.subarray(0,32));s[0]&=248,s[31]&=127,s[31]|=64;const a=new Uint8Array(64);a.set(s.subarray(32),32);const l=new r.SHA512;l.update(a.subarray(32)),l.update(e);const c=l.digest();l.clean(),C(c),A(i,c),T(a,i),l.reset(),l.update(a.subarray(0,32)),l.update(t.subarray(32)),l.update(e);const u=l.digest();C(u);for(let t=0;t<32;t++)n[t]=c[t];for(let t=0;t<32;t++)for(let e=0;e<32;e++)n[t+e]+=u[t]*s[e];return L(a.subarray(32),n),a},e.SH=function(t){let e=[o(),o(),o(),o()];if(function(t,e){const n=o(),r=o(),i=o(),c=o(),u=o(),h=o(),f=o();return p(t[2],a),function(t,e){for(let n=0;n<16;n++)t[n]=e[2*n]+(e[2*n+1]<<8);t[15]&=32767}(t[1],e),x(i,t[1]),b(c,i,l),w(i,i,t[2]),_(c,t[2],c),x(u,c),x(h,u),b(f,h,u),b(n,f,i),b(n,n,c),function(t,e){const n=o();let r;for(r=0;r<16;r++)n[r]=e[r];for(r=250;r>=0;r--)x(n,n),1!==r&&b(n,n,e);for(r=0;r<16;r++)t[r]=n[r]}(n,n),b(n,n,i),b(n,n,c),b(n,n,c),b(t[0],n,c),x(r,t[0]),b(r,r,c),y(r,i)&&b(t[0],t[0],d),x(r,t[0]),b(r,r,c),y(r,i)?-1:(v(t[0])===e[31]>>7&&w(t[0],s,t[0]),b(t[3],t[0],t[1]),0)}(e,t))throw new Error("Ed25519: invalid public key");let n=o(),r=o(),i=e[1];_(n,a,i),w(r,a,i),E(r,r),b(n,n,r);let c=new Uint8Array(32);return g(c,n),c},e.zh=function(t){const e=(0,r.hash)(t.subarray(0,32));e[0]&=248,e[31]&=127,e[31]|=64;const n=new Uint8Array(e.subarray(0,32));return(0,i.wipe)(e),n}},7117:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mul=Math.imul||function(t,e){var n=65535&t,r=65535&e;return n*r+((t>>>16&65535)*r+n*(e>>>16&65535)<<16>>>0)|0},e.add=function(t,e){return t+e|0},e.sub=function(t,e){return t-e|0},e.rotl=function(t,e){return t<<e|t>>>32-e},e.rotr=function(t,e){return t<<32-e|t>>>e},e.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(t){return e.isInteger(t)&&t>=-e.MAX_SAFE_INTEGER&&t<=e.MAX_SAFE_INTEGER}},19:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.openBox=e.box=e.precomputeSharedKey=e.generateKeyPair=void 0;const r=n(7664),i=n(7025),o=n(7801),s=n(7309);var a=n(7664);Object.defineProperty(e,"generateKeyPair",{enumerable:!0,get:function(){return a.generateKeyPair}});const l=new Uint8Array(16);function c(t,e){const n=(0,r.scalarMult)(e,t);return(0,i.hsalsa)(n,l,n),n}e.precomputeSharedKey=c,e.box=function(t,e,n,r){const i=c(t,e),a=(0,o.secretBox)(i,n,r);return(0,s.wipe)(i),a},e.openBox=function(t,e,n,r){const i=c(t,e),a=(0,o.openSecretBox)(i,n,r);return(0,s.wipe)(i),a}},450:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(19),e),i(n(7801),e)},7801:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.generateKey=e.openSecretBox=e.secretBox=void 0;const r=n(7025),i=n(3027),o=n(7309),s=n(1416);e.secretBox=function(t,e,n){if(24!==e.length)throw new Error("secretBox nonce must be 24 bytes");const s=new Uint8Array(64),a=new Uint8Array(32);a.set(e),(0,r.stream)(t,a,s,8);const l=new Uint8Array(16+n.length);for(let t=0;t<32&&t<n.length;t++)l[16+t]=n[t]^s[32+t];n.length>32&&(0,r.streamXOR)(t,a,n.subarray(32),l.subarray(48),8);const c=(0,i.oneTimeAuth)(s.subarray(0,32),l.subarray(16));for(let t=0;t<c.length;t++)l[t]=c[t];return(0,o.wipe)(c),(0,o.wipe)(s),(0,o.wipe)(a),l},e.openSecretBox=function(t,e,n){if(24!==e.length)throw new Error("secretBox nonce must be 24 bytes");if(n.length<16)throw new Error("secretBox data must be at least 16 bytes");const s=new Uint8Array(64),a=new Uint8Array(32);a.set(e),(0,r.stream)(t,a,s,8);const l=(0,i.oneTimeAuth)(s.subarray(0,32),n.subarray(16));if(!(0,i.equal)(l,n.subarray(0,16)))return null;const c=n.subarray(16),u=new Uint8Array(c.length);for(let t=0;t<32&&t<c.length;t++)u[t]=c[t]^s[32+t];return c.length>32&&(0,r.streamXOR)(t,a,c.subarray(32),u.subarray(32),8),(0,o.wipe)(l),(0,o.wipe)(s),(0,o.wipe)(a),u},e.generateKey=function(t){return(0,s.randomBytes)(32,t)}},3027:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4153),i=n(7309);e.DIGEST_LENGTH=16;var o=function(){function t(t){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var n=t[0]|t[1]<<8;this._r[0]=8191&n;var r=t[2]|t[3]<<8;this._r[1]=8191&(n>>>13|r<<3);var i=t[4]|t[5]<<8;this._r[2]=7939&(r>>>10|i<<6);var o=t[6]|t[7]<<8;this._r[3]=8191&(i>>>7|o<<9);var s=t[8]|t[9]<<8;this._r[4]=255&(o>>>4|s<<12),this._r[5]=s>>>1&8190;var a=t[10]|t[11]<<8;this._r[6]=8191&(s>>>14|a<<2);var l=t[12]|t[13]<<8;this._r[7]=8065&(a>>>11|l<<5);var c=t[14]|t[15]<<8;this._r[8]=8191&(l>>>8|c<<8),this._r[9]=c>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return t.prototype._blocks=function(t,e,n){for(var r=this._fin?0:2048,i=this._h[0],o=this._h[1],s=this._h[2],a=this._h[3],l=this._h[4],c=this._h[5],u=this._h[6],h=this._h[7],d=this._h[8],p=this._h[9],f=this._r[0],m=this._r[1],g=this._r[2],y=this._r[3],v=this._r[4],_=this._r[5],w=this._r[6],b=this._r[7],x=this._r[8],E=this._r[9];n>=16;){var S=t[e+0]|t[e+1]<<8;i+=8191&S;var M=t[e+2]|t[e+3]<<8;o+=8191&(S>>>13|M<<3);var T=t[e+4]|t[e+5]<<8;s+=8191&(M>>>10|T<<6);var A=t[e+6]|t[e+7]<<8;a+=8191&(T>>>7|A<<9);var R=t[e+8]|t[e+9]<<8;l+=8191&(A>>>4|R<<12),c+=R>>>1&8191;var L=t[e+10]|t[e+11]<<8;u+=8191&(R>>>14|L<<2);var C=t[e+12]|t[e+13]<<8;h+=8191&(L>>>11|C<<5);var P=t[e+14]|t[e+15]<<8,I=0,O=I;O+=i*f,O+=o*(5*E),O+=s*(5*x),O+=a*(5*b),I=(O+=l*(5*w))>>>13,O&=8191,O+=c*(5*_),O+=u*(5*v),O+=h*(5*y),O+=(d+=8191&(C>>>8|P<<8))*(5*g);var N=I+=(O+=(p+=P>>>5|r)*(5*m))>>>13;N+=i*m,N+=o*f,N+=s*(5*E),N+=a*(5*x),I=(N+=l*(5*b))>>>13,N&=8191,N+=c*(5*w),N+=u*(5*_),N+=h*(5*v),N+=d*(5*y),I+=(N+=p*(5*g))>>>13,N&=8191;var k=I;k+=i*g,k+=o*m,k+=s*f,k+=a*(5*E),I=(k+=l*(5*x))>>>13,k&=8191,k+=c*(5*b),k+=u*(5*w),k+=h*(5*_),k+=d*(5*v);var D=I+=(k+=p*(5*y))>>>13;D+=i*y,D+=o*g,D+=s*m,D+=a*f,I=(D+=l*(5*E))>>>13,D&=8191,D+=c*(5*x),D+=u*(5*b),D+=h*(5*w),D+=d*(5*_);var B=I+=(D+=p*(5*v))>>>13;B+=i*v,B+=o*y,B+=s*g,B+=a*m,I=(B+=l*f)>>>13,B&=8191,B+=c*(5*E),B+=u*(5*x),B+=h*(5*b),B+=d*(5*w);var U=I+=(B+=p*(5*_))>>>13;U+=i*_,U+=o*v,U+=s*y,U+=a*g,I=(U+=l*m)>>>13,U&=8191,U+=c*f,U+=u*(5*E),U+=h*(5*x),U+=d*(5*b);var z=I+=(U+=p*(5*w))>>>13;z+=i*w,z+=o*_,z+=s*v,z+=a*y,I=(z+=l*g)>>>13,z&=8191,z+=c*m,z+=u*f,z+=h*(5*E),z+=d*(5*x);var F=I+=(z+=p*(5*b))>>>13;F+=i*b,F+=o*w,F+=s*_,F+=a*v,I=(F+=l*y)>>>13,F&=8191,F+=c*g,F+=u*m,F+=h*f,F+=d*(5*E);var H=I+=(F+=p*(5*x))>>>13;H+=i*x,H+=o*b,H+=s*w,H+=a*_,I=(H+=l*v)>>>13,H&=8191,H+=c*y,H+=u*g,H+=h*m,H+=d*f;var G=I+=(H+=p*(5*E))>>>13;G+=i*E,G+=o*x,G+=s*b,G+=a*w,I=(G+=l*_)>>>13,G&=8191,G+=c*v,G+=u*y,G+=h*g,G+=d*m,i=O=8191&(I=(I=((I+=(G+=p*f)>>>13)<<2)+I|0)+(O&=8191)|0),o=N+=I>>>=13,s=k&=8191,a=D&=8191,l=B&=8191,c=U&=8191,u=z&=8191,h=F&=8191,d=H&=8191,p=G&=8191,e+=16,n-=16}this._h[0]=i,this._h[1]=o,this._h[2]=s,this._h[3]=a,this._h[4]=l,this._h[5]=c,this._h[6]=u,this._h[7]=h,this._h[8]=d,this._h[9]=p},t.prototype.finish=function(t,e){void 0===e&&(e=0);var n,r,i,o,s=new Uint16Array(10);if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=n,n=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=5*n,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,s[0]=this._h[0]+5,n=s[0]>>>13,s[0]&=8191,o=1;o<10;o++)s[o]=this._h[o]+n,n=s[o]>>>13,s[o]&=8191;for(s[9]-=8192,r=(1^n)-1,o=0;o<10;o++)s[o]&=r;for(r=~r,o=0;o<10;o++)this._h[o]=this._h[o]&r|s[o];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),i=this._h[0]+this._pad[0],this._h[0]=65535&i,o=1;o<8;o++)i=(this._h[o]+this._pad[o]|0)+(i>>>16)|0,this._h[o]=65535&i;return t[e+0]=this._h[0]>>>0,t[e+1]=this._h[0]>>>8,t[e+2]=this._h[1]>>>0,t[e+3]=this._h[1]>>>8,t[e+4]=this._h[2]>>>0,t[e+5]=this._h[2]>>>8,t[e+6]=this._h[3]>>>0,t[e+7]=this._h[3]>>>8,t[e+8]=this._h[4]>>>0,t[e+9]=this._h[4]>>>8,t[e+10]=this._h[5]>>>0,t[e+11]=this._h[5]>>>8,t[e+12]=this._h[6]>>>0,t[e+13]=this._h[6]>>>8,t[e+14]=this._h[7]>>>0,t[e+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(t){var e,n=0,r=t.length;if(this._leftover){(e=16-this._leftover)>r&&(e=r);for(var i=0;i<e;i++)this._buffer[this._leftover+i]=t[n+i];if(r-=e,n+=e,this._leftover+=e,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(r>=16&&(e=r-r%16,this._blocks(t,n,e),n+=e,r-=e),r){for(i=0;i<r;i++)this._buffer[this._leftover+i]=t[n+i];this._leftover+=r}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},t.prototype.clean=function(){return i.wipe(this._buffer),i.wipe(this._r),i.wipe(this._h),i.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();e.Poly1305=o,e.oneTimeAuth=function(t,e){var n=new o(t);n.update(e);var r=n.digest();return n.clean(),r},e.equal=function(t,n){return t.length===e.DIGEST_LENGTH&&n.length===e.DIGEST_LENGTH&&r.equal(t,n)}},1416:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const r=n(6008),i=n(8099),o=n(7309);function s(t,n=e.defaultRandomSource){return n.randomBytes(t)}e.defaultRandomSource=new r.SystemRandomSource,e.randomBytes=s,e.randomUint32=function(t=e.defaultRandomSource){const n=s(4,t),r=(0,i.readUint32LE)(n);return(0,o.wipe)(n),r};const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(t,n=a,r=e.defaultRandomSource){if(n.length<2)throw new Error("randomString charset is too short");if(n.length>256)throw new Error("randomString charset is too long");let i="";const l=n.length,c=256-256%l;for(;t>0;){const e=s(Math.ceil(256*t/c),r);for(let r=0;r<e.length&&t>0;r++){const o=e[r];o<c&&(i+=n.charAt(o%l),t--)}(0,o.wipe)(e)}return i}e.randomString=l,e.randomStringForEntropy=function(t,n=a,r=e.defaultRandomSource){return l(Math.ceil(t/(Math.log(n.length)/Math.LN2)),n,r)}},5455:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BrowserRandomSource=void 0,e.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t="undefined"!=typeof self?self.crypto||self.msCrypto:null;t&&void 0!==t.getRandomValues&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const e=new Uint8Array(t);for(let t=0;t<e.length;t+=65536)this._crypto.getRandomValues(e.subarray(t,t+Math.min(e.length-t,65536)));return e}}},8871:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NodeRandomSource=void 0;const r=n(7309);e.NodeRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const t=n(5883);t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let e=this._crypto.randomBytes(t);if(e.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let t=0;t<n.length;t++)n[t]=e[t];return(0,r.wipe)(e),n}}},6008:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SystemRandomSource=void 0;const r=n(5455),i=n(8871);e.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new r.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new i.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}},7318:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8099),i=n(7309);function o(t,e,n){for(var i,o=1634760805,s=n[3]<<24|n[2]<<16|n[1]<<8|n[0],a=n[7]<<24|n[6]<<16|n[5]<<8|n[4],l=n[11]<<24|n[10]<<16|n[9]<<8|n[8],c=n[15]<<24|n[14]<<16|n[13]<<8|n[12],u=857760878,h=e[3]<<24|e[2]<<16|e[1]<<8|e[0],d=e[7]<<24|e[6]<<16|e[5]<<8|e[4],p=e[11]<<24|e[10]<<16|e[9]<<8|e[8],f=e[15]<<24|e[14]<<16|e[13]<<8|e[12],m=2036477234,g=n[19]<<24|n[18]<<16|n[17]<<8|n[16],y=n[23]<<24|n[22]<<16|n[21]<<8|n[20],v=n[27]<<24|n[26]<<16|n[25]<<8|n[24],_=n[31]<<24|n[30]<<16|n[29]<<8|n[28],w=1797285236,b=o,x=s,E=a,S=l,M=c,T=u,A=h,R=d,L=p,C=f,P=m,I=g,O=y,N=v,k=_,D=w,B=0;B<20;B+=2)b^=(i=(O^=(i=(L^=(i=(M^=(i=b+O|0)<<7|i>>>25)+b|0)<<9|i>>>23)+M|0)<<13|i>>>19)+L|0)<<18|i>>>14,T^=(i=(x^=(i=(N^=(i=(C^=(i=T+x|0)<<7|i>>>25)+T|0)<<9|i>>>23)+C|0)<<13|i>>>19)+N|0)<<18|i>>>14,P^=(i=(A^=(i=(E^=(i=(k^=(i=P+A|0)<<7|i>>>25)+P|0)<<9|i>>>23)+k|0)<<13|i>>>19)+E|0)<<18|i>>>14,D^=(i=(I^=(i=(R^=(i=(S^=(i=D+I|0)<<7|i>>>25)+D|0)<<9|i>>>23)+S|0)<<13|i>>>19)+R|0)<<18|i>>>14,b^=(i=(S^=(i=(E^=(i=(x^=(i=b+S|0)<<7|i>>>25)+b|0)<<9|i>>>23)+x|0)<<13|i>>>19)+E|0)<<18|i>>>14,T^=(i=(M^=(i=(R^=(i=(A^=(i=T+M|0)<<7|i>>>25)+T|0)<<9|i>>>23)+A|0)<<13|i>>>19)+R|0)<<18|i>>>14,P^=(i=(C^=(i=(L^=(i=(I^=(i=P+C|0)<<7|i>>>25)+P|0)<<9|i>>>23)+I|0)<<13|i>>>19)+L|0)<<18|i>>>14,D^=(i=(k^=(i=(N^=(i=(O^=(i=D+k|0)<<7|i>>>25)+D|0)<<9|i>>>23)+O|0)<<13|i>>>19)+N|0)<<18|i>>>14;r.writeUint32LE(b+o|0,t,0),r.writeUint32LE(x+s|0,t,4),r.writeUint32LE(E+a|0,t,8),r.writeUint32LE(S+l|0,t,12),r.writeUint32LE(M+c|0,t,16),r.writeUint32LE(T+u|0,t,20),r.writeUint32LE(A+h|0,t,24),r.writeUint32LE(R+d|0,t,28),r.writeUint32LE(L+p|0,t,32),r.writeUint32LE(C+f|0,t,36),r.writeUint32LE(P+m|0,t,40),r.writeUint32LE(I+g|0,t,44),r.writeUint32LE(O+y|0,t,48),r.writeUint32LE(N+v|0,t,52),r.writeUint32LE(k+_|0,t,56),r.writeUint32LE(D+w|0,t,60)}function s(t,e,n,r,s){if(void 0===s&&(s=0),32!==t.length)throw new Error("Salsa20: key size must be 32 bytes");if(r.length<n.length)throw new Error("Salsa20: destination is shorter than source");var l,c;if(0===s){if(8!==e.length)throw new Error("Salsa20 nonce must be 8 bytes");(l=new Uint8Array(16)).set(e),c=e.length}else{if(16!==e.length)throw new Error("Salsa20 nonce with counter must be 16 bytes");l=e,c=16-s}for(var u=new Uint8Array(64),h=0;h<n.length;h+=64){o(u,l,t);for(var d=h;d<h+64&&d<n.length;d++)r[d]=n[d]^u[d-h];a(l,c,l.length-c)}return i.wipe(u),0===s&&i.wipe(l),r}function a(t,e,n){for(var r=1;n--;)r=r+(255&t[e])|0,t[e]=255&r,r>>>=8,e++;if(r>0)throw new Error("Salsa20: counter overflow")}e.streamXOR=s,e.stream=function(t,e,n,r){return void 0===r&&(r=0),i.wipe(n),s(t,e,n,n,r)}},3350:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8099),i=n(7309);e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var o=function(){function t(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return t.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},t.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},t.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},t.prototype.update=function(t,n){if(void 0===n&&(n=t.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var r=0;if(this._bytesHashed+=n,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&n>0;)this._buffer[this._bufferLength++]=t[r++],n--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(n>=this.blockSize&&(r=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,r,n),n%=this.blockSize);n>0;)this._buffer[this._bufferLength++]=t[r++],n--;return this},t.prototype.finish=function(t){if(!this._finished){var e=this._bytesHashed,n=this._bufferLength,i=e/536870912|0,o=e<<3,s=e%128<112?128:256;this._buffer[n]=128;for(var l=n+1;l<s-8;l++)this._buffer[l]=0;r.writeUint32BE(i,this._buffer,s-8),r.writeUint32BE(o,this._buffer,s-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,s),this._finished=!0}for(l=0;l<this.digestLength/8;l++)r.writeUint32BE(this._stateHi[l],t,8*l),r.writeUint32BE(this._stateLo[l],t,8*l+4);return this},t.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},t.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},t.prototype.restoreState=function(t){return this._stateHi.set(t.stateHi),this._stateLo.set(t.stateLo),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},t.prototype.cleanSavedState=function(t){i.wipe(t.stateHi),i.wipe(t.stateLo),t.buffer&&i.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},t}();e.SHA512=o;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(t,e,n,i,o,a,l){for(var c,u,h,d,p,f,m,g,y=n[0],v=n[1],_=n[2],w=n[3],b=n[4],x=n[5],E=n[6],S=n[7],M=i[0],T=i[1],A=i[2],R=i[3],L=i[4],C=i[5],P=i[6],I=i[7];l>=128;){for(var O=0;O<16;O++){var N=8*O+a;t[O]=r.readUint32BE(o,N),e[O]=r.readUint32BE(o,N+4)}for(O=0;O<80;O++){var k,D,B=y,U=v,z=_,F=w,H=b,G=x,V=E,j=M,W=T,q=A,K=R,X=L,Y=C,J=P;if(p=65535&(u=I),f=u>>>16,m=65535&(c=S),g=c>>>16,p+=65535&(u=(L>>>14|b<<18)^(L>>>18|b<<14)^(b>>>9|L<<23)),f+=u>>>16,m+=65535&(c=(b>>>14|L<<18)^(b>>>18|L<<14)^(L>>>9|b<<23)),g+=c>>>16,p+=65535&(u=L&C^~L&P),f+=u>>>16,m+=65535&(c=b&x^~b&E),g+=c>>>16,c=s[2*O],p+=65535&(u=s[2*O+1]),f+=u>>>16,m+=65535&c,g+=c>>>16,c=t[O%16],f+=(u=e[O%16])>>>16,m+=65535&c,g+=c>>>16,m+=(f+=(p+=65535&u)>>>16)>>>16,p=65535&(u=d=65535&p|f<<16),f=u>>>16,m=65535&(c=h=65535&m|(g+=m>>>16)<<16),g=c>>>16,p+=65535&(u=(M>>>28|y<<4)^(y>>>2|M<<30)^(y>>>7|M<<25)),f+=u>>>16,m+=65535&(c=(y>>>28|M<<4)^(M>>>2|y<<30)^(M>>>7|y<<25)),g+=c>>>16,f+=(u=M&T^M&A^T&A)>>>16,m+=65535&(c=y&v^y&_^v&_),g+=c>>>16,k=65535&(m+=(f+=(p+=65535&u)>>>16)>>>16)|(g+=m>>>16)<<16,D=65535&p|f<<16,p=65535&(u=K),f=u>>>16,m=65535&(c=F),g=c>>>16,f+=(u=d)>>>16,m+=65535&(c=h),g+=c>>>16,v=B,_=U,w=z,b=F=65535&(m+=(f+=(p+=65535&u)>>>16)>>>16)|(g+=m>>>16)<<16,x=H,E=G,S=V,y=k,T=j,A=W,R=q,L=K=65535&p|f<<16,C=X,P=Y,I=J,M=D,O%16==15)for(N=0;N<16;N++)c=t[N],p=65535&(u=e[N]),f=u>>>16,m=65535&c,g=c>>>16,c=t[(N+9)%16],p+=65535&(u=e[(N+9)%16]),f+=u>>>16,m+=65535&c,g+=c>>>16,h=t[(N+1)%16],p+=65535&(u=((d=e[(N+1)%16])>>>1|h<<31)^(d>>>8|h<<24)^(d>>>7|h<<25)),f+=u>>>16,m+=65535&(c=(h>>>1|d<<31)^(h>>>8|d<<24)^h>>>7),g+=c>>>16,h=t[(N+14)%16],f+=(u=((d=e[(N+14)%16])>>>19|h<<13)^(h>>>29|d<<3)^(d>>>6|h<<26))>>>16,m+=65535&(c=(h>>>19|d<<13)^(d>>>29|h<<3)^h>>>6),g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,t[N]=65535&m|g<<16,e[N]=65535&p|f<<16}p=65535&(u=M),f=u>>>16,m=65535&(c=y),g=c>>>16,c=n[0],f+=(u=i[0])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[0]=y=65535&m|g<<16,i[0]=M=65535&p|f<<16,p=65535&(u=T),f=u>>>16,m=65535&(c=v),g=c>>>16,c=n[1],f+=(u=i[1])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[1]=v=65535&m|g<<16,i[1]=T=65535&p|f<<16,p=65535&(u=A),f=u>>>16,m=65535&(c=_),g=c>>>16,c=n[2],f+=(u=i[2])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[2]=_=65535&m|g<<16,i[2]=A=65535&p|f<<16,p=65535&(u=R),f=u>>>16,m=65535&(c=w),g=c>>>16,c=n[3],f+=(u=i[3])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[3]=w=65535&m|g<<16,i[3]=R=65535&p|f<<16,p=65535&(u=L),f=u>>>16,m=65535&(c=b),g=c>>>16,c=n[4],f+=(u=i[4])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[4]=b=65535&m|g<<16,i[4]=L=65535&p|f<<16,p=65535&(u=C),f=u>>>16,m=65535&(c=x),g=c>>>16,c=n[5],f+=(u=i[5])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[5]=x=65535&m|g<<16,i[5]=C=65535&p|f<<16,p=65535&(u=P),f=u>>>16,m=65535&(c=E),g=c>>>16,c=n[6],f+=(u=i[6])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[6]=E=65535&m|g<<16,i[6]=P=65535&p|f<<16,p=65535&(u=I),f=u>>>16,m=65535&(c=S),g=c>>>16,c=n[7],f+=(u=i[7])>>>16,m+=65535&c,g+=c>>>16,g+=(m+=(f+=(p+=65535&u)>>>16)>>>16)>>>16,n[7]=S=65535&m|g<<16,i[7]=I=65535&p|f<<16,a+=128,l-=128}return a}e.hash=function(t){var e=new o;e.update(t);var n=e.digest();return e.clean(),n}},6249:(t,e)=>{"use strict";var n="utf8: invalid string";e.cv=function(t){for(var e=new Uint8Array(function(t){for(var e=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i<128)e+=1;else if(i<2048)e+=2;else if(i<55296)e+=3;else{if(!(i<=57343))throw new Error(n);if(r>=t.length-1)throw new Error(n);r++,e+=4}}return e}(t)),r=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?e[r++]=o:o<2048?(e[r++]=192|o>>6,e[r++]=128|63&o):o<55296?(e[r++]=224|o>>12,e[r++]=128|o>>6&63,e[r++]=128|63&o):(i++,o=(1023&o)<<10,o|=1023&t.charCodeAt(i),o+=65536,e[r++]=240|o>>18,e[r++]=128|o>>12&63,e[r++]=128|o>>6&63,e[r++]=128|63&o)}return e}},7309:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wipe=function(t){for(var e=0;e<t.length;e++)t[e]=0;return t}},6273:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.X25519Session=e.SECRET_SEED_LENGTH=e.SAVED_STATE_LENGTH=e.ACCEPT_MESSAGE_LENGTH=e.OFFER_MESSAGE_LENGTH=void 0;const r=n(1416),i=n(7309),o=n(7664),s=n(4826);e.OFFER_MESSAGE_LENGTH=o.PUBLIC_KEY_LENGTH,e.ACCEPT_MESSAGE_LENGTH=o.PUBLIC_KEY_LENGTH,e.SAVED_STATE_LENGTH=o.SECRET_KEY_LENGTH,e.SECRET_SEED_LENGTH=o.SECRET_KEY_LENGTH,e.X25519Session=class{constructor(t,n){this.offerMessageLength=e.OFFER_MESSAGE_LENGTH,this.acceptMessageLength=e.ACCEPT_MESSAGE_LENGTH,this.sharedKeyLength=o.SHARED_KEY_LENGTH,this.savedStateLength=e.SAVED_STATE_LENGTH,this._seed=t||(0,r.randomBytes)(o.SECRET_KEY_LENGTH,n)}saveState(){return new Uint8Array(this._seed)}restoreState(t){return this._seed=new Uint8Array(t),this}clean(){this._seed&&(0,i.wipe)(this._seed),this._keyPair&&((0,i.wipe)(this._keyPair.secretKey),(0,i.wipe)(this._keyPair.publicKey)),this._sharedKey&&(0,i.wipe)(this._sharedKey),this._sessionKeys&&((0,i.wipe)(this._sessionKeys.receive),(0,i.wipe)(this._sessionKeys.send))}offer(){return this._keyPair=(0,o.generateKeyPairFromSeed)(this._seed),new Uint8Array(this._keyPair.publicKey)}accept(t){if(this._keyPair)throw new Error("X25519Session: accept shouldn't be called by offering party");if(t.length!==this.offerMessageLength)throw new Error("X25519Session: incorrect offer message length");if(this._sharedKey)throw new Error("X25519Session: accept was already called");const e=(0,o.generateKeyPairFromSeed)(this._seed);return this._sharedKey=(0,o.sharedKey)(e.secretKey,t),this._sessionKeys=(0,s.clientSessionKeysFromSharedKey)(this._sharedKey,e.publicKey,t),(0,i.wipe)(e.secretKey),e.publicKey}finish(t){if(t.length!==this.acceptMessageLength)throw new Error("X25519Session: incorrect accept message length");if(!this._keyPair)throw new Error("X25519Session: no offer state");if(this._sharedKey)throw new Error("X25519Session: finish was already called");return this._sharedKey=(0,o.sharedKey)(this._keyPair.secretKey,t),this._sessionKeys=(0,s.serverSessionKeysFromSharedKey)(this._sharedKey,this._keyPair.publicKey,t),this}getSharedKey(){if(!this._sharedKey)throw new Error("X25519Session: no shared key established");return new Uint8Array(this._sharedKey)}getSessionKeys(){if(!this._sessionKeys)throw new Error("X25519Session: no shared key established");return{receive:new Uint8Array(this._sessionKeys.receive),send:new Uint8Array(this._sessionKeys.send)}}}},4826:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clientSessionKeys=e.serverSessionKeys=e.clientSessionKeysFromSharedKey=e.serverSessionKeysFromSharedKey=e.X25519Session=void 0;const r=n(1322),i=n(7664);var o=n(6273);Object.defineProperty(e,"X25519Session",{enumerable:!0,get:function(){return o.X25519Session}});function s(t,e,n,i=r.BLAKE2b){const o=new i;if(64!==o.digestLength)throw new Error("X25519: incorrect digest length");const s=o.update(t).update(n).update(e).digest();return{send:s.subarray(0,32),receive:s.subarray(32)}}function a(t,e,n,i=r.BLAKE2b){const o=new i;if(64!==o.digestLength)throw new Error("X25519: incorrect digest length");const s=o.update(t).update(e).update(n).digest();return{receive:s.subarray(0,32),send:s.subarray(32)}}e.serverSessionKeysFromSharedKey=s,e.clientSessionKeysFromSharedKey=a,e.serverSessionKeys=function(t,e,n=r.BLAKE2b){return s((0,i.sharedKey)(t.secretKey,e),t.publicKey,e,n)},e.clientSessionKeys=function(t,e,n=r.BLAKE2b){return a((0,i.sharedKey)(t.secretKey,e),t.publicKey,e,n)}},7664:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const r=n(1416),i=n(7309);function o(t){const e=new Float64Array(16);if(t)for(let n=0;n<t.length;n++)e[n]=t[n];return e}e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;const s=new Uint8Array(32);s[0]=9;const a=o([56129,1]);function l(t){let e=1;for(let n=0;n<16;n++){let r=t[n]+e+65535;e=Math.floor(r/65536),t[n]=r-65536*e}t[0]+=e-1+37*(e-1)}function c(t,e,n){const r=~(n-1);for(let n=0;n<16;n++){const i=r&(t[n]^e[n]);t[n]^=i,e[n]^=i}}function u(t,e,n){for(let r=0;r<16;r++)t[r]=e[r]+n[r]}function h(t,e,n){for(let r=0;r<16;r++)t[r]=e[r]-n[r]}function d(t,e,n){let r,i,o=0,s=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=0,w=0,b=0,x=0,E=0,S=0,M=0,T=0,A=0,R=0,L=0,C=0,P=0,I=0,O=0,N=0,k=0,D=n[0],B=n[1],U=n[2],z=n[3],F=n[4],H=n[5],G=n[6],V=n[7],j=n[8],W=n[9],q=n[10],K=n[11],X=n[12],Y=n[13],J=n[14],Z=n[15];r=e[0],o+=r*D,s+=r*B,a+=r*U,l+=r*z,c+=r*F,u+=r*H,h+=r*G,d+=r*V,p+=r*j,f+=r*W,m+=r*q,g+=r*K,y+=r*X,v+=r*Y,_+=r*J,w+=r*Z,r=e[1],s+=r*D,a+=r*B,l+=r*U,c+=r*z,u+=r*F,h+=r*H,d+=r*G,p+=r*V,f+=r*j,m+=r*W,g+=r*q,y+=r*K,v+=r*X,_+=r*Y,w+=r*J,b+=r*Z,r=e[2],a+=r*D,l+=r*B,c+=r*U,u+=r*z,h+=r*F,d+=r*H,p+=r*G,f+=r*V,m+=r*j,g+=r*W,y+=r*q,v+=r*K,_+=r*X,w+=r*Y,b+=r*J,x+=r*Z,r=e[3],l+=r*D,c+=r*B,u+=r*U,h+=r*z,d+=r*F,p+=r*H,f+=r*G,m+=r*V,g+=r*j,y+=r*W,v+=r*q,_+=r*K,w+=r*X,b+=r*Y,x+=r*J,E+=r*Z,r=e[4],c+=r*D,u+=r*B,h+=r*U,d+=r*z,p+=r*F,f+=r*H,m+=r*G,g+=r*V,y+=r*j,v+=r*W,_+=r*q,w+=r*K,b+=r*X,x+=r*Y,E+=r*J,S+=r*Z,r=e[5],u+=r*D,h+=r*B,d+=r*U,p+=r*z,f+=r*F,m+=r*H,g+=r*G,y+=r*V,v+=r*j,_+=r*W,w+=r*q,b+=r*K,x+=r*X,E+=r*Y,S+=r*J,M+=r*Z,r=e[6],h+=r*D,d+=r*B,p+=r*U,f+=r*z,m+=r*F,g+=r*H,y+=r*G,v+=r*V,_+=r*j,w+=r*W,b+=r*q,x+=r*K,E+=r*X,S+=r*Y,M+=r*J,T+=r*Z,r=e[7],d+=r*D,p+=r*B,f+=r*U,m+=r*z,g+=r*F,y+=r*H,v+=r*G,_+=r*V,w+=r*j,b+=r*W,x+=r*q,E+=r*K,S+=r*X,M+=r*Y,T+=r*J,A+=r*Z,r=e[8],p+=r*D,f+=r*B,m+=r*U,g+=r*z,y+=r*F,v+=r*H,_+=r*G,w+=r*V,b+=r*j,x+=r*W,E+=r*q,S+=r*K,M+=r*X,T+=r*Y,A+=r*J,R+=r*Z,r=e[9],f+=r*D,m+=r*B,g+=r*U,y+=r*z,v+=r*F,_+=r*H,w+=r*G,b+=r*V,x+=r*j,E+=r*W,S+=r*q,M+=r*K,T+=r*X,A+=r*Y,R+=r*J,L+=r*Z,r=e[10],m+=r*D,g+=r*B,y+=r*U,v+=r*z,_+=r*F,w+=r*H,b+=r*G,x+=r*V,E+=r*j,S+=r*W,M+=r*q,T+=r*K,A+=r*X,R+=r*Y,L+=r*J,C+=r*Z,r=e[11],g+=r*D,y+=r*B,v+=r*U,_+=r*z,w+=r*F,b+=r*H,x+=r*G,E+=r*V,S+=r*j,M+=r*W,T+=r*q,A+=r*K,R+=r*X,L+=r*Y,C+=r*J,P+=r*Z,r=e[12],y+=r*D,v+=r*B,_+=r*U,w+=r*z,b+=r*F,x+=r*H,E+=r*G,S+=r*V,M+=r*j,T+=r*W,A+=r*q,R+=r*K,L+=r*X,C+=r*Y,P+=r*J,I+=r*Z,r=e[13],v+=r*D,_+=r*B,w+=r*U,b+=r*z,x+=r*F,E+=r*H,S+=r*G,M+=r*V,T+=r*j,A+=r*W,R+=r*q,L+=r*K,C+=r*X,P+=r*Y,I+=r*J,O+=r*Z,r=e[14],_+=r*D,w+=r*B,b+=r*U,x+=r*z,E+=r*F,S+=r*H,M+=r*G,T+=r*V,A+=r*j,R+=r*W,L+=r*q,C+=r*K,P+=r*X,I+=r*Y,O+=r*J,N+=r*Z,r=e[15],w+=r*D,b+=r*B,x+=r*U,E+=r*z,S+=r*F,M+=r*H,T+=r*G,A+=r*V,R+=r*j,L+=r*W,C+=r*q,P+=r*K,I+=r*X,O+=r*Y,N+=r*J,k+=r*Z,o+=38*b,s+=38*x,a+=38*E,l+=38*S,c+=38*M,u+=38*T,h+=38*A,d+=38*R,p+=38*L,f+=38*C,m+=38*P,g+=38*I,y+=38*O,v+=38*N,_+=38*k,i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),i=1,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=v+i+65535,i=Math.floor(r/65536),v=r-65536*i,r=_+i+65535,i=Math.floor(r/65536),_=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,o+=i-1+37*(i-1),t[0]=o,t[1]=s,t[2]=a,t[3]=l,t[4]=c,t[5]=u,t[6]=h,t[7]=d,t[8]=p,t[9]=f,t[10]=m,t[11]=g,t[12]=y,t[13]=v,t[14]=_,t[15]=w}function p(t,e){d(t,e,e)}function f(t,e){const n=new Uint8Array(32),r=new Float64Array(80),i=o(),s=o(),f=o(),m=o(),g=o(),y=o();for(let e=0;e<31;e++)n[e]=t[e];n[31]=127&t[31]|64,n[0]&=248,function(t,e){for(let n=0;n<16;n++)t[n]=e[2*n]+(e[2*n+1]<<8);t[15]&=32767}(r,e);for(let t=0;t<16;t++)s[t]=r[t];i[0]=m[0]=1;for(let t=254;t>=0;--t){const e=n[t>>>3]>>>(7&t)&1;c(i,s,e),c(f,m,e),u(g,i,f),h(i,i,f),u(f,s,m),h(s,s,m),p(m,g),p(y,i),d(i,f,i),d(f,s,g),u(g,i,f),h(i,i,f),p(s,i),h(f,m,y),d(i,f,a),u(i,i,m),d(f,f,i),d(i,m,y),d(m,s,r),p(s,g),c(i,s,e),c(f,m,e)}for(let t=0;t<16;t++)r[t+16]=i[t],r[t+32]=f[t],r[t+48]=s[t],r[t+64]=m[t];const v=r.subarray(32),_=r.subarray(16);!function(t,e){const n=o();for(let t=0;t<16;t++)n[t]=e[t];for(let t=253;t>=0;t--)p(n,n),2!==t&&4!==t&&d(n,n,e);for(let e=0;e<16;e++)t[e]=n[e]}(v,v),d(_,_,v);const w=new Uint8Array(32);return function(t,e){const n=o(),r=o();for(let t=0;t<16;t++)r[t]=e[t];l(r),l(r),l(r);for(let t=0;t<2;t++){n[0]=r[0]-65517;for(let t=1;t<15;t++)n[t]=r[t]-65535-(n[t-1]>>16&1),n[t-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const t=n[15]>>16&1;n[14]&=65535,c(r,n,1-t)}for(let e=0;e<16;e++)t[2*e]=255&r[e],t[2*e+1]=r[e]>>8}(w,_),w}function m(t){return f(t,s)}function g(t){if(t.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const n=new Uint8Array(t);return{publicKey:m(n),secretKey:n}}e.scalarMult=f,e.scalarMultBase=m,e.generateKeyPairFromSeed=g,e.generateKeyPair=function(t){const e=(0,r.randomBytes)(32,t),n=g(e);return(0,i.wipe)(e),n},e.sharedKey=function(t,n,r=!1){if(t.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(n.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const i=f(t,n);if(r){let t=0;for(let e=0;e<i.length;e++)t|=i[e];if(0===t)throw new Error("X25519: invalid shared key")}return i}},7025:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8099),i=n(7318),o=n(7309);function s(t,e,n,r,s){if(void 0===s&&(s=0),0===s){if(24!==e.length)throw new Error("XSalsa20 nonce must be 24 bytes")}else if(32!==e.length)throw new Error("XSalsa20 nonce with counter must be 32 bytes");var l=a(t,e.subarray(0,16),new Uint8Array(32)),c=i.streamXOR(l,e.subarray(16),n,r,s);return o.wipe(l),c}function a(t,e,n){for(var i,o=1634760805,s=t[3]<<24|t[2]<<16|t[1]<<8|t[0],a=t[7]<<24|t[6]<<16|t[5]<<8|t[4],l=t[11]<<24|t[10]<<16|t[9]<<8|t[8],c=t[15]<<24|t[14]<<16|t[13]<<8|t[12],u=857760878,h=e[3]<<24|e[2]<<16|e[1]<<8|e[0],d=e[7]<<24|e[6]<<16|e[5]<<8|e[4],p=e[11]<<24|e[10]<<16|e[9]<<8|e[8],f=e[15]<<24|e[14]<<16|e[13]<<8|e[12],m=2036477234,g=t[19]<<24|t[18]<<16|t[17]<<8|t[16],y=t[23]<<24|t[22]<<16|t[21]<<8|t[20],v=t[27]<<24|t[26]<<16|t[25]<<8|t[24],_=t[31]<<24|t[30]<<16|t[29]<<8|t[28],w=1797285236,b=0;b<20;b+=2)o^=(i=(y^=(i=(p^=(i=(c^=(i=o+y|0)<<7|i>>>25)+o|0)<<9|i>>>23)+c|0)<<13|i>>>19)+p|0)<<18|i>>>14,u^=(i=(s^=(i=(v^=(i=(f^=(i=u+s|0)<<7|i>>>25)+u|0)<<9|i>>>23)+f|0)<<13|i>>>19)+v|0)<<18|i>>>14,m^=(i=(h^=(i=(a^=(i=(_^=(i=m+h|0)<<7|i>>>25)+m|0)<<9|i>>>23)+_|0)<<13|i>>>19)+a|0)<<18|i>>>14,w^=(i=(g^=(i=(d^=(i=(l^=(i=w+g|0)<<7|i>>>25)+w|0)<<9|i>>>23)+l|0)<<13|i>>>19)+d|0)<<18|i>>>14,o^=(i=(l^=(i=(a^=(i=(s^=(i=o+l|0)<<7|i>>>25)+o|0)<<9|i>>>23)+s|0)<<13|i>>>19)+a|0)<<18|i>>>14,u^=(i=(c^=(i=(d^=(i=(h^=(i=u+c|0)<<7|i>>>25)+u|0)<<9|i>>>23)+h|0)<<13|i>>>19)+d|0)<<18|i>>>14,m^=(i=(f^=(i=(p^=(i=(g^=(i=m+f|0)<<7|i>>>25)+m|0)<<9|i>>>23)+g|0)<<13|i>>>19)+p|0)<<18|i>>>14,w^=(i=(_^=(i=(v^=(i=(y^=(i=w+_|0)<<7|i>>>25)+w|0)<<9|i>>>23)+y|0)<<13|i>>>19)+v|0)<<18|i>>>14;return r.writeUint32LE(o,n,0),r.writeUint32LE(u,n,4),r.writeUint32LE(m,n,8),r.writeUint32LE(w,n,12),r.writeUint32LE(h,n,16),r.writeUint32LE(d,n,20),r.writeUint32LE(p,n,24),r.writeUint32LE(f,n,28),n}e.streamXOR=s,e.stream=function(t,e,n,r){return void 0===r&&(r=0),o.wipe(n),s(t,e,n,n,r)},e.hsalsa=a},9669:(t,e,n)=>{t.exports=n(1609)},5448:(t,e,n)=>{"use strict";var r=n(4867),i=n(6026),o=n(4372),s=n(5327),a=n(4097),l=n(4109),c=n(7985),u=n(5061),h=n(5655),d=n(5263);t.exports=function(t){return new Promise((function(e,n){var p,f=t.data,m=t.headers,g=t.responseType;function y(){t.cancelToken&&t.cancelToken.unsubscribe(p),t.signal&&t.signal.removeEventListener("abort",p)}r.isFormData(f)&&delete m["Content-Type"];var v=new XMLHttpRequest;if(t.auth){var _=t.auth.username||"",w=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";m.Authorization="Basic "+btoa(_+":"+w)}var b=a(t.baseURL,t.url);function x(){if(v){var r="getAllResponseHeaders"in v?l(v.getAllResponseHeaders()):null,o={data:g&&"text"!==g&&"json"!==g?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:r,config:t,request:v};i((function(t){e(t),y()}),(function(t){n(t),y()}),o),v=null}}if(v.open(t.method.toUpperCase(),s(b,t.params,t.paramsSerializer),!0),v.timeout=t.timeout,"onloadend"in v?v.onloadend=x:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(x)},v.onabort=function(){v&&(n(u("Request aborted",t,"ECONNABORTED",v)),v=null)},v.onerror=function(){n(u("Network Error",t,null,v)),v=null},v.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",r=t.transitional||h.transitional;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(u(e,t,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",v)),v=null},r.isStandardBrowserEnv()){var E=(t.withCredentials||c(b))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;E&&(m[t.xsrfHeaderName]=E)}"setRequestHeader"in v&&r.forEach(m,(function(t,e){void 0===f&&"content-type"===e.toLowerCase()?delete m[e]:v.setRequestHeader(e,t)})),r.isUndefined(t.withCredentials)||(v.withCredentials=!!t.withCredentials),g&&"json"!==g&&(v.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&v.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(p=function(t){v&&(n(!t||t&&t.type?new d("canceled"):t),v.abort(),v=null)},t.cancelToken&&t.cancelToken.subscribe(p),t.signal&&(t.signal.aborted?p():t.signal.addEventListener("abort",p))),f||(f=null),v.send(f)}))}},1609:(t,e,n)=>{"use strict";var r=n(4867),i=n(1849),o=n(321),s=n(7185),a=function t(e){var n=new o(e),a=i(o.prototype.request,n);return r.extend(a,o.prototype,n),r.extend(a,n),a.create=function(n){return t(s(e,n))},a}(n(5655));a.Axios=o,a.Cancel=n(5263),a.CancelToken=n(4972),a.isCancel=n(6502),a.VERSION=n(7288).version,a.all=function(t){return Promise.all(t)},a.spread=n(8713),a.isAxiosError=n(6268),t.exports=a,t.exports.default=a},5263:t=>{"use strict";function e(t){this.message=t}e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,t.exports=e},4972:(t,e,n)=>{"use strict";var r=n(5263);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;this.promise.then((function(t){if(n._listeners){var e,r=n._listeners.length;for(e=0;e<r;e++)n._listeners[e](t);n._listeners=null}})),this.promise.then=function(t){var e,r=new Promise((function(t){n.subscribe(t),e=t})).then(t);return r.cancel=function(){n.unsubscribe(e)},r},t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},i.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},i.source=function(){var t;return{token:new i((function(e){t=e})),cancel:t}},t.exports=i},6502:t=>{"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},321:(t,e,n)=>{"use strict";var r=n(4867),i=n(5327),o=n(782),s=n(3572),a=n(7185),l=n(4875),c=l.validators;function u(t){this.defaults=t,this.interceptors={request:new o,response:new o}}u.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=t.transitional;void 0!==e&&l.assertOptions(e,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var n=[],r=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(r=r&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var i,o=[];if(this.interceptors.response.forEach((function(t){o.push(t.fulfilled,t.rejected)})),!r){var u=[s,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(o),i=Promise.resolve(t);u.length;)i=i.then(u.shift(),u.shift());return i}for(var h=t;n.length;){var d=n.shift(),p=n.shift();try{h=d(h)}catch(t){p(t);break}}try{i=s(h)}catch(t){return Promise.reject(t)}for(;o.length;)i=i.then(o.shift(),o.shift());return i},u.prototype.getUri=function(t){return t=a(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,n){return this.request(a(n||{},{method:t,url:e,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(t){u.prototype[t]=function(e,n,r){return this.request(a(r||{},{method:t,url:e,data:n}))}})),t.exports=u},782:(t,e,n)=>{"use strict";var r=n(4867);function i(){this.handlers=[]}i.prototype.use=function(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},4097:(t,e,n)=>{"use strict";var r=n(1793),i=n(7303);t.exports=function(t,e){return t&&!r(e)?i(t,e):e}},5061:(t,e,n)=>{"use strict";var r=n(481);t.exports=function(t,e,n,i,o){var s=new Error(t);return r(s,e,n,i,o)}},3572:(t,e,n)=>{"use strict";var r=n(4867),i=n(8527),o=n(6502),s=n(5655),a=n(5263);function l(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new a("canceled")}t.exports=function(t){return l(t),t.headers=t.headers||{},t.data=i.call(t,t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return l(t),e.data=i.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(l(t),e&&e.response&&(e.response.data=i.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},481:t=>{"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t}},7185:(t,e,n)=>{"use strict";var r=n(4867);t.exports=function(t,e){e=e||{};var n={};function i(t,e){return r.isPlainObject(t)&&r.isPlainObject(e)?r.merge(t,e):r.isPlainObject(e)?r.merge({},e):r.isArray(e)?e.slice():e}function o(n){return r.isUndefined(e[n])?r.isUndefined(t[n])?void 0:i(void 0,t[n]):i(t[n],e[n])}function s(t){if(!r.isUndefined(e[t]))return i(void 0,e[t])}function a(n){return r.isUndefined(e[n])?r.isUndefined(t[n])?void 0:i(void 0,t[n]):i(void 0,e[n])}function l(n){return n in e?i(t[n],e[n]):n in t?i(void 0,t[n]):void 0}var c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l};return r.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=c[t]||o,i=e(t);r.isUndefined(i)&&e!==l||(n[t]=i)})),n}},6026:(t,e,n)=>{"use strict";var r=n(5061);t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},8527:(t,e,n)=>{"use strict";var r=n(4867),i=n(5655);t.exports=function(t,e,n){var o=this||i;return r.forEach(n,(function(n){t=n.call(o,t,e)})),t}},5655:(t,e,n)=>{"use strict";var r=n(4867),i=n(6016),o=n(481),s={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var l,c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(l=n(5448)),l),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)||e&&"application/json"===e["Content-Type"]?(a(e,"application/json"),function(t,e,n){if(r.isString(t))try{return(0,JSON.parse)(t),r.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional||c.transitional,n=e&&e.silentJSONParsing,i=e&&e.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||i&&r.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(s){if("SyntaxError"===t.name)throw o(t,this,"E_JSON_PARSE");throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(t){c.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){c.headers[t]=r.merge(s)})),t.exports=c},7288:t=>{t.exports={version:"0.24.0"}},1849:t=>{"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},5327:(t,e,n)=>{"use strict";var r=n(4867);function i(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var s=[];r.forEach(e,(function(t,e){null!=t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),s.push(i(e)+"="+i(t))})))})),o=s.join("&")}if(o){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},7303:t=>{"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},4372:(t,e,n)=>{"use strict";var r=n(4867);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,i,o,s){var a=[];a.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:t=>{"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},6268:t=>{"use strict";t.exports=function(t){return"object"==typeof t&&!0===t.isAxiosError}},7985:(t,e,n)=>{"use strict";var r=n(4867);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},6016:(t,e,n)=>{"use strict";var r=n(4867);t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},4109:(t,e,n)=>{"use strict";var r=n(4867),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,s={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(s[e]&&i.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},8713:t=>{"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},4875:(t,e,n)=>{"use strict";var r=n(7288).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){i[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));var o={};i.transitional=function(t,e,n){function i(t,e){return"[Axios v"+r+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return function(n,r,s){if(!1===t)throw new Error(i(r," has been removed"+(e?" in "+e:"")));return e&&!o[r]&&(o[r]=!0,console.warn(i(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,r,s)}},t.exports={assertOptions:function(t,e,n){if("object"!=typeof t)throw new TypeError("options must be an object");for(var r=Object.keys(t),i=r.length;i-- >0;){var o=r[i],s=e[o];if(s){var a=t[o],l=void 0===a||s(a,o,t);if(!0!==l)throw new TypeError("option "+o+" must be "+l)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:i}},4867:(t,e,n)=>{"use strict";var r=n(1849),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function s(t){return void 0===t}function a(t){return null!==t&&"object"==typeof t}function l(t){if("[object Object]"!==i.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function c(t){return"[object Function]"===i.call(t)}function u(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isPlainObject:l,isUndefined:s,isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:c,isStream:function(t){return a(t)&&c(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function t(){var e={};function n(n,r){l(e[r])&&l(n)?e[r]=t(e[r],n):l(n)?e[r]=t({},n):o(n)?e[r]=n.slice():e[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return e},extend:function(t,e,n){return u(e,(function(e,i){t[i]=n&&"function"==typeof e?r(e,n):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},8162:(t,e,n)=>{"use strict";var r=n(9509).Buffer;t.exports=function(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==e[s])throw new TypeError(o+" is ambiguous");e[s]=i}var a=t.length,l=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return r.alloc(0);for(var n=0,i=0,o=0;t[n]===l;)i++,n++;for(var s=(t.length-n)*c+1>>>0,u=new Uint8Array(s);t[n];){var h=e[t.charCodeAt(n)];if(255===h)return;for(var d=0,p=s-1;(0!==h||d<o)&&-1!==p;p--,d++)h+=a*u[p]>>>0,u[p]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");o=d,n++}for(var f=s-o;f!==s&&0===u[f];)f++;var m=r.allocUnsafe(i+(s-f));m.fill(0,0,i);for(var g=i;f!==s;)m[g++]=u[f++];return m}return{encode:function(e){if((Array.isArray(e)||e instanceof Uint8Array)&&(e=r.from(e)),!r.isBuffer(e))throw new TypeError("Expected Buffer");if(0===e.length)return"";for(var n=0,i=0,o=0,s=e.length;o!==s&&0===e[o];)o++,n++;for(var c=(s-o)*u+1>>>0,h=new Uint8Array(c);o!==s;){for(var d=e[o],p=0,f=c-1;(0!==d||p<i)&&-1!==f;f--,p++)d+=256*h[f]>>>0,h[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");i=p,o++}for(var m=c-i;m!==c&&0===h[m];)m++;for(var g=l.repeat(n);m<c;++m)g+=t.charAt(h[m]);return g},decodeUnsafe:h,decode:function(t){var e=h(t);if(e)return e;throw new Error("Non-base"+a+" character")}}}},9742:(t,e)=>{"use strict";e.byteLength=function(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,o=l(t),s=o[0],a=o[1],c=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),u=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],c[u++]=e>>16&255,c[u++]=e>>8&255,c[u++]=255&e;return 2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,c[u++]=255&e),1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,c[u++]=e>>8&255,c[u++]=255&e),c},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=16383,a=0,l=r-i;a<l;a+=s)o.push(c(t,a,a+s>l?l:a+s));return 1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},7191:(t,e,n)=>{var r=n(8162);t.exports=r("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},3310:(t,e,n)=>{"use strict";var r=n(7191),i=n(9509).Buffer;t.exports=function(t){function e(e){var n=e.slice(0,-4),r=e.slice(-4),i=t(n);if(!(r[0]^i[0]|r[1]^i[1]|r[2]^i[2]|r[3]^i[3]))return n}return{encode:function(e){var n=t(e);return r.encode(i.concat([e,n],e.length+4))},decode:function(t){var n=e(r.decode(t));if(!n)throw new Error("Invalid checksum");return n},decodeUnsafe:function(t){var n=r.decodeUnsafe(t);if(n)return e(n)}}}},8334:(t,e,n)=>{"use strict";var r=n(3482),i=n(3310);t.exports=i((function(t){var e=r("sha256").update(t).digest();return r("sha256").update(e).digest()}))},8764:(t,e,n)=>{"use strict";const r=n(9742),i=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return c(t,e,n)}function c(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|m(t,e);let r=a(n);const i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return p(e.buffer,e.byteOffset,e.byteLength)}return d(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return p(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return p(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return l.from(r,e,n);const i=function(t){if(l.isBuffer(t)){const e=0|f(t.length),n=a(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||J(t.length)?a(0):d(t):"Buffer"===t.type&&Array.isArray(t.data)?d(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return u(t),a(t<0?0:0|f(t))}function d(t){const e=t.length<0?0:0|f(t.length),n=a(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function p(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,l.prototype),r}function f(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function m(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return K(t).length;default:if(i)return r?-1:q(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return R(this,e,n);case"latin1":case"binary":return L(this,e,n);case"base64":return M(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),J(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:_(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):_(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function _(t,e,n,r,i){let o,s=1,a=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let r=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===l)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){let n=!0;for(let r=0;r<l;r++)if(c(t,o+r)!==c(e,r)){n=!1;break}if(n)return o}return-1}function w(t,e,n,r){n=Number(n)||0;const i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=e.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(J(r))return s;t[n+s]=r}return s}function b(t,e,n,r){return X(q(e,t.length-n),t,n,r)}function x(t,e,n,r){return X(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return X(K(e),t,n,r)}function S(t,e,n,r){return X(function(t,e){let n,r,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function M(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);const r=[];let i=e;for(;i<n;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=n){let n,r,a,l;switch(s){case 1:e<128&&(o=e);break;case 2:n=t[i+1],128==(192&n)&&(l=(31&e)<<6|63&n,l>127&&(o=l));break;case 3:n=t[i+1],r=t[i+2],128==(192&n)&&128==(192&r)&&(l=(15&e)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=t[i+1],r=t[i+2],a=t[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(l=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(t){const e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=A));return n}(r)}e.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,n){return c(t,e,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},l.allocUnsafe=function(t){return h(t)},l.allocUnsafeSlow=function(t){return h(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(Y(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=l.allocUnsafe(e);let i=0;for(n=0;n<t.length;++n){let e=t[n];if(Y(e,Uint8Array))i+e.length>r.length?(l.isBuffer(e)||(e=l.from(e)),e.copy(r,i)):Uint8Array.prototype.set.call(r,e,i);else{if(!l.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,i)}i+=e.length}return r},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},l.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},l.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},l.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?T(this,0,t):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){let t="";const n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(t,e,n,r,i){if(Y(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0);const a=Math.min(o,s),c=this.slice(r,i),u=t.slice(e,n);for(let t=0;t<a;++t)if(c[t]!==u[t]){o=c[t],s=u[t];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":case"latin1":case"binary":return x(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function R(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function L(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function C(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=e;r<n;++r)i+=Z[t[r]];return i}function P(t,e,n){const r=t.slice(e,n);let i="";for(let t=0;t<r.length-1;t+=2)i+=String.fromCharCode(r[t]+256*r[t+1]);return i}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,r,i,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function N(t,e,n,r,i){G(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function k(t,e,n,r,i){G(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n+7]=o,o>>=8,t[n+6]=o,o>>=8,t[n+5]=o,o>>=8,t[n+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function D(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,r,o){return e=+e,n>>>=0,o||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function U(t,e,n,r,o){return e=+e,n>>>=0,o||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=this[t+--e],i=1;for(;e>0&&(i*=256);)r+=this[t+--e]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readBigUInt64LE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=e,i=1,o=this[t+--r];for(;r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||I(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){t>>>=0,e||I(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readBigInt64LE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),l.prototype.readBigInt64BE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),l.prototype.readFloatLE=function(t,e){return t>>>=0,e||I(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||I(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||I(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||I(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||O(this,t,e,n,Math.pow(2,8*n)-1,0);let i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||O(this,t,e,n,Math.pow(2,8*n)-1,0);let i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigUInt64LE=Q((function(t,e=0){return N(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Q((function(t,e=0){return k(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,t,e,n,r-1,-r)}let i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);O(this,t,e,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigInt64LE=Q((function(t,e=0){return N(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Q((function(t,e=0){return k(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{const o=l.isBuffer(t)?t:l.from(t,r),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<n-e;++i)this[i+e]=o[i%s]}return this};const z={};function F(t,e,n){z[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function H(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function G(t,e,n,r,i,o){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new z.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,n){V(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||j(e,t.length-(n+1))}(r,i,o)}function V(t,e){if("number"!=typeof t)throw new z.ERR_INVALID_ARG_TYPE(e,"number",t)}function j(t,e,n){if(Math.floor(t)!==t)throw V(t,n),new z.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}F("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),F("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),F("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=H(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=H(i)),i+="n"),r+=` It must be ${e}. Received ${i}`,r}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function q(t,e){let n;e=e||1/0;const r=t.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function K(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function X(t,e,n,r){let i;for(i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function J(t){return t!=t}const Z=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)e[r+i]=t[n]+t[i]}return e}();function Q(t){return"undefined"==typeof BigInt?$:t}function $(){throw new Error("BigInt not supported")}},1027:(t,e,n)=>{var r=n(9509).Buffer,i=n(2830).Transform,o=n(2553).s;function s(t){i.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}n(5717)(s,i),s.prototype.update=function(t,e,n){"string"==typeof t&&(t=r.from(t,e));var i=this._update(t);return this.hashMode?this:(n&&(i=this._toString(i,n)),i)},s.prototype.setAutoPadding=function(){},s.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},s.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},s.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},s.prototype._transform=function(t,e,n){var r;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){r=t}finally{n(r)}},s.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(t){e=t}t(e)},s.prototype._finalOrDigest=function(t){var e=this.__final()||r.alloc(0);return t&&(e=this._toString(e,t,!0)),e},s.prototype._toString=function(t,e,n){if(this._decoder||(this._decoder=new o(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var r=this._decoder.write(t);return n&&(r+=this._decoder.end()),r},t.exports=s},3482:(t,e,n)=>{"use strict";var r=n(5717),i=n(2318),o=n(9785),s=n(9072),a=n(1027);function l(t){a.call(this,"digest"),this._hash=t}r(l,a),l.prototype._update=function(t){this._hash.update(t)},l.prototype._final=function(){return this._hash.digest()},t.exports=function(t){return"md5"===(t=t.toLowerCase())?new i:"rmd160"===t||"ripemd160"===t?new o:new l(s(t))}},4098:function(t,e){var n="undefined"!=typeof self?self:this,r=function(){function t(){this.fetch=!1,this.DOMException=n.DOMException}return t.prototype=n,new t}();!function(t){!function(e){var n="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),o="FormData"in t,s="ArrayBuffer"in t;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function c(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=String(t)),t}function h(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function d(t){this.map={},t instanceof d?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function p(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function m(t){var e=new FileReader,n=f(e);return e.readAsArrayBuffer(t),n}function g(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&i&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=g(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||l(t))?this._bodyArrayBuffer=g(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var t,e,n,r=p(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,n=f(e=new FileReader),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(t,e){t=c(t),e=u(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},d.prototype.delete=function(t){delete this.map[c(t)]},d.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},d.prototype.set=function(t,e){this.map[c(t)]=u(e)},d.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},d.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),h(t)},d.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),h(t)},d.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),h(t)},r&&(d.prototype[Symbol.iterator]=d.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function _(t,e){var n,r,i=(e=e||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(r=(n=e.method||this.method||"GET").toUpperCase(),v.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function w(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}})),e}function b(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},y.call(_.prototype),y.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var x=[301,302,303,307,308];b.redirect=function(t,e){if(-1===x.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function E(t,n){return new Promise((function(r,o){var s=new _(t,n);if(s.signal&&s.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function l(){a.abort()}a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new d,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}})),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new b(i,n))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",l),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",l)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}E.polyfill=!0,t.fetch||(t.fetch=E,t.Headers=d,t.Request=_,t.Response=b),e.Headers=d,e.Request=_,e.Response=b,e.fetch=E,Object.defineProperty(e,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;(e=i.fetch).default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e},7187:t=>{"use strict";var e,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var i=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(n,r){function i(n){t.removeListener(e,o),r(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}m(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&m(t,"error",e,{once:!0})}(t,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function c(t,e,n,r){var i,o,s,c;if(a(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(t))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=u.bind(r);return i.listener=n,r.wrapFn=i,i}function d(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):f(i,i.length)}function p(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function m(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){r.once&&t.removeEventListener(e,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[t];if(void 0===l)return!1;if("function"==typeof l)r(l,this,e);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)r(u[n],this,e)}return!0},o.prototype.addListener=function(t,e){return c(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return c(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,h(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,h(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,r,i,o,s;if(a(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},o.prototype.listeners=function(t){return d(this,t,!0)},o.prototype.rawListeners=function(t){return d(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},2445:t=>{"use strict";t.exports=function(t){var e=t.uri,n=t.name,r=t.type;this.uri=e,this.name=n,this.type=r}},804:(t,e,n)=>{"use strict";var r=n(1268);t.exports=function t(e,n,i){var o;void 0===n&&(n=""),void 0===i&&(i=r);var s=new Map;function a(t,e){var n=s.get(e);n?n.push.apply(n,t):s.set(e,t)}if(i(e))o=null,a([n],e);else{var l=n?n+".":"";if("undefined"!=typeof FileList&&e instanceof FileList)o=Array.prototype.map.call(e,(function(t,e){return a([""+l+e],t),null}));else if(Array.isArray(e))o=e.map((function(e,n){var r=t(e,""+l+n,i);return r.files.forEach(a),r.clone}));else if(e&&e.constructor===Object)for(var c in o={},e){var u=t(e[c],""+l+c,i);u.files.forEach(a),o[c]=u.clone}else o=e}return{clone:o,files:s}}},4823:(t,e,n)=>{"use strict";e.ReactNativeFile=n(2445),e.extractFiles=n(804),e.isExtractableFile=n(1268)},1268:(t,e,n)=>{"use strict";var r=n(2445);t.exports=function(t){return"undefined"!=typeof File&&t instanceof File||"undefined"!=typeof Blob&&t instanceof Blob||t instanceof r}},6230:t=>{t.exports="object"==typeof self?self.FormData:window.FormData},8458:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(4823),o=r(n(6230)),s=function(t){return i.isExtractableFile(t)||null!==t&&"object"==typeof t&&"function"==typeof t.pipe};e.default=function(t,e,n){var r=i.extractFiles({query:t,variables:e,operationName:n},"",s),a=r.clone,l=r.files;if(0===l.size){if(!Array.isArray(t))return JSON.stringify(a);if(void 0!==e&&!Array.isArray(e))throw new Error("Cannot create request body with given variable type, array expected");var c=t.reduce((function(t,n,r){return t.push({query:n,variables:e?e[r]:void 0}),t}),[]);return JSON.stringify(c)}var u=new("undefined"==typeof FormData?o.default:FormData);u.append("operations",JSON.stringify(a));var h={},d=0;return l.forEach((function(t){h[++d]=t})),u.append("map",JSON.stringify(h)),d=0,l.forEach((function(t,e){u.append(""+ ++d,e)})),u}},8687:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return o(e,t),e},a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))},l=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},c=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.gql=e.batchRequests=e.request=e.rawRequest=e.GraphQLClient=e.ClientError=void 0;var h=s(n(4098)),d=h,p=n(3033),f=u(n(8458)),m=n(8308);Object.defineProperty(e,"ClientError",{enumerable:!0,get:function(){return m.ClientError}});var g=function(t){var e={};return t&&("undefined"!=typeof Headers&&t instanceof Headers||t instanceof d.Headers?e=function(t){var e={};return t.forEach((function(t,n){e[n]=t})),e}(t):Array.isArray(t)?t.forEach((function(t){var n=t[0],r=t[1];e[n]=r})):e=t),e},y=function(t){return t.replace(/([\s,]|#[^\n\r]+)+/g," ").trim()},v=function(t){var e=t.url,n=t.query,i=t.variables,o=t.operationName,s=t.headers,c=t.fetch,u=t.fetchOptions;return a(void 0,void 0,void 0,(function(){var t;return l(this,(function(a){switch(a.label){case 0:return t=f.default(n,i,o),[4,c(e,r({method:"POST",headers:r(r({},"string"==typeof t?{"Content-Type":"application/json"}:{}),s),body:t},u))];case 1:return[2,a.sent()]}}))}))},_=function(t){var e=t.url,n=t.query,i=t.variables,o=t.operationName,s=t.headers,c=t.fetch,u=t.fetchOptions;return a(void 0,void 0,void 0,(function(){var t;return l(this,(function(a){switch(a.label){case 0:return t=function(t){var e=t.query,n=t.variables,r=t.operationName;if(!Array.isArray(e)){var i=["query="+encodeURIComponent(y(e))];return n&&i.push("variables="+encodeURIComponent(JSON.stringify(n))),r&&i.push("operationName="+encodeURIComponent(r)),i.join("&")}if(void 0!==n&&!Array.isArray(n))throw new Error("Cannot create query with given variable type, array expected");var o=e.reduce((function(t,e,r){return t.push({query:y(e),variables:n?JSON.stringify(n[r]):void 0}),t}),[]);return"query="+encodeURIComponent(JSON.stringify(o))}({query:n,variables:i,operationName:o}),[4,c(e+"?"+t,r({method:"GET",headers:s},u))];case 1:return[2,a.sent()]}}))}))},w=function(){function t(t,e){this.url=t,this.options=e||{}}return t.prototype.rawRequest=function(t,e,n){var i=this.options,o=i.headers,s=i.fetch,a=void 0===s?h.default:s,l=i.method,u=void 0===l?"POST":l,d=c(i,["headers","fetch","method"]);return b({url:this.url,query:t,variables:e,headers:r(r({},g(o)),g(n)),operationName:void 0,fetch:a,method:u,fetchOptions:d})},t.prototype.request=function(t,e,n){return a(this,void 0,void 0,(function(){var i,o,s,a,u,d,p,f,m,y,v;return l(this,(function(l){switch(l.label){case 0:return i=this.options,o=i.headers,s=i.fetch,a=void 0===s?h.default:s,u=i.method,d=void 0===u?"POST":u,p=c(i,["headers","fetch","method"]),f=this.url,m=S(t),y=m.query,v=m.operationName,[4,b({url:f,query:y,variables:e,headers:r(r({},g(o)),g(n)),operationName:v,fetch:a,method:d,fetchOptions:p})];case 1:return[2,l.sent().data]}}))}))},t.prototype.batchRequests=function(t,e){return a(this,void 0,void 0,(function(){var n,i,o,s,a,u,d,p,f,m;return l(this,(function(l){switch(l.label){case 0:return n=this.options,i=n.headers,o=n.fetch,s=void 0===o?h.default:o,a=n.method,u=void 0===a?"POST":a,d=c(n,["headers","fetch","method"]),p=this.url,f=t.map((function(t){return S(t.document).query})),m=t.map((function(t){return t.variables})),[4,b({url:p,query:f,variables:m,headers:r(r({},g(i)),g(e)),operationName:void 0,fetch:s,method:u,fetchOptions:d})];case 1:return[2,l.sent().data]}}))}))},t.prototype.setHeaders=function(t){return this.options.headers=t,this},t.prototype.setHeader=function(t,e){var n,r=this.options.headers;return r?r[t]=e:this.options.headers=((n={})[t]=e,n),this},t.prototype.setEndpoint=function(t){return this.url=t,this},t}();function b(t){var e=t.url,n=t.query,i=t.variables,o=t.headers,s=t.operationName,c=t.fetch,u=t.method,h=void 0===u?"POST":u,d=t.fetchOptions;return a(this,void 0,void 0,(function(){var t,a,u,p,f,g,y,w;return l(this,(function(l){switch(l.label){case 0:return t="POST"===h.toUpperCase()?v:_,a=Array.isArray(n),[4,t({url:e,query:n,variables:i,operationName:s,headers:o,fetch:c,fetchOptions:d})];case 1:return[4,E(u=l.sent())];case 2:if(p=l.sent(),f=a&&Array.isArray(p)?!p.some((function(t){return!t.data})):!!p.data,u.ok&&!p.errors&&f)return g=u.headers,y=u.status,[2,r(r({},a?{data:p}:p),{headers:g,status:y})];throw w="string"==typeof p?{error:p}:p,new m.ClientError(r(r({},w),{status:u.status,headers:u.headers}),{query:n,variables:i})}}))}))}function x(t,e,n,r){return a(this,void 0,void 0,(function(){return l(this,(function(i){return[2,new w(t).request(e,n,r)]}))}))}function E(t){var e=t.headers.get("Content-Type");return e&&e.startsWith("application/json")?t.json():t.text()}function S(t){var e;if("string"==typeof t)return{query:t};var n=void 0,r=t.definitions.filter((function(t){return"OperationDefinition"===t.kind}));return 1===r.length&&(n=null===(e=r[0].name)||void 0===e?void 0:e.value),{query:p.print(t),operationName:n}}e.GraphQLClient=w,e.rawRequest=function(t,e,n,r){return a(this,void 0,void 0,(function(){return l(this,(function(i){return[2,new w(t).rawRequest(e,n,r)]}))}))},e.request=x,e.batchRequests=function(t,e,n){return a(this,void 0,void 0,(function(){return l(this,(function(r){return[2,new w(t).batchRequests(e,n)]}))}))},e.default=x,e.gql=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.reduce((function(t,n,r){return""+t+n+(r in e?e[r]:"")}),"")}},8308:function(t,e){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ClientError=void 0;var i=function(t){function e(n,r){var i=this,o=e.extractMessage(n)+": "+JSON.stringify({response:n,request:r});return i=t.call(this,o)||this,Object.setPrototypeOf(i,e.prototype),i.response=n,i.request=r,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,e),i}return r(e,t),e.extractMessage=function(t){try{return t.errors[0].message}catch(e){return"GraphQL Error (Code: "+t.status+")"}},e}(Error);e.ClientError=i},7242:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.devAssert=function(t,e){if(!Boolean(t))throw new Error(e)}},8002:(t,e)=>{"use strict";function n(t,e){switch(typeof t){case"string":return JSON.stringify(t);case"function":return t.name?`[function ${t.name}]`:"[function]";case"object":return function(t,e){if(null===t)return"null";if(e.includes(t))return"[Circular]";const r=[...e,t];if(function(t){return"function"==typeof t.toJSON}(t)){const e=t.toJSON();if(e!==t)return"string"==typeof e?e:n(e,r)}else if(Array.isArray(t))return function(t,e){if(0===t.length)return"[]";if(e.length>2)return"[Array]";const r=Math.min(10,t.length),i=t.length-r,o=[];for(let i=0;i<r;++i)o.push(n(t[i],e));return 1===i?o.push("... 1 more item"):i>1&&o.push(`... ${i} more items`),"["+o.join(", ")+"]"}(t,r);return function(t,e){const r=Object.entries(t);if(0===r.length)return"{}";if(e.length>2)return"["+function(t){const e=Object.prototype.toString.call(t).replace(/^\[object /,"").replace(/]$/,"");if("Object"===e&&"function"==typeof t.constructor){const e=t.constructor.name;if("string"==typeof e&&""!==e)return e}return e}(t)+"]";const i=r.map((([t,r])=>t+": "+n(r,e)));return"{ "+i.join(", ")+" }"}(t,r)}(t,e);default:return String(t)}}Object.defineProperty(e,"__esModule",{value:!0}),e.inspect=function(t){return n(t,[])}},1807:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Token=e.QueryDocumentKeys=e.OperationTypeNode=e.Location=void 0,e.isNode=function(t){const e=null==t?void 0:t.kind;return"string"==typeof e&&o.has(e)};class n{constructor(t,e,n){this.start=t.start,this.end=e.end,this.startToken=t,this.endToken=e,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}e.Location=n;class r{constructor(t,e,n,r,i,o){this.kind=t,this.start=e,this.end=n,this.line=r,this.column=i,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}e.Token=r;const i={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};e.QueryDocumentKeys=i;const o=new Set(Object.keys(i));let s;e.OperationTypeNode=s,function(t){t.QUERY="query",t.MUTATION="mutation",t.SUBSCRIPTION="subscription"}(s||(e.OperationTypeNode=s={}))},849:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dedentBlockStringLines=function(t){var e;let n=Number.MAX_SAFE_INTEGER,r=null,o=-1;for(let e=0;e<t.length;++e){var s;const a=t[e],l=i(a);l!==a.length&&(r=null!==(s=r)&&void 0!==s?s:e,o=e,0!==e&&l<n&&(n=l))}return t.map(((t,e)=>0===e?t:t.slice(n))).slice(null!==(e=r)&&void 0!==e?e:0,o+1)},e.isPrintableAsBlockString=function(t){if(""===t)return!0;let e=!0,n=!1,r=!0,i=!1;for(let o=0;o<t.length;++o)switch(t.codePointAt(o)){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 11:case 12:case 14:case 15:case 13:return!1;case 10:if(e&&!i)return!1;i=!0,e=!0,n=!1;break;case 9:case 32:n||(n=e);break;default:r&&(r=n),e=!1}return!e&&(!r||!i)},e.printBlockString=function(t,e){const n=t.replace(/"""/g,'\\"""'),i=n.split(/\r\n|[\n\r]/g),o=1===i.length,s=i.length>1&&i.slice(1).every((t=>0===t.length||(0,r.isWhiteSpace)(t.charCodeAt(0)))),a=n.endsWith('\\"""'),l=t.endsWith('"')&&!a,c=t.endsWith("\\"),u=l||c,h=!(null!=e&&e.minimize)&&(!o||t.length>70||u||s||a);let d="";const p=o&&(0,r.isWhiteSpace)(t.charCodeAt(0));return(h&&!p||s)&&(d+="\n"),d+=n,(h||u)&&(d+="\n"),'"""'+d+'"""'};var r=n(100);function i(t){let e=0;for(;e<t.length&&(0,r.isWhiteSpace)(t.charCodeAt(e));)++e;return e}},100:(t,e)=>{"use strict";function n(t){return t>=48&&t<=57}function r(t){return t>=97&&t<=122||t>=65&&t<=90}Object.defineProperty(e,"__esModule",{value:!0}),e.isDigit=n,e.isLetter=r,e.isNameContinue=function(t){return r(t)||n(t)||95===t},e.isNameStart=function(t){return r(t)||95===t},e.isWhiteSpace=function(t){return 9===t||32===t}},2828:(t,e)=>{"use strict";let n;Object.defineProperty(e,"__esModule",{value:!0}),e.Kind=void 0,e.Kind=n,function(t){t.NAME="Name",t.DOCUMENT="Document",t.OPERATION_DEFINITION="OperationDefinition",t.VARIABLE_DEFINITION="VariableDefinition",t.SELECTION_SET="SelectionSet",t.FIELD="Field",t.ARGUMENT="Argument",t.FRAGMENT_SPREAD="FragmentSpread",t.INLINE_FRAGMENT="InlineFragment",t.FRAGMENT_DEFINITION="FragmentDefinition",t.VARIABLE="Variable",t.INT="IntValue",t.FLOAT="FloatValue",t.STRING="StringValue",t.BOOLEAN="BooleanValue",t.NULL="NullValue",t.ENUM="EnumValue",t.LIST="ListValue",t.OBJECT="ObjectValue",t.OBJECT_FIELD="ObjectField",t.DIRECTIVE="Directive",t.NAMED_TYPE="NamedType",t.LIST_TYPE="ListType",t.NON_NULL_TYPE="NonNullType",t.SCHEMA_DEFINITION="SchemaDefinition",t.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",t.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",t.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",t.FIELD_DEFINITION="FieldDefinition",t.INPUT_VALUE_DEFINITION="InputValueDefinition",t.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",t.UNION_TYPE_DEFINITION="UnionTypeDefinition",t.ENUM_TYPE_DEFINITION="EnumTypeDefinition",t.ENUM_VALUE_DEFINITION="EnumValueDefinition",t.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",t.DIRECTIVE_DEFINITION="DirectiveDefinition",t.SCHEMA_EXTENSION="SchemaExtension",t.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",t.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",t.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",t.UNION_TYPE_EXTENSION="UnionTypeExtension",t.ENUM_TYPE_EXTENSION="EnumTypeExtension",t.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(n||(e.Kind=n={}))},8942:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.printString=function(t){return`"${t.replace(n,r)}"`};const n=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function r(t){return i[t.charCodeAt(0)]}const i=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"]},3033:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.print=function(t){return(0,r.visit)(t,s)};var r=n(285),i=n(849),o=n(8942);const s={Name:{leave:t=>t.value},Variable:{leave:t=>"$"+t.name},Document:{leave:t=>a(t.definitions,"\n\n")},OperationDefinition:{leave(t){const e=c("(",a(t.variableDefinitions,", "),")"),n=a([t.operation,a([t.name,e]),a(t.directives," ")]," ");return("query"===n?"":n+" ")+t.selectionSet}},VariableDefinition:{leave:({variable:t,type:e,defaultValue:n,directives:r})=>t+": "+e+c(" = ",n)+c(" ",a(r," "))},SelectionSet:{leave:({selections:t})=>l(t)},Field:{leave({alias:t,name:e,arguments:n,directives:r,selectionSet:i}){const o=c("",t,": ")+e;let s=o+c("(",a(n,", "),")");return s.length>80&&(s=o+c("(\n",u(a(n,"\n")),"\n)")),a([s,a(r," "),i]," ")}},Argument:{leave:({name:t,value:e})=>t+": "+e},FragmentSpread:{leave:({name:t,directives:e})=>"..."+t+c(" ",a(e," "))},InlineFragment:{leave:({typeCondition:t,directives:e,selectionSet:n})=>a(["...",c("on ",t),a(e," "),n]," ")},FragmentDefinition:{leave:({name:t,typeCondition:e,variableDefinitions:n,directives:r,selectionSet:i})=>`fragment ${t}${c("(",a(n,", "),")")} on ${e} ${c("",a(r," ")," ")}`+i},IntValue:{leave:({value:t})=>t},FloatValue:{leave:({value:t})=>t},StringValue:{leave:({value:t,block:e})=>e?(0,i.printBlockString)(t):(0,o.printString)(t)},BooleanValue:{leave:({value:t})=>t?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:t})=>t},ListValue:{leave:({values:t})=>"["+a(t,", ")+"]"},ObjectValue:{leave:({fields:t})=>"{"+a(t,", ")+"}"},ObjectField:{leave:({name:t,value:e})=>t+": "+e},Directive:{leave:({name:t,arguments:e})=>"@"+t+c("(",a(e,", "),")")},NamedType:{leave:({name:t})=>t},ListType:{leave:({type:t})=>"["+t+"]"},NonNullType:{leave:({type:t})=>t+"!"},SchemaDefinition:{leave:({description:t,directives:e,operationTypes:n})=>c("",t,"\n")+a(["schema",a(e," "),l(n)]," ")},OperationTypeDefinition:{leave:({operation:t,type:e})=>t+": "+e},ScalarTypeDefinition:{leave:({description:t,name:e,directives:n})=>c("",t,"\n")+a(["scalar",e,a(n," ")]," ")},ObjectTypeDefinition:{leave:({description:t,name:e,interfaces:n,directives:r,fields:i})=>c("",t,"\n")+a(["type",e,c("implements ",a(n," & ")),a(r," "),l(i)]," ")},FieldDefinition:{leave:({description:t,name:e,arguments:n,type:r,directives:i})=>c("",t,"\n")+e+(h(n)?c("(\n",u(a(n,"\n")),"\n)"):c("(",a(n,", "),")"))+": "+r+c(" ",a(i," "))},InputValueDefinition:{leave:({description:t,name:e,type:n,defaultValue:r,directives:i})=>c("",t,"\n")+a([e+": "+n,c("= ",r),a(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:t,name:e,interfaces:n,directives:r,fields:i})=>c("",t,"\n")+a(["interface",e,c("implements ",a(n," & ")),a(r," "),l(i)]," ")},UnionTypeDefinition:{leave:({description:t,name:e,directives:n,types:r})=>c("",t,"\n")+a(["union",e,a(n," "),c("= ",a(r," | "))]," ")},EnumTypeDefinition:{leave:({description:t,name:e,directives:n,values:r})=>c("",t,"\n")+a(["enum",e,a(n," "),l(r)]," ")},EnumValueDefinition:{leave:({description:t,name:e,directives:n})=>c("",t,"\n")+a([e,a(n," ")]," ")},InputObjectTypeDefinition:{leave:({description:t,name:e,directives:n,fields:r})=>c("",t,"\n")+a(["input",e,a(n," "),l(r)]," ")},DirectiveDefinition:{leave:({description:t,name:e,arguments:n,repeatable:r,locations:i})=>c("",t,"\n")+"directive @"+e+(h(n)?c("(\n",u(a(n,"\n")),"\n)"):c("(",a(n,", "),")"))+(r?" repeatable":"")+" on "+a(i," | ")},SchemaExtension:{leave:({directives:t,operationTypes:e})=>a(["extend schema",a(t," "),l(e)]," ")},ScalarTypeExtension:{leave:({name:t,directives:e})=>a(["extend scalar",t,a(e," ")]," ")},ObjectTypeExtension:{leave:({name:t,interfaces:e,directives:n,fields:r})=>a(["extend type",t,c("implements ",a(e," & ")),a(n," "),l(r)]," ")},InterfaceTypeExtension:{leave:({name:t,interfaces:e,directives:n,fields:r})=>a(["extend interface",t,c("implements ",a(e," & ")),a(n," "),l(r)]," ")},UnionTypeExtension:{leave:({name:t,directives:e,types:n})=>a(["extend union",t,a(e," "),c("= ",a(n," | "))]," ")},EnumTypeExtension:{leave:({name:t,directives:e,values:n})=>a(["extend enum",t,a(e," "),l(n)]," ")},InputObjectTypeExtension:{leave:({name:t,directives:e,fields:n})=>a(["extend input",t,a(e," "),l(n)]," ")}};function a(t,e=""){var n;return null!==(n=null==t?void 0:t.filter((t=>t)).join(e))&&void 0!==n?n:""}function l(t){return c("{\n",u(a(t,"\n")),"\n}")}function c(t,e,n=""){return null!=e&&""!==e?t+e+n:""}function u(t){return c("  ",t.replace(/\n/g,"\n  "))}function h(t){var e;return null!==(e=null==t?void 0:t.some((t=>t.includes("\n"))))&&void 0!==e&&e}},285:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BREAK=void 0,e.getEnterLeaveForKind=l,e.getVisitFn=function(t,e,n){const{enter:r,leave:i}=l(t,e);return n?i:r},e.visit=function(t,e,n=o.QueryDocumentKeys){const c=new Map;for(const t of Object.values(s.Kind))c.set(t,l(e,t));let u,h,d,p,f=Array.isArray(t),m=[t],g=-1,y=[];const v=[],_=[];let w=t;do{g++;const t=g===m.length,s=t&&0!==y.length;if(t){if(d=0===_.length?void 0:v[v.length-1],h=p,p=_.pop(),s)if(f){h=h.slice();let t=0;for(const[e,n]of y){const r=e-t;null===n?(h.splice(r,1),t++):h[r]=n}}else{h=Object.defineProperties({},Object.getOwnPropertyDescriptors(h));for(const[t,e]of y)h[t]=e}g=u.index,m=u.keys,y=u.edits,f=u.inArray,u=u.prev}else{if(d=p?f?g:m[g]:void 0,h=p?p[d]:w,null==h)continue;p&&v.push(d)}let l;if(!Array.isArray(h)){var b,x;(0,o.isNode)(h)||(0,i.devAssert)(!1,`Invalid AST Node: ${(0,r.inspect)(h)}.`);const n=t?null===(b=c.get(h.kind))||void 0===b?void 0:b.leave:null===(x=c.get(h.kind))||void 0===x?void 0:x.enter;if(l=null==n?void 0:n.call(e,h,d,p,v,_),l===a)break;if(!1===l){if(!t){v.pop();continue}}else if(void 0!==l&&(y.push([d,l]),!t)){if(!(0,o.isNode)(l)){v.pop();continue}h=l}}var E;void 0===l&&s&&y.push([d,h]),t?v.pop():(u={inArray:f,index:g,keys:m,edits:y,prev:u},f=Array.isArray(h),m=f?h:null!==(E=n[h.kind])&&void 0!==E?E:[],g=-1,y=[],p&&_.push(p),p=h)}while(void 0!==u);return 0!==y.length&&(w=y[y.length-1][1]),w},e.visitInParallel=function(t){const e=new Array(t.length).fill(null),n=Object.create(null);for(const r of Object.values(s.Kind)){let i=!1;const o=new Array(t.length).fill(void 0),s=new Array(t.length).fill(void 0);for(let e=0;e<t.length;++e){const{enter:n,leave:a}=l(t[e],r);i||(i=null!=n||null!=a),o[e]=n,s[e]=a}if(!i)continue;const c={enter(...n){const r=n[0];for(let s=0;s<t.length;s++)if(null===e[s]){var i;const l=null===(i=o[s])||void 0===i?void 0:i.apply(t[s],n);if(!1===l)e[s]=r;else if(l===a)e[s]=a;else if(void 0!==l)return l}},leave(...n){const r=n[0];for(let o=0;o<t.length;o++)if(null===e[o]){var i;const r=null===(i=s[o])||void 0===i?void 0:i.apply(t[o],n);if(r===a)e[o]=a;else if(void 0!==r&&!1!==r)return r}else e[o]===r&&(e[o]=null)}};n[r]=c}return n};var r=n(8002),i=n(7242),o=n(1807),s=n(2828);const a=Object.freeze({});function l(t,e){const n=t[e];return"object"==typeof n?n:"function"==typeof n?{enter:n,leave:void 0}:{enter:t.enter,leave:t.leave}}e.BREAK=a},3349:(t,e,n)=>{"use strict";var r=n(9509).Buffer,i=n(8473).Transform;function o(t){i.call(this),this._block=r.allocUnsafe(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}n(5717)(o,i),o.prototype._transform=function(t,e,n){var r=null;try{this.update(t,e)}catch(t){r=t}n(r)},o.prototype._flush=function(t){var e=null;try{this.push(this.digest())}catch(t){e=t}t(e)},o.prototype.update=function(t,e){if(function(t,e){if(!r.isBuffer(t)&&"string"!=typeof t)throw new TypeError("Data must be a string or a buffer")}(t),this._finalized)throw new Error("Digest already called");r.isBuffer(t)||(t=r.from(t,e));for(var n=this._block,i=0;this._blockOffset+t.length-i>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)n[o++]=t[i++];this._update(),this._blockOffset=0}for(;i<t.length;)n[this._blockOffset++]=t[i++];for(var s=0,a=8*t.length;a>0;++s)this._length[s]+=a,(a=this._length[s]/4294967296|0)>0&&(this._length[s]-=4294967296*a);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();void 0!==t&&(e=e.toString(t)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return e},o.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=o},645:(t,e)=>{e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1,p=t[e+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+t[e+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+t[e+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=f,s/=256,c-=8);t[n+p-f]|=128*m}},5717:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},2318:(t,e,n)=>{"use strict";var r=n(5717),i=n(3349),o=n(9509).Buffer,s=new Array(16);function a(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function l(t,e){return t<<e|t>>>32-e}function c(t,e,n,r,i,o,s){return l(t+(e&n|~e&r)+i+o|0,s)+e|0}function u(t,e,n,r,i,o,s){return l(t+(e&r|n&~r)+i+o|0,s)+e|0}function h(t,e,n,r,i,o,s){return l(t+(e^n^r)+i+o|0,s)+e|0}function d(t,e,n,r,i,o,s){return l(t+(n^(e|~r))+i+o|0,s)+e|0}r(a,i),a.prototype._update=function(){for(var t=s,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var n=this._a,r=this._b,i=this._c,o=this._d;n=c(n,r,i,o,t[0],3614090360,7),o=c(o,n,r,i,t[1],3905402710,12),i=c(i,o,n,r,t[2],606105819,17),r=c(r,i,o,n,t[3],3250441966,22),n=c(n,r,i,o,t[4],4118548399,7),o=c(o,n,r,i,t[5],1200080426,12),i=c(i,o,n,r,t[6],2821735955,17),r=c(r,i,o,n,t[7],4249261313,22),n=c(n,r,i,o,t[8],1770035416,7),o=c(o,n,r,i,t[9],2336552879,12),i=c(i,o,n,r,t[10],4294925233,17),r=c(r,i,o,n,t[11],2304563134,22),n=c(n,r,i,o,t[12],1804603682,7),o=c(o,n,r,i,t[13],4254626195,12),i=c(i,o,n,r,t[14],2792965006,17),n=u(n,r=c(r,i,o,n,t[15],1236535329,22),i,o,t[1],4129170786,5),o=u(o,n,r,i,t[6],3225465664,9),i=u(i,o,n,r,t[11],643717713,14),r=u(r,i,o,n,t[0],3921069994,20),n=u(n,r,i,o,t[5],3593408605,5),o=u(o,n,r,i,t[10],38016083,9),i=u(i,o,n,r,t[15],3634488961,14),r=u(r,i,o,n,t[4],3889429448,20),n=u(n,r,i,o,t[9],568446438,5),o=u(o,n,r,i,t[14],3275163606,9),i=u(i,o,n,r,t[3],4107603335,14),r=u(r,i,o,n,t[8],1163531501,20),n=u(n,r,i,o,t[13],2850285829,5),o=u(o,n,r,i,t[2],4243563512,9),i=u(i,o,n,r,t[7],1735328473,14),n=h(n,r=u(r,i,o,n,t[12],2368359562,20),i,o,t[5],4294588738,4),o=h(o,n,r,i,t[8],2272392833,11),i=h(i,o,n,r,t[11],1839030562,16),r=h(r,i,o,n,t[14],4259657740,23),n=h(n,r,i,o,t[1],2763975236,4),o=h(o,n,r,i,t[4],1272893353,11),i=h(i,o,n,r,t[7],4139469664,16),r=h(r,i,o,n,t[10],3200236656,23),n=h(n,r,i,o,t[13],681279174,4),o=h(o,n,r,i,t[0],3936430074,11),i=h(i,o,n,r,t[3],3572445317,16),r=h(r,i,o,n,t[6],76029189,23),n=h(n,r,i,o,t[9],3654602809,4),o=h(o,n,r,i,t[12],3873151461,11),i=h(i,o,n,r,t[15],530742520,16),n=d(n,r=h(r,i,o,n,t[2],3299628645,23),i,o,t[0],4096336452,6),o=d(o,n,r,i,t[7],1126891415,10),i=d(i,o,n,r,t[14],2878612391,15),r=d(r,i,o,n,t[5],4237533241,21),n=d(n,r,i,o,t[12],1700485571,6),o=d(o,n,r,i,t[3],2399980690,10),i=d(i,o,n,r,t[10],4293915773,15),r=d(r,i,o,n,t[1],2240044497,21),n=d(n,r,i,o,t[8],1873313359,6),o=d(o,n,r,i,t[15],4264355552,10),i=d(i,o,n,r,t[6],2734768916,15),r=d(r,i,o,n,t[13],1309151649,21),n=d(n,r,i,o,t[4],4149444226,6),o=d(o,n,r,i,t[11],3174756917,10),i=d(i,o,n,r,t[2],718787259,15),r=d(r,i,o,n,t[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+o|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=o.allocUnsafe(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t},t.exports=a},6192:(t,e)=>{var n,r,i=function(){var t=function(t,e){var n=t,r=s[e],i=null,o=0,l=null,g=[],y={},_=function(t,e){i=function(t){for(var e=new Array(t),n=0;n<t;n+=1){e[n]=new Array(t);for(var r=0;r<t;r+=1)e[n][r]=null}return e}(o=4*n+17),w(0,0),w(o-7,0),w(0,o-7),x(),b(),S(t,e),n>=7&&E(t),null==l&&(l=T(n,r,g)),M(l,e)},w=function(t,e){for(var n=-1;n<=7;n+=1)if(!(t+n<=-1||o<=t+n))for(var r=-1;r<=7;r+=1)e+r<=-1||o<=e+r||(i[t+n][e+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},b=function(){for(var t=8;t<o-8;t+=1)null==i[t][6]&&(i[t][6]=t%2==0);for(var e=8;e<o-8;e+=1)null==i[6][e]&&(i[6][e]=e%2==0)},x=function(){for(var t=a.getPatternPosition(n),e=0;e<t.length;e+=1)for(var r=0;r<t.length;r+=1){var o=t[e],s=t[r];if(null==i[o][s])for(var l=-2;l<=2;l+=1)for(var c=-2;c<=2;c+=1)i[o+l][s+c]=-2==l||2==l||-2==c||2==c||0==l&&0==c}},E=function(t){for(var e=a.getBCHTypeNumber(n),r=0;r<18;r+=1){var s=!t&&1==(e>>r&1);i[Math.floor(r/3)][r%3+o-8-3]=s}for(r=0;r<18;r+=1)s=!t&&1==(e>>r&1),i[r%3+o-8-3][Math.floor(r/3)]=s},S=function(t,e){for(var n=r<<3|e,s=a.getBCHTypeInfo(n),l=0;l<15;l+=1){var c=!t&&1==(s>>l&1);l<6?i[l][8]=c:l<8?i[l+1][8]=c:i[o-15+l][8]=c}for(l=0;l<15;l+=1)c=!t&&1==(s>>l&1),l<8?i[8][o-l-1]=c:l<9?i[8][15-l-1+1]=c:i[8][15-l-1]=c;i[o-8][8]=!t},M=function(t,e){for(var n=-1,r=o-1,s=7,l=0,c=a.getMaskFunction(e),u=o-1;u>0;u-=2)for(6==u&&(u-=1);;){for(var h=0;h<2;h+=1)if(null==i[r][u-h]){var d=!1;l<t.length&&(d=1==(t[l]>>>s&1)),c(r,u-h)&&(d=!d),i[r][u-h]=d,-1==(s-=1)&&(l+=1,s=7)}if((r+=n)<0||o<=r){r-=n,n=-n;break}}},T=function(t,e,n){for(var r=u.getRSBlocks(t,e),i=h(),o=0;o<n.length;o+=1){var s=n[o];i.put(s.getMode(),4),i.put(s.getLength(),a.getLengthInBits(s.getMode(),t)),s.write(i)}var l=0;for(o=0;o<r.length;o+=1)l+=r[o].dataCount;if(i.getLengthInBits()>8*l)throw"code length overflow. ("+i.getLengthInBits()+">"+8*l+")";for(i.getLengthInBits()+4<=8*l&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=8*l||(i.put(236,8),i.getLengthInBits()>=8*l));)i.put(17,8);return function(t,e){for(var n=0,r=0,i=0,o=new Array(e.length),s=new Array(e.length),l=0;l<e.length;l+=1){var u=e[l].dataCount,h=e[l].totalCount-u;r=Math.max(r,u),i=Math.max(i,h),o[l]=new Array(u);for(var d=0;d<o[l].length;d+=1)o[l][d]=255&t.getBuffer()[d+n];n+=u;var p=a.getErrorCorrectPolynomial(h),f=c(o[l],p.getLength()-1).mod(p);for(s[l]=new Array(p.getLength()-1),d=0;d<s[l].length;d+=1){var m=d+f.getLength()-s[l].length;s[l][d]=m>=0?f.getAt(m):0}}var g=0;for(d=0;d<e.length;d+=1)g+=e[d].totalCount;var y=new Array(g),v=0;for(d=0;d<r;d+=1)for(l=0;l<e.length;l+=1)d<o[l].length&&(y[v]=o[l][d],v+=1);for(d=0;d<i;d+=1)for(l=0;l<e.length;l+=1)d<s[l].length&&(y[v]=s[l][d],v+=1);return y}(i,r)};y.addData=function(t,e){var n=null;switch(e=e||"Byte"){case"Numeric":n=d(t);break;case"Alphanumeric":n=p(t);break;case"Byte":n=f(t);break;case"Kanji":n=m(t);break;default:throw"mode:"+e}g.push(n),l=null},y.isDark=function(t,e){if(t<0||o<=t||e<0||o<=e)throw t+","+e;return i[t][e]},y.getModuleCount=function(){return o},y.make=function(){if(n<1){for(var t=1;t<40;t++){for(var e=u.getRSBlocks(t,r),i=h(),o=0;o<g.length;o++){var s=g[o];i.put(s.getMode(),4),i.put(s.getLength(),a.getLengthInBits(s.getMode(),t)),s.write(i)}var l=0;for(o=0;o<e.length;o++)l+=e[o].dataCount;if(i.getLengthInBits()<=8*l)break}n=t}_(!1,function(){for(var t=0,e=0,n=0;n<8;n+=1){_(!0,n);var r=a.getLostPoint(y);(0==n||t>r)&&(t=r,e=n)}return e}())},y.createTableTag=function(t,e){t=t||2;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: "+(e=void 0===e?4*t:e)+"px;",n+='">',n+="<tbody>";for(var r=0;r<y.getModuleCount();r+=1){n+="<tr>";for(var i=0;i<y.getModuleCount();i+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+t+"px;",n+=" height: "+t+"px;",n+=" background-color: ",n+=y.isDark(r,i)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return(n+="</tbody>")+"</table>"},y.createSvgTag=function(t,e,n,r){var i={};"object"==typeof arguments[0]&&(t=(i=arguments[0]).cellSize,e=i.margin,n=i.alt,r=i.title),t=t||2,e=void 0===e?4*t:e,(n="string"==typeof n?{text:n}:n||{}).text=n.text||null,n.id=n.text?n.id||"qrcode-description":null,(r="string"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||"qrcode-title":null;var o,s,a,l,c=y.getModuleCount()*t+2*e,u="";for(l="l"+t+",0 0,"+t+" -"+t+",0 0,-"+t+"z ",u+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',u+=i.scalable?"":' width="'+c+'px" height="'+c+'px"',u+=' viewBox="0 0 '+c+" "+c+'" ',u+=' preserveAspectRatio="xMinYMin meet"',u+=r.text||n.text?' role="img" aria-labelledby="'+A([r.id,n.id].join(" ").trim())+'"':"",u+=">",u+=r.text?'<title id="'+A(r.id)+'">'+A(r.text)+"</title>":"",u+=n.text?'<description id="'+A(n.id)+'">'+A(n.text)+"</description>":"",u+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',u+='<path d="',s=0;s<y.getModuleCount();s+=1)for(a=s*t+e,o=0;o<y.getModuleCount();o+=1)y.isDark(s,o)&&(u+="M"+(o*t+e)+","+a+l);return(u+='" stroke="transparent" fill="black"/>')+"</svg>"},y.createDataURL=function(t,e){t=t||2,e=void 0===e?4*t:e;var n=y.getModuleCount()*t+2*e,r=e,i=n-e;return v(n,n,(function(e,n){if(r<=e&&e<i&&r<=n&&n<i){var o=Math.floor((e-r)/t),s=Math.floor((n-r)/t);return y.isDark(s,o)?0:1}return 1}))},y.createImgTag=function(t,e,n){t=t||2,e=void 0===e?4*t:e;var r=y.getModuleCount()*t+2*e,i="";return i+="<img",i+=' src="',i+=y.createDataURL(t,e),i+='"',i+=' width="',i+=r,i+='"',i+=' height="',i+=r,i+='"',n&&(i+=' alt="',i+=A(n),i+='"'),i+"/>"};var A=function(t){for(var e="",n=0;n<t.length;n+=1){var r=t.charAt(n);switch(r){case"<":e+="&lt;";break;case">":e+="&gt;";break;case"&":e+="&amp;";break;case'"':e+="&quot;";break;default:e+=r}}return e};return y.createASCII=function(t,e){if((t=t||1)<2)return function(t){t=void 0===t?2:t;var e,n,r,i,o,s=1*y.getModuleCount()+2*t,a=t,l=s-t,c={"██":"█","█ ":"▀"," █":"▄","  ":" "},u={"██":"▀","█ ":"▀"," █":" ","  ":" "},h="";for(e=0;e<s;e+=2){for(r=Math.floor((e-a)/1),i=Math.floor((e+1-a)/1),n=0;n<s;n+=1)o="█",a<=n&&n<l&&a<=e&&e<l&&y.isDark(r,Math.floor((n-a)/1))&&(o=" "),a<=n&&n<l&&a<=e+1&&e+1<l&&y.isDark(i,Math.floor((n-a)/1))?o+=" ":o+="█",h+=t<1&&e+1>=l?u[o]:c[o];h+="\n"}return s%2&&t>0?h.substring(0,h.length-s-1)+Array(s+1).join("▀"):h.substring(0,h.length-1)}(e);t-=1,e=void 0===e?2*t:e;var n,r,i,o,s=y.getModuleCount()*t+2*e,a=e,l=s-e,c=Array(t+1).join("██"),u=Array(t+1).join("  "),h="",d="";for(n=0;n<s;n+=1){for(i=Math.floor((n-a)/t),d="",r=0;r<s;r+=1)o=1,a<=r&&r<l&&a<=n&&n<l&&y.isDark(i,Math.floor((r-a)/t))&&(o=0),d+=o?c:u;for(i=0;i<t;i+=1)h+=d+"\n"}return h.substring(0,h.length-1)},y.renderTo2dContext=function(t,e){e=e||2;for(var n=y.getModuleCount(),r=0;r<n;r++)for(var i=0;i<n;i++)t.fillStyle=y.isDark(r,i)?"black":"white",t.fillRect(r*e,i*e,e,e)},y};t.stringToBytes=(t.stringToBytesFuncs={default:function(t){for(var e=[],n=0;n<t.length;n+=1){var r=t.charCodeAt(n);e.push(255&r)}return e}}).default,t.createStringToBytes=function(t,e){var n=function(){for(var n=y(t),r=function(){var t=n.read();if(-1==t)throw"eof";return t},i=0,o={};;){var s=n.read();if(-1==s)break;var a=r(),l=r()<<8|r();o[String.fromCharCode(s<<8|a)]=l,i+=1}if(i!=e)throw i+" != "+e;return o}(),r="?".charCodeAt(0);return function(t){for(var e=[],i=0;i<t.length;i+=1){var o=t.charCodeAt(i);if(o<128)e.push(o);else{var s=n[t.charAt(i)];"number"==typeof s?(255&s)==s?e.push(s):(e.push(s>>>8),e.push(255&s)):e.push(r)}}return e}};var e,n,r,i,o,s={L:1,M:0,Q:3,H:2},a=(e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,r=7973,o=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},(i={}).getBCHTypeInfo=function(t){for(var e=t<<10;o(e)-o(n)>=0;)e^=n<<o(e)-o(n);return 21522^(t<<10|e)},i.getBCHTypeNumber=function(t){for(var e=t<<12;o(e)-o(r)>=0;)e^=r<<o(e)-o(r);return t<<12|e},i.getPatternPosition=function(t){return e[t-1]},i.getMaskFunction=function(t){switch(t){case 0:return function(t,e){return(t+e)%2==0};case 1:return function(t,e){return t%2==0};case 2:return function(t,e){return e%3==0};case 3:return function(t,e){return(t+e)%3==0};case 4:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case 5:return function(t,e){return t*e%2+t*e%3==0};case 6:return function(t,e){return(t*e%2+t*e%3)%2==0};case 7:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw"bad maskPattern:"+t}},i.getErrorCorrectPolynomial=function(t){for(var e=c([1],0),n=0;n<t;n+=1)e=e.multiply(c([1,l.gexp(n)],0));return e},i.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+t}else if(e<27)switch(t){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+t}else{if(!(e<41))throw"type:"+e;switch(t){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+t}}},i.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r+=1)for(var i=0;i<e;i+=1){for(var o=0,s=t.isDark(r,i),a=-1;a<=1;a+=1)if(!(r+a<0||e<=r+a))for(var l=-1;l<=1;l+=1)i+l<0||e<=i+l||0==a&&0==l||s==t.isDark(r+a,i+l)&&(o+=1);o>5&&(n+=3+o-5)}for(r=0;r<e-1;r+=1)for(i=0;i<e-1;i+=1){var c=0;t.isDark(r,i)&&(c+=1),t.isDark(r+1,i)&&(c+=1),t.isDark(r,i+1)&&(c+=1),t.isDark(r+1,i+1)&&(c+=1),0!=c&&4!=c||(n+=3)}for(r=0;r<e;r+=1)for(i=0;i<e-6;i+=1)t.isDark(r,i)&&!t.isDark(r,i+1)&&t.isDark(r,i+2)&&t.isDark(r,i+3)&&t.isDark(r,i+4)&&!t.isDark(r,i+5)&&t.isDark(r,i+6)&&(n+=40);for(i=0;i<e;i+=1)for(r=0;r<e-6;r+=1)t.isDark(r,i)&&!t.isDark(r+1,i)&&t.isDark(r+2,i)&&t.isDark(r+3,i)&&t.isDark(r+4,i)&&!t.isDark(r+5,i)&&t.isDark(r+6,i)&&(n+=40);var u=0;for(i=0;i<e;i+=1)for(r=0;r<e;r+=1)t.isDark(r,i)&&(u+=1);return n+Math.abs(100*u/e/e-50)/5*10},i),l=function(){for(var t=new Array(256),e=new Array(256),n=0;n<8;n+=1)t[n]=1<<n;for(n=8;n<256;n+=1)t[n]=t[n-4]^t[n-5]^t[n-6]^t[n-8];for(n=0;n<255;n+=1)e[t[n]]=n;return{glog:function(t){if(t<1)throw"glog("+t+")";return e[t]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t[e]}}}();function c(t,e){if(void 0===t.length)throw t.length+"/"+e;var n=function(){for(var n=0;n<t.length&&0==t[n];)n+=1;for(var r=new Array(t.length-n+e),i=0;i<t.length-n;i+=1)r[i]=t[i+n];return r}(),r={getAt:function(t){return n[t]},getLength:function(){return n.length},multiply:function(t){for(var e=new Array(r.getLength()+t.getLength()-1),n=0;n<r.getLength();n+=1)for(var i=0;i<t.getLength();i+=1)e[n+i]^=l.gexp(l.glog(r.getAt(n))+l.glog(t.getAt(i)));return c(e,0)},mod:function(t){if(r.getLength()-t.getLength()<0)return r;for(var e=l.glog(r.getAt(0))-l.glog(t.getAt(0)),n=new Array(r.getLength()),i=0;i<r.getLength();i+=1)n[i]=r.getAt(i);for(i=0;i<t.getLength();i+=1)n[i]^=l.gexp(l.glog(t.getAt(i))+e);return c(n,0).mod(t)}};return r}var u=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var n={};return n.totalCount=t,n.dataCount=e,n},n={getRSBlocks:function(n,r){var i=function(e,n){switch(n){case s.L:return t[4*(e-1)+0];case s.M:return t[4*(e-1)+1];case s.Q:return t[4*(e-1)+2];case s.H:return t[4*(e-1)+3];default:return}}(n,r);if(void 0===i)throw"bad rs block @ typeNumber:"+n+"/errorCorrectionLevel:"+r;for(var o=i.length/3,a=[],l=0;l<o;l+=1)for(var c=i[3*l+0],u=i[3*l+1],h=i[3*l+2],d=0;d<c;d+=1)a.push(e(u,h));return a}};return n}(),h=function(){var t=[],e=0,n={getBuffer:function(){return t},getAt:function(e){var n=Math.floor(e/8);return 1==(t[n]>>>7-e%8&1)},put:function(t,e){for(var r=0;r<e;r+=1)n.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return e},putBit:function(n){var r=Math.floor(e/8);t.length<=r&&t.push(0),n&&(t[r]|=128>>>e%8),e+=1}};return n},d=function(t){var e=t,n={getMode:function(){return 1},getLength:function(t){return e.length},write:function(t){for(var n=e,i=0;i+2<n.length;)t.put(r(n.substring(i,i+3)),10),i+=3;i<n.length&&(n.length-i==1?t.put(r(n.substring(i,i+1)),4):n.length-i==2&&t.put(r(n.substring(i,i+2)),7))}},r=function(t){for(var e=0,n=0;n<t.length;n+=1)e=10*e+i(t.charAt(n));return e},i=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+t};return n},p=function(t){var e=t,n={getMode:function(){return 2},getLength:function(t){return e.length},write:function(t){for(var n=e,i=0;i+1<n.length;)t.put(45*r(n.charAt(i))+r(n.charAt(i+1)),11),i+=2;i<n.length&&t.put(r(n.charAt(i)),6)}},r=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("A"<=t&&t<="Z")return t.charCodeAt(0)-"A".charCodeAt(0)+10;switch(t){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+t}};return n},f=function(e){var n=t.stringToBytes(e);return{getMode:function(){return 4},getLength:function(t){return n.length},write:function(t){for(var e=0;e<n.length;e+=1)t.put(n[e],8)}}},m=function(e){var n=t.stringToBytesFuncs.SJIS;if(!n)throw"sjis not supported.";!function(t,e){var r=n("友");if(2!=r.length||38726!=(r[0]<<8|r[1]))throw"sjis not supported."}();var r=n(e),i={getMode:function(){return 8},getLength:function(t){return~~(r.length/2)},write:function(t){for(var e=r,n=0;n+1<e.length;){var i=(255&e[n])<<8|255&e[n+1];if(33088<=i&&i<=40956)i-=33088;else{if(!(57408<=i&&i<=60351))throw"illegal char at "+(n+1)+"/"+i;i-=49472}i=192*(i>>>8&255)+(255&i),t.put(i,13),n+=2}if(n<e.length)throw"illegal char at "+(n+1)}};return i},g=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,n,r){n=n||0,r=r||t.length;for(var i=0;i<r;i+=1)e.writeByte(t[i+n])},writeString:function(t){for(var n=0;n<t.length;n+=1)e.writeByte(t.charCodeAt(n))},toByteArray:function(){return t},toString:function(){var e="";e+="[";for(var n=0;n<t.length;n+=1)n>0&&(e+=","),e+=t[n];return e+"]"}};return e},y=function(t){var e=t,n=0,r=0,i=0,o={read:function(){for(;i<8;){if(n>=e.length){if(0==i)return-1;throw"unexpected end of file./"+i}var t=e.charAt(n);if(n+=1,"="==t)return i=0,-1;t.match(/^\s$/)||(r=r<<6|s(t.charCodeAt(0)),i+=6)}var o=r>>>i-8&255;return i-=8,o}},s=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw"c:"+t};return o},v=function(t,e,n){for(var r=function(t,e){var n=t,r=e,i=new Array(t*e),o={setPixel:function(t,e,r){i[e*n+t]=r},write:function(t){t.writeString("GIF87a"),t.writeShort(n),t.writeShort(r),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(n),t.writeShort(r),t.writeByte(0);var e=s(2);t.writeByte(2);for(var i=0;e.length-i>255;)t.writeByte(255),t.writeBytes(e,i,255),i+=255;t.writeByte(e.length-i),t.writeBytes(e,i,e.length-i),t.writeByte(0),t.writeString(";")}},s=function(t){for(var e=1<<t,n=1+(1<<t),r=t+1,o=a(),s=0;s<e;s+=1)o.add(String.fromCharCode(s));o.add(String.fromCharCode(e)),o.add(String.fromCharCode(n));var l,c,u,h=g(),d=(l=h,c=0,u=0,{write:function(t,e){if(t>>>e!=0)throw"length over";for(;c+e>=8;)l.writeByte(255&(t<<c|u)),e-=8-c,t>>>=8-c,u=0,c=0;u|=t<<c,c+=e},flush:function(){c>0&&l.writeByte(u)}});d.write(e,r);var p=0,f=String.fromCharCode(i[p]);for(p+=1;p<i.length;){var m=String.fromCharCode(i[p]);p+=1,o.contains(f+m)?f+=m:(d.write(o.indexOf(f),r),o.size()<4095&&(o.size()==1<<r&&(r+=1),o.add(f+m)),f=m)}return d.write(o.indexOf(f),r),d.write(n,r),d.flush(),h.toByteArray()},a=function(){var t={},e=0,n={add:function(r){if(n.contains(r))throw"dup key:"+r;t[r]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return void 0!==t[e]}};return n};return o}(t,e),i=0;i<e;i+=1)for(var o=0;o<t;o+=1)r.setPixel(o,i,n(o,i));var s=g();r.write(s);for(var a=function(){var t=0,e=0,n=0,r="",i={},o=function(t){r+=String.fromCharCode(s(63&t))},s=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw"n:"+t};return i.writeByte=function(r){for(t=t<<8|255&r,e+=8,n+=1;e>=6;)o(t>>>e-6),e-=6},i.flush=function(){if(e>0&&(o(t<<6-e),t=0,e=0),n%3!=0)for(var i=3-n%3,s=0;s<i;s+=1)r+="="},i.toString=function(){return r},i}(),l=s.toByteArray(),c=0;c<l.length;c+=1)a.writeByte(l[c]);return a.flush(),"data:image/gif;base64,"+a};return t}();i.stringToBytesFuncs["UTF-8"]=function(t){return function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}(t)},void 0===(r="function"==typeof(n=function(){return i})?n.apply(e,[]):n)||(t.exports=r)},4281:t=>{"use strict";var e={};function n(t,n,r){r||(r=Error);var i=function(t){var e,r;function i(e,r,i){return t.call(this,function(t,e,r){return"string"==typeof n?n:n(t,e,r)}(e,r,i))||this}return r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=t,e[t]=i}function r(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map((function(t){return String(t)})),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}n("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(t,e,n){var i,o,s,a,l;if("string"==typeof e&&(o="not ",e.substr(0,o.length)===o)?(i="must not be",e=e.replace(/^not /,"")):i="must be",function(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}(t," argument"))s="The ".concat(t," ").concat(i," ").concat(r(e,"type"));else{var c=("number"!=typeof l&&(l=0),l+".".length>(a=t).length||-1===a.indexOf(".",l)?"argument":"property");s='The "'.concat(t,'" ').concat(c," ").concat(i," ").concat(r(e,"type"))}return s+". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.q=e},6753:(t,e,n)=>{"use strict";var r=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=c;var i=n(9481),o=n(4229);n(5717)(c,i);for(var s=r(o.prototype),a=0;a<s.length;a++){var l=s[a];c.prototype[l]||(c.prototype[l]=o.prototype[l])}function c(t){if(!(this instanceof c))return new c(t);i.call(this,t),o.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||process.nextTick(h,this)}function h(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})},2725:(t,e,n)=>{"use strict";t.exports=i;var r=n(4605);function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}n(5717)(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},9481:(t,e,n)=>{"use strict";var r;t.exports=S,S.ReadableState=E,n(7187).EventEmitter;var i,o=function(t,e){return t.listeners(e).length},s=n(2503),a=n(8764).Buffer,l=n.g.Uint8Array||function(){},c=n(4616);i=c&&c.debuglog?c.debuglog("stream"):function(){};var u,h,d,p=n(7327),f=n(1195),m=n(2457).getHighWaterMark,g=n(4281).q,y=g.ERR_INVALID_ARG_TYPE,v=g.ERR_STREAM_PUSH_AFTER_EOF,_=g.ERR_METHOD_NOT_IMPLEMENTED,w=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(5717)(S,s);var b=f.errorOrDestroy,x=["error","close","destroy","pause","resume"];function E(t,e,i){r=r||n(6753),t=t||{},"boolean"!=typeof i&&(i=e instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(u||(u=n(2553).s),this.decoder=new u(t.encoding),this.encoding=t.encoding)}function S(t){if(r=r||n(6753),!(this instanceof S))return new S(t);var e=this instanceof r;this._readableState=new E(t,this,e),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function M(t,e,n,r,o){i("readableAddChunk",e);var s,c=t._readableState;if(null===e)c.reading=!1,function(t,e){if(i("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?L(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,C(t)))}}(t,c);else if(o||(s=function(t,e){var n,r;return r=e,a.isBuffer(r)||r instanceof l||"string"==typeof e||void 0===e||t.objectMode||(n=new y("chunk",["string","Buffer","Uint8Array"],e)),n}(c,e)),s)b(t,s);else if(c.objectMode||e&&e.length>0)if("string"==typeof e||c.objectMode||Object.getPrototypeOf(e)===a.prototype||(e=function(t){return a.from(t)}(e)),r)c.endEmitted?b(t,new w):T(t,c,e,!0);else if(c.ended)b(t,new v);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!n?(e=c.decoder.write(e),c.objectMode||0!==e.length?T(t,c,e,!1):P(t,c)):T(t,c,e,!1)}else r||(c.reading=!1,P(t,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function T(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&L(t)),P(t,e)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),S.prototype.destroy=f.destroy,S.prototype._undestroy=f.undestroy,S.prototype._destroy=function(t,e){e(t)},S.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=a.from(t,e),e=""),n=!0),M(this,t,e,!1,n)},S.prototype.unshift=function(t){return M(this,t,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(t){u||(u=n(2553).s);var e=new u(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var A=1073741824;function R(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=A?t=A:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function L(t){var e=t._readableState;i("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(i("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(C,t))}function C(t){var e=t._readableState;i("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,D(t)}function P(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(I,t,e))}function I(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var n=e.length;if(i("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function O(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function N(t){i("readable nexttick read 0"),t.read(0)}function k(t,e){i("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),D(t),e.flowing&&!e.reading&&t.read(0)}function D(t){var e=t._readableState;for(i("flow",e.flowing);e.flowing&&null!==t.read(););}function B(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function U(t){var e=t._readableState;i("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(z,e,t))}function z(t,e){if(i("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function F(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}S.prototype.read=function(t){i("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return i("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?U(this):L(this),null;if(0===(t=R(t,e))&&e.ended)return 0===e.length&&U(this),null;var r,o=e.needReadable;return i("need readable",o),(0===e.length||e.length-t<e.highWaterMark)&&i("length less than watermark",o=!0),e.ended||e.reading?i("reading or ended",o=!1):o&&(i("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=R(n,e))),null===(r=t>0?B(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&U(this)),null!==r&&this.emit("data",r),r},S.prototype._read=function(t){b(this,new _("_read()"))},S.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t)}r.pipesCount+=1,i("pipe count=%d opts=%j",r.pipesCount,e);var s=e&&!1===e.end||t===process.stdout||t===process.stderr?f:a;function a(){i("onend"),t.end()}r.endEmitted?process.nextTick(s):n.once("end",s),t.on("unpipe",(function e(o,s){i("onunpipe"),o===n&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,i("cleanup"),t.removeListener("close",d),t.removeListener("finish",p),t.removeListener("drain",l),t.removeListener("error",h),t.removeListener("unpipe",e),n.removeListener("end",a),n.removeListener("end",f),n.removeListener("data",u),c=!0,!r.awaitDrain||t._writableState&&!t._writableState.needDrain||l())}));var l=function(t){return function(){var e=t._readableState;i("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,D(t))}}(n);t.on("drain",l);var c=!1;function u(e){i("ondata");var o=t.write(e);i("dest.write",o),!1===o&&((1===r.pipesCount&&r.pipes===t||r.pipesCount>1&&-1!==F(r.pipes,t))&&!c&&(i("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function h(e){i("onerror",e),f(),t.removeListener("error",h),0===o(t,"error")&&b(t,e)}function d(){t.removeListener("finish",p),f()}function p(){i("onfinish"),t.removeListener("close",d),f()}function f(){i("unpipe"),n.unpipe(t)}return n.on("data",u),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(n):t._events.error=[n,t._events.error]:t.on(e,n)}(t,"error",h),t.once("close",d),t.once("finish",p),t.emit("pipe",n),r.flowing||(i("pipe resume"),n.resume()),t},S.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=F(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},S.prototype.on=function(t,e){var n=s.prototype.on.call(this,t,e),r=this._readableState;return"data"===t?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===t&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,i("on readable",r.length,r.reading),r.length?L(this):r.reading||process.nextTick(N,this))),n},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(t,e){var n=s.prototype.removeListener.call(this,t,e);return"readable"===t&&process.nextTick(O,this),n},S.prototype.removeAllListeners=function(t){var e=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||process.nextTick(O,this),e},S.prototype.resume=function(){var t=this._readableState;return t.flowing||(i("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(k,t,e))}(this,t)),t.paused=!1,this},S.prototype.pause=function(){return i("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(i("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var o in t.on("end",(function(){if(i("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(o){i("wrapped data"),n.decoder&&(o=n.decoder.write(o)),n.objectMode&&null==o||(n.objectMode||o&&o.length)&&(e.push(o)||(r=!0,t.pause()))})),t)void 0===this[o]&&"function"==typeof t[o]&&(this[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));for(var s=0;s<x.length;s++)t.on(x[s],this.emit.bind(this,x[s]));return this._read=function(e){i("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=n(5850)),h(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),S._fromList=B,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(t,e){return void 0===d&&(d=n(5167)),d(S,t,e)})},4605:(t,e,n)=>{"use strict";t.exports=u;var r=n(4281).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,l=n(6753);function c(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(t){if(!(this instanceof u))return new u(t);l.call(this,t),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",h)}function h(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(e,n){d(t,e,n)}))}function d(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new a;if(t._transformState.transforming)throw new s;return t.push(null)}n(5717)(u,l),u.prototype.push=function(t,e){return this._transformState.needTransform=!1,l.prototype.push.call(this,t,e)},u.prototype._transform=function(t,e,n){n(new i("_transform()"))},u.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},u.prototype._destroy=function(t,e){l.prototype._destroy.call(this,t,(function(t){e(t)}))}},4229:(t,e,n)=>{"use strict";function r(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(undefined),r=r.next}e.corkedRequestsFree.next=t}(e,t)}}var i;t.exports=S,S.WritableState=E;var o,s={deprecate:n(4927)},a=n(2503),l=n(8764).Buffer,c=n.g.Uint8Array||function(){},u=n(1195),h=n(2457).getHighWaterMark,d=n(4281).q,p=d.ERR_INVALID_ARG_TYPE,f=d.ERR_METHOD_NOT_IMPLEMENTED,m=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,y=d.ERR_STREAM_DESTROYED,v=d.ERR_STREAM_NULL_VALUES,_=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,b=u.errorOrDestroy;function x(){}function E(t,e,o){i=i||n(6753),t=t||{},"boolean"!=typeof o&&(o=e instanceof i),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=h(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===t.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if("function"!=typeof i)throw new m;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(process.nextTick(i,r),process.nextTick(C,t,e),t._writableState.errorEmitted=!0,b(t,r)):(i(r),t._writableState.errorEmitted=!0,b(t,r),C(t,e))}(t,n,r,e,i);else{var o=R(n)||t.destroyed;o||n.corked||n.bufferProcessing||!n.bufferedRequest||A(t,n),r?process.nextTick(T,t,n,o,i):T(t,n,o,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function S(t){var e=this instanceof(i=i||n(6753));if(!e&&!o.call(S,this))return new S(t);this._writableState=new E(t,this,e),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),a.call(this)}function M(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new y("write")):n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function T(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),C(t,e)}function A(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var i=e.bufferedRequestCount,o=new Array(i),s=e.corkedRequestsFree;s.entry=n;for(var a=0,l=!0;n;)o[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;o.allBuffers=l,M(t,e,!0,e.length,o,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new r(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,h=n.callback;if(M(t,e,!1,e.objectMode?1:c.length,c,u,h),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function R(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function L(t,e){t._final((function(n){e.pendingcb--,n&&b(t,n),e.prefinished=!0,t.emit("prefinish"),C(t,e)}))}function C(t,e){var n=R(e);if(n&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,process.nextTick(L,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}n(5717)(S,a),E.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(E.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(t){return!!o.call(this,t)||this===S&&t&&t._writableState instanceof E}})):o=function(t){return t instanceof this},S.prototype.pipe=function(){b(this,new g)},S.prototype.write=function(t,e,n){var r,i=this._writableState,o=!1,s=!i.objectMode&&(r=t,l.isBuffer(r)||r instanceof c);return s&&!l.isBuffer(t)&&(t=function(t){return l.from(t)}(t)),"function"==typeof e&&(n=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=x),i.ending?function(t,e){var n=new _;b(t,n),process.nextTick(e,n)}(this,n):(s||function(t,e,n,r){var i;return null===n?i=new v:"string"==typeof n||e.objectMode||(i=new p("chunk",["string","Buffer"],n)),!i||(b(t,i),process.nextTick(r,i),!1)}(this,i,t,n))&&(i.pendingcb++,o=function(t,e,n,r,i,o){if(!n){var s=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=l.from(e,n)),e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else M(t,e,!1,a,r,i,o);return c}(this,i,s,t,e,n)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||A(this,t))},S.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new w(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(t,e,n){n(new f("_write()"))},S.prototype._writev=null,S.prototype.end=function(t,e,n){var r=this._writableState;return"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||function(t,e,n){e.ending=!0,C(t,e),n&&(e.finished?process.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,r,n),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),S.prototype.destroy=u.destroy,S.prototype._undestroy=u.undestroy,S.prototype._destroy=function(t,e){e(t)}},5850:(t,e,n)=>{"use strict";var r;function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=n(8610),s=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function p(t,e){return{value:t,done:e}}function f(t){var e=t[s];if(null!==e){var n=t[d].read();null!==n&&(t[u]=null,t[s]=null,t[a]=null,e(p(n,!1)))}}function m(t){process.nextTick(f,t)}var g=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((i(r={get stream(){return this[d]},next:function(){var t=this,e=this[l];if(null!==e)return Promise.reject(e);if(this[c])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(e,n){process.nextTick((function(){t[l]?n(t[l]):e(p(void 0,!0))}))}));var n,r=this[u];if(r)n=new Promise(function(t,e){return function(n,r){t.then((function(){e[c]?n(p(void 0,!0)):e[h](n,r)}),r)}}(r,this));else{var i=this[d].read();if(null!==i)return Promise.resolve(p(i,!1));n=new Promise(this[h])}return this[u]=n,n}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var t=this;return new Promise((function(e,n){t[d].destroy(null,(function(t){t?n(t):e(p(void 0,!0))}))}))})),r),g);t.exports=function(t){var e,n=Object.create(y,(i(e={},d,{value:t,writable:!0}),i(e,s,{value:null,writable:!0}),i(e,a,{value:null,writable:!0}),i(e,l,{value:null,writable:!0}),i(e,c,{value:t._readableState.endEmitted,writable:!0}),i(e,h,{value:function(t,e){var r=n[d].read();r?(n[u]=null,n[s]=null,n[a]=null,t(p(r,!1))):(n[s]=t,n[a]=e)},writable:!0}),e));return n[u]=null,o(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[a];return null!==e&&(n[u]=null,n[s]=null,n[a]=null,e(t)),void(n[l]=t)}var r=n[s];null!==r&&(n[u]=null,n[s]=null,n[a]=null,r(p(void 0,!0))),n[c]=!0})),t.on("readable",m.bind(null,n)),n}},7327:(t,e,n)=>{"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=n(8764).Buffer,a=n(2361).inspect,l=a&&a.custom||"inspect";t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}var e,n;return e=t,n=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return s.alloc(0);for(var e,n,r,i=s.allocUnsafe(t>>>0),o=this.head,a=0;o;)e=o.data,n=i,r=a,s.prototype.copy.call(e,n,r),a+=o.data.length,o=o.next;return i}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;for(t-=r.length;e=e.next;){var i=e.data,o=t>i.length?i.length:t;if(o===i.length?r+=i:r+=i.slice(0,t),0==(t-=o)){o===i.length?(++n,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=s.allocUnsafe(t),n=this.head,r=1;for(n.data.copy(e),t-=n.data.length;n=n.next;){var i=n.data,o=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,o),0==(t-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,e}},{key:l,value:function(t,e){return a(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{depth:0,customInspect:!1}))}}],n&&o(e.prototype,n),t}()},1195:t=>{"use strict";function e(t,e){r(t,e),n(t)}function n(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function r(t,e){t.emit("error",e)}t.exports={destroy:function(t,i){var o=this,s=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return s||a?(i?i(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(r,this,t)):process.nextTick(r,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!i&&t?o._writableState?o._writableState.errorEmitted?process.nextTick(n,o):(o._writableState.errorEmitted=!0,process.nextTick(e,o,t)):process.nextTick(e,o,t):i?(process.nextTick(n,o),i(t)):process.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}}},8610:(t,e,n)=>{"use strict";var r=n(4281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function t(e,n,o){if("function"==typeof n)return t(e,null,n);n||(n={}),o=function(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}(o||i);var s=n.readable||!1!==n.readable&&e.readable,a=n.writable||!1!==n.writable&&e.writable,l=function(){e.writable||u()},c=e._writableState&&e._writableState.finished,u=function(){a=!1,c=!0,s||o.call(e)},h=e._readableState&&e._readableState.endEmitted,d=function(){s=!1,h=!0,a||o.call(e)},p=function(t){o.call(e,t)},f=function(){var t;return s&&!h?(e._readableState&&e._readableState.ended||(t=new r),o.call(e,t)):a&&!c?(e._writableState&&e._writableState.ended||(t=new r),o.call(e,t)):void 0},m=function(){e.req.on("finish",u)};return function(t){return t.setHeader&&"function"==typeof t.abort}(e)?(e.on("complete",u),e.on("abort",f),e.req?m():e.on("request",m)):a&&!e._writableState&&(e.on("end",l),e.on("close",l)),e.on("end",d),e.on("finish",u),!1!==n.error&&e.on("error",p),e.on("close",f),function(){e.removeListener("complete",u),e.removeListener("abort",f),e.removeListener("request",m),e.req&&e.req.removeListener("finish",u),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",u),e.removeListener("end",d),e.removeListener("error",p),e.removeListener("close",f)}}},5167:t=>{t.exports=function(){throw new Error("Readable.from is not available in the browser")}},9946:(t,e,n)=>{"use strict";var r,i=n(4281).q,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(t){if(t)throw t}function l(t,e,i,o){o=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(o);var a=!1;t.on("close",(function(){a=!0})),void 0===r&&(r=n(8610)),r(t,{readable:e,writable:i},(function(t){if(t)return o(t);a=!0,o()}));var l=!1;return function(e){if(!a&&!l)return l=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void o(e||new s("pipe"))}}function c(t){t()}function u(t,e){return t.pipe(e)}function h(t){return t.length?"function"!=typeof t[t.length-1]?a:t.pop():a}t.exports=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=h(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new o("streams");var s=e.map((function(t,n){var o=n<e.length-1;return l(t,o,n>0,(function(t){r||(r=t),t&&s.forEach(c),o||(s.forEach(c),i(r))}))}));return e.reduce(u)}},2457:(t,e,n)=>{"use strict";var r=n(4281).q.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(t,e,n,i){var o=function(t,e,n){return null!=t.highWaterMark?t.highWaterMark:e?t[n]:null}(e,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return t.objectMode?16:16384}}},2503:(t,e,n)=>{t.exports=n(7187).EventEmitter},8473:(t,e,n)=>{(e=t.exports=n(9481)).Stream=e,e.Readable=e,e.Writable=n(4229),e.Duplex=n(6753),e.Transform=n(4605),e.PassThrough=n(2725),e.finished=n(8610),e.pipeline=n(9946)},9785:(t,e,n)=>{"use strict";var r=n(8764).Buffer,i=n(5717),o=n(3349),s=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],d=[1352829926,1548603684,1836072691,2053994217,0];function p(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function f(t,e){return t<<e|t>>>32-e}function m(t,e,n,r,i,o,s,a){return f(t+(e^n^r)+o+s|0,a)+i|0}function g(t,e,n,r,i,o,s,a){return f(t+(e&n|~e&r)+o+s|0,a)+i|0}function y(t,e,n,r,i,o,s,a){return f(t+((e|~n)^r)+o+s|0,a)+i|0}function v(t,e,n,r,i,o,s,a){return f(t+(e&r|n&~r)+o+s|0,a)+i|0}function _(t,e,n,r,i,o,s,a){return f(t+(e^(n|~r))+o+s|0,a)+i|0}i(p,o),p.prototype._update=function(){for(var t=s,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);for(var n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,p=0|this._e,w=0|this._a,b=0|this._b,x=0|this._c,E=0|this._d,S=0|this._e,M=0;M<80;M+=1){var T,A;M<16?(T=m(n,r,i,o,p,t[a[M]],h[0],c[M]),A=_(w,b,x,E,S,t[l[M]],d[0],u[M])):M<32?(T=g(n,r,i,o,p,t[a[M]],h[1],c[M]),A=v(w,b,x,E,S,t[l[M]],d[1],u[M])):M<48?(T=y(n,r,i,o,p,t[a[M]],h[2],c[M]),A=y(w,b,x,E,S,t[l[M]],d[2],u[M])):M<64?(T=v(n,r,i,o,p,t[a[M]],h[3],c[M]),A=g(w,b,x,E,S,t[l[M]],d[3],u[M])):(T=_(n,r,i,o,p,t[a[M]],h[4],c[M]),A=m(w,b,x,E,S,t[l[M]],d[4],u[M])),n=p,p=o,o=f(i,10),i=r,r=T,w=S,S=E,E=f(x,10),x=b,b=A}var R=this._b+i+E|0;this._b=this._c+o+S|0,this._c=this._d+p+w|0,this._d=this._e+n+b|0,this._e=this._a+r+x|0,this._a=R},p.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=r.alloc?r.alloc(20):new r(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t},t.exports=p},9509:(t,e,n)=>{var r=n(8764),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},4189:(t,e,n)=>{var r=n(9509).Buffer;function i(t,e){this._block=r.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}i.prototype.update=function(t,e){"string"==typeof t&&(e=e||"utf8",t=r.from(t,e));for(var n=this._block,i=this._blockSize,o=t.length,s=this._len,a=0;a<o;){for(var l=s%i,c=Math.min(o-a,i-l),u=0;u<c;u++)n[l+u]=t[a+u];a+=c,(s+=c)%i==0&&this._update(n)}return this._len+=o,this},i.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return t?o.toString(t):o},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i},9072:(t,e,n)=>{var r=t.exports=function(t){t=t.toLowerCase();var e=r[t];if(!e)throw new Error(t+" is not supported (we accept pull requests)");return new e};r.sha=n(4448),r.sha1=n(8336),r.sha224=n(8432),r.sha256=n(7499),r.sha384=n(1686),r.sha512=n(7816)},4448:(t,e,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function l(){this.init(),this._w=a,i.call(this,64,56)}function c(t){return t<<30|t>>>2}function u(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(t){for(var e,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,a=0|this._d,l=0|this._e,h=0;h<16;++h)n[h]=t.readInt32BE(4*h);for(;h<80;++h)n[h]=n[h-3]^n[h-8]^n[h-14]^n[h-16];for(var d=0;d<80;++d){var p=~~(d/20),f=0|((e=r)<<5|e>>>27)+u(p,i,o,a)+l+n[d]+s[p];l=a,a=o,o=c(i),i=r,r=f}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=l},8336:(t,e,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function l(){this.init(),this._w=a,i.call(this,64,56)}function c(t){return t<<5|t>>>27}function u(t){return t<<30|t>>>2}function h(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(t){for(var e,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,a=0|this._d,l=0|this._e,d=0;d<16;++d)n[d]=t.readInt32BE(4*d);for(;d<80;++d)n[d]=(e=n[d-3]^n[d-8]^n[d-14]^n[d-16])<<1|e>>>31;for(var p=0;p<80;++p){var f=~~(p/20),m=c(r)+h(f,i,o,a)+l+n[p]+s[f]|0;l=a,a=o,o=u(i),i=r,r=m}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=l},8432:(t,e,n)=>{var r=n(5717),i=n(7499),o=n(4189),s=n(9509).Buffer,a=new Array(64);function l(){this.init(),this._w=a,o.call(this,64,56)}r(l,i),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var t=s.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},t.exports=l},7499:(t,e,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function l(){this.init(),this._w=a,i.call(this,64,56)}function c(t,e,n){return n^t&(e^n)}function u(t,e,n){return t&e|n&(t|e)}function h(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function d(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function p(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}r(l,i),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(t){for(var e,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,a=0|this._d,l=0|this._e,f=0|this._f,m=0|this._g,g=0|this._h,y=0;y<16;++y)n[y]=t.readInt32BE(4*y);for(;y<64;++y)n[y]=0|(((e=n[y-2])>>>17|e<<15)^(e>>>19|e<<13)^e>>>10)+n[y-7]+p(n[y-15])+n[y-16];for(var v=0;v<64;++v){var _=g+d(l)+c(l,f,m)+s[v]+n[v]|0,w=h(r)+u(r,i,o)|0;g=m,m=f,f=l,l=a+_|0,a=o,o=i,i=r,r=_+w|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=l+this._e|0,this._f=f+this._f|0,this._g=m+this._g|0,this._h=g+this._h|0},l.prototype._hash=function(){var t=o.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},t.exports=l},1686:(t,e,n)=>{var r=n(5717),i=n(7816),o=n(4189),s=n(9509).Buffer,a=new Array(160);function l(){this.init(),this._w=a,o.call(this,128,112)}r(l,i),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var t=s.allocUnsafe(48);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=l},7816:(t,e,n)=>{var r=n(5717),i=n(4189),o=n(9509).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function l(){this.init(),this._w=a,i.call(this,128,112)}function c(t,e,n){return n^t&(e^n)}function u(t,e,n){return t&e|n&(t|e)}function h(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function d(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function p(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function f(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function m(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function g(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function y(t,e){return t>>>0<e>>>0?1:0}r(l,i),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(t){for(var e=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,a=0|this._eh,l=0|this._fh,v=0|this._gh,_=0|this._hh,w=0|this._al,b=0|this._bl,x=0|this._cl,E=0|this._dl,S=0|this._el,M=0|this._fl,T=0|this._gl,A=0|this._hl,R=0;R<32;R+=2)e[R]=t.readInt32BE(4*R),e[R+1]=t.readInt32BE(4*R+4);for(;R<160;R+=2){var L=e[R-30],C=e[R-30+1],P=p(L,C),I=f(C,L),O=m(L=e[R-4],C=e[R-4+1]),N=g(C,L),k=e[R-14],D=e[R-14+1],B=e[R-32],U=e[R-32+1],z=I+D|0,F=P+k+y(z,I)|0;F=(F=F+O+y(z=z+N|0,N)|0)+B+y(z=z+U|0,U)|0,e[R]=F,e[R+1]=z}for(var H=0;H<160;H+=2){F=e[H],z=e[H+1];var G=u(n,r,i),V=u(w,b,x),j=h(n,w),W=h(w,n),q=d(a,S),K=d(S,a),X=s[H],Y=s[H+1],J=c(a,l,v),Z=c(S,M,T),Q=A+K|0,$=_+q+y(Q,A)|0;$=($=($=$+J+y(Q=Q+Z|0,Z)|0)+X+y(Q=Q+Y|0,Y)|0)+F+y(Q=Q+z|0,z)|0;var tt=W+V|0,et=j+G+y(tt,W)|0;_=v,A=T,v=l,T=M,l=a,M=S,a=o+$+y(S=E+Q|0,E)|0,o=i,E=x,i=r,x=b,r=n,b=w,n=$+et+y(w=Q+tt|0,Q)|0}this._al=this._al+w|0,this._bl=this._bl+b|0,this._cl=this._cl+x|0,this._dl=this._dl+E|0,this._el=this._el+S|0,this._fl=this._fl+M|0,this._gl=this._gl+T|0,this._hl=this._hl+A|0,this._ah=this._ah+n+y(this._al,w)|0,this._bh=this._bh+r+y(this._bl,b)|0,this._ch=this._ch+i+y(this._cl,x)|0,this._dh=this._dh+o+y(this._dl,E)|0,this._eh=this._eh+a+y(this._el,S)|0,this._fh=this._fh+l+y(this._fl,M)|0,this._gh=this._gh+v+y(this._gl,T)|0,this._hh=this._hh+_+y(this._hl,A)|0},l.prototype._hash=function(){var t=o.allocUnsafe(64);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=l},2830:(t,e,n)=>{t.exports=i;var r=n(7187).EventEmitter;function i(){r.call(this)}n(5717)(i,r),i.Readable=n(9481),i.Writable=n(4229),i.Duplex=n(6753),i.Transform=n(4605),i.PassThrough=n(2725),i.finished=n(8610),i.pipeline=n(9946),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",a),n.on("close",l));var s=!1;function a(){s||(s=!0,t.end())}function l(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(u(),0===r.listenerCount(this,"error"))throw t}function u(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",l),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",u),n.removeListener("close",u),t.removeListener("close",u)}return n.on("error",c),t.on("error",c),n.on("end",u),n.on("close",u),t.on("close",u),t.emit("pipe",n),t}},2553:(t,e,n)=>{"use strict";var r=n(9509).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=u,this.end=h,e=3;break;default:return this.write=d,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function u(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function h(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function d(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.s=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},4927:(t,e,n)=>{function r(t){try{if(!n.g.localStorage)return!1}catch(t){return!1}var e=n.g.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}t.exports=function(t,e){if(r("noDeprecation"))return t;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(e);r("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}},5883:()=>{},2361:()=>{},4616:()=>{}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.u=t=>t+".bundle.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,(()=>{"use strict";var t={};n.r(t),n.d(t,{ACESFilmicToneMapping:()=>Hr,AddEquation:()=>ur,AddOperation:()=>Dr,AdditiveAnimationBlendMode:()=>fo,AdditiveBlending:()=>sr,AlphaFormat:()=>wi,AlwaysDepth:()=>Ar,AlwaysStencilFunc:()=>zo,AmbientLight:()=>_m,AmbientLightProbe:()=>Dm,AnimationClip:()=>jf,AnimationLoader:()=>Qf,AnimationMixer:()=>fg,AnimationObjectGroup:()=>dg,AnimationUtils:()=>Pf,ArcCurve:()=>hp,ArrayCamera:()=>Nh,ArrowHelper:()=>ry,Audio:()=>Xm,AudioAnalyser:()=>tg,AudioContext:()=>Om,AudioListener:()=>Km,AudioLoader:()=>Nm,AxesHelper:()=>iy,AxisHelper:()=>Oy,BackSide:()=>tr,BasicDepthPacking:()=>wo,BasicShadowMap:()=>Yn,BinaryTextureLoader:()=>Uy,Bone:()=>wd,BooleanKeyframeTrack:()=>Bf,BoundingBoxHelper:()=>Ny,Box2:()=>Sg,Box3:()=>Bs,Box3Helper:()=>Qg,BoxBufferGeometry:()=>Bl,BoxGeometry:()=>Bl,BoxHelper:()=>Zg,BufferAttribute:()=>$a,BufferGeometry:()=>yl,BufferGeometryLoader:()=>Tm,ByteType:()=>ui,Cache:()=>qf,Camera:()=>Gl,CameraHelper:()=>Xg,CanvasRenderer:()=>Fy,CanvasTexture:()=>Qd,CatmullRomCurve3:()=>yp,CineonToneMapping:()=>Fr,CircleBufferGeometry:()=>$d,CircleGeometry:()=>$d,ClampToEdgeWrapping:()=>Zr,Clock:()=>Hm,Color:()=>Es,ColorKeyframeTrack:()=>Uf,CompressedTexture:()=>Zd,CompressedTextureLoader:()=>$f,ConeBufferGeometry:()=>ep,ConeGeometry:()=>ep,CubeCamera:()=>Wl,CubeReflectionMapping:()=>jr,CubeRefractionMapping:()=>Wr,CubeTexture:()=>ql,CubeTextureLoader:()=>em,CubeUVReflectionMapping:()=>Xr,CubeUVRefractionMapping:()=>Yr,CubicBezierCurve:()=>bp,CubicBezierCurve3:()=>xp,CubicInterpolant:()=>Of,CullFaceBack:()=>qn,CullFaceFront:()=>Kn,CullFaceFrontBack:()=>Xn,CullFaceNone:()=>Wn,Curve:()=>cp,CurvePath:()=>Lp,CustomBlending:()=>cr,CustomToneMapping:()=>Gr,CylinderBufferGeometry:()=>tp,CylinderGeometry:()=>tp,Cylindrical:()=>xg,DataTexture:()=>bd,DataTexture2DArray:()=>Uc,DataTexture3D:()=>jc,DataTextureLoader:()=>nm,DataUtils:()=>ly,DecrementStencilOp:()=>Ro,DecrementWrapStencilOp:()=>Co,DefaultLoadingManager:()=>Xf,DepthFormat:()=>Si,DepthStencilFormat:()=>Mi,DepthTexture:()=>Uh,DirectionalLight:()=>vm,DirectionalLightHelper:()=>Wg,DiscreteInterpolant:()=>kf,DodecahedronBufferGeometry:()=>rp,DodecahedronGeometry:()=>rp,DoubleSide:()=>er,DstAlphaFactor:()=>br,DstColorFactor:()=>Er,DynamicBufferAttribute:()=>Ey,DynamicCopyUsage:()=>Ko,DynamicDrawUsage:()=>Ho,DynamicReadUsage:()=>jo,EdgesGeometry:()=>lp,EdgesHelper:()=>ky,EllipseCurve:()=>up,EqualDepth:()=>Cr,EqualStencilFunc:()=>No,EquirectangularReflectionMapping:()=>qr,EquirectangularRefractionMapping:()=>Kr,Euler:()=>ba,EventDispatcher:()=>Qo,ExtrudeBufferGeometry:()=>sf,ExtrudeGeometry:()=>sf,FaceColors:()=>dy,FileLoader:()=>Zf,FlatShading:()=>nr,Float16BufferAttribute:()=>al,Float32Attribute:()=>Py,Float32BufferAttribute:()=>ll,Float64Attribute:()=>Iy,Float64BufferAttribute:()=>cl,FloatType:()=>mi,Fog:()=>jh,FogExp2:()=>Vh,Font:()=>Ky,FontLoader:()=>qy,FramebufferTexture:()=>Jd,FrontSide:()=>$n,Frustum:()=>tc,GLBufferAttribute:()=>yg,GLSL1:()=>Yo,GLSL3:()=>Jo,GreaterDepth:()=>Ir,GreaterEqualDepth:()=>Pr,GreaterEqualStencilFunc:()=>Uo,GreaterStencilFunc:()=>Do,GridHelper:()=>Fg,Group:()=>kh,HalfFloatType:()=>gi,HemisphereLight:()=>om,HemisphereLightHelper:()=>zg,HemisphereLightProbe:()=>km,IcosahedronBufferGeometry:()=>lf,IcosahedronGeometry:()=>lf,ImageBitmapLoader:()=>Pm,ImageLoader:()=>tm,ImageUtils:()=>Ms,ImmediateRenderObject:()=>Xy,IncrementStencilOp:()=>Ao,IncrementWrapStencilOp:()=>Lo,InstancedBufferAttribute:()=>Md,InstancedBufferGeometry:()=>Mm,InstancedInterleavedBuffer:()=>gg,InstancedMesh:()=>Cd,Int16Attribute:()=>Ay,Int16BufferAttribute:()=>rl,Int32Attribute:()=>Ly,Int32BufferAttribute:()=>ol,Int8Attribute:()=>Sy,Int8BufferAttribute:()=>tl,IntType:()=>pi,InterleavedBuffer:()=>qh,InterleavedBufferAttribute:()=>Xh,Interpolant:()=>If,InterpolateDiscrete:()=>so,InterpolateLinear:()=>ao,InterpolateSmooth:()=>lo,InvertStencilOp:()=>Po,JSONLoader:()=>Hy,KeepStencilOp:()=>Mo,KeyframeTrack:()=>Df,LOD:()=>pd,LatheBufferGeometry:()=>cf,LatheGeometry:()=>cf,Layers:()=>xa,LensFlare:()=>Vy,LessDepth:()=>Rr,LessEqualDepth:()=>Lr,LessEqualStencilFunc:()=>ko,LessStencilFunc:()=>Oo,Light:()=>im,LightProbe:()=>xm,Line:()=>Bd,Line3:()=>Ag,LineBasicMaterial:()=>Pd,LineCurve:()=>Ep,LineCurve3:()=>Sp,LineDashedMaterial:()=>Lf,LineLoop:()=>Hd,LinePieces:()=>uy,LineSegments:()=>Fd,LineStrip:()=>cy,LinearEncoding:()=>vo,LinearFilter:()=>ii,LinearInterpolant:()=>Nf,LinearMipMapLinearFilter:()=>li,LinearMipMapNearestFilter:()=>si,LinearMipmapLinearFilter:()=>ai,LinearMipmapNearestFilter:()=>oi,LinearToneMapping:()=>Ur,Loader:()=>Yf,LoaderUtils:()=>Sm,LoadingManager:()=>Kf,LoopOnce:()=>ro,LoopPingPong:()=>oo,LoopRepeat:()=>io,LuminanceAlphaFormat:()=>Ei,LuminanceFormat:()=>xi,MOUSE:()=>Vn,Material:()=>Ya,MaterialLoader:()=>Em,Math:()=>us,MathUtils:()=>us,Matrix3:()=>ds,Matrix4:()=>ha,MaxEquation:()=>fr,Mesh:()=>kl,MeshBasicMaterial:()=>Ja,MeshDepthMaterial:()=>Rh,MeshDistanceMaterial:()=>Lh,MeshFaceMaterial:()=>fy,MeshLambertMaterial:()=>Af,MeshMatcapMaterial:()=>Rf,MeshNormalMaterial:()=>Tf,MeshPhongMaterial:()=>Sf,MeshPhysicalMaterial:()=>Ef,MeshStandardMaterial:()=>xf,MeshToonMaterial:()=>Mf,MinEquation:()=>pr,MirroredRepeatWrapping:()=>Qr,MixOperation:()=>kr,MultiMaterial:()=>my,MultiplyBlending:()=>lr,MultiplyOperation:()=>Nr,NearestFilter:()=>$r,NearestMipMapLinearFilter:()=>ri,NearestMipMapNearestFilter:()=>ei,NearestMipmapLinearFilter:()=>ni,NearestMipmapNearestFilter:()=>ti,NeverDepth:()=>Tr,NeverStencilFunc:()=>Io,NoBlending:()=>ir,NoColors:()=>hy,NoToneMapping:()=>Br,NormalAnimationBlendMode:()=>po,NormalBlending:()=>or,NotEqualDepth:()=>Or,NotEqualStencilFunc:()=>Bo,NumberKeyframeTrack:()=>zf,Object3D:()=>Da,ObjectLoader:()=>Am,ObjectSpaceNormalMap:()=>Eo,OctahedronBufferGeometry:()=>uf,OctahedronGeometry:()=>uf,OneFactor:()=>gr,OneMinusDstAlphaFactor:()=>xr,OneMinusDstColorFactor:()=>Sr,OneMinusSrcAlphaFactor:()=>wr,OneMinusSrcColorFactor:()=>vr,OrthographicCamera:()=>pc,PCFShadowMap:()=>Jn,PCFSoftShadowMap:()=>Zn,PMREMGenerator:()=>Ac,ParametricGeometry:()=>jy,Particle:()=>yy,ParticleBasicMaterial:()=>wy,ParticleSystem:()=>vy,ParticleSystemMaterial:()=>by,Path:()=>Cp,PerspectiveCamera:()=>Vl,Plane:()=>Zl,PlaneBufferGeometry:()=>rc,PlaneGeometry:()=>rc,PlaneHelper:()=>$g,PointCloud:()=>gy,PointCloudMaterial:()=>_y,PointLight:()=>gm,PointLightHelper:()=>kg,Points:()=>Kd,PointsMaterial:()=>Gd,PolarGridHelper:()=>Hg,PolyhedronBufferGeometry:()=>np,PolyhedronGeometry:()=>np,PositionalAudio:()=>$m,PropertyBinding:()=>hg,PropertyMixer:()=>eg,QuadraticBezierCurve:()=>Mp,QuadraticBezierCurve3:()=>Tp,Quaternion:()=>Os,QuaternionKeyframeTrack:()=>Hf,QuaternionLinearInterpolant:()=>Ff,REVISION:()=>Gn,RGBADepthPacking:()=>bo,RGBAFormat:()=>bi,RGBAIntegerFormat:()=>Ci,RGBA_ASTC_10x10_Format:()=>$i,RGBA_ASTC_10x5_Format:()=>Ji,RGBA_ASTC_10x6_Format:()=>Zi,RGBA_ASTC_10x8_Format:()=>Qi,RGBA_ASTC_12x10_Format:()=>to,RGBA_ASTC_12x12_Format:()=>eo,RGBA_ASTC_4x4_Format:()=>Gi,RGBA_ASTC_5x4_Format:()=>Vi,RGBA_ASTC_5x5_Format:()=>ji,RGBA_ASTC_6x5_Format:()=>Wi,RGBA_ASTC_6x6_Format:()=>qi,RGBA_ASTC_8x5_Format:()=>Ki,RGBA_ASTC_8x6_Format:()=>Xi,RGBA_ASTC_8x8_Format:()=>Yi,RGBA_BPTC_Format:()=>no,RGBA_ETC2_EAC_Format:()=>Hi,RGBA_PVRTC_2BPPV1_Format:()=>Ui,RGBA_PVRTC_4BPPV1_Format:()=>Bi,RGBA_S3TC_DXT1_Format:()=>Ii,RGBA_S3TC_DXT3_Format:()=>Oi,RGBA_S3TC_DXT5_Format:()=>Ni,RGB_ETC1_Format:()=>zi,RGB_ETC2_Format:()=>Fi,RGB_PVRTC_2BPPV1_Format:()=>Di,RGB_PVRTC_4BPPV1_Format:()=>ki,RGB_S3TC_DXT1_Format:()=>Pi,RGFormat:()=>Ri,RGIntegerFormat:()=>Li,RawShaderMaterial:()=>fc,Ray:()=>ua,Raycaster:()=>vg,RectAreaLight:()=>wm,RedFormat:()=>Ti,RedIntegerFormat:()=>Ai,ReinhardToneMapping:()=>zr,RepeatWrapping:()=>Jr,ReplaceStencilOp:()=>To,ReverseSubtractEquation:()=>dr,RingBufferGeometry:()=>hf,RingGeometry:()=>hf,Scene:()=>Wh,SceneUtils:()=>Gy,ShaderChunk:()=>ic,ShaderLib:()=>sc,ShaderMaterial:()=>Hl,ShadowMaterial:()=>bf,Shape:()=>Pp,ShapeBufferGeometry:()=>df,ShapeGeometry:()=>df,ShapePath:()=>oy,ShapeUtils:()=>nf,ShortType:()=>hi,Skeleton:()=>Sd,SkeletonHelper:()=>Og,SkinnedMesh:()=>_d,SmoothShading:()=>rr,Sphere:()=>na,SphereBufferGeometry:()=>pf,SphereGeometry:()=>pf,Spherical:()=>bg,SphericalHarmonics3:()=>bm,SplineCurve:()=>Ap,SpotLight:()=>hm,SpotLightHelper:()=>Lg,Sprite:()=>cd,SpriteMaterial:()=>Yh,SrcAlphaFactor:()=>_r,SrcAlphaSaturateFactor:()=>Mr,SrcColorFactor:()=>yr,StaticCopyUsage:()=>qo,StaticDrawUsage:()=>Fo,StaticReadUsage:()=>Vo,StereoCamera:()=>Fm,StreamCopyUsage:()=>Xo,StreamDrawUsage:()=>Go,StreamReadUsage:()=>Wo,StringKeyframeTrack:()=>Gf,SubtractEquation:()=>hr,SubtractiveBlending:()=>ar,TOUCH:()=>jn,TangentSpaceNormalMap:()=>xo,TetrahedronBufferGeometry:()=>ff,TetrahedronGeometry:()=>ff,TextGeometry:()=>Wy,Texture:()=>As,TextureLoader:()=>rm,TorusBufferGeometry:()=>mf,TorusGeometry:()=>mf,TorusKnotBufferGeometry:()=>gf,TorusKnotGeometry:()=>gf,Triangle:()=>Ka,TriangleFanDrawMode:()=>yo,TriangleStripDrawMode:()=>go,TrianglesDrawMode:()=>mo,TubeBufferGeometry:()=>yf,TubeGeometry:()=>yf,UVMapping:()=>Vr,Uint16Attribute:()=>Ry,Uint16BufferAttribute:()=>il,Uint32Attribute:()=>Cy,Uint32BufferAttribute:()=>sl,Uint8Attribute:()=>My,Uint8BufferAttribute:()=>el,Uint8ClampedAttribute:()=>Ty,Uint8ClampedBufferAttribute:()=>nl,Uniform:()=>mg,UniformsLib:()=>oc,UniformsUtils:()=>Fl,UnsignedByteType:()=>ci,UnsignedInt248Type:()=>_i,UnsignedIntType:()=>fi,UnsignedShort4444Type:()=>yi,UnsignedShort5551Type:()=>vi,UnsignedShortType:()=>di,VSMShadowMap:()=>Qn,Vector2:()=>hs,Vector3:()=>Ns,Vector4:()=>Ls,VectorKeyframeTrack:()=>Vf,Vertex:()=>xy,VertexColors:()=>py,VideoTexture:()=>Yd,WebGL1Renderer:()=>Gh,WebGLCubeRenderTarget:()=>Kl,WebGLMultipleRenderTargets:()=>Ps,WebGLMultisampleRenderTarget:()=>Is,WebGLRenderTarget:()=>Cs,WebGLRenderTargetCube:()=>zy,WebGLRenderer:()=>Hh,WebGLUtils:()=>Oh,WireframeGeometry:()=>vf,WireframeHelper:()=>Dy,WrapAroundEnding:()=>ho,XHRLoader:()=>By,ZeroCurvatureEnding:()=>co,ZeroFactor:()=>mr,ZeroSlopeEnding:()=>uo,ZeroStencilOp:()=>So,_SRGBAFormat:()=>Zo,sRGBEncoding:()=>_o});const e={"Total ANAVER.SE":{début:0,fin:0,durée:"NA"},"Code Barre":{début:0,fin:0,durée:"NA"},Identité:{début:0,fin:0,durée:"NA"},"Liste des Jetons Natifs":{début:0,fin:0,durée:"NA"},"Choix aléatoire":{début:0,fin:0,durée:"NA"},"Téléchargement premier espace":{début:0,fin:0,durée:"NA"},"Création Monde":{début:0,fin:0,durée:"NA"},"Galleries Natives":{début:0,fin:0,durée:"NA"},"Galleries OBJKT":{début:0,fin:0,durée:"NA"},"Galleries VERSUM":{début:0,fin:0,durée:"NA"}};function r(){}function i(t){return null==t?r:function(){return this.querySelector(t)}}function o(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function s(){return[]}function a(t){return null==t?s:function(){return this.querySelectorAll(t)}}function l(t){return function(){return this.matches(t)}}function c(t){return function(e){return e.matches(t)}}window.horlogesLog=()=>{console.log("%cTableau de bord des horloges","font-weight:bold;text-decoration:underline;"),console.log("Toutes les durées sont en millisecondes.");for(const t in e)e[t].fin>0?e[t].durée=e[t].fin-e[t].début:e[t].durée="NA";console.table(e)};var u=Array.prototype.find;function h(){return this.firstElementChild}var d=Array.prototype.filter;function p(){return Array.from(this.children)}function f(t){return new Array(t.length)}function m(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function g(t){return function(){return t}}function y(t,e,n,r,i,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new m(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function v(t,e,n,r,i,o,s){var a,l,c,u=new Map,h=e.length,d=o.length,p=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(p[a]=c=s.call(l,l.__data__,a,e)+"",u.has(c)?i[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(t,o[a],a,o)+"",(l=u.get(c))?(r[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new m(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&u.get(p[a])===l&&(i[a]=l)}function _(t){return t.__data__}function w(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function b(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}m.prototype={constructor:m,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var x="http://www.w3.org/1999/xhtml";const E={svg:"http://www.w3.org/2000/svg",xhtml:x,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function S(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),E.hasOwnProperty(e)?{space:E[e],local:t}:t}function M(t){return function(){this.removeAttribute(t)}}function T(t){return function(){this.removeAttributeNS(t.space,t.local)}}function A(t,e){return function(){this.setAttribute(t,e)}}function R(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function L(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function C(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function P(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function I(t){return function(){this.style.removeProperty(t)}}function O(t,e,n){return function(){this.style.setProperty(t,e,n)}}function N(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function k(t,e){return t.style.getPropertyValue(e)||P(t).getComputedStyle(t,null).getPropertyValue(e)}function D(t){return function(){delete this[t]}}function B(t,e){return function(){this[t]=e}}function U(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function z(t){return t.trim().split(/^|\s+/)}function F(t){return t.classList||new H(t)}function H(t){this._node=t,this._names=z(t.getAttribute("class")||"")}function G(t,e){for(var n=F(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function V(t,e){for(var n=F(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function j(t){return function(){G(this,t)}}function W(t){return function(){V(this,t)}}function q(t,e){return function(){(e.apply(this,arguments)?G:V)(this,t)}}function K(){this.textContent=""}function X(t){return function(){this.textContent=t}}function Y(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function J(){this.innerHTML=""}function Z(t){return function(){this.innerHTML=t}}function Q(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function $(){this.nextSibling&&this.parentNode.appendChild(this)}function tt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function et(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===x&&e.documentElement.namespaceURI===x?e.createElement(t):e.createElementNS(n,t)}}function nt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function rt(t){var e=S(t);return(e.local?nt:et)(e)}function it(){return null}function ot(){var t=this.parentNode;t&&t.removeChild(this)}function st(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function at(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function lt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function ct(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function ut(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function ht(t,e,n){var r=P(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dt(t,e){return function(){return ht(this,t,e)}}function pt(t,e){return function(){return ht(this,t,e.apply(this,arguments))}}H.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ft=[null];function mt(t,e){this._groups=t,this._parents=e}function gt(){return new mt([[document.documentElement]],ft)}mt.prototype=gt.prototype={constructor:mt,select:function(t){"function"!=typeof t&&(t=i(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var s,a,l=e[o],c=l.length,u=r[o]=new Array(c),h=0;h<c;++h)(s=l[h])&&(a=t.call(s,s.__data__,h,l))&&("__data__"in s&&(a.__data__=s.__data__),u[h]=a);return new mt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return o(t.apply(this,arguments))}}(t):a(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l,c=e[s],u=c.length,h=0;h<u;++h)(l=c[h])&&(r.push(t.call(l,l.__data__,h,c)),i.push(l));return new mt(r,i)},selectChild:function(t){return this.select(null==t?h:function(t){return function(){return u.call(this.children,t)}}("function"==typeof t?t:c(t)))},selectChildren:function(t){return this.selectAll(null==t?p:function(t){return function(){return d.call(this.children,t)}}("function"==typeof t?t:c(t)))},filter:function(t){"function"!=typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,c=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&c.push(o);return new mt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,_);var n=e?v:y,r=this._parents,i=this._groups;"function"!=typeof t&&(t=g(t));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],h=i[c],d=h.length,p=w(t.call(u,u&&u.__data__,c,r)),f=p.length,m=a[c]=new Array(f),b=s[c]=new Array(f),x=l[c]=new Array(d);n(u,h,m,b,x,p,e);for(var E,S,M=0,T=0;M<f;++M)if(E=m[M]){for(M>=T&&(T=M+1);!(S=b[T])&&++T<f;);E._next=S||null}}return(s=new mt(s,r))._enter=a,s._exit=l,s},enter:function(){return new mt(this._enter||this._groups.map(f),this._parents)},exit:function(){return new mt(this._exit||this._groups.map(f),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c,u=n[l],h=r[l],d=u.length,p=a[l]=new Array(d),f=0;f<d;++f)(c=u[f]||h[f])&&(p[f]=c);for(;l<i;++l)a[l]=n[l];return new mt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=b);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new mt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this},attr:function(t,e){var n=S(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?T:M:"function"==typeof e?n.local?C:L:n.local?R:A)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?I:"function"==typeof e?N:O)(t,e,null==n?"":n)):k(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?D:"function"==typeof e?U:B)(t,e)):this.node()[t]},classed:function(t,e){var n=z(t+"");if(arguments.length<2){for(var r=F(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?q:e?j:W)(n,e))},text:function(t){return arguments.length?this.each(null==t?K:("function"==typeof t?Y:X)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?J:("function"==typeof t?Q:Z)(t)):this.node().innerHTML},raise:function(){return this.each($)},lower:function(){return this.each(tt)},append:function(t){var e="function"==typeof t?t:rt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:rt(t),r=null==e?it:"function"==typeof e?e:i(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ot)},clone:function(t){return this.select(t?at:st)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=lt(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?ut:ct,r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?pt:dt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};const yt=gt;var vt={value:()=>{}};function _t(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new wt(r)}function wt(t){this._=t}function bt(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function xt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Et(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=vt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}wt.prototype=_t.prototype={constructor:wt,on:function(t,e){var n,r=this._,i=bt(t+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=i[o]).type)r[n]=Et(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Et(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=i[o]).type)&&(n=xt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new wt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const St=_t;var Mt,Tt,At=0,Rt=0,Lt=0,Ct=0,Pt=0,It=0,Ot="object"==typeof performance&&performance.now?performance:Date,Nt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function kt(){return Pt||(Nt(Dt),Pt=Ot.now()+It)}function Dt(){Pt=0}function Bt(){this._call=this._time=this._next=null}function Ut(t,e,n){var r=new Bt;return r.restart(t,e,n),r}function zt(){Pt=(Ct=Ot.now())+It,At=Rt=0;try{!function(){kt(),++At;for(var t,e=Mt;e;)(t=Pt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--At}()}finally{At=0,function(){for(var t,e,n=Mt,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Mt=e);Tt=t,Ht(r)}(),Pt=0}}function Ft(){var t=Ot.now(),e=t-Ct;e>1e3&&(It-=e,Ct=t)}function Ht(t){At||(Rt&&(Rt=clearTimeout(Rt)),t-Pt>24?(t<1/0&&(Rt=setTimeout(zt,t-Ot.now()-It)),Lt&&(Lt=clearInterval(Lt))):(Lt||(Ct=Ot.now(),Lt=setInterval(Ft,1e3)),At=1,Nt(zt)))}function Gt(t,e,n){var r=new Bt;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}Bt.prototype=Ut.prototype={constructor:Bt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?kt():+n)+(null==e?0:+e),this._next||Tt===this||(Tt?Tt._next=this:Mt=this,Tt=this),this._call=t,this._time=n,Ht()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ht())}};var Vt=St("start","end","cancel","interrupt"),jt=[];function Wt(t,e,n,r,i,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var c,u,h,d;if(1!==n.state)return a();for(c in i)if((d=i[c]).name===n.name){if(3===d.state)return Gt(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[c])}if(Gt((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Ut((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Vt,tween:jt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function qt(t,e){var n=Xt(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Kt(t,e){var n=Xt(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Xt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Yt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Jt,Zt=180/Math.PI,Qt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $t(t,e,n,r,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Zt,skewX:Math.atan(l)*Zt,scaleX:s,scaleY:a}}function te(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:Yt(t,i)},{i:l-2,x:Yt(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Yt(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Yt(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,l),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:Yt(t,n)},{i:a-2,x:Yt(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var ee=te((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Qt:$t(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ne=te((function(t){return null==t?Qt:(Jt||(Jt=document.createElementNS("http://www.w3.org/2000/svg","g")),Jt.setAttribute("transform",t),(t=Jt.transform.baseVal.consolidate())?$t((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Qt)}),", ",")",")");function re(t,e){var n,r;return function(){var i=Kt(this,t),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function ie(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Kt(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function oe(t,e,n){var r=t._id;return t.each((function(){var t=Kt(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Xt(t,r).value[e]}}function se(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ae(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function le(){}var ce=.7,ue=1/ce,he="\\s*([+-]?\\d+)\\s*",de="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",pe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fe=/^#([0-9a-f]{3,8})$/,me=new RegExp("^rgb\\("+[he,he,he]+"\\)$"),ge=new RegExp("^rgb\\("+[pe,pe,pe]+"\\)$"),ye=new RegExp("^rgba\\("+[he,he,he,de]+"\\)$"),ve=new RegExp("^rgba\\("+[pe,pe,pe,de]+"\\)$"),_e=new RegExp("^hsl\\("+[de,pe,pe]+"\\)$"),we=new RegExp("^hsla\\("+[de,pe,pe,de]+"\\)$"),be={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function xe(){return this.rgb().formatHex()}function Ee(){return this.rgb().formatRgb()}function Se(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=fe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Me(e):3===n?new Le(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Te(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Te(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=me.exec(t))?new Le(e[1],e[2],e[3],1):(e=ge.exec(t))?new Le(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ye.exec(t))?Te(e[1],e[2],e[3],e[4]):(e=ve.exec(t))?Te(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=_e.exec(t))?Oe(e[1],e[2]/100,e[3]/100,1):(e=we.exec(t))?Oe(e[1],e[2]/100,e[3]/100,e[4]):be.hasOwnProperty(t)?Me(be[t]):"transparent"===t?new Le(NaN,NaN,NaN,0):null}function Me(t){return new Le(t>>16&255,t>>8&255,255&t,1)}function Te(t,e,n,r){return r<=0&&(t=e=n=NaN),new Le(t,e,n,r)}function Ae(t){return t instanceof le||(t=Se(t)),t?new Le((t=t.rgb()).r,t.g,t.b,t.opacity):new Le}function Re(t,e,n,r){return 1===arguments.length?Ae(t):new Le(t,e,n,null==r?1:r)}function Le(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ce(){return"#"+Ie(this.r)+Ie(this.g)+Ie(this.b)}function Pe(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ie(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Oe(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ke(t,e,n,r)}function Ne(t){if(t instanceof ke)return new ke(t.h,t.s,t.l,t.opacity);if(t instanceof le||(t=Se(t)),!t)return new ke;if(t instanceof ke)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new ke(s,a,l,t.opacity)}function ke(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function De(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Be(t,e,n,r,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*r+s*i)/6}se(le,Se,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:xe,formatHex:xe,formatHsl:function(){return Ne(this).formatHsl()},formatRgb:Ee,toString:Ee}),se(Le,Re,ae(le,{brighter:function(t){return t=null==t?ue:Math.pow(ue,t),new Le(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?ce:Math.pow(ce,t),new Le(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ce,formatHex:Ce,formatRgb:Pe,toString:Pe})),se(ke,(function(t,e,n,r){return 1===arguments.length?Ne(t):new ke(t,e,n,null==r?1:r)}),ae(le,{brighter:function(t){return t=null==t?ue:Math.pow(ue,t),new ke(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?ce:Math.pow(ce,t),new ke(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Le(De(t>=240?t-240:t+120,i,r),De(t,i,r),De(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const Ue=t=>()=>t;function ze(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Ue(isNaN(t)?e:t)}const Fe=function t(e){var n=function(t){return 1==(t=+t)?ze:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ue(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Re(t)).r,(e=Re(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=ze(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function He(t){return function(e){var n,r,i=e.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=Re(e[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=t(o),s=t(s),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=s(t),r.b=a(t),r+""}}}He((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],s=r>0?t[r-1]:2*i-o,a=r<e-1?t[r+2]:2*o-i;return Be((n-r/e)*e,s,i,o,a)}})),He((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],s=t[(r+1)%e],a=t[(r+2)%e];return Be((n-r/e)*e,i,o,s,a)}}));var Ge=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ve=new RegExp(Ge.source,"g");function je(t,e){var n,r,i,o=Ge.lastIndex=Ve.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=Ge.exec(t))&&(r=Ve.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Yt(n,r)})),o=Ve.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})}function We(t,e){var n;return("number"==typeof e?Yt:e instanceof Se?Fe:(n=Se(e))?(e=n,Fe):je)(t,e)}function qe(t){return function(){this.removeAttribute(t)}}function Ke(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xe(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function Ye(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function Je(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttribute(t)}}function Ze(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function Qe(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function $e(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function tn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&$e(t,i)),n}return i._value=e,i}function en(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Qe(t,i)),n}return i._value=e,i}function nn(t,e){return function(){qt(this,t).delay=+e.apply(this,arguments)}}function rn(t,e){return e=+e,function(){qt(this,t).delay=e}}function on(t,e){return function(){Kt(this,t).duration=+e.apply(this,arguments)}}function sn(t,e){return e=+e,function(){Kt(this,t).duration=e}}function an(t,e){if("function"!=typeof e)throw new Error;return function(){Kt(this,t).ease=e}}function ln(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?qt:Kt;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}var cn=yt.prototype.constructor;function un(t){return function(){this.style.removeProperty(t)}}function hn(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function dn(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&hn(t,o,n)),r}return o._value=e,o}function pn(t){return function(e){this.textContent=t.call(this,e)}}function fn(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&pn(r)),e}return r._value=t,r}var mn=0;function gn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function yn(){return++mn}var vn=yt.prototype;gn.prototype=function(t){return yt().transition(t)}.prototype={constructor:gn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=i(t));for(var r=this._groups,o=r.length,s=new Array(o),a=0;a<o;++a)for(var l,c,u=r[a],h=u.length,d=s[a]=new Array(h),p=0;p<h;++p)(l=u[p])&&(c=t.call(l,l.__data__,p,u))&&("__data__"in l&&(c.__data__=l.__data__),d[p]=c,Wt(d[p],e,n,p,d,Xt(l,n)));return new gn(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=a(t));for(var r=this._groups,i=r.length,o=[],s=[],l=0;l<i;++l)for(var c,u=r[l],h=u.length,d=0;d<h;++d)if(c=u[d]){for(var p,f=t.call(c,c.__data__,d,u),m=Xt(c,n),g=0,y=f.length;g<y;++g)(p=f[g])&&Wt(p,e,n,g,f,m);o.push(f),s.push(c)}return new gn(o,s,e,n)},selectChild:vn.selectChild,selectChildren:vn.selectChildren,filter:function(t){"function"!=typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,c=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&c.push(o);return new gn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,c=e[a],u=n[a],h=c.length,d=s[a]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;a<r;++a)s[a]=e[a];return new gn(s,this._parents,this._name,this._id)},selection:function(){return new cn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=yn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=Xt(s,e);Wt(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new gn(r,this._parents,t,n)},call:vn.call,nodes:vn.nodes,node:vn.node,size:vn.size,empty:vn.empty,each:vn.each,on:function(t,e){var n=this._id;return arguments.length<2?Xt(this.node(),n).on.on(t):this.each(ln(n,t,e))},attr:function(t,e){var n=S(t),r="transform"===n?ne:We;return this.attrTween(t,"function"==typeof e?(n.local?Ze:Je)(n,r,oe(this,"attr."+t,e)):null==e?(n.local?Ke:qe)(n):(n.local?Ye:Xe)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=S(t);return this.tween(n,(r.local?tn:en)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?ee:We;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=k(this,t),s=(this.style.removeProperty(t),k(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}(t,r)).on("end.style."+t,un(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var s=k(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=k(this,t)),s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a))}}(t,r,oe(this,"style."+t,e))).each(function(t,e){var n,r,i,o,s="style."+e,a="end."+s;return function(){var l=Kt(this,t),c=l.on,u=null==l.value[s]?o||(o=un(e)):void 0;c===n&&i===u||(r=(n=c).copy()).on(a,i=u),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var s=k(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,dn(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(oe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,fn(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Xt(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?re:ie)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?nn:rn)(e,t)):Xt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?on:sn)(e,t)):Xt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(an(e,t)):Xt(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Kt(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=Kt(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:vn[Symbol.iterator]};var _n={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function wn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}yt.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete t.__transition}}(this,t)}))},yt.prototype.transition=function(t){var e,n;t instanceof gn?(e=t._id,t=t._name):(e=yn(),(n=_n).time=kt(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)(s=a[c])&&Wt(s,t,e,c,a,n||wn(s,e));return new gn(r,this._parents,t,e)};const{abs:bn,max:xn,min:En}=Math;function Sn(t){return{type:t}}function Mn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}["w","e"].map(Sn),["n","s"].map(Sn),["n","w","e","s","nw","ne","sw","se"].map(Sn);var Tn,An=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Rn(t){if(!(e=An.exec(t)))throw new Error("invalid format: "+t);var e;return new Ln({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Ln(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Cn(t,e){var n=Mn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Rn.prototype=Ln.prototype,Ln.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Pn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Cn(100*t,e),r:Cn,s:function(t,e){var n=Mn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Tn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Mn(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function In(t){return t}var On,Nn,kn=Array.prototype.map,Dn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Bn(t){return On=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?In:(e=kn.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(t.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?In:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(kn.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Rn(t)).fill,n=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):Pn[v]||(void 0===g&&(g=12),y=!0,v="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var _="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o:/[%p]/.test(v)?l:"",b=Pn[v],x=/[defgprs%]/.test(v);function E(t){var i,o,l,d=_,E=w;if("c"===v)E=b(t)+E,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:b(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:c:"-"===h||"("===h?"":h)+d,E=("s"===v?Dn[8+Tn/3]:"")+E+(S&&"("===h?")":""),x)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){E=(46===l?s+t.slice(i+1):t.slice(i))+E,t=t.slice(0,i);break}}m&&!p&&(t=r(t,1/0));var M=d.length+t.length+E.length,T=M<f?new Array(f-M+1).join(e):"";switch(m&&p&&(t=r(T+t,T.length?f-E.length:1/0),T=""),n){case"<":t=d+t+E+T;break;case"=":t=d+T+t+E;break;case"^":t=T.slice(0,M=T.length>>1)+d+t+E+T.slice(M);break;default:t=T+d+t+E}return a(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),E.toString=function(){return t+""},E}return{format:h,formatPrefix:function(t,e){var n,r=h(((t=Rn(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor((n=e,((n=Mn(Math.abs(n)))?n[1]:NaN)/3)))),o=Math.pow(10,-i),s=Dn[8+i/3];return function(t){return r(o*t)+s}}}}(t),Nn=On.format,On.formatPrefix,On}function Un(t){return"string"==typeof t?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],ft)}function zn(t){return Un(rt(t).call(document.documentElement))}function Fn(t,e,n){this.k=t,this.x=e,this.y=n}Bn({thousands:",",grouping:[3],currency:["$",""]}),Fn.prototype={constructor:Fn,scale:function(t){return 1===t?this:new Fn(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Fn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Fn(1,0,0),Fn.prototype;const Hn=[];for(let t=0;t<25;t++)Hn.push(parseInt(4*Math.random()));const Gn="137",Vn={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},jn={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Wn=0,qn=1,Kn=2,Xn=3,Yn=0,Jn=1,Zn=2,Qn=3,$n=0,tr=1,er=2,nr=1,rr=2,ir=0,or=1,sr=2,ar=3,lr=4,cr=5,ur=100,hr=101,dr=102,pr=103,fr=104,mr=200,gr=201,yr=202,vr=203,_r=204,wr=205,br=206,xr=207,Er=208,Sr=209,Mr=210,Tr=0,Ar=1,Rr=2,Lr=3,Cr=4,Pr=5,Ir=6,Or=7,Nr=0,kr=1,Dr=2,Br=0,Ur=1,zr=2,Fr=3,Hr=4,Gr=5,Vr=300,jr=301,Wr=302,qr=303,Kr=304,Xr=306,Yr=307,Jr=1e3,Zr=1001,Qr=1002,$r=1003,ti=1004,ei=1004,ni=1005,ri=1005,ii=1006,oi=1007,si=1007,ai=1008,li=1008,ci=1009,ui=1010,hi=1011,di=1012,pi=1013,fi=1014,mi=1015,gi=1016,yi=1017,vi=1018,_i=1020,wi=1021,bi=1023,xi=1024,Ei=1025,Si=1026,Mi=1027,Ti=1028,Ai=1029,Ri=1030,Li=1031,Ci=1033,Pi=33776,Ii=33777,Oi=33778,Ni=33779,ki=35840,Di=35841,Bi=35842,Ui=35843,zi=36196,Fi=37492,Hi=37496,Gi=37808,Vi=37809,ji=37810,Wi=37811,qi=37812,Ki=37813,Xi=37814,Yi=37815,Ji=37816,Zi=37817,Qi=37818,$i=37819,to=37820,eo=37821,no=36492,ro=2200,io=2201,oo=2202,so=2300,ao=2301,lo=2302,co=2400,uo=2401,ho=2402,po=2500,fo=2501,mo=0,go=1,yo=2,vo=3e3,_o=3001,wo=3200,bo=3201,xo=0,Eo=1,So=0,Mo=7680,To=7681,Ao=7682,Ro=7683,Lo=34055,Co=34056,Po=5386,Io=512,Oo=513,No=514,ko=515,Do=516,Bo=517,Uo=518,zo=519,Fo=35044,Ho=35048,Go=35040,Vo=35045,jo=35049,Wo=35041,qo=35046,Ko=35050,Xo=35042,Yo="100",Jo="300 es",Zo=1035;class Qo{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t);t.target=null}}}const $o=[];for(let t=0;t<256;t++)$o[t]=(t<16?"0":"")+t.toString(16);let ts=1234567;const es=Math.PI/180,ns=180/Math.PI;function rs(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return($o[255&t]+$o[t>>8&255]+$o[t>>16&255]+$o[t>>24&255]+"-"+$o[255&e]+$o[e>>8&255]+"-"+$o[e>>16&15|64]+$o[e>>24&255]+"-"+$o[63&n|128]+$o[n>>8&255]+"-"+$o[n>>16&255]+$o[n>>24&255]+$o[255&r]+$o[r>>8&255]+$o[r>>16&255]+$o[r>>24&255]).toUpperCase()}function is(t,e,n){return Math.max(e,Math.min(n,t))}function os(t,e){return(t%e+e)%e}function ss(t,e,n){return(1-n)*t+n*e}function as(t){return 0==(t&t-1)&&0!==t}function ls(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function cs(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}var us=Object.freeze({__proto__:null,DEG2RAD:es,RAD2DEG:ns,generateUUID:rs,clamp:is,euclideanModulo:os,mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:ss,damp:function(t,e,n,r){return ss(t,e,1-Math.exp(-n*r))},pingpong:function(t,e=1){return e-Math.abs(os(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(ts=t%2147483647),ts=16807*ts%2147483647,(ts-1)/2147483646},degToRad:function(t){return t*es},radToDeg:function(t){return t*ns},isPowerOfTwo:as,ceilPowerOfTwo:ls,floorPowerOfTwo:cs,setQuaternionFromProperEuler:function(t,e,n,r,i){const o=Math.cos,s=Math.sin,a=o(n/2),l=s(n/2),c=o((e+r)/2),u=s((e+r)/2),h=o((e-r)/2),d=s((e-r)/2),p=o((r-e)/2),f=s((r-e)/2);switch(i){case"XYX":t.set(a*u,l*h,l*d,a*c);break;case"YZY":t.set(l*d,a*u,l*h,a*c);break;case"ZXZ":t.set(l*h,l*d,a*u,a*c);break;case"XZX":t.set(a*u,l*f,l*p,a*c);break;case"YXY":t.set(l*p,a*u,l*f,a*c);break;case"ZYZ":t.set(l*f,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}});class hs{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}hs.prototype.isVector2=!0;class ds{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,o,s,a,l){const c=this.elements;return c[0]=t,c[1]=r,c[2]=s,c[3]=e,c[4]=i,c[5]=a,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],s=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],g=r[6],y=r[1],v=r[4],_=r[7],w=r[2],b=r[5],x=r[8];return i[0]=o*f+s*y+a*w,i[3]=o*m+s*v+a*b,i[6]=o*g+s*_+a*x,i[1]=l*f+c*y+u*w,i[4]=l*m+c*v+u*b,i[7]=l*g+c*_+u*x,i[2]=h*f+d*y+p*w,i[5]=h*m+d*v+p*b,i[8]=h*g+d*_+p*x,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8];return e*o*c-e*s*l-n*i*c+n*s*a+r*i*l-r*o*a}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=c*o-s*l,h=s*a-c*i,d=l*i-o*a,p=e*u+n*h+r*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=u*f,t[1]=(r*l-c*n)*f,t[2]=(s*n-r*o)*f,t[3]=h*f,t[4]=(c*e-r*a)*f,t[5]=(r*i-s*e)*f,t[6]=d*f,t[7]=(n*a-l*e)*f,t[8]=(o*e-n*i)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,o,s){const a=Math.cos(i),l=Math.sin(i);return this.set(n*a,n*l,-n*(a*o+l*s)+o+t,-r*l,r*a,-r*(-l*o+a*s)+s+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],s=r[6],a=r[1],l=r[4],c=r[7];return r[0]=e*i+n*a,r[3]=e*o+n*l,r[6]=e*s+n*c,r[1]=-n*i+e*a,r[4]=-n*o+e*l,r[7]=-n*s+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function ps(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}ds.prototype.isMatrix3=!0;const fs={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ms(t,e){return new fs[t](e)}function gs(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const ys={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vs={h:0,s:0,l:0},_s={h:0,s:0,l:0};function ws(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function bs(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function xs(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class Es{constructor(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=os(t,1),e=is(e,0,1),n=is(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=ws(i,r,t+1/3),this.g=ws(i,r,t),this.b=ws(i,r,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const r=n[1],i=n[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){const n=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,i=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,r,i)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=ys[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=bs(t.r),this.g=bs(t.g),this.b=bs(t.b),this}copyLinearToSRGB(t){return this.r=xs(t.r),this.g=xs(t.g),this.b=xs(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,r=this.b,i=Math.max(e,n,r),o=Math.min(e,n,r);let s,a;const l=(o+i)/2;if(o===i)s=0,a=0;else{const t=i-o;switch(a=l<=.5?t/(i+o):t/(2-i-o),i){case e:s=(n-r)/t+(n<r?6:0);break;case n:s=(r-e)/t+2;break;case r:s=(e-n)/t+4}s/=6}return t.h=s,t.s=a,t.l=l,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(vs),vs.h+=t,vs.s+=e,vs.l+=n,this.setHSL(vs.h,vs.s,vs.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(vs),t.getHSL(_s);const n=ss(vs.h,_s.h,e),r=ss(vs.s,_s.s,e),i=ss(vs.l,_s.l,e);return this.setHSL(n,r,i),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}let Ss;Es.NAMES=ys,Es.prototype.isColor=!0,Es.prototype.r=1,Es.prototype.g=1,Es.prototype.b=1;class Ms{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Ss&&(Ss=gs("canvas")),Ss.width=t.width,Ss.height=t.height;const n=Ss.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Ss}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=gs("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),i=r.data;for(let t=0;t<i.length;t++)i[t]=255*bs(i[t]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*bs(e[t]/255)):e[t]=bs(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Ts=0;class As extends Qo{constructor(t=As.DEFAULT_IMAGE,e=As.DEFAULT_MAPPING,n=Zr,r=Zr,i=ii,o=ai,s=bi,a=ci,l=1,c=vo){super(),Object.defineProperty(this,"id",{value:Ts++}),this.uuid=rs(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=a,this.offset=new hs(0,0),this.repeat=new hs(1,1),this.center=new hs(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ds,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const r=this.image;if(void 0===r.uuid&&(r.uuid=rs()),!e&&void 0===t.images[r.uuid]){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(Rs(r[t].image)):e.push(Rs(r[t]))}else e=Rs(r);t.images[r.uuid]={uuid:r.uuid,url:e}}n.image=r.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Vr)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Jr:t.x=t.x-Math.floor(t.x);break;case Zr:t.x=t.x<0?0:1;break;case Qr:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Jr:t.y=t.y-Math.floor(t.y);break;case Zr:t.y=t.y<0?0:1;break;case Qr:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function Rs(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Ms.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}As.DEFAULT_IMAGE=void 0,As.DEFAULT_MAPPING=Vr,As.prototype.isTexture=!0;class Ls{constructor(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const o=.01,s=.1,a=t.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<o&&Math.abs(u-f)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<s&&Math.abs(u+f)<s&&Math.abs(p+m)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,a=(d+1)/2,y=(g+1)/2,v=(c+h)/4,_=(u+f)/4,w=(p+m)/4;return t>a&&t>y?t<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=v/n,i=_/n):a>y?a<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(a),n=v/r,i=w/r):y<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(y),n=_/i,r=w/i),this.set(n,r,i,e),this}let y=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(u-f)/y,this.z=(h-c)/y,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Ls.prototype.isVector4=!0;class Cs extends Qo{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Ls(0,0,t,e),this.scissorTest=!1,this.viewport=new Ls(0,0,t,e),this.texture=new As(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:ii,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=Object.assign({},t.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Cs.prototype.isWebGLRenderTarget=!0;class Ps extends Cs{constructor(t,e,n){super(t,e);const r=this.texture;this.texture=[];for(let t=0;t<n;t++)this.texture[t]=r.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}Ps.prototype.isWebGLMultipleRenderTargets=!0;class Is extends Cs{constructor(t,e,n={}){super(t,e,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(t){return super.copy.call(this,t),this.samples=t.samples,this.useRenderToTexture=t.useRenderToTexture,this.useRenderbuffer=t.useRenderbuffer,this}}Is.prototype.isWebGLMultisampleRenderTarget=!0;class Os{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,i,o,s){let a=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[o+0],d=i[o+1],p=i[o+2],f=i[o+3];if(0===s)return t[e+0]=a,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===s)return t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(u!==f||a!==h||l!==d||c!==p){let t=1-s;const e=a*h+l*d+c*p+u*f,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,e*n);t=Math.sin(t*o)/i,s=Math.sin(s*o)/i}const i=s*n;if(a=a*t+h*i,l=l*t+d*i,c=c*t+p*i,u=u*t+f*i,t===1-s){const t=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=t,l*=t,c*=t,u*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,r,i,o){const s=n[r],a=n[r+1],l=n[r+2],c=n[r+3],u=i[o],h=i[o+1],d=i[o+2],p=i[o+3];return t[e]=s*p+c*u+a*d-l*h,t[e+1]=a*p+c*h+l*u-s*d,t[e+2]=l*p+c*d+s*h-a*u,t[e+3]=c*p-s*u-a*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,i=t._z,o=t._order,s=Math.cos,a=Math.sin,l=s(n/2),c=s(r/2),u=s(i/2),h=a(n/2),d=a(r/2),p=a(i/2);switch(o){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],s=e[5],a=e[9],l=e[2],c=e[6],u=e[10],h=n+s+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-a)*t,this._y=(i-l)*t,this._z=(o-r)*t}else if(n>s&&n>u){const t=2*Math.sqrt(1+n-s-u);this._w=(c-a)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+l)/t}else if(s>u){const t=2*Math.sqrt(1+s-n-u);this._w=(i-l)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+u-n-s);this._w=(o-r)/t,this._x=(i+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(is(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,o=t._w,s=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+o*s+r*l-i*a,this._y=r*c+o*a+i*s-n*l,this._z=i*c+o*l+n*a-r*s,this._w=o*c-n*s-r*a-i*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,o=this._w;let s=o*t._w+n*t._x+r*t._y+i*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const a=1-s*s;if(a<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,s),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(i),n*Math.cos(i),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Os.prototype.isQuaternion=!0;class Ns{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ds.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Ds.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,s=t.z,a=t.w,l=a*e+o*r-s*n,c=a*n+s*e-i*r,u=a*r+i*n-o*e,h=-i*e-o*n-s*r;return this.x=l*a+h*-i+c*-s-u*-o,this.y=c*a+h*-o+u*-i-l*-s,this.z=u*a+h*-s+l*-o-c*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,o=e.x,s=e.y,a=e.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return ks.copy(this).projectOnVector(t),this.sub(ks)}reflect(t){return this.sub(ks.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(is(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Ns.prototype.isVector3=!0;const ks=new Ns,Ds=new Os;class Bs{constructor(t=new Ns(1/0,1/0,1/0),e=new Ns(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=t.length;a<l;a+=3){const l=t[a],c=t[a+1],u=t[a+2];l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(e,n,r),this.max.set(i,o,s),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=t.count;a<l;a++){const l=t.getX(a),c=t.getY(a),u=t.getZ(a);l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(e,n,r),this.max.set(i,o,s),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=zs.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){const e=n.attributes.position;for(let n=0,r=e.count;n<r;n++)zs.fromBufferAttribute(e,n).applyMatrix4(t.matrixWorld),this.expandByPoint(zs)}else null===n.boundingBox&&n.computeBoundingBox(),Fs.copy(n.boundingBox),Fs.applyMatrix4(t.matrixWorld),this.union(Fs);const r=t.children;for(let t=0,n=r.length;t<n;t++)this.expandByObject(r[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,zs),zs.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Ks),Xs.subVectors(this.max,Ks),Hs.subVectors(t.a,Ks),Gs.subVectors(t.b,Ks),Vs.subVectors(t.c,Ks),js.subVectors(Gs,Hs),Ws.subVectors(Vs,Gs),qs.subVectors(Hs,Vs);let e=[0,-js.z,js.y,0,-Ws.z,Ws.y,0,-qs.z,qs.y,js.z,0,-js.x,Ws.z,0,-Ws.x,qs.z,0,-qs.x,-js.y,js.x,0,-Ws.y,Ws.x,0,-qs.y,qs.x,0];return!!Zs(e,Hs,Gs,Vs,Xs)&&(e=[1,0,0,0,1,0,0,0,1],!!Zs(e,Hs,Gs,Vs,Xs)&&(Ys.crossVectors(js,Ws),e=[Ys.x,Ys.y,Ys.z],Zs(e,Hs,Gs,Vs,Xs)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return zs.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(zs).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Us[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Us[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Us[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Us[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Us[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Us[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Us[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Us[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Us)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}Bs.prototype.isBox3=!0;const Us=[new Ns,new Ns,new Ns,new Ns,new Ns,new Ns,new Ns,new Ns],zs=new Ns,Fs=new Bs,Hs=new Ns,Gs=new Ns,Vs=new Ns,js=new Ns,Ws=new Ns,qs=new Ns,Ks=new Ns,Xs=new Ns,Ys=new Ns,Js=new Ns;function Zs(t,e,n,r,i){for(let o=0,s=t.length-3;o<=s;o+=3){Js.fromArray(t,o);const s=i.x*Math.abs(Js.x)+i.y*Math.abs(Js.y)+i.z*Math.abs(Js.z),a=e.dot(Js),l=n.dot(Js),c=r.dot(Js);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>s)return!1}return!0}const Qs=new Bs,$s=new Ns,ta=new Ns,ea=new Ns;class na{constructor(t=new Ns,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):Qs.setFromPoints(t).getCenter(n);let r=0;for(let e=0,i=t.length;e<i;e++)r=Math.max(r,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){ea.subVectors(t,this.center);const e=ea.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(ea.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return!0===this.center.equals(t.center)?ta.set(0,0,1).multiplyScalar(t.radius):ta.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint($s.copy(t.center).add(ta)),this.expandByPoint($s.copy(t.center).sub(ta)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ra=new Ns,ia=new Ns,oa=new Ns,sa=new Ns,aa=new Ns,la=new Ns,ca=new Ns;class ua{constructor(t=new Ns,e=new Ns(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,ra)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=ra.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(ra.copy(this.direction).multiplyScalar(e).add(this.origin),ra.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){ia.copy(t).add(e).multiplyScalar(.5),oa.copy(e).sub(t).normalize(),sa.copy(this.origin).sub(ia);const i=.5*t.distanceTo(e),o=-this.direction.dot(oa),s=sa.dot(this.direction),a=-sa.dot(oa),l=sa.lengthSq(),c=Math.abs(1-o*o);let u,h,d,p;if(c>0)if(u=o*a-s,h=o*s-a,p=i*c,u>=0)if(h>=-p)if(h<=p){const t=1/c;u*=t,h*=t,d=u*(u+o*h+2*s)+h*(o*u+h+2*a)+l}else h=i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-o*i+s)),h=u>0?-i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+l):(u=Math.max(0,-(o*i+s)),h=u>0?i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l);else h=o>0?-i:i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(oa).multiplyScalar(h).add(ia),d}intersectSphere(t,e){ra.subVectors(t.center,this.origin);const n=ra.dot(this.direction),r=ra.dot(ra)-n*n,i=t.radius*t.radius;if(r>i)return null;const o=Math.sqrt(i-r),s=n-o,a=n+o;return s<0&&a<0?null:s<0?this.at(a,e):this.at(s,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,i,o,s,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),c>=0?(i=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),u>=0?(s=(t.min.z-h.z)*u,a=(t.max.z-h.z)*u):(s=(t.max.z-h.z)*u,a=(t.min.z-h.z)*u),n>a||s>r?null:((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,ra)}intersectTriangle(t,e,n,r,i){aa.subVectors(e,t),la.subVectors(n,t),ca.crossVectors(aa,la);let o,s=this.direction.dot(ca);if(s>0){if(r)return null;o=1}else{if(!(s<0))return null;o=-1,s=-s}sa.subVectors(this.origin,t);const a=o*this.direction.dot(la.crossVectors(sa,la));if(a<0)return null;const l=o*this.direction.dot(aa.cross(sa));if(l<0)return null;if(a+l>s)return null;const c=-o*sa.dot(ca);return c<0?null:this.at(c/s,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ha{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,o,s,a,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ha).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/da.setFromMatrixColumn(t,0).length(),i=1/da.setFromMatrixColumn(t,1).length(),o=1/da.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){const t=o*c,n=o*u,r=s*c,i=s*u;e[0]=a*c,e[4]=-a*u,e[8]=l,e[1]=n+r*l,e[5]=t-i*l,e[9]=-s*a,e[2]=i-t*l,e[6]=r+n*l,e[10]=o*a}else if("YXZ"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t+i*s,e[4]=r*s-n,e[8]=o*l,e[1]=o*u,e[5]=o*c,e[9]=-s,e[2]=n*s-r,e[6]=i+t*s,e[10]=o*a}else if("ZXY"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t-i*s,e[4]=-o*u,e[8]=r+n*s,e[1]=n+r*s,e[5]=o*c,e[9]=i-t*s,e[2]=-o*l,e[6]=s,e[10]=o*a}else if("ZYX"===t.order){const t=o*c,n=o*u,r=s*c,i=s*u;e[0]=a*c,e[4]=r*l-n,e[8]=t*l+i,e[1]=a*u,e[5]=i*l+t,e[9]=n*l-r,e[2]=-l,e[6]=s*a,e[10]=o*a}else if("YZX"===t.order){const t=o*a,n=o*l,r=s*a,i=s*l;e[0]=a*c,e[4]=i-t*u,e[8]=r*u+n,e[1]=u,e[5]=o*c,e[9]=-s*c,e[2]=-l*c,e[6]=n*u+r,e[10]=t-i*u}else if("XZY"===t.order){const t=o*a,n=o*l,r=s*a,i=s*l;e[0]=a*c,e[4]=-u,e[8]=l*c,e[1]=t*u+i,e[5]=o*c,e[9]=n*u-r,e[2]=r*u-n,e[6]=s*c,e[10]=i*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(fa,t,ma)}lookAt(t,e,n){const r=this.elements;return va.subVectors(t,e),0===va.lengthSq()&&(va.z=1),va.normalize(),ga.crossVectors(n,va),0===ga.lengthSq()&&(1===Math.abs(n.z)?va.x+=1e-4:va.z+=1e-4,va.normalize(),ga.crossVectors(n,va)),ga.normalize(),ya.crossVectors(va,ga),r[0]=ga.x,r[4]=ya.x,r[8]=va.x,r[1]=ga.y,r[5]=ya.y,r[9]=va.y,r[2]=ga.z,r[6]=ya.z,r[10]=va.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],s=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],y=n[3],v=n[7],_=n[11],w=n[15],b=r[0],x=r[4],E=r[8],S=r[12],M=r[1],T=r[5],A=r[9],R=r[13],L=r[2],C=r[6],P=r[10],I=r[14],O=r[3],N=r[7],k=r[11],D=r[15];return i[0]=o*b+s*M+a*L+l*O,i[4]=o*x+s*T+a*C+l*N,i[8]=o*E+s*A+a*P+l*k,i[12]=o*S+s*R+a*I+l*D,i[1]=c*b+u*M+h*L+d*O,i[5]=c*x+u*T+h*C+d*N,i[9]=c*E+u*A+h*P+d*k,i[13]=c*S+u*R+h*I+d*D,i[2]=p*b+f*M+m*L+g*O,i[6]=p*x+f*T+m*C+g*N,i[10]=p*E+f*A+m*P+g*k,i[14]=p*S+f*R+m*I+g*D,i[3]=y*b+v*M+_*L+w*O,i[7]=y*x+v*T+_*C+w*N,i[11]=y*E+v*A+_*P+w*k,i[15]=y*S+v*R+_*I+w*D,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],s=t[5],a=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+i*a*u-r*l*u-i*s*h+n*l*h+r*s*d-n*a*d)+t[7]*(+e*a*d-e*l*h+i*o*h-r*o*d+r*l*c-i*a*c)+t[11]*(+e*l*u-e*s*d-i*o*u+n*o*d+i*s*c-n*l*c)+t[15]*(-r*s*c-e*a*u+e*s*h+r*o*u-n*o*h+n*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],y=u*m*l-f*h*l+f*a*d-s*m*d-u*a*g+s*h*g,v=p*h*l-c*m*l-p*a*d+o*m*d+c*a*g-o*h*g,_=c*f*l-p*u*l+p*s*d-o*f*d-c*s*g+o*u*g,w=p*u*a-c*f*a-p*s*h+o*f*h+c*s*m-o*u*m,b=e*y+n*v+r*_+i*w;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/b;return t[0]=y*x,t[1]=(f*h*i-u*m*i-f*r*d+n*m*d+u*r*g-n*h*g)*x,t[2]=(s*m*i-f*a*i+f*r*l-n*m*l-s*r*g+n*a*g)*x,t[3]=(u*a*i-s*h*i-u*r*l+n*h*l+s*r*d-n*a*d)*x,t[4]=v*x,t[5]=(c*m*i-p*h*i+p*r*d-e*m*d-c*r*g+e*h*g)*x,t[6]=(p*a*i-o*m*i-p*r*l+e*m*l+o*r*g-e*a*g)*x,t[7]=(o*h*i-c*a*i+c*r*l-e*h*l-o*r*d+e*a*d)*x,t[8]=_*x,t[9]=(p*u*i-c*f*i-p*n*d+e*f*d+c*n*g-e*u*g)*x,t[10]=(o*f*i-p*s*i+p*n*l-e*f*l-o*n*g+e*s*g)*x,t[11]=(c*s*i-o*u*i-c*n*l+e*u*l+o*n*d-e*s*d)*x,t[12]=w*x,t[13]=(c*f*r-p*u*r+p*n*h-e*f*h-c*n*m+e*u*m)*x,t[14]=(p*s*r-o*f*r-p*n*a+e*f*a+o*n*m-e*s*m)*x,t[15]=(o*u*r-c*s*r+c*n*a-e*u*a-o*n*h+e*s*h)*x,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,s=t.y,a=t.z,l=i*o,c=i*s;return this.set(l*o+n,l*s-r*a,l*a+r*s,0,l*s+r*a,c*s+n,c*a-r*o,0,l*a-r*s,c*a+r*o,i*a*a+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,o){return this.set(1,n,i,0,t,1,o,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,o=e._y,s=e._z,a=e._w,l=i+i,c=o+o,u=s+s,h=i*l,d=i*c,p=i*u,f=o*c,m=o*u,g=s*u,y=a*l,v=a*c,_=a*u,w=n.x,b=n.y,x=n.z;return r[0]=(1-(f+g))*w,r[1]=(d+_)*w,r[2]=(p-v)*w,r[3]=0,r[4]=(d-_)*b,r[5]=(1-(h+g))*b,r[6]=(m+y)*b,r[7]=0,r[8]=(p+v)*x,r[9]=(m-y)*x,r[10]=(1-(h+f))*x,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=da.set(r[0],r[1],r[2]).length();const o=da.set(r[4],r[5],r[6]).length(),s=da.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],pa.copy(this);const a=1/i,l=1/o,c=1/s;return pa.elements[0]*=a,pa.elements[1]*=a,pa.elements[2]*=a,pa.elements[4]*=l,pa.elements[5]*=l,pa.elements[6]*=l,pa.elements[8]*=c,pa.elements[9]*=c,pa.elements[10]*=c,e.setFromRotationMatrix(pa),n.x=i,n.y=o,n.z=s,this}makePerspective(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const s=this.elements,a=2*i/(e-t),l=2*i/(n-r),c=(e+t)/(e-t),u=(n+r)/(n-r),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return s[0]=a,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(t,e,n,r,i,o){const s=this.elements,a=1/(e-t),l=1/(n-r),c=1/(o-i),u=(e+t)*a,h=(n+r)*l,d=(o+i)*c;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}ha.prototype.isMatrix4=!0;const da=new Ns,pa=new ha,fa=new Ns(0,0,0),ma=new Ns(1,1,1),ga=new Ns,ya=new Ns,va=new Ns,_a=new ha,wa=new Os;class ba{constructor(t=0,e=0,n=0,r=ba.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,i=r[0],o=r[4],s=r[8],a=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(e){case"XYZ":this._y=Math.asin(is(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-is(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(is(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-is(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(is(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-is(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return _a.makeRotationFromQuaternion(t),this.setFromRotationMatrix(_a,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return wa.setFromEuler(this),this.setFromQuaternion(wa,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new Ns(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}ba.prototype.isEuler=!0,ba.DefaultOrder="XYZ",ba.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class xa{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let Ea=0;const Sa=new Ns,Ma=new Os,Ta=new ha,Aa=new Ns,Ra=new Ns,La=new Ns,Ca=new Os,Pa=new Ns(1,0,0),Ia=new Ns(0,1,0),Oa=new Ns(0,0,1),Na={type:"added"},ka={type:"removed"};class Da extends Qo{constructor(){super(),Object.defineProperty(this,"id",{value:Ea++}),this.uuid=rs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Da.DefaultUp.clone();const t=new Ns,e=new ba,n=new Os,r=new Ns(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ha},normalMatrix:{value:new ds}}),this.matrix=new ha,this.matrixWorld=new ha,this.matrixAutoUpdate=Da.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new xa,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Ma.setFromAxisAngle(t,e),this.quaternion.multiply(Ma),this}rotateOnWorldAxis(t,e){return Ma.setFromAxisAngle(t,e),this.quaternion.premultiply(Ma),this}rotateX(t){return this.rotateOnAxis(Pa,t)}rotateY(t){return this.rotateOnAxis(Ia,t)}rotateZ(t){return this.rotateOnAxis(Oa,t)}translateOnAxis(t,e){return Sa.copy(t).applyQuaternion(this.quaternion),this.position.add(Sa.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Pa,t)}translateY(t){return this.translateOnAxis(Ia,t)}translateZ(t){return this.translateOnAxis(Oa,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Ta.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Aa.copy(t):Aa.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Ra.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ta.lookAt(Ra,Aa,this.up):Ta.lookAt(Aa,Ra,this.up),this.quaternion.setFromRotationMatrix(Ta),r&&(Ta.extractRotation(r.matrixWorld),Ma.setFromRotationMatrix(Ta),this.quaternion.premultiply(Ma.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Na)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(ka)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(ka)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Ta.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Ta.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ta),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ra,t,La),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ra,Ca,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=o(t.geometries),r=o(t.materials),i=o(t.textures),s=o(t.images),a=o(t.shapes),l=o(t.skeletons),c=o(t.animations);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=r,n;function o(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}}Da.DefaultUp=new Ns(0,1,0),Da.DefaultMatrixAutoUpdate=!0,Da.prototype.isObject3D=!0;const Ba=new Ns,Ua=new Ns,za=new Ns,Fa=new Ns,Ha=new Ns,Ga=new Ns,Va=new Ns,ja=new Ns,Wa=new Ns,qa=new Ns;class Ka{constructor(t=new Ns,e=new Ns,n=new Ns){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),Ba.subVectors(t,e),r.cross(Ba);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){Ba.subVectors(r,e),Ua.subVectors(n,e),za.subVectors(t,e);const o=Ba.dot(Ba),s=Ba.dot(Ua),a=Ba.dot(za),l=Ua.dot(Ua),c=Ua.dot(za),u=o*l-s*s;if(0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*a-s*c)*h,p=(o*c-s*a)*h;return i.set(1-d-p,p,d)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Fa),Fa.x>=0&&Fa.y>=0&&Fa.x+Fa.y<=1}static getUV(t,e,n,r,i,o,s,a){return this.getBarycoord(t,e,n,r,Fa),a.set(0,0),a.addScaledVector(i,Fa.x),a.addScaledVector(o,Fa.y),a.addScaledVector(s,Fa.z),a}static isFrontFacing(t,e,n,r){return Ba.subVectors(n,e),Ua.subVectors(t,e),Ba.cross(Ua).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Ba.subVectors(this.c,this.b),Ua.subVectors(this.a,this.b),.5*Ba.cross(Ua).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ka.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Ka.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,i){return Ka.getUV(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return Ka.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ka.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,i=this.c;let o,s;Ha.subVectors(r,n),Ga.subVectors(i,n),ja.subVectors(t,n);const a=Ha.dot(ja),l=Ga.dot(ja);if(a<=0&&l<=0)return e.copy(n);Wa.subVectors(t,r);const c=Ha.dot(Wa),u=Ga.dot(Wa);if(c>=0&&u<=c)return e.copy(r);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return o=a/(a-c),e.copy(n).addScaledVector(Ha,o);qa.subVectors(t,i);const d=Ha.dot(qa),p=Ga.dot(qa);if(p>=0&&d<=p)return e.copy(i);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return s=l/(l-p),e.copy(n).addScaledVector(Ga,s);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return Va.subVectors(i,r),s=(u-c)/(u-c+(d-p)),e.copy(r).addScaledVector(Va,s);const g=1/(m+f+h);return o=f*g,s=h*g,e.copy(n).addScaledVector(Ha,o).addScaledVector(Ga,s)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let Xa=0;class Ya extends Qo{constructor(){super(),Object.defineProperty(this,"id",{value:Xa++}),this.uuid=rs(),this.name="",this.type="Material",this.fog=!0,this.blending=or,this.side=$n,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=_r,this.blendDst=wr,this.blendEquation=ur,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Lr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=zo,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Mo,this.stencilZFail=Mo,this.stencilZPass=Mo,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.alphaWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===nr;continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==or&&(n.blending=this.blending),this.side!==$n&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.alphaWrite=this.alphaWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.alphaWrite=t.alphaWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}Ya.prototype.isMaterial=!0;class Ja extends Ya{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new Es(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Ja.prototype.isMeshBasicMaterial=!0;const Za=new Ns,Qa=new hs;class $a{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=Fo,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new Es),e[n++]=i.r,e[n++]=i.g,e[n++]=i.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new hs),e[n++]=i.x,e[n++]=i.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new Ns),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new Ls),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z,e[n++]=i.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Qa.fromBufferAttribute(this,e),Qa.applyMatrix3(t),this.setXY(e,Qa.x,Qa.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Za.fromBufferAttribute(this,e),Za.applyMatrix3(t),this.setXYZ(e,Za.x,Za.y,Za.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Za.x=this.getX(e),Za.y=this.getY(e),Za.z=this.getZ(e),Za.applyMatrix4(t),this.setXYZ(e,Za.x,Za.y,Za.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Za.x=this.getX(e),Za.y=this.getY(e),Za.z=this.getZ(e),Za.applyNormalMatrix(t),this.setXYZ(e,Za.x,Za.y,Za.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Za.x=this.getX(e),Za.y=this.getY(e),Za.z=this.getZ(e),Za.transformDirection(t),this.setXYZ(e,Za.x,Za.y,Za.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Fo&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}$a.prototype.isBufferAttribute=!0;class tl extends $a{constructor(t,e,n){super(new Int8Array(t),e,n)}}class el extends $a{constructor(t,e,n){super(new Uint8Array(t),e,n)}}class nl extends $a{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}}class rl extends $a{constructor(t,e,n){super(new Int16Array(t),e,n)}}class il extends $a{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class ol extends $a{constructor(t,e,n){super(new Int32Array(t),e,n)}}class sl extends $a{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class al extends $a{constructor(t,e,n){super(new Uint16Array(t),e,n)}}al.prototype.isFloat16BufferAttribute=!0;class ll extends $a{constructor(t,e,n){super(new Float32Array(t),e,n)}}class cl extends $a{constructor(t,e,n){super(new Float64Array(t),e,n)}}let ul=0;const hl=new ha,dl=new Da,pl=new Ns,fl=new Bs,ml=new Bs,gl=new Ns;class yl extends Qo{constructor(){super(),Object.defineProperty(this,"id",{value:ul++}),this.uuid=rs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(ps(t)?sl:il)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new ds).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return hl.makeRotationFromQuaternion(t),this.applyMatrix4(hl),this}rotateX(t){return hl.makeRotationX(t),this.applyMatrix4(hl),this}rotateY(t){return hl.makeRotationY(t),this.applyMatrix4(hl),this}rotateZ(t){return hl.makeRotationZ(t),this.applyMatrix4(hl),this}translate(t,e,n){return hl.makeTranslation(t,e,n),this.applyMatrix4(hl),this}scale(t,e,n){return hl.makeScale(t,e,n),this.applyMatrix4(hl),this}lookAt(t){return dl.lookAt(t),dl.updateMatrix(),this.applyMatrix4(dl.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pl).negate(),this.translate(pl.x,pl.y,pl.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new ll(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Bs);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ns(-1/0,-1/0,-1/0),new Ns(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];fl.setFromBufferAttribute(n),this.morphTargetsRelative?(gl.addVectors(this.boundingBox.min,fl.min),this.boundingBox.expandByPoint(gl),gl.addVectors(this.boundingBox.max,fl.max),this.boundingBox.expandByPoint(gl)):(this.boundingBox.expandByPoint(fl.min),this.boundingBox.expandByPoint(fl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new na);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ns,1/0);if(t){const n=this.boundingSphere.center;if(fl.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];ml.setFromBufferAttribute(n),this.morphTargetsRelative?(gl.addVectors(fl.min,ml.min),fl.expandByPoint(gl),gl.addVectors(fl.max,ml.max),fl.expandByPoint(gl)):(fl.expandByPoint(ml.min),fl.expandByPoint(ml.max))}fl.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)gl.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(gl));if(e)for(let i=0,o=e.length;i<o;i++){const o=e[i],s=this.morphTargetsRelative;for(let e=0,i=o.count;e<i;e++)gl.fromBufferAttribute(o,e),s&&(pl.fromBufferAttribute(t,e),gl.add(pl)),r=Math.max(r,n.distanceToSquared(gl))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,i=e.normal.array,o=e.uv.array,s=r.length/3;void 0===e.tangent&&this.setAttribute("tangent",new $a(new Float32Array(4*s),4));const a=e.tangent.array,l=[],c=[];for(let t=0;t<s;t++)l[t]=new Ns,c[t]=new Ns;const u=new Ns,h=new Ns,d=new Ns,p=new hs,f=new hs,m=new hs,g=new Ns,y=new Ns;function v(t,e,n){u.fromArray(r,3*t),h.fromArray(r,3*e),d.fromArray(r,3*n),p.fromArray(o,2*t),f.fromArray(o,2*e),m.fromArray(o,2*n),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const i=1/(f.x*m.y-m.x*f.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(i),y.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(i),l[t].add(g),l[e].add(g),l[n].add(g),c[t].add(y),c[e].add(y),c[n].add(y))}let _=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(let t=0,e=_.length;t<e;++t){const e=_[t],r=e.start;for(let t=r,i=r+e.count;t<i;t+=3)v(n[t+0],n[t+1],n[t+2])}const w=new Ns,b=new Ns,x=new Ns,E=new Ns;function S(t){x.fromArray(i,3*t),E.copy(x);const e=l[t];w.copy(e),w.sub(x.multiplyScalar(x.dot(e))).normalize(),b.crossVectors(E,e);const n=b.dot(c[t])<0?-1:1;a[4*t]=w.x,a[4*t+1]=w.y,a[4*t+2]=w.z,a[4*t+3]=n}for(let t=0,e=_.length;t<e;++t){const e=_[t],r=e.start;for(let t=r,i=r+e.count;t<i;t+=3)S(n[t+0]),S(n[t+1]),S(n[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new $a(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new Ns,i=new Ns,o=new Ns,s=new Ns,a=new Ns,l=new Ns,c=new Ns,u=new Ns;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),p=t.getX(h+1),f=t.getX(h+2);r.fromBufferAttribute(e,d),i.fromBufferAttribute(e,p),o.fromBufferAttribute(e,f),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),s.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),s.add(c),a.add(c),l.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,s=e.count;t<s;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===t.attributes[r])continue;const i=n[r].array,o=t.attributes[r],s=o.array,a=o.itemSize*e,l=Math.min(s.length,i.length-a);for(let t=0,e=a;t<l;t++,e++)i[e]=s[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)gl.fromBufferAttribute(t,e),gl.normalize(),t.setXYZ(e,gl.x,gl.y,gl.z)}toNonIndexed(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,o=new n.constructor(e.length*r);let s=0,a=0;for(let i=0,l=e.length;i<l;i++){s=t.isInterleavedBufferAttribute?e[i]*t.data.stride+t.offset:e[i]*r;for(let t=0;t<r;t++)o[a++]=n[s++]}return new $a(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new yl,n=this.index.array,r=this.attributes;for(const i in r){const o=t(r[i],n);e.setAttribute(i,o)}const i=this.morphAttributes;for(const r in i){const o=[],s=i[r];for(let e=0,r=s.length;e<r;e++){const r=t(s[e],n);o.push(r)}e.morphAttributes[r]=o}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let t=0,n=o.length;t<n;t++){const n=o[t];e.addGroup(n.start,n.count,n.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const r=n[e];t.data.attributes[e]=r.toJSON(t.data)}const r={};let i=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],o=[];for(let e=0,r=n.length;e<r;e++){const r=n[e];o.push(r.toJSON(t.data))}o.length>0&&(r[e]=o,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return null!==s&&(t.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const t in r){const n=r[t];this.setAttribute(t,n.clone(e))}const i=t.morphAttributes;for(const t in i){const n=[],r=i[t];for(let t=0,i=r.length;t<i;t++)n.push(r[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let t=0,e=o.length;t<e;t++){const e=o[t];this.addGroup(e.start,e.count,e.materialIndex)}const s=t.boundingBox;null!==s&&(this.boundingBox=s.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}yl.prototype.isBufferGeometry=!0;const vl=new ha,_l=new ua,wl=new na,bl=new Ns,xl=new Ns,El=new Ns,Sl=new Ns,Ml=new Ns,Tl=new Ns,Al=new Ns,Rl=new Ns,Ll=new Ns,Cl=new hs,Pl=new hs,Il=new hs,Ol=new Ns,Nl=new Ns;class kl extends Da{constructor(t=new yl,e=new Ja){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),wl.copy(n.boundingSphere),wl.applyMatrix4(i),!1===t.ray.intersectsSphere(wl))return;if(vl.copy(i).invert(),_l.copy(t.ray).applyMatrix4(vl),null!==n.boundingBox&&!1===_l.intersectsBox(n.boundingBox))return;let o;if(n.isBufferGeometry){const i=n.index,s=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==i)if(Array.isArray(r))for(let n=0,p=h.length;n<p;n++){const p=h[n],f=r[p.materialIndex];for(let n=Math.max(p.start,d.start),r=Math.min(i.count,Math.min(p.start+p.count,d.start+d.count));n<r;n+=3){const r=i.getX(n),h=i.getX(n+1),d=i.getX(n+2);o=Dl(this,f,t,_l,s,a,l,c,u,r,h,d),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=p.materialIndex,e.push(o))}}else for(let n=Math.max(0,d.start),h=Math.min(i.count,d.start+d.count);n<h;n+=3){const h=i.getX(n),d=i.getX(n+1),p=i.getX(n+2);o=Dl(this,r,t,_l,s,a,l,c,u,h,d,p),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}else if(void 0!==s)if(Array.isArray(r))for(let n=0,i=h.length;n<i;n++){const i=h[n],p=r[i.materialIndex];for(let n=Math.max(i.start,d.start),r=Math.min(s.count,Math.min(i.start+i.count,d.start+d.count));n<r;n+=3)o=Dl(this,p,t,_l,s,a,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=i.materialIndex,e.push(o))}else for(let n=Math.max(0,d.start),i=Math.min(s.count,d.start+d.count);n<i;n+=3)o=Dl(this,r,t,_l,s,a,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Dl(t,e,n,r,i,o,s,a,l,c,u,h){bl.fromBufferAttribute(i,c),xl.fromBufferAttribute(i,u),El.fromBufferAttribute(i,h);const d=t.morphTargetInfluences;if(o&&d){Al.set(0,0,0),Rl.set(0,0,0),Ll.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=d[t],n=o[t];0!==e&&(Sl.fromBufferAttribute(n,c),Ml.fromBufferAttribute(n,u),Tl.fromBufferAttribute(n,h),s?(Al.addScaledVector(Sl,e),Rl.addScaledVector(Ml,e),Ll.addScaledVector(Tl,e)):(Al.addScaledVector(Sl.sub(bl),e),Rl.addScaledVector(Ml.sub(xl),e),Ll.addScaledVector(Tl.sub(El),e)))}bl.add(Al),xl.add(Rl),El.add(Ll)}t.isSkinnedMesh&&(t.boneTransform(c,bl),t.boneTransform(u,xl),t.boneTransform(h,El));const p=function(t,e,n,r,i,o,s,a){let l;if(l=e.side===tr?r.intersectTriangle(s,o,i,!0,a):r.intersectTriangle(i,o,s,e.side!==er,a),null===l)return null;Nl.copy(a),Nl.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(Nl);return c<n.near||c>n.far?null:{distance:c,point:Nl.clone(),object:t}}(t,e,n,r,bl,xl,El,Ol);if(p){a&&(Cl.fromBufferAttribute(a,c),Pl.fromBufferAttribute(a,u),Il.fromBufferAttribute(a,h),p.uv=Ka.getUV(Ol,bl,xl,El,Cl,Pl,Il,new hs)),l&&(Cl.fromBufferAttribute(l,c),Pl.fromBufferAttribute(l,u),Il.fromBufferAttribute(l,h),p.uv2=Ka.getUV(Ol,bl,xl,El,Cl,Pl,Il,new hs));const t={a:c,b:u,c:h,normal:new Ns,materialIndex:0};Ka.getNormal(bl,xl,El,t.normal),p.face=t}return p}kl.prototype.isMesh=!0;class Bl extends yl{constructor(t=1,e=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const s=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(t,e,n,r,i,o,p,f,m,g,y){const v=o/m,_=p/g,w=o/2,b=p/2,x=f/2,E=m+1,S=g+1;let M=0,T=0;const A=new Ns;for(let o=0;o<S;o++){const s=o*_-b;for(let a=0;a<E;a++){const h=a*v-w;A[t]=h*r,A[e]=s*i,A[n]=x,l.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(a/m),u.push(1-o/g),M+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const n=h+e+E*t,r=h+e+E*(t+1),i=h+(e+1)+E*(t+1),o=h+(e+1)+E*t;a.push(n,r,o),a.push(r,i,o),T+=6}s.addGroup(d,T,y),d+=T,h+=M}p("z","y","x",-1,-1,n,e,t,o,i,0),p("z","y","x",1,-1,n,e,-t,o,i,1),p("x","z","y",1,1,t,n,e,r,o,2),p("x","z","y",1,-1,t,n,-e,r,o,3),p("x","y","z",1,-1,t,e,n,r,i,4),p("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new ll(l,3)),this.setAttribute("normal",new ll(c,3)),this.setAttribute("uv",new ll(u,2))}static fromJSON(t){return new Bl(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Ul(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function zl(t){const e={};for(let n=0;n<t.length;n++){const r=Ul(t[n]);for(const t in r)e[t]=r[t]}return e}const Fl={clone:Ul,merge:zl};class Hl extends Ya{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ul(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}Hl.prototype.isShaderMaterial=!0;class Gl extends Da{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new ha,this.projectionMatrix=new ha,this.projectionMatrixInverse=new ha}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Gl.prototype.isCamera=!0;class Vl extends Gl{constructor(t=50,e=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*ns*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*es*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*ns*Math.atan(Math.tan(.5*es*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*es*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/t,e-=o.offsetY*n/s,r*=o.width/t,n*=o.height/s}const s=this.filmOffset;0!==s&&(i+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}Vl.prototype.isPerspectiveCamera=!0;const jl=90;class Wl extends Da{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new Vl(jl,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Ns(1,0,0)),this.add(r);const i=new Vl(jl,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Ns(-1,0,0)),this.add(i);const o=new Vl(jl,1,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Ns(0,1,0)),this.add(o);const s=new Vl(jl,1,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new Ns(0,-1,0)),this.add(s);const a=new Vl(jl,1,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Ns(0,0,1)),this.add(a);const l=new Vl(jl,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Ns(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,o,s,a,l]=this.children,c=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,i),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,s),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.xr.enabled=c,n.texture.needsPMREMUpdate=!0}}class ql extends As{constructor(t,e,n,r,i,o,s,a,l,c){super(t=void 0!==t?t:[],e=void 0!==e?e:jr,n,r,i,o,s,a,l,c),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}ql.prototype.isCubeTexture=!0;class Kl extends Cs{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),e=e||{},this.texture=new ql(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:ii}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=bi,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new Bl(5,5,5),s=new Hl({name:"CubemapFromEquirect",uniforms:Ul(n),vertexShader:r,fragmentShader:i,side:tr,blending:ir});s.uniforms.tEquirect.value=e;const a=new kl(o,s),l=e.minFilter;return e.minFilter===ai&&(e.minFilter=ii),new Wl(1,10,this).update(t,a),e.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(t,e,n,r){const i=t.getRenderTarget();for(let i=0;i<6;i++)t.setRenderTarget(this,i),t.clear(e,n,r);t.setRenderTarget(i)}}Kl.prototype.isWebGLCubeRenderTarget=!0;const Xl=new Ns,Yl=new Ns,Jl=new ds;class Zl{constructor(t=new Ns(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=Xl.subVectors(n,e).cross(Yl.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(Xl),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:e.copy(n).multiplyScalar(i).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Jl.getNormalMatrix(t),r=this.coplanarPoint(Xl).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Zl.prototype.isPlane=!0;const Ql=new na,$l=new Ns;class tc{constructor(t=new Zl,e=new Zl,n=new Zl,r=new Zl,i=new Zl,o=new Zl){this.planes=[t,e,n,r,i,o]}set(t,e,n,r,i,o){const s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],y=n[14],v=n[15];return e[0].setComponents(s-r,u-a,f-h,v-m).normalize(),e[1].setComponents(s+r,u+a,f+h,v+m).normalize(),e[2].setComponents(s+i,u+l,f+d,v+g).normalize(),e[3].setComponents(s-i,u-l,f-d,v-g).normalize(),e[4].setComponents(s-o,u-c,f-p,v-y).normalize(),e[5].setComponents(s+o,u+c,f+p,v+y).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ql.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ql)}intersectsSprite(t){return Ql.center.set(0,0,0),Ql.radius=.7071067811865476,Ql.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ql)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let t=0;t<6;t++)if(e[t].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if($l.x=r.normal.x>0?t.max.x:t.min.x,$l.y=r.normal.y>0?t.max.y:t.min.y,$l.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint($l)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function ec(){let t=null,e=!1,n=null,r=null;function i(e,o){n(e,o),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function nc(t,e){const n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){if(e.isGLBufferAttribute){const t=r.get(e);return void((!t||t.version<e.version)&&r.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const o=r.get(e);void 0===o?r.set(e,function(e,r){const i=e.array,o=e.usage,s=t.createBuffer();t.bindBuffer(r,s),t.bufferData(r,i,o),e.onUploadCallback();let a=5126;return i instanceof Float32Array?a=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?e.isFloat16BufferAttribute?n?a=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):a=5123:i instanceof Int16Array?a=5122:i instanceof Uint32Array?a=5125:i instanceof Int32Array?a=5124:i instanceof Int8Array?a=5120:(i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&(a=5121),{buffer:s,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(function(e,r,i){const o=r.array,s=r.updateRange;t.bindBuffer(i,e),-1===s.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o,s.offset,s.count):t.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o.subarray(s.offset,s.offset+s.count)),s.count=-1)}(o.buffer,e,i),o.version=e.version)}}}class rc extends yl{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=t/2,o=e/2,s=Math.floor(n),a=Math.floor(r),l=s+1,c=a+1,u=t/s,h=e/a,d=[],p=[],f=[],m=[];for(let t=0;t<c;t++){const e=t*h-o;for(let n=0;n<l;n++){const r=n*u-i;p.push(r,-e,0),f.push(0,0,1),m.push(n/s),m.push(1-t/a)}}for(let t=0;t<a;t++)for(let e=0;e<s;e++){const n=e+l*t,r=e+l*(t+1),i=e+1+l*(t+1),o=e+1+l*t;d.push(n,r,o),d.push(r,i,o)}this.setIndex(d),this.setAttribute("position",new ll(p,3)),this.setAttribute("normal",new ll(f,3)),this.setAttribute("uv",new ll(m,2))}static fromJSON(t){return new rc(t.width,t.height,t.widthSegments,t.heightSegments)}}const ic={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},oc={common:{diffuse:{value:new Es(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ds},uv2Transform:{value:new ds},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new hs(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Es(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Es(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ds}},sprite:{diffuse:{value:new Es(16777215)},opacity:{value:1},center:{value:new hs(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ds}}},sc={basic:{uniforms:zl([oc.common,oc.specularmap,oc.envmap,oc.aomap,oc.lightmap,oc.fog]),vertexShader:ic.meshbasic_vert,fragmentShader:ic.meshbasic_frag},lambert:{uniforms:zl([oc.common,oc.specularmap,oc.envmap,oc.aomap,oc.lightmap,oc.emissivemap,oc.fog,oc.lights,{emissive:{value:new Es(0)}}]),vertexShader:ic.meshlambert_vert,fragmentShader:ic.meshlambert_frag},phong:{uniforms:zl([oc.common,oc.specularmap,oc.envmap,oc.aomap,oc.lightmap,oc.emissivemap,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.fog,oc.lights,{emissive:{value:new Es(0)},specular:{value:new Es(1118481)},shininess:{value:30}}]),vertexShader:ic.meshphong_vert,fragmentShader:ic.meshphong_frag},standard:{uniforms:zl([oc.common,oc.envmap,oc.aomap,oc.lightmap,oc.emissivemap,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.roughnessmap,oc.metalnessmap,oc.fog,oc.lights,{emissive:{value:new Es(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ic.meshphysical_vert,fragmentShader:ic.meshphysical_frag},toon:{uniforms:zl([oc.common,oc.aomap,oc.lightmap,oc.emissivemap,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.gradientmap,oc.fog,oc.lights,{emissive:{value:new Es(0)}}]),vertexShader:ic.meshtoon_vert,fragmentShader:ic.meshtoon_frag},matcap:{uniforms:zl([oc.common,oc.bumpmap,oc.normalmap,oc.displacementmap,oc.fog,{matcap:{value:null}}]),vertexShader:ic.meshmatcap_vert,fragmentShader:ic.meshmatcap_frag},points:{uniforms:zl([oc.points,oc.fog]),vertexShader:ic.points_vert,fragmentShader:ic.points_frag},dashed:{uniforms:zl([oc.common,oc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ic.linedashed_vert,fragmentShader:ic.linedashed_frag},depth:{uniforms:zl([oc.common,oc.displacementmap]),vertexShader:ic.depth_vert,fragmentShader:ic.depth_frag},normal:{uniforms:zl([oc.common,oc.bumpmap,oc.normalmap,oc.displacementmap,{opacity:{value:1}}]),vertexShader:ic.meshnormal_vert,fragmentShader:ic.meshnormal_frag},sprite:{uniforms:zl([oc.sprite,oc.fog]),vertexShader:ic.sprite_vert,fragmentShader:ic.sprite_frag},background:{uniforms:{uvTransform:{value:new ds},t2D:{value:null}},vertexShader:ic.background_vert,fragmentShader:ic.background_frag},cube:{uniforms:zl([oc.envmap,{opacity:{value:1}}]),vertexShader:ic.cube_vert,fragmentShader:ic.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ic.equirect_vert,fragmentShader:ic.equirect_frag},distanceRGBA:{uniforms:zl([oc.common,oc.displacementmap,{referencePosition:{value:new Ns},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ic.distanceRGBA_vert,fragmentShader:ic.distanceRGBA_frag},shadow:{uniforms:zl([oc.lights,oc.fog,{color:{value:new Es(0)},opacity:{value:1}}]),vertexShader:ic.shadow_vert,fragmentShader:ic.shadow_frag}};function ac(t,e,n,r,i,o){const s=new Es(0);let a,l,c=!0===i?0:1,u=null,h=0,d=null;function p(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,o)}return{getClearColor:function(){return s},setClearColor:function(t,e=1){s.set(t),c=e,p(s,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,p(s,c)},render:function(n,i){let o=!1,f=!0===i.isScene?i.background:null;f&&f.isTexture&&(f=e.get(f));const m=t.xr,g=m.getSession&&m.getSession();g&&"additive"===g.environmentBlendMode&&(f=null),null===f?p(s,c):f&&f.isColor&&(p(f,1),o=!0),(t.autoClear||o)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),f&&(f.isCubeTexture||f.mapping===Xr)?(void 0===l&&(l=new kl(new Bl(1,1,1),new Hl({name:"BackgroundCubeMaterial",uniforms:Ul(sc.cube.uniforms),vertexShader:sc.cube.vertexShader,fragmentShader:sc.cube.fragmentShader,side:tr,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=f,l.material.uniforms.flipEnvMap.value=f.isCubeTexture&&!1===f.isRenderTargetTexture?-1:1,u===f&&h===f.version&&d===t.toneMapping||(l.material.needsUpdate=!0,u=f,h=f.version,d=t.toneMapping),n.unshift(l,l.geometry,l.material,0,0,null)):f&&f.isTexture&&(void 0===a&&(a=new kl(new rc(2,2),new Hl({name:"BackgroundMaterial",uniforms:Ul(sc.background.uniforms),vertexShader:sc.background.vertexShader,fragmentShader:sc.background.fragmentShader,side:$n,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),a.material.uniforms.uvTransform.value.copy(f.matrix),u===f&&h===f.version&&d===t.toneMapping||(a.material.needsUpdate=!0,u=f,h=f.version,d=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function lc(t,e,n,r){const i=t.getParameter(34921),o=r.isWebGL2?null:e.get("OES_vertex_array_object"),s=r.isWebGL2||null!==o,a={},l=d(null);let c=l;function u(e){return r.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function h(e){return r.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function d(t){const e=[],n=[],r=[];for(let t=0;t<i;t++)e[t]=0,n[t]=0,r[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:r,object:t,attributes:{},index:null}}function p(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function f(t){m(t,0)}function m(n,i){const o=c.newAttributes,s=c.enabledAttributes,a=c.attributeDivisors;o[n]=1,0===s[n]&&(t.enableVertexAttribArray(n),s[n]=1),a[n]!==i&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),a[n]=i)}function g(){const e=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function y(e,n,i,o,s,a){!0!==r.isWebGL2||5124!==i&&5125!==i?t.vertexAttribPointer(e,n,i,o,s,a):t.vertexAttribIPointer(e,n,i,s,a)}function v(){_(),c!==l&&(c=l,u(c.object))}function _(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,v,_){let w=!1;if(s){const e=function(e,n,i){const s=!0===i.wireframe;let l=a[e.id];void 0===l&&(l={},a[e.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[s];return void 0===u&&(u=d(r.isWebGL2?t.createVertexArray():o.createVertexArrayOES()),c[s]=u),u}(v,h,l);c!==e&&(c=e,u(c.object)),w=function(t,e){const n=c.attributes,r=t.attributes;let i=0;for(const t in r){const e=n[t],o=r[t];if(void 0===e)return!0;if(e.attribute!==o)return!0;if(e.data!==o.data)return!0;i++}return c.attributesNum!==i||c.index!==e}(v,_),w&&function(t,e){const n={},r=t.attributes;let i=0;for(const t in r){const e=r[t],o={};o.attribute=e,e.data&&(o.data=e.data),n[t]=o,i++}c.attributes=n,c.attributesNum=i,c.index=e}(v,_)}else{const t=!0===l.wireframe;c.geometry===v.id&&c.program===h.id&&c.wireframe===t||(c.geometry=v.id,c.program=h.id,c.wireframe=t,w=!0)}!0===i.isInstancedMesh&&(w=!0),null!==_&&n.update(_,34963),w&&(function(i,o,s,a){if(!1===r.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();const l=a.attributes,c=s.getAttributes(),u=o.defaultAttributeValues;for(const e in c){const r=c[e];if(r.location>=0){let o=l[e];if(void 0===o&&("instanceMatrix"===e&&i.instanceMatrix&&(o=i.instanceMatrix),"instanceColor"===e&&i.instanceColor&&(o=i.instanceColor)),void 0!==o){const e=o.normalized,s=o.itemSize,l=n.get(o);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,l=n.stride,d=o.offset;if(n&&n.isInstancedInterleavedBuffer){for(let t=0;t<r.locationSize;t++)m(r.location+t,n.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<r.locationSize;t++)f(r.location+t);t.bindBuffer(34962,c);for(let t=0;t<r.locationSize;t++)y(r.location+t,s/r.locationSize,u,e,l*h,(d+s/r.locationSize*t)*h)}else{if(o.isInstancedBufferAttribute){for(let t=0;t<r.locationSize;t++)m(r.location+t,o.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let t=0;t<r.locationSize;t++)f(r.location+t);t.bindBuffer(34962,c);for(let t=0;t<r.locationSize;t++)y(r.location+t,s/r.locationSize,u,e,s*h,s/r.locationSize*t*h)}}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(r.location,n);break;case 3:t.vertexAttrib3fv(r.location,n);break;case 4:t.vertexAttrib4fv(r.location,n);break;default:t.vertexAttrib1fv(r.location,n)}}}}g()}(i,l,h,v),null!==_&&t.bindBuffer(34963,n.get(_).buffer))},reset:v,resetDefaultState:_,dispose:function(){v();for(const t in a){const e=a[t];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t]}},releaseStatesOfGeometry:function(t){if(void 0===a[t.id])return;const e=a[t.id];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t.id]},releaseStatesOfProgram:function(t){for(const e in a){const n=a[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)h(r[t].object),delete r[t];delete n[t.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function cc(t,e,n,r){const i=r.isWebGL2;let o;this.setMode=function(t){o=t},this.render=function(e,r){t.drawArrays(o,e,r),n.update(r,o,1)},this.renderInstances=function(r,s,a){if(0===a)return;let l,c;if(i)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](o,r,s,a),n.update(s,o,a)}}function uc(t,e,n){let r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let s=void 0!==n.precision?n.precision:"highp";const a=i(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=o||e.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),m=t.getParameter(36347),g=t.getParameter(36348),y=t.getParameter(36349),v=h>0,_=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:v,floatFragmentTextures:_,floatVertexTextures:v&&_,maxSamples:o?t.getParameter(36183):0}}function hc(t){const e=this;let n=null,r=0,i=!1,o=!1;const s=new Zl,a=new ds,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,n,r,i){const o=null!==t?t.length:0;let c=null;if(0!==o){if(c=l.value,!0!==i||null===c){const e=r+4*o,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<e)&&(c=new Float32Array(e));for(let e=0,n=r;e!==o;++e,n+=4)s.copy(t[e]).applyMatrix4(i,a),s.normal.toArray(c,n),c[n+3]=s.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,o){const s=0!==t.length||e||0!==r||i;return i=e,n=u(t,o,0),r=t.length,s},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(e,s,a){const h=e.clippingPlanes,d=e.clipIntersection,p=e.clipShadows,f=t.get(e);if(!i||null===h||0===h.length||o&&!p)o?u(null):c();else{const t=o?0:r,e=4*t;let i=f.clippingState||null;l.value=i,i=u(h,s,e,a);for(let t=0;t!==e;++t)i[t]=n[t];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function dc(t){let e=new WeakMap;function n(t,e){return e===qr?t.mapping=jr:e===Kr&&(t.mapping=Wr),t}function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const o=i.mapping;if(o===qr||o===Kr){if(e.has(i))return n(e.get(i).texture,i.mapping);{const o=i.image;if(o&&o.height>0){const s=new Kl(o.height/2);return s.fromEquirectangularTexture(t,i),e.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}sc.physical={uniforms:zl([sc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new hs(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Es(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new hs},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Es(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Es(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ic.meshphysical_vert,fragmentShader:ic.meshphysical_frag};class pc extends Gl{constructor(t=-1,e=1,n=1,r=-1,i=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,o=n+t,s=r+e,a=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,o=i+t*this.view.width,s-=e*this.view.offsetY,a=s-e*this.view.height}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}pc.prototype.isOrthographicCamera=!0;class fc extends Hl{constructor(t){super(t),this.type="RawShaderMaterial"}}fc.prototype.isRawShaderMaterial=!0;const mc=Math.pow(2,8),gc=[.125,.215,.35,.446,.526,.582],yc=5+gc.length,vc=new pc,{_lodPlanes:_c,_sizeLods:wc,_sigmas:bc}=Rc(),xc=new Es;let Ec=null;const Sc=(1+Math.sqrt(5))/2,Mc=1/Sc,Tc=[new Ns(1,1,1),new Ns(-1,1,1),new Ns(1,1,-1),new Ns(-1,1,-1),new Ns(0,Sc,Mc),new Ns(0,Sc,-Mc),new Ns(Mc,0,Sc),new Ns(-Mc,0,Sc),new Ns(Sc,Mc,0),new Ns(-Sc,Mc,0)];class Ac{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(t){const e=new Float32Array(20),n=new Ns(0,1,0);return new fc({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:ir,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,r=100){Ec=this._renderer.getRenderTarget();const i=this._allocateTargets();return this._sceneToCubeUV(t,n,r,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Ic(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Pc(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<_c.length;t++)_c[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Ec),t.scissorTest=!1,Cc(t,0,0,t.width,t.height)}_fromTexture(t,e){Ec=this._renderer.getRenderTarget();const n=e||this._allocateTargets(t);return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(t){const e={magFilter:ii,minFilter:ii,generateMipmaps:!1,type:gi,format:bi,encoding:vo,depthBuffer:!1},n=Lc(e);return n.depthBuffer=!t,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=Lc(e)),n}_compileMaterial(t){const e=new kl(_c[0],t);this._renderer.compile(e,vc)}_sceneToCubeUV(t,e,n,r){const i=new Vl(90,1,e,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(xc),a.toneMapping=Br,a.autoClear=!1;const u=new Ja({name:"PMREM.Background",side:tr,depthWrite:!1,depthTest:!1}),h=new kl(new Bl,u);let d=!1;const p=t.background;p?p.isColor&&(u.color.copy(p),t.background=null,d=!0):(u.color.copy(xc),d=!0);for(let e=0;e<6;e++){const n=e%3;0===n?(i.up.set(0,o[e],0),i.lookAt(s[e],0,0)):1===n?(i.up.set(0,0,o[e]),i.lookAt(0,s[e],0)):(i.up.set(0,o[e],0),i.lookAt(0,0,s[e])),Cc(r,n*mc,e>2?mc:0,mc,mc),a.setRenderTarget(r),d&&a.render(h,i),a.render(t,i)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,t.background=p}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===jr||t.mapping===Wr;r?(null===this._cubemapShader&&(this._cubemapShader=Ic()),this._cubemapShader.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=Pc());const i=r?this._cubemapShader:this._equirectShader,o=new kl(_c[0],i),s=i.uniforms;s.envMap.value=t,r||s.texelSize.value.set(1/t.image.width,1/t.image.height),Cc(e,0,0,3*mc,2*mc),n.setRenderTarget(e),n.render(o,vc)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let e=1;e<yc;e++){const n=Math.sqrt(bc[e]*bc[e]-bc[e-1]*bc[e-1]),r=Tc[(e-1)%Tc.length];this._blur(t,e-1,e,n,r)}e.autoClear=n}_blur(t,e,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,r,"latitudinal",i),this._halfBlur(o,t,n,n,r,"longitudinal",i)}_halfBlur(t,e,n,r,i,o,s){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new kl(_c[r],l),u=l.uniforms,h=wc[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,p=i/d,f=isFinite(i)?1+Math.floor(3*p):20;f>20&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let t=0;t<20;++t){const e=t/p,n=Math.exp(-e*e/2);m.push(n),0===t?g+=n:t<f&&(g+=2*n)}for(let t=0;t<m.length;t++)m[t]=m[t]/g;u.envMap.value=t.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===o,s&&(u.poleAxis.value=s),u.dTheta.value=d,u.mipInt.value=8-n;const y=wc[r];Cc(e,3*Math.max(0,mc-2*y),(0===r?0:2*mc)+2*y*(r>4?r-8+4:0),3*y,2*y),a.setRenderTarget(e),a.render(c,vc)}}function Rc(){const t=[],e=[],n=[];let r=8;for(let i=0;i<yc;i++){const o=Math.pow(2,r);e.push(o);let s=1/o;i>4?s=gc[i-8+4-1]:0===i&&(s=0),n.push(s);const a=1/(o-1),l=-a/2,c=1+a/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,d=6,p=3,f=2,m=1,g=new Float32Array(p*d*h),y=new Float32Array(f*d*h),v=new Float32Array(m*d*h);for(let t=0;t<h;t++){const e=t%3*2/3-1,n=t>2?0:-1,r=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];g.set(r,p*d*t),y.set(u,f*d*t);const i=[t,t,t,t,t,t];v.set(i,m*d*t)}const _=new yl;_.setAttribute("position",new $a(g,p)),_.setAttribute("uv",new $a(y,f)),_.setAttribute("faceIndex",new $a(v,m)),t.push(_),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}function Lc(t){const e=new Cs(3*mc,3*mc,t);return e.texture.mapping=Xr,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Cc(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function Pc(){const t=new hs(1,1);return new fc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:t}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:ir,depthTest:!1,depthWrite:!1})}function Ic(){return new fc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:ir,depthTest:!1,depthWrite:!1})}function Oc(t){let e=new WeakMap,n=null;function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping,s=o===qr||o===Kr,a=o===jr||o===Wr;if(s||a){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let r=e.get(i);return null===n&&(n=new Ac(t)),r=s?n.fromEquirectangular(i,r):n.fromCubemap(i,r),e.set(i,r),r.texture}if(e.has(i))return e.get(i).texture;{const o=i.image;if(s&&o&&o.height>0||a&&o&&function(t){let e=0;for(let n=0;n<6;n++)void 0!==t[n]&&e++;return 6===e}(o)){null===n&&(n=new Ac(t));const o=s?n.fromEquirectangular(i):n.fromCubemap(i);return e.set(i,o),i.addEventListener("dispose",r),o.texture}return null}}}return i},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Nc(t){const e={};function n(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){const e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function kc(t,e,n,r){const i={},o=new WeakMap;function s(t){const a=t.target;null!==a.index&&e.remove(a.index);for(const t in a.attributes)e.remove(a.attributes[t]);a.removeEventListener("dispose",s),delete i[a.id];const l=o.get(a);l&&(e.remove(l),o.delete(a)),r.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(t){const n=[],r=t.index,i=t.attributes.position;let s=0;if(null!==r){const t=r.array;s=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],o=t[e+2];n.push(r,i,i,o,o,r)}}else{const t=i.array;s=i.version;for(let e=0,r=t.length/3-1;e<r;e+=3){const t=e+0,r=e+1,i=e+2;n.push(t,r,r,i,i,t)}}const a=new(ps(n)?sl:il)(n,1);a.version=s;const l=o.get(t);l&&e.remove(l),o.set(t,a)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",s),i[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const t in n)e.update(n[t],34962);const r=t.morphAttributes;for(const t in r){const n=r[t];for(let t=0,r=n.length;t<r;t++)e.update(n[t],34962)}},getWireframeAttribute:function(t){const e=o.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return o.get(t)}}}function Dc(t,e,n,r){const i=r.isWebGL2;let o,s,a;this.setMode=function(t){o=t},this.setIndex=function(t){s=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(o,r,s,e*a),n.update(r,o,1)},this.renderInstances=function(r,l,c){if(0===c)return;let u,h;if(i)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](o,l,s,r*a,c),n.update(l,o,c)}}function Bc(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}class Uc extends As{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=$r,this.minFilter=$r,this.wrapR=Zr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function zc(t,e){return t[0]-e[0]}function Fc(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Hc(t,e){let n=1;const r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?n=127:r instanceof Int16Array?n=32767:r instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),t.divideScalar(n)}function Gc(t,e,n){const r={},i=new Float32Array(8),o=new WeakMap,s=new Ns,a=[];for(let t=0;t<8;t++)a[t]=[t,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const r=c.morphAttributes.position.length;let i=o.get(c);if(void 0===i||i.count!==r){void 0!==i&&i.texture.dispose();const t=void 0!==c.morphAttributes.normal,n=c.morphAttributes.position,a=c.morphAttributes.normal||[],l=!0===t?2:1;let u=c.attributes.position.count*l,h=1;u>e.maxTextureSize&&(h=Math.ceil(u/e.maxTextureSize),u=e.maxTextureSize);const d=new Float32Array(u*h*4*r),p=new Uc(d,u,h,r);p.format=bi,p.type=mi,p.needsUpdate=!0;const f=4*l;for(let e=0;e<r;e++){const r=n[e],i=a[e],o=u*h*4*e;for(let e=0;e<r.count;e++){s.fromBufferAttribute(r,e),!0===r.normalized&&Hc(s,r);const n=e*f;d[o+n+0]=s.x,d[o+n+1]=s.y,d[o+n+2]=s.z,d[o+n+3]=0,!0===t&&(s.fromBufferAttribute(i,e),!0===i.normalized&&Hc(s,i),d[o+n+4]=s.x,d[o+n+5]=s.y,d[o+n+6]=s.z,d[o+n+7]=0)}}function m(){p.dispose(),o.delete(c),c.removeEventListener("dispose",m)}i={count:r,texture:p,size:new hs(u,h)},o.set(c,i),c.addEventListener("dispose",m)}let a=0;for(let t=0;t<d.length;t++)a+=d[t];const l=c.morphTargetsRelative?1:1-a;h.getUniforms().setValue(t,"morphTargetBaseInfluence",l),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",i.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",i.size)}else{const e=void 0===d?0:d.length;let n=r[c.id];if(void 0===n||n.length!==e){n=[];for(let t=0;t<e;t++)n[t]=[t,0];r[c.id]=n}for(let t=0;t<e;t++){const e=n[t];e[0]=t,e[1]=d[t]}n.sort(Fc);for(let t=0;t<8;t++)t<e&&n[t][1]?(a[t][0]=n[t][0],a[t][1]=n[t][1]):(a[t][0]=Number.MAX_SAFE_INTEGER,a[t][1]=0);a.sort(zc);const o=c.morphAttributes.position,s=c.morphAttributes.normal;let l=0;for(let t=0;t<8;t++){const e=a[t],n=e[0],r=e[1];n!==Number.MAX_SAFE_INTEGER&&r?(o&&c.getAttribute("morphTarget"+t)!==o[n]&&c.setAttribute("morphTarget"+t,o[n]),s&&c.getAttribute("morphNormal"+t)!==s[n]&&c.setAttribute("morphNormal"+t,s[n]),i[t]=r,l+=r):(o&&!0===c.hasAttribute("morphTarget"+t)&&c.deleteAttribute("morphTarget"+t),s&&!0===c.hasAttribute("morphNormal"+t)&&c.deleteAttribute("morphNormal"+t),i[t]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(t,"morphTargetBaseInfluence",u),h.getUniforms().setValue(t,"morphTargetInfluences",i)}}}}function Vc(t,e,n,r){let i=new WeakMap;function o(t){const e=t.target;e.removeEventListener("dispose",o),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){const s=r.render.frame,a=t.geometry,l=e.get(t,a);return i.get(l)!==s&&(e.update(l),i.set(l,s)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",o)&&t.addEventListener("dispose",o),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}Uc.prototype.isDataTexture2DArray=!0;class jc extends As{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=$r,this.minFilter=$r,this.wrapR=Zr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}jc.prototype.isDataTexture3D=!0;const Wc=new As,qc=new Uc,Kc=new jc,Xc=new ql,Yc=[],Jc=[],Zc=new Float32Array(16),Qc=new Float32Array(9),$c=new Float32Array(4);function tu(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let o=Yc[i];if(void 0===o&&(o=new Float32Array(i),Yc[i]=o),0!==e){r.toArray(o,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(o,i)}return o}function eu(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function nu(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function ru(t,e){let n=Jc[e];void 0===n&&(n=new Int32Array(e),Jc[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function iu(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function ou(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(eu(n,e))return;t.uniform2fv(this.addr,e),nu(n,e)}}function su(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(eu(n,e))return;t.uniform3fv(this.addr,e),nu(n,e)}}function au(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(eu(n,e))return;t.uniform4fv(this.addr,e),nu(n,e)}}function lu(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(eu(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),nu(n,e)}else{if(eu(n,r))return;$c.set(r),t.uniformMatrix2fv(this.addr,!1,$c),nu(n,r)}}function cu(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(eu(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),nu(n,e)}else{if(eu(n,r))return;Qc.set(r),t.uniformMatrix3fv(this.addr,!1,Qc),nu(n,r)}}function uu(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(eu(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),nu(n,e)}else{if(eu(n,r))return;Zc.set(r),t.uniformMatrix4fv(this.addr,!1,Zc),nu(n,r)}}function hu(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function du(t,e){const n=this.cache;eu(n,e)||(t.uniform2iv(this.addr,e),nu(n,e))}function pu(t,e){const n=this.cache;eu(n,e)||(t.uniform3iv(this.addr,e),nu(n,e))}function fu(t,e){const n=this.cache;eu(n,e)||(t.uniform4iv(this.addr,e),nu(n,e))}function mu(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function gu(t,e){const n=this.cache;eu(n,e)||(t.uniform2uiv(this.addr,e),nu(n,e))}function yu(t,e){const n=this.cache;eu(n,e)||(t.uniform3uiv(this.addr,e),nu(n,e))}function vu(t,e){const n=this.cache;eu(n,e)||(t.uniform4uiv(this.addr,e),nu(n,e))}function _u(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||Wc,i)}function wu(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||Kc,i)}function bu(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||Xc,i)}function xu(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||qc,i)}function Eu(t,e){t.uniform1fv(this.addr,e)}function Su(t,e){const n=tu(e,this.size,2);t.uniform2fv(this.addr,n)}function Mu(t,e){const n=tu(e,this.size,3);t.uniform3fv(this.addr,n)}function Tu(t,e){const n=tu(e,this.size,4);t.uniform4fv(this.addr,n)}function Au(t,e){const n=tu(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Ru(t,e){const n=tu(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Lu(t,e){const n=tu(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Cu(t,e){t.uniform1iv(this.addr,e)}function Pu(t,e){t.uniform2iv(this.addr,e)}function Iu(t,e){t.uniform3iv(this.addr,e)}function Ou(t,e){t.uniform4iv(this.addr,e)}function Nu(t,e){t.uniform1uiv(this.addr,e)}function ku(t,e){t.uniform2uiv(this.addr,e)}function Du(t,e){t.uniform3uiv(this.addr,e)}function Bu(t,e){t.uniform4uiv(this.addr,e)}function Uu(t,e,n){const r=e.length,i=ru(n,r);t.uniform1iv(this.addr,i);for(let t=0;t!==r;++t)n.safeSetTexture2D(e[t]||Wc,i[t])}function zu(t,e,n){const r=e.length,i=ru(n,r);t.uniform1iv(this.addr,i);for(let t=0;t!==r;++t)n.setTexture3D(e[t]||Kc,i[t])}function Fu(t,e,n){const r=e.length,i=ru(n,r);t.uniform1iv(this.addr,i);for(let t=0;t!==r;++t)n.safeSetTextureCube(e[t]||Xc,i[t])}function Hu(t,e,n){const r=e.length,i=ru(n,r);t.uniform1iv(this.addr,i);for(let t=0;t!==r;++t)n.setTexture2DArray(e[t]||qc,i[t])}function Gu(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return iu;case 35664:return ou;case 35665:return su;case 35666:return au;case 35674:return lu;case 35675:return cu;case 35676:return uu;case 5124:case 35670:return hu;case 35667:case 35671:return du;case 35668:case 35672:return pu;case 35669:case 35673:return fu;case 5125:return mu;case 36294:return gu;case 36295:return yu;case 36296:return vu;case 35678:case 36198:case 36298:case 36306:case 35682:return _u;case 35679:case 36299:case 36307:return wu;case 35680:case 36300:case 36308:case 36293:return bu;case 36289:case 36303:case 36311:case 36292:return xu}}(e.type)}function Vu(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Eu;case 35664:return Su;case 35665:return Mu;case 35666:return Tu;case 35674:return Au;case 35675:return Ru;case 35676:return Lu;case 5124:case 35670:return Cu;case 35667:case 35671:return Pu;case 35668:case 35672:return Iu;case 35669:case 35673:return Ou;case 5125:return Nu;case 36294:return ku;case 36295:return Du;case 36296:return Bu;case 35678:case 36198:case 36298:case 36306:case 35682:return Uu;case 35679:case 36299:case 36307:return zu;case 35680:case 36300:case 36308:case 36293:return Fu;case 36289:case 36303:case 36311:case 36292:return Hu}}(e.type)}function ju(t){this.id=t,this.seq=[],this.map={}}Vu.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),nu(e,t)},ju.prototype.setValue=function(t,e,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(t,e[o.id],n)}};const Wu=/(\w+)(\])?(\[|\.)?/g;function qu(t,e){t.seq.push(e),t.map[e.id]=e}function Ku(t,e,n){const r=t.name,i=r.length;for(Wu.lastIndex=0;;){const o=Wu.exec(r),s=Wu.lastIndex;let a=o[1];const l="]"===o[2],c=o[3];if(l&&(a|=0),void 0===c||"["===c&&s+2===i){qu(n,void 0===c?new Gu(a,t,e):new Vu(a,t,e));break}{let t=n.map[a];void 0===t&&(t=new ju(a),qu(n,t)),n=t}}}function Xu(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let r=0;r<n;++r){const n=t.getActiveUniform(e,r);Ku(n,t.getUniformLocation(e,n.name),this)}}function Yu(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}Xu.prototype.setValue=function(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)},Xu.prototype.setOptional=function(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)},Xu.upload=function(t,e,n,r){for(let i=0,o=e.length;i!==o;++i){const o=e[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,r)}},Xu.seqWithValue=function(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n};let Ju=0;function Zu(t,e,n){const r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":n.toUpperCase()+"\n\n"+i+"\n\n"+function(t){const e=t.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(t.getShaderSource(e))}function Qu(t,e){const n=function(t){switch(t){case vo:return["Linear","( value )"];case _o:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function $u(t,e){let n;switch(e){case Ur:n="Linear";break;case zr:n="Reinhard";break;case Fr:n="OptimizedCineon";break;case Hr:n="ACESFilmic";break;case Gr:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function th(t){return""!==t}function eh(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function nh(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const rh=/^[ \t]*#include +<([\w\d./]+)>/gm;function ih(t){return t.replace(rh,oh)}function oh(t,e){const n=ic[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return ih(n)}const sh=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ah=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lh(t){return t.replace(ah,uh).replace(sh,ch)}function ch(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),uh(0,e,n,r)}function uh(t,e,n,r){let i="";for(let t=parseInt(e);t<parseInt(n);t++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return i}function hh(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function dh(t,e,n,r){const i=t.getContext(),o=n.defines;let s=n.vertexShader,a=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Jn?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Zn?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Qn&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case jr:case Wr:e="ENVMAP_TYPE_CUBE";break;case Xr:case Yr:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Wr:case Yr:e="ENVMAP_MODE_REFRACTION"}return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Nr:e="ENVMAP_BLENDING_MULTIPLY";break;case kr:e="ENVMAP_BLENDING_MIX";break;case Dr:e="ENVMAP_BLENDING_ADD"}return e}(n),d=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(th).join("\n")}(n),p=function(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(o),f=i.createProgram();let m,g,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(m=[p].filter(th).join("\n"),m.length>0&&(m+="\n"),g=[d,p].filter(th).join("\n"),g.length>0&&(g+="\n")):(m=[hh(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(th).join("\n"),g=[d,hh(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Br?"#define TONE_MAPPING":"",n.toneMapping!==Br?ic.tonemapping_pars_fragment:"",n.toneMapping!==Br?$u("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.alphaWrite?"":"#define OPAQUE",ic.encodings_pars_fragment,Qu("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(th).join("\n")),s=ih(s),s=eh(s,n),s=nh(s,n),a=ih(a),a=eh(a,n),a=nh(a,n),s=lh(s),a=lh(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in",n.glslVersion===Jo?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Jo?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const v=y+g+a,_=Yu(i,35633,y+m+s),w=Yu(i,35632,v);if(i.attachShader(f,_),i.attachShader(f,w),void 0!==n.index0AttributeName?i.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(f,0,"position"),i.linkProgram(f),t.debug.checkShaderErrors){const t=i.getProgramInfoLog(f).trim(),e=i.getShaderInfoLog(_).trim(),n=i.getShaderInfoLog(w).trim();let r=!0,o=!0;if(!1===i.getProgramParameter(f,35714)){r=!1;const e=Zu(i,_,"vertex"),n=Zu(i,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(f,35715)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+n)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==e&&""!==n||(o=!1);o&&(this.diagnostics={runnable:r,programLog:t,vertexShader:{log:e,prefix:m},fragmentShader:{log:n,prefix:g}})}let b,x;return i.deleteShader(_),i.deleteShader(w),this.getUniforms=function(){return void 0===b&&(b=new Xu(i,f)),b},this.getAttributes=function(){return void 0===x&&(x=function(t,e){const n={},r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i),o=r.name;let s=1;35674===r.type&&(s=2),35675===r.type&&(s=3),35676===r.type&&(s=4),n[o]={type:r.type,location:t.getAttribLocation(e,o),locationSize:s}}return n}(i,f)),x},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(f),this.program=void 0},this.name=n.shaderName,this.id=Ju++,this.cacheKey=e,this.usedTimes=1,this.program=f,this.vertexShader=_,this.fragmentShader=w,this}let ph=0;class fh{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(e),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(i)&&(o.add(i),i.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(!1===e.has(t)){const n=new mh;e.set(t,n)}return e.get(t)}}class mh{constructor(){this.id=ph++,this.usedTimes=0}}function gh(t,e,n,r,i,o,s){const a=new xa,l=new fh,c=[],u=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.floatVertexTextures,p=i.maxVertexUniforms,f=i.vertexTextures;let m=i.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(o,a,c,y,v){const _=y.fog,w=o.isMeshStandardMaterial?y.environment:null,b=(o.isMeshStandardMaterial?n:e).get(o.envMap||w),x=g[o.type],E=v.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(d)return 1024;{const t=p,n=Math.floor((t-20)/4),r=Math.min(n,e.length);return r<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+r+"."),0):r}}(v):0;let S,M,T,A;if(null!==o.precision&&(m=i.getMaxPrecision(o.precision),m!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",m,"instead.")),x){const t=sc[x];S=t.vertexShader,M=t.fragmentShader}else S=o.vertexShader,M=o.fragmentShader,l.update(o),T=l.getVertexShaderID(o),A=l.getFragmentShaderID(o);const R=t.getRenderTarget(),L=o.alphaTest>0,C=o.clearcoat>0;return{isWebGL2:u,shaderID:x,shaderName:o.type,vertexShader:S,fragmentShader:M,defines:o.defines,customVertexShaderID:T,customFragmentShaderID:A,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:m,instancing:!0===v.isInstancedMesh,instancingColor:!0===v.isInstancedMesh&&null!==v.instanceColor,supportsVertexTextures:f,outputEncoding:null===R?t.outputEncoding:!0===R.isXRRenderTarget?R.texture.encoding:vo,map:!!o.map,matcap:!!o.matcap,envMap:!!b,envMapMode:b&&b.mapping,envMapCubeUV:!!b&&(b.mapping===Xr||b.mapping===Yr),lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===Eo,tangentSpaceNormalMap:o.normalMapType===xo,decodeVideoTexture:!!o.map&&!0===o.map.isVideoTexture&&o.map.encoding===_o,clearcoat:C,clearcoatMap:C&&!!o.clearcoatMap,clearcoatRoughnessMap:C&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:C&&!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,alphaMap:!!o.alphaMap,alphaTest:L,alphaWrite:o.alphaWrite||o.transparent,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!v.geometry&&!!v.geometry.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!v.geometry&&!!v.geometry.attributes.color&&4===v.geometry.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.displacementMap||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheenColorMap||o.sheenRoughnessMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap||!o.displacementMap),fog:!!_,useFog:o.fog,fogExp2:_&&_.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===v.isSkinnedMesh&&E>0,maxBones:E,useVertexTexture:d,morphTargets:!!v.geometry&&!!v.geometry.morphAttributes.position,morphNormals:!!v.geometry&&!!v.geometry.morphAttributes.normal,morphTargetsCount:v.geometry&&v.geometry.morphAttributes.position?v.geometry.morphAttributes.position.length:0,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.length>0,shadowMapType:t.shadowMap.type,toneMapping:o.toneMapped?t.toneMapping:Br,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===er,flipSided:o.side===tr,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(function(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.maxBones),t.push(e.morphTargetsCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.alphaWrite)}(n,e),function(t,e){a.disableAll(),e.isWebGL2&&a.enable(0),e.supportsVertexTextures&&a.enable(1),e.instancing&&a.enable(2),e.instancingColor&&a.enable(3),e.map&&a.enable(4),e.matcap&&a.enable(5),e.envMap&&a.enable(6),e.envMapCubeUV&&a.enable(7),e.lightMap&&a.enable(8),e.aoMap&&a.enable(9),e.emissiveMap&&a.enable(10),e.bumpMap&&a.enable(11),e.normalMap&&a.enable(12),e.objectSpaceNormalMap&&a.enable(13),e.tangentSpaceNormalMap&&a.enable(14),e.clearcoat&&a.enable(15),e.clearcoatMap&&a.enable(16),e.clearcoatRoughnessMap&&a.enable(17),e.clearcoatNormalMap&&a.enable(18),e.displacementMap&&a.enable(19),e.specularMap&&a.enable(20),e.roughnessMap&&a.enable(21),e.metalnessMap&&a.enable(22),e.gradientMap&&a.enable(23),e.alphaMap&&a.enable(24),e.alphaTest&&a.enable(25),e.vertexColors&&a.enable(26),e.vertexAlphas&&a.enable(27),e.vertexUvs&&a.enable(28),e.vertexTangents&&a.enable(29),e.uvsVertexOnly&&a.enable(30),e.fog&&a.enable(31),t.push(a.mask),a.disableAll(),e.useFog&&a.enable(0),e.flatShading&&a.enable(1),e.logarithmicDepthBuffer&&a.enable(2),e.skinning&&a.enable(3),e.useVertexTexture&&a.enable(4),e.morphTargets&&a.enable(5),e.morphNormals&&a.enable(6),e.premultipliedAlpha&&a.enable(7),e.shadowMapEnabled&&a.enable(8),e.physicallyCorrectLights&&a.enable(9),e.doubleSided&&a.enable(10),e.flipSided&&a.enable(11),e.depthPacking&&a.enable(12),e.dithering&&a.enable(13),e.specularIntensityMap&&a.enable(14),e.specularColorMap&&a.enable(15),e.transmission&&a.enable(16),e.transmissionMap&&a.enable(17),e.thicknessMap&&a.enable(18),e.sheen&&a.enable(19),e.sheenColorMap&&a.enable(20),e.sheenRoughnessMap&&a.enable(21),e.decodeVideoTexture&&a.enable(22),t.push(a.mask)}(n,e),n.push(t.outputEncoding)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=g[t.type];let n;if(e){const t=sc[e];n=Fl.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let r;for(let t=0,e=c.length;t<e;t++){const e=c[t];if(e.cacheKey===n){r=e,++r.usedTimes;break}}return void 0===r&&(r=new dh(t,n,e,o),c.push(r)),r},releaseProgram:function(t){if(0==--t.usedTimes){const e=c.indexOf(t);c[e]=c[c.length-1],c.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:c,dispose:function(){l.dispose()}}}function yh(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function vh(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function _h(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function wh(){const t=[];let e=0;const n=[],r=[],i=[];function o(n,r,i,o,s,a){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:a},t[e]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=s,l.group=a),e++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){e=0,n.length=0,r.length=0,i.length=0},push:function(t,e,s,a,l,c){const u=o(t,e,s,a,l,c);s.transmission>0?r.push(u):!0===s.transparent?i.push(u):n.push(u)},unshift:function(t,e,s,a,l,c){const u=o(t,e,s,a,l,c);s.transmission>0?r.unshift(u):!0===s.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=e,r=t.length;n<r;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||vh),r.length>1&&r.sort(e||_h),i.length>1&&i.sort(e||_h)}}}function bh(){let t=new WeakMap;return{get:function(e,n){let r;return!1===t.has(e)?(r=new wh,t.set(e,[r])):n>=t.get(e).length?(r=new wh,t.get(e).push(r)):r=t.get(e)[n],r},dispose:function(){t=new WeakMap}}}function xh(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Ns,color:new Es};break;case"SpotLight":n={position:new Ns,direction:new Ns,color:new Es,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Ns,color:new Es,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Ns,skyColor:new Es,groundColor:new Es};break;case"RectAreaLight":n={color:new Es,position:new Ns,halfWidth:new Ns,halfHeight:new Ns}}return t[e.id]=n,n}}}let Eh=0;function Sh(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Mh(t,e){const n=new xh,r=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new hs};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new hs,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)i.probe.push(new Ns);const o=new Ns,s=new ha,a=new ha;return{setup:function(o,s){let a=0,l=0,c=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0;o.sort(Sh);const v=!0!==s?Math.PI:1;for(let t=0,e=o.length;t<e;t++){const e=o[t],s=e.color,_=e.intensity,w=e.distance,b=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)a+=s.r*_*v,l+=s.g*_*v,c+=s.b*_*v;else if(e.isLightProbe)for(let t=0;t<9;t++)i.probe[t].addScaledVector(e.sh.coefficients[t],_);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*v),e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.directionalShadow[u]=n,i.directionalShadowMap[u]=b,i.directionalShadowMatrix[u]=e.shadow.matrix,m++}i.directional[u]=t,u++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(s).multiplyScalar(_*v),t.distance=w,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.spotShadow[d]=n,i.spotShadowMap[d]=b,i.spotShadowMatrix[d]=e.shadow.matrix,y++}i.spot[d]=t,d++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(s).multiplyScalar(_),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),i.rectArea[p]=t,p++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*v),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,i.pointShadow[h]=n,i.pointShadowMap[h]=b,i.pointShadowMatrix[h]=e.shadow.matrix,g++}i.point[h]=t,h++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(_*v),t.groundColor.copy(e.groundColor).multiplyScalar(_*v),i.hemi[f]=t,f++}}p>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=oc.LTC_FLOAT_1,i.rectAreaLTC2=oc.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=oc.LTC_HALF_1,i.rectAreaLTC2=oc.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=a,i.ambient[1]=l,i.ambient[2]=c;const _=i.hash;_.directionalLength===u&&_.pointLength===h&&_.spotLength===d&&_.rectAreaLength===p&&_.hemiLength===f&&_.numDirectionalShadows===m&&_.numPointShadows===g&&_.numSpotShadows===y||(i.directional.length=u,i.spot.length=d,i.rectArea.length=p,i.point.length=h,i.hemi.length=f,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotShadowMatrix.length=y,_.directionalLength=u,_.pointLength=h,_.spotLength=d,_.rectAreaLength=p,_.hemiLength=f,_.numDirectionalShadows=m,_.numPointShadows=g,_.numSpotShadows=y,i.version=Eh++)},setupView:function(t,e){let n=0,r=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=i.directional[n];t.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),n++}else if(d.isSpotLight){const t=i.spot[l];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const t=i.rectArea[c];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),a.identity(),s.copy(d.matrixWorld),s.premultiply(h),a.extractRotation(s),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(d.isPointLight){const t=i.point[r];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),r++}else if(d.isHemisphereLight){const t=i.hemi[u];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(h),t.direction.normalize(),u++}}},state:i}}function Th(t,e){const n=new Mh(t,e),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(t){n.setup(r,t)},setupLightsView:function(t){n.setupView(r,t)},pushLight:function(t){r.push(t)},pushShadow:function(t){i.push(t)}}}function Ah(t,e){let n=new WeakMap;return{get:function(r,i=0){let o;return!1===n.has(r)?(o=new Th(t,e),n.set(r,[o])):i>=n.get(r).length?(o=new Th(t,e),n.get(r).push(o)):o=n.get(r)[i],o},dispose:function(){n=new WeakMap}}}class Rh extends Ya{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=wo,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}Rh.prototype.isMeshDepthMaterial=!0;class Lh extends Ya{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Ns,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function Ch(t,e,n){let r=new tc;const i=new hs,o=new hs,s=new Ls,a=new Rh({depthPacking:bo}),l=new Lh,c={},u=n.maxTextureSize,h={0:tr,1:$n,2:er},d=new Hl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new hs},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new yl;f.setAttribute("position",new $a(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new kl(f,d),g=this;function y(n,r){const i=e.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,p,m,null)}function v(e,n,r,i,o,s,u){let d=null;const p=!0===i.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(d=void 0!==p?p:!0===i.isPointLight?l:a,t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0){const t=d.uuid,e=r.uuid;let n=c[t];void 0===n&&(n={},c[t]=n);let i=n[e];void 0===i&&(i=d.clone(),n[e]=i),d=i}return d.visible=r.visible,d.wireframe=r.wireframe,d.side=u===Qn?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:h[r.side],d.alphaMap=r.alphaMap,d.alphaTest=r.alphaTest,d.clipShadows=r.clipShadows,d.clippingPlanes=r.clippingPlanes,d.clipIntersection=r.clipIntersection,d.displacementMap=r.displacementMap,d.displacementScale=r.displacementScale,d.displacementBias=r.displacementBias,d.wireframeLinewidth=r.wireframeLinewidth,d.linewidth=r.linewidth,!0===i.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(i.matrixWorld),d.nearDistance=o,d.farDistance=s),d}function _(n,i,o,s,a){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===Qn)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=e.update(n),i=n.material;if(Array.isArray(i)){const e=r.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=i[c.materialIndex];if(u&&u.visible){const e=v(n,0,u,s,o.near,o.far,a);t.renderBufferDirect(o,null,r,e,n,c)}}}else if(i.visible){const e=v(n,0,i,s,o.near,o.far,a);t.renderBufferDirect(o,null,r,e,n,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)_(l[t],i,o,s,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Jn,this.render=function(e,n,a){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(ir),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=e.length;l<c;l++){const c=e[l],h=c.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;i.copy(h.mapSize);const p=h.getFrameExtents();if(i.multiply(p),o.copy(h.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(o.x=Math.floor(u/p.x),i.x=o.x*p.x,h.mapSize.x=o.x),i.y>u&&(o.y=Math.floor(u/p.y),i.y=o.y*p.y,h.mapSize.y=o.y)),null===h.map&&!h.isPointLightShadow&&this.type===Qn){const t={minFilter:ii,magFilter:ii,format:bi};h.map=new Cs(i.x,i.y,t),h.map.texture.name=c.name+".shadowMap",h.mapPass=new Cs(i.x,i.y,t),h.camera.updateProjectionMatrix()}if(null===h.map){const t={minFilter:$r,magFilter:$r,format:bi};h.map=new Cs(i.x,i.y,t),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}t.setRenderTarget(h.map),t.clear();const f=h.getViewportCount();for(let t=0;t<f;t++){const e=h.getViewport(t);s.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),d.viewport(s),h.updateMatrices(c,t),r=h.getFrustum(),_(n,a,h.camera,c,this.type)}h.isPointLightShadow||this.type!==Qn||y(h,a),h.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function Ph(t,e,n){const r=n.isWebGL2,i=new function(){let e=!1;const n=new Ls;let r=null;const i=new Ls(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,s,a){!0===a&&(e*=s,r*=s,o*=s),n.set(e,r,o,s),!1===i.equals(n)&&(t.clearColor(e,r,o,s),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){let e=!1,n=null,r=null,i=null;return{setTest:function(t){t?U(2929):z(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case Tr:t.depthFunc(512);break;case Ar:t.depthFunc(519);break;case Rr:t.depthFunc(513);break;case Lr:t.depthFunc(515);break;case Cr:t.depthFunc(514);break;case Pr:t.depthFunc(518);break;case Ir:t.depthFunc(516);break;case Or:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},s=new function(){let e=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null;return{setTest:function(t){e||(t?U(2960):z(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,s){r===e&&i===n&&o===s||(t.stencilFunc(e,n,s),r=e,i=n,o=s)},setOp:function(e,n,r){s===e&&a===n&&l===r||(t.stencilOp(e,n,r),s=e,a=n,l=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null}}};let a={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,f=null,m=null,g=null,y=null,v=null,_=null,w=!1,b=null,x=null,E=null,S=null,M=null;const T=t.getParameter(35661);let A=!1,R=0;const L=t.getParameter(7938);-1!==L.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(L)[1]),A=R>=1):-1!==L.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),A=R>=2);let C=null,P={};const I=t.getParameter(3088),O=t.getParameter(2978),N=(new Ls).fromArray(I),k=(new Ls).fromArray(O);function D(e,n,r){const i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<r;e++)t.texImage2D(n+e,0,6408,1,1,0,6408,5121,i);return o}const B={};function U(e){!0!==a[e]&&(t.enable(e),a[e]=!0)}function z(e){!1!==a[e]&&(t.disable(e),a[e]=!1)}B[3553]=D(3553,3553,1),B[34067]=D(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),s.setClear(0),U(2929),o.setFunc(Lr),V(!1),j(qn),U(2884),G(ir);const F={[ur]:32774,[hr]:32778,[dr]:32779};if(r)F[pr]=32775,F[fr]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(F[pr]=t.MIN_EXT,F[fr]=t.MAX_EXT)}const H={[mr]:0,[gr]:1,[yr]:768,[_r]:770,[Mr]:776,[Er]:774,[br]:772,[vr]:769,[wr]:771,[Sr]:775,[xr]:773};function G(e,n,r,i,o,s,a,l){if(e!==ir){if(!1===d&&(U(3042),d=!0),e===cr)o=o||n,s=s||r,a=a||i,n===f&&o===y||(t.blendEquationSeparate(F[n],F[o]),f=n,y=o),r===m&&i===g&&s===v&&a===_||(t.blendFuncSeparate(H[r],H[i],H[s],H[a]),m=r,g=i,v=s,_=a),p=e,w=null;else if(e!==p||l!==w){if(f===ur&&y===ur||(t.blendEquation(32774),f=ur,y=ur),l)switch(e){case or:t.blendFuncSeparate(1,771,1,771);break;case sr:t.blendFunc(1,1);break;case ar:t.blendFuncSeparate(0,769,0,1);break;case lr:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case or:t.blendFuncSeparate(770,771,1,771);break;case sr:t.blendFunc(770,1);break;case ar:t.blendFuncSeparate(0,769,0,1);break;case lr:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}m=null,g=null,v=null,_=null,p=e,w=l}}else!0===d&&(z(3042),d=!1)}function V(e){b!==e&&(e?t.frontFace(2304):t.frontFace(2305),b=e)}function j(e){e!==Wn?(U(2884),e!==x&&(e===qn?t.cullFace(1029):e===Kn?t.cullFace(1028):t.cullFace(1032))):z(2884),x=e}function W(e,n,r){e?(U(32823),S===n&&M===r||(t.polygonOffset(n,r),S=n,M=r)):z(32823)}function q(e){void 0===e&&(e=33984+T-1),C!==e&&(t.activeTexture(e),C=e)}return{buffers:{color:i,depth:o,stencil:s},enable:U,disable:z,bindFramebuffer:function(e,n){return l[e]!==n&&(t.bindFramebuffer(e,n),l[e]=n,r&&(36009===e&&(l[36160]=n),36160===e&&(l[36009]=n)),!0)},drawBuffers:function(r,i){let o=u,s=!1;if(r)if(o=c.get(i),void 0===o&&(o=[],c.set(i,o)),r.isWebGLMultipleRenderTargets){const t=r.texture;if(o.length!==t.length||36064!==o[0]){for(let e=0,n=t.length;e<n;e++)o[e]=36064+e;o.length=t.length,s=!0}}else 36064!==o[0]&&(o[0]=36064,s=!0);else 1029!==o[0]&&(o[0]=1029,s=!0);s&&(n.isWebGL2?t.drawBuffers(o):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(o))},useProgram:function(e){return h!==e&&(t.useProgram(e),h=e,!0)},setBlending:G,setMaterial:function(t,e){t.side===er?z(2884):U(2884);let n=t.side===tr;e&&(n=!n),V(n),t.blending===or&&!1===t.transparent?G(ir):G(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite);const r=t.stencilWrite;s.setTest(r),r&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),W(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?U(32926):z(32926)},setFlipSided:V,setCullFace:j,setLineWidth:function(e){e!==E&&(A&&t.lineWidth(e),E=e)},setPolygonOffset:W,setScissorTest:function(t){t?U(3089):z(3089)},activeTexture:q,bindTexture:function(e,n){null===C&&q();let r=P[C];void 0===r&&(r={type:void 0,texture:void 0},P[C]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||B[e]),r.type=e,r.texture=n)},unbindTexture:function(){const e=P[C];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===N.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),N.copy(e))},viewport:function(e){!1===k.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),k.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===r&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),a={},C=null,P={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,f=null,m=null,g=null,y=null,v=null,_=null,w=!1,b=null,x=null,E=null,S=null,M=null,N.set(0,0,t.canvas.width,t.canvas.height),k.set(0,0,t.canvas.width,t.canvas.height),i.reset(),o.reset(),s.reset()}}}function Ih(t,e,n,r,i,o,s){const a=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,u=i.maxTextureSize,h=i.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,p=new WeakMap;let f,m=!1;try{m="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function g(t,e){return m?new OffscreenCanvas(t,e):gs("canvas")}function y(t,e,n,r){let i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const r=e?cs:Math.floor,o=r(i*t.width),s=r(i*t.height);void 0===f&&(f=g(o,s));const a=n?g(o,s):f;return a.width=o,a.height=s,a.getContext("2d").drawImage(t,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+s+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function v(t){return as(t.width)&&as(t.height)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==$r&&t.minFilter!==ii}function w(e){t.generateMipmap(e)}function b(n,r,i,o,s=!1){if(!1===a)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=r;return 6403===r&&(5126===i&&(l=33326),5131===i&&(l=33325),5121===i&&(l=33321)),33319===r&&(5126===i&&(l=33328),5131===i&&(l=33327),5121===i&&(l=33323)),6408===r&&(5126===i&&(l=34836),5131===i&&(l=34842),5121===i&&(l=o===_o&&!1===s?35907:32856),32819===i&&(l=32854),32820===i&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||e.get("EXT_color_buffer_float"),l}function x(t,e,n){return!0===_(t,n)||t.isFramebufferTexture&&t.minFilter!==$r&&t.minFilter!==ii?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function E(t){return t===$r||t===ti||t===ni?9728:9729}function S(e){const n=e.target;n.removeEventListener("dispose",S),function(e){const n=r.get(e);void 0!==n.__webglInit&&(t.deleteTexture(n.__webglTexture),r.remove(e))}(n),n.isVideoTexture&&p.delete(n),s.memory.textures--}function M(e){const n=e.target;n.removeEventListener("dispose",M),function(e){const n=e.texture,i=r.get(e),o=r.get(n);if(e){if(void 0!==o.__webglTexture&&(t.deleteTexture(o.__webglTexture),s.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(i.__webglFramebuffer[e]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[e]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&t.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,i=n.length;e<i;e++){const i=r.get(n[e]);i.__webglTexture&&(t.deleteTexture(i.__webglTexture),s.memory.textures--),r.remove(n[e])}r.remove(n),r.remove(e)}}(n)}let T=0;function A(t,e){const i=r.get(t);if(t.isVideoTexture&&function(t){const e=s.render.frame;p.get(t)!==e&&(p.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){const n=t.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void O(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function R(e,i){const s=r.get(e);e.version>0&&s.__version!==e.version?function(e,r,i){if(6!==r.image.length)return;I(e,r),n.activeTexture(33984+i),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);const s=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),l=r.image[0]&&r.image[0].isDataTexture,u=[];for(let t=0;t<6;t++)u[t]=s||l?l?r.image[t].image:r.image[t]:y(r.image[t],!1,!0,c),u[t]=U(r,u[t]);const h=u[0],d=v(h)||a,p=o.convert(r.format,r.encoding),f=o.convert(r.type),m=b(r.internalFormat,p,f,r.encoding),g=a&&!0!==r.isVideoTexture,E=void 0===e.__version;let S,M=x(r,h,d);if(P(34067,r,d),s){g&&E&&n.texStorage2D(34067,M,m,h.width,h.height);for(let t=0;t<6;t++){S=u[t].mipmaps;for(let e=0;e<S.length;e++){const i=S[e];r.format!==bi?null!==p?g?n.compressedTexSubImage2D(34069+t,e,0,0,i.width,i.height,p,i.data):n.compressedTexImage2D(34069+t,e,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?n.texSubImage2D(34069+t,e,0,0,i.width,i.height,p,f,i.data):n.texImage2D(34069+t,e,m,i.width,i.height,0,p,f,i.data)}}}else{S=r.mipmaps,g&&E&&(S.length>0&&M++,n.texStorage2D(34067,M,m,u[0].width,u[0].height));for(let t=0;t<6;t++)if(l){g?n.texSubImage2D(34069+t,0,0,0,u[t].width,u[t].height,p,f,u[t].data):n.texImage2D(34069+t,0,m,u[t].width,u[t].height,0,p,f,u[t].data);for(let e=0;e<S.length;e++){const r=S[e].image[t].image;g?n.texSubImage2D(34069+t,e+1,0,0,r.width,r.height,p,f,r.data):n.texImage2D(34069+t,e+1,m,r.width,r.height,0,p,f,r.data)}}else{g?n.texSubImage2D(34069+t,0,0,0,p,f,u[t]):n.texImage2D(34069+t,0,m,p,f,u[t]);for(let e=0;e<S.length;e++){const r=S[e];g?n.texSubImage2D(34069+t,e+1,0,0,p,f,r.image[t]):n.texImage2D(34069+t,e+1,m,p,f,r.image[t])}}}_(r,d)&&w(34067),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}(s,e,i):(n.activeTexture(33984+i),n.bindTexture(34067,s.__webglTexture))}const L={[Jr]:10497,[Zr]:33071,[Qr]:33648},C={[$r]:9728,[ti]:9984,[ni]:9986,[ii]:9729,[oi]:9985,[ai]:9987};function P(n,o,s){if(s?(t.texParameteri(n,10242,L[o.wrapS]),t.texParameteri(n,10243,L[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,L[o.wrapR]),t.texParameteri(n,10240,C[o.magFilter]),t.texParameteri(n,10241,C[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),o.wrapS===Zr&&o.wrapT===Zr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,E(o.magFilter)),t.texParameteri(n,10241,E(o.minFilter)),o.minFilter!==$r&&o.minFilter!==ii&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const s=e.get("EXT_texture_filter_anisotropic");if(o.type===mi&&!1===e.has("OES_texture_float_linear"))return;if(!1===a&&o.type===gi&&!1===e.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function I(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",S),e.__webglTexture=t.createTexture(),s.memory.textures++)}function O(e,r,i){let s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),I(e,r),n.activeTexture(33984+i),n.bindTexture(s,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);const l=function(t){return!a&&(t.wrapS!==Zr||t.wrapT!==Zr||t.minFilter!==$r&&t.minFilter!==ii)}(r)&&!1===v(r.image);let c=y(r.image,l,!1,u);c=U(r,c);const h=v(c)||a,d=o.convert(r.format,r.encoding);let p,f=o.convert(r.type),m=b(r.internalFormat,d,f,r.encoding,r.isVideoTexture);P(s,r,h);const g=r.mipmaps,E=a&&!0!==r.isVideoTexture,S=void 0===e.__version,M=x(r,c,h);if(r.isDepthTexture)m=6402,a?m=r.type===mi?36012:r.type===fi?33190:r.type===_i?35056:33189:r.type===mi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===Si&&6402===m&&r.type!==di&&r.type!==fi&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=di,f=o.convert(r.type)),r.format===Mi&&6402===m&&(m=34041,r.type!==_i&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=_i,f=o.convert(r.type))),E&&S?n.texStorage2D(3553,1,m,c.width,c.height):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,null);else if(r.isDataTexture)if(g.length>0&&h){E&&S&&n.texStorage2D(3553,M,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],E?n.texSubImage2D(3553,0,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data);r.generateMipmaps=!1}else E?(S&&n.texStorage2D(3553,M,m,c.width,c.height),n.texSubImage2D(3553,0,0,0,c.width,c.height,d,f,c.data)):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,c.data);else if(r.isCompressedTexture){E&&S&&n.texStorage2D(3553,M,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],r.format!==bi?null!==d?E?n.compressedTexSubImage2D(3553,t,0,0,p.width,p.height,d,p.data):n.compressedTexImage2D(3553,t,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?n.texSubImage2D(3553,t,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data)}else if(r.isDataTexture2DArray)E?(S&&n.texStorage3D(35866,M,m,c.width,c.height,c.depth),n.texSubImage3D(35866,0,0,0,0,c.width,c.height,c.depth,d,f,c.data)):n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,d,f,c.data);else if(r.isDataTexture3D)E?(S&&n.texStorage3D(32879,M,m,c.width,c.height,c.depth),n.texSubImage3D(32879,0,0,0,0,c.width,c.height,c.depth,d,f,c.data)):n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,d,f,c.data);else if(r.isFramebufferTexture)E&&S?n.texStorage2D(3553,M,m,c.width,c.height):n.texImage2D(3553,0,m,c.width,c.height,0,d,f,null);else if(g.length>0&&h){E&&S&&n.texStorage2D(3553,M,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],E?n.texSubImage2D(3553,t,0,0,d,f,p):n.texImage2D(3553,t,m,d,f,p);r.generateMipmaps=!1}else E?(S&&n.texStorage2D(3553,M,m,c.width,c.height),n.texSubImage2D(3553,0,0,0,d,f,c)):n.texImage2D(3553,0,m,d,f,c);_(r,h)&&w(s),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function N(e,i,s,a,l){const c=o.convert(s.format,s.encoding),u=o.convert(s.type),h=b(s.internalFormat,c,u,s.encoding);r.get(i).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(l,0,h,i.width,i.height,0,c,u,null)),n.bindFramebuffer(36160,e),i.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,a,l,r.get(s).__webglTexture,0,B(i)):t.framebufferTexture2D(36160,a,l,r.get(s).__webglTexture,0),n.bindFramebuffer(36160,null)}function k(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r||n.useRenderToTexture){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===mi?i=36012:e.type===fi&&(i=33190));const r=B(n);n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,r,i,n.width,n.height):t.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){const i=B(n);r&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,i,35056,n.width,n.height):n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,i,35056,n.width,n.height):t.renderbufferStorage(36161,34041,n.width,n.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,i=o.convert(e.format,e.encoding),s=o.convert(e.type),a=b(e.internalFormat,i,s,e.encoding),l=B(n);r&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,l,a,n.width,n.height):n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,l,a,n.width,n.height):t.renderbufferStorage(36161,a,n.width,n.height)}t.bindRenderbuffer(36161,null)}function D(e){const i=r.get(e),o=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!i.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),A(i.depthTexture,0);const o=r.get(i.depthTexture).__webglTexture,s=B(i);if(i.depthTexture.format===Si)i.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,o,0,s):t.framebufferTexture2D(36160,36096,3553,o,0);else{if(i.depthTexture.format!==Mi)throw new Error("Unknown depthTexture format");i.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,o,0,s):t.framebufferTexture2D(36160,33306,3553,o,0)}}(i.__webglFramebuffer,e)}else if(o){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(36160,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=t.createRenderbuffer(),k(i.__webglDepthbuffer[r],e,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),k(i.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}function B(t){return a&&(t.useRenderbuffer||t.useRenderToTexture)?Math.min(h,t.samples):0}function U(t,n){const r=t.encoding,i=t.format,o=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===Zo||r!==vo&&(r===_o?!1===a?!0===e.has("EXT_sRGB")&&i===bi?(t.format=Zo,t.minFilter=ii,t.generateMipmaps=!1):n=Ms.sRGBToLinear(n):i===bi&&o===ci||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",r)),n}let z=!1,F=!1;this.allocateTextureUnit=function(){const t=T;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),T+=1,t},this.resetTextureUnits=function(){T=0},this.setTexture2D=A,this.setTexture2DArray=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?O(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?O(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=R,this.rebindTextures=function(t,e,n){const i=r.get(t);void 0!==e&&N(i.__webglFramebuffer,t,t.texture,36064,3553),void 0!==n&&D(t)},this.setupRenderTarget=function(e){const l=e.texture,c=r.get(e),u=r.get(l);e.addEventListener("dispose",M),!0!==e.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=t.createTexture()),u.__version=l.version,s.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,p=l.isDataTexture3D||l.isDataTexture2DArray,f=v(e)||a;if(h){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else if(c.__webglFramebuffer=t.createFramebuffer(),d)if(i.drawBuffers){const n=e.texture;for(let e=0,i=n.length;e<i;e++){const i=r.get(n[e]);void 0===i.__webglTexture&&(i.__webglTexture=t.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(e.useRenderbuffer)if(a){c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const r=o.convert(l.format,l.encoding),i=o.convert(l.type),s=b(l.internalFormat,r,i,l.encoding),a=B(e);t.renderbufferStorageMultisample(36161,a,s,e.width,e.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),k(c.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(34067,u.__webglTexture),P(34067,l,f);for(let t=0;t<6;t++)N(c.__webglFramebuffer[t],e,l,36064,34069+t);_(l,f)&&w(34067),n.unbindTexture()}else if(d){const t=e.texture;for(let i=0,o=t.length;i<o;i++){const o=t[i],s=r.get(o);n.bindTexture(3553,s.__webglTexture),P(3553,o,f),N(c.__webglFramebuffer,e,o,36064+i,3553),_(o,f)&&w(3553)}n.unbindTexture()}else{let t=3553;p&&(a?t=l.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(t,u.__webglTexture),P(t,l,f),N(c.__webglFramebuffer,e,l,36064,t),_(l,f)&&w(t),n.unbindTexture()}e.depthBuffer&&D(e)},this.updateRenderTargetMipmap=function(t){const e=v(t)||a,i=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let o=0,s=i.length;o<s;o++){const s=i[o];if(_(s,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,i=r.get(s).__webglTexture;n.bindTexture(e,i),w(e),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.useRenderbuffer)if(a){const i=e.width,o=e.height;let s=16384;const a=[36064],l=e.stencilBuffer?33306:36096;e.depthBuffer&&a.push(l),e.ignoreDepthForMultisampleCopy||(e.depthBuffer&&(s|=256),e.stencilBuffer&&(s|=1024));const c=r.get(e);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer),e.ignoreDepthForMultisampleCopy&&(t.invalidateFramebuffer(36008,[l]),t.invalidateFramebuffer(36009,[l])),t.blitFramebuffer(0,0,i,o,0,0,i,o,s,9728),t.invalidateFramebuffer(36008,a),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=D,this.setupFrameBufferTexture=N,this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),A(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),F=!0),t=t.texture),R(t,e)}}function Oh(t,e,n){const r=n.isWebGL2;return{convert:function(t,n=null){let i;if(t===ci)return 5121;if(t===yi)return 32819;if(t===vi)return 32820;if(t===ui)return 5120;if(t===hi)return 5122;if(t===di)return 5123;if(t===pi)return 5124;if(t===fi)return 5125;if(t===mi)return 5126;if(t===gi)return r?5131:(i=e.get("OES_texture_half_float"),null!==i?i.HALF_FLOAT_OES:null);if(t===wi)return 6406;if(t===bi)return 6408;if(t===xi)return 6409;if(t===Ei)return 6410;if(t===Si)return 6402;if(t===Mi)return 34041;if(t===Ti)return 6403;if(t===Zo)return i=e.get("EXT_sRGB"),null!==i?i.SRGB_ALPHA_EXT:null;if(t===Ai)return 36244;if(t===Ri)return 33319;if(t===Li)return 33320;if(t===Ci)return 36249;if(t===Pi||t===Ii||t===Oi||t===Ni)if(n===_o){if(i=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(t===Pi)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(t===Ii)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(t===Oi)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(t===Ni)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=e.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(t===Pi)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===Ii)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===Oi)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===Ni)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===ki||t===Di||t===Bi||t===Ui){if(i=e.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(t===ki)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===Di)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===Bi)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===Ui)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===zi)return i=e.get("WEBGL_compressed_texture_etc1"),null!==i?i.COMPRESSED_RGB_ETC1_WEBGL:null;if(t===Fi||t===Hi){if(i=e.get("WEBGL_compressed_texture_etc"),null===i)return null;if(t===Fi)return n===_o?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(t===Hi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(t===Gi||t===Vi||t===ji||t===Wi||t===qi||t===Ki||t===Xi||t===Yi||t===Ji||t===Zi||t===Qi||t===$i||t===to||t===eo){if(i=e.get("WEBGL_compressed_texture_astc"),null===i)return null;if(t===Gi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(t===Vi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(t===ji)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(t===Wi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(t===qi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(t===Ki)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(t===Xi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(t===Yi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(t===Ji)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(t===Zi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(t===Qi)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(t===$i)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(t===to)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(t===eo)return n===_o?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(t===no){if(i=e.get("EXT_texture_compression_bptc"),null===i)return null;if(t===no)return n===_o?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}return t===_i?r?34042:(i=e.get("WEBGL_depth_texture"),null!==i?i.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Lh.prototype.isMeshDistanceMaterial=!0;class Nh extends Vl{constructor(t=[]){super(),this.cameras=t}}Nh.prototype.isArrayCamera=!0;class kh extends Da{constructor(){super(),this.type="Group"}}kh.prototype.isGroup=!0;const Dh={type:"move"};class Bh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new kh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new kh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ns,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ns),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new kh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ns,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ns),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,i=null,o=null;const s=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==s&&(r=e.getPose(t.targetRaySpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Dh))),l&&t.hand){o=!0;for(const r of t.hand.values()){const t=e.getJointPose(r,n);if(void 0===l.joints[r.jointName]){const t=new kh;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[r.jointName]=t,l.add(t)}const i=l.joints[r.jointName];null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=t.radius),i.visible=null!==t}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),a=.02,c=.005;l.inputState.pinching&&s>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&s<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));return null!==s&&(s.visible=null!==r),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==o),this}}class Uh extends As{constructor(t,e,n,r,i,o,s,a,l,c){if((c=void 0!==c?c:Si)!==Si&&c!==Mi)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Si&&(n=di),void 0===n&&c===Mi&&(n=_i),super(null,r,i,o,s,a,c,n,l),this.image={width:t,height:e},this.magFilter=void 0!==s?s:$r,this.minFilter=void 0!==a?a:$r,this.flipY=!1,this.generateMipmaps=!1}}Uh.prototype.isDepthTexture=!0;class zh extends Qo{constructor(t,e){super();const n=this;let r=null,i=1,o=null,s="local-floor";const a=t.extensions.has("WEBGL_multisampled_render_to_texture");let l=null,c=null,u=null,h=null,d=!1,p=null;const f=e.getContextAttributes();let m=null,g=null;const y=[],v=new Map,_=new Vl;_.layers.enable(1),_.viewport=new Ls;const w=new Vl;w.layers.enable(2),w.viewport=new Ls;const b=[_,w],x=new Nh;x.layers.enable(1),x.layers.enable(2);let E=null,S=null;function M(t){const e=v.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function T(){v.forEach((function(t,e){t.disconnect(e)})),v.clear(),E=null,S=null,t.setRenderTarget(m),h=null,u=null,c=null,r=null,g=null,I.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function A(t){const e=r.inputSources;for(let t=0;t<y.length;t++)v.set(e[t],y[t]);for(let e=0;e<t.removed.length;e++){const n=t.removed[e],r=v.get(n);r&&(r.dispatchEvent({type:"disconnected",data:n}),v.delete(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e],r=v.get(n);r&&r.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=y[t];return void 0===e&&(e=new Bh,y[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=y[t];return void 0===e&&(e=new Bh,y[t]=e),e.getGripSpace()},this.getHand=function(t){let e=y[t];return void 0===e&&(e=new Bh,y[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){s=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(l){if(r=l,null!==r){if(m=t.getRenderTarget(),r.addEventListener("select",M),r.addEventListener("selectstart",M),r.addEventListener("selectend",M),r.addEventListener("squeeze",M),r.addEventListener("squeezestart",M),r.addEventListener("squeezeend",M),r.addEventListener("end",T),r.addEventListener("inputsourceschange",A),!0!==f.xrCompatible&&await e.makeXRCompatible(),void 0===r.renderState.layers||!1===t.capabilities.isWebGL2){const n={antialias:void 0!==r.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,e,n),r.updateRenderState({baseLayer:h}),g=new Cs(h.framebufferWidth,h.framebufferHeight,{format:bi,type:ci,encoding:t.outputEncoding})}else{d=f.antialias;let n=null,o=null,s=null;f.depth&&(s=f.stencil?35056:33190,n=f.stencil?Mi:Si,o=f.stencil?_i:di);const l={colorFormat:t.outputEncoding===_o?35907:32856,depthFormat:s,scaleFactor:i};c=new XRWebGLBinding(r,e),u=c.createProjectionLayer(l),r.updateRenderState({layers:[u]}),g=d?new Is(u.textureWidth,u.textureHeight,{format:bi,type:ci,depthTexture:new Uh(u.textureWidth,u.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,useRenderToTexture:a,encoding:t.outputEncoding}):new Cs(u.textureWidth,u.textureHeight,{format:bi,type:ci,depthTexture:new Uh(u.textureWidth,u.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,encoding:t.outputEncoding})}g.isXRRenderTarget=!0,this.setFoveation(1),o=await r.requestReferenceSpace(s),I.setContext(r),I.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const R=new Ns,L=new Ns;function C(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;x.near=w.near=_.near=t.near,x.far=w.far=_.far=t.far,E===x.near&&S===x.far||(r.updateRenderState({depthNear:x.near,depthFar:x.far}),E=x.near,S=x.far);const e=t.parent,n=x.cameras;C(x,e);for(let t=0;t<n.length;t++)C(n[t],e);x.matrixWorld.decompose(x.position,x.quaternion,x.scale),t.position.copy(x.position),t.quaternion.copy(x.quaternion),t.scale.copy(x.scale),t.matrix.copy(x.matrix),t.matrixWorld.copy(x.matrixWorld);const i=t.children;for(let t=0,e=i.length;t<e;t++)i[t].updateMatrixWorld(!0);2===n.length?function(t,e,n){R.setFromMatrixPosition(e.matrixWorld),L.setFromMatrixPosition(n.matrixWorld);const r=R.distanceTo(L),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,s=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(o[8]+1)/o[0],d=s*u,p=s*h,f=r/(-u+h),m=f*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=s+f,y=a+f,v=d-m,_=p+(r-m),w=l*a/y*g,b=c*a/y*g;t.projectionMatrix.makePerspective(v,_,w,b,g,y)}(x,_,w):x.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return x},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(t){null!==u&&(u.fixedFoveation=t),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=t)};let P=null;const I=new ec;I.setAnimationLoop((function(e,n){if(l=n.getViewerPose(o),p=n,null!==l){const e=l.views;null!==h&&(t.setRenderTargetFramebuffer(g,h.framebuffer),t.setRenderTarget(g));let n=!1;e.length!==x.cameras.length&&(x.cameras.length=0,n=!0);for(let r=0;r<e.length;r++){const i=e[r];let o=null;if(null!==h)o=h.getViewport(i);else{const e=c.getViewSubImage(u,i);o=e.viewport,0===r&&(t.setRenderTargetTextures(g,e.colorTexture,u.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(g))}const s=b[r];s.matrix.fromArray(i.transform.matrix),s.projectionMatrix.fromArray(i.projectionMatrix),s.viewport.set(o.x,o.y,o.width,o.height),0===r&&x.matrix.copy(s.matrix),!0===n&&x.cameras.push(s)}}const i=r.inputSources;for(let t=0;t<y.length;t++){const e=y[t],r=i[t];e.update(r,n,o)}P&&P(e,n),p=null})),this.setAnimationLoop=function(t){P=t},this.dispose=function(){}}}function Fh(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);const r=t.get(n).envMap;let i,o;r&&(e.envMap.value=r,e.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?i=n.map:n.specularMap?i=n.specularMap:n.displacementMap?i=n.displacementMap:n.normalMap?i=n.normalMap:n.bumpMap?i=n.bumpMap:n.roughnessMap?i=n.roughnessMap:n.metalnessMap?i=n.metalnessMap:n.alphaMap?i=n.alphaMap:n.emissiveMap?i=n.emissiveMap:n.clearcoatMap?i=n.clearcoatMap:n.clearcoatNormalMap?i=n.clearcoatNormalMap:n.clearcoatRoughnessMap?i=n.clearcoatRoughnessMap:n.specularIntensityMap?i=n.specularIntensityMap:n.specularColorMap?i=n.specularColorMap:n.transmissionMap?i=n.transmissionMap:n.thicknessMap?i=n.thicknessMap:n.sheenColorMap?i=n.sheenColorMap:n.sheenRoughnessMap&&(i=n.sheenRoughnessMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uv2Transform.value.copy(o.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,n.side===tr&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),n.side===tr&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,r,i,o,s){r.isMeshBasicMaterial?e(t,r):r.isMeshLambertMaterial?(e(t,r),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,r)):r.isMeshToonMaterial?(e(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===tr&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===tr&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshPhongMaterial?(e(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===tr&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===tr&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshStandardMaterial?(e(t,r),r.isMeshPhysicalMaterial?function(t,e,r){n(t,e),t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap)),e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===tr&&t.clearcoatNormalScale.value.negate())),e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=r.texture,t.transmissionSamplerSize.value.set(r.width,r.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)),t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,r,s):n(t,r)):r.isMeshMatcapMaterial?(e(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===tr&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===tr&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDepthMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDistanceMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,r)):r.isMeshNormalMaterial?(e(t,r),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===tr&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===tr&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,r){let i;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?i=e.map:e.alphaMap&&(i=e.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,r,i,o):r.isSpriteMaterial?function(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Hh(t={}){const e=void 0!==t.canvas?t.canvas:function(){const t=gs("canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let h=null,d=null;const p=[],f=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=vo,this.physicallyCorrectLights=!1,this.toneMapping=Br,this.toneMappingExposure=1;const m=this;let g=!1,y=0,v=0,_=null,w=-1,b=null;const x=new Ls,E=new Ls;let S=null,M=e.width,T=e.height,A=1,R=null,L=null;const C=new Ls(0,0,M,T),P=new Ls(0,0,M,T);let I=!1;const O=new tc;let N=!1,k=!1,D=null;const B=new ha,U=new Ns,z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function F(){return null===_?A:1}let H,G,V,j,W,q,K,X,Y,J,Z,Q,$,tt,et,nt,rt,it,ot,st,at,lt,ct,ut=n;function ht(t,n){for(let r=0;r<t.length;r++){const i=t[r],o=e.getContext(i,n);if(null!==o)return o}return null}try{const t={alpha:!0,depth:i,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Gn}`),e.addEventListener("webglcontextlost",ft,!1),e.addEventListener("webglcontextrestored",mt,!1),null===ut){const e=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&e.shift(),ut=ht(e,t),null===ut)throw ht(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ut.getShaderPrecisionFormat&&(ut.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function dt(){H=new Nc(ut),G=new uc(ut,H,t),H.init(G),lt=new Oh(ut,H,G),V=new Ph(ut,H,G),j=new Bc(ut),W=new yh,q=new Ih(ut,H,V,W,G,lt,j),K=new dc(m),X=new Oc(m),Y=new nc(ut,G),ct=new lc(ut,H,Y,G),J=new kc(ut,Y,j,ct),Z=new Vc(ut,J,Y,j),ot=new Gc(ut,G,q),nt=new hc(W),Q=new gh(m,K,X,H,G,ct,nt),$=new Fh(W),tt=new bh,et=new Ah(H,G),it=new ac(m,K,V,Z,r,a),rt=new Ch(m,Z,G),st=new cc(ut,H,j,G),at=new Dc(ut,H,j,G),j.programs=Q.programs,m.capabilities=G,m.extensions=H,m.properties=W,m.renderLists=tt,m.shadowMap=rt,m.state=V,m.info=j}dt();const pt=new zh(m,ut);function ft(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function mt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const t=j.autoReset,e=rt.enabled,n=rt.autoUpdate,r=rt.needsUpdate,i=rt.type;dt(),j.autoReset=t,rt.enabled=e,rt.autoUpdate=n,rt.needsUpdate=r,rt.type=i}function gt(t){const e=t.target;e.removeEventListener("dispose",gt),function(t){(function(t){const e=W.get(t).programs;void 0!==e&&(e.forEach((function(t){Q.releaseProgram(t)})),t.isShaderMaterial&&Q.releaseShaderCache(t))})(t),W.remove(t)}(e)}this.xr=pt,this.getContext=function(){return ut},this.getContextAttributes=function(){return ut.getContextAttributes()},this.forceContextLoss=function(){const t=H.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=H.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return A},this.setPixelRatio=function(t){void 0!==t&&(A=t,this.setSize(M,T,!1))},this.getSize=function(t){return t.set(M,T)},this.setSize=function(t,n,r){pt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(M=t,T=n,e.width=Math.floor(t*A),e.height=Math.floor(n*A),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(M*A,T*A).floor()},this.setDrawingBufferSize=function(t,n,r){M=t,T=n,A=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(x)},this.getViewport=function(t){return t.copy(C)},this.setViewport=function(t,e,n,r){t.isVector4?C.set(t.x,t.y,t.z,t.w):C.set(t,e,n,r),V.viewport(x.copy(C).multiplyScalar(A).floor())},this.getScissor=function(t){return t.copy(P)},this.setScissor=function(t,e,n,r){t.isVector4?P.set(t.x,t.y,t.z,t.w):P.set(t,e,n,r),V.scissor(E.copy(P).multiplyScalar(A).floor())},this.getScissorTest=function(){return I},this.setScissorTest=function(t){V.setScissorTest(I=t)},this.setOpaqueSort=function(t){R=t},this.setTransparentSort=function(t){L=t},this.getClearColor=function(t){return t.copy(it.getClearColor())},this.setClearColor=function(){it.setClearColor.apply(it,arguments)},this.getClearAlpha=function(){return it.getClearAlpha()},this.setClearAlpha=function(){it.setClearAlpha.apply(it,arguments)},this.clear=function(t,e,n){let r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),ut.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ft,!1),e.removeEventListener("webglcontextrestored",mt,!1),tt.dispose(),et.dispose(),W.dispose(),K.dispose(),X.dispose(),Z.dispose(),ct.dispose(),Q.dispose(),pt.dispose(),pt.removeEventListener("sessionstart",vt),pt.removeEventListener("sessionend",_t),D&&(D.dispose(),D=null),wt.stop()},this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=z);const s=i.isMesh&&i.matrixWorld.determinant()<0,a=function(t,e,n,r,i){!0!==e.isScene&&(e=z),q.resetTextureUnits();const o=e.fog,s=r.isMeshStandardMaterial?e.environment:null,a=null===_?m.outputEncoding:!0===_.isXRRenderTarget?_.texture.encoding:vo,l=(r.isMeshStandardMaterial?X:K).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,f=n.morphAttributes.position?n.morphAttributes.position.length:0,g=r.toneMapped?m.toneMapping:Br,y=W.get(r),v=d.state.lights;if(!0===N&&(!0===k||t!==b)){const e=t===b&&r.id===w;nt.setState(r,t,e)}let x=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==v.state.version||y.outputEncoding!==a||i.isInstancedMesh&&!1===y.instancing?x=!0:i.isInstancedMesh||!0!==y.instancing?i.isSkinnedMesh&&!1===y.skinning?x=!0:i.isSkinnedMesh||!0!==y.skinning?y.envMap!==l||r.fog&&y.fog!==o?x=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===nt.numPlanes&&y.numIntersection===nt.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==h||y.morphNormals!==p||y.toneMapping!==g||!0===G.isWebGL2&&y.morphTargetsCount!==f)&&(x=!0):x=!0:x=!0:x=!0:(x=!0,y.__version=r.version);let E=y.currentProgram;!0===x&&(E=Mt(r,e,i));let S=!1,M=!1,R=!1;const L=E.getUniforms(),C=y.uniforms;if(V.useProgram(E.program)&&(S=!0,M=!0,R=!0),r.id!==w&&(w=r.id,M=!0),S||b!==t){if(L.setValue(ut,"projectionMatrix",t.projectionMatrix),G.logarithmicDepthBuffer&&L.setValue(ut,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),b!==t&&(b=t,M=!0,R=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const e=L.map.cameraPosition;void 0!==e&&e.setValue(ut,U.setFromMatrixPosition(t.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&L.setValue(ut,"isOrthographic",!0===t.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&L.setValue(ut,"viewMatrix",t.matrixWorldInverse)}if(i.isSkinnedMesh){L.setOptional(ut,i,"bindMatrix"),L.setOptional(ut,i,"bindMatrixInverse");const t=i.skeleton;t&&(G.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),L.setValue(ut,"boneTexture",t.boneTexture,q),L.setValue(ut,"boneTextureSize",t.boneTextureSize)):L.setOptional(ut,t,"boneMatrices"))}var P,I;return!n||void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||ot.update(i,n,r,E),(M||y.receiveShadow!==i.receiveShadow)&&(y.receiveShadow=i.receiveShadow,L.setValue(ut,"receiveShadow",i.receiveShadow)),M&&(L.setValue(ut,"toneMappingExposure",m.toneMappingExposure),y.needsLights&&(I=R,(P=C).ambientLightColor.needsUpdate=I,P.lightProbe.needsUpdate=I,P.directionalLights.needsUpdate=I,P.directionalLightShadows.needsUpdate=I,P.pointLights.needsUpdate=I,P.pointLightShadows.needsUpdate=I,P.spotLights.needsUpdate=I,P.spotLightShadows.needsUpdate=I,P.rectAreaLights.needsUpdate=I,P.hemisphereLights.needsUpdate=I),o&&r.fog&&$.refreshFogUniforms(C,o),$.refreshMaterialUniforms(C,r,A,T,D),Xu.upload(ut,y.uniformsList,C,q)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Xu.upload(ut,y.uniformsList,C,q),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&L.setValue(ut,"center",i.center),L.setValue(ut,"modelViewMatrix",i.modelViewMatrix),L.setValue(ut,"normalMatrix",i.normalMatrix),L.setValue(ut,"modelMatrix",i.matrixWorld),E}(t,e,n,r,i);V.setMaterial(r,s);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===r.wireframe&&(l=J.getWireframeAttribute(n),h=2),ct.setup(i,r,a,n,l);let p=st;null!==l&&(u=Y.get(l),p=at,p.setIndex(u));const f=null!==l?l.count:c.count,g=n.drawRange.start*h,y=n.drawRange.count*h,v=null!==o?o.start*h:0,x=null!==o?o.count*h:1/0,E=Math.max(g,v),S=Math.min(f,g+y,v+x)-1,M=Math.max(0,S-E+1);if(0!==M){if(i.isMesh)!0===r.wireframe?(V.setLineWidth(r.wireframeLinewidth*F()),p.setMode(1)):p.setMode(4);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),V.setLineWidth(t*F()),i.isLineSegments?p.setMode(1):i.isLineLoop?p.setMode(2):p.setMode(3)}else i.isPoints?p.setMode(0):i.isSprite&&p.setMode(4);if(i.isInstancedMesh)p.renderInstances(E,M,i.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);p.renderInstances(E,M,t)}else p.render(E,M)}},this.compile=function(t,e){d=et.get(t),d.init(),f.push(d),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights(m.physicallyCorrectLights),t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++)Mt(n[r],t,e);else Mt(n,t,e)})),f.pop(),d=null};let yt=null;function vt(){wt.stop()}function _t(){wt.start()}const wt=new ec;function bt(t,e,n,r){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||O.intersectsSprite(t)){r&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);const e=Z.update(t),i=t.material;i.visible&&h.push(t,e,i,n,U.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==j.render.frame&&(t.skeleton.update(),t.skeleton.frame=j.render.frame),!t.frustumCulled||O.intersectsObject(t))){r&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);const e=Z.update(t),i=t.material;if(Array.isArray(i)){const r=e.groups;for(let o=0,s=r.length;o<s;o++){const s=r[o],a=i[s.materialIndex];a&&a.visible&&h.push(t,e,a,n,U.z,s)}}else i.visible&&h.push(t,e,i,n,U.z,null)}const i=t.children;for(let t=0,o=i.length;t<o;t++)bt(i[t],e,n,r)}function xt(t,e,n,r){const i=t.opaque,o=t.transmissive,a=t.transparent;d.setupLightsView(n),o.length>0&&function(t,e,n){if(null===D){const t=!0===s&&!0===G.isWebGL2;D=new(t?Is:Cs)(1024,1024,{generateMipmaps:!0,type:null!==lt.convert(gi)?gi:ci,minFilter:ai,magFilter:$r,wrapS:Zr,wrapT:Zr,useRenderToTexture:H.has("WEBGL_multisampled_render_to_texture")})}const r=m.getRenderTarget();m.setRenderTarget(D),m.clear();const i=m.toneMapping;m.toneMapping=Br,Et(t,e,n),m.toneMapping=i,q.updateMultisampleRenderTarget(D),q.updateRenderTargetMipmap(D),m.setRenderTarget(r)}(i,e,n),r&&V.viewport(x.copy(r)),i.length>0&&Et(i,e,n),o.length>0&&Et(o,e,n),a.length>0&&Et(a,e,n)}function Et(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,o=t.length;i<o;i++){const o=t[i],s=o.object,a=o.geometry,l=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&St(s,e,n,a,l,c)}}function St(t,e,n,r,i,o){t.onBeforeRender(m,e,n,r,i,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),i.onBeforeRender(m,e,n,r,t,o),!0===i.transparent&&i.side===er?(i.side=tr,i.needsUpdate=!0,m.renderBufferDirect(n,e,r,i,t,o),i.side=$n,i.needsUpdate=!0,m.renderBufferDirect(n,e,r,i,t,o),i.side=er):m.renderBufferDirect(n,e,r,i,t,o),t.onAfterRender(m,e,n,r,i,o)}function Mt(t,e,n){!0!==e.isScene&&(e=z);const r=W.get(t),i=d.state.lights,o=d.state.shadowsArray,s=i.state.version,a=Q.getParameters(t,i.state,o,e,n),l=Q.getProgramCacheKey(a);let c=r.programs;r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=(t.isMeshStandardMaterial?X:K).get(t.envMap||r.environment),void 0===c&&(t.addEventListener("dispose",gt),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===s)return Tt(t,a),u}else a.uniforms=Q.getUniforms(t),t.onBuild(n,a,m),t.onBeforeCompile(a,m),u=Q.acquireProgram(a,l),c.set(l,u),r.uniforms=a.uniforms;const h=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=nt.uniform),Tt(t,a),r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const p=u.getUniforms(),f=Xu.seqWithValue(p.seq,h);return r.currentProgram=u,r.uniformsList=f,u}function Tt(t,e){const n=W.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}wt.setAnimationLoop((function(t){yt&&yt(t)})),"undefined"!=typeof window&&wt.setContext(window),this.setAnimationLoop=function(t){yt=t,pt.setAnimationLoop(t),null===t?wt.stop():wt.start()},pt.addEventListener("sessionstart",vt),pt.addEventListener("sessionend",_t),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===pt.enabled&&!0===pt.isPresenting&&(!0===pt.cameraAutoUpdate&&pt.updateCamera(e),e=pt.getCamera()),!0===t.isScene&&t.onBeforeRender(m,t,e,_),d=et.get(t,f.length),d.init(),f.push(d),B.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),O.setFromProjectionMatrix(B),k=this.localClippingEnabled,N=nt.init(this.clippingPlanes,k,e),h=tt.get(t,p.length),h.init(),p.push(h),bt(t,e,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(R,L),!0===N&&nt.beginShadows();const n=d.state.shadowsArray;if(rt.render(n,t,e),!0===N&&nt.endShadows(),!0===this.info.autoReset&&this.info.reset(),it.render(h,t),d.setupLights(m.physicallyCorrectLights),e.isArrayCamera){const n=e.cameras;for(let e=0,r=n.length;e<r;e++){const r=n[e];xt(h,t,r,r.viewport)}}else xt(h,t,e);null!==_&&(q.updateMultisampleRenderTarget(_),q.updateRenderTargetMipmap(_)),!0===t.isScene&&t.onAfterRender(m,t,e),V.buffers.depth.setTest(!0),V.buffers.depth.setMask(!0),V.buffers.color.setMask(!0),V.setPolygonOffset(!1),ct.resetDefaultState(),w=-1,b=null,f.pop(),d=f.length>0?f[f.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(t,e,n){W.get(t.texture).__webglTexture=e,W.get(t.depthTexture).__webglTexture=n;const r=W.get(t);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||t.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),t.useRenderToTexture=!1,t.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(t,e){const n=W.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){_=t,y=e,v=n;let r=!0;if(t){const e=W.get(t);void 0!==e.__useDefaultFramebuffer?(V.bindFramebuffer(36160,null),r=!1):void 0===e.__webglFramebuffer?q.setupRenderTarget(t):e.__hasExternalTextures&&q.rebindTextures(t,W.get(t.texture).__webglTexture,W.get(t.depthTexture).__webglTexture)}let i=null,o=!1,s=!1;if(t){const n=t.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(s=!0);const r=W.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=r[e],o=!0):i=t.useRenderbuffer?W.get(t).__webglMultisampledFramebuffer:r,x.copy(t.viewport),E.copy(t.scissor),S=t.scissorTest}else x.copy(C).multiplyScalar(A).floor(),E.copy(P).multiplyScalar(A).floor(),S=I;if(V.bindFramebuffer(36160,i)&&G.drawBuffers&&r&&V.drawBuffers(t,i),V.viewport(x),V.scissor(E),V.setScissorTest(S),o){const r=W.get(t.texture);ut.framebufferTexture2D(36160,36064,34069+e,r.__webglTexture,n)}else if(s){const r=W.get(t.texture),i=e||0;ut.framebufferTextureLayer(36160,36064,r.__webglTexture,n||0,i)}w=-1},this.readRenderTargetPixels=function(t,e,n,r,i,o,s){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=W.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){V.bindFramebuffer(36160,a);try{const s=t.texture,a=s.format,l=s.type;if(a!==bi&&lt.convert(a)!==ut.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===gi&&(H.has("EXT_color_buffer_half_float")||G.isWebGL2&&H.has("EXT_color_buffer_float"));if(!(l===ci||lt.convert(l)===ut.getParameter(35738)||l===mi&&(G.isWebGL2||H.has("OES_texture_float")||H.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ut.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&ut.readPixels(e,n,r,i,lt.convert(a),lt.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const t=null!==_?W.get(_).__webglFramebuffer:null;V.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){if(!0!==e.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r);q.setTexture2D(e,0),ut.copyTexSubImage2D(3553,n,0,0,t.x,t.y,i,o),V.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r=0){const i=e.image.width,o=e.image.height,s=lt.convert(n.format),a=lt.convert(n.type);q.setTexture2D(n,0),ut.pixelStorei(37440,n.flipY),ut.pixelStorei(37441,n.premultiplyAlpha),ut.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?ut.texSubImage2D(3553,r,t.x,t.y,i,o,s,a,e.image.data):e.isCompressedTexture?ut.compressedTexSubImage2D(3553,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,s,e.mipmaps[0].data):ut.texSubImage2D(3553,r,t.x,t.y,s,a,e.image),0===r&&n.generateMipmaps&&ut.generateMipmap(3553),V.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,r,i=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const o=t.max.x-t.min.x+1,s=t.max.y-t.min.y+1,a=t.max.z-t.min.z+1,l=lt.convert(r.format),c=lt.convert(r.type);let u;if(r.isDataTexture3D)q.setTexture3D(r,0),u=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");q.setTexture2DArray(r,0),u=35866}ut.pixelStorei(37440,r.flipY),ut.pixelStorei(37441,r.premultiplyAlpha),ut.pixelStorei(3317,r.unpackAlignment);const h=ut.getParameter(3314),d=ut.getParameter(32878),p=ut.getParameter(3316),f=ut.getParameter(3315),g=ut.getParameter(32877),y=n.isCompressedTexture?n.mipmaps[0]:n.image;ut.pixelStorei(3314,y.width),ut.pixelStorei(32878,y.height),ut.pixelStorei(3316,t.min.x),ut.pixelStorei(3315,t.min.y),ut.pixelStorei(32877,t.min.z),n.isDataTexture||n.isDataTexture3D?ut.texSubImage3D(u,i,e.x,e.y,e.z,o,s,a,l,c,y.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ut.compressedTexSubImage3D(u,i,e.x,e.y,e.z,o,s,a,l,y.data)):ut.texSubImage3D(u,i,e.x,e.y,e.z,o,s,a,l,c,y),ut.pixelStorei(3314,h),ut.pixelStorei(32878,d),ut.pixelStorei(3316,p),ut.pixelStorei(3315,f),ut.pixelStorei(32877,g),0===i&&r.generateMipmaps&&ut.generateMipmap(u),V.unbindTexture()},this.initTexture=function(t){q.setTexture2D(t,0),V.unbindTexture()},this.resetState=function(){y=0,v=0,_=null,V.reset(),ct.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Hh.prototype.isWebGLRenderer=!0;class Gh extends Hh{}Gh.prototype.isWebGL1Renderer=!0;class Vh{constructor(t,e=25e-5){this.name="",this.color=new Es(t),this.density=e}clone(){return new Vh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Vh.prototype.isFogExp2=!0;class jh{constructor(t,e=1,n=1e3){this.name="",this.color=new Es(t),this.near=e,this.far=n}clone(){return new jh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}jh.prototype.isFog=!0;class Wh extends Da{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}Wh.prototype.isScene=!0;class qh{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Fo,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=rs()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=rs()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=rs()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}qh.prototype.isInterleavedBuffer=!0;const Kh=new Ns;class Xh{constructor(t,e,n,r=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Kh.x=this.getX(e),Kh.y=this.getY(e),Kh.z=this.getZ(e),Kh.applyMatrix4(t),this.setXYZ(e,Kh.x,Kh.y,Kh.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Kh.x=this.getX(e),Kh.y=this.getY(e),Kh.z=this.getZ(e),Kh.applyNormalMatrix(t),this.setXYZ(e,Kh.x,Kh.y,Kh.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Kh.x=this.getX(e),Kh.y=this.getY(e),Kh.z=this.getZ(e),Kh.transformDirection(t),this.setXYZ(e,Kh.x,Kh.y,Kh.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new $a(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Xh(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Xh.prototype.isInterleavedBufferAttribute=!0;class Yh extends Ya{constructor(t){super(),this.type="SpriteMaterial",this.color=new Es(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let Jh;Yh.prototype.isSpriteMaterial=!0;const Zh=new Ns,Qh=new Ns,$h=new Ns,td=new hs,ed=new hs,nd=new ha,rd=new Ns,id=new Ns,od=new Ns,sd=new hs,ad=new hs,ld=new hs;class cd extends Da{constructor(t){if(super(),this.type="Sprite",void 0===Jh){Jh=new yl;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new qh(t,5);Jh.setIndex([0,1,2,0,2,3]),Jh.setAttribute("position",new Xh(e,3,0,!1)),Jh.setAttribute("uv",new Xh(e,2,3,!1))}this.geometry=Jh,this.material=void 0!==t?t:new Yh,this.center=new hs(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Qh.setFromMatrixScale(this.matrixWorld),nd.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),$h.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Qh.multiplyScalar(-$h.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const o=this.center;ud(rd.set(-.5,-.5,0),$h,o,Qh,r,i),ud(id.set(.5,-.5,0),$h,o,Qh,r,i),ud(od.set(.5,.5,0),$h,o,Qh,r,i),sd.set(0,0),ad.set(1,0),ld.set(1,1);let s=t.ray.intersectTriangle(rd,id,od,!1,Zh);if(null===s&&(ud(id.set(-.5,.5,0),$h,o,Qh,r,i),ad.set(0,1),s=t.ray.intersectTriangle(rd,od,id,!1,Zh),null===s))return;const a=t.ray.origin.distanceTo(Zh);a<t.near||a>t.far||e.push({distance:a,point:Zh.clone(),uv:Ka.getUV(Zh,rd,id,od,sd,ad,ld,new hs),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function ud(t,e,n,r,i,o){td.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(ed.x=o*td.x-i*td.y,ed.y=i*td.x+o*td.y):ed.copy(td),t.copy(e),t.x+=ed.x,t.y+=ed.y,t.applyMatrix4(nd)}cd.prototype.isSprite=!0;const hd=new Ns,dd=new Ns;class pd extends Da{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,e=0){e=Math.abs(e);const n=this.levels;let r;for(r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null}raycast(t,e){if(this.levels.length>0){hd.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(hd);this.getObjectForDistance(n).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){hd.setFromMatrixPosition(t.matrixWorld),dd.setFromMatrixPosition(this.matrixWorld);const n=hd.distanceTo(dd)/t.zoom;let r,i;for(e[0].object.visible=!0,r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}}toJSON(t){const e=super.toJSON(t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let t=0,r=n.length;t<r;t++){const r=n[t];e.object.levels.push({object:r.object.uuid,distance:r.distance})}return e}}const fd=new Ns,md=new Ls,gd=new Ls,yd=new Ns,vd=new ha;class _d extends kl{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ha,this.bindMatrixInverse=new ha}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Ls,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,r=this.geometry;md.fromBufferAttribute(r.attributes.skinIndex,t),gd.fromBufferAttribute(r.attributes.skinWeight,t),fd.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const r=gd.getComponent(t);if(0!==r){const i=md.getComponent(t);vd.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),e.addScaledVector(yd.copy(fd).applyMatrix4(vd),r)}}return e.applyMatrix4(this.bindMatrixInverse)}}_d.prototype.isSkinnedMesh=!0;class wd extends Da{constructor(){super(),this.type="Bone"}}wd.prototype.isBone=!0;class bd extends As{constructor(t=null,e=1,n=1,r,i,o,s,a,l=$r,c=$r,u,h){super(null,o,s,a,l,c,r,i,u,h),this.image={data:t,width:e,height:n},this.magFilter=l,this.minFilter=c,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}bd.prototype.isDataTexture=!0;const xd=new ha,Ed=new ha;class Sd{constructor(t=[],e=[]){this.uuid=rs(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new ha)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new ha;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,i=t.length;r<i;r++){const i=t[r]?t[r].matrixWorld:Ed;xd.multiplyMatrices(i,e[r]),xd.toArray(n,16*r)}null!==r&&(r.needsUpdate=!0)}clone(){return new Sd(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=ls(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new bd(e,t,t,bi,mi);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){const r=t.bones[n];let i=e[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new wd),this.bones.push(i),this.boneInverses.push((new ha).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,i=e.length;r<i;r++){const i=e[r];t.bones.push(i.uuid);const o=n[r];t.boneInverses.push(o.toArray())}return t}}class Md extends $a{constructor(t,e,n,r=1){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}Md.prototype.isInstancedBufferAttribute=!0;const Td=new ha,Ad=new ha,Rd=[],Ld=new kl;class Cd extends kl{constructor(t,e,n){super(t,e),this.instanceMatrix=new Md(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(Ld.geometry=this.geometry,Ld.material=this.material,void 0!==Ld.material)for(let i=0;i<r;i++){this.getMatrixAt(i,Td),Ad.multiplyMatrices(n,Td),Ld.matrixWorld=Ad,Ld.raycast(t,Rd);for(let t=0,n=Rd.length;t<n;t++){const n=Rd[t];n.instanceId=i,n.object=this,e.push(n)}Rd.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new Md(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Cd.prototype.isInstancedMesh=!0;class Pd extends Ya{constructor(t){super(),this.type="LineBasicMaterial",this.color=new Es(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}}Pd.prototype.isLineBasicMaterial=!0;const Id=new Ns,Od=new Ns,Nd=new ha,kd=new ua,Dd=new na;class Bd extends Da{constructor(t=new yl,e=new Pd){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)Id.fromBufferAttribute(e,t-1),Od.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=Id.distanceTo(Od);t.setAttribute("lineDistance",new ll(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Dd.copy(n.boundingSphere),Dd.applyMatrix4(r),Dd.radius+=i,!1===t.ray.intersectsSphere(Dd))return;Nd.copy(r).invert(),kd.copy(t.ray).applyMatrix4(Nd);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s,l=new Ns,c=new Ns,u=new Ns,h=new Ns,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const r=n.index,i=n.attributes.position;if(null!==r)for(let n=Math.max(0,o.start),s=Math.min(r.count,o.start+o.count)-1;n<s;n+=d){const o=r.getX(n),s=r.getX(n+1);if(l.fromBufferAttribute(i,o),c.fromBufferAttribute(i,s),kd.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(h);d<t.near||d>t.far||e.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}else for(let n=Math.max(0,o.start),r=Math.min(i.count,o.start+o.count)-1;n<r;n+=d){if(l.fromBufferAttribute(i,n),c.fromBufferAttribute(i,n+1),kd.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const r=t.ray.origin.distanceTo(h);r<t.near||r>t.far||e.push({distance:r,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Bd.prototype.isLine=!0;const Ud=new Ns,zd=new Ns;class Fd extends Bd{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)Ud.fromBufferAttribute(e,t),zd.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+Ud.distanceTo(zd);t.setAttribute("lineDistance",new ll(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Fd.prototype.isLineSegments=!0;class Hd extends Bd{constructor(t,e){super(t,e),this.type="LineLoop"}}Hd.prototype.isLineLoop=!0;class Gd extends Ya{constructor(t){super(),this.type="PointsMaterial",this.color=new Es(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}}Gd.prototype.isPointsMaterial=!0;const Vd=new ha,jd=new ua,Wd=new na,qd=new Ns;class Kd extends Da{constructor(t=new yl,e=new Gd){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Wd.copy(n.boundingSphere),Wd.applyMatrix4(r),Wd.radius+=i,!1===t.ray.intersectsSphere(Wd))return;Vd.copy(r).invert(),jd.copy(t.ray).applyMatrix4(Vd);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s;if(n.isBufferGeometry){const i=n.index,s=n.attributes.position;if(null!==i)for(let n=Math.max(0,o.start),l=Math.min(i.count,o.start+o.count);n<l;n++){const o=i.getX(n);qd.fromBufferAttribute(s,o),Xd(qd,o,a,r,t,e,this)}else for(let n=Math.max(0,o.start),i=Math.min(s.count,o.start+o.count);n<i;n++)qd.fromBufferAttribute(s,n),Xd(qd,n,a,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Xd(t,e,n,r,i,o,s){const a=jd.distanceSqToPoint(t);if(a<n){const n=new Ns;jd.closestPointToPoint(t,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;o.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:s})}}Kd.prototype.isPoints=!0;class Yd extends As{constructor(t,e,n,r,i,o,s,a,l){super(t,e,n,r,i,o,s,a,l),this.minFilter=void 0!==o?o:ii,this.magFilter=void 0!==i?i:ii,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Yd.prototype.isVideoTexture=!0;class Jd extends As{constructor(t,e,n){super({width:t,height:e}),this.format=n,this.magFilter=$r,this.minFilter=$r,this.generateMipmaps=!1,this.needsUpdate=!0}}Jd.prototype.isFramebufferTexture=!0;class Zd extends As{constructor(t,e,n,r,i,o,s,a,l,c,u,h){super(null,o,s,a,l,c,r,i,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}Zd.prototype.isCompressedTexture=!0;class Qd extends As{constructor(t,e,n,r,i,o,s,a,l){super(t,e,n,r,i,o,s,a,l),this.needsUpdate=!0}}Qd.prototype.isCanvasTexture=!0;class $d extends yl{constructor(t=1,e=8,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},e=Math.max(3,e);const i=[],o=[],s=[],a=[],l=new Ns,c=new hs;o.push(0,0,0),s.push(0,0,1),a.push(.5,.5);for(let i=0,u=3;i<=e;i++,u+=3){const h=n+i/e*r;l.x=t*Math.cos(h),l.y=t*Math.sin(h),o.push(l.x,l.y,l.z),s.push(0,0,1),c.x=(o[u]/t+1)/2,c.y=(o[u+1]/t+1)/2,a.push(c.x,c.y)}for(let t=1;t<=e;t++)i.push(t,t+1,0);this.setIndex(i),this.setAttribute("position",new ll(o,3)),this.setAttribute("normal",new ll(s,3)),this.setAttribute("uv",new ll(a,2))}static fromJSON(t){return new $d(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class tp extends yl{constructor(t=1,e=1,n=1,r=8,i=1,o=!1,s=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=n/2;let g=0;function y(n){const i=p,o=new hs,f=new Ns;let y=0;const v=!0===n?t:e,_=!0===n?1:-1;for(let t=1;t<=r;t++)u.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),p++;const w=p;for(let t=0;t<=r;t++){const e=t/r*a+s,n=Math.cos(e),i=Math.sin(e);f.x=v*i,f.y=m*_,f.z=v*n,u.push(f.x,f.y,f.z),h.push(0,_,0),o.x=.5*n+.5,o.y=.5*i*_+.5,d.push(o.x,o.y),p++}for(let t=0;t<r;t++){const e=i+t,r=w+t;!0===n?c.push(r,r+1,e):c.push(r+1,r,e),y+=3}l.addGroup(g,y,!0===n?1:2),g+=y}!function(){const o=new Ns,y=new Ns;let v=0;const _=(e-t)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,v=g*(e-t)+t;for(let t=0;t<=r;t++){const e=t/r,i=e*a+s,l=Math.sin(i),f=Math.cos(i);y.x=v*l,y.y=-g*n+m,y.z=v*f,u.push(y.x,y.y,y.z),o.set(l,_,f).normalize(),h.push(o.x,o.y,o.z),d.push(e,1-g),c.push(p++)}f.push(c)}for(let t=0;t<r;t++)for(let e=0;e<i;e++){const n=f[e][t],r=f[e+1][t],i=f[e+1][t+1],o=f[e][t+1];c.push(n,r,o),c.push(r,i,o),v+=6}l.addGroup(g,v,0),g+=v}(),!1===o&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new ll(u,3)),this.setAttribute("normal",new ll(h,3)),this.setAttribute("uv",new ll(d,2))}static fromJSON(t){return new tp(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class ep extends tp{constructor(t=1,e=1,n=8,r=1,i=!1,o=0,s=2*Math.PI){super(0,t,e,n,r,i,o,s),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:s}}static fromJSON(t){return new ep(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class np extends yl{constructor(t=[],e=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r};const i=[],o=[];function s(t,e,n,r){const i=r+1,o=[];for(let r=0;r<=i;r++){o[r]=[];const s=t.clone().lerp(n,r/i),a=e.clone().lerp(n,r/i),l=i-r;for(let t=0;t<=l;t++)o[r][t]=0===t&&r===i?s:s.clone().lerp(a,t/l)}for(let t=0;t<i;t++)for(let e=0;e<2*(i-t)-1;e++){const n=Math.floor(e/2);e%2==0?(a(o[t][n+1]),a(o[t+1][n]),a(o[t][n])):(a(o[t][n+1]),a(o[t+1][n+1]),a(o[t+1][n]))}}function a(t){i.push(t.x,t.y,t.z)}function l(e,n){const r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function c(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function u(t){return Math.atan2(t.z,-t.x)}!function(t){const n=new Ns,r=new Ns,i=new Ns;for(let o=0;o<e.length;o+=3)l(e[o+0],n),l(e[o+1],r),l(e[o+2],i),s(n,r,i,t)}(r),function(t){const e=new Ns;for(let n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){const t=new Ns;for(let n=0;n<i.length;n+=3){t.x=i[n+0],t.y=i[n+1],t.z=i[n+2];const r=u(t)/2/Math.PI+.5,s=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);o.push(r,1-s)}var e;(function(){const t=new Ns,e=new Ns,n=new Ns,r=new Ns,s=new hs,a=new hs,l=new hs;for(let h=0,d=0;h<i.length;h+=9,d+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),s.set(o[d+0],o[d+1]),a.set(o[d+2],o[d+3]),l.set(o[d+4],o[d+5]),r.copy(t).add(e).add(n).divideScalar(3);const p=u(r);c(s,d+0,t,p),c(a,d+2,e,p),c(l,d+4,n,p)}})(),function(){for(let t=0;t<o.length;t+=6){const e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),s=Math.min(e,n,r);i>.9&&s<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new ll(i,3)),this.setAttribute("normal",new ll(i.slice(),3)),this.setAttribute("uv",new ll(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(t){return new np(t.vertices,t.indices,t.radius,t.details)}}class rp extends np{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new rp(t.radius,t.detail)}}const ip=new Ns,op=new Ns,sp=new Ns,ap=new Ka;class lp extends yl{constructor(t=null,e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},null!==t){const n=4,r=Math.pow(10,n),i=Math.cos(es*e),o=t.getIndex(),s=t.getAttribute("position"),a=o?o.count:s.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let t=0;t<a;t+=3){o?(l[0]=o.getX(t),l[1]=o.getX(t+1),l[2]=o.getX(t+2)):(l[0]=t,l[1]=t+1,l[2]=t+2);const{a:e,b:n,c:a}=ap;if(e.fromBufferAttribute(s,l[0]),n.fromBufferAttribute(s,l[1]),a.fromBufferAttribute(s,l[2]),ap.getNormal(sp),u[0]=`${Math.round(e.x*r)},${Math.round(e.y*r)},${Math.round(e.z*r)}`,u[1]=`${Math.round(n.x*r)},${Math.round(n.y*r)},${Math.round(n.z*r)}`,u[2]=`${Math.round(a.x*r)},${Math.round(a.y*r)},${Math.round(a.z*r)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let t=0;t<3;t++){const e=(t+1)%3,n=u[t],r=u[e],o=ap[c[t]],s=ap[c[e]],a=`${n}_${r}`,p=`${r}_${n}`;p in h&&h[p]?(sp.dot(h[p].normal)<=i&&(d.push(o.x,o.y,o.z),d.push(s.x,s.y,s.z)),h[p]=null):a in h||(h[a]={index0:l[t],index1:l[e],normal:sp.clone()})}}for(const t in h)if(h[t]){const{index0:e,index1:n}=h[t];ip.fromBufferAttribute(s,e),op.fromBufferAttribute(s,n),d.push(ip.x,ip.y,ip.z),d.push(op.x,op.y,op.z)}this.setAttribute("position",new ll(d,3))}}}class cp{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),i=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),i+=n.distanceTo(r),e.push(i),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const i=n.length;let o;o=e||t*n[i-1];let s,a=0,l=i-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),s=n[r]-o,s<0)a=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(i-1);const c=n[r];return(r+(o-c)/(n[r+1]-c))/(i-1)}getTangent(t,e){const n=1e-4;let r=t-n,i=t+n;r<0&&(r=0),i>1&&(i=1);const o=this.getPoint(r),s=this.getPoint(i),a=e||(o.isVector2?new hs:new Ns);return a.copy(s).sub(o).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new Ns,r=[],i=[],o=[],s=new Ns,a=new ha;for(let e=0;e<=t;e++){const n=e/t;r[e]=this.getTangentAt(n,new Ns)}i[0]=new Ns,o[0]=new Ns;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),o[0].crossVectors(r[0],i[0]);for(let e=1;e<=t;e++){if(i[e]=i[e-1].clone(),o[e]=o[e-1].clone(),s.crossVectors(r[e-1],r[e]),s.length()>Number.EPSILON){s.normalize();const t=Math.acos(is(r[e-1].dot(r[e]),-1,1));i[e].applyMatrix4(a.makeRotationAxis(s,t))}o[e].crossVectors(r[e],i[e])}if(!0===e){let e=Math.acos(is(i[0].dot(i[t]),-1,1));e/=t,r[0].dot(s.crossVectors(i[0],i[t]))>0&&(e=-e);for(let n=1;n<=t;n++)i[n].applyMatrix4(a.makeRotationAxis(r[n],e*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class up extends cp{constructor(t=0,e=0,n=1,r=1,i=0,o=2*Math.PI,s=!1,a=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=s,this.aRotation=a}getPoint(t,e){const n=e||new hs,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);const s=this.aStartAngle+t*i;let a=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,r=l-this.aY;a=n*t-r*e+this.aX,l=n*e+r*t+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}up.prototype.isEllipseCurve=!0;class hp extends up{constructor(t,e,n,r,i,o){super(t,e,n,n,r,i,o),this.type="ArcCurve"}}function dp(){let t=0,e=0,n=0,r=0;function i(i,o,s,a){t=i,e=s,n=-3*i+3*o-2*s-a,r=2*i-2*o+s+a}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,s,a){let l=(e-t)/o-(n-t)/(o+s)+(n-e)/s,c=(n-e)/s-(r-e)/(s+a)+(r-n)/a;l*=s,c*=s,i(e,n,l,c)},calc:function(i){const o=i*i;return t+e*i+n*o+r*(o*i)}}}hp.prototype.isArcCurve=!0;const pp=new Ns,fp=new dp,mp=new dp,gp=new dp;class yp extends cp{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new Ns){const n=e,r=this.points,i=r.length,o=(i-(this.closed?0:1))*t;let s,a,l=Math.floor(o),c=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?s=r[(l-1)%i]:(pp.subVectors(r[0],r[1]).add(r[0]),s=pp);const u=r[l%i],h=r[(l+1)%i];if(this.closed||l+2<i?a=r[(l+2)%i]:(pp.subVectors(r[i-1],r[i-2]).add(r[i-1]),a=pp),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(s.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),r=Math.pow(h.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),r<1e-4&&(r=n),fp.initNonuniformCatmullRom(s.x,u.x,h.x,a.x,e,n,r),mp.initNonuniformCatmullRom(s.y,u.y,h.y,a.y,e,n,r),gp.initNonuniformCatmullRom(s.z,u.z,h.z,a.z,e,n,r)}else"catmullrom"===this.curveType&&(fp.initCatmullRom(s.x,u.x,h.x,a.x,this.tension),mp.initCatmullRom(s.y,u.y,h.y,a.y,this.tension),gp.initCatmullRom(s.z,u.z,h.z,a.z,this.tension));return n.set(fp.calc(c),mp.calc(c),gp.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Ns).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function vp(t,e,n,r,i){const o=.5*(r-e),s=.5*(i-n),a=t*t;return(2*n-2*r+o+s)*(t*a)+(-3*n+3*r-2*o-s)*a+o*t+n}function _p(t,e,n,r){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function wp(t,e,n,r,i){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}yp.prototype.isCatmullRomCurve3=!0;class bp extends cp{constructor(t=new hs,e=new hs,n=new hs,r=new hs){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new hs){const n=e,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(wp(t,r.x,i.x,o.x,s.x),wp(t,r.y,i.y,o.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}bp.prototype.isCubicBezierCurve=!0;class xp extends cp{constructor(t=new Ns,e=new Ns,n=new Ns,r=new Ns){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new Ns){const n=e,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(wp(t,r.x,i.x,o.x,s.x),wp(t,r.y,i.y,o.y,s.y),wp(t,r.z,i.z,o.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}xp.prototype.isCubicBezierCurve3=!0;class Ep extends cp{constructor(t=new hs,e=new hs){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new hs){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new hs;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Ep.prototype.isLineCurve=!0;class Sp extends cp{constructor(t=new Ns,e=new Ns){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new Ns){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Mp extends cp{constructor(t=new hs,e=new hs,n=new hs){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new hs){const n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(_p(t,r.x,i.x,o.x),_p(t,r.y,i.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Mp.prototype.isQuadraticBezierCurve=!0;class Tp extends cp{constructor(t=new Ns,e=new Ns,n=new Ns){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Ns){const n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(_p(t,r.x,i.x,o.x),_p(t,r.y,i.y,o.y),_p(t,r.z,i.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Tp.prototype.isQuadraticBezierCurve3=!0;class Ap extends cp{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new hs){const n=e,r=this.points,i=(r.length-1)*t,o=Math.floor(i),s=i-o,a=r[0===o?o:o-1],l=r[o],c=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(vp(s,a.x,l.x,c.x,u.x),vp(s,a.y,l.y,c.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new hs).fromArray(n))}return this}}Ap.prototype.isSplineCurve=!0;var Rp=Object.freeze({__proto__:null,ArcCurve:hp,CatmullRomCurve3:yp,CubicBezierCurve:bp,CubicBezierCurve3:xp,EllipseCurve:up,LineCurve:Ep,LineCurve3:Sp,QuadraticBezierCurve:Mp,QuadraticBezierCurve3:Tp,SplineCurve:Ap});class Lp extends cp{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Ep(e,t))}getPoint(t,e){const n=t*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const t=r[i]-n,o=this.curves[i],s=o.getLength(),a=0===s?0:1-t/s;return o.getPointAt(a,e)}i++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],s=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,a=o.getPoints(s);for(let t=0;t<a.length;t++){const r=a[t];n&&n.equals(r)||(e.push(r),n=r)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new Rp[n.type]).fromJSON(n))}return this}}class Cp extends Lp{constructor(t){super(),this.type="Path",this.currentPoint=new hs,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Ep(this.currentPoint.clone(),new hs(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const i=new Mp(this.currentPoint.clone(),new hs(t,e),new hs(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,i,o){const s=new bp(this.currentPoint.clone(),new hs(t,e),new hs(n,r),new hs(i,o));return this.curves.push(s),this.currentPoint.set(i,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Ap(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,i,o){const s=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+s,e+a,n,r,i,o),this}absarc(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this}ellipse(t,e,n,r,i,o,s,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,r,i,o,s,a),this}absellipse(t,e,n,r,i,o,s,a){const l=new up(t,e,n,r,i,o,s,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Pp extends Cp{constructor(t){super(t),this.uuid=rs(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new Cp).fromJSON(n))}return this}}function Ip(t,e,n,r,i){let o,s;if(i===function(t,e,n,r){let i=0;for(let o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)s=$p(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=$p(o,t[o],t[o+1],s);return s&&Kp(s,s.next)&&(tf(s),s=s.next),s}function Op(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!Kp(r,r.next)&&0!==qp(r.prev,r,r.next))r=r.next;else{if(tf(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function Np(t,e,n,r,i,o,s){if(!t)return;!s&&o&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=Gp(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,s,a,l,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,r);e++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1)}(i)}(t,r,i,o);let a,l,c=t;for(;t.prev!==t.next;)if(a=t.prev,l=t.next,o?Dp(t,r,i,o):kp(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),tf(t),t=l.next,c=l.next;else if((t=l)===c){s?1===s?Np(t=Bp(Op(t),e,n),e,n,r,i,o,2):2===s&&Up(t,e,n,r,i,o):Np(Op(t),e,n,r,i,o,1);break}}function kp(t){const e=t.prev,n=t,r=t.next;if(qp(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(jp(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&qp(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Dp(t,e,n,r){const i=t.prev,o=t,s=t.next;if(qp(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,u=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=Gp(a,l,e,n,r),d=Gp(c,u,e,n,r);let p=t.prevZ,f=t.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&jp(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&qp(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&jp(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&qp(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&jp(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&qp(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&jp(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&qp(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Bp(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!Kp(i,o)&&Xp(i,r,r.next,o)&&Zp(i,o)&&Zp(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),tf(r),tf(r.next),r=t=o),r=r.next}while(r!==t);return Op(r)}function Up(t,e,n,r,i,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&Wp(s,t)){let a=Qp(s,t);return s=Op(s,s.next),a=Op(a,a.next),Np(s,e,n,r,i,o),void Np(a,e,n,r,i,o)}t=t.next}s=s.next}while(s!==t)}function zp(t,e){return t.x-e.x}function Fp(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s){if(s=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,l=o.x,c=o.y;let u,h=1/0;n=o;do{r>=n.x&&n.x>=l&&r!==n.x&&jp(i<c?r:s,i,l,c,i<c?s:r,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(r-n.x),Zp(n,t)&&(u<h||u===h&&(n.x>o.x||n.x===o.x&&Hp(o,n)))&&(o=n,h=u)),n=n.next}while(n!==a);return o}(t,e),e){const n=Qp(e,t);Op(e,e.next),Op(n,n.next)}}function Hp(t,e){return qp(t.prev,t,e.prev)<0&&qp(e.next,t,t.next)<0}function Gp(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Vp(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function jp(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function Wp(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Xp(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Zp(t,e)&&Zp(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(qp(t.prev,t,e.prev)||qp(t,e.prev,e))||Kp(t,e)&&qp(t.prev,t,t.next)>0&&qp(e.prev,e,e.next)>0)}function qp(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Kp(t,e){return t.x===e.x&&t.y===e.y}function Xp(t,e,n,r){const i=Jp(qp(t,e,n)),o=Jp(qp(t,e,r)),s=Jp(qp(n,r,t)),a=Jp(qp(n,r,e));return i!==o&&s!==a||!(0!==i||!Yp(t,n,e))||!(0!==o||!Yp(t,r,e))||!(0!==s||!Yp(n,t,r))||!(0!==a||!Yp(n,e,r))}function Yp(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Jp(t){return t>0?1:t<0?-1:0}function Zp(t,e){return qp(t.prev,t,t.next)<0?qp(t,e,t.next)>=0&&qp(t,t.prev,e)>=0:qp(t,e,t.prev)<0||qp(t,t.next,e)<0}function Qp(t,e){const n=new ef(t.i,t.x,t.y),r=new ef(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function $p(t,e,n,r){const i=new ef(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function tf(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ef(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class nf{static area(t){const e=t.length;let n=0;for(let r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n}static isClockWise(t){return nf.area(t)<0}static triangulateShape(t,e){const n=[],r=[],i=[];rf(t),of(n,t);let o=t.length;e.forEach(rf);for(let t=0;t<e.length;t++)r.push(o),o+=e[t].length,of(n,e[t]);const s=function(t,e,n=2){const r=e&&e.length,i=r?e[0]*n:t.length;let o=Ip(t,0,i,n,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,c,u,h,d,p;if(r&&(o=function(t,e,n,r){const i=[];let o,s,a,l,c;for(o=0,s=e.length;o<s;o++)a=e[o]*r,l=o<s-1?e[o+1]*r:t.length,c=Ip(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(Vp(c));for(i.sort(zp),o=0;o<i.length;o++)Fp(i[o],n),n=Op(n,n.next);return n}(t,e,o,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(let e=n;e<i;e+=n)h=t[e],d=t[e+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?1/p:0}return Np(o,s,n,a,l,p),s}(n,r);for(let t=0;t<s.length;t+=3)i.push(s.slice(t,t+3));return i}}function rf(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function of(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class sf extends yl{constructor(t=new Pp([new hs(.5,.5),new hs(-.5,.5),new hs(-.5,-.5),new hs(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],i=[];for(let e=0,n=t.length;e<n;e++)o(t[e]);function o(t){const o=[],s=void 0!==e.curveSegments?e.curveSegments:12,a=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:1,c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:.2,h=void 0!==e.bevelSize?e.bevelSize:u-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:af;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let g,y,v,_,w,b=!1;f&&(g=f.getSpacedPoints(a),b=!0,c=!1,y=f.computeFrenetFrames(a,!1),v=new Ns,_=new Ns,w=new Ns),c||(p=0,u=0,h=0,d=0);const x=t.extractPoints(s);let E=x.shape;const S=x.holes;if(!nf.isClockWise(E)){E=E.reverse();for(let t=0,e=S.length;t<e;t++){const e=S[t];nf.isClockWise(e)&&(S[t]=e.reverse())}}const M=nf.triangulateShape(E,S),T=E;for(let t=0,e=S.length;t<e;t++){const e=S[t];E=E.concat(e)}function A(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const R=E.length,L=M.length;function C(t,e,n){let r,i,o;const s=t.x-e.x,a=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=s*s+a*a,h=s*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=e.x-a/h,f=e.y+s/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(s*c-a*l);r=p+s*m-t.x,i=f+a*m-t.y;const g=r*r+i*i;if(g<=2)return new hs(r,i);o=Math.sqrt(g/2)}else{let t=!1;s>Number.EPSILON?l>Number.EPSILON&&(t=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(c)&&(t=!0),t?(r=-a,i=s,o=Math.sqrt(u)):(r=s,i=a,o=Math.sqrt(u/2))}return new hs(r/o,i/o)}const P=[];for(let t=0,e=T.length,n=e-1,r=t+1;t<e;t++,n++,r++)n===e&&(n=0),r===e&&(r=0),P[t]=C(T[t],T[n],T[r]);const I=[];let O,N=P.concat();for(let t=0,e=S.length;t<e;t++){const e=S[t];O=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),O[t]=C(e[t],e[r],e[i]);I.push(O),N=N.concat(O)}for(let t=0;t<p;t++){const e=t/p,n=u*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+d;for(let t=0,e=T.length;t<e;t++){const e=A(T[t],P[t],r);B(e.x,e.y,-n)}for(let t=0,e=S.length;t<e;t++){const e=S[t];O=I[t];for(let t=0,i=e.length;t<i;t++){const i=A(e[t],O[t],r);B(i.x,i.y,-n)}}}const k=h+d;for(let t=0;t<R;t++){const e=c?A(E[t],N[t],k):E[t];b?(_.copy(y.normals[0]).multiplyScalar(e.x),v.copy(y.binormals[0]).multiplyScalar(e.y),w.copy(g[0]).add(_).add(v),B(w.x,w.y,w.z)):B(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<R;e++){const n=c?A(E[e],N[e],k):E[e];b?(_.copy(y.normals[t]).multiplyScalar(n.x),v.copy(y.binormals[t]).multiplyScalar(n.y),w.copy(g[t]).add(_).add(v),B(w.x,w.y,w.z)):B(n.x,n.y,l/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+d;for(let t=0,e=T.length;t<e;t++){const e=A(T[t],P[t],r);B(e.x,e.y,l+n)}for(let t=0,e=S.length;t<e;t++){const e=S[t];O=I[t];for(let t=0,i=e.length;t<i;t++){const i=A(e[t],O[t],r);b?B(i.x,i.y+g[a-1].y,g[a-1].x+n):B(i.x,i.y,l+n)}}}function D(t,e){let n=t.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=t.length-1);for(let t=0,n=a+2*p;t<n;t++){const n=R*t,o=R*(t+1);z(e+r+n,e+i+n,e+i+o,e+r+o)}}}function B(t,e,n){o.push(t),o.push(e),o.push(n)}function U(t,e,i){F(t),F(e),F(i);const o=r.length/3,s=m.generateTopUV(n,r,o-3,o-2,o-1);H(s[0]),H(s[1]),H(s[2])}function z(t,e,i,o){F(t),F(e),F(o),F(e),F(i),F(o);const s=r.length/3,a=m.generateSideWallUV(n,r,s-6,s-3,s-2,s-1);H(a[0]),H(a[1]),H(a[3]),H(a[1]),H(a[2]),H(a[3])}function F(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function H(t){i.push(t.x),i.push(t.y)}!function(){const t=r.length/3;if(c){let t=0,e=R*t;for(let t=0;t<L;t++){const n=M[t];U(n[2]+e,n[1]+e,n[0]+e)}t=a+2*p,e=R*t;for(let t=0;t<L;t++){const n=M[t];U(n[0]+e,n[1]+e,n[2]+e)}}else{for(let t=0;t<L;t++){const e=M[t];U(e[2],e[1],e[0])}for(let t=0;t<L;t++){const e=M[t];U(e[0]+R*a,e[1]+R*a,e[2]+R*a)}}n.addGroup(t,r.length/3-t,0)}(),function(){const t=r.length/3;let e=0;D(T,e),e+=T.length;for(let t=0,n=S.length;t<n;t++){const n=S[t];D(n,e),e+=n.length}n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new ll(r,3)),this.setAttribute("uv",new ll(i,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let e=0,r=t.length;e<r;e++){const r=t[e];n.shapes.push(r.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let r=0,i=t.shapes.length;r<i;r++){const i=e[t.shapes[r]];n.push(i)}const r=t.options.extrudePath;return void 0!==r&&(t.options.extrudePath=(new Rp[r.type]).fromJSON(r)),new sf(n,t.options)}}const af={generateTopUV:function(t,e,n,r,i){const o=e[3*n],s=e[3*n+1],a=e[3*r],l=e[3*r+1],c=e[3*i],u=e[3*i+1];return[new hs(o,s),new hs(a,l),new hs(c,u)]},generateSideWallUV:function(t,e,n,r,i,o){const s=e[3*n],a=e[3*n+1],l=e[3*n+2],c=e[3*r],u=e[3*r+1],h=e[3*r+2],d=e[3*i],p=e[3*i+1],f=e[3*i+2],m=e[3*o],g=e[3*o+1],y=e[3*o+2];return Math.abs(a-u)<Math.abs(s-c)?[new hs(s,1-l),new hs(c,1-h),new hs(d,1-f),new hs(m,1-y)]:[new hs(a,1-l),new hs(u,1-h),new hs(p,1-f),new hs(g,1-y)]}};class lf extends np{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new lf(t.radius,t.detail)}}class cf extends yl{constructor(t=[new hs(0,.5),new hs(.5,0),new hs(0,-.5)],e=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e),r=is(r,0,2*Math.PI);const i=[],o=[],s=[],a=[],l=[],c=1/e,u=new Ns,h=new hs,d=new Ns,p=new Ns,f=new Ns;let m=0,g=0;for(let e=0;e<=t.length-1;e++)switch(e){case 0:m=t[e+1].x-t[e].x,g=t[e+1].y-t[e].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(f.x,f.y,f.z);break;default:m=t[e+1].x-t[e].x,g=t[e+1].y-t[e].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),a.push(d.x,d.y,d.z),f.copy(p)}for(let i=0;i<=e;i++){const d=n+i*c*r,p=Math.sin(d),f=Math.cos(d);for(let n=0;n<=t.length-1;n++){u.x=t[n].x*p,u.y=t[n].y,u.z=t[n].x*f,o.push(u.x,u.y,u.z),h.x=i/e,h.y=n/(t.length-1),s.push(h.x,h.y);const r=a[3*n+0]*p,c=a[3*n+1],d=a[3*n+0]*f;l.push(r,c,d)}}for(let n=0;n<e;n++)for(let e=0;e<t.length-1;e++){const r=e+n*t.length,o=r,s=r+t.length,a=r+t.length+1,l=r+1;i.push(o,s,l),i.push(a,l,s)}this.setIndex(i),this.setAttribute("position",new ll(o,3)),this.setAttribute("uv",new ll(s,2)),this.setAttribute("normal",new ll(l,3))}static fromJSON(t){return new cf(t.points,t.segments,t.phiStart,t.phiLength)}}class uf extends np{constructor(t=1,e=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new uf(t.radius,t.detail)}}class hf extends yl{constructor(t=.5,e=1,n=8,r=1,i=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},n=Math.max(3,n);const s=[],a=[],l=[],c=[];let u=t;const h=(e-t)/(r=Math.max(1,r)),d=new Ns,p=new hs;for(let t=0;t<=r;t++){for(let t=0;t<=n;t++){const r=i+t/n*o;d.x=u*Math.cos(r),d.y=u*Math.sin(r),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/e+1)/2,p.y=(d.y/e+1)/2,c.push(p.x,p.y)}u+=h}for(let t=0;t<r;t++){const e=t*(n+1);for(let t=0;t<n;t++){const r=t+e,i=r,o=r+n+1,a=r+n+2,l=r+1;s.push(i,o,l),s.push(o,a,l)}}this.setIndex(s),this.setAttribute("position",new ll(a,3)),this.setAttribute("normal",new ll(l,3)),this.setAttribute("uv",new ll(c,2))}static fromJSON(t){return new hf(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class df extends yl{constructor(t=new Pp([new hs(0,.5),new hs(-.5,-.5),new hs(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],i=[],o=[];let s=0,a=0;if(!1===Array.isArray(t))l(t);else for(let e=0;e<t.length;e++)l(t[e]),this.addGroup(s,a,e),s+=a,a=0;function l(t){const s=r.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===nf.isClockWise(c)&&(c=c.reverse());for(let t=0,e=u.length;t<e;t++){const e=u[t];!0===nf.isClockWise(e)&&(u[t]=e.reverse())}const h=nf.triangulateShape(c,u);for(let t=0,e=u.length;t<e;t++){const e=u[t];c=c.concat(e)}for(let t=0,e=c.length;t<e;t++){const e=c[t];r.push(e.x,e.y,0),i.push(0,0,1),o.push(e.x,e.y)}for(let t=0,e=h.length;t<e;t++){const e=h[t],r=e[0]+s,i=e[1]+s,o=e[2]+s;n.push(r,i,o),a+=3}}this.setIndex(n),this.setAttribute("position",new ll(r,3)),this.setAttribute("normal",new ll(i,3)),this.setAttribute("uv",new ll(o,2))}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let r=0,i=t.shapes.length;r<i;r++){const i=e[t.shapes[r]];n.push(i)}return new df(n,t.curveSegments)}}class pf extends yl{constructor(t=1,e=32,n=16,r=0,i=2*Math.PI,o=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const a=Math.min(o+s,Math.PI);let l=0;const c=[],u=new Ns,h=new Ns,d=[],p=[],f=[],m=[];for(let d=0;d<=n;d++){const g=[],y=d/n;let v=0;0==d&&0==o?v=.5/e:d==n&&a==Math.PI&&(v=-.5/e);for(let n=0;n<=e;n++){const a=n/e;u.x=-t*Math.cos(r+a*i)*Math.sin(o+y*s),u.y=t*Math.cos(o+y*s),u.z=t*Math.sin(r+a*i)*Math.sin(o+y*s),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(a+v,1-y),g.push(l++)}c.push(g)}for(let t=0;t<n;t++)for(let r=0;r<e;r++){const e=c[t][r+1],i=c[t][r],s=c[t+1][r],l=c[t+1][r+1];(0!==t||o>0)&&d.push(e,i,l),(t!==n-1||a<Math.PI)&&d.push(i,s,l)}this.setIndex(d),this.setAttribute("position",new ll(p,3)),this.setAttribute("normal",new ll(f,3)),this.setAttribute("uv",new ll(m,2))}static fromJSON(t){return new pf(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class ff extends np{constructor(t=1,e=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new ff(t.radius,t.detail)}}class mf extends yl{constructor(t=1,e=.4,n=8,r=6,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const o=[],s=[],a=[],l=[],c=new Ns,u=new Ns,h=new Ns;for(let o=0;o<=n;o++)for(let d=0;d<=r;d++){const p=d/r*i,f=o/n*Math.PI*2;u.x=(t+e*Math.cos(f))*Math.cos(p),u.y=(t+e*Math.cos(f))*Math.sin(p),u.z=e*Math.sin(f),s.push(u.x,u.y,u.z),c.x=t*Math.cos(p),c.y=t*Math.sin(p),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(d/r),l.push(o/n)}for(let t=1;t<=n;t++)for(let e=1;e<=r;e++){const n=(r+1)*t+e-1,i=(r+1)*(t-1)+e-1,s=(r+1)*(t-1)+e,a=(r+1)*t+e;o.push(n,i,a),o.push(i,s,a)}this.setIndex(o),this.setAttribute("position",new ll(s,3)),this.setAttribute("normal",new ll(a,3)),this.setAttribute("uv",new ll(l,2))}static fromJSON(t){return new mf(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class gf extends yl{constructor(t=1,e=.4,n=64,r=8,i=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},n=Math.floor(n),r=Math.floor(r);const s=[],a=[],l=[],c=[],u=new Ns,h=new Ns,d=new Ns,p=new Ns,f=new Ns,m=new Ns,g=new Ns;for(let s=0;s<=n;++s){const v=s/n*i*Math.PI*2;y(v,i,o,t,d),y(v+.01,i,o,t,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let t=0;t<=r;++t){const i=t/r*Math.PI*2,o=-e*Math.cos(i),p=e*Math.sin(i);u.x=d.x+(o*g.x+p*f.x),u.y=d.y+(o*g.y+p*f.y),u.z=d.z+(o*g.z+p*f.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(s/n),c.push(t/r)}}for(let t=1;t<=n;t++)for(let e=1;e<=r;e++){const n=(r+1)*(t-1)+(e-1),i=(r+1)*t+(e-1),o=(r+1)*t+e,a=(r+1)*(t-1)+e;s.push(n,i,a),s.push(i,o,a)}function y(t,e,n,r,i){const o=Math.cos(t),s=Math.sin(t),a=n/e*t,l=Math.cos(a);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*s*.5,i.z=r*Math.sin(a)*.5}this.setIndex(s),this.setAttribute("position",new ll(a,3)),this.setAttribute("normal",new ll(l,3)),this.setAttribute("uv",new ll(c,2))}static fromJSON(t){return new gf(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class yf extends yl{constructor(t=new Tp(new Ns(-1,-1,0),new Ns(-1,1,0),new Ns(1,1,0)),e=64,n=1,r=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i};const o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const s=new Ns,a=new Ns,l=new hs;let c=new Ns;const u=[],h=[],d=[],p=[];function f(i){c=t.getPointAt(i/e,c);const l=o.normals[i],d=o.binormals[i];for(let t=0;t<=r;t++){const e=t/r*Math.PI*2,i=Math.sin(e),o=-Math.cos(e);a.x=o*l.x+i*d.x,a.y=o*l.y+i*d.y,a.z=o*l.z+i*d.z,a.normalize(),h.push(a.x,a.y,a.z),s.x=c.x+n*a.x,s.y=c.y+n*a.y,s.z=c.z+n*a.z,u.push(s.x,s.y,s.z)}}!function(){for(let t=0;t<e;t++)f(t);f(!1===i?e:0),function(){for(let t=0;t<=e;t++)for(let n=0;n<=r;n++)l.x=t/e,l.y=n/r,d.push(l.x,l.y)}(),function(){for(let t=1;t<=e;t++)for(let e=1;e<=r;e++){const n=(r+1)*(t-1)+(e-1),i=(r+1)*t+(e-1),o=(r+1)*t+e,s=(r+1)*(t-1)+e;p.push(n,i,s),p.push(i,o,s)}}()}(),this.setIndex(p),this.setAttribute("position",new ll(u,3)),this.setAttribute("normal",new ll(h,3)),this.setAttribute("uv",new ll(d,2))}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new yf((new Rp[t.path.type]).fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class vf extends yl{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],n=new Set,r=new Ns,i=new Ns;if(null!==t.index){const o=t.attributes.position,s=t.index;let a=t.groups;0===a.length&&(a=[{start:0,count:s.count,materialIndex:0}]);for(let t=0,l=a.length;t<l;++t){const l=a[t],c=l.start;for(let t=c,a=c+l.count;t<a;t+=3)for(let a=0;a<3;a++){const l=s.getX(t+a),c=s.getX(t+(a+1)%3);r.fromBufferAttribute(o,l),i.fromBufferAttribute(o,c),!0===_f(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}}else{const o=t.attributes.position;for(let t=0,s=o.count/3;t<s;t++)for(let s=0;s<3;s++){const a=3*t+s,l=3*t+(s+1)%3;r.fromBufferAttribute(o,a),i.fromBufferAttribute(o,l),!0===_f(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}this.setAttribute("position",new ll(e,3))}}}function _f(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r,i),!0)}var wf=Object.freeze({__proto__:null,BoxGeometry:Bl,BoxBufferGeometry:Bl,CircleGeometry:$d,CircleBufferGeometry:$d,ConeGeometry:ep,ConeBufferGeometry:ep,CylinderGeometry:tp,CylinderBufferGeometry:tp,DodecahedronGeometry:rp,DodecahedronBufferGeometry:rp,EdgesGeometry:lp,ExtrudeGeometry:sf,ExtrudeBufferGeometry:sf,IcosahedronGeometry:lf,IcosahedronBufferGeometry:lf,LatheGeometry:cf,LatheBufferGeometry:cf,OctahedronGeometry:uf,OctahedronBufferGeometry:uf,PlaneGeometry:rc,PlaneBufferGeometry:rc,PolyhedronGeometry:np,PolyhedronBufferGeometry:np,RingGeometry:hf,RingBufferGeometry:hf,ShapeGeometry:df,ShapeBufferGeometry:df,SphereGeometry:pf,SphereBufferGeometry:pf,TetrahedronGeometry:ff,TetrahedronBufferGeometry:ff,TorusGeometry:mf,TorusBufferGeometry:mf,TorusKnotGeometry:gf,TorusKnotBufferGeometry:gf,TubeGeometry:yf,TubeBufferGeometry:yf,WireframeGeometry:vf});class bf extends Ya{constructor(t){super(),this.type="ShadowMaterial",this.color=new Es(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}bf.prototype.isShadowMaterial=!0;class xf extends Ya{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Es(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Es(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new hs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}xf.prototype.isMeshStandardMaterial=!0;class Ef extends xf{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new hs(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return is(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Es(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Es(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Es(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}Ef.prototype.isMeshPhysicalMaterial=!0;class Sf extends Ya{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new Es(16777215),this.specular=new Es(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Es(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new hs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}Sf.prototype.isMeshPhongMaterial=!0;class Mf extends Ya{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Es(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Es(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new hs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Mf.prototype.isMeshToonMaterial=!0;class Tf extends Ya{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new hs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}Tf.prototype.isMeshNormalMaterial=!0;class Af extends Ya{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new Es(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Es(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Af.prototype.isMeshLambertMaterial=!0;class Rf extends Ya{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Es(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xo,this.normalScale=new hs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}}Rf.prototype.isMeshMatcapMaterial=!0;class Lf extends Pd{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}Lf.prototype.isLineDashedMaterial=!0;var Cf=Object.freeze({__proto__:null,ShadowMaterial:bf,SpriteMaterial:Yh,RawShaderMaterial:fc,ShaderMaterial:Hl,PointsMaterial:Gd,MeshPhysicalMaterial:Ef,MeshStandardMaterial:xf,MeshPhongMaterial:Sf,MeshToonMaterial:Mf,MeshNormalMaterial:Tf,MeshLambertMaterial:Af,MeshDepthMaterial:Rh,MeshDistanceMaterial:Lh,MeshBasicMaterial:Ja,MeshMatcapMaterial:Rf,LineDashedMaterial:Lf,LineBasicMaterial:Pd,Material:Ya});const Pf={arraySlice:function(t,e,n){return Pf.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let t=0;t!==e;++t)n[t]=t;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){const r=t.length,i=new t.constructor(r);for(let o=0,s=0;s!==r;++o){const r=n[o]*e;for(let n=0;n!==e;++n)i[s++]=t[r+n]}return i},flattenJSON:function(t,e,n,r){let i=1,o=t[0];for(;void 0!==o&&void 0===o[r];)o=t[i++];if(void 0===o)return;let s=o[r];if(void 0!==s)if(Array.isArray(s))do{s=o[r],void 0!==s&&(e.push(o.time),n.push.apply(n,s)),o=t[i++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[r],void 0!==s&&(e.push(o.time),s.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{s=o[r],void 0!==s&&(e.push(o.time),n.push(s)),o=t[i++]}while(void 0!==o)},subclip:function(t,e,n,r,i=30){const o=t.clone();o.name=e;const s=[];for(let t=0;t<o.tracks.length;++t){const e=o.tracks[t],a=e.getValueSize(),l=[],c=[];for(let t=0;t<e.times.length;++t){const o=e.times[t]*i;if(!(o<n||o>=r)){l.push(e.times[t]);for(let n=0;n<a;++n)c.push(e.values[t*a+n])}}0!==l.length&&(e.times=Pf.convertArray(l,e.times.constructor),e.values=Pf.convertArray(c,e.values.constructor),s.push(e))}o.tracks=s;let a=1/0;for(let t=0;t<o.tracks.length;++t)a>o.tracks[t].times[0]&&(a=o.tracks[t].times[0]);for(let t=0;t<o.tracks.length;++t)o.tracks[t].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(t,e=0,n=t,r=30){r<=0&&(r=30);const i=n.tracks.length,o=e/r;for(let e=0;e<i;++e){const r=n.tracks[e],i=r.ValueTypeName;if("bool"===i||"string"===i)continue;const s=t.tracks.find((function(t){return t.name===r.name&&t.ValueTypeName===i}));if(void 0===s)continue;let a=0;const l=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=r.times.length-1;let d;if(o<=r.times[0]){const t=a,e=l-a;d=Pf.arraySlice(r.values,t,e)}else if(o>=r.times[h]){const t=h*l+a,e=t+l-a;d=Pf.arraySlice(r.values,t,e)}else{const t=r.createInterpolant(),e=a,n=l-a;t.evaluate(o),d=Pf.arraySlice(t.resultBuffer,e,n)}"quaternion"===i&&(new Os).fromArray(d).normalize().conjugate().toArray(d);const p=s.times.length;for(let t=0;t<p;++t){const e=t*u+c;if("quaternion"===i)Os.multiplyQuaternionsFlat(s.values,e,d,0,s.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)s.values[e+n]-=d[n]}}}return t.blendMode=fo,t}};class If{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let o;n:{r:if(!(t<r)){for(let o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}if(t>=i)break t;{const s=e[1];t<s&&(n=2,i=s);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}}for(;n<o;){const r=n+o>>>1;t<e[r]?o=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let t=0;t!==r;++t)e[t]=n[i+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}If.prototype.beforeStart_=If.prototype.copySampleValue_,If.prototype.afterEnd_=If.prototype.copySampleValue_;class Of extends If{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:co,endingEnd:co}}intervalChanged_(t,e,n){const r=this.parameterPositions;let i=t-2,o=t+1,s=r[i],a=r[o];if(void 0===s)switch(this.getSettings_().endingStart){case uo:i=t,s=2*e-n;break;case ho:i=r.length-2,s=e+r[i]-r[i+1];break;default:i=t,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case uo:o=t,a=2*n-e;break;case ho:o=1,a=n+r[1]-r[0];break;default:o=t-1,a=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-s),this._weightNext=l/(a-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(r-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let t=0;t!==s;++t)i[t]=g*o[c+t]+y*o[l+t]+v*o[a+t]+_*o[u+t];return i}}class Nf extends If{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,c=(n-e)/(r-e),u=1-c;for(let t=0;t!==s;++t)i[t]=o[l+t]*u+o[a+t]*c;return i}}class kf extends If{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class Df{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Pf.convertArray(e,this.TimeBufferType),this.values=Pf.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:Pf.convertArray(t.times,Array),values:Pf.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new kf(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Nf(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Of(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case so:e=this.InterpolantFactoryMethodDiscrete;break;case ao:e=this.InterpolantFactoryMethodLinear;break;case lo:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return so;case this.InterpolantFactoryMethodLinear:return ao;case this.InterpolantFactoryMethodSmooth:return lo}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const t=this.getValueSize();this.times=Pf.arraySlice(n,i,o),this.values=Pf.arraySlice(this.values,i*t,o*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let e=0;e!==i;e++){const r=n[e];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,r),t=!1;break}if(null!==o&&o>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,r,o),t=!1;break}o=r}if(void 0!==r&&Pf.isTypedArray(r))for(let e=0,n=r.length;e!==n;++e){const n=r[e];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,n),t=!1;break}}return t}optimize(){const t=Pf.arraySlice(this.times),e=Pf.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===lo,i=t.length-1;let o=1;for(let s=1;s<i;++s){let i=!1;const a=t[s];if(a!==t[s+1]&&(1!==s||a!==t[0]))if(r)i=!0;else{const t=s*n,r=t-n,o=t+n;for(let s=0;s!==n;++s){const n=e[t+s];if(n!==e[r+s]||n!==e[o+s]){i=!0;break}}}if(i){if(s!==o){t[o]=t[s];const r=s*n,i=o*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++o}}if(i>0){t[o]=t[i];for(let t=i*n,r=o*n,s=0;s!==n;++s)e[r+s]=e[t+s];++o}return o!==t.length?(this.times=Pf.arraySlice(t,0,o),this.values=Pf.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this}clone(){const t=Pf.arraySlice(this.times,0),e=Pf.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}Df.prototype.TimeBufferType=Float32Array,Df.prototype.ValueBufferType=Float32Array,Df.prototype.DefaultInterpolation=ao;class Bf extends Df{}Bf.prototype.ValueTypeName="bool",Bf.prototype.ValueBufferType=Array,Bf.prototype.DefaultInterpolation=so,Bf.prototype.InterpolantFactoryMethodLinear=void 0,Bf.prototype.InterpolantFactoryMethodSmooth=void 0;class Uf extends Df{}Uf.prototype.ValueTypeName="color";class zf extends Df{}zf.prototype.ValueTypeName="number";class Ff extends If{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=(n-e)/(r-e);let l=t*s;for(let t=l+s;l!==t;l+=4)Os.slerpFlat(i,0,o,l-s,o,l,a);return i}}class Hf extends Df{InterpolantFactoryMethodLinear(t){return new Ff(this.times,this.values,this.getValueSize(),t)}}Hf.prototype.ValueTypeName="quaternion",Hf.prototype.DefaultInterpolation=ao,Hf.prototype.InterpolantFactoryMethodSmooth=void 0;class Gf extends Df{}Gf.prototype.ValueTypeName="string",Gf.prototype.ValueBufferType=Array,Gf.prototype.DefaultInterpolation=so,Gf.prototype.InterpolantFactoryMethodLinear=void 0,Gf.prototype.InterpolantFactoryMethodSmooth=void 0;class Vf extends Df{}Vf.prototype.ValueTypeName="vector";class jf{constructor(t,e=-1,n,r=po){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=rs(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let t=0,i=n.length;t!==i;++t)e.push(Wf(n[t]).scale(r));const i=new this(t.name,t.duration,e,t.blendMode);return i.uuid=t.uuid,i}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,r=n.length;t!==r;++t)e.push(Df.toJSON(n[t]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const i=e.length,o=[];for(let t=0;t<i;t++){let s=[],a=[];s.push((t+i-1)%i,t,(t+1)%i),a.push(0,1,0);const l=Pf.getKeyframeOrder(s);s=Pf.sortedArray(s,1,l),a=Pf.sortedArray(a,1,l),r||0!==s[0]||(s.push(i),a.push(a[0])),o.push(new zf(".morphTargetInfluences["+e[t].name+"]",s,a).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let e=0,n=t.length;e<n;e++){const n=t[e],o=n.name.match(i);if(o&&o.length>1){const t=o[1];let e=r[t];e||(r[t]=e=[]),e.push(n)}}const o=[];for(const t in r)o.push(this.CreateFromMorphTargetSequence(t,r[t],e,n));return o}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,r,i){if(0!==n.length){const o=[],s=[];Pf.flattenJSON(n,o,s,r),0!==o.length&&i.push(new t(e,o,s))}},r=[],i=t.name||"default",o=t.fps||30,s=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let t=0;t<l.length;t++){const i=l[t].keys;if(i&&0!==i.length)if(i[0].morphTargets){const t={};let e;for(e=0;e<i.length;e++)if(i[e].morphTargets)for(let n=0;n<i[e].morphTargets.length;n++)t[i[e].morphTargets[n]]=-1;for(const n in t){const t=[],o=[];for(let r=0;r!==i[e].morphTargets.length;++r){const r=i[e];t.push(r.time),o.push(r.morphTarget===n?1:0)}r.push(new zf(".morphTargetInfluence["+n+"]",t,o))}a=t.length*(o||1)}else{const o=".bones["+e[t].name+"]";n(Vf,o+".position",i,"pos",r),n(Hf,o+".quaternion",i,"rot",r),n(Vf,o+".scale",i,"scl",r)}}return 0===r.length?null:new this(i,a,r,s)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Wf(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return zf;case"vector":case"vector2":case"vector3":case"vector4":return Vf;case"color":return Uf;case"quaternion":return Hf;case"bool":case"boolean":return Bf;case"string":return Gf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];Pf.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const qf={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Kf{constructor(t,e,n){const r=this;let i,o=!1,s=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===o&&void 0!==r.onStart&&r.onStart(t,s,a),o=!0},this.itemEnd=function(t){s++,void 0!==r.onProgress&&r.onProgress(t,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}}const Xf=new Kf;class Yf{constructor(t){this.manager=void 0!==t?t:Xf,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Jf={};class Zf extends Yf{constructor(t){super(t)}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=qf.get(t);if(void 0!==i)return this.manager.itemStart(t),setTimeout((()=>{e&&e(i),this.manager.itemEnd(t)}),0),i;if(void 0!==Jf[t])return void Jf[t].push({onLoad:e,onProgress:n,onError:r});Jf[t]=[],Jf[t].push({onLoad:e,onProgress:n,onError:r});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,a=this.responseType;fetch(o).then((e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===e.body.getReader)return e;const n=Jf[t],r=e.body.getReader(),i=e.headers.get("Content-Length"),o=i?parseInt(i):0,s=0!==o;let a=0;const l=new ReadableStream({start(t){!function e(){r.read().then((({done:r,value:i})=>{if(r)t.close();else{a+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:a,total:o});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(r)}t.enqueue(i),e()}}))}()}});return new Response(l)}throw Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)})).then((t=>{switch(a){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,s)));case"json":return t.json();default:if(void 0===s)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(s),n=e&&e[1]?e[1].toLowerCase():void 0,r=new TextDecoder(n);return t.arrayBuffer().then((t=>r.decode(t)))}}})).then((e=>{qf.add(t,e);const n=Jf[t];delete Jf[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onLoad&&r.onLoad(e)}})).catch((e=>{const n=Jf[t];if(void 0===n)throw this.manager.itemError(t),e;delete Jf[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Qf extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new Zf(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)}parse(t){const e=[];for(let n=0;n<t.length;n++){const r=jf.parse(t[n]);e.push(r)}return e}}class $f extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=this,o=[],s=new Zd,a=new Zf(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials);let l=0;function c(c){a.load(t[c],(function(t){const n=i.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=ii),s.image=o,s.format=n.format,s.needsUpdate=!0,e&&e(s))}),n,r)}if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)c(e);else a.load(t,(function(t){const n=i.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){o[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)o[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),o[e].format=n.format,o[e].width=n.width,o[e].height=n.height}s.image=o}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=ii),s.format=n.format,s.needsUpdate=!0,e&&e(s)}),n,r);return s}}class tm extends Yf{constructor(t){super(t)}load(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=qf.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const s=gs("img");function a(){c(),qf.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){c(),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}function c(){s.removeEventListener("load",a,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",a,!1),s.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(t),s.src=t,s}}class em extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=new ql,o=new tm(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let s=0;function a(n){o.load(t[n],(function(t){i.images[n]=t,s++,6===s&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(let e=0;e<t.length;++e)a(e);return i}}class nm extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new bd,s=new Zf(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(t,(function(t){const n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Zr,o.wrapT=void 0!==n.wrapT?n.wrapT:Zr,o.magFilter=void 0!==n.magFilter?n.magFilter:ii,o.minFilter=void 0!==n.minFilter?n.minFilter:ii,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=ai),1===n.mipmapCount&&(o.minFilter=ii),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}class rm extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=new As,o=new tm(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(t){i.image=t,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}class im extends Da{constructor(t,e=1){super(),this.type="Light",this.color=new Es(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}im.prototype.isLight=!0;class om extends im{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(Da.DefaultUp),this.updateMatrix(),this.groundColor=new Es(e)}copy(t){return im.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}om.prototype.isHemisphereLight=!0;const sm=new ha,am=new Ns,lm=new Ns;class cm{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new hs(512,512),this.map=null,this.mapPass=null,this.matrix=new ha,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tc,this._frameExtents=new hs(1,1),this._viewportCount=1,this._viewports=[new Ls(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;am.setFromMatrixPosition(t.matrixWorld),e.position.copy(am),lm.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(lm),e.updateMatrixWorld(),sm.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sm),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class um extends cm{constructor(){super(new Vl(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*ns*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}um.prototype.isSpotLightShadow=!0;class hm extends im{constructor(t,e,n=0,r=Math.PI/3,i=0,o=1){super(t,e),this.type="SpotLight",this.position.copy(Da.DefaultUp),this.updateMatrix(),this.target=new Da,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.shadow=new um}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}hm.prototype.isSpotLight=!0;const dm=new ha,pm=new Ns,fm=new Ns;class mm extends cm{constructor(){super(new Vl(90,1,.5,500)),this._frameExtents=new hs(4,2),this._viewportCount=6,this._viewports=[new Ls(2,1,1,1),new Ls(0,1,1,1),new Ls(3,1,1,1),new Ls(1,1,1,1),new Ls(3,0,1,1),new Ls(1,0,1,1)],this._cubeDirections=[new Ns(1,0,0),new Ns(-1,0,0),new Ns(0,0,1),new Ns(0,0,-1),new Ns(0,1,0),new Ns(0,-1,0)],this._cubeUps=[new Ns(0,1,0),new Ns(0,1,0),new Ns(0,1,0),new Ns(0,1,0),new Ns(0,0,1),new Ns(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,i=t.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),pm.setFromMatrixPosition(t.matrixWorld),n.position.copy(pm),fm.copy(n.position),fm.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(fm),n.updateMatrixWorld(),r.makeTranslation(-pm.x,-pm.y,-pm.z),dm.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dm)}}mm.prototype.isPointLightShadow=!0;class gm extends im{constructor(t,e,n=0,r=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new mm}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}gm.prototype.isPointLight=!0;class ym extends cm{constructor(){super(new pc(-5,5,5,-5,.5,500))}}ym.prototype.isDirectionalLightShadow=!0;class vm extends im{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(Da.DefaultUp),this.updateMatrix(),this.target=new Da,this.shadow=new ym}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}vm.prototype.isDirectionalLight=!0;class _m extends im{constructor(t,e){super(t,e),this.type="AmbientLight"}}_m.prototype.isAmbientLight=!0;class wm extends im{constructor(t,e,n=10,r=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}wm.prototype.isRectAreaLight=!0;class bm{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Ns)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}bm.prototype.isSphericalHarmonics3=!0;class xm extends im{constructor(t=new bm,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}xm.prototype.isLightProbe=!0;class Em extends Yf{constructor(t){super(t),this.textures={}}load(t,e,n,r){const i=this,o=new Zf(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)}parse(t){const e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}const r=new Cf[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&void 0!==r.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=t.sheen),void 0!==t.sheenColor&&(r.sheenColor=(new Es).setHex(t.sheenColor)),void 0!==t.sheenRoughness&&(r.sheenRoughness=t.sheenRoughness),void 0!==t.emissive&&void 0!==r.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==r.specular&&r.specular.setHex(t.specular),void 0!==t.specularIntensity&&(r.specularIntensity=t.specularIntensity),void 0!==t.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(t.specularColor),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.transmission&&(r.transmission=t.transmission),void 0!==t.thickness&&(r.thickness=t.thickness),void 0!==t.attenuationDistance&&(r.attenuationDistance=t.attenuationDistance),void 0!==t.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(t.attenuationColor),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.shadowSide&&(r.shadowSide=t.shadowSide),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.alphaWrite&&(r.alphaWrite=t.alphaWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.alphaToCoverage&&(r.alphaToCoverage=t.alphaToCoverage),void 0!==t.premultipliedAlpha&&(r.premultipliedAlpha=t.premultipliedAlpha),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const e in t.uniforms){const i=t.uniforms[e];switch(r.uniforms[e]={},i.type){case"t":r.uniforms[e].value=n(i.value);break;case"c":r.uniforms[e].value=(new Es).setHex(i.value);break;case"v2":r.uniforms[e].value=(new hs).fromArray(i.value);break;case"v3":r.uniforms[e].value=(new Ns).fromArray(i.value);break;case"v4":r.uniforms[e].value=(new Ls).fromArray(i.value);break;case"m3":r.uniforms[e].value=(new ds).fromArray(i.value);break;case"m4":r.uniforms[e].value=(new ha).fromArray(i.value);break;default:r.uniforms[e].value=i.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const e in t.extensions)r.extensions[e]=t.extensions[e];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),r.normalScale=(new hs).fromArray(e)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.specularIntensityMap&&(r.specularIntensityMap=n(t.specularIntensityMap)),void 0!==t.specularColorMap&&(r.specularColorMap=n(t.specularColorMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new hs).fromArray(t.clearcoatNormalScale)),void 0!==t.transmissionMap&&(r.transmissionMap=n(t.transmissionMap)),void 0!==t.thicknessMap&&(r.thicknessMap=n(t.thicknessMap)),void 0!==t.sheenColorMap&&(r.sheenColorMap=n(t.sheenColorMap)),void 0!==t.sheenRoughnessMap&&(r.sheenRoughnessMap=n(t.sheenRoughnessMap)),r}setTextures(t){return this.textures=t,this}}class Sm{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class Mm extends yl{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}Mm.prototype.isInstancedBufferGeometry=!0;class Tm extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new Zf(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)}parse(t){const e={},n={};function r(t,r){if(void 0!==e[r])return e[r];const i=t.interleavedBuffers[r],o=function(t,e){if(void 0!==n[e])return n[e];const r=t.arrayBuffers[e],i=new Uint32Array(r).buffer;return n[e]=i,i}(t,i.buffer),s=ms(i.type,o),a=new qh(s,i.stride);return a.uuid=i.uuid,e[r]=a,a}const i=t.isInstancedBufferGeometry?new Mm:new yl,o=t.data.index;if(void 0!==o){const t=ms(o.type,o.array);i.setIndex(new $a(t,1))}const s=t.data.attributes;for(const e in s){const n=s[e];let o;if(n.isInterleavedBufferAttribute){const e=r(t.data,n.data);o=new Xh(e,n.itemSize,n.offset,n.normalized)}else{const t=ms(n.type,n.array);o=new(n.isInstancedBufferAttribute?Md:$a)(t,n.itemSize,n.normalized)}void 0!==n.name&&(o.name=n.name),void 0!==n.usage&&o.setUsage(n.usage),void 0!==n.updateRange&&(o.updateRange.offset=n.updateRange.offset,o.updateRange.count=n.updateRange.count),i.setAttribute(e,o)}const a=t.data.morphAttributes;if(a)for(const e in a){const n=a[e],o=[];for(let e=0,i=n.length;e<i;e++){const i=n[e];let s;if(i.isInterleavedBufferAttribute){const e=r(t.data,i.data);s=new Xh(e,i.itemSize,i.offset,i.normalized)}else{const t=ms(i.type,i.array);s=new $a(t,i.itemSize,i.normalized)}void 0!==i.name&&(s.name=i.name),o.push(s)}i.morphAttributes[e]=o}t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(let t=0,e=l.length;t!==e;++t){const e=l[t];i.addGroup(e.start,e.count,e.materialIndex)}const c=t.data.boundingSphere;if(void 0!==c){const t=new Ns;void 0!==c.center&&t.fromArray(c.center),i.boundingSphere=new na(t,c.radius)}return t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i}}class Am extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=this,o=""===this.path?Sm.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const s=new Zf(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){let o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}const s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)}async loadAsync(t,e){const n=""===this.path?Sm.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||n;const r=new Zf(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(t,e),o=JSON.parse(i),s=o.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+t);return await this.parseAsync(o)}parse(t,e){const n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),o=this.parseImages(t.images,(function(){void 0!==e&&e(l)})),s=this.parseTextures(t.textures,o),a=this.parseMaterials(t.materials,s),l=this.parseObject(t.object,i,a,s,n),c=this.parseSkeletons(t.skeletons,l);if(this.bindSkeletons(l,c),void 0!==e){let t=!1;for(const e in o)if(o[e]instanceof HTMLImageElement){t=!0;break}!1===t&&e(l)}return l}async parseAsync(t){const e=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,n),i=await this.parseImagesAsync(t.images),o=this.parseTextures(t.textures,i),s=this.parseMaterials(t.materials,o),a=this.parseObject(t.object,r,s,o,e),l=this.parseSkeletons(t.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(t){const e={};if(void 0!==t)for(let n=0,r=t.length;n<r;n++){const r=(new Pp).fromJSON(t[n]);e[r.uuid]=r}return e}parseSkeletons(t,e){const n={},r={};if(e.traverse((function(t){t.isBone&&(r[t.uuid]=t)})),void 0!==t)for(let e=0,i=t.length;e<i;e++){const i=(new Sd).fromJSON(t[e],r);n[i.uuid]=i}return n}parseGeometries(t,e){const n={};if(void 0!==t){const r=new Tm;for(let i=0,o=t.length;i<o;i++){let o;const s=t[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:s.type in wf?o=wf[s.type].fromJSON(s,e):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${s.type}"`)}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}}return n}parseMaterials(t,e){const n={},r={};if(void 0!==t){const i=new Em;i.setTextures(e);for(let e=0,o=t.length;e<o;e++){const o=t[e];if("MultiMaterial"===o.type){const t=[];for(let e=0;e<o.materials.length;e++){const r=o.materials[e];void 0===n[r.uuid]&&(n[r.uuid]=i.parse(r)),t.push(n[r.uuid])}r[o.uuid]=t}else void 0===n[o.uuid]&&(n[o.uuid]=i.parse(o)),r[o.uuid]=n[o.uuid]}}return r}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const r=t[n],i=jf.parse(r);e[i.uuid]=i}return e}parseImages(t,e){const n=this,r={};let i;function o(t){if("string"==typeof t){const e=t;return function(t){return n.manager.itemStart(t),i.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e)}return t.data?{data:ms(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){const n=new Kf(e);i=new tm(n),i.setCrossOrigin(this.crossOrigin);for(let e=0,n=t.length;e<n;e++){const n=t[e],i=n.url;if(Array.isArray(i)){r[n.uuid]=[];for(let t=0,e=i.length;t<e;t++){const e=o(i[t]);null!==e&&(e instanceof HTMLImageElement?r[n.uuid].push(e):r[n.uuid].push(new bd(e.data,e.width,e.height)))}}else{const t=o(n.url);null!==t&&(r[n.uuid]=t)}}}return r}async parseImagesAsync(t){const e=this,n={};let r;async function i(t){if("string"==typeof t){const n=t,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:e.resourcePath+n;return await r.loadAsync(i)}return t.data?{data:ms(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){r=new tm(this.manager),r.setCrossOrigin(this.crossOrigin);for(let e=0,r=t.length;e<r;e++){const r=t[e],o=r.url;if(Array.isArray(o)){n[r.uuid]=[];for(let t=0,e=o.length;t<e;t++){const e=o[t],s=await i(e);null!==s&&(s instanceof HTMLImageElement?n[r.uuid].push(s):n[r.uuid].push(new bd(s.data,s.width,s.height)))}}else{const t=await i(r.url);null!==t&&(n[r.uuid]=t)}}}return n}parseTextures(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}const r={};if(void 0!==t)for(let i=0,o=t.length;i<o;i++){const o=t[i];let s;void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const a=e[o.image];Array.isArray(a)?(s=new ql(a),6===a.length&&(s.needsUpdate=!0)):(s=a&&a.data?new bd(a.data,a.width,a.height):new As(a),a&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,Rm)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],Lm),s.wrapT=n(o.wrap[1],Lm)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,Cm)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,Cm)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),void 0!==o.userData&&(s.userData=o.userData),r[o.uuid]=s}return r}parseObject(t,e,n,r,i){let o,s,a;function l(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function c(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),e.push(n[i])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}function u(t){return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined texture",t),r[t]}switch(t.type){case"Scene":o=new Wh,void 0!==t.background&&(Number.isInteger(t.background)?o.background=new Es(t.background):o.background=u(t.background)),void 0!==t.environment&&(o.environment=u(t.environment)),void 0!==t.fog&&("Fog"===t.fog.type?o.fog=new jh(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(o.fog=new Vh(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":o=new Vl(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(o.focus=t.focus),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.filmGauge&&(o.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(o.filmOffset=t.filmOffset),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"OrthographicCamera":o=new pc(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"AmbientLight":o=new _m(t.color,t.intensity);break;case"DirectionalLight":o=new vm(t.color,t.intensity);break;case"PointLight":o=new gm(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":o=new wm(t.color,t.intensity,t.width,t.height);break;case"SpotLight":o=new hm(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":o=new om(t.color,t.groundColor,t.intensity);break;case"LightProbe":o=(new xm).fromJSON(t);break;case"SkinnedMesh":s=l(t.geometry),a=c(t.material),o=new _d(s,a),void 0!==t.bindMode&&(o.bindMode=t.bindMode),void 0!==t.bindMatrix&&o.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(o.skeleton=t.skeleton);break;case"Mesh":s=l(t.geometry),a=c(t.material),o=new kl(s,a);break;case"InstancedMesh":s=l(t.geometry),a=c(t.material);const e=t.count,n=t.instanceMatrix,r=t.instanceColor;o=new Cd(s,a,e),o.instanceMatrix=new Md(new Float32Array(n.array),16),void 0!==r&&(o.instanceColor=new Md(new Float32Array(r.array),r.itemSize));break;case"LOD":o=new pd;break;case"Line":o=new Bd(l(t.geometry),c(t.material));break;case"LineLoop":o=new Hd(l(t.geometry),c(t.material));break;case"LineSegments":o=new Fd(l(t.geometry),c(t.material));break;case"PointCloud":case"Points":o=new Kd(l(t.geometry),c(t.material));break;case"Sprite":o=new cd(c(t.material));break;case"Group":o=new kh;break;case"Bone":o=new wd;break;default:o=new Da}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(o.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(o.matrixAutoUpdate=t.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.quaternion&&o.quaternion.fromArray(t.quaternion),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.castShadow&&(o.castShadow=t.castShadow),void 0!==t.receiveShadow&&(o.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(o.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(o.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(o.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&o.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(o.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.frustumCulled&&(o.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(o.renderOrder=t.renderOrder),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.layers&&(o.layers.mask=t.layers),void 0!==t.children){const s=t.children;for(let t=0;t<s.length;t++)o.add(this.parseObject(s[t],e,n,r,i))}if(void 0!==t.animations){const e=t.animations;for(let t=0;t<e.length;t++){const n=e[t];o.animations.push(i[n])}}if("LOD"===t.type){void 0!==t.autoUpdate&&(o.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],r=o.getObjectByProperty("uuid",n.object);void 0!==r&&o.addLevel(r,n.distance)}}return o}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse((function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){const n=e[t.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton):t.bind(n,t.bindMatrix)}}))}setTexturePath(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}const Rm={UVMapping:Vr,CubeReflectionMapping:jr,CubeRefractionMapping:Wr,EquirectangularReflectionMapping:qr,EquirectangularRefractionMapping:Kr,CubeUVReflectionMapping:Xr,CubeUVRefractionMapping:Yr},Lm={RepeatWrapping:Jr,ClampToEdgeWrapping:Zr,MirroredRepeatWrapping:Qr},Cm={NearestFilter:$r,NearestMipmapNearestFilter:ti,NearestMipmapLinearFilter:ni,LinearFilter:ii,LinearMipmapNearestFilter:oi,LinearMipmapLinearFilter:ai};class Pm extends Yf{constructor(t){super(t),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=qf.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,fetch(t,s).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){qf.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}let Im;Pm.prototype.isImageBitmapLoader=!0;const Om={getContext:function(){return void 0===Im&&(Im=new(window.AudioContext||window.webkitAudioContext)),Im},setContext:function(t){Im=t}};class Nm extends Yf{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new Zf(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{const t=n.slice(0);Om.getContext().decodeAudioData(t,(function(t){e(t)}))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)}}class km extends xm{constructor(t,e,n=1){super(void 0,n);const r=(new Es).set(t),i=(new Es).set(e),o=new Ns(r.r,r.g,r.b),s=new Ns(i.r,i.g,i.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(a),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(l)}}km.prototype.isHemisphereLightProbe=!0;class Dm extends xm{constructor(t,e=1){super(void 0,e);const n=(new Es).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}Dm.prototype.isAmbientLightProbe=!0;const Bm=new ha,Um=new ha,zm=new ha;class Fm{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Vl,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Vl,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,zm.copy(t.projectionMatrix);const n=e.eyeSep/2,r=n*e.near/e.focus,i=e.near*Math.tan(es*e.fov*.5)/e.zoom;let o,s;Um.elements[12]=-n,Bm.elements[12]=n,o=-i*e.aspect+r,s=i*e.aspect+r,zm.elements[0]=2*e.near/(s-o),zm.elements[8]=(s+o)/(s-o),this.cameraL.projectionMatrix.copy(zm),o=-i*e.aspect-r,s=i*e.aspect-r,zm.elements[0]=2*e.near/(s-o),zm.elements[8]=(s+o)/(s-o),this.cameraR.projectionMatrix.copy(zm)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Um),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Bm)}}class Hm{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Gm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=Gm();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function Gm(){return("undefined"==typeof performance?Date:performance).now()}const Vm=new Ns,jm=new Os,Wm=new Ns,qm=new Ns;class Km extends Da{constructor(){super(),this.type="AudioListener",this.context=Om.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Hm}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Vm,jm,Wm),qm.set(0,0,-1).applyQuaternion(jm),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Vm.x,t),e.positionY.linearRampToValueAtTime(Vm.y,t),e.positionZ.linearRampToValueAtTime(Vm.z,t),e.forwardX.linearRampToValueAtTime(qm.x,t),e.forwardY.linearRampToValueAtTime(qm.y,t),e.forwardZ.linearRampToValueAtTime(qm.z,t),e.upX.linearRampToValueAtTime(n.x,t),e.upY.linearRampToValueAtTime(n.y,t),e.upZ.linearRampToValueAtTime(n.z,t)}else e.setPosition(Vm.x,Vm.y,Vm.z),e.setOrientation(qm.x,qm.y,qm.z,n.x,n.y,n.z)}}class Xm extends Da{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const Ym=new Ns,Jm=new Os,Zm=new Ns,Qm=new Ns;class $m extends Xm{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Ym,Jm,Zm),Qm.set(0,0,1).applyQuaternion(Jm);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(Ym.x,t),e.positionY.linearRampToValueAtTime(Ym.y,t),e.positionZ.linearRampToValueAtTime(Ym.z,t),e.orientationX.linearRampToValueAtTime(Qm.x,t),e.orientationY.linearRampToValueAtTime(Qm.y,t),e.orientationZ.linearRampToValueAtTime(Qm.z,t)}else e.setPosition(Ym.x,Ym.y,Ym.z),e.setOrientation(Qm.x,Qm.y,Qm.z)}}class tg{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}class eg{constructor(t,e,n){let r,i,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==r;++t)n[i+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,i,0,t,r)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const t=e*this._origIndex;this._mixBufferRegion(n,r,t,1-i,e)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let t=e,i=e+e;t!==i;++t)if(n[t]!==n[t+e]){s.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let t=n,i=r;t!==i;++t)e[t]=e[r+t%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,i){if(r>=.5)for(let r=0;r!==i;++r)t[e+r]=t[n+r]}_slerp(t,e,n,r){Os.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,i){const o=this._workIndex*i;Os.multiplyQuaternionsFlat(t,o,t,e,t,n),Os.slerpFlat(t,e,t,e,t,o,r)}_lerp(t,e,n,r,i){const o=1-r;for(let s=0;s!==i;++s){const i=e+s;t[i]=t[i]*o+t[n+s]*r}}_lerpAdditive(t,e,n,r,i){for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]+t[n+o]*r}}}const ng=new RegExp("[\\[\\]\\.:\\/]","g"),rg="[^\\[\\]\\.:\\/]",ig="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",og=/((?:WC+[\/:])*)/.source.replace("WC",rg),sg=/(WCOD+)?/.source.replace("WCOD",ig),ag=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",rg),lg=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",rg),cg=new RegExp("^"+og+sg+ag+lg+"$"),ug=["material","materials","bones"];class hg{constructor(t,e,n){this.path=e,this.parsedPath=n||hg.parseTrackName(e),this.node=hg.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new hg.Composite(t,e,n):new hg(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(ng,"")}static parseTrackName(t){const e=cg.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==ug.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const o=n(i.children);if(o)return o}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=hg.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}const o=t[r];if(void 0===o){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",t)}let s=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}hg.Composite=class{constructor(t,e,n){const r=n||hg.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},hg.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},hg.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},hg.prototype.GetterByBindingType=[hg.prototype._getValue_direct,hg.prototype._getValue_array,hg.prototype._getValue_arrayElement,hg.prototype._getValue_toArray],hg.prototype.SetterByBindingTypeAndVersioning=[[hg.prototype._setValue_direct,hg.prototype._setValue_direct_setNeedsUpdate,hg.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[hg.prototype._setValue_array,hg.prototype._setValue_array_setNeedsUpdate,hg.prototype._setValue_array_setMatrixWorldNeedsUpdate],[hg.prototype._setValue_arrayElement,hg.prototype._setValue_arrayElement_setNeedsUpdate,hg.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[hg.prototype._setValue_fromArray,hg.prototype._setValue_fromArray_setNeedsUpdate,hg.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class dg{constructor(){this.uuid=rs(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length;let s,a=t.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=e[h];if(void 0===d){d=a++,e[h]=d,t.push(u);for(let t=0,e=o;t!==e;++t)i[t].push(new hg(u,n[t],r[t]))}else if(d<l){s=t[d];const a=--l,c=t[a];e[c.uuid]=d,t[d]=c,e[h]=a,t[a]=u;for(let t=0,e=o;t!==e;++t){const e=i[t],o=e[a];let s=e[d];e[d]=o,void 0===s&&(s=new hg(u,n[t],r[t])),e[a]=s}}else t[d]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o],a=s.uuid,l=e[a];if(void 0!==l&&l>=i){const o=i++,c=t[o];e[c.uuid]=l,t[l]=c,e[a]=o,t[o]=s;for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[o],i=e[l];e[l]=r,e[o]=i}}}this.nCachedObjects_=i}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,o=t.length;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s].uuid,l=e[a];if(void 0!==l)if(delete e[a],l<i){const s=--i,a=t[s],c=--o,u=t[c];e[a.uuid]=l,t[l]=a,e[u.uuid]=s,t[s]=u,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[s],i=e[c];e[l]=r,e[s]=i,e.pop()}}else{const i=--o,s=t[i];i>0&&(e[s.uuid]=l),t[l]=s,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t];e[l]=e[i],e.pop()}}}this.nCachedObjects_=i}subscribe_(t,e){const n=this._bindingsIndicesByPath;let r=n[t];const i=this._bindings;if(void 0!==r)return i[r];const o=this._paths,s=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[t]=r,o.push(t),s.push(e),i.push(u);for(let n=c,r=a.length;n!==r;++n){const r=a[n];u[n]=new hg(r,t,e)}return u}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const r=this._paths,i=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s];e[t[s]]=n,o[n]=a,o.pop(),i[n]=i[s],i.pop(),r[n]=r[s],r.pop()}}}dg.prototype.isAnimationObjectGroup=!0;class pg{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const i=e.tracks,o=i.length,s=new Array(o),a={endingStart:co,endingEnd:co};for(let t=0;t!==o;++t){const e=i[t].createInterpolant(null);s[t]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=io,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=r/n,o=n/r;t.warp(1,i,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,i=r.time,o=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=i,a[1]=i+n,l[0]=t/o,l[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;if(r<0||0===n)return;this._startTime=null,e=n*r}e*=this._updateTimeScale(t);const o=this._updateTime(e),s=this._updateWeight(t);if(s>0){const t=this._interpolants,e=this._propertyBindings;if(this.blendMode===fo)for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulateAdditive(s);else for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulate(r,s)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const o=n===oo;if(0===t)return-1===i?r:o&&1==(1&i)?e-r:r;if(n===ro){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1==(1&i))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=uo,r.endingEnd=uo):(r.endingStart=t?this.zeroSlopeAtStart?uo:co:ho,r.endingEnd=e?this.zeroSlopeAtEnd?uo:co:ho)}_scheduleFading(t,e,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const s=o.parameterPositions,a=o.sampleValues;return s[0]=i,a[0]=e,s[1]=i+t,a[1]=n,this}}class fg extends Qo{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,s=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let t=0;t!==i;++t){const i=r[t],l=i.name;let u=c[l];if(void 0!==u)++u.referenceCount,o[t]=u;else{if(u=o[t],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,l));continue}const r=e&&e._propertyBindings[t].binding.parsedPath;u=new eg(hg.create(n,l,r),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,a,l),o[t]=u}s[t].resultBuffer=u.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,i=this._actionsByClip;let o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,o=this._actionsByClip,s=o[i],a=s.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null,delete s.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete o[i],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[e];void 0===o&&(o={},r[e]=o),o[n]=t,t._cacheIndex=i.length,i.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,s=o[r],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete s[i],0===Object.keys(s).length&&delete o[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new Nf(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i}clipAction(t,e,n){const r=e||this._root,i=r.uuid;let o="string"==typeof t?jf.findByName(r,t):t;const s=null!==o?o.uuid:t,a=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:po),void 0!==a){const t=a.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;l=a.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new pg(this,o,e,n);return this._bindAction(c,l),this._addInactiveAction(c,s,i),c}existingAction(t,e){const n=e||this._root,r=n.uuid,i="string"==typeof t?jf.findByName(n,t):t,o=i?i.uuid:t,s=this._actionsByClip[o];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1;for(let s=0;s!==n;++s)e[s]._update(r,t,i,o);const s=this._bindings,a=this._nActiveBindings;for(let t=0;t!==a;++t)s[t].apply(o);return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,o=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,e[i]=o,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const t in n){const r=n[t].actionByRoot[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}const r=this._bindingsByRootAndName[e];if(void 0!==r)for(const t in r){const e=r[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}fg.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class mg{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new mg(void 0===this.value.clone?this.value:this.value.clone())}}class gg extends qh{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}gg.prototype.isInstancedInterleavedBuffer=!0;class yg{constructor(t,e,n,r,i){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}yg.prototype.isGLBufferAttribute=!0;class vg{constructor(t,e,n=0,r=1/0){this.ray=new ua(t,e),this.near=n,this.far=r,this.camera=null,this.layers=new xa,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return wg(t,this,n,e),n.sort(_g),n}intersectObjects(t,e=!0,n=[]){for(let r=0,i=t.length;r<i;r++)wg(t[r],this,n,e);return n.sort(_g),n}}function _g(t,e){return t.distance-e.distance}function wg(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r){const r=t.children;for(let t=0,i=r.length;t<i;t++)wg(r[t],e,n,!0)}}class bg{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(is(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class xg{constructor(t=1,e=0,n=0){return this.radius=t,this.theta=e,this.y=n,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return(new this.constructor).copy(this)}}const Eg=new hs;class Sg{constructor(t=new hs(1/0,1/0),e=new hs(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Eg.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Eg.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}Sg.prototype.isBox2=!0;const Mg=new Ns,Tg=new Ns;class Ag{constructor(t=new Ns,e=new Ns){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){Mg.subVectors(t,this.start),Tg.subVectors(this.end,this.start);const n=Tg.dot(Tg);let r=Tg.dot(Mg)/n;return e&&(r=is(r,0,1)),r}closestPointToPoint(t,e,n){const r=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Rg=new Ns;class Lg extends Da{constructor(t,e){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;const n=new yl,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,e=1,n=32;t<n;t++,e++){const i=t/n*Math.PI*2,o=e/n*Math.PI*2;r.push(Math.cos(i),Math.sin(i),1,Math.cos(o),Math.sin(o),1)}n.setAttribute("position",new ll(r,3));const i=new Pd({fog:!1,toneMapped:!1});this.cone=new Fd(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Rg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Rg),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Cg=new Ns,Pg=new ha,Ig=new ha;class Og extends Fd{constructor(t){const e=Ng(t),n=new yl,r=[],i=[],o=new Es(0,0,1),s=new Es(0,1,0);for(let t=0;t<e.length;t++){const n=e[t];n.parent&&n.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(s.r,s.g,s.b))}n.setAttribute("position",new ll(r,3)),n.setAttribute("color",new ll(i,3)),super(n,new Pd({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");Ig.copy(this.root.matrixWorld).invert();for(let t=0,n=0;t<e.length;t++){const i=e[t];i.parent&&i.parent.isBone&&(Pg.multiplyMatrices(Ig,i.matrixWorld),Cg.setFromMatrixPosition(Pg),r.setXYZ(n,Cg.x,Cg.y,Cg.z),Pg.multiplyMatrices(Ig,i.parent.matrixWorld),Cg.setFromMatrixPosition(Pg),r.setXYZ(n+1,Cg.x,Cg.y,Cg.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}function Ng(t){const e=[];t&&t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,Ng(t.children[n]));return e}class kg extends kl{constructor(t,e,n){super(new pf(e,4,2),new Ja({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Dg=new Ns,Bg=new Es,Ug=new Es;class zg extends Da{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new uf(e);r.rotateY(.5*Math.PI),this.material=new Ja({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new $a(o,3)),this.add(new kl(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");Bg.copy(this.light.color),Ug.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const r=t<n/2?Bg:Ug;e.setXYZ(t,r.r,r.g,r.b)}e.needsUpdate=!0}t.lookAt(Dg.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Fg extends Fd{constructor(t=10,e=10,n=4473924,r=8947848){n=new Es(n),r=new Es(r);const i=e/2,o=t/e,s=t/2,a=[],l=[];for(let t=0,c=0,u=-s;t<=e;t++,u+=o){a.push(-s,0,u,s,0,u),a.push(u,0,-s,u,0,s);const e=t===i?n:r;e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3}const c=new yl;c.setAttribute("position",new ll(a,3)),c.setAttribute("color",new ll(l,3)),super(c,new Pd({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Hg extends Fd{constructor(t=10,e=16,n=8,r=64,i=4473924,o=8947848){i=new Es(i),o=new Es(o);const s=[],a=[];for(let n=0;n<=e;n++){const r=n/e*(2*Math.PI),l=Math.sin(r)*t,c=Math.cos(r)*t;s.push(0,0,0),s.push(l,0,c);const u=1&n?i:o;a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(let e=0;e<=n;e++){const l=1&e?i:o,c=t-t/n*e;for(let t=0;t<r;t++){let e=t/r*(2*Math.PI),n=Math.sin(e)*c,i=Math.cos(e)*c;s.push(n,0,i),a.push(l.r,l.g,l.b),e=(t+1)/r*(2*Math.PI),n=Math.sin(e)*c,i=Math.cos(e)*c,s.push(n,0,i),a.push(l.r,l.g,l.b)}}const l=new yl;l.setAttribute("position",new ll(s,3)),l.setAttribute("color",new ll(a,3)),super(l,new Pd({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const Gg=new Ns,Vg=new Ns,jg=new Ns;class Wg extends Da{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);let r=new yl;r.setAttribute("position",new ll([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const i=new Pd({fog:!1,toneMapped:!1});this.lightPlane=new Bd(r,i),this.add(this.lightPlane),r=new yl,r.setAttribute("position",new ll([0,0,0,0,0,1],3)),this.targetLine=new Bd(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Gg.setFromMatrixPosition(this.light.matrixWorld),Vg.setFromMatrixPosition(this.light.target.matrixWorld),jg.subVectors(Vg,Gg),this.lightPlane.lookAt(Vg),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Vg),this.targetLine.scale.z=jg.length()}}const qg=new Ns,Kg=new Gl;class Xg extends Fd{constructor(t){const e=new yl,n=new Pd({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={},s=new Es(16755200),a=new Es(16711680),l=new Es(43775),c=new Es(16777215),u=new Es(3355443);function h(t,e,n){d(t,n),d(e,n)}function d(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}h("n1","n2",s),h("n2","n4",s),h("n4","n3",s),h("n3","n1",s),h("f1","f2",s),h("f2","f4",s),h("f4","f3",s),h("f3","f1",s),h("n1","f1",s),h("n2","f2",s),h("n3","f3",s),h("n4","f4",s),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),e.setAttribute("position",new ll(r,3)),e.setAttribute("color",new ll(i,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const t=this.geometry,e=this.pointMap;Kg.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Yg("c",e,t,Kg,0,0,-1),Yg("t",e,t,Kg,0,0,1),Yg("n1",e,t,Kg,-1,-1,-1),Yg("n2",e,t,Kg,1,-1,-1),Yg("n3",e,t,Kg,-1,1,-1),Yg("n4",e,t,Kg,1,1,-1),Yg("f1",e,t,Kg,-1,-1,1),Yg("f2",e,t,Kg,1,-1,1),Yg("f3",e,t,Kg,-1,1,1),Yg("f4",e,t,Kg,1,1,1),Yg("u1",e,t,Kg,.7,1.1,-1),Yg("u2",e,t,Kg,-.7,1.1,-1),Yg("u3",e,t,Kg,0,2,-1),Yg("cf1",e,t,Kg,-1,0,1),Yg("cf2",e,t,Kg,1,0,1),Yg("cf3",e,t,Kg,0,-1,1),Yg("cf4",e,t,Kg,0,1,1),Yg("cn1",e,t,Kg,-1,0,-1),Yg("cn2",e,t,Kg,1,0,-1),Yg("cn3",e,t,Kg,0,-1,-1),Yg("cn4",e,t,Kg,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Yg(t,e,n,r,i,o,s){qg.set(i,o,s).unproject(r);const a=e[t];if(void 0!==a){const t=n.getAttribute("position");for(let e=0,n=a.length;e<n;e++)t.setXYZ(a[e],qg.x,qg.y,qg.z)}}const Jg=new Bs;class Zg extends Fd{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new yl;i.setIndex(new $a(n,1)),i.setAttribute("position",new $a(r,3)),super(i,new Pd({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Jg.setFromObject(this.object),Jg.isEmpty())return;const e=Jg.min,n=Jg.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t){return Fd.prototype.copy.call(this,t),this.object=t.object,this}}class Qg extends Fd{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new yl;r.setIndex(new $a(n,1)),r.setAttribute("position",new ll([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new Pd({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class $g extends Bd{constructor(t,e=1,n=16776960){const r=n,i=new yl;i.setAttribute("position",new ll([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),super(i,new Pd({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const o=new yl;o.setAttribute("position",new ll([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new kl(o,new Ja({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?tr:$n,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const ty=new Ns;let ey,ny;class ry extends Da{constructor(t=new Ns(0,0,1),e=new Ns(0,0,0),n=1,r=16776960,i=.2*n,o=.2*i){super(),this.type="ArrowHelper",void 0===ey&&(ey=new yl,ey.setAttribute("position",new ll([0,0,0,0,1,0],3)),ny=new tp(0,.5,1,5,1),ny.translate(0,-.5,0)),this.position.copy(e),this.line=new Bd(ey,new Pd({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new kl(ny,new Ja({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{ty.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(ty,e)}}setLength(t,e=.2*t,n=.2*e){this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class iy extends Fd{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new yl;n.setAttribute("position",new ll(e,3)),n.setAttribute("color",new ll([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new Pd({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,n){const r=new Es,i=this.geometry.attributes.color.array;return r.set(t),r.toArray(i,0),r.toArray(i,3),r.set(e),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class oy{constructor(){this.type="ShapePath",this.color=new Es,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new Cp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this}bezierCurveTo(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,e){function n(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n],i=new Pp;i.curves=r.curves,e.push(i)}return e}function r(t,e){const n=e.length;let r=!1;for(let i=n-1,o=0;o<n;i=o++){let n=e[i],s=e[o],a=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[o],a=-a,s=e[i],l=-l),t.y<n.y||t.y>s.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-a*(t.y-n.y);if(0===e)return!0;if(e<0)continue;r=!r}}else{if(t.y!==n.y)continue;if(s.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=s.x)return!0}}return r}const i=nf.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);let s,a,l;const c=[];if(1===o.length)return a=o[0],l=new Pp,l.curves=a.curves,c.push(l),c;let u=!i(o[0].getPoints());u=t?!u:u;const h=[],d=[];let p,f,m=[],g=0;d[g]=void 0,m[g]=[];for(let e=0,n=o.length;e<n;e++)a=o[e],p=a.getPoints(),s=i(p),s=t?!s:s,s?(!u&&d[g]&&g++,d[g]={s:new Pp,p},d[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:p[0]});if(!d[0])return n(o);if(d.length>1){let t=!1;const e=[];for(let t=0,e=d.length;t<e;t++)h[t]=[];for(let n=0,i=d.length;n<i;n++){const i=m[n];for(let o=0;o<i.length;o++){const s=i[o];let a=!0;for(let i=0;i<d.length;i++)r(s.p,d[i].p)&&(n!==i&&e.push({froms:n,tos:i,hole:o}),a?(a=!1,h[i].push(s)):t=!0);a&&h[n].push(s)}}e.length>0&&(t||(m=h))}for(let t=0,e=d.length;t<e;t++){l=d[t].s,c.push(l),f=m[t];for(let t=0,e=f.length;t<e;t++)l.holes.push(f[t].h)}return c}}const sy=new Float32Array(1),ay=new Int32Array(sy.buffer);class ly{static toHalfFloat(t){t>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),t=65504),sy[0]=t;const e=ay[0];let n=e>>16&32768,r=e>>12&2047;const i=e>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&e,n):i<113?(r|=2048,n|=(r>>114-i)+(r>>113-i&1),n):(n|=i-112<<10|r>>1,n+=1&r,n)}}const cy=0,uy=1,hy=0,dy=1,py=2;function fy(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function my(t=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function gy(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Kd(t,e)}function yy(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new cd(t)}function vy(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Kd(t,e)}function _y(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Gd(t)}function wy(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Gd(t)}function by(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Gd(t)}function xy(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ns(t,e,n)}function Ey(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new $a(t,e).setUsage(Ho)}function Sy(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new tl(t,e)}function My(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new el(t,e)}function Ty(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new nl(t,e)}function Ay(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new rl(t,e)}function Ry(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new il(t,e)}function Ly(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new ol(t,e)}function Cy(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new sl(t,e)}function Py(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new ll(t,e)}function Iy(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new cl(t,e)}function Oy(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new iy(t)}function Ny(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Zg(t,e)}function ky(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Fd(new lp(t.geometry),new Pd({color:void 0!==e?e:16777215}))}function Dy(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Fd(new vf(t.geometry),new Pd({color:void 0!==e?e:16777215}))}function By(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Zf(t)}function Uy(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new nm(t)}function zy(t,e,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Kl(t,n)}function Fy(){console.error("THREE.CanvasRenderer has been removed")}function Hy(){console.error("THREE.JSONLoader has been removed.")}cp.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(cp.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Cp.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},Fg.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Og.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Yf.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Sm.extractUrlBase(t)},Yf.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Sg.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},Sg.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Sg.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Sg.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},Bs.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Bs.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Bs.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Bs.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Bs.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},na.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},tc.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Ag.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ds.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},ds.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},ds.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ds.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},ds.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ds.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},ha.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},ha.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},ha.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Ns).setFromMatrixColumn(this,3)},ha.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},ha.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},ha.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},ha.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},ha.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},ha.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},ha.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},ha.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},ha.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},ha.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},ha.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},ha.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},ha.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},ha.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},ha.prototype.makeFrustum=function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)},ha.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Zl.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Os.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Os.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},ua.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},ua.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},ua.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Ka.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Ka.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},Ka.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},Ka.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},Ka.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},Ka.barycoordFromPoint=function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ka.getBarycoord(t,e,n,r,i)},Ka.normal=function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ka.getNormal(t,e,n,r)},Pp.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},Pp.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new sf(this,t)},Pp.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new df(this,t)},hs.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},hs.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},hs.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ns.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Ns.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Ns.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},Ns.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},Ns.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},Ns.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},Ns.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Ns.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Ns.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ls.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Ls.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Da.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},Da.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Da.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},Da.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Da.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Da.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),kl.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(kl.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),mo},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),_d.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Vl.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(im.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties($a.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ho},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ho)}}}),$a.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Ho:Fo),this},$a.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},$a.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},yl.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},yl.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new $a(arguments[1],arguments[2])))},yl.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},yl.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},yl.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},yl.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},yl.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(yl.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),qh.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Ho:Fo),this},qh.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},sf.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},sf.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},sf.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Wh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},mg.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Ya.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Es}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===nr}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Hl.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Hh.prototype.clearTarget=function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},Hh.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},Hh.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Hh.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Hh.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Hh.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Hh.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Hh.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Hh.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Hh.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Hh.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Hh.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Hh.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Hh.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Hh.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},Hh.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Hh.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Hh.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Hh.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Hh.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Hh.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Hh.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Hh.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Hh.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Hh.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Hh.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?_o:vo}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(Ch.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Cs.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Xm.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Nm).load(t,(function(t){e.setBuffer(t)})),this},tg.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Wl.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},Wl.prototype.clear=function(t,e,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,r)},Ms.crossOrigin=void 0,Ms.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new rm;i.setCrossOrigin(this.crossOrigin);const o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Ms.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new em;i.setCrossOrigin(this.crossOrigin);const o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Ms.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ms.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Gy={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Vy(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function jy(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new yl}function Wy(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new yl}function qy(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function Ky(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function Xy(){console.error("THREE.ImmediateRenderObject has been removed.")}function Yy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jy(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Gn}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Gn);var Zy,Qy,$y,tv,ev,nv,rv,iv,ov,sv,av,lv,cv,uv={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},hv={duration:.5,overwrite:!1,delay:0},dv=1e8,pv=1e-8,fv=2*Math.PI,mv=fv/4,gv=0,yv=Math.sqrt,vv=Math.cos,_v=Math.sin,wv=function(t){return"string"==typeof t},bv=function(t){return"function"==typeof t},xv=function(t){return"number"==typeof t},Ev=function(t){return void 0===t},Sv=function(t){return"object"==typeof t},Mv=function(t){return!1!==t},Tv=function(){return"undefined"!=typeof window},Av=function(t){return bv(t)||wv(t)},Rv="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Lv=Array.isArray,Cv=/(?:-?\.?\d|\.)+/gi,Pv=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Iv=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ov=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Nv=/[+-]=-?[.\d]+/,kv=/[^,'"\[\]\s]+/gi,Dv=/[\d.+\-=]+(?:e[-+]\d*)*/i,Bv={},Uv={},zv=function(t){return(Uv=u_(t,Bv))&&Jw},Fv=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Hv=function(t,e){return!e&&console.warn(t)},Gv=function(t,e){return t&&(Bv[t]=e)&&Uv&&(Uv[t]=e)||Bv},Vv=function(){return 0},jv={},Wv=[],qv={},Kv={},Xv={},Yv=30,Jv=[],Zv="",Qv=function(t){var e,n,r=t[0];if(Sv(r)||bv(r)||(t=[t]),!(e=(r._gsap||{}).harness)){for(n=Jv.length;n--&&!Jv[n].targetTest(r););e=Jv[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new bw(t[n],e)))||t.splice(n,1);return t},$v=function(t){return t._gsap||Qv(F_(t))[0]._gsap},t_=function(t,e,n){return(n=t[e])&&bv(n)?t[e]():Ev(n)&&t.getAttribute&&t.getAttribute(e)||n},e_=function(t,e){return(t=t.split(",")).forEach(e)||t},n_=function(t){return Math.round(1e5*t)/1e5||0},r_=function(t,e){for(var n=e.length,r=0;t.indexOf(e[r])<0&&++r<n;);return r<n},i_=function(){var t,e,n=Wv.length,r=Wv.slice(0);for(qv={},Wv.length=0,t=0;t<n;t++)(e=r[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},o_=function(t,e,n,r){Wv.length&&i_(),t.render(e,n,r),Wv.length&&i_()},s_=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(kv).length<2?e:wv(t)?t.trim():t},a_=function(t){return t},l_=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},c_=function(t,e){for(var n in e)n in t||"duration"===n||"ease"===n||(t[n]=e[n])},u_=function(t,e){for(var n in e)t[n]=e[n];return t},h_=function t(e,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(e[r]=Sv(n[r])?t(e[r]||(e[r]={}),n[r]):n[r]);return e},d_=function(t,e){var n,r={};for(n in t)n in e||(r[n]=t[n]);return r},p_=function(t){var e=t.parent||Qy,n=t.keyframes?c_:l_;if(Mv(t.inherit))for(;e;)n(t,e.vars.defaults),e=e.parent||e._dp;return t},f_=function(t,e,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=e._prev,o=e._next;i?i._next=o:t[n]===e&&(t[n]=o),o?o._prev=i:t[r]===e&&(t[r]=i),e._next=e._prev=e.parent=null},m_=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},g_=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},y_=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},v_=function t(e){return!e||e._ts&&t(e.parent)},__=function(t){return t._repeat?w_(t._tTime,t=t.duration()+t._rDelay)*t:0},w_=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},b_=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},x_=function(t){return t._end=n_(t._start+(t._tDur/Math.abs(t._ts||t._rts||pv)||0))},E_=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=n_(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),x_(t),n._dirty||g_(n,t)),t},S_=function(t,e){var n;if((e._time||e._initted&&!e._dur)&&(n=b_(t.rawTime(),e),(!e._dur||D_(0,e.totalDuration(),n)-e._tTime>pv)&&e.render(n,!0)),g_(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},M_=function(t,e,n,r){return e.parent&&m_(e),e._start=n_((xv(n)?n:n||t!==Qy?O_(t,n,e):t._time)+e._delay),e._end=n_(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),function(t,e,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var o,s=t[r];if(i)for(o=e[i];s&&s[i]>o;)s=s._prev;s?(e._next=s._next,s._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[r]=e,e._prev=s,e.parent=e._dp=t}(t,e,"_first","_last",t._sort?"_start":0),L_(e)||(t._recent=e),r||S_(t,e),t},T_=function(t,e){return(Bv.ScrollTrigger||Fv("scrollTrigger",e))&&Bv.ScrollTrigger.create(e,t)},A_=function(t,e,n,r){return Rw(t,e),t._initted?!n&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&rv!==lw.frame?(Wv.push(t),t._lazy=[e,r],1):void 0:1},R_=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},L_=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},C_=function(t,e,n,r){var i=t._repeat,o=n_(e)||0,s=t._tTime/t._tDur;return s&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=i?i<0?1e10:n_(o*(i+1)+t._rDelay*i):o,s&&!r?E_(t,t._tTime=t._tDur*s):t.parent&&x_(t),n||g_(t.parent,t),t},P_=function(t){return t instanceof Ew?g_(t):C_(t,t._dur)},I_={_start:0,endTime:Vv,totalDuration:Vv},O_=function t(e,n,r){var i,o,s,a=e.labels,l=e._recent||I_,c=e.duration()>=dv?l.endTime(!1):e._dur;return wv(n)&&(isNaN(n)||n in a)?(o=n.charAt(0),s="%"===n.substr(-1),i=n.indexOf("="),"<"===o||">"===o?(i>=0&&(n=n.replace(/=/,"")),("<"===o?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(s?(i<0?l:r).totalDuration()/100:1)):i<0?(n in a||(a[n]=c),a[n]):(o=parseFloat(n.charAt(i-1)+n.substr(i+1)),s&&r&&(o=o/100*(Lv(r)?r[0]:r).totalDuration()),i>1?t(e,n.substr(0,i-1),r)+o:c+o)):null==n?c:+n},N_=function(t,e,n){var r,i,o=xv(e[1]),s=(o?2:1)+(t<2?0:1),a=e[s];if(o&&(a.duration=e[1]),a.parent=n,t){for(r=a,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=Mv(i.vars.inherit)&&i.parent;a.immediateRender=Mv(r.immediateRender),t<2?a.runBackwards=1:a.startAt=e[s-1]}return new Iw(e[0],a,e[s+1])},k_=function(t,e){return t||0===t?e(t):e},D_=function(t,e,n){return n<t?t:n>e?e:n},B_=function(t){if("string"!=typeof t)return"";var e=Dv.exec(t);return e?t.substr(e.index+e[0].length):""},U_=[].slice,z_=function(t,e){return t&&Sv(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Sv(t[0]))&&!t.nodeType&&t!==$y},F_=function(t,e,n){return!wv(t)||n||!tv&&cw()?Lv(t)?function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var r;return wv(t)&&!e||z_(t,1)?(r=n).push.apply(r,F_(t)):n.push(t)}))||n}(t,n):z_(t)?U_.call(t,0):t?[t]:[]:U_.call((e||ev).querySelectorAll(t),0)},H_=function(t){return t.sort((function(){return.5-Math.random()}))},G_=function(t){if(bv(t))return t;var e=Sv(t)?t:{each:t},n=gw(e.ease),r=e.from||0,i=parseFloat(e.base)||0,o={},s=r>0&&r<1,a=isNaN(r)||s,l=e.axis,c=r,u=r;return wv(r)?c=u={center:.5,edges:.5,end:1}[r]||0:!s&&a&&(c=r[0],u=r[1]),function(t,s,h){var d,p,f,m,g,y,v,_,w,b=(h||e).length,x=o[b];if(!x){if(!(w="auto"===e.grid?0:(e.grid||[1,dv])[1])){for(v=-dv;v<(v=h[w++].getBoundingClientRect().left)&&w<b;);w--}for(x=o[b]=[],d=a?Math.min(w,b)*c-.5:r%w,p=a?b*u/w-.5:r/w|0,v=0,_=dv,y=0;y<b;y++)f=y%w-d,m=p-(y/w|0),x[y]=g=l?Math.abs("y"===l?m:f):yv(f*f+m*m),g>v&&(v=g),g<_&&(_=g);"random"===r&&H_(x),x.max=v-_,x.min=_,x.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(w>b?b-1:l?"y"===l?b/w:w:Math.max(w,b/w))||0)*("edges"===r?-1:1),x.b=b<0?i-b:i,x.u=B_(e.amount||e.each)||0,n=n&&b<0?fw(n):n}return b=(x[t]-x.min)/x.max||0,n_(x.b+(n?n(b):b)*x.v)+x.u}},V_=function(t){var e=t<1?Math.pow(10,(t+"").length-2):1;return function(n){var r=Math.round(parseFloat(n)/t)*t*e;return(r-r%1)/e+(xv(n)?0:B_(n))}},j_=function(t,e){var n,r,i=Lv(t);return!i&&Sv(t)&&(n=i=t.radius||dv,t.values?(t=F_(t.values),(r=!xv(t[0]))&&(n*=n)):t=V_(t.increment)),k_(e,i?bv(t)?function(e){return r=t(e),Math.abs(r-e)<=n?r:e}:function(e){for(var i,o,s=parseFloat(r?e.x:e),a=parseFloat(r?e.y:0),l=dv,c=0,u=t.length;u--;)(i=r?(i=t[u].x-s)*i+(o=t[u].y-a)*o:Math.abs(t[u]-s))<l&&(l=i,c=u);return c=!n||l<=n?t[c]:e,r||c===e||xv(e)?c:c+B_(e)}:V_(t))},W_=function(t,e,n,r){return k_(Lv(t)?!e:!0===n?!!(n=0):!r,(function(){return Lv(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*r)/r}))},q_=function(t,e,n){return k_(n,(function(n){return t[~~e(n)]}))},K_=function(t){for(var e,n,r,i,o=0,s="";~(e=t.indexOf("random(",o));)r=t.indexOf(")",e),i="["===t.charAt(e+7),n=t.substr(e+7,r-e-7).match(i?kv:Cv),s+=t.substr(o,e-o)+W_(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),o=r+1;return s+t.substr(o,t.length-o)},X_=function(t,e,n,r,i){var o=e-t,s=r-n;return k_(i,(function(e){return n+((e-t)/o*s||0)}))},Y_=function(t,e,n){var r,i,o,s=t.labels,a=dv;for(r in s)(i=s[r]-e)<0==!!n&&i&&a>(i=Math.abs(i))&&(o=r,a=i);return o},J_=function(t,e,n){var r,i,o=t.vars,s=o[e];if(s)return r=o[e+"Params"],i=o.callbackScope||t,n&&Wv.length&&i_(),r?s.apply(i,r):s.call(i)},Z_=function(t){return m_(t),t.scrollTrigger&&t.scrollTrigger.kill(!1),t.progress()<1&&J_(t,"onInterrupt"),t},Q_=function(t){var e=(t=!t.name&&t.default||t).name,n=bv(t),r=e&&!n&&t.init?function(){this._props=[]}:t,i={init:Vv,render:Hw,add:Tw,kill:Vw,modifier:Gw,rawVars:0},o={targetTest:0,get:0,getSetter:Bw,aliases:{},register:0};if(cw(),t!==r){if(Kv[e])return;l_(r,l_(d_(t,i),o)),u_(r.prototype,u_(i,d_(t,o))),Kv[r.prop=e]=r,t.targetTest&&(Jv.push(r),jv[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Gv(e,r),t.register&&t.register(Jw,r,qw)},$_=255,tw={aqua:[0,$_,$_],lime:[0,$_,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,$_],navy:[0,0,128],white:[$_,$_,$_],olive:[128,128,0],yellow:[$_,$_,0],orange:[$_,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[$_,0,0],pink:[$_,192,203],cyan:[0,$_,$_],transparent:[$_,$_,$_,0]},ew=function(t,e,n){return(6*(t=t<0?t+1:t>1?t-1:t)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*$_+.5|0},nw=function(t,e,n){var r,i,o,s,a,l,c,u,h,d,p=t?xv(t)?[t>>16,t>>8&$_,t&$_]:0:tw.black;if(!p){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),tw[t])p=tw[t];else if("#"===t.charAt(0)){if(t.length<6&&(r=t.charAt(1),i=t.charAt(2),o=t.charAt(3),t="#"+r+r+i+i+o+o+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(p=parseInt(t.substr(1,6),16))>>16,p>>8&$_,p&$_,parseInt(t.substr(7),16)/255];p=[(t=parseInt(t.substr(1),16))>>16,t>>8&$_,t&$_]}else if("hsl"===t.substr(0,3))if(p=d=t.match(Cv),e){if(~t.indexOf("="))return p=t.match(Pv),n&&p.length<4&&(p[3]=1),p}else s=+p[0]%360/360,a=+p[1]/100,r=2*(l=+p[2]/100)-(i=l<=.5?l*(a+1):l+a-l*a),p.length>3&&(p[3]*=1),p[0]=ew(s+1/3,r,i),p[1]=ew(s,r,i),p[2]=ew(s-1/3,r,i);else p=t.match(Cv)||tw.transparent;p=p.map(Number)}return e&&!d&&(r=p[0]/$_,i=p[1]/$_,o=p[2]/$_,l=((c=Math.max(r,i,o))+(u=Math.min(r,i,o)))/2,c===u?s=a=0:(h=c-u,a=l>.5?h/(2-c-u):h/(c+u),s=c===r?(i-o)/h+(i<o?6:0):c===i?(o-r)/h+2:(r-i)/h+4,s*=60),p[0]=~~(s+.5),p[1]=~~(100*a+.5),p[2]=~~(100*l+.5)),n&&p.length<4&&(p[3]=1),p},rw=function(t){var e=[],n=[],r=-1;return t.split(ow).forEach((function(t){var i=t.match(Iv)||[];e.push.apply(e,i),n.push(r+=i.length+1)})),e.c=n,e},iw=function(t,e,n){var r,i,o,s,a="",l=(t+a).match(ow),c=e?"hsla(":"rgba(",u=0;if(!l)return t;if(l=l.map((function(t){return(t=nw(t,e,1))&&c+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),n&&(o=rw(t),(r=n.c).join(a)!==o.c.join(a)))for(s=(i=t.replace(ow,"1").split(Iv)).length-1;u<s;u++)a+=i[u]+(~r.indexOf(u)?l.shift()||c+"0,0,0,0)":(o.length?o:l.length?l:n).shift());if(!i)for(s=(i=t.split(ow)).length-1;u<s;u++)a+=i[u]+l[u];return a+i[s]},ow=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in tw)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),sw=/hsl[a]?\(/,aw=function(t){var e,n=t.join(" ");if(ow.lastIndex=0,ow.test(n))return e=sw.test(n),t[1]=iw(t[1],e),t[0]=iw(t[0],e,rw(t[1])),!0},lw=function(){var t,e,n,r,i,o,s=Date.now,a=500,l=33,c=s(),u=c,h=1e3/240,d=h,p=[],f=function n(f){var m,g,y,v,_=s()-u,w=!0===f;if(_>a&&(c+=_-l),((m=(y=(u+=_)-c)-d)>0||w)&&(v=++r.frame,i=y-1e3*r.time,r.time=y/=1e3,d+=m+(m>=h?4:h-m),g=1),w||(t=e(n)),g)for(o=0;o<p.length;o++)p[o](y,i,v,f)};return r={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(t){return i/(1e3/(t||60))},wake:function(){nv&&(!tv&&Tv()&&($y=tv=window,ev=$y.document||{},Bv.gsap=Jw,($y.gsapVersions||($y.gsapVersions=[])).push(Jw.version),zv(Uv||$y.GreenSockGlobals||!$y.gsap&&$y||{}),n=$y.requestAnimationFrame),t&&r.sleep(),e=n||function(t){return setTimeout(t,d-1e3*r.time+1|0)},ov=1,f(2))},sleep:function(){(n?$y.cancelAnimationFrame:clearTimeout)(t),ov=0,e=Vv},lagSmoothing:function(t,e){a=t||1e8,l=Math.min(e,a,0)},fps:function(t){h=1e3/(t||240),d=1e3*r.time+h},add:function(t){p.indexOf(t)<0&&p.push(t),cw()},remove:function(t){var e;~(e=p.indexOf(t))&&p.splice(e,1)&&o>=e&&o--},_listeners:p}}(),cw=function(){return!ov&&lw.wake()},uw={},hw=/^[\d.\-M][\d.\-,\s]/,dw=/["']/g,pw=function(t){for(var e,n,r,i={},o=t.substr(1,t.length-3).split(":"),s=o[0],a=1,l=o.length;a<l;a++)n=o[a],e=a!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,e),i[s]=isNaN(r)?r.replace(dw,"").trim():+r,s=n.substr(e+1).trim();return i},fw=function(t){return function(e){return 1-t(1-e)}},mw=function t(e,n){for(var r,i=e._first;i;)i instanceof Ew?t(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?t(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},gw=function(t,e){return t&&(bv(t)?t:uw[t]||function(t){var e,n,r,i,o=(t+"").split("("),s=uw[o[0]];return s&&o.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[pw(o[1])]:(e=t,n=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",n),e.substring(n,~i&&i<r?e.indexOf(")",r+1):r)).split(",").map(s_)):uw._CE&&hw.test(t)?uw._CE("",t):s}(t))||e},yw=function(t,e,n,r){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===r&&(r=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var i,o={easeIn:e,easeOut:n,easeInOut:r};return e_(t,(function(t){for(var e in uw[t]=Bv[t]=o,uw[i=t.toLowerCase()]=n,o)uw[i+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=uw[t+"."+e]=o[e]})),o},vw=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},_w=function t(e,n,r){var i=n>=1?n:1,o=(r||(e?.3:.45))/(n<1?n:1),s=o/fv*(Math.asin(1/i)||0),a=function(t){return 1===t?1:i*Math.pow(2,-10*t)*_v((t-s)*o)+1},l="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:vw(a);return o=fv/o,l.config=function(n,r){return t(e,n,r)},l},ww=function t(e,n){void 0===n&&(n=1.70158);var r=function(t){return t?--t*t*((n+1)*t+n)+1:0},i="out"===e?r:"in"===e?function(t){return 1-r(1-t)}:vw(r);return i.config=function(n){return t(e,n)},i};e_("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;yw(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),uw.Linear.easeNone=uw.none=uw.Linear.easeIn,yw("Elastic",_w("in"),_w("out"),_w()),sv=7.5625,lv=1/(av=2.75),yw("Bounce",(function(t){return 1-cv(1-t)}),cv=function(t){return t<lv?sv*t*t:t<.7272727272727273?sv*Math.pow(t-1.5/av,2)+.75:t<.9090909090909092?sv*(t-=2.25/av)*t+.9375:sv*Math.pow(t-2.625/av,2)+.984375}),yw("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),yw("Circ",(function(t){return-(yv(1-t*t)-1)})),yw("Sine",(function(t){return 1===t?1:1-vv(t*mv)})),yw("Back",ww("in"),ww("out"),ww()),uw.SteppedEase=uw.steps=Bv.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,r=t+(e?0:1),i=e?1:0;return function(t){return((r*D_(0,.99999999,t)|0)+i)*n}}},hv.ease=uw["quad.out"],e_("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return Zv+=t+","+t+"Params,"}));var bw=function(t,e){this.id=gv++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:t_,this.set=e?e.getSetter:Bw},xw=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,C_(this,+t.duration,1,1),this.data=t.data,ov||lw.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,C_(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(cw(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(E_(this,t),!n._dp||n.parent||S_(n,this);n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&M_(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===pv||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),o_(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+__(this))%this._dur||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+__(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?w_(this._tTime,n)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?b_(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,y_(this.totalTime(D_(-this._delay,this._tDur,e),!0))},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(cw(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=pv)&&Math.abs(this._zTime)!==pv))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&M_(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(Mv(t)?this.totalDuration():this.duration())/Math.abs(this._ts)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?b_(e.rawTime(t),this):this._tTime:this._tTime},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(e._ts||1),e=e._dp;return n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,P_(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){return arguments.length?(this._rDelay=t,P_(this)):this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(O_(this,t),Mv(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,Mv(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-pv))},e.eventCallback=function(t,e,n){var r=this.vars;return arguments.length>1?(e?(r[t]=e,n&&(r[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete r[t],this):r[t]},e.then=function(t){var e=this;return new Promise((function(n){var r=bv(t)?t:a_,i=function(){var t=e.then;e.then=null,bv(r)&&(r=r(e))&&(r.then||r===e)&&(e.then=t),n(r),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?i():e._prom=i}))},e.kill=function(){Z_(this)},t}();l_(xw.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Ew=function(t){function e(e,n){var r;return void 0===e&&(e={}),(r=t.call(this,e)||this).labels={},r.smoothChildTiming=!!e.smoothChildTiming,r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=Mv(e.sortChildren),Qy&&M_(e.parent||Qy,Yy(r),n),e.reversed&&r.reverse(),e.paused&&r.paused(!0),e.scrollTrigger&&T_(Yy(r),e.scrollTrigger),r}Jy(e,t);var n=e.prototype;return n.to=function(t,e,n){return N_(0,arguments,this),this},n.from=function(t,e,n){return N_(1,arguments,this),this},n.fromTo=function(t,e,n,r){return N_(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,p_(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Iw(t,e,O_(this,n),1),this},n.call=function(t,e,n){return M_(this,Iw.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,r,i,o,s){return n.duration=e,n.stagger=n.stagger||r,n.onComplete=o,n.onCompleteParams=s,n.parent=this,new Iw(t,n,O_(this,i)),this},n.staggerFrom=function(t,e,n,r,i,o,s){return n.runBackwards=1,p_(n).immediateRender=Mv(n.immediateRender),this.staggerTo(t,e,n,r,i,o,s)},n.staggerFromTo=function(t,e,n,r,i,o,s,a){return r.startAt=n,p_(r).immediateRender=Mv(r.immediateRender),this.staggerTo(t,e,r,i,o,s,a)},n.render=function(t,e,n){var r,i,o,s,a,l,c,u,h,d,p,f,m=this._time,g=this._dirty?this.totalDuration():this._tDur,y=this._dur,v=this!==Qy&&t>g-pv&&t>=0?g:t<pv?0:t,_=this._zTime<0!=t<0&&(this._initted||!y);if(v!==this._tTime||n||_){if(m!==this._time&&y&&(v+=this._time-m,t+=this._time-m),r=v,h=this._start,l=!(u=this._ts),_&&(y||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(p=this._yoyo,a=y+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,n);if(r=n_(v%a),v===g?(s=this._repeat,r=y):((s=~~(v/a))&&s===v/a&&(r=y,s--),r>y&&(r=y)),d=w_(this._tTime,a),!m&&this._tTime&&d!==s&&(d=s),p&&1&s&&(r=y-r,f=1),s!==d&&!this._lock){var w=p&&1&d,b=w===(p&&1&s);if(s<d&&(w=!w),m=w?0:y,this._lock=1,this.render(m||(f?0:n_(s*a)),e,!y)._lock=0,this._tTime=v,!e&&this.parent&&J_(this,"onRepeat"),this.vars.repeatRefresh&&!f&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,g=this._tDur,b&&(this._lock=2,m=w?y:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!f&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;mw(this,f)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(t,e,n){var r;if(n>e)for(r=t._first;r&&r._start<=n;){if(!r._dur&&"isPause"===r.data&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=n;){if(!r._dur&&"isPause"===r.data&&r._start<e)return r;r=r._prev}}(this,n_(m),n_(r)),c&&(v-=r-(r=c._start))),this._tTime=v,this._time=r,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&r&&!e&&(J_(this,"onStart"),this._tTime!==v))return this;if(r>=m&&t>=0)for(i=this._first;i;){if(o=i._next,(i._act||r>=i._start)&&i._ts&&c!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!l){c=0,o&&(v+=this._zTime=-1e-8);break}}i=o}else{i=this._last;for(var x=t<0?t:r;i;){if(o=i._prev,(i._act||x<=i._end)&&i._ts&&c!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(x-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(x-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!l){c=0,o&&(v+=this._zTime=x?-1e-8:pv);break}}i=o}}if(c&&!e&&(this.pause(),c.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=h,x_(this),this.render(t,e,n);this._onUpdate&&!e&&J_(this,"onUpdate",!0),(v===g&&g>=this.totalDuration()||!v&&m)&&(h!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((t||!y)&&(v===g&&this._ts>0||!v&&this._ts<0)&&m_(this,1),e||t<0&&!m||!v&&!m&&g||(J_(this,v===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(xv(e)||(e=O_(this,e,t)),!(t instanceof xw)){if(Lv(t))return t.forEach((function(t){return n.add(t,e)})),this;if(wv(t))return this.addLabel(t,e);if(!bv(t))return this;t=Iw.delayedCall(0,t)}return this!==t?M_(this,t,e):this},n.getChildren=function(t,e,n,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===r&&(r=-dv);for(var i=[],o=this._first;o;)o._start>=r&&(o instanceof Iw?e&&i.push(o):(n&&i.push(o),t&&i.push.apply(i,o.getChildren(!0,e,n)))),o=o._next;return i},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return wv(t)?this.removeLabel(t):bv(t)?this.killTweensOf(t):(f_(this,t),t===this._recent&&(this._recent=this._last),g_(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=n_(lw.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=O_(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var r=Iw.delayedCall(0,e||Vv,n);return r.data="isPause",this._hasPause=1,M_(this,r,O_(this,t))},n.removePause=function(t){var e=this._first;for(t=O_(this,t);e;)e._start===t&&"isPause"===e.data&&m_(e),e=e._next},n.killTweensOf=function(t,e,n){for(var r=this.getTweensOf(t,n),i=r.length;i--;)Sw!==r[i]&&r[i].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,r=[],i=F_(t),o=this._first,s=xv(e);o;)o instanceof Iw?r_(o._targets,i)&&(s?(!Sw||o._initted&&o._ts)&&o.globalTime(0)<=e&&o.globalTime(o.totalDuration())>e:!e||o.isActive())&&r.push(o):(n=o.getTweensOf(i,e)).length&&r.push.apply(r,n),o=o._next;return r},n.tweenTo=function(t,e){e=e||{};var n,r=this,i=O_(r,t),o=e,s=o.startAt,a=o.onStart,l=o.onStartParams,c=o.immediateRender,u=Iw.to(r,l_({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:e.duration||Math.abs((i-(s&&"time"in s?s.time:r._time))/r.timeScale())||pv,onStart:function(){if(r.pause(),!n){var t=e.duration||Math.abs((i-(s&&"time"in s?s.time:r._time))/r.timeScale());u._dur!==t&&C_(u,t,0,1).render(u._time,!0,!0),n=1}a&&a.apply(u,l||[])}},e));return c?u.render(0):u},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,l_({startAt:{time:O_(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),Y_(this,O_(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),Y_(this,O_(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+pv)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var r,i=this._first,o=this.labels;i;)i._start>=n&&(i._start+=t,i._end+=t),i=i._next;if(e)for(r in o)o[r]>=n&&(o[r]+=t);return g_(this)},n.invalidate=function(){var e=this._first;for(this._lock=0;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),g_(this)},n.totalDuration=function(t){var e,n,r,i=0,o=this,s=o._last,a=dv;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-t:t));if(o._dirty){for(r=o.parent;s;)e=s._prev,s._dirty&&s.totalDuration(),(n=s._start)>a&&o._sort&&s._ts&&!o._lock?(o._lock=1,M_(o,s,n-s._delay,1)._lock=0):a=n,n<0&&s._ts&&(i-=n,(!r&&!o._dp||r&&r.smoothChildTiming)&&(o._start+=n/o._ts,o._time-=n,o._tTime-=n),o.shiftChildren(-n,!1,-Infinity),a=0),s._end>i&&s._ts&&(i=s._end),s=e;C_(o,o===Qy&&o._time>i?o._time:i,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(t){if(Qy._ts&&(o_(Qy,b_(t,Qy)),rv=lw.frame),lw.frame>=Yv){Yv+=uv.autoSleep||120;var e=Qy._first;if((!e||!e._ts)&&uv.autoSleep&&lw._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||lw.sleep()}}},e}(xw);l_(Ew.prototype,{_lock:0,_hasPause:0,_forcing:0});var Sw,Mw=function(t,e,n,r,i,o,s){var a,l,c,u,h,d,p,f,m=new qw(this._pt,t,e,0,1,Fw,null,i),g=0,y=0;for(m.b=n,m.e=r,n+="",(p=~(r+="").indexOf("random("))&&(r=K_(r)),o&&(o(f=[n,r],t,e),n=f[0],r=f[1]),l=n.match(Ov)||[];a=Ov.exec(r);)u=a[0],h=r.substring(g,a.index),c?c=(c+1)%5:"rgba("===h.substr(-5)&&(c=1),u!==l[y++]&&(d=parseFloat(l[y-1])||0,m._pt={_next:m._pt,p:h||1===y?h:",",s:d,c:"="===u.charAt(1)?parseFloat(u.substr(2))*("-"===u.charAt(0)?-1:1):parseFloat(u)-d,m:c&&c<4?Math.round:0},g=Ov.lastIndex);return m.c=g<r.length?r.substring(g,r.length):"",m.fp=s,(Nv.test(r)||p)&&(m.e=0),this._pt=m,m},Tw=function(t,e,n,r,i,o,s,a,l){bv(r)&&(r=r(i||0,t,o));var c,u=t[e],h="get"!==n?n:bv(u)?l?t[e.indexOf("set")||!bv(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,d=bv(u)?l?kw:Nw:Ow;if(wv(r)&&(~r.indexOf("random(")&&(r=K_(r)),"="===r.charAt(1)&&((c=parseFloat(h)+parseFloat(r.substr(2))*("-"===r.charAt(0)?-1:1)+(B_(h)||0))||0===c)&&(r=c)),h!==r)return isNaN(h*r)||""===r?(!u&&!(e in t)&&Fv(e,r),Mw.call(this,t,e,h,r,d,a||uv.stringFilter,l)):(c=new qw(this._pt,t,e,+h||0,r-(h||0),"boolean"==typeof u?zw:Uw,0,d),l&&(c.fp=l),s&&c.modifier(s,this,t),this._pt=c)},Aw=function(t,e,n,r,i,o){var s,a,l,c;if(Kv[t]&&!1!==(s=new Kv[t]).init(i,s.rawVars?e[t]:function(t,e,n,r,i){if(bv(t)&&(t=Lw(t,i,e,n,r)),!Sv(t)||t.style&&t.nodeType||Lv(t)||Rv(t))return wv(t)?Lw(t,i,e,n,r):t;var o,s={};for(o in t)s[o]=Lw(t[o],i,e,n,r);return s}(e[t],r,i,o,n),n,r,o)&&(n._pt=a=new qw(n._pt,i,t,0,1,s.render,s,0,s.priority),n!==iv))for(l=n._ptLookup[n._targets.indexOf(i)],c=s._props.length;c--;)l[s._props[c]]=a;return s},Rw=function t(e,n){var r,i,o,s,a,l,c,u,h,d,p,f,m,g=e.vars,y=g.ease,v=g.startAt,_=g.immediateRender,w=g.lazy,b=g.onUpdate,x=g.onUpdateParams,E=g.callbackScope,S=g.runBackwards,M=g.yoyoEase,T=g.keyframes,A=g.autoRevert,R=e._dur,L=e._startAt,C=e._targets,P=e.parent,I=P&&"nested"===P.data?P.parent._targets:C,O="auto"===e._overwrite&&!Zy,N=e.timeline;if(N&&(!T||!y)&&(y="none"),e._ease=gw(y,hv.ease),e._yEase=M?fw(gw(!0===M?y:M,hv.ease)):0,M&&e._yoyo&&!e._repeat&&(M=e._yEase,e._yEase=e._ease,e._ease=M),e._from=!N&&!!g.runBackwards,!N){if(f=(u=C[0]?$v(C[0]).harness:0)&&g[u.prop],r=d_(g,jv),L&&L.render(-1,!0).kill(),v)if(m_(e._startAt=Iw.set(C,l_({data:"isStart",overwrite:!1,parent:P,immediateRender:!0,lazy:Mv(w),startAt:null,delay:0,onUpdate:b,onUpdateParams:x,callbackScope:E,stagger:0},v))),n<0&&!_&&!A&&e._startAt.render(-1,!0),_){if(n>0&&!A&&(e._startAt=0),R&&n<=0)return void(n&&(e._zTime=n))}else!1===A&&(e._startAt=0);else if(S&&R)if(L)!A&&(e._startAt=0);else if(n&&(_=!1),o=l_({overwrite:!1,data:"isFromStart",lazy:_&&Mv(w),immediateRender:_,stagger:0,parent:P},r),f&&(o[u.prop]=f),m_(e._startAt=Iw.set(C,o)),n<0&&e._startAt.render(-1,!0),_){if(!n)return}else t(e._startAt,pv);for(e._pt=0,w=R&&Mv(w)||w&&!R,i=0;i<C.length;i++){if(c=(a=C[i])._gsap||Qv(C)[i]._gsap,e._ptLookup[i]=d={},qv[c.id]&&Wv.length&&i_(),p=I===C?i:I.indexOf(a),u&&!1!==(h=new u).init(a,f||r,e,p,I)&&(e._pt=s=new qw(e._pt,a,h.name,0,1,h.render,h,0,h.priority),h._props.forEach((function(t){d[t]=s})),h.priority&&(l=1)),!u||f)for(o in r)Kv[o]&&(h=Aw(o,r,e,p,a,I))?h.priority&&(l=1):d[o]=s=Tw.call(e,a,o,"get",r[o],p,I,0,g.stringFilter);e._op&&e._op[i]&&e.kill(a,e._op[i]),O&&e._pt&&(Sw=e,Qy.killTweensOf(a,d,e.globalTime(0)),m=!e.parent,Sw=0),e._pt&&w&&(qv[c.id]=1)}l&&Ww(e),e._onInit&&e._onInit(e)}e._onUpdate=b,e._initted=(!e._op||e._pt)&&!m},Lw=function(t,e,n,r,i){return bv(t)?t.call(e,n,r,i):wv(t)&&~t.indexOf("random(")?K_(t):t},Cw=Zv+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Pw=(Cw+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Iw=function(t){function e(e,n,r,i){var o;"number"==typeof n&&(r.duration=n,n=r,r=null);var s,a,l,c,u,h,d,p,f=(o=t.call(this,i?n:p_(n))||this).vars,m=f.duration,g=f.delay,y=f.immediateRender,v=f.stagger,_=f.overwrite,w=f.keyframes,b=f.defaults,x=f.scrollTrigger,E=f.yoyoEase,S=n.parent||Qy,M=(Lv(e)||Rv(e)?xv(e[0]):"length"in n)?[e]:F_(e);if(o._targets=M.length?Qv(M):Hv("GSAP target "+e+" not found. https://greensock.com",!uv.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=_,w||v||Av(m)||Av(g)){if(n=o.vars,(s=o.timeline=new Ew({data:"nested",defaults:b||{}})).kill(),s.parent=s._dp=Yy(o),s._start=0,w)l_(s.vars.defaults,{ease:"none"}),v?M.forEach((function(t,e){return w.forEach((function(n,r){return s.to(t,n,r?">":e*v)}))})):w.forEach((function(t){return s.to(M,t,">")}));else{if(c=M.length,d=v?G_(v):Vv,Sv(v))for(u in v)~Cw.indexOf(u)&&(p||(p={}),p[u]=v[u]);for(a=0;a<c;a++){for(u in l={},n)Pw.indexOf(u)<0&&(l[u]=n[u]);l.stagger=0,E&&(l.yoyoEase=E),p&&u_(l,p),h=M[a],l.duration=+Lw(m,Yy(o),a,h,M),l.delay=(+Lw(g,Yy(o),a,h,M)||0)-o._delay,!v&&1===c&&l.delay&&(o._delay=g=l.delay,o._start+=g,l.delay=0),s.to(h,l,d(a,h,M))}s.duration()?m=g=0:o.timeline=0}m||o.duration(m=s.duration())}else o.timeline=0;return!0!==_||Zy||(Sw=Yy(o),Qy.killTweensOf(M),Sw=0),M_(S,Yy(o),r),n.reversed&&o.reverse(),n.paused&&o.paused(!0),(y||!m&&!w&&o._start===n_(S._time)&&Mv(y)&&v_(Yy(o))&&"nested"!==S.data)&&(o._tTime=-1e-8,o.render(Math.max(0,-g))),x&&T_(Yy(o),x),o}Jy(e,t);var n=e.prototype;return n.render=function(t,e,n){var r,i,o,s,a,l,c,u,h,d=this._time,p=this._tDur,f=this._dur,m=t>p-pv&&t>=0?p:t<pv?0:t;if(f){if(m!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=t<0){if(r=m,u=this.timeline,this._repeat){if(s=f+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*s+t,e,n);if(r=n_(m%s),m===p?(o=this._repeat,r=f):((o=~~(m/s))&&o===m/s&&(r=f,o--),r>f&&(r=f)),(l=this._yoyo&&1&o)&&(h=this._yEase,r=f-r),a=w_(this._tTime,s),r===d&&!n&&this._initted)return this;o!==a&&(u&&this._yEase&&mw(u,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(n_(s*o),!0).invalidate()._lock=0))}if(!this._initted){if(A_(this,t<0?t:r,n,e))return this._tTime=0,this;if(f!==this._dur)return this.render(t,e,n)}if(this._tTime=m,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(h||this._ease)(r/f),this._from&&(this.ratio=c=1-c),r&&!d&&!e&&J_(this,"onStart"),r&&!d&&!e&&(J_(this,"onStart"),this._tTime!==m))return this;for(i=this._pt;i;)i.r(c,i.d),i=i._next;u&&u.render(t<0?t:!r&&l?-1e-8:u._dur*c,e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(t<0&&this._startAt&&this._startAt.render(t,!0,n),J_(this,"onUpdate")),this._repeat&&o!==a&&this.vars.onRepeat&&!e&&this.parent&&J_(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,!0),(t||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&m_(this,1),e||t<0&&!d||!m&&!d||(J_(this,m===p?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,r){var i,o,s,a=t.ratio,l=e<0||!e&&(!t._start&&R_(t)&&(t._initted||!L_(t))||(t._ts<0||t._dp._ts<0)&&!L_(t))?0:1,c=t._rDelay,u=0;if(c&&t._repeat&&(u=D_(0,t._tDur,e),o=w_(u,c),s=w_(t._tTime,c),t._yoyo&&1&o&&(l=1-l),o!==s&&(a=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==a||r||t._zTime===pv||!e&&t._zTime){if(!t._initted&&A_(t,e,r,n))return;for(s=t._zTime,t._zTime=e||(n?pv:0),n||(n=e&&!s),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=u,i=t._pt;i;)i.r(l,i.d),i=i._next;t._startAt&&e<0&&t._startAt.render(e,!0,!0),t._onUpdate&&!n&&J_(t,"onUpdate"),u&&t._repeat&&!n&&t.parent&&J_(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&m_(t,1),n||(J_(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?Z_(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,Sw&&!0!==Sw.vars.overwrite)._first||Z_(this),this.parent&&n!==this.timeline.totalDuration()&&C_(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,o,s,a,l,c,u=this._targets,h=t?F_(t):u,d=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,r=n===e.length;r&&n--&&t[n]===e[n];);return n<0}(u,h))return"all"===e&&(this._pt=0),Z_(this);for(r=this._op=this._op||[],"all"!==e&&(wv(e)&&(a={},e_(e,(function(t){return a[t]=1})),e=a),e=function(t,e){var n,r,i,o,s=t[0]?$v(t[0]).harness:0,a=s&&s.aliases;if(!a)return e;for(r in n=u_({},e),a)if(r in n)for(i=(o=a[r].split(",")).length;i--;)n[o[i]]=n[r];return n}(u,e)),c=u.length;c--;)if(~h.indexOf(u[c]))for(a in i=d[c],"all"===e?(r[c]=e,s=i,o={}):(o=r[c]=r[c]||{},s=e),s)(l=i&&i[a])&&("kill"in l.d&&!0!==l.d.kill(a)||f_(this,l,"_pt"),delete i[a]),"all"!==o&&(o[a]=1);return this._initted&&!this._pt&&p&&Z_(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return N_(1,arguments)},e.delayedCall=function(t,n,r,i){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},e.fromTo=function(t,e,n){return N_(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return Qy.killTweensOf(t,e,n)},e}(xw);l_(Iw.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),e_("staggerTo,staggerFrom,staggerFromTo",(function(t){Iw[t]=function(){var e=new Ew,n=U_.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var Ow=function(t,e,n){return t[e]=n},Nw=function(t,e,n){return t[e](n)},kw=function(t,e,n,r){return t[e](r.fp,n)},Dw=function(t,e,n){return t.setAttribute(e,n)},Bw=function(t,e){return bv(t[e])?Nw:Ev(t[e])&&t.setAttribute?Dw:Ow},Uw=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},zw=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Fw=function(t,e){var n=e._pt,r="";if(!t&&e.b)r=e.b;else if(1===t&&e.e)r=e.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+r,n=n._next;r+=e.c}e.set(e.t,e.p,r,e)},Hw=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Gw=function(t,e,n,r){for(var i,o=this._pt;o;)i=o._next,o.p===r&&o.modifier(t,e,n),o=i},Vw=function(t){for(var e,n,r=this._pt;r;)n=r._next,r.p===t&&!r.op||r.op===t?f_(this,r,"_pt"):r.dep||(e=1),r=n;return!e},jw=function(t,e,n,r){r.mSet(t,e,r.m.call(r.tween,n,r.mt),r)},Ww=function(t){for(var e,n,r,i,o=t._pt;o;){for(e=o._next,n=r;n&&n.pr>o.pr;)n=n._next;(o._prev=n?n._prev:i)?o._prev._next=o:r=o,(o._next=n)?n._prev=o:i=o,o=e}t._pt=r},qw=function(){function t(t,e,n,r,i,o,s,a,l){this.t=e,this.s=r,this.c=i,this.p=n,this.r=o||Uw,this.d=s||this,this.set=a||Ow,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=jw,this.m=t,this.mt=n,this.tween=e},t}();e_(Zv+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return jv[t]=1})),Bv.TweenMax=Bv.TweenLite=Iw,Bv.TimelineLite=Bv.TimelineMax=Ew,Qy=new Ew({sortChildren:!1,defaults:hv,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),uv.stringFilter=aw;var Kw={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return Q_(t)}))},timeline:function(t){return new Ew(t)},getTweensOf:function(t,e){return Qy.getTweensOf(t,e)},getProperty:function(t,e,n,r){wv(t)&&(t=F_(t)[0]);var i=$v(t||{}).get,o=n?a_:s_;return"native"===n&&(n=""),t?e?o((Kv[e]&&Kv[e].get||i)(t,e,n,r)):function(e,n,r){return o((Kv[e]&&Kv[e].get||i)(t,e,n,r))}:t},quickSetter:function(t,e,n){if((t=F_(t)).length>1){var r=t.map((function(t){return Jw.quickSetter(t,e,n)})),i=r.length;return function(t){for(var e=i;e--;)r[e](t)}}t=t[0]||{};var o=Kv[e],s=$v(t),a=s.harness&&(s.harness.aliases||{})[e]||e,l=o?function(e){var r=new o;iv._pt=0,r.init(t,n?e+n:e,iv,0,[t]),r.render(1,r),iv._pt&&Hw(1,iv)}:s.set(t,a);return o?l:function(e){return l(t,a,n?e+n:e,s,1)}},isTweening:function(t){return Qy.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=gw(t.ease,hv.ease)),h_(hv,t||{})},config:function(t){return h_(uv,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,r=t.plugins,i=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach((function(t){return t&&!Kv[t]&&!Bv[t]&&Hv(e+" effect requires "+t+" plugin.")})),Xv[e]=function(t,e,r){return n(F_(t),l_(e||{},i),r)},o&&(Ew.prototype[e]=function(t,n,r){return this.add(Xv[e](t,Sv(n)?n:(r=n)&&{},this),r)})},registerEase:function(t,e){uw[t]=gw(e)},parseEase:function(t,e){return arguments.length?gw(t,e):uw},getById:function(t){return Qy.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,r,i=new Ew(t);for(i.smoothChildTiming=Mv(t.smoothChildTiming),Qy.remove(i),i._dp=0,i._time=i._tTime=Qy._time,n=Qy._first;n;)r=n._next,!e&&!n._dur&&n instanceof Iw&&n.vars.onComplete===n._targets[0]||M_(i,n,n._start-n._delay),n=r;return M_(Qy,i,0),i},utils:{wrap:function t(e,n,r){var i=n-e;return Lv(e)?q_(e,t(0,e.length),n):k_(r,(function(t){return(i+(t-e)%i)%i+e}))},wrapYoyo:function t(e,n,r){var i=n-e,o=2*i;return Lv(e)?q_(e,t(0,e.length-1),n):k_(r,(function(t){return e+((t=(o+(t-e)%o)%o||0)>i?o-t:t)}))},distribute:G_,random:W_,snap:j_,normalize:function(t,e,n){return X_(t,e,0,1,n)},getUnit:B_,clamp:function(t,e,n){return k_(n,(function(n){return D_(t,e,n)}))},splitColor:nw,toArray:F_,selector:function(t){return t=F_(t)[0]||Hv("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return F_(e,n.querySelectorAll?n:n===t?Hv("Invalid scope")||ev.createElement("div"):t)}},mapRange:X_,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||B_(n))}},interpolate:function t(e,n,r,i){var o=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!o){var s,a,l,c,u,h=wv(e),d={};if(!0===r&&(i=1)&&(r=null),h)e={p:e},n={p:n};else if(Lv(e)&&!Lv(n)){for(l=[],c=e.length,u=c-2,a=1;a<c;a++)l.push(t(e[a-1],e[a]));c--,o=function(t){t*=c;var e=Math.min(u,~~t);return l[e](t-e)},r=n}else i||(e=u_(Lv(e)?[]:{},e));if(!l){for(s in n)Tw.call(d,e,s,"get",n[s]);o=function(t){return Hw(t,d)||(h?e.p:e)}}}return k_(r,o)},shuffle:H_},install:zv,effects:Xv,ticker:lw,updateRoot:Ew.updateRoot,plugins:Kv,globalTimeline:Qy,core:{PropTween:qw,globals:Gv,Tween:Iw,Timeline:Ew,Animation:xw,getCache:$v,_removeLinkedListItem:f_,suppressOverwrites:function(t){return Zy=t}}};e_("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return Kw[t]=Iw[t]})),lw.add(Ew.updateRoot),iv=Kw.to({},{duration:0});var Xw=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Yw=function(t,e){return{name:t,rawVars:1,init:function(t,n,r){r._onInit=function(t){var r,i;if(wv(n)&&(r={},e_(n,(function(t){return r[t]=1})),n=r),e){for(i in r={},n)r[i]=e(n[i]);n=r}!function(t,e){var n,r,i,o=t._targets;for(n in e)for(r=o.length;r--;)(i=t._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=Xw(i,n)),i&&i.modifier&&i.modifier(e[n],t,o[r],n))}(t,n)}}}},Jw=Kw.registerPlugin({name:"attr",init:function(t,e,n,r,i){var o,s;for(o in e)(s=this.add(t,"setAttribute",(t.getAttribute(o)||0)+"",e[o],r,i,0,0,o))&&(s.op=o),this._props.push(o)}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n])}},Yw("roundProps",V_),Yw("modifiers"),Yw("snap",j_))||Kw;Iw.version=Ew.version=Jw.version="3.7.0",nv=1,Tv()&&cw(),uw.Power0,uw.Power1,uw.Power2,uw.Power3,uw.Power4,uw.Linear,uw.Quad,uw.Cubic,uw.Quart,uw.Quint,uw.Strong,uw.Elastic,uw.Back,uw.SteppedEase,uw.Bounce,uw.Sine,uw.Expo,uw.Circ;var Zw,Qw,$w,tb,eb,nb,rb,ib={},ob=180/Math.PI,sb=Math.PI/180,ab=Math.atan2,lb=/([A-Z])/g,cb=/(?:left|right|width|margin|padding|x)/i,ub=/[\s,\(]\S/,hb={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},db=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},pb=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},fb=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},mb=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},gb=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},yb=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},vb=function(t,e,n){return t.style[e]=n},_b=function(t,e,n){return t.style.setProperty(e,n)},wb=function(t,e,n){return t._gsap[e]=n},bb=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},xb=function(t,e,n,r,i){var o=t._gsap;o.scaleX=o.scaleY=n,o.renderTransform(i,o)},Eb=function(t,e,n,r,i){var o=t._gsap;o[e]=n,o.renderTransform(i,o)},Sb="transform",Mb=Sb+"Origin",Tb=function(t,e){var n=Qw.createElementNS?Qw.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Qw.createElement(t);return n.style?n:Qw.createElement(t)},Ab=function t(e,n,r){var i=getComputedStyle(e);return i[n]||i.getPropertyValue(n.replace(lb,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&t(e,Lb(n)||n,1)||""},Rb="O,Moz,ms,Ms,Webkit".split(","),Lb=function(t,e,n){var r=(e||eb).style,i=5;if(t in r&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);i--&&!(Rb[i]+t in r););return i<0?null:(3===i?"ms":i>=0?Rb[i]:"")+t},Cb=function(){"undefined"!=typeof window&&window.document&&(Zw=window,Qw=Zw.document,$w=Qw.documentElement,eb=Tb("div")||{style:{}},Tb("div"),Sb=Lb(Sb),Mb=Sb+"Origin",eb.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",rb=!!Lb("perspective"),tb=1)},Pb=function t(e){var n,r=Tb("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,o=this.nextSibling,s=this.style.cssText;if($w.appendChild(r),r.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(t){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(o?i.insertBefore(this,o):i.appendChild(this)),$w.removeChild(r),this.style.cssText=s,n},Ib=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Ob=function(t){var e;try{e=t.getBBox()}catch(n){e=Pb.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Pb||(e=Pb.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+Ib(t,["x","cx","x1"])||0,y:+Ib(t,["y","cy","y1"])||0,width:0,height:0}},Nb=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Ob(t))},kb=function(t,e){if(e){var n=t.style;e in ib&&e!==Mb&&(e=Sb),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(lb,"-$1").toLowerCase())):n.removeAttribute(e)}},Db=function(t,e,n,r,i,o){var s=new qw(t._pt,e,n,0,1,o?yb:gb);return t._pt=s,s.b=r,s.e=i,t._props.push(n),s},Bb={deg:1,rad:1,turn:1},Ub=function t(e,n,r,i){var o,s,a,l,c=parseFloat(r)||0,u=(r+"").trim().substr((c+"").length)||"px",h=eb.style,d=cb.test(n),p="svg"===e.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===i,y="%"===i;return i===u||!c||Bb[i]||Bb[u]?c:("px"!==u&&!g&&(c=t(e,n,r,"px")),l=e.getCTM&&Nb(e),!y&&"%"!==u||!ib[n]&&!~n.indexOf("adius")?(h[d?"width":"height"]=m+(g?u:i),s=~n.indexOf("adius")||"em"===i&&e.appendChild&&!p?e:e.parentNode,l&&(s=(e.ownerSVGElement||{}).parentNode),s&&s!==Qw&&s.appendChild||(s=Qw.body),(a=s._gsap)&&y&&a.width&&d&&a.time===lw.time?n_(c/a.width*m):((y||"%"===u)&&(h.position=Ab(e,"position")),s===e&&(h.position="static"),s.appendChild(eb),o=eb[f],s.removeChild(eb),h.position="absolute",d&&y&&((a=$v(s)).time=lw.time,a.width=s[f]),n_(g?o*c/m:o&&c?m/o*c:0))):(o=l?e.getBBox()[d?"width":"height"]:e[f],n_(y?c/o*m:c/100*o)))},zb=function(t,e,n,r){var i;return tb||Cb(),e in hb&&"transform"!==e&&~(e=hb[e]).indexOf(",")&&(e=e.split(",")[0]),ib[e]&&"transform"!==e?(i=Jb(t,r),i="transformOrigin"!==e?i[e]:i.svg?i.origin:Zb(Ab(t,Mb))+" "+i.zOrigin+"px"):(!(i=t.style[e])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=Vb[e]&&Vb[e](t,e,n)||Ab(t,e)||t_(t,e)||("opacity"===e?1:0)),n&&!~(i+"").trim().indexOf(" ")?Ub(t,e,i,n)+n:i},Fb=function(t,e,n,r){if(!n||"none"===n){var i=Lb(e,t,1),o=i&&Ab(t,i,1);o&&o!==n?(e=i,n=o):"borderColor"===e&&(n=Ab(t,"borderTopColor"))}var s,a,l,c,u,h,d,p,f,m,g,y,v=new qw(this._pt,t.style,e,0,1,Fw),_=0,w=0;if(v.b=n,v.e=r,n+="","auto"==(r+="")&&(t.style[e]=r,r=Ab(t,e)||r,t.style[e]=n),aw(s=[n,r]),r=s[1],l=(n=s[0]).match(Iv)||[],(r.match(Iv)||[]).length){for(;a=Iv.exec(r);)d=a[0],f=r.substring(_,a.index),u?u=(u+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(u=1),d!==(h=l[w++]||"")&&(c=parseFloat(h)||0,g=h.substr((c+"").length),(y="="===d.charAt(1)?+(d.charAt(0)+"1"):0)&&(d=d.substr(2)),p=parseFloat(d),m=d.substr((p+"").length),_=Iv.lastIndex-m.length,m||(m=m||uv.units[e]||g,_===r.length&&(r+=m,v.e+=m)),g!==m&&(c=Ub(t,e,h,m)||0),v._pt={_next:v._pt,p:f||1===w?f:",",s:c,c:y?y*p:p-c,m:u&&u<4||"zIndex"===e?Math.round:0});v.c=_<r.length?r.substring(_,r.length):""}else v.r="display"===e&&"none"===r?yb:gb;return Nv.test(r)&&(v.e=0),this._pt=v,v},Hb={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Gb=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,r,i,o=e.t,s=o.style,a=e.u,l=o._gsap;if("all"===a||!0===a)s.cssText="",r=1;else for(i=(a=a.split(",")).length;--i>-1;)n=a[i],ib[n]&&(r=1,n="transformOrigin"===n?Mb:Sb),kb(o,n);r&&(kb(o,Sb),l&&(l.svg&&o.removeAttribute("transform"),Jb(o,1),l.uncache=1))}},Vb={clearProps:function(t,e,n,r,i){if("isFromStart"!==i.data){var o=t._pt=new qw(t._pt,e,n,0,0,Gb);return o.u=r,o.pr=-10,o.tween=i,t._props.push(n),1}}},jb=[1,0,0,1,0,0],Wb={},qb=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},Kb=function(t){var e=Ab(t,Sb);return qb(e)?jb:e.substr(7).match(Pv).map(n_)},Xb=function(t,e){var n,r,i,o,s=t._gsap||$v(t),a=t.style,l=Kb(t);return s.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=t.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?jb:l:(l!==jb||t.offsetParent||t===$w||s.svg||(i=a.display,a.display="block",(n=t.parentNode)&&t.offsetParent||(o=1,r=t.nextSibling,$w.appendChild(t)),l=Kb(t),i?a.display=i:kb(t,"display"),o&&(r?n.insertBefore(t,r):n?n.appendChild(t):$w.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Yb=function(t,e,n,r,i,o){var s,a,l,c=t._gsap,u=i||Xb(t,!0),h=c.xOrigin||0,d=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=u[0],g=u[1],y=u[2],v=u[3],_=u[4],w=u[5],b=e.split(" "),x=parseFloat(b[0])||0,E=parseFloat(b[1])||0;n?u!==jb&&(a=m*v-g*y)&&(l=x*(-g/a)+E*(m/a)-(m*w-g*_)/a,x=x*(v/a)+E*(-y/a)+(y*w-v*_)/a,E=l):(x=(s=Ob(t)).x+(~b[0].indexOf("%")?x/100*s.width:x),E=s.y+(~(b[1]||b[0]).indexOf("%")?E/100*s.height:E)),r||!1!==r&&c.smooth?(_=x-h,w=E-d,c.xOffset=p+(_*m+w*y)-_,c.yOffset=f+(_*g+w*v)-w):c.xOffset=c.yOffset=0,c.xOrigin=x,c.yOrigin=E,c.smooth=!!r,c.origin=e,c.originIsAbsolute=!!n,t.style[Mb]="0px 0px",o&&(Db(o,c,"xOrigin",h,x),Db(o,c,"yOrigin",d,E),Db(o,c,"xOffset",p,c.xOffset),Db(o,c,"yOffset",f,c.yOffset)),t.setAttribute("data-svg-origin",x+" "+E)},Jb=function(t,e){var n=t._gsap||new bw(t);if("x"in n&&!e&&!n.uncache)return n;var r,i,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,w,b,x,E,S,M,T,A,R,L,C,P,I,O,N,k=t.style,D=n.scaleX<0,B="px",U="deg",z=Ab(t,Mb)||"0";return r=i=o=l=c=u=h=d=p=0,s=a=1,n.svg=!(!t.getCTM||!Nb(t)),g=Xb(t,n.svg),n.svg&&(T=(!n.uncache||"0px 0px"===z)&&!e&&t.getAttribute("data-svg-origin"),Yb(t,T||z,!!T||n.originIsAbsolute,!1!==n.smooth,g)),f=n.xOrigin||0,m=n.yOrigin||0,g!==jb&&(w=g[0],b=g[1],x=g[2],E=g[3],r=S=g[4],i=M=g[5],6===g.length?(s=Math.sqrt(w*w+b*b),a=Math.sqrt(E*E+x*x),l=w||b?ab(b,w)*ob:0,(h=x||E?ab(x,E)*ob+l:0)&&(a*=Math.abs(Math.cos(h*sb))),n.svg&&(r-=f-(f*w+m*x),i-=m-(f*b+m*E))):(N=g[6],I=g[7],L=g[8],C=g[9],P=g[10],O=g[11],r=g[12],i=g[13],o=g[14],c=(y=ab(N,P))*ob,y&&(T=S*(v=Math.cos(-y))+L*(_=Math.sin(-y)),A=M*v+C*_,R=N*v+P*_,L=S*-_+L*v,C=M*-_+C*v,P=N*-_+P*v,O=I*-_+O*v,S=T,M=A,N=R),u=(y=ab(-x,P))*ob,y&&(v=Math.cos(-y),O=E*(_=Math.sin(-y))+O*v,w=T=w*v-L*_,b=A=b*v-C*_,x=R=x*v-P*_),l=(y=ab(b,w))*ob,y&&(T=w*(v=Math.cos(y))+b*(_=Math.sin(y)),A=S*v+M*_,b=b*v-w*_,M=M*v-S*_,w=T,S=A),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),s=n_(Math.sqrt(w*w+b*b+x*x)),a=n_(Math.sqrt(M*M+N*N)),y=ab(S,M),h=Math.abs(y)>2e-4?y*ob:0,p=O?1/(O<0?-O:O):0),n.svg&&(T=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!qb(Ab(t,Sb)),T&&t.setAttribute("transform",T))),Math.abs(h)>90&&Math.abs(h)<270&&(D?(s*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,h+=h<=0?180:-180)),n.x=r-((n.xPercent=r&&(n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-r)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+B,n.y=i-((n.yPercent=i&&(n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-i)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+B,n.z=o+B,n.scaleX=n_(s),n.scaleY=n_(a),n.rotation=n_(l)+U,n.rotationX=n_(c)+U,n.rotationY=n_(u)+U,n.skewX=h+U,n.skewY=d+U,n.transformPerspective=p+B,(n.zOrigin=parseFloat(z.split(" ")[2])||0)&&(k[Mb]=Zb(z)),n.xOffset=n.yOffset=0,n.force3D=uv.force3D,n.renderTransform=n.svg?ix:rb?rx:$b,n.uncache=0,n},Zb=function(t){return(t=t.split(" "))[0]+" "+t[1]},Qb=function(t,e,n){var r=B_(e);return n_(parseFloat(e)+parseFloat(Ub(t,"x",n+"px",r)))+r},$b=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,rx(t,e)},tx="0deg",ex="0px",nx=") ",rx=function(t,e){var n=e||this,r=n.xPercent,i=n.yPercent,o=n.x,s=n.y,a=n.z,l=n.rotation,c=n.rotationY,u=n.rotationX,h=n.skewX,d=n.skewY,p=n.scaleX,f=n.scaleY,m=n.transformPerspective,g=n.force3D,y=n.target,v=n.zOrigin,_="",w="auto"===g&&t&&1!==t||!0===g;if(v&&(u!==tx||c!==tx)){var b,x=parseFloat(c)*sb,E=Math.sin(x),S=Math.cos(x);x=parseFloat(u)*sb,b=Math.cos(x),o=Qb(y,o,E*b*-v),s=Qb(y,s,-Math.sin(x)*-v),a=Qb(y,a,S*b*-v+v)}m!==ex&&(_+="perspective("+m+nx),(r||i)&&(_+="translate("+r+"%, "+i+"%) "),(w||o!==ex||s!==ex||a!==ex)&&(_+=a!==ex||w?"translate3d("+o+", "+s+", "+a+") ":"translate("+o+", "+s+nx),l!==tx&&(_+="rotate("+l+nx),c!==tx&&(_+="rotateY("+c+nx),u!==tx&&(_+="rotateX("+u+nx),h===tx&&d===tx||(_+="skew("+h+", "+d+nx),1===p&&1===f||(_+="scale("+p+", "+f+nx),y.style[Sb]=_||"translate(0, 0)"},ix=function(t,e){var n,r,i,o,s,a=e||this,l=a.xPercent,c=a.yPercent,u=a.x,h=a.y,d=a.rotation,p=a.skewX,f=a.skewY,m=a.scaleX,g=a.scaleY,y=a.target,v=a.xOrigin,_=a.yOrigin,w=a.xOffset,b=a.yOffset,x=a.forceCSS,E=parseFloat(u),S=parseFloat(h);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=sb,p*=sb,n=Math.cos(d)*m,r=Math.sin(d)*m,i=Math.sin(d-p)*-g,o=Math.cos(d-p)*g,p&&(f*=sb,s=Math.tan(p-f),i*=s=Math.sqrt(1+s*s),o*=s,f&&(s=Math.tan(f),n*=s=Math.sqrt(1+s*s),r*=s)),n=n_(n),r=n_(r),i=n_(i),o=n_(o)):(n=m,o=g,r=i=0),(E&&!~(u+"").indexOf("px")||S&&!~(h+"").indexOf("px"))&&(E=Ub(y,"x",u,"px"),S=Ub(y,"y",h,"px")),(v||_||w||b)&&(E=n_(E+v-(v*n+_*i)+w),S=n_(S+_-(v*r+_*o)+b)),(l||c)&&(s=y.getBBox(),E=n_(E+l/100*s.width),S=n_(S+c/100*s.height)),s="matrix("+n+","+r+","+i+","+o+","+E+","+S+")",y.setAttribute("transform",s),x&&(y.style[Sb]=s)},ox=function(t,e,n,r,i,o){var s,a,l=360,c=wv(i),u=parseFloat(i)*(c&&~i.indexOf("rad")?ob:1),h=o?u*o:u-r,d=r+h+"deg";return c&&("short"===(s=i.split("_")[1])&&(h%=l)!=h%180&&(h+=h<0?l:-360),"cw"===s&&h<0?h=(h+36e9)%l-~~(h/l)*l:"ccw"===s&&h>0&&(h=(h-36e9)%l-~~(h/l)*l)),t._pt=a=new qw(t._pt,e,n,r,h,pb),a.e=d,a.u="deg",t._props.push(n),a},sx=function(t,e){for(var n in e)t[n]=e[n];return t},ax=function(t,e,n){var r,i,o,s,a,l,c,u=sx({},n._gsap),h=n.style;for(i in u.svg?(o=n.getAttribute("transform"),n.setAttribute("transform",""),h[Sb]=e,r=Jb(n,1),kb(n,Sb),n.setAttribute("transform",o)):(o=getComputedStyle(n)[Sb],h[Sb]=e,r=Jb(n,1),h[Sb]=o),ib)(o=u[i])!==(s=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(a=B_(o)!==(c=B_(s))?Ub(n,i,o,c):parseFloat(o),l=parseFloat(s),t._pt=new qw(t._pt,r,i,a,l-a,db),t._pt.u=c||0,t._props.push(i));sx(r,u)};e_("padding,margin,Width,Radius",(function(t,e){var n="Top",r="Right",i="Bottom",o="Left",s=(e<3?[n,r,i,o]:[n+o,n+r,i+r,i+o]).map((function(n){return e<2?t+n:"border"+n+t}));Vb[e>1?"border"+t:t]=function(t,e,n,r,i){var o,a;if(arguments.length<4)return o=s.map((function(e){return zb(t,e,n)})),5===(a=o.join(" ")).split(o[0]).length?o[0]:a;o=(r+"").split(" "),a={},s.forEach((function(t,e){return a[t]=o[e]=o[e]||o[(e-1)/2|0]})),t.init(e,a,i)}}));var lx,cx,ux={name:"css",register:Cb,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,r,i){var o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,w,b,x,E,S=this._props,M=t.style,T=n.vars.startAt;for(h in tb||Cb(),e)if("autoRound"!==h&&(s=e[h],!Kv[h]||!Aw(h,e,n,r,t,i)))if(c=typeof s,u=Vb[h],"function"===c&&(c=typeof(s=s.call(n,r,t,i))),"string"===c&&~s.indexOf("random(")&&(s=K_(s)),u)u(this,t,h,s,n)&&(_=1);else if("--"===h.substr(0,2))o=(getComputedStyle(t).getPropertyValue(h)+"").trim(),s+="",ow.lastIndex=0,ow.test(o)||(d=B_(o),p=B_(s)),p?d!==p&&(o=Ub(t,h,o,p)+p):d&&(s+=d),this.add(M,"setProperty",o,s,r,i,0,0,h),S.push(h);else if("undefined"!==c){if(T&&h in T?(o="function"==typeof T[h]?T[h].call(n,r,t,i):T[h],h in uv.units&&!B_(o)&&(o+=uv.units[h]),"="===(o+"").charAt(1)&&(o=zb(t,h))):o=zb(t,h),l=parseFloat(o),(f="string"===c&&"="===s.charAt(1)?+(s.charAt(0)+"1"):0)&&(s=s.substr(2)),a=parseFloat(s),h in hb&&("autoAlpha"===h&&(1===l&&"hidden"===zb(t,"visibility")&&a&&(l=0),Db(this,M,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==h&&"transform"!==h&&~(h=hb[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in ib)if(g||((y=t._gsap).renderTransform&&!e.parseTransform||Jb(t,e.parseTransform),v=!1!==e.smoothOrigin&&y.smooth,(g=this._pt=new qw(this._pt,M,Sb,0,1,y.renderTransform,y,0,-1)).dep=1),"scale"===h)this._pt=new qw(this._pt,y,"scaleY",y.scaleY,(f?f*a:a-y.scaleY)||0),S.push("scaleY",h),h+="X";else{if("transformOrigin"===h){b=void 0,x=void 0,E=void 0,x=(b=(w=s).split(" "))[0],E=b[1]||"50%","top"!==x&&"bottom"!==x&&"left"!==E&&"right"!==E||(w=x,x=E,E=w),b[0]=Hb[x]||x,b[1]=Hb[E]||E,s=b.join(" "),y.svg?Yb(t,s,0,v,0,this):((p=parseFloat(s.split(" ")[2])||0)!==y.zOrigin&&Db(this,y,"zOrigin",y.zOrigin,p),Db(this,M,h,Zb(o),Zb(s)));continue}if("svgOrigin"===h){Yb(t,s,1,v,0,this);continue}if(h in Wb){ox(this,y,h,l,s,f);continue}if("smoothOrigin"===h){Db(this,y,"smooth",y.smooth,s);continue}if("force3D"===h){y[h]=s;continue}if("transform"===h){ax(this,s,t);continue}}else h in M||(h=Lb(h)||h);if(m||(a||0===a)&&(l||0===l)&&!ub.test(s)&&h in M)a||(a=0),(d=(o+"").substr((l+"").length))!==(p=B_(s)||(h in uv.units?uv.units[h]:d))&&(l=Ub(t,h,o,p)),this._pt=new qw(this._pt,m?y:M,h,l,f?f*a:a-l,m||"px"!==p&&"zIndex"!==h||!1===e.autoRound?db:mb),this._pt.u=p||0,d!==p&&(this._pt.b=o,this._pt.r=fb);else if(h in M)Fb.call(this,t,h,o,s);else{if(!(h in t)){Fv(h,s);continue}this.add(t,h,o||t[h],s,r,i)}S.push(h)}_&&Ww(this)},get:zb,aliases:hb,getSetter:function(t,e,n){var r=hb[e];return r&&r.indexOf(",")<0&&(e=r),e in ib&&e!==Mb&&(t._gsap.x||zb(t,"x"))?n&&nb===n?"scale"===e?bb:wb:(nb=n||{})&&("scale"===e?xb:Eb):t.style&&!Ev(t.style[e])?vb:~e.indexOf("-")?_b:Bw(t,e)},core:{_removeProperty:kb,_getMatrix:Xb}};Jw.utils.checkPrefix=Lb,cx=e_("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+(lx="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){ib[t]=1})),e_(lx,(function(t){uv.units[t]="deg",Wb[t]=1})),hb[cx[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+lx,e_("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");hb[e[1]]=cx[e[0]]})),e_("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){uv.units[t]="px"})),Jw.registerPlugin(ux);var hx=Jw.registerPlugin(ux)||Jw;function dx(t,e=!1){const n=null!==t[0].index,r=new Set(Object.keys(t[0].attributes)),i=new Set(Object.keys(t[0].morphAttributes)),o={},s={},a=t[0].morphTargetsRelative,l=new yl;let c=0;for(let u=0;u<t.length;++u){const h=t[u];let d=0;if(n!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const t in h.attributes){if(!r.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+t+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[t]&&(o[t]=[]),o[t].push(h.attributes[t]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const t in h.morphAttributes){if(!i.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===s[t]&&(s[t]=[]),s[t].push(h.morphAttributes[t])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(h.userData),e){let t;if(n)t=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;t=h.attributes.position.count}l.addGroup(c,t,u),c+=t}}if(n){let e=0;const n=[];for(let r=0;r<t.length;++r){const i=t[r].index;for(let t=0;t<i.count;++t)n.push(i.getX(t)+e);e+=t[r].attributes.position.count}l.setIndex(n)}for(const t in o){const e=px(o[t]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+t+" attribute."),null;l.setAttribute(t,e)}for(const t in s){const e=s[t][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[t]=[];for(let n=0;n<e;++n){const e=[];for(let r=0;r<s[t].length;++r)e.push(s[t][r][n]);const r=px(e);if(!r)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+t+" morphAttribute."),null;l.morphAttributes[t].push(r)}}return l}function px(t){let e,n,r,i=0;for(let o=0;o<t.length;++o){const s=t[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=s.array.constructor),e!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===r&&(r=s.normalized),r!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=s.array.length}const o=new e(i);let s=0;for(let e=0;e<t.length;++e)o.set(t[e].array,s),s+=t[e].array.length;return new $a(o,n,r)}hx.core.Tween;var fx={};const mx=e=>{var n;switch(e.type){case"ShapeGeometry":var r=new Pp;e.shapeArgs.forEach((t=>r[t.draw](...t.drawArgs))),(n={args:e.args,geometry:new df(r)}).edges=new lp(n.geometry);break;case"ExtrudeGeometry":r=new Pp,e.shapeArgs.forEach((t=>r[t.draw](...t.drawArgs))),(n={geometry:new sf(r,e.extrudeSettings)}).edges=new lp(n.geometry);break;case"ParametricGeometry":const o=new yl;o.setAttribute("position",new $a(e.attributes.position.array,e.attributes.position.itemSize,e.attributes.position.Boolean)),o.setAttribute("normal",new $a(e.attributes.normal.array,e.attributes.normal.itemSize,e.attributes.normal.Boolean)),o.setAttribute("uv",new $a(e.attributes.uv.array,e.attributes.uv.itemSize,e.attributes.uv.Boolean)),o.setIndex(new $a(e.index.array,e.index.itemSize,e.index.Boolean)),(n={geometry:o}).edges=new lp(n.geometry);break;default:if(fx.hasOwnProperty(e.type)){var i=!1;fx[e.type].forEach((t=>{if(t.args.length===e.args.length){var r=!0;for(let n=0;n<t.args.length;n++)t.args[n]===e.args[n]||(r=!1);r&&(i=!0,(n=t).count++,n.instances=[])}})),i||((n={args:e.args,geometry:new t[e.type](...e.args),count:1}).edges=new lp(n.geometry),fx[e.type].push(n))}else fx[e.type]=[],(n={args:e.args,geometry:new t[e.type](...e.args),count:1}).edges=new lp(n.geometry),fx[e.type].push(n)}return n},gx=new Worker(new URL(n.p+n.u(482),n.b)),yx=(t,e,n,r)=>{gx.postMessage({img:t,id:e,type:n,location:r,currentRoom:GL.room})},vx=new rm,_x=t=>new Promise((e=>vx.load(t,e))),wx="rgb(255,0,0)",bx="rgb(0,255,235)",xx=new Ja({color:"white",opacity:.85,transparent:!0}),Ex=new Pd({color:"black",onBeforeCompile:t=>{t.vertexShader=`\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ${t.vertexShader}\n`.replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),Sx=new Pd({color:bx}),Mx=new Pd({color:"red"}),Tx=new Pd({color:"black"}),Ax=new Pd({color:bx,onBeforeCompile:t=>{t.vertexShader=`\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ${t.vertexShader}\n`.replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),Rx=new Pd({color:wx,onBeforeCompile:t=>{t.vertexShader=`\n    attribute vec3 instT;\n    attribute vec4 instR;\n    attribute vec3 instS;\n    \n    // http://barradeau.com/blog/?p=1109\n    vec3 trs( inout vec3 position, vec3 T, vec4 R, vec3 S ) {\n        position *= S;\n        position += 2.0 * cross( R.xyz, cross( R.xyz, position ) + R.w * position );\n        position += T;\n        return position;\n    }\n    ${t.vertexShader}\n`.replace("#include <begin_vertex>","#include <begin_vertex>\n      transformed = trs(transformed, instT, instR, instS);\n")}}),Lx=new Ja({color:wx,side:er}),Cx=new Ja({color:bx,side:er}),Px={ghost:xx,whiteFull:new Ja({color:"white",side:er}),blackFull:new Ja({color:"black",side:er}),redFull:Lx,redLineLone:Mx,redLine:Rx,cyanFull:Cx,cyanLine:Ax,red:wx,cyan:bx,blackLine:Ex,hatchingMaterial:0,blackColor:new Es("rgb(0, 0, 0)"),whiteColor:new Es("rgb(255, 255, 255)"),blackLineLone:Tx,cyanLineLone:Sx,redColor:new Es(wx),cyanColor:new Es(bx)};var Ix=n(8687);const Ox={},Nx=document.getElementById("connectInfo"),kx=(t,e)=>{Nx.innerHTML="",Ox[t]=e;var n="";for(const t in Ox)n+=`${t} - ${Ox[t]}<br>`;Nx.innerHTML=n},Dx=Ix.gql`
  query getProfiles($artists: [String!]!) {
    holder(where: { address: { _in: $artists } }) {
      alias
      address
      description
      discord
      dns
      email
      ethereum
      facebook
      flag
      github
      gitlab
      inserted_at
      instagram
      last_metadata_update
      logo
      medium
      reddit
      slack
      support
      telegram
      twitter
      tzdomain
      website
    }
  }
`,Bx={};async function Ux(t,e){const n=[];return t.forEach((t=>{Bx.hasOwnProperty(t)||n.push(t)})),await(0,Ix.request)("https://data.objkt.com/v3/graphql",Dx,{artists:n}).then((t=>{t&&(t.hasOwnProperty("holder")&&t.holder.forEach((t=>Bx[t.address]=t)),e&&t.tzprofiles[0].alias&&fC(t.tzprofiles[0].alias))})).catch((t=>{console.log("tzProfiles is currently unable to provide detailed user information.")}))}const zx=Ix.gql`
  query getUserGenerators($userId: String, $take: Int) {
    user(id: $userId) {
      generativeTokens(take: $take) {
        name
        id
        slug
        thumbnailUri
      }
    }
  }
`,Fx=Ix.gql`
  query GetObjktsByHolderPaged(
    $limit: Int!
    $offset: Int!
    $where: token_holder_bool_exp = {}
    $order_by: [token_holder_order_by!] = {}
  ) {
    token_holder(
      limit: $limit
      offset: $offset
      where: $where
      order_by: $order_by
    ) {
      token {
        ...TokenDefault
        __typename
        fa {
          collection_type
          contract
          name
        }
      }
      __typename
      holder {
        alias
      }
    }
  }

  fragment TokenDefault on token {
    pk
    token_id
    artifact_uri
    description
    display_uri
    thumbnail_uri
    timestamp
    name
    creators {
      creator_address
    }
    attributes {
      attribute {
        id
        name
        type
        value
        __typename
      }
      __typename
    }
    __typename
  }
`,Hx=Ix.gql`
  query getUserGenCollection($generativeTokenId: Float) {
    generativeToken(id: $generativeTokenId) {
      entireCollection {
        id
        name
        metadata
      }
    }
  }
`;var Gx,Vx=0,jx={},Wx={};const qx=(t,e)=>{Gx=t,(0,Ix.request)("https://data.objkt.com/v3/graphql",Fx,JSON.parse(((t,e,n)=>`\n    {\n        "where": {\n          "holder_address": {\n            "_eq": "${t}"\n          },\n          "quantity": {\n            "_gt": 0\n          },\n          "token": {\n            "fa": {\n              "live": {\n                "_eq": true\n              }\n            }\n          }\n        },\n        "order_by": {\n          "last_incremented_at": "desc"\n        },\n        "limit": 500,\n        "offset": "${e}"\n      }`)(t,Vx))).then((t=>{if(t.token_holder.forEach((t=>{if(t.token.hasOwnProperty("creators")&&t.token.creators[0]){var e=t.token.creators[0].creator_address;Wx.hasOwnProperty(e)?Wx[e].push(t.token):Wx[e]=[t.token],jx.hasOwnProperty(e)||(jx[e]=t.token.creators[0].alias),yL[JSON.stringify(t.token.pk)]=t.token}})),500===t.token_holder.length)Vx+=500,setTimeout((()=>{qx(Gx)}),1e3);else{var n=[],r=[];for(const t in Wx)n.push(Wx[t][0]),r.push(t);Ux(r).then((t=>{Zx(Wx,n,e)})),kx("OBJKT tokens retrieval","🟢")}})).catch((t=>{console.log("Failed to retrieve your OBJKT tokens"),console.log(t),kx("OBJKT tokens retrieval","🔴")}))};var Kx={},Xx=[];const Yx=(t,e)=>{(0,Ix.request)("https://data.objkt.com/v3/graphql",((t,e)=>Ix.gql`
query getArtistCreations {
  token_creator(offset: ${t}, where: {creator_address: {_eq: ${e}}, token: {fa: {contract: {_nin: ["KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE","KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi"]}}}}) {
    token {
       pk
    token_id
    artifact_uri
    description
    display_uri
    thumbnail_uri
    timestamp
    name
    creators {
      creator_address
    }
    attributes {
      attribute {
        id
        name
        type
        value
        __typename
      }
      __typename
    }
    __typename
         fa {
          collection_type
          contract
          name
        }
      creators {
        creator_address
      }
    }
  }
}
`)(t,e)).then((n=>{if(n.token_creator.forEach((t=>{const e=t.token.fa.name+"-"+t.token.fa.contract;Kx.hasOwnProperty(e)||(Kx[e]=[]),Kx[e].push(t.token)})),500===n.token_creator.length)setTimeout((()=>{Yx(t+1,e)}),1e3);else for(const t in Kx){const e=document.createElement("div");e.className="gentkProfiles";const n=Kx[t][0],r=new Image;r.className="thumbnail",r.src="https://assets.objkt.media/file/assets-003/"+n.fa.contract+"/"+n.token_id+"/thumb288",n.display_uri||(r.style.width="200px",r.style.imageRendering="pixelated",r.src=n.artifact_uri),r.onerror=t=>{r.src="/notfound.png"},r.style.cursor="pointer",r.addEventListener("click",(()=>{const e=Jx(Kx[t]);n.DOMelements={gallery:e},rP(n)})),r&&e.appendChild(r);const i=document.createElement("div");i.className="artThumbTitle";const o=document.createElement("div");o.className="artistNames",o.innerText=n.fa.name,i.appendChild(o),e.appendChild(i),Xx.push(e)}kx("Personal creations retrieval","🟢")})).catch((t=>{console.log("Failed to retrieve your OBJKT tokens"),console.log(t),kx("Personal creations retrieval","🔴")}))},Jx=t=>{var e=[];return t.forEach((t=>{const n=t.fa.contract+t.token_id,r=document.createElement("li");r.className="gentkCell";const i=document.createElement("div");var o="";i.className="thumbTitle";const s=new Image;s.className="thumbnail",t.hasOwnProperty("metadata")&&(s.src="https://gateway.fxhash.xyz/ipfs/"+t.metadata.thumbnailUri.replace("ipfs://",""),s.style.cursor="pointer",t.metadata.displayUri.replace("ipfs://",""));var a="https://objkt.com/asset/"+t.fa.contract+"/"+t.token_id;t.url=a,t.hasOwnProperty("name")&&(o=t.name,s.src="https://assets.objkt.media/file/assets-003/"+t.fa.contract+"/"+t.token_id+"/thumb288",t.display_uri||(s.style.width="200px",s.style.imageRendering="pixelated",s.src=t.artifact_uri),s.onerror=t=>{s.src="/notfound.png"},s.style.cursor="pointer");var l="<div style='font-size:10px'>Check token on <a target='_blank' href='"+a+"'>OBJKT</a> </div>";i.innerHTML=o+"<br>"+l,yL[n]=t,s.addEventListener("click",(()=>{$x(t,n)})),r.appendChild(s),r.appendChild(i),e.push(r)})),e},Zx=(t,e)=>{var n=0;e.forEach((e=>{n++,setTimeout((()=>{const n=new Image;n.className="thumbnail",n.src="https://assets.objkt.media/file/assets-003/"+e.fa.contract+"/"+e.token_id+"/thumb288",n.style.cursor="pointer",e.display_uri||(n.style.width="200px",n.style.imageRendering="pixelated",n.src=e.artifact_uri),n.onerror=t=>{n.src="/notfound.png"},n.addEventListener("click",(()=>{const n=Qx(t,e);e.DOMelements={gallery:n},rP(e)})),tE(Bx[e.creators[0].creator_address],n)}),50*n)}))},Qx=(t,e)=>{var n=t[e.creators[0].creator_address];const r=[];return n.forEach((t=>{const e=t.pk,n=document.createElement("li");n.className="gentkCell";const i=document.createElement("div");var o="";i.className="thumbTitle";const s=new Image;s.className="thumbnail",t.hasOwnProperty("metadata")&&(s.src="https://gateway.fxhash.xyz/ipfs/"+t.metadata.thumbnailUri.replace("ipfs://",""),s.style.cursor="pointer",t.metadata.displayUri.replace("ipfs://",""));var a="https://objkt.com/asset/"+t.fa.contract+"/"+t.token_id;t.url=a,t.hasOwnProperty("name")&&(o=t.name,s.src="https://assets.objkt.media/file/assets-003/"+t.fa.contract+"/"+t.token_id+"/thumb288",t.display_uri||(s.style.width="200px",s.style.imageRendering="pixelated",s.src=t.artifact_uri),s.onerror=t=>{s.src="/notfound.png"},s.style.cursor="pointer");var l="<div style='font-size:10px'>Check token on <a target='_blank' href='"+a+"'>OBJKT</a> </div>";i.innerHTML=o+"<br>"+l,s.addEventListener("click",(()=>{$x(t,e)})),n.appendChild(s),n.appendChild(i),r.push(n)})),r},$x=(t,e)=>{var n;sP(),n=t.display_uri?"https://assets.objkt.media/file/assets-003/"+t.display_uri.replace("ipfs://","")+"/display":t.artifact_uri,yx(n,{id:e},"objkt")};function tE(t,e){const n=document.createElement("div");if(n.className="gentkProfiles",e&&n.appendChild(e),t&&(t.twitter||t.alias||t.logo)){t.alias||(t.alias="");const e=document.createElement("div");e.className="artThumbTitle";const i=t.twitter?`@${t.twitter}`:"",o=document.createElement("div");o.className="artistNames";var r=t.alias.length<50?t.alias:t.alias.substring(0,50)+"…";if(o.innerHTML=`<span>${r}</span>\n  <span><a href="${t.twitter}" target="_blank">${i.replace("https://twitter.com/","")}</a></span>`,t.logo&&t.logo.indexOf("ipfs")>-1)try{const n=document.createElement("img");n.className="profilePic",n.src=t.logo,n.addEventListener("error",(e=>{t.alias&&console.log("%c The profile picture of |"+t.alias+"| cannot be found.","font-weight:bold"),n.style.display="none"})),e.appendChild(n)}catch(t){console.log("failed getting image")}e.appendChild(o),n.appendChild(e)}vL.push(n)}var eE={};const nE=t=>{fetch(`https://api.opensea.io/api/v1/collections?asset_owner=${t}&offset=0&limit=300`,{method:"GET",headers:{Accept:"application/json"}}).then((t=>t.json())).then((e=>{e.forEach((e=>{var n,r="";e.primary_asset_contracts.forEach((t=>r+=t.name+" ")),(n=new Image).className="thumbnail",n.style.width="200px",n.style.height="200px",n.style.objectFit="cover",e.image_url&&(n.src=e.banner_image_url),n.addEventListener("error",(()=>n.src="./missing.png"));const i=e.slug;n.addEventListener("click",(()=>{((t,e)=>{eE.hasOwnProperty(e)?rP(eE[e]):fetch(`https://api.opensea.io/api/v1/assets?owner=${t}&collection_slug=${e}&order_direction=desc&limit=50&include_orders=false`,{method:"GET",headers:{Accept:"application/json","X-API-KEY":"a73d594a3303471a82688d0b300ac6a0"}}).then((t=>t.json())).then((t=>{eE[e]={data:[]},t.assets.forEach((t=>{yL[JSON.stringify(t.id)]=t,eE[e].data.push(t)})),(t=>{var e=eE[t].data;const n=[];e.forEach((t=>{const e=t.id,r=document.createElement("li");r.className="gentkCell";const i=document.createElement("div"),o=t.name;i.className="thumbTitle";const s=new Image;s.className="thumbnail",s.src=t.image_url,t.image_url;const a=t.permalink;s.style.cursor="pointer";var l="<div style='font-size:10px'>Check token on <a target='_blank' href='"+a+"'>OpenSea</a> </div>";i.innerHTML=o+"<br>"+l,s.addEventListener("click",(()=>{((t,e)=>{sP(),yx(t.image_url,{id:e,objkt:t},"openSea")})(t,e)})),r.appendChild(s),r.appendChild(i),n.push(r)})),eE[t].DOMelements={gallery:n}})(e),rP(eE[e])})).catch((t=>console.error(t)))})(t,i)})),tE({name:r,twitter:e.twitter_username,logo:null},n)})),kx("OpenSea tokens retrieval","🟢")})).catch((t=>{console.log("Failed to retrieve your OpenSea tokens"),console.log(t),kx("OpenSea tokens retrieval","🔴")}))};var rE,iE,oE;function sE(t){return Object.keys(t)}!function(t){t.transfer_request="transfer_request",t.sign_payload_request="sign_payload_request"}(rE||(rE={})),function(t){t.transfer="transfer",t.sign_payload_json="sign_payload_json",t.sign_payload_raw="sign_payload_raw"}(iE||(iE={})),function(t){t.PENDING="pending",t.RESOLVED="resolved",t.REJECTED="rejected"}(oE||(oE={}));const aE=()=>{throw new Error("ExposedPromise not initialized yet.")};class lE{constructor(){this._resolve=aE,this._reject=aE,this._status=oE.PENDING,this._promise=new Promise(((t,e)=>{this._resolve=e=>{this.isSettled()||(this._promiseResult=e,t(e),this._status=oE.RESOLVED)},this._reject=t=>{this.isSettled()||(this._promiseError=t,e(t),this._status=oE.REJECTED)}}))}get promise(){return this._promise}get resolve(){return this._resolve}get reject(){return this._reject}get status(){return this._status}get promiseResult(){return this._promiseResult}get promiseError(){return this._promiseError}static resolve(t){const e=new lE;return e.resolve(t),e}static reject(t){const e=new lE;return e.reject(t),e}isPending(){return this.status===oE.PENDING}isResolved(){return this.status===oE.RESOLVED}isRejected(){return this.status===oE.REJECTED}isSettled(){return this.isResolved()||this.isRejected()}}var cE=n(8334),uE=n(450),hE=n(1416),dE=n(6249),pE=n(1322),fE=n(1050),mE=n(3683),gE=n(8764).Buffer,yE=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};function vE(t){return gE.from(t).toString("hex")}function _E(t){return yE(this,void 0,void 0,(function*(){return vE("string"==typeof t?(0,pE.hash)((0,dE.cv)(t),32):(0,pE.hash)(t,32))}))}function wE(t){return yE(this,void 0,void 0,(function*(){return(0,fE._w)((0,pE.hash)((0,dE.cv)(t),32))}))}function bE(t,e){return yE(this,void 0,void 0,(function*(){const n=gE.from((0,hE.randomBytes)(24));return vE(gE.concat([n,gE.from((0,uE.secretBox)(e,n,gE.from(t,"utf8")))]))}))}function xE(t,e){return yE(this,void 0,void 0,(function*(){const n=t.slice(0,24),r=t.slice(24),i=(0,uE.openSecretBox)(e,n,r);if(!i)throw new Error("Decryption failed");return gE.from(i).toString("utf8")}))}function EE(t,e,n){return yE(this,void 0,void 0,(function*(){const r=(0,fE.zh)(gE.from(n)),i=(0,fE.SH)(gE.from(e)),o="string"==typeof t?(0,dE.cv)(t):t,s=o.slice(0,32),a=o.slice(32),l=new pE.BLAKE2b(24).update(s,32).update(i,32).digest(),c=(0,uE.openBox)(s,r,l,a);if(!c)throw new Error("Decryption failed");return gE.from(c).toString()}))}function SE(t,e){return`@${t}:${e}`}var ME,TE,AE,RE,LE,CE,PE,IE,OE,NE,kE,DE,BE,UE,zE=n(8764).Buffer;function FE(){return t=this,e=void 0,r=function*(){const t=(0,hE.randomBytes)(16);return[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)].map((function(t){return zE.from(t).toString("hex")})).join("-")},new((n=void 0)||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}));var t,e,n,r}(UE=ME||(ME={})).BlockchainRequest="blockchain_request",UE.PermissionRequest="permission_request",UE.SignPayloadRequest="sign_payload_request",UE.OperationRequest="operation_request",UE.BroadcastRequest="broadcast_request",UE.BlockchainResponse="blockchain_response",UE.PermissionResponse="permission_response",UE.SignPayloadResponse="sign_payload_response",UE.OperationResponse="operation_response",UE.BroadcastResponse="broadcast_response",UE.Acknowledge="acknowledge",UE.Disconnect="disconnect",UE.Error="error",function(t){t.SIGN="sign",t.OPERATION_REQUEST="operation_request",t.ENCRYPT="encrypt",t.THRESHOLD="threshold"}(TE||(TE={})),function(t){t.MAINNET="mainnet",t.GHOSTNET="ghostnet",t.MONDAYNET="mondaynet",t.DAILYNET="dailynet",t.DELPHINET="delphinet",t.EDONET="edonet",t.FLORENCENET="florencenet",t.GRANADANET="granadanet",t.HANGZHOUNET="hangzhounet",t.ITHACANET="ithacanet",t.JAKARTANET="jakartanet",t.KATHMANDUNET="kathmandunet",t.CUSTOM="custom"}(AE||(AE={})),function(t){t.ENDORSEMENT="endorsement",t.SEED_NONCE_REVELATION="seed_nonce_revelation",t.DOUBLE_ENDORSEMENT_EVIDENCE="double_endorsement_evidence",t.DOUBLE_BAKING_EVIDENCE="double_baking_evidence",t.ACTIVATE_ACCOUNT="activate_account",t.PROPOSALS="proposals",t.BALLOT="ballot",t.REVEAL="reveal",t.TRANSACTION="transaction",t.ORIGINATION="origination",t.DELEGATION="delegation"}(RE||(RE={})),function(t){t.WEBSITE="website",t.EXTENSION="extension",t.P2P="p2p"}(LE||(LE={})),function(t){t.BACKGROUND="toBackground",t.PAGE="toPage",t.EXTENSION="toExtension"}(CE||(CE={})),(BE=PE||(PE={})).BROADCAST_ERROR="BROADCAST_ERROR",BE.NETWORK_NOT_SUPPORTED="NETWORK_NOT_SUPPORTED",BE.NO_ADDRESS_ERROR="NO_ADDRESS_ERROR",BE.NO_PRIVATE_KEY_FOUND_ERROR="NO_PRIVATE_KEY_FOUND_ERROR",BE.NOT_GRANTED_ERROR="NOT_GRANTED_ERROR",BE.PARAMETERS_INVALID_ERROR="PARAMETERS_INVALID_ERROR",BE.TOO_MANY_OPERATIONS="TOO_MANY_OPERATIONS",BE.TRANSACTION_INVALID_ERROR="TRANSACTION_INVALID_ERROR",BE.SIGNATURE_TYPE_NOT_SUPPORTED="SIGNATURE_TYPE_NOT_SUPPORTED",BE.ABORTED_ERROR="ABORTED_ERROR",BE.UNKNOWN_ERROR="UNKNOWN_ERROR",(DE=IE||(IE={})).NOT_CONNECTED="NOT_CONNECTED",DE.CONNECTING="CONNECTING",DE.CONNECTED="CONNECTED",function(t){t.CHROME_MESSAGE="chrome_message",t.POST_MESSAGE="post_message",t.LEDGER="ledger",t.P2P="p2p"}(OE||(OE={})),(kE=NE||(NE={})).TRANSPORT_P2P_PEERS_DAPP="beacon:communication-peers-dapp",kE.TRANSPORT_P2P_PEERS_WALLET="beacon:communication-peers-wallet",kE.TRANSPORT_POSTMESSAGE_PEERS_DAPP="beacon:postmessage-peers-dapp",kE.TRANSPORT_POSTMESSAGE_PEERS_WALLET="beacon:postmessage-peers-wallet",kE.ACCOUNTS="beacon:accounts",kE.ACTIVE_ACCOUNT="beacon:active-account",kE.BEACON_SDK_SECRET_SEED="beacon:sdk-secret-seed",kE.APP_METADATA_LIST="beacon:app-metadata-list",kE.PERMISSION_LIST="beacon:permissions",kE.BEACON_SDK_VERSION="beacon:sdk_version",kE.MATRIX_PRESERVED_STATE="beacon:sdk-matrix-preserved-state",kE.MATRIX_PEER_ROOM_IDS="beacon:matrix-peer-rooms",kE.MATRIX_SELECTED_NODE="beacon:matrix-selected-node",kE.MULTI_NODE_SETUP_DONE="beacon:multi-node-setup";const HE={[NE.TRANSPORT_P2P_PEERS_DAPP]:[],[NE.TRANSPORT_P2P_PEERS_WALLET]:[],[NE.TRANSPORT_POSTMESSAGE_PEERS_DAPP]:[],[NE.TRANSPORT_POSTMESSAGE_PEERS_WALLET]:[],[NE.ACCOUNTS]:[],[NE.ACTIVE_ACCOUNT]:void 0,[NE.BEACON_SDK_SECRET_SEED]:void 0,[NE.APP_METADATA_LIST]:[],[NE.PERMISSION_LIST]:[],[NE.BEACON_SDK_VERSION]:void 0,[NE.MATRIX_PRESERVED_STATE]:{},[NE.MATRIX_PEER_ROOM_IDS]:{},[NE.MATRIX_SELECTED_NODE]:void 0,[NE.MULTI_NODE_SETUP_DONE]:void 0};var GE,VE;!function(t){t.RAW="raw",t.OPERATION="operation",t.MICHELINE="micheline"}(GE||(GE={})),function(t){t.LIGHT="light",t.DARK="dark"}(VE||(VE={}));const jE=[t=>{}];let WE={postMessage:(t,e)=>{console.log("GOT MOCK POST MESSAGE",t),jE.forEach((e=>{e({data:t})}))},addEventListener:(t,e)=>{jE.push(e)},removeEventListener:(t,e)=>{jE.splice(jE.indexOf((t=>t===e)),1)},location:{origin:"*"}};try{"undefined"!=typeof window&&(WE=window)}catch(t){console.log(`not defined: ${t}`)}var qE=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))},KE=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class XE{constructor(t,e){this.storage=t,this.storageKey=e}getAll(){return KE(this,void 0,void 0,(function*(){return this.storage.get(this.storageKey)}))}getOne(t){return KE(this,void 0,void 0,(function*(){return(yield this.storage.get(this.storageKey)).find(t)}))}addOne(t,e,n=!0){return KE(this,void 0,void 0,(function*(){const r=yield this.storage.get(this.storageKey);if(r.some(e)){if(n)for(let n=0;n<r.length;n++)e(r[n])&&(r[n]=t)}else r.push(t);return this.storage.set(this.storageKey,r)}))}remove(t){return KE(this,void 0,void 0,(function*(){const e=(yield this.storage.get(this.storageKey)).filter((e=>!t(e)));return this.storage.set(this.storageKey,e)}))}removeAll(){return KE(this,void 0,void 0,(function*(){return this.storage.delete(this.storageKey)}))}}var YE=n(8764).Buffer;const JE=(t,e)=>{return n=void 0,r=void 0,o=function*(){const n=[t,e.type];e.name&&n.push(`name:${e.name}`),e.rpcUrl&&n.push(`rpc:${e.rpcUrl}`);const r=YE.from((0,pE.hash)((0,dE.cv)(n.join("-")),10));return cE.encode(r)},new((i=void 0)||(i=Promise))((function(t,e){function s(t){try{l(o.next(t))}catch(t){e(t)}}function a(t){try{l(o.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(s,a)}l((o=o.apply(n,r||[])).next())}));var n,r,i,o};var ZE=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class QE{constructor(t){this.storageManager=new XE(t,NE.ACCOUNTS)}getAccounts(){return ZE(this,void 0,void 0,(function*(){return this.storageManager.getAll()}))}getAccount(t){return ZE(this,void 0,void 0,(function*(){return this.storageManager.getOne((e=>e.accountIdentifier===t))}))}addAccount(t){return ZE(this,void 0,void 0,(function*(){return this.storageManager.addOne(t,(e=>e.accountIdentifier===t.accountIdentifier))}))}removeAccount(t){return ZE(this,void 0,void 0,(function*(){return this.storageManager.remove((e=>e.accountIdentifier===t))}))}removeAccounts(t){return ZE(this,void 0,void 0,(function*(){return this.storageManager.remove((e=>t.includes(e.accountIdentifier)))}))}removeAllAccounts(){return ZE(this,void 0,void 0,(function*(){return this.storageManager.removeAll()}))}hasPermission(t){return ZE(this,void 0,void 0,(function*(){return class{static hasPermission(t,e,n){return r=this,i=void 0,s=function*(){switch(t.type){case ME.PermissionRequest:case ME.BroadcastRequest:return!0;case ME.OperationRequest:{const n=yield JE(t.sourceAddress,t.network),r=yield e(n);return!!r&&r.scopes.includes(TE.OPERATION_REQUEST)}case ME.SignPayloadRequest:{const e=(yield n()).filter((e=>e.address===t.sourceAddress));return 0!==e.length&&e.some((t=>t.scopes.includes(TE.SIGN)))}default:throw new Error("Message not handled")}},new((o=void 0)||(o=Promise))((function(t,e){function n(t){try{l(s.next(t))}catch(t){e(t)}}function a(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var r;e.done?t(e.value):(r=e.value,r instanceof o?r:new o((function(t){t(r)}))).then(n,a)}l((s=s.apply(r,i||[])).next())}));var r,i,o,s}}.hasPermission(t,this.getAccount.bind(this),this.getAccounts.bind(this))}))}}var $E=n(8764).Buffer;const tS=t=>{return e=void 0,n=void 0,i=function*(){const e=$E.from((0,pE.hash)($E.from(t,"hex"),5));return cE.encode(e)},new((r=void 0)||(r=Promise))((function(t,o){function s(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(s,a)}l((i=i.apply(e,n||[])).next())}));var e,n,r,i};let eS=!!WE.beaconSdkDebugEnabled;eS&&console.log("[BEACON]: Debug mode is ON (turned on either by the developer or a browser extension)");class nS{constructor(t){this.name=t}debug(t,...e){rS.debug(this.name,t,e)}log(t,...e){rS.log(this.name,t,e)}warn(t,...e){rS.warn(this.name,t,e)}error(t,...e){rS.error(this.name,t,e)}}new nS("");let rS=new class{constructor(){}debug(t,e,...n){this._log("debug",t,e,n)}log(t,e,...n){this._log("log",t,e,n)}warn(t,e,...n){this._log("warn",t,e,n)}error(t,e,...n){this._log("error",t,e,n)}_log(t,e,n,r=[]){if(!eS)return;let i=`[BEACON] ${(new Date).toISOString()} [${e}](${n})`,o=r;switch(r[0]&&"string"==typeof r[0]&&(i+=` ${r[0]}`,o=r.slice(1)),t){case"error":console.group(i),console.error(...o);break;case"warn":console.group(i),console.warn(...o);break;case"debug":console.groupCollapsed(i),console.debug(...o);break;default:console.group(i),console.log(...o)}console.groupEnd()}};var iS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const oS=new nS("Client");class sS{constructor(t,e){this.name="BeaconError",this.title="Error",this.message=`[${t}]:${e}`,this.description=e}get fullDescription(){return{description:this.description}}static getError(t,e){switch(t){case PE.BROADCAST_ERROR:return new aS;case PE.NETWORK_NOT_SUPPORTED:return new lS;case PE.NO_ADDRESS_ERROR:return new cS;case PE.NO_PRIVATE_KEY_FOUND_ERROR:return new uS;case PE.NOT_GRANTED_ERROR:return new hS;case PE.PARAMETERS_INVALID_ERROR:return new dS;case PE.TOO_MANY_OPERATIONS:return new pS;case PE.TRANSACTION_INVALID_ERROR:return new fS(e);case PE.SIGNATURE_TYPE_NOT_SUPPORTED:return new DS;case PE.ABORTED_ERROR:return new TS;case PE.UNKNOWN_ERROR:return new mS}}}class aS extends sS{constructor(){super(PE.BROADCAST_ERROR,"The transaction could not be broadcast to the network. Please try again."),this.name="BroadcastBeaconError",this.title="Broadcast Error"}}class lS extends sS{constructor(){super(PE.NETWORK_NOT_SUPPORTED,"The wallet does not support this network. Please select another one."),this.name="NetworkNotSupportedBeaconError",this.title="Network Error"}}class cS extends sS{constructor(){super(PE.NO_ADDRESS_ERROR,"The wallet does not have an account set up. Please make sure to set up your wallet and try again."),this.name="NoAddressBeaconError",this.title="No Address"}}class uS extends sS{constructor(){super(PE.NO_PRIVATE_KEY_FOUND_ERROR,"The account you are trying to interact with is not available. Please make sure to add the account to your wallet and try again."),this.name="NoPrivateKeyBeaconError",this.title="Account Not Found"}}class hS extends sS{constructor(){super(PE.NOT_GRANTED_ERROR,"You do not have the necessary permissions to perform this action. Please initiate another permission request and give the necessary permissions."),this.name="NotGrantedBeaconError",this.title="Permission Not Granted"}}class dS extends sS{constructor(){super(PE.PARAMETERS_INVALID_ERROR,"Some of the parameters you provided are invalid and the request could not be completed. Please check your inputs and try again."),this.name="ParametersInvalidBeaconError",this.title="Parameters Invalid"}}class pS extends sS{constructor(){super(PE.TOO_MANY_OPERATIONS,"The request contains too many transactions. Please include fewer operations and try again."),this.name="TooManyOperationsBeaconError",this.title="Too Many Operations"}}class fS extends sS{constructor(t){super(PE.TRANSACTION_INVALID_ERROR,"The transaction is invalid and the node did not accept it."),this.data=t,this.name="TransactionInvalidBeaconError",this.title="Transaction Invalid",this.data=t}get fullDescription(){return{description:this.description,data:JSON.stringify(this.data,void 0,2)}}}class mS extends sS{constructor(){super(PE.UNKNOWN_ERROR,"An unknown error occured. Please try again or report it to a developer."),this.name="UnknownBeaconError",this.title="Error"}}var gS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const yS=new nS("Transport");class vS{constructor(t,e,n){this.type=OE.POST_MESSAGE,this._isConnected=IE.NOT_CONNECTED,this.listeners=[],this.name=t,this.client=e,this.peerManager=n}get connectionStatus(){return this._isConnected}static isAvailable(){return gS(this,void 0,void 0,(function*(){return Promise.resolve(!1)}))}connect(){return gS(this,void 0,void 0,(function*(){yS.log("connect"),this._isConnected=IE.CONNECTED}))}disconnect(){return gS(this,void 0,void 0,(function*(){yS.log("disconnect"),this._isConnected=IE.NOT_CONNECTED}))}send(t,e){return gS(this,void 0,void 0,(function*(){if(e)return this.client.sendMessage(t,e);{const e=(yield this.getPeers()).map((e=>this.client.sendMessage(t,e)));return(yield Promise.all(e))[0]}}))}addListener(t){return gS(this,void 0,void 0,(function*(){yS.debug("addListener"),this.listeners.push(t)}))}removeListener(t){return gS(this,void 0,void 0,(function*(){yS.log("removeListener"),this.listeners=this.listeners.filter((e=>e!==t))}))}getPeers(){return gS(this,void 0,void 0,(function*(){return this.peerManager.getPeers()}))}addPeer(t,e=!0){return gS(this,void 0,void 0,(function*(){yS.log("addPeer","adding peer",t),yield this.peerManager.addPeer(t),yield this.listen(t.publicKey)}))}removePeer(t){return gS(this,void 0,void 0,(function*(){yS.log("removePeer","removing peer",t),yield this.peerManager.removePeer(t.publicKey),this.client&&(yield this.client.unsubscribeFromEncryptedMessage(t.publicKey))}))}removeAllPeers(){return gS(this,void 0,void 0,(function*(){yS.log("removeAllPeers"),yield this.peerManager.removeAllPeers(),this.client&&(yield this.client.unsubscribeFromEncryptedMessages())}))}notifyListeners(t,e){return gS(this,void 0,void 0,(function*(){0===this.listeners.length?yS.warn("notifyListeners","0 listeners notified!",this):yS.log("notifyListeners",`Notifying ${this.listeners.length} listeners`,this),this.listeners.forEach((n=>{n(t,e)}))}))}}var _S=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class wS{constructor(t){this.prefix=t}static isSupported(){return _S(this,void 0,void 0,(function*(){return Promise.resolve(Boolean("undefined"!=typeof window)&&Boolean(window.localStorage))}))}get(t){return _S(this,void 0,void 0,(function*(){const e=localStorage.getItem(this.getPrefixedKey(t));if(!e)return"object"==typeof HE[t]?JSON.parse(JSON.stringify(HE[t])):HE[t];try{return JSON.parse(e)}catch(t){return e}}))}set(t,e){return _S(this,void 0,void 0,(function*(){return"string"==typeof e?localStorage.setItem(this.getPrefixedKey(t),e):localStorage.setItem(this.getPrefixedKey(t),JSON.stringify(e))}))}delete(t){return _S(this,void 0,void 0,(function*(){return Promise.resolve(localStorage.removeItem(this.getPrefixedKey(t)))}))}getPrefixedKey(t){return this.prefix?`${this.prefix}-${t}`:t}}new nS("STORAGE");var bS=n(8764).Buffer,xS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class ES{serialize(t){return xS(this,void 0,void 0,(function*(){const e=JSON.stringify(t);return cE.encode(bS.from(e))}))}deserialize(t){return xS(this,void 0,void 0,(function*(){if("string"!=typeof t)throw new Error("Encoded payload needs to be a string");return JSON.parse(cE.decode(t).toString())}))}}var SS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class MS{constructor(t){this.storageManager=new XE(t,NE.APP_METADATA_LIST)}getAppMetadataList(){return SS(this,void 0,void 0,(function*(){return this.storageManager.getAll()}))}getAppMetadata(t){return SS(this,void 0,void 0,(function*(){return this.storageManager.getOne((e=>e.senderId===t))}))}addAppMetadata(t){return SS(this,void 0,void 0,(function*(){return this.storageManager.addOne(t,(e=>e.senderId===t.senderId))}))}removeAppMetadata(t){return SS(this,void 0,void 0,(function*(){return this.storageManager.remove((e=>e.senderId===t))}))}removeAppMetadatas(t){return SS(this,void 0,void 0,(function*(){return this.storageManager.remove((e=>t.includes(e.senderId)))}))}removeAllAppMetadata(){return SS(this,void 0,void 0,(function*(){return this.storageManager.removeAll()}))}}class TS extends sS{constructor(){super(PE.ABORTED_ERROR,"The action was aborted by the user."),this.name="UnknownBeaconError",this.title="Aborted"}}var AS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class RS{constructor(t,e){this.storageManager=new XE(t,e)}hasPeer(t){return AS(this,void 0,void 0,(function*(){return!!(yield this.getPeer(t))}))}getPeers(){return AS(this,void 0,void 0,(function*(){return this.storageManager.getAll()}))}getPeer(t){return AS(this,void 0,void 0,(function*(){return this.storageManager.getOne((e=>e.publicKey===t))}))}addPeer(t){return AS(this,void 0,void 0,(function*(){return this.storageManager.addOne(t,(e=>e.publicKey===t.publicKey))}))}removePeer(t){return AS(this,void 0,void 0,(function*(){return this.storageManager.remove((e=>e.publicKey===t))}))}removePeers(t){return AS(this,void 0,void 0,(function*(){return this.storageManager.remove((e=>t.includes(e.publicKey)))}))}removeAllPeers(){return AS(this,void 0,void 0,(function*(){return this.storageManager.removeAll()}))}}var LS=n(4826),CS=n(8764).Buffer,PS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class IS{constructor(t){this.keyPair=t}getPublicKey(){return PS(this,void 0,void 0,(function*(){return vE(this.keyPair.publicKey)}))}getPublicKeyHash(){return PS(this,void 0,void 0,(function*(){return _E(this.keyPair.publicKey)}))}createCryptoBoxServer(t,e){return PS(this,void 0,void 0,(function*(){return(0,LS.serverSessionKeys)({publicKey:(0,fE.SH)(e.publicKey),secretKey:(0,fE.zh)(e.secretKey)},(0,fE.SH)(CS.from(t,"hex")))}))}createCryptoBoxClient(t,e){return PS(this,void 0,void 0,(function*(){return(0,LS.clientSessionKeys)({publicKey:(0,fE.SH)(e.publicKey),secretKey:(0,fE.zh)(e.secretKey)},(0,fE.SH)(CS.from(t,"hex")))}))}encryptMessageAsymmetric(t,e){return PS(this,void 0,void 0,(function*(){return function(t,e){return yE(this,void 0,void 0,(function*(){const n=(0,fE.SH)(gE.from(e)),r=(0,uE.generateKeyPair)(),i=new pE.BLAKE2b(24).update(r.publicKey,32).update(n,32).digest(),o="string"==typeof t?(0,dE.cv)(t):t,s=(0,uE.box)(n,r.secretKey,i,o);return vE((0,mE.z)(r.publicKey,s))}))}(e,CS.from(t,"hex"))}))}}var OS=n(8764).Buffer,NS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class kS extends IS{constructor(t,e){super(e),this.name=t,this.init().catch(console.error)}start(){return NS(this,void 0,void 0,(function*(){yield Promise.resolve()}))}getPairingRequestInfo(){return NS(this,void 0,void 0,(function*(){return{id:yield FE(),type:"postmessage-pairing-request",name:this.name,version:"3",publicKey:yield this.getPublicKey()}}))}getPairingResponseInfo(t){return NS(this,void 0,void 0,(function*(){return{id:t.id,type:"postmessage-pairing-response",name:this.name,version:t.version,publicKey:yield this.getPublicKey()}}))}unsubscribeFromEncryptedMessage(t){return NS(this,void 0,void 0,(function*(){this.activeListeners.get(t)&&this.activeListeners.delete(t)}))}unsubscribeFromEncryptedMessages(){return NS(this,void 0,void 0,(function*(){this.activeListeners.clear()}))}decryptMessage(t,e){return NS(this,void 0,void 0,(function*(){const n=yield this.createCryptoBoxServer(t,this.keyPair),r=OS.from(e,"hex");if(r.length>=40)try{return yield xE(r,n.receive)}catch(t){}throw new Error("Could not decrypt message")}))}encryptMessage(t,e){return NS(this,void 0,void 0,(function*(){const n=yield this.createCryptoBoxClient(t,this.keyPair);return bE(e,n.send)}))}}class DS extends sS{constructor(){super(PE.SIGNATURE_TYPE_NOT_SUPPORTED,"The wallet is not able to sign payloads of this type."),this.name="SignatureTypeNotSupportedBeaconError",this.title="Signature Type Not Supported"}}var BS,US=n(9669),zS=n.n(US);!function(t){t.TEXT="m.text"}(BS||(BS={}));class FS{constructor(t,e,n,r){this.type=t,this.sender=e,this.content=n,this.timestamp=r}static from(t){if(GS(t))return new FS(t.content.msgtype,t.sender,t.content.body,t.origin_server_ts)}}const HS=t=>"m.room.message"===t.type,GS=t=>HS(t)&&t.content instanceof Object&&"msgtype"in t.content&&t.content.msgtype===BS.TEXT;var VS;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JOINED=1]="JOINED",t[t.INVITED=2]="INVITED",t[t.LEFT=3]="LEFT"}(VS||(VS={}));class jS{constructor(t,e=VS.UNKNOWN,n=[],r=[]){this.id=t,this.status=e,this.members=n,this.messages=r}static fromSync(t){var e,n,r;if(!t)return[];function i(t,e){return Object.entries(t).map((([t,n])=>e(t,n)))}return[...i(null!==(e=t.join)&&void 0!==e?e:{},jS.fromJoined),...i(null!==(n=t.invite)&&void 0!==n?n:{},jS.fromInvited),...i(null!==(r=t.leave)&&void 0!==r?r:{},jS.fromLeft)]}static from(t,e){return"string"==typeof t?new jS(t,e||VS.UNKNOWN):void 0!==e?new jS(t.id,e,t.members,t.messages):t}static merge(t,e){return e&&e.id===t.id?new jS(t.id,t.status,[...e.members,...t.members].filter(((t,e,n)=>n.indexOf(t)===e)),[...e.messages,...t.messages]):jS.from(t)}static fromJoined(t,e){const n=[...e.state.events,...e.timeline.events],r=jS.getMembersFromEvents(n),i=jS.getMessagesFromEvents(n);return new jS(t,VS.JOINED,r,i)}static fromInvited(t,e){const n=jS.getMembersFromEvents(e.invite_state.events);return new jS(t,VS.INVITED,n)}static fromLeft(t,e){const n=[...e.state.events,...e.timeline.events],r=jS.getMembersFromEvents(n),i=jS.getMessagesFromEvents(n);return new jS(t,VS.LEFT,r,i)}static getMembersFromEvents(t){return jS.getUniqueEvents(t.filter((t=>(t=>"m.room.create"===t.type&&t.content instanceof Object&&"creator"in t.content)(t)||(t=>"m.room.member"===t.type&&t.content instanceof Object&&"membership"in t.content&&"join"===t.content.membership)(t)))).map((t=>t.sender)).filter(((t,e,n)=>n.indexOf(t)===e))}static getMessagesFromEvents(t){return jS.getUniqueEvents(t.filter(HS)).map((t=>FS.from(t))).filter(Boolean)}static getUniqueEvents(t){const e={},n=[];return t.forEach(((t,r)=>{const i=t.event_id;void 0!==i&&i in e||(void 0!==i&&(e[i]=r),n.push(t))})),n}}var WS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const qS=["syncToken","rooms"];class KS{constructor(t){this.storage=t,this.state={isRunning:!1,userId:void 0,deviceId:void 0,txnNo:0,accessToken:void 0,syncToken:void 0,pollingTimeout:void 0,pollingRetries:0,rooms:{}},this.onStateChangedListeners=new Map,this.waitReadyPromise=new Promise(((t,e)=>WS(this,void 0,void 0,(function*(){try{yield this.initFromStorage(),t()}catch(t){e(t)}}))))}get(t){return this.state[t]}getRoom(t){const e=jS.from(t,VS.UNKNOWN);return this.state.rooms[e.id]||e}update(t){return WS(this,void 0,void 0,(function*(){yield this.waitReady();const e=Object.assign({},this.state);this.setState(t),this.updateStorage(t),this.notifyListeners(e,this.state,t)}))}onStateChanged(t,...e){e.length>0?e.forEach((e=>{this.onStateChangedListeners.set(e,t)})):this.onStateChangedListeners.set("all",t)}waitReady(){return WS(this,void 0,void 0,(function*(){return this.waitReadyPromise}))}initFromStorage(){return WS(this,void 0,void 0,(function*(){const t=yield this.storage.get(NE.MATRIX_PRESERVED_STATE);this.setState(t)}))}prepareData(t){const e=["rooms"].some((e=>void 0!==t[e]))?JSON.parse(JSON.stringify(t)):t;return Object.values(e.rooms||{}).forEach((t=>{t.messages=[]})),e}updateStorage(t){if(Object.entries(t).filter((([t,e])=>qS.includes(t)&&Boolean(e))).length>0){const t={};qS.forEach((e=>{t[e]=this.state[e]})),this.storage.set(NE.MATRIX_PRESERVED_STATE,this.prepareData(t))}}setState(t){this.state={isRunning:t.isRunning||this.state.isRunning,userId:t.userId||this.state.userId,deviceId:t.deviceId||this.state.deviceId,txnNo:t.txnNo||this.state.txnNo,accessToken:t.accessToken||this.state.accessToken,syncToken:t.syncToken||this.state.syncToken,pollingTimeout:t.pollingTimeout||this.state.pollingTimeout,pollingRetries:t.pollingRetries||this.state.pollingRetries,rooms:this.mergeRooms(this.state.rooms,t.rooms)}}mergeRooms(t,e){if(!e)return t;const n=Array.isArray(e)?e:Object.values(e),r=Object.assign({},t);return n.forEach((e=>{r[e.id]=jS.merge(e,t[e.id])})),r}notifyListeners(t,e,n){const r=this.onStateChangedListeners.get("all");r&&r(t,e,n),sE(n).filter((t=>void 0!==n[t])).forEach((r=>{const i=this.onStateChangedListeners.get(r);i&&i(t,e,n)}))}}var XS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const YS=new nS("MatrixHttpClient");class JS{constructor(t){this.baseUrl=t,this.cancelTokenSource=zS().CancelToken.source()}get(t,e,n){return XS(this,void 0,void 0,(function*(){return this.send("GET",t,n,e)}))}post(t,e,n,r){return XS(this,void 0,void 0,(function*(){return this.send("POST",t,n,r,e)}))}put(t,e,n,r){return XS(this,void 0,void 0,(function*(){return this.send("PUT",t,n,r,e)}))}cancelAllRequests(){return XS(this,void 0,void 0,(function*(){return this.cancelTokenSource.cancel("Manually cancelled")}))}send(t,e,n,r,i){return XS(this,void 0,void 0,(function*(){const o=n?this.getHeaders(n):void 0,s=r?this.getParams(r):void 0;let a;try{a=yield zS().request({method:t,url:e,baseURL:this.apiUrl("/_matrix/client/r0"),headers:o,data:i,params:s,cancelToken:this.cancelTokenSource.token})}catch(t){const e=t;throw YS.error("send",e.code,e.message,e.response.data),t.response.data}return a.data}))}getHeaders(t){const e={},n=[];if(t.accessToken&&n.push(["Authorization",`Bearer ${t.accessToken}`]),0!==n.length){for(const[t,r]of n)e[t]=r;return e}}getParams(t){if(!t)return;const e=Object.assign(t,{});return sE(e).forEach((t=>void 0===e[t]&&delete e[t])),e}apiUrl(...t){return[this.baseUrl.endsWith("/")?this.baseUrl.substr(0,this.baseUrl.length-1):this.baseUrl,...t.map((t=>t.startsWith("/")?t.substr(1):t))].join("/")}}var ZS=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class QS{constructor(t){this.httpClient=t}createRoom(t,e={}){return ZS(this,void 0,void 0,(function*(){return this.httpClient.post("/createRoom",e,{accessToken:t})}))}inviteToRoom(t,e,n){return ZS(this,void 0,void 0,(function*(){return n.status!==VS.JOINED&&n.status!==VS.UNKNOWN?Promise.reject(`User is not a member of room ${n.id}.`):this.httpClient.post(`/rooms/${encodeURIComponent(n.id)}/invite`,{user_id:e},{accessToken:t})}))}joinRoom(t,e){return ZS(this,void 0,void 0,(function*(){return e.status===VS.JOINED?Promise.resolve({room_id:e.id}):this.httpClient.post(`/rooms/${encodeURIComponent(e.id)}/join`,{},{accessToken:t})}))}getJoinedRooms(t){return ZS(this,void 0,void 0,(function*(){return this.httpClient.get("/joined_rooms",void 0,{accessToken:t})}))}}class $S{constructor(t){this.httpClient=t}login(t,e,n){return r=this,i=void 0,s=function*(){return this.httpClient.post("/login",{type:"m.login.password",identifier:{type:"m.id.user",user:t},password:e,device_id:n})},new((o=void 0)||(o=Promise))((function(t,e){function n(t){try{l(s.next(t))}catch(t){e(t)}}function a(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var r;e.done?t(e.value):(r=e.value,r instanceof o?r:new o((function(t){t(r)}))).then(n,a)}l((s=s.apply(r,i||[])).next())}));var r,i,o,s}}var tM,eM=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class nM{constructor(t){this.httpClient=t,this.cachedPromises=new Map}sync(t,e){return eM(this,void 0,void 0,(function*(){return this.withCache("sync",(()=>this.httpClient.get("/sync",{timeout:e?e.pollingTimeout:void 0,since:e?e.syncToken:void 0},{accessToken:t})))}))}sendMessage(t,e,n,r){return eM(this,void 0,void 0,(function*(){return new Promise(((i,o)=>this.scheduleEvent({accessToken:t,roomId:e,type:"m.room.message",content:n,txnId:r,onSuccess:i,onError:o})))}))}scheduleEvent(t){this.sendEvent(t)}sendEvent(t){return eM(this,void 0,void 0,(function*(){const{roomId:e,type:n,txnId:r,content:i,accessToken:o}=t;try{const s=yield this.httpClient.put(`/rooms/${encodeURIComponent(e)}/send/${n}/${encodeURIComponent(r)}`,i,{accessToken:o});t.onSuccess(s)}catch(e){t.onError(e)}}))}withCache(t,e){let n=this.cachedPromises.get(t);return n||(n=e().finally((()=>{this.cachedPromises.delete(t)})),this.cachedPromises.set(t,n)),n}}!function(t){t.INVITE="invite",t.MESSAGE="message"}(tM||(tM={}));class rM extends class{constructor(){this.events={}}on(t,e){return"object"!=typeof this.events[t]&&(this.events[t]=[]),this.events[t].push(e),()=>this.removeListener(t,e)}removeListener(t,e){if("object"!=typeof this.events[t])return;if(!e)return void(this.events[t]=[]);const n=this.events[t].indexOf(e);n>-1&&this.events[t].splice(n,1)}removeAllListeners(){Object.keys(this.events).forEach((t=>this.events[t].splice(0,this.events[t].length)))}emit(t,...e){"object"==typeof this.events[t]&&[...this.events[t]].forEach((t=>t.apply(this,e)))}once(t,e){const n=this.on(t,((...t)=>{n(),e.apply(this,t)}));return n}}{constructor(){super(...arguments),this.eventEmitProviders=new Map([[tM.INVITE,()=>[this.isInvite,this.emitInvite.bind(this)]],[tM.MESSAGE,()=>[this.isMessage,this.emitMessage.bind(this)]]])}onStateChanged(t,e,n){for(const t of sE(tM))this.emitIfEvent(tM[t],n)}emitIfEvent(t,e){const n=this.eventEmitProviders.get(t);if(n){const[r,i]=n();r(e)&&i(t,e)}}emitClientEvent(t,e,n){this.emit(t,{type:t,content:e,timestamp:n})}isInvite(t){return!!t.rooms&&t.rooms.some((t=>t.status===VS.INVITED))}emitInvite(t,e){e.rooms.filter((t=>t.status===VS.INVITED)).map((t=>[t.id,t.members])).forEach((([e,n])=>{this.emitClientEvent(t,{roomId:e,members:n})}))}isMessage(t){return!!t.rooms&&t.rooms.some((t=>t.messages.length>0))}emitMessage(t,e){e.rooms.filter((t=>t.messages.length>0)).map((t=>t.messages.map((e=>[t.id,e,e.timestamp])))).reduce(((t,e)=>t.concat(e)),[]).forEach((([e,n,r])=>{this.emitClientEvent(t,{roomId:e,message:n},r)}))}}var iM=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const oM=new nS("MatrixClient");class sM{constructor(t,e,n,r,i,o){this.store=t,this.eventEmitter=e,this.userService=n,this.roomService=r,this.eventService=i,this.httpClient=o,this.isActive=!0,this._isReady=new lE,this.store.onStateChanged(((t,e,n)=>{this.eventEmitter.onStateChanged(t,e,n)}),"rooms")}static create(t){const e=new KS(t.storage),n=new rM,r=new JS(t.baseUrl),i=new $S(r),o=new QS(r),s=new nM(r);return new sM(e,n,i,o,s,r)}get joinedRooms(){return new Promise((t=>iM(this,void 0,void 0,(function*(){yield this.isConnected(),t(Object.values(this.store.get("rooms")).filter((t=>t.status===VS.JOINED)))}))))}get invitedRooms(){return new Promise((t=>iM(this,void 0,void 0,(function*(){yield this.isConnected(),t(Object.values(this.store.get("rooms")).filter((t=>t.status===VS.INVITED)))}))))}get leftRooms(){return new Promise((t=>iM(this,void 0,void 0,(function*(){yield this.isConnected(),t(Object.values(this.store.get("rooms")).filter((t=>t.status===VS.LEFT)))}))))}start(t){return iM(this,void 0,void 0,(function*(){const e=yield this.userService.login(t.id,t.password,t.deviceId);yield this.store.update({accessToken:e.access_token});const n=new Promise(((t,e)=>iM(this,void 0,void 0,(function*(){yield this.poll(0,(e=>iM(this,void 0,void 0,(function*(){this.store.get("isRunning")||t(),yield this.store.update({isRunning:!0,syncToken:e.next_batch,pollingTimeout:3e4,pollingRetries:0,rooms:jS.fromSync(e.rooms)})}))),(t=>iM(this,void 0,void 0,(function*(){this.store.get("isRunning")||e(t),yield this.store.update({isRunning:!1,pollingRetries:this.store.get("pollingRetries")+1})}))))}))));return n.then((()=>{this._isReady.resolve()})).catch(console.error),n}))}isConnected(){return iM(this,void 0,void 0,(function*(){return this._isReady.promise}))}stop(){return iM(this,void 0,void 0,(function*(){return oM.log("MATRIX CLIENT STOPPED"),this.isActive=!1,this._isReady=new lE,this.httpClient.cancelAllRequests()}))}subscribe(t,e){this.eventEmitter.on(t,e)}unsubscribe(t,e){e&&this.eventEmitter.removeListener(t,e)}unsubscribeAll(t){this.eventEmitter.removeListener(t)}getRoomById(t){return iM(this,void 0,void 0,(function*(){return yield this.isConnected(),this.store.getRoom(t)}))}createTrustedPrivateRoom(...t){return iM(this,void 0,void 0,(function*(){return yield this.isConnected(),this.requiresAuthorization("createRoom",(e=>iM(this,void 0,void 0,(function*(){return(yield this.roomService.createRoom(e,{room_version:"5",invite:t,preset:"public_chat",is_direct:!0})).room_id}))))}))}inviteToRooms(t,...e){return iM(this,void 0,void 0,(function*(){yield this.isConnected(),yield this.requiresAuthorization("invite",(n=>Promise.all(e.map((e=>{const r=this.store.getRoom(e);this.roomService.inviteToRoom(n,t,r).catch((t=>oM.warn("inviteToRooms",t)))})))))}))}joinRooms(...t){return iM(this,void 0,void 0,(function*(){yield this.isConnected(),yield this.requiresAuthorization("join",(e=>Promise.all(t.map((t=>{const n=this.store.getRoom(t);return this.roomService.joinRoom(e,n)})))))}))}sendTextMessage(t,e){return iM(this,void 0,void 0,(function*(){yield this.isConnected(),yield this.requiresAuthorization("send",(n=>iM(this,void 0,void 0,(function*(){const r=yield this.createTxnId();return this.eventService.sendMessage(n,t,{msgtype:"m.text",body:e},r)}))))}))}poll(t,e,n){return iM(this,void 0,void 0,(function*(){const r=this.store,i=this.sync.bind(this),o=(s,a)=>iM(this,void 0,void 0,(function*(){let l=0;try{const n=yield i();e(n)}catch(t){n(t),l=r.get("pollingRetries"),this.isActive&&oM.log(`Retry syncing... ${l} retries so far`)}finally{this.isActive?setTimeout((()=>iM(this,void 0,void 0,(function*(){yield o(s,a)}))),l>3?5e3+t:t):a(new Error("Syncing stopped manually."))}}));return new Promise(o)}))}sync(){return iM(this,void 0,void 0,(function*(){return this.requiresAuthorization("sync",(t=>iM(this,void 0,void 0,(function*(){return this.eventService.sync(t,{pollingTimeout:this.store.get("pollingTimeout"),syncToken:this.store.get("syncToken")})}))))}))}requiresAuthorization(t,e){return iM(this,void 0,void 0,(function*(){const n=this.store.get("accessToken");return n?e(n):Promise.reject(`${t} requires authorization but no access token has been provided.`)}))}createTxnId(){return iM(this,void 0,void 0,(function*(){const t=(new Date).getTime(),e=this.store.get("txnNo");return yield this.store.update({txnNo:e+1}),`m${t}.${e}`}))}}var aM=n(8764).Buffer,lM=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const cM=new nS("P2PCommunicationClient"),uM=["beacon-node-1.diamond.papers.tech","beacon-node-1.sky.papers.tech","beacon-node-2.sky.papers.tech","beacon-node-1.hope.papers.tech","beacon-node-1.hope-2.papers.tech","beacon-node-1.hope-3.papers.tech","beacon-node-1.hope-4.papers.tech","beacon-node-1.hope-5.papers.tech"];class hM extends IS{constructor(t,e,n,r,i,o,s){super(e),this.name=t,this.replicationCount=n,this.storage=r,this.iconUrl=o,this.appUrl=s,this.client=new lE,this.activeListeners=new Map,this.ignoredRooms=[],this.loginCounter=0,cM.log("constructor","P2PCommunicationClient created");const a=i.length>0?i:uM;this.ENABLED_RELAY_SERVERS=a}getPairingRequestInfo(){return lM(this,void 0,void 0,(function*(){const t={id:yield FE(),type:"p2p-pairing-request",name:this.name,version:"3",publicKey:yield this.getPublicKey(),relayServer:yield this.getRelayServer()};return this.iconUrl&&(t.icon=this.iconUrl),this.appUrl&&(t.appUrl=this.appUrl),t}))}getPairingResponseInfo(t){return lM(this,void 0,void 0,(function*(){const e={id:t.id,type:"p2p-pairing-response",name:this.name,version:t.version,publicKey:yield this.getPublicKey(),relayServer:yield this.getRelayServer()};return this.iconUrl&&(e.icon=this.iconUrl),this.appUrl&&(e.appUrl=this.appUrl),e}))}getRelayServer(){return lM(this,void 0,void 0,(function*(){if(this.relayServer)return this.relayServer.promise;this.relayServer=new lE;const t=yield this.storage.get(NE.MATRIX_SELECTED_NODE);if(t&&t.length>0)return this.relayServer.resolve(t),t;const e=[...this.ENABLED_RELAY_SERVERS];for(;e.length>0;){const t=Math.floor(Math.random()*e.length),n=e[t];try{return yield zS().get(`https://${n}/_matrix/client/versions`),this.storage.set(NE.MATRIX_SELECTED_NODE,n).catch((t=>cM.log(t))),this.relayServer.resolve(n),n}catch(r){cM.log(`Ignoring server "${n}", trying another one...`),e.splice(t,1)}}throw this.relayServer.reject("No matrix server reachable!"),new Error("No matrix server reachable!")}))}tryJoinRooms(t,e=1){return lM(this,void 0,void 0,(function*(){try{yield(yield this.client.promise).joinRooms(t)}catch(n){e<=10&&"M_FORBIDDEN"===n.errcode?(cM.log("Retrying to join...",n),setTimeout((()=>lM(this,void 0,void 0,(function*(){yield this.tryJoinRooms(t,e+1)}))),200)):cM.log(`Failed to join after ${e} tries.`,n)}}))}start(){var t;return lM(this,void 0,void 0,(function*(){cM.log("start","starting client"),cM.log("start","connecting to server");const e=yield this.getRelayServer(),n=sM.create({baseUrl:`https://${e}`,storage:this.storage});this.initialListener=t=>lM(this,void 0,void 0,(function*(){this.initialEvent&&this.initialEvent.timestamp&&t&&t.timestamp?this.initialEvent.timestamp<t.timestamp&&(this.initialEvent=t):this.initialEvent=t})),n.subscribe(tM.MESSAGE,this.initialListener),n.subscribe(tM.INVITE,(t=>lM(this,void 0,void 0,(function*(){let e;1===t.content.members.length&&(e=t.content.members[0]),yield this.tryJoinRooms(t.content.roomId),e&&(yield this.updateRelayServer(e),yield this.updatePeerRoom(e,t.content.roomId))}))));const r=`login:${Math.floor(Date.now()/1e3/300)}`;cM.log("start",`login ${r}, ${yield this.getPublicKeyHash()} on ${e}`);const i=(0,pE.hash)((0,dE.cv)(r),32),o=null!==(t=this.keyPair.secretKey)&&void 0!==t?t:this.keyPair.privateKey,s=(0,fE.Xx)(o,i);try{yield n.start({id:yield this.getPublicKeyHash(),password:`ed:${vE(s)}:${yield this.getPublicKey()}`,deviceId:vE(this.keyPair.publicKey)})}catch(t){if(cM.error("start","Could not log in, retrying"),yield this.reset(),this.loginCounter<=this.ENABLED_RELAY_SERVERS.length)return this.loginCounter++,void this.start();throw cM.error("start","Tried to log in to every known beacon node, but no login was successful."),new Error("Could not connect to any beacon nodes. Try again later.")}cM.log("start","login successful, client is ready"),this.client.resolve(n)}))}stop(){return lM(this,void 0,void 0,(function*(){cM.log("stop","stopping client"),this.client.isResolved()&&(yield(yield this.client.promise).stop().catch((t=>cM.error(t)))),yield this.reset()}))}reset(){return lM(this,void 0,void 0,(function*(){cM.log("reset","resetting connection"),yield this.storage.delete(NE.MATRIX_PEER_ROOM_IDS).catch((t=>cM.log(t))),yield this.storage.delete(NE.MATRIX_PRESERVED_STATE).catch((t=>cM.log(t))),yield this.storage.delete(NE.MATRIX_SELECTED_NODE).catch((t=>cM.log(t))),this.relayServer=void 0,this.client=new lE,this.initialEvent=void 0,this.initialListener=void 0}))}listenForEncryptedMessage(t,e){return lM(this,void 0,void 0,(function*(){if(this.activeListeners.has(t))return;cM.log("listenForEncryptedMessage",`start listening for encrypted messages from publicKey ${t}`);const n=yield this.createCryptoBoxServer(t,this.keyPair),r=r=>lM(this,void 0,void 0,(function*(){if(this.isTextMessage(r.content)&&(yield this.isSender(r,t))){let i;yield this.updateRelayServer(r.content.message.sender),yield this.updatePeerRoom(r.content.message.sender,r.content.roomId);try{i=aM.from(r.content.message.content,"hex")}catch(t){}if(i&&i.length>=40)try{const r=yield xE(i,n.receive);cM.log("listenForEncryptedMessage",`received a message from ${t}`,r),e(r)}catch(t){}}}));this.activeListeners.set(t,r),(yield this.client.promise).subscribe(tM.MESSAGE,r);const i=this.initialEvent;i&&i.timestamp&&(new Date).getTime()-i.timestamp<3e5?(cM.log("listenForEncryptedMessage","Handling previous event"),yield r(i)):cM.log("listenForEncryptedMessage","No previous event found");const o=this.initialListener;o&&(yield this.client.promise).unsubscribe(tM.MESSAGE,o),this.initialListener=void 0,this.initialEvent=void 0}))}unsubscribeFromEncryptedMessage(t){return lM(this,void 0,void 0,(function*(){const e=this.activeListeners.get(t);e&&((yield this.client.promise).unsubscribe(tM.MESSAGE,e),this.activeListeners.delete(t))}))}unsubscribeFromEncryptedMessages(){return lM(this,void 0,void 0,(function*(){(yield this.client.promise).unsubscribeAll(tM.MESSAGE),this.activeListeners.clear()}))}sendMessage(t,e){return lM(this,void 0,void 0,(function*(){const n=yield this.createCryptoBoxClient(e.publicKey,this.keyPair),r=SE(yield _E(aM.from(e.publicKey,"hex")),e.relayServer),i=yield this.getRelevantRoom(r);yield this.waitForJoin(i);const o=yield bE(t,n.send);cM.log("sendMessage","sending encrypted message",e.publicKey,i,t),(yield this.client.promise).sendTextMessage(i,o).catch((t=>lM(this,void 0,void 0,(function*(){if("M_FORBIDDEN"===t.errcode){cM.log("sendMessage","M_FORBIDDEN",i,t),yield this.deleteRoomIdFromRooms(i);const e=yield this.getRelevantRoom(r);cM.log("sendMessage","Old room deleted, new room created",e),(yield this.client.promise).sendTextMessage(e,o).catch((t=>lM(this,void 0,void 0,(function*(){cM.log("sendMessage","inner error",e,t)}))))}else cM.log("sendMessage","unexpected error",t)}))))}))}updatePeerRoom(t,e){return lM(this,void 0,void 0,(function*(){cM.log("updatePeerRoom",t,e);const n=t.split(":");if(n.length<2||!n[0].startsWith("@"))throw new Error("Invalid sender");const r=yield this.storage.get(NE.MATRIX_PEER_ROOM_IDS),i=r[t];i===e&&cM.debug("updatePeerRoom","rooms are the same, not updating"),cM.debug("updatePeerRoom","current room",i,"new room",e),i&&i[1]&&(cM.log("updatePeerRoom",`adding room "${i[1]}" to ignored array`),this.ignoredRooms.push(i[1])),r[t]=e,yield this.storage.set(NE.MATRIX_PEER_ROOM_IDS,r)}))}deleteRoomIdFromRooms(t){return lM(this,void 0,void 0,(function*(){const e=yield this.storage.get(NE.MATRIX_PEER_ROOM_IDS),n=Object.entries(e).filter((e=>e[1]!==t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e[0]]:e[1]})),{});yield this.storage.set(NE.MATRIX_PEER_ROOM_IDS,n),this.ignoredRooms.push(t)}))}listenForChannelOpening(t){return lM(this,void 0,void 0,(function*(){cM.debug("listenForChannelOpening"),(yield this.client.promise).subscribe(tM.MESSAGE,(e=>lM(this,void 0,void 0,(function*(){if(this.isTextMessage(e.content)&&(yield this.isChannelOpenMessage(e.content))){cM.log("listenForChannelOpening","channel opening received, trying to decrypt",JSON.stringify(e)),yield this.updateRelayServer(e.content.message.sender),yield this.updatePeerRoom(e.content.message.sender,e.content.roomId);const n=e.content.message.content.split(":"),r=aM.from(n[n.length-1],"hex");if(r.length>=40)try{const e=JSON.parse(yield EE(r,this.keyPair.publicKey,this.keyPair.secretKey));cM.log("listenForChannelOpening","channel opening received and decrypted",JSON.stringify(e)),t(Object.assign(Object.assign({},e),{senderId:yield tS(e.publicKey)}))}catch(t){}}}))))}))}waitForJoin(t,e=0){return lM(this,void 0,void 0,(function*(){const n=yield(yield this.client.promise).getRoomById(t);if(cM.log("waitForJoin",`Currently ${n.members.length} members, we need at least 2`),!(n.members.length>=2||0===n.members.length)){if(e<=200)return cM.log(`Waiting for join... Try: ${e}`),new Promise((n=>{setTimeout((()=>lM(this,void 0,void 0,(function*(){n(this.waitForJoin(t,e+1))}))),100*(e>50?10:1))}));throw new Error(`No one joined after ${e} tries.`)}}))}sendPairingResponse(t){return lM(this,void 0,void 0,(function*(){cM.log("sendPairingResponse");const e=SE(yield _E(aM.from(t.publicKey,"hex")),t.relayServer),n=yield(yield this.client.promise).createTrustedPrivateRoom(e);cM.debug("sendPairingResponse",`Connecting to room "${n}"`),yield this.updatePeerRoom(e,n),yield this.waitForJoin(n),cM.debug("sendPairingResponse","Successfully joined room.");const r=void 0===t.version?yield this.getPublicKey():JSON.stringify(yield this.getPairingResponseInfo(t));cM.debug("sendPairingResponse","Sending pairing response",r);const i=yield this.encryptMessageAsymmetric(t.publicKey,r),o=["@channel-open",e,i].join(":");(yield this.client.promise).sendTextMessage(n,o).catch((t=>lM(this,void 0,void 0,(function*(){if("M_FORBIDDEN"===t.errcode){cM.log("sendPairingResponse","M_FORBIDDEN",n,t),yield this.deleteRoomIdFromRooms(n);const r=yield this.getRelevantRoom(e);cM.log("sendPairingResponse","Old room deleted, new room created",r),(yield this.client.promise).sendTextMessage(r,o).catch((t=>lM(this,void 0,void 0,(function*(){cM.log("sendPairingResponse","inner error",r,t)}))))}else cM.log("sendPairingResponse","unexpected error",t)}))))}))}isTextMessage(t){return t.message.type===BS.TEXT}updateRelayServer(t){return lM(this,void 0,void 0,(function*(){cM.log("updateRelayServer",t);const e=t.split(":");if(e.length<2||!e[0].startsWith("@"))throw new Error("Invalid sender");const n=e.shift(),r=e.join(":"),i=localStorage.getItem("beacon:communication-peers-dapp")?new RS(this.storage,NE.TRANSPORT_P2P_PEERS_DAPP):new RS(this.storage,NE.TRANSPORT_P2P_PEERS_WALLET),o=(yield i.getPeers()).map((t=>lM(this,void 0,void 0,(function*(){`@${yield _E(aM.from(t.publicKey,"hex"))}`===n&&t.relayServer!==r&&(t.relayServer=r,yield i.addPeer(t))}))));yield Promise.all(o)}))}isChannelOpenMessage(t){return lM(this,void 0,void 0,(function*(){return t.message.content.startsWith(`@channel-open:@${yield _E(aM.from(yield this.getPublicKey(),"hex"))}`)}))}isSender(t,e){return lM(this,void 0,void 0,(function*(){return t.content.message.sender.startsWith(`@${yield _E(aM.from(e,"hex"))}`)}))}getRelevantRoom(t){return lM(this,void 0,void 0,(function*(){const e=yield this.storage.get(NE.MATRIX_PEER_ROOM_IDS);let n=e[t];if(!n){cM.log("getRelevantRoom",`No room found for peer ${t}, checking joined ones.`);const r=yield this.getRelevantJoinedRoom(t);n=r.id,e[t]=r.id,yield this.storage.set(NE.MATRIX_PEER_ROOM_IDS,e)}return cM.log("getRelevantRoom",`Using room ${n}`),n}))}getRelevantJoinedRoom(t){return lM(this,void 0,void 0,(function*(){const e=yield(yield this.client.promise).joinedRooms;cM.log("checking joined rooms",e,t);const n=e.filter((t=>!this.ignoredRooms.some((e=>t.id===e)))).filter((e=>e.members.some((e=>e===t))));let r;if(0===n.length||this.ignoredRooms.length>0){cM.log("getRelevantJoinedRoom","no relevant rooms found, creating new one");const e=yield(yield this.client.promise).createTrustedPrivateRoom(t);r=yield(yield this.client.promise).getRoomById(e),cM.log("getRelevantJoinedRoom",`waiting for other party to join room: ${r.id}`),yield this.waitForJoin(e),cM.log("getRelevantJoinedRoom",`new room created and peer invited: ${r.id}`)}else r=n[0],cM.log("getRelevantJoinedRoom",`channel already open, reusing room ${r.id}`);return r}))}}var dM=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const pM=new nS("P2PTransport");class fM extends vS{constructor(t,e,n,r,i,o,s){super(t,new hM(t,e,1,n,r,o,s),new RS(n,i)),this.type=OE.P2P}static isAvailable(){return dM(this,void 0,void 0,(function*(){return Promise.resolve(!0)}))}connect(){const t=Object.create(null,{connect:{get:()=>super.connect}});return dM(this,void 0,void 0,(function*(){if(this._isConnected!==IE.NOT_CONNECTED)return;pM.log("connect"),this._isConnected=IE.CONNECTING,yield this.client.start();const e=yield this.getPeers();if(e.length>0){pM.log("connect",`connecting to ${e.length} peers`);const t=e.map((t=>dM(this,void 0,void 0,(function*(){return this.listen(t.publicKey)}))));Promise.all(t).catch((t=>pM.error("connect",t)))}return yield this.startOpenChannelListener(),t.connect.call(this)}))}disconnect(){const t=Object.create(null,{disconnect:{get:()=>super.disconnect}});return dM(this,void 0,void 0,(function*(){return yield this.client.stop(),t.disconnect.call(this)}))}startOpenChannelListener(){return dM(this,void 0,void 0,(function*(){}))}getPairingRequestInfo(){return dM(this,void 0,void 0,(function*(){return this.client.getPairingRequestInfo()}))}listen(t){return dM(this,void 0,void 0,(function*(){yield this.client.listenForEncryptedMessage(t,(e=>{const n={origin:LE.P2P,id:t};this.notifyListeners(e,n).catch((t=>{throw t}))})).catch((t=>{throw t}))}))}}var mM=n(8764).Buffer,gM=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class yM extends kS{constructor(){super(...arguments),this.activeListeners=new Map}init(){return gM(this,void 0,void 0,(function*(){this.subscribeToMessages().catch(console.error)}))}listenForEncryptedMessage(t,e){return gM(this,void 0,void 0,(function*(){this.activeListeners.has(t)||this.activeListeners.set(t,((n,r)=>gM(this,void 0,void 0,(function*(){try{const i=yield this.decryptMessage(t,n.encryptedPayload);e(i,r)}catch(t){}}))))}))}sendMessage(t,e){var n;return gM(this,void 0,void 0,(function*(){const r=yield this.encryptMessage(e.publicKey,t),i=null===(n=e)||void 0===n?void 0:n.extensionId,o={target:CE.EXTENSION,encryptedPayload:r,targetId:i};WE.postMessage(o,WE.location.origin)}))}listenForChannelOpening(t){return gM(this,void 0,void 0,(function*(){WE.addEventListener("message",(e=>gM(this,void 0,void 0,(function*(){var n,r;if(e.source!==WE||e.origin!==WE.location.origin)return;const i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.message;if(i&&i.target===CE.PAGE&&(yield this.isChannelOpenMessage(i))){const n=mM.from(i.payload,"hex");if(n.length>=40)try{const i=JSON.parse(yield EE(n,this.keyPair.publicKey,this.keyPair.secretKey));t(Object.assign(Object.assign({},i),{senderId:yield tS(i.publicKey),extensionId:null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.sender.id}))}catch(t){}}}))))}))}sendPairingRequest(t){return gM(this,void 0,void 0,(function*(){const e={target:CE.EXTENSION,payload:yield(new ES).serialize(yield this.getPairingRequestInfo()),targetId:t};WE.postMessage(e,WE.location.origin)}))}isChannelOpenMessage(t){return gM(this,void 0,void 0,(function*(){return"object"==typeof t&&t.hasOwnProperty("payload")}))}subscribeToMessages(){return gM(this,void 0,void 0,(function*(){WE.addEventListener("message",(t=>{if(t.source===WE&&t.origin===WE.location.origin&&"object"==typeof t&&t){const e=t.data;e.message&&e.message.target===CE.PAGE&&this.activeListeners.forEach((t=>{t(e.message,{origin:LE.EXTENSION,id:e.sender.id||""})}))}}))}))}}var vM=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const _M=new nS("PostMessageTransport");let wM,bM,xM=!1;class EM extends vS{constructor(t,e,n,r){super(t,new yM(t,e),new RS(n,r)),this.type=OE.POST_MESSAGE}static isAvailable(){return vM(this,void 0,void 0,(function*(){return new Promise((t=>{const e=n=>{const r=n.data;r&&"pong"===r.payload&&(t(!0),WE.removeEventListener("message",e))};WE.addEventListener("message",e);const n={target:CE.EXTENSION,payload:"ping"};WE.postMessage(n,WE.location.origin)}))}))}static getAvailableExtensions(){return vM(this,void 0,void 0,(function*(){return wM||bM||(bM=[],wM=new Promise((t=>{EM.listenForExtensions(),setTimeout((()=>{t(null!=bM?bM:[])}),1e3)})).finally((()=>{wM=void 0})),wM)}))}static listenForExtensions(){if(xM)return;WE.addEventListener("message",(t=>{if(t.source!==WE||t.origin!==WE.location.origin)return;const e=t.data,n=e.sender;var r;e&&"pong"===e.payload&&n&&(_M.log("getAvailableExtensions",`extension "${n.name}" is available`,n),r=n,bM||(bM=[]),bM.some((t=>t.id===r.id))||(bM.push(r),WE.postMessage("extensionsUpdated",WE.location.origin)))}));const t={target:CE.EXTENSION,payload:"ping"};WE.postMessage(t,WE.location.origin),xM=!0}connect(){const t=Object.create(null,{connect:{get:()=>super.connect}});return vM(this,void 0,void 0,(function*(){if(_M.log("connect"),this._isConnected!==IE.NOT_CONNECTED)return;this._isConnected=IE.CONNECTING;const e=yield this.getPeers();if(e.length>0){_M.log("connect",`connecting to ${e.length} peers`);const t=e.map((t=>vM(this,void 0,void 0,(function*(){return this.listen(t.publicKey)}))));Promise.all(t).catch((t=>_M.error("connect",t)))}yield this.startOpenChannelListener(),yield t.connect.call(this)}))}startOpenChannelListener(){return vM(this,void 0,void 0,(function*(){}))}getPairingRequestInfo(){return vM(this,void 0,void 0,(function*(){return this.client.getPairingRequestInfo()}))}listen(t){return vM(this,void 0,void 0,(function*(){_M.log("listen",t),yield this.client.listenForEncryptedMessage(t,((t,e)=>{const n={origin:LE.EXTENSION,id:e.id};this.notifyListeners(t,n).catch((t=>{throw t}))})).catch((t=>{throw t}))}))}}const SM=":host {\n  --animation-duration: 300ms;\n  all: initial;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes fadeOut {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n\n.animated {\n  animation-duration: var(--animation-duration);\n  animation-fill-mode: both;\n}\n\n.fadeIn {\n  animation-name: fadeIn;\n}\n\n.fadeOut {\n  animation-name: fadeOut;\n}\n\n.beacon-modal__wrapper {\n  position: relative;\n  top: 0;\n  display: inline-block;\n  z-index: 2147483000;\n  max-width: 500px;\n  width: 80%;\n  padding: 24px;\n}\n\n@media (min-height: 700px) {\n  .beacon-modal__wrapper {\n    top: 50%;\n    transform: translateY(-50%);\n  }\n}\n\n.theme__light .beacon-modal__base,\n.theme__light .beacon-modal__close__wrapper {\n  background: #fff;\n}\n\n.theme__dark .beacon-modal__base,\n.theme__dark .beacon-modal__close__wrapper {\n  background: #27334c;\n}\n\n.beacon-modal__base,\n.beacon-modal__close__wrapper {\n  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.1);\n}\n\n.beacon-modal__base {\n  margin: 0 auto;\n  border-radius: 32px;\n  overflow: hidden;\n}\n\n.beacon-modal__header {\n  padding: 16px 0;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.beacon-modal__headerLogo {\n  width: 100%;\n  max-width: 320px;\n  margin: 20px auto;\n  height: 100%;\n}\n\na,\nbutton {\n  cursor: pointer;\n}\n\n.beacon-modal__close__wrapper {\n  position: absolute;\n  top: 44px;\n  right: 24px;\n  z-index: 10000;\n  cursor: pointer;\n  border-radius: 100%;\n}\n\n.beacon-modal__close__icon {\n  width: 16px;\n  height: 16px;\n  position: relative;\n  top: 0;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transform: rotate(45deg);\n  margin: 8px;\n}\n\n.beacon-modal__close__line1 {\n  position: absolute;\n  width: 90%;\n}\n\n.beacon-modal__close__line2 {\n  position: absolute;\n  width: 90%;\n  transform: rotate(90deg);\n}\n\n.theme__light .beacon-modal__close__line2,\n.theme__light .beacon-modal__close__line1 {\n  border: 1px solid #000;\n}\n\n.theme__dark .beacon-modal__close__line2,\n.theme__dark .beacon-modal__close__line1 {\n  border: 1px solid #fff;\n}\n\n.beacon-alert__base {\n  position: fixed;\n  overflow-y: scroll;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 2147482999;\n  background-color: rgb(17 17 17 / 0.84);\n  text-align: center;\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n  font-family: Roboto, Helvetica, sans-serif;\n}\n\n.beacon-alert__base::-webkit-scrollbar {\n  display: none;\n}\n\n.beacon-alert__title {\n  text-align: center;\n}\n\n.beacon-alert__text,\n.beacon-alert__title {\n  margin: 0 auto;\n  padding: 0 0 24px;\n}\n\n.margin__bottom {\n  margin-bottom: 16px;\n}\n\n.beacon-alert__title {\n  font-size: 18px;\n}\n\n.theme__light .beacon-alert__title {\n  color: #3b3d40;\n}\n\n.theme__dark .beacon-alert__title,\n.theme__dark .beacon-alert__text {\n  color: #7c99d6;\n}\n\n.beacon-alert__text {\n  color: #000;\n  font-size: 14px;\n}\n\n.beacon-modal__button,\n.beacon-modal__button--outline {\n  height: 36px;\n  font-size: 14px;\n  letter-spacing: 0.84px;\n  margin-bottom: 4px;\n  margin-inline-end: 2px;\n  margin-inline-start: 2px;\n  margin-left: 2px;\n  margin-right: 2px;\n  margin-top: 4px;\n  padding-inline-end: 15.4px;\n  padding-inline-start: 15.4px;\n  padding-left: 15.4px;\n  padding-right: 15.4px;\n  overflow-wrap: break-word;\n  pointer-events: auto;\n  text-align: center;\n  border-radius: 4px;\n  border: 2px solid #3880ff;\n}\n\n.beacon-modal__button {\n  background: #3880ff;\n  color: #fff;\n}\n\n.beacon-modal__button--outline {\n  background: #fff;\n  color: #444444;\n  border: 1px solid #444444;\n}\n\n.beacon-alert__image {\n  width: 200px;\n  height: 200px;\n  box-sizing: border-box;\n  box-shadow: 0 10px 20px 0 rgba(17, 17, 17, 0.12);\n  border: 1px solid rgba(17, 17, 17, 0.04);\n  border-radius: 16px;\n}\n.connect__btn {\n  margin: 24px 0;\n  width: 100%;\n}\n\n#beacon-modal__content {\n  padding: 24px;\n}\n\n#beacon-switch {\n  margin-top: 24px;\n}\n\n#beacon-title {\n  margin: 0 0 24px;\n}\n\na {\n  text-decoration: none;\n}\n\npre {\n  white-space: pre-wrap; /* css-3 */\n  white-space: -moz-pre-wrap; /* Mozilla, since 1999 */\n  white-space: -pre-wrap; /* Opera 4-6 */\n  white-space: -o-pre-wrap; /* Opera 7 */\n  word-wrap: break-word; /* Internet Explorer 5.5+ */\n  padding: 16px;\n  background: #ececec;\n  line-height: 1.25rem;\n}\n",MM="#beacon-main-text {\n  display: initial;\n}\n.beacon-selection__container {\n  padding: 16px 16px 0;\n}\n.beacon-selection__list {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  text-decoration: none;\n  padding-bottom: 12px;\n  align-items: center;\n}\n.beacon-list__title {\n  text-align: left;\n  font-size: 12px;\n}\n.beacon-list__wrapper:nth-child(-n + 3) {\n  padding: 0 0 1rem;\n}\n.theme__light .beacon-list__title {\n  color: #7c828b;\n}\n.theme__dark .beacon-list__title,\n.theme__dark #beacon--disclaimer {\n  color: #7c99d6;\n}\n\n.beacon-selection__name {\n  font-size: 1rem;\n  font-weight: 600;\n  text-align: left;\n}\n.theme__light .beacon-selection__name,\n.theme__light .beacon--selection__name__lg {\n  color: #3b3d40;\n}\n.theme__dark .beacon-selection__name,\n.theme__dark .beacon--selection__name__lg {\n  color: #6183ff;\n}\n.beacon-selection__img {\n  width: 48px;\n  height: 48px;\n  box-shadow: 0 4px 12px 0 rgba(17, 17, 17, 0.24);\n  border-radius: 16px;\n  background-color: #fff;\n}\n.beacon--selection__name__lg {\n  font-size: 1.5rem;\n  font-weight: 600;\n  text-align: center;\n  padding: 1rem 0;\n}\n.beacon--selected__container {\n  padding: 2rem 0 0;\n}\n#beacon--qr__copy__container {\n  height: 0;\n}\n#beacon--qr__copy {\n  display: none;\n  position: relative;\n  margin-top: auto;\n  margin-left: auto;\n  margin-right: auto;\n}\n#beacon--qr__container {\n  margin-left: auto;\n  margin-right: auto;\n}\n#beacon--qr__container:hover #beacon--qr__copy {\n  display: block;\n}\n\n.disabled p {\n  text-align: left;\n  margin: 0;\n  font-size: 10px;\n  font-weight: 300;\n  opacity: 0.48;\n}\n\n#beacon--disclaimer {\n  text-align: left;\n  padding-top: 24px;\n  font-size: 0.875rem;\n}\n.progress-line,\n.progress-line:before {\n  height: 3px;\n  width: -webkit-fill-available;\n  margin-left: -24px;\n  margin-right: -24px;\n}\n.progress-line {\n  background-color: #a7c4f7;\n  display: -webkit-flex;\n  display: flex;\n}\n.progress-line:before {\n  background-color: #3880ff;\n  content: '';\n  -webkit-animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n  animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n}\n@-webkit-keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n@keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n",TM=(t,e)=>e.test(t.navigator.userAgent),AM=t=>((t,e)=>t.matchMedia("(any-pointer:coarse)").matches)(t),RM=t=>TM(t,/iPhone|iPod/i)||(t=>!!TM(t,/iPad/i)||!(!TM(t,/Macintosh/i)||!AM(t)))(t),LM=t=>TM(t,/android|sink/i);var CM=n(6192);const PM=new nS("QR"),IM=(t,e)=>`${t}?type=tzip10&data=${e}`;var OM=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};let NM=[{key:"galleon_desktop",name:"Galleon",shortName:"Galleon",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAN6ElEQVR4Ad3BC3SW9X3A8e/v/7yX3IAQCLdwhyCKGlARRBRorbdZaWu1lx27Xlydp+txW1vtXLs2nh0723o6e13VdhU7dahzFdGCchOEAAICohAScg/kfnnzXvI+z/P/7U0lPVlGIIE31O3zEYaZqoI2OerlTLfqzzJGJnmJ7rxAOJiFVZP0bTJkJKJOoEGUanGkFMdvhxGICMNNSDNVhY62IBnBpSpcD+5SVRagZINyRiIKUilGSnDZJMZ5lYycWhFhOAhpoloBfv6Vat0vqdXbUB1DOohYEXbiOE+JJJ/GjO0QEdJFOEdquyQRdz8WDsj9av1FDCeRTjHBXx1vbPnhpIJd9SJ3cK6Es6SqqI0tU899BOtfzvkkEhcn9KgY7yFxciOcA+EsWK87Dxv7kfr2TkD4UxFTK478tQRG/U5EOBvCEKgqfjK2QrR7FaqT+YAQE3wiltR7c0aMijFEDoOkWoF6oW/gJ54EcvkgUXtZKCC3fLf4W+uKH3yonSFwGAS11vG73V9i7TcBwweR6gTr+5/+bvHfbC5+8JF6BsnhDDQRDagXexrkc3zACeSgwU8X33//tuLvPVzNIDichlrfqO3+jar/Gf7vCKsjnywu/vbrxQ8+VM8ZOAxAVfGT7Q+j/j0MM5vsRpwAaRS2vr+y+MFvvVD84PfaOQ3DAGyy689F9RsMIzfSRndLA1UvPkW6CYy3rn0x2R3P4jQMp6Be9wVY95cMM7ezDT/RRe3a1cSO15B26hcFSD6qqgzE0I/aSMB6sadAszlPrO9R/uSPGQ5qvbvUi6xkAIZ+1NevonYh51nr/t207HmT4aC+9zP14yM4BUMf6sfHqe99hz+R8qd+hnoeaadaoL77gOpq+jOcpKokE7EHUB3FeeDFuvBiXfQVb6in9vfPMxzUevdGI9dNoh/DSWqTEwKOfJnzpOLZx/DicfqrfvEp3K5O0k41MyvD+bqq0pehl9/1V6hmch50lr1L/WsvcSpeLErVC79hOKj1v4StG0UfhhS10YBauYvzQK1P6eM/BFUGUv/6SySajpN2qiPVjvgsfRhS1Pc+jGoB50Ht2tVEq49xOup5VD73a4aD+v6dqkovo6rg2ds4DxJNJ6h6/jcMRuO214nVVZN2yiKiHZM5ydDUKCp6M+fB0V//CD/ZzWCoKlX/+STpp0aN3sRJhrwRc1AKGGZNJZtofXsnQ9G0YyPxEzWknWNWqCo9jNrkYlCGkxfrouzJnzBUqkrNmv8g3VTtYminhwEpYphVPPsYyfZWzkbD1nW4kQ7SS6fjB3JJMVh7AcOo8+gh6l9fw9myrsuJTWtJK1VRnzmkGIWpDBP1fUof/yGoci6Ob3wZVEknC1NJMaDjGSY1Lz9DtKaCcxVvqKf93X2kk7H+eFIMMJJhEG+oo+qFVaTL8U1rSSdfdQQpBtUQw+DoE49g3STp0rxrK148Sro4jgmRYgBLmjW88Xva3tlLOlk3SVPJJtJGxJJiEBMjjdxIO+VP/Zzh0LjtddLFT7oxUgxoK2lUvupnuF2dDIf29/aT7GglHZxQqJUUA1LHIFlrUQbWdmA3Ddte438TQAABBBAQ+hAGRZWW3dtIB1XqSQkI5phil3AG1lruL/457ZEY//T3dzE+P4/+wmPGMf87P+Z/EFKEPxAQThIwoRA9ir79I1BlMMKjx3LuBEHKSQlgvEP4nFYy6fL14l+wbssuetz02fv4yuc/zp133EAoGKCXk5FFtPYYg9Xd2kCPcN54BkVh5OyLOGdCVIKRSlICSOgtSDKQxuZ27v2HR9l76Ci9ovEE3//FM6x6fh1f/PTNfPKjy8jOyiQ0egxNJZtpKtnCcJj9hXsxwSBDYa3ltS17eOfdMv72nk9hjCFlHzLBJyUgSd2pjrioBuln85v7eOCfH6elrZNTOdHUykM/+S3/8thzXL98ITcsX8hVf/lNUEvTzq2k0+zP30vB9R9nMKxV9h8qY/2W3bz82nYaW9rpUd/QwsP/eA/BYHibiNAjQDQRkVGh7ar+Mk5qaGrl+z99hpc37GAwYt3d/Ne6bfxu3TYcY5hXOJWrE1nMz4iRDi9E80luOMYFFauZUjCO/DG55ORk4WDw1CcSidLY0k5VbQOHj1ax/1AZXfEE/b28sYSW9ghfu/v29ZwkpNhE+9+p+o80NrXx62de4ZkXXyfhuvQwIiiKtSACRgQFVJXTcUS5e0wr8zPjnItn23PZGMmhPxFSBFRRhkJa4k2HJ9ZVH3NJCZCy6ulnV+8+WPf998pqnDmzp3PNVQvooVZRAd9TMsLg++C6EAg6gI+Ig7VKIGA4VlVHWUUNyvt8FX7Zksfn89qYGkpyNkrcsTiXXc0NpIhQXllLWUUNiKBKijJUin2+rvqYy0kBepi5tT4n1o8ckXPTpq07sYAqgyICapUZUydx3bLFiCrGMRyrqqO0vIpfteQhDJ1y0pad/IEqs2ZM5vrlV4EqIhBLJDlaXkV9YzOO46CqnEnCDf4bfQgnTbtk5U3BUPIV0kGVGVMLuGDWNKwq8USCnXvfIel6pI0qmeEQhbOmM3H8GHzf8j5FRFCrBEMhPN9HfZduV/HV7nzj1R2LKys300s4KTD/MpnmjNsryHzOgghY35I/ZjSTC8YzJncUoVCIZLKb7KxsFl5xCQcOHKa5rR0siAHHOPjWJxwOknQ9GpvbqKiqIxKNImI4WyKCquK7HggEwyFCJkA4y3xiz8YXX6QPoY+pl3/01hDe7xgEVSU/L5eLLyok6Bh6iDE0t7RRU3eC5tZOPM8lEAzSQ1XpTwQEwfU8Ao7D+Pw8ZkwrYGRODmotCBw6coza442ICOfG7Kn0Wei9vVbpI0AfsUT1S8HgxI3iyIc4BccYFi6Yx6gR2YDQ3NLG9p37SHo+p+IEAqgqA1EFRXEcBwVONLVyoqmVXgJ87o5b6IrGiMYSHK2opryiBkQYIk3GE1/z3t2g9CP0M6Xo2gvDgex9QJgeqswtnMGMKZPwrWXX3ndoj3QhAoKgpKiipN81VxbR1NbJ4aMVqCqFM6cyZ8YURAxbS/bSGY0xGKr+qvLwlL9gx6/oT+jv9tuZVRa7LxDg4aWLFpCdmUEymcQ4BmsVARQLOCjvM6KoVUSEHj5wtKySmvoGEGGoFLhpxVW8d7SSqtrj9DU2L5eii+bQnXQZNSKbg++VU11/nIEI1HZ1ZRcdP/J8K6cgnMLd93zFXLH42nVHSyuv64onKK+qpbyiBjEGVeVMHCMUzpzOtMnjQZWE67HzrYMkkknOJOA4rLxxGZve3ENrewd9BRyHlTcu5/mXNyACqHLpRYVcueASXt24jboTTfTj+9Z+pGLfuk0MQBjAvKU35yei/i4xZjrnKBwKseSKS8nMCHO4rJJj1XWcSu7IHK67djFr1m2h23XpS4DbbrmONes20+169LrmyiKq6hoZm5dLwYSxbN25j/bOLnq4ycR9Eqn4QWVlJQMRTmPCrI9cnJMbeAMYTTqoMrdwJrOnFVBaUU3psWp6zZ09nakFE1i/pYT+FFh54wq2vLmTjkiMXpdfOpdorJvDZRX0EOCaxZeRGQ6xedvbj3eM9b5c+8oaTsfhNLrajjVOnFH4hu9zBxAmRQRUwXoWtRaL4DgGYRBEaG5tp7SimrGjc7l64Xyam9tZumgB8XiCHXsO0J8RuO3mFWx+8y06IlF6zb+oEAEOHi6nr6ra4zQ2Na1+4tEHvvjIfd9QzkAYhE996atXjcoZvTZgzGirihEwThAERC1J1wUMxoAxhtb2CAcOHSHpeigDK5iQzyf+7MOsWr2GjkiU/jJCIT56wzJe3bCNrlicXpfOLSQUNLx18Aj9+RL87fjM6BdKtm7wGARhkBbfcvvFTfWda0TMdE5DVckbNZKii+cQCgYQMZRVVFNWWYuI0CM7K4PlS66gsamV3fsPAUJ/UyaO4/KiC1mzfiu+tfS6/JILAGXPwVL6s+r+oK3KfrOtZaNlkIQhmHHhsnwysp52DNcxWKoUzpzKzOlTCAUcfN+SSCTZsmMPvlr6U4VrFy3A8z127DlIX1cvLKKto4t3S8vpJxpL2rtDGa3/Xrl7N0MhDFHBkmtNOJH5dSPmQSDMIMyYMomL5syksyvKm7vexqpyKuPGjmbpwgVs27WPxpY2eglw04eXcuhIOVW1x+lL0d3GDd159MBLRzgLwtm4/XYmVMcvzEqYn5qA+yFOIRQMsGRhEVkZGVTU1PFeaQWIcCrhYJAVS6+kIxJh++4DiPBHeaNGsGLpItZv3k4kGuOPNNDRnbTFMXPiJy0H9nicJeEc5M6YQzB/zq0jfa9YkPkoFM0rZNL4fJKux/bd+4l3dzOQjFCIa6+6DBQ273iLpOvxR6osvryIzIwQm7a/RR/xOP5j3SbwUPPuVxo5R0IaBJYslWmJSTd+8uZFX92xd//19Q1NDgNRZea0ycydPZ3uZJI3Svbheh59TRw3lsWXXULJ3gMcb2zhfVLneYEnWqIj/jWyIHmC554jHYR0Gnkr4yc0TM4MmDska9StjsoSgaAIzJs7m4IJ+QhCeVUtpeVVIEJf2VkZLF+ykKamVnbtP0RKXbdNvOIkEi90BXI2NB98zSPNhGGSPXEiubnTRnzuMx9bNH3yxCtWPbN2XkNL50zEFACjQTMBA7jhcCiy8sblDR0dsepX168/4pnAft/rLIn62aXthzcr/1/kXng15OQzadZCcifPkbyCQpORP5fr77qLd8rKgHmcb/8N3VaULP16cD8AAAAASUVORK5CYII=",deepLink:"galleon://"},{key:"umami_desktop",name:"Umami",shortName:"Umami",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAANSklEQVR4Ae3BC1RVZaLA8f+39z4HgQXiJBmgLWpEHRXFQhHMiJGsMTR5zJjL8Iosb2KOaRpZ4gulScXedWOIAequtGmC1mAjjSmWYyRpoGiTiEp6xgxWJ5QAOY/9XbhLW3DcoFQ+6/fjF7/4eRN0k5TSExgLhAD9AA+urCbgOFAB7BBCNNINgoskpQwBFgFxgDtXp2agAMgUQlRwEQQXIKXsCawHkgClsrKSwsJCSktLqampobGxESklV4IQAk9PTwIDAwkPDyc2Npbg4GBa6UAusFAIcYouCLogpRwIFAFBu3fvJjU1lZKSEtooioKfnx9eXl4IIbgSpJQ0NDTw1Vdfoes6baKioli7di2hoaG0OgRMFEIcpBOCTkgpBwIfSin7rFq1ivT0dHRdJyYmhuTkZKKiovD29uZqcPr0aUpKSsjJyWHTpk0oisKyZctYunQpQoivgTuFEFUYEBiQUvYEPpVSBs2aNYucnByCgoLIy8sjIiKCq9nHH3/MjBkzOHToEMnJyWRnZyOEOASMFEKcwoWCsfVA0KpVq8jJyWHMmDGUlZURERHB1S4iIoKysjLGjBlDTk4Oq1atolUQsB4DCi6klCFA0u7du0lPTycoKIhNmzbh4+PDtcLHx4dNmzYRFBREeno6u3fvplWSlDIEFxrnWwQoqamp6LpOXl4ePj4+uNKrPkP/9J/Ib2tR+g9Hvfe/kKe/wfF6BkhJByYz6p1xKIPDwHYGe/YS0HXOIxSUXwejjn8QVA2kxP7nJ8F2BkNCIHrdiDJyPMqA22jPx8eHvLw87rjjDlJTU9m2bZsCLAIepB2NdqSUnkBcZWUlJSUlTJw4kYiICDqwncH+0qM4PyrkHOfWtxCBQ1AG3Y785iv08u24cn6wEXP6X1EGhyF6B+DYsA4jzg/A+VEBpvkvIfrcjHbfTOx56ei7P6BTbz+POnYypj8+C+YenBMREUFMTAxFRUVUVlYSHBwcJ6X0FEI0cpZCR2MB98LCQtokJyfjyrE5D+dHhXQgdeyvPAYOO6Y5mQjPnpzHYcP+9Ezkfw6jTXkUbfJsOqP/+1Na5v8Wx9+zEH63YE57A/O6f6COmQSaCSPOHe9if3EBrpKTk2lTWFhIK3dgLO0odBRCq9LSUhRFISoqClfqyPFgMuNKHvsCx4ZMhG8A2py1GJGnrdhWPICsPY42Yzna7+fTqeZGHH9ZQcu8u3DueBfl18MwPZaFW045ptlrUEKjwcOL9pw73kWv+oz2oqKiUBSF0tJSzgqhHY2O+tGqpqYGPz8/vL296cBhR/jfinZ/Co6/PY8rR+HLKCGRqGMmIf/9KY5Nr+FK1lmwpcVjXvkW2rTHEb39sWcvAYcdI/I/h7GvT8Hxv39CvScRNTIe9d7pqPdOB92JtFSjWw4h6yxw2oowmWnP29sbPz8/jh49yln9aEejIw9aNTY24uXlhStHfjrq5Dlof5iP8+Mi5IkjdKDr2J+ZgzmzGC1pObrlEHrFh7iStcexPXE/piX5qPckIvoNwL4+BfnNV3RGfn0Mx+sZON74E8qAESghd6EMDkPcOgT15oF0xcvLi8bGRs7yoB0FA1JKhBC4kk3fYc9aDOYemOY9B4qKK/ltLfanZ4LDjjk1G+XWoRiR9XXYlsThLHkbZXAY5ue2ot5xPxckdfSDe3C8tR7b8j/QkjiElsQh2B4dj23lVPQDn+BKCIGUEiMK3aSX/RNnydsog0ai/f4RjOiHKrA/MwfcPDAt34DoNwBDtjPYn5+H/cUFCM2EadGrmNNeR/jdQnfIBiv6kUr08u04S/5Kdyj8APbsJciTNWhTHkUJHoMR565i7C8vRHj/CvOqvyECB9MZ59aNtDzyW/TPtqGE3o3bi9sx/fdTiBv86DYp6Q6FH6KpAXvmbHA6MC16FeHbFyPObW9hf2khwvtXuGUUoAwJpzOy9ji29GnYn5qBPPkl6oQk3LI+wTT/RZRBoVwqCj+QXr0X+6tPIHr2xrwkHzy8MOLcuhF7ZgqYe2BesRE1eipdcZa9T8u8KOzPzkVaqlHvSsD8dBFur+xEe/AJlEEjQdXonKA7NDqh6zrnUVTac27dgOgXhDY5BfPjr2FbnQh2G66cHxch67/G9HgOprnPoAy8HXt2GtjOYEh34vzwHZwfvoMyZDRq9FTUsN+hJcyDhHnQ3IheXYF+ZD/ScghZZ0HW10HjacTNA3Gl6zqd0ehEfX09rsSNfXHleH01orc/6h33Y1r4P9jXPQROB670z8uwLfodptQ/o949DeU3o7A/90f06r10RT/wCfqBT7CbUlGGjUEdEYUyZDTK4NEowWO4GPX19ZhMJoxodKK2tpa6ujp8fX05R42IwbEhE3Qn39N17M/NQ3h4oY6eAItexb4+BRx2XMk6C7YnJqM9+DjapNmY17yHY1M2jo3rofk7umRvQd+zDX3PNv6fmztKv4EI/1sRvv7Q0xfR60bUsZNpr66ujtraWgICAjCi0AkpJcXFxbQnAvqjTU7hPA4btqdnopeXoIbfh/nJfOjhgSGHDUfeKmxpsciTR9Hun43by/9CvXsaqBoXraUZvboC50cFON55CcdfliOPHsBVcXExUko6o9CFrKwsXGmJT6JNfQxMbnRga8H21Aycpf9AuS0K8+oChG8AndE/L6Nl/jgcbzyFcPfE9HAmbi99hBo9FUxmusXkhjb1MbTEJ3GVlZVFVzS6sHPnTgoKCoiLi+N7QqBNeRT13uno5R8iv/0akHzvzHe0UfoPx+3lf+Hc/QGy9hhISWf0w/tQhkYg/G7BNPcZtAefQN+1GdnUQNcEoteNKCPuQvTsjauCggJ27txJVzQuYPbs2dx2220EBgbSnujZG/WueLpk7oEaEUN3CR9f1Hum82PU1NQwe/ZsLkThAurq6oiOjqa6upprRXV1NdHR0dTV1XFOjx49MKJwEQ4fPszIkSPJzc1F13WuVrquk5uby6hRozh8+DDtBQQEYETjItXX1zNz5kzWrFlDUlIS48aNY8CAAXh5eSGE4EqQUtLQ0EBVVRVbt24lNzeXgwcPYuT222/HiEY3HTx4kMWLF3O5nDhxAqvVytChQ/kxYmJiMKLwMzBo0CAiIyMxovAzsHr1ahRFwYjCdW7KlCnEx8fz+eefY0ThOjZ69GhycnI4deoUKSkpGNG4Tt13331s2LABk8lEfHw8R44cwYjGdcbX15f09HQeeughmpqaiI+P5/3336d///4Y0bgO3HDDDYwePZrY2FgeeOABPD09qaioIDExkf3799Omb9++GNG4AqKjo0lJSSEkJAR3d3e60qdPH3x9fTlx4gRGPD098fb25pyqqioyMzPJzc3F4XBwTmhoKEY0LiMhBC+88AJz586lzZdffonVaqUrVquVzkgpsVgsWCwWysvL2bJlC7t27UJKiauJEydiROMyWrBgAXPnzmXPnj0kJSVRWVnJ5TB06FDGjh2LEY3LxN3dnbS0NE6ePMn48eOxWq1cLhkZGQghMKJwmYSFhdGrVy9yc3OxWq34+/uzb98+9u3bh7+/P5dKYmIikyZNYu/evRhRuEz69OlDm5qaGtpER0cTHBxMcHAw0dHRXAqRkZFkZWVhtVqZM2cORjQuE4vFQptBgwbRpqioiM2bN9OmqKiIn1pCQgL5+fkIIUhISODYsWMY0TAghOCnVlZWxsmTJ0lKSuLZZ5/l+PHjTJgwgZ9aQEAAGRkZTJ8+nYaGBhISEigpKaFfv34Y0eioiVaenp781Ox2O4sXLyYvL4/t27fz8MMPs2XLFpxOJz+GEIK+ffsSFhZGXFwccXFxuLm5sWvXLqZPn05VVRVtPDw8OKuJdjQ6Ok6rwMBAvvjiC35q+fn53HTTTWRkZLB582ZaWlpobm7mx/Dw8MBsNnPOvn37WLduHW+++Sa6rnNOYGAgZ1loR6OjClqFh4dTXFzMpbBmzRree+89Zs2axYgRI3B3d6crw4cPx+FwcODAAVxJKWlubsZisVBeXs6WLVvYu3cvRsLDwzmrgnY0OtoBNMfGxrovX76cS2X//v088sgjXIwTJ05gtVoZOXIkP0ZsbCytmoEdtKPQjhCiESgIDg4mKiqK60VkZCTDhg2j1btCiO9oR+F8mYC+du1aVFXlWqeqKmvXrqWVBDJxoeBCCFEB5IaGhrJs2TKudWlpaYwaNYpW+UKIz3ChYGwhcGjp0qUkJydzrUpKSmLZsmW0OgwswICCASHEKWCiEOLr7OxsVq5ciaqqXCtUVWX58uW89tprKIpSC8QIIeoxoNKJlStXfrNixYoiIcQ9kZGRN0yYMIHq6mpqamq4nBYuXEhzczOvvPIKFyMyMpKNGzcybdo0hBCHgfFCiC/ohOACpJQ9gfVAEqBUVlZSWFhIaWkpR48epampCSkll8qePXuor69n3LhxuBJC4OHhQWBgIOHh4cTGxjJs2DBaSSAfWCCEqKcLgoskpRwBLAJiAXeuTs3Au0CmEOIzLoKgm6SUnsCdwHCgH+DBldUEWIAKYIcQ4jt+8YtfXKz/A/OhBgM5KLZoAAAAAElFTkSuQmCC",deepLink:"umami://"}],kM=[{key:"spire_chrome",id:"gpfndedineagiepkpinficbcbbgjoenn",name:"Spire",shortName:"Spire",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAIIElEQVR4Ae3Ba5BeZWEA4Oc9u9kkJGHZkIQkLhQziQmVBpJwOTDg7saKEIQwnYq2/WWnUjuxHTOOgbYq77ZqSVGrtZliae2P/gE74zQIodoZEmwrR6pQlTYJ0DWNuWAChBBIyN7exsGZL2e/3Xy3Xf3RPI+zzvr/LfgFyGMKCMPHX/JT7eec75RUxJD8nAVTKI/JKe1YjquxEsuwCHOPH/phm9ER5yy8fAQv4yCeww/wHezGcBGDqRJMgTymaejD+3AjFhvHC09+SRodtijfaAIH8CgexI4ihiGTLJhEeUzn4Q58CG9Vw7MP/po0OmL5b2xVhx/hPny5iOGoSRJMgjymmfgwNmGeOowOnfD0F5eQRq36yIBs2ix1OoR7saWI4YQWBS3IYwrowxasMLGEo3gK/4UfDXz9d+ce+t79HydZsPp3PrPk1vtfxBK8HatxLoKJ7cQGbC9i0KygSXlM0/EpbESbagl78QAewneLGAZVbMTnvWkT7vUzeUwduBK34b24CEG1YXwOdxcxnNSEoAl5TAvwAPpUS3gS9+CRIoYh43sYN3vTNtxsHHlMHViHu3AVgmqP4f1FDIc1KGhQHtMSPIIVqu3GXXioiGHUxGZhAAu86UUswTETyGPKsB6bsUy1nXhPEcOABgQNyGNagn/BEmXD+BI+WcTwmtquxJPKrsUTashjmo0/we+jXdkA3lXEMKBOQZ3ymBbgcaxQdgQfKGLYqn6bsFnZH+HP1CmP6TZ8BV3KdqKniOGwOrSpQx7TdGzFFcr24sYihsc15hNYqmwU/6BO+3b07+rujd/EOnSqmI813b3xwX07+kfUkKkhjyngU+hVthfvLmL4vsbMwRrVrkCnBhQxPI0b8GNla9Gfx6SWTG192KjsCG4tYtilcZdinmpdWKlBRQy7sB5HlH0UfWrInEEe00xsQZuKYXygiOH7mvOrJtarCUUMT+O3MayiHVvymGY6g8yZfRgrlP1lEcNWzesxsT5NKmL4J2xRdgk2OIPMBPKYunCnst24W/POxWoTW43zNO8TeF7Zx/KYOk0gM7EP4nwVCXcVMbymeavQZWKdWKVJRQzHsAlJxQLcYQKZceQxTcPvKfs2HtKatWrr1ZqteFLZh/KY2o0jM761uFhFwr1FDKNa06O2Pi0oYhjFPUgqlqDXODJj5DE55XZl/4ttWtOFy9V2OeZqzTbsVXa7cWSqteNGZQ8UMQxpzRXoVNscrNGCIoZB/KOydXlMbcbIVFuOxSoSvq51PerXo3VbkVS8BcuNkal2jbKj+K7WBPSq31oErfkPvKrsamNkql2q7HtFDINaMxeXqd9KnK8FRQwn8bSylcbIVFum7L+17irMVr9ZuFLrnlG21BiZ0+QxBSxWNqB1PRrXq3V7lC3OYwpOkykL6FJ2WGsCejVuLYLWHFI2F8FpMtVmKntda+Zjpca9HfO1ZlBZZozM1LsaMzVuJq42xTLVTiibpTU9mterNR3KRo2RKUs4omy+5mVYq3l9yDRvgbKXkZwmc5oihoQDypZo3gW4RPMuwQWad7GyA0UMyWky1Z5T9sual2OG5s1ArnmXKnveGJlqzyhbk8fUoTl9WterCXlM07FK2Q+Mkan2hLJOXKFxbejVuj60adyVOFfZd4yRqbYbB1QE3KJxC7Fc65ZjocatR1CxH7uNkak2jH9W9v48pmkacy06tK4D12pAHlMH3qtsWxHDiDEyYxQxOOWryn4J6zTmnSZPn8bcjIuUfdU4MuN7DHtUBHwsjylTnzZcb/L0oE0d8pgy3ImgYgA7jCMzjiKGIfy1smtxq/osxttMnrdhsfqsx1XK7itiGDaOzMTux0sqAu7JY5qttneg3eRpx3VqyGOagz9HUHEIf2MCmQkUMRzBZmXL0a+2PpNvrdr+FEuV3VvEcNQEMmf2V9il7A/ymNabWDuuM/muR7sJ5DHdhg3KdmKLM8icQRHDCWzAiIp2/H0e02XGdyGWmnxL0W0ceUyr8BW0qxjGhiKGE84gU9t2/IWyLjyUx7RCtR60mXxtuM4YeUwrsBVdyj6H7WrI1FDEkPBxbFd2Eb6Rx3SZsl5T551Ok8e0Ct/Ehcoew91FDGppU4d9O/pHunvjo7gF81R04n3dvXH3vh39uzANmzHX1JiN+zCax3QbvoYLlO3Ee4oYXlWHNnXat6P/9e7e+ChuQZeKmfj17t7YdeTZh38ydOzgnQimxnmzFq/52pqPHrgTn8UsZQO4qYhhvzq1acC+Hf1Hunvjw3g35qnIcI00+puvPPvIDFMnXNjX/1uzFq3pQaZsJ24qYhjQgEyDihgG0IPtxji299/mmGKv7nl8jmqPoaeIYUCDMk0oYjiEm/BZjDgljQw6tvffTbVjP/62NDLoZ4axGeuKGA5rQqZJRQwnsQk3YNcbL/+Pk6/sMdVOvrLHyVf2OGUnbsBdRQwnNSmYBHlMM/d/69Mb9//rZzaNDh3vNIWy9hlHu3s+uXnx9X/4hSKGE1oUTKKLb/ri/ENP/d2GwVf33zF84qVFJlH7jK4XOjq7vyylLccPPXPYJAmmwII1H+x44+Xn140Onbj9jRd33zj8xpEuTWibcd6R6Z0XfaN9ZteDM+Yu23boqb8dNMmCKfSWd/yx0eGT04ZeO3j56wefytPwyV8ZOv7israO2RekkcFFieCUQAptHQdHBl/7ybRz5j0X2qf/cNai1cW02Qv/M2ufMbT/W582VYJfgEXXfCQMHXshS2nET4XQZtqchaMHn/hCctZZZ/08/R8wPGmSSU1PIgAAAABJRU5ErkJggg==",link:"https://spirewallet.com/"},{key:"temple_chrome",id:"ookjlbkiijinhpmnjffcofjonbfbgaoc",name:"Temple Wallet",shortName:"Temple",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAGbElEQVR4Ae3B32/ddR3H8efr/f1+z2m7dT1n3Vp+De22EsxmxARvCNDGhBvDj3/AaxdMJEpIUAOJxl8IXJnFGyNX3i3BiEG9ELIqZNSLmRBYYD+7CS3tuv5Y23N6es7n87Zd2uULxAXDt2cmnseDjo6Ojo6Ojo6Ojo7/S6Jgje/sGdTdu1+2ewZvwwQSMsAEJjCBBCYwwAQSMoEJDDCBBCYwgQmJN3XLH79JwUSBGt/dO4jzmqrlQ/bQEJhAQgaYwAQmkMAEBphAQiYwgQEmkMAEJjAhsYxU1eArLQpkFKTx5MAg0mskOuTLTVgLFErsBO6lYEZRTN8i0SESgQmfq1M4MUrBUoqS6E2xTgIBc6twWy8bfLkJszWukfgUgZMj1okN6iujQ3vYNAI8R4FSCiLTCaQGoozA51cRmxotwvFLEBxChOAQHYJDiHhwCA7RIUQIDsEBRweqZF/qBxPr7vfLj6Xa+4cWBUkpSOkXU/W1Z28fRzwIgloTmgFKKezuJnn4IAiQQIDENQIkJECsEwgQ+L+WCK9fxCeX0Z29rNsJ3Au8RUFSipTYGOJBNkj4QgMNpEjAQA+YwAQSmMAAE0jIBCYwwAQS2ttD+NM5/PQc3NnLNWIUeIuCGEVKdJxEkBgkgoUGn8uuMvSWiKeukDNCgYwiJTpBYg0SQSL8aoP/RnhtApyPSY98leTRg+Tc71ceSymIUaDSDy/WSTROIkgMVlvQinwW8Z3LhGPv49Mr5OmWHejOXeTsBN1LQYyimY0pMZQIJYKlBp+FBnaAwE/P8xmMUpCUginVceBZJAiR8Oo5MKHUIDVIDUoJ9pUBdFeVLRroQdUu4pk5bHQfG/zSVcKJD1EpgVICpQSVzCmnH1CQlKKZTiA1CLEcT07jy2uQJZAaZAalBB2s4HN1RJU83bUbPzMPDgioduFTy1BOoZxAOXVKdiR78tzvKIhRsOyJM3VCHI/jU/jCKh9jQkN9qDuDpTVYDeTZcBVfWsOnV9ig3hKqdLHJcT+SPXnuNxQoZRuEv33wbVbW9pEZeTZcfZSe7HFCxB18ro56etmi4d0g8LPz6NadbEge+uJL4ZWzx3DmSj+Y+AcFS9kGXS+vvgu8C5G8tRcH52jFx3Fng8/W0R29bNFAD6p0Ec8sYA/sY4P27aqUfj75F7aJ0U7BTxLiVYJDK+IzK3yShqv4uXlyRuLkw8Y2Mdqo9PSFFi1/g1aE4LDYgFqLPBuu4str+MwKm/qBw2wTo91CHCM4tCK0HJ9ZIU8HqyDhZxfIGWWbGO3WiscJEYJDiPjUCnna240qZeK5eXJG2CZGu0U/SStepRUhOD65xCfpYBU/v8B10oh/9IixDYw2K/1ssuXB3/AQ8VbE51dhpUmeHajgy018psamfuAw28C4GVpxjOAQIgTHJ5fI04EqkvDzC+SMsg1SbgL1ZL32tVtAYoN2d5OnPd2oUsbPL8B9t7NpBPgVBTParPG9vU95rfmMbutFBypouAr93XyMQPsrxAsL5Iz49KNGwYw2ajw1+BSpvUBm+EyNG9GBCiw38cs1rhH9wGEKZrTJ2vdv/bIye0FZgjLDZ2vciPZXQODnF7hOjFIwo11SO02W1MkMsgTmV7kR9XejvjJ+YZGcEQpmtEnppx82yOwEpQQyw+stWAvciPZXiBOL4GwZ8cuPGQVKaadSMob4OhJEJ/z+DHSlKDPoLZE8cAd0p2zRUAXeuQyzNRjsYV0/cBh4m4IYbaTMjitLkMBPzRLfu4KfmiVOLEK9hV+pk6ehPpCIE4vkjFIgo51SGwfq8Z/T+GKDa7pTbKgP3PGZGnnq70Z9ZfzCIteJEQqU0EY/+fNceOb2cNpn66+T6FUSe9UO7XkQKBMc1gI2XAUJJJDwj1bwS4sk990BEkgDP3r67hd//Pz7TgFS2qz80uIxctbu4RFC/Abu+HyAWgt2ZmzRUB/x1Cx+pY729rCuH3QYeJsCGDdbM4zRjNCM0Az41DJ5+kIfSPjEIjmjFCTlZmvG47iDA9EJf72ITk5DapAIMoNEhPEpfLoGBkg9FCTlZmvFkx79Ku67fHIZ5huQGaSGMoMdGSTCP1omzNbAdBT4JQUxbrLSc1MtmuENv7QEM3U+pRGgGdl0FHiifPSKU5CU/wE+ufI8l2t/JzH+I2eW6L8t/3rO6ejo6Ojo6Ojo6Ojo+Jz+DTK0Yr9D+W0JAAAAAElFTkSuQmCC",link:"https://templewallet.com/"}],DM=[{key:"kukai_web",name:"Kukai Wallet",shortName:"Kukai",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAHNklEQVR4Ae3BbWyUhQEA4Ofevg0f7d0RsAllEJSpQVy1K3SQIQro2HRoVIymS/Zj6w8xfk6NWzRzoJkO48d0MUaTZv6yMRFNxM2EIX4wIthSUJERgrCmjHZWCXdXapsWbgk/iLbvlXuPsgHjeZx11ln/1xJiaGjMV+NazMU0lDs1DKADm7GmuSnRqUgJRWhozF+AR7EMoVPbIFbjoeamxOeOI+E4Ghrzy/EMxjq99OGe5qbEi0ZQZgQNjfk/4HGETj8hltbUrRi3fevKdQooU0BDY345Hnf6u6ymbkXX9q0rt4gQiNDQmL8Azzhz/LGhMf9dEQLRHsVYZ46x+L0IgSEaGvPVWObMs6yhMV9tiNBw1yJ0EiQSVJ1D9WQmTmDsGEf19XPgIJ1ddH9JPu9kCHEtXvINoeHmGkXl5cyppb6Oiy8iWWlE2Rw7dtLSRus2BgaMprl4yTeEhptmFIwfz9VXsWQxyUpFSyWZV8+8enI9rF3P2+vo7TUaphkiNFy5IowZwyWzSCbZ287edsdcMZ+Gm0glnZBkJcuu40eLeOU1PtjomPOmM+Ncsjk+/Yy+fsUoN0SoBOfP4L7bSacds6mFtev56Y+ZXWtUpZIs/wX13+cva/nJlfxgtmMyGZ56nt17xBaKacwY7ruddNq3zKtnXr2TanYts2sNk05z3+3c8yD9/WIJxXTJLNJpJ+RQL51dZHOOSiWpnkzFeCVLp7lkFi1bxRKKadw4Jen+inc30NrGvv0iTZ3CnDoWLaBqktjGjRNbKKb2DrH0HOLV13lvA4ePGNG+/ezbz5q/snABt9xIZYWitXeILRBTewd/36QoO3fxwMO88z6Hjyja4SO88z4PPMzOXYqycTPtHWILlODFP/PxdiPa8jGPPc3BjJIdzPDY02z52Ii2fcoLTUoSKMHhw3T8S0E7d/HsCwwOOmGDgzz7Ajt3KWjffo4cUZJACcrLWThfpJ5DPPcig4NGzeAgz71IzyGRLv8h5eVKEijBnFoqK0V69XUOZhQlnSKVVJSDGV59XaRUkjm1ShIqQX2dSN1f8d4GI0qnuGEp8+pJJR2VzbGphTfeIpNV0HsbuO4aqiYZpr6OD1vEFogpkeB7s0R6dwOHjyjo/BmsWsmSxaSSjkklWbKYVSs5f4aCDh/h3Q0iXXwRiYTYAjFVnUNlhUitbQpKp7j/TlJJBaWS3H8n6ZSCWttESlZSdY7YAjFVTxbpUC/79ivohqWkko4rleSGpQrat59DvSJVTxZbIKaJE0Tq7DKiefWKNq/eiDq7RJo4QWyBmMaOESmbU1AqSSqpaKkkqaSCsjmRxo4RW+C/IJFwygrE1NcvUiqpoEyWbE7RsjmyOQWlkiL19YstENOBgyJVTzaiTS2KtqnFiKoni3TgoNgCMXV2iVQxnqlTFPTGW2Rzjiub4423FDR1ChXjRersElsgpu4v6Tkk0pw6BWWyPPknsjkFZbI8+ScyWQXNqRMp10P3l2ILxJTPs32HSIsWUBYoaPcefv071q4nm3NMNsfa9fxmBbv3KKgsYNECkT77B/m82EIlaGljXr1hqiaxcAHvvK+gTJaXX+HlV0glHZXNKcrCBVRNEqmlTUkCJWjdRk+PSLfcyIS0omRzZHOKMiHNLTeKlM3Ruk1JAiUYGOC9jSJVVnDXrYShUROG3HUrlRUifbCRgQElCZSgLGDqFAXNvJC7byMMnbAw5O7bmHmhgqZ+hyBQkkAJljdSW2NEsy/lwXuZkFayCWkevJfZlxpRbQ23NSpJIKbp05g/V1FmXsgTj3DlFZQFilYWcOUVPPEIMy9UlPlzmT5NbKGYpk8TS2UFjT/numt4dwOtbezbL9LUKcypY9ECqiaJbfo02jvEEorp66+VpGoSN1/PzddzqJfOLrI5R6WSVE+mYrwT8vXXYgvF9MkOMhnSaSWrGM/5M4yqTIZPdogtEFN/P089TybjWz7awiNPsGWbk2bLNh55go+2+JZMhqeep79fbKES7N7Drx6k5mJSSfb8k73tjtq5i8vn87ObSCWNimyOV17jg42O2rmL86Yz41yyOT79jL5+JQkNN6AIff20tIn0wUZat3L1VSxZTLJSSXI9rF3P2+vo7fUte9vZ2y6uAUOEhuswCnp7Wf0mb77NnFrq65g1k1TSiLI5duykpY3WbQwMGE0dhggNtxm/NEoGBviwhQ9bSCSoOofqyUycwNgxjurr58BBOrvo/pJ83smy2RCh4dbgeYRGWT7PF9180e1/YRBrDBEYorkp0YnVzjyrm5sSnYYIRPst+pw5+vCQCGUibN+68kBN3YqvsNSZ4Y7mpsTfRChTwPatK1tr6laMw2VOb6uamxKrFFBmBNu3rlxXU7fi37gKodNLH+5obkqsMoKEIjQ05i/Ao1iG0KltEKvxUHNT4nPHkRBDQ2O+GtdiLqah3KlhAB3YjDXNTYlOZ5111llF+A8aUDCF69BprwAAAABJRU5ErkJggg==",links:{mainnet:"https://wallet.kukai.app",ghostnet:"https://ghostnet.kukai.app",mondaynet:"https://dailynet.kukai.app",delphinet:"https://testnet.kukai.app",edonet:"https://edonet.kukai.app",florencenet:"https://florencenet.kukai.app",granadanet:"https://granadanet.kukai.app",hangzhounet:"https://hangzhounet.kukai.app",ithacanet:"https://ithacanet.kukai.app",jakartanet:"https://jakartanet.kukai.app",kathmandunet:"https://kathmandunet.kukai.app"}}],BM=[{key:"airgap_ios",name:"AirGap Wallet",shortName:"AirGap",color:"rgb(4, 235, 204)",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAALT0lEQVR4AeXBCXiU9Z3A8e/vfd+5kskBARYIkAsCSIRyRe5AKbhQ8CqWemGpVnF1qVKPrdoSrSiW6qq0lhZXu7UrskVQSq0VpAIGwxGgHAE5RBMIgUAyk8xkMjOZ+e/zZh9cauXNTMjx7MPnI0qpRkC4PCkDEEDj8hTVuMxpXOY02om3xsfix1/jlumP4qmu48saAiHumv1TFj/2Kp7qOtqLQRsLhxp549U/8x8vvY2vth7TkUNljBwziAsdO3KCnUWl7Cwq5U+rP+KO+ddx8x3TsNtttCWDNhKNRPnjW5tZ9twqTp88xxcUIMKXiQZKKUQEf12AlxatYOVr73PPgzcyY9Z4NE2jLeiFhYULAaGVNDZGWLdqM4/8y0usXbkJf12A84J9u1Je+M/MnjSCPrqdC3Xt1okrhmRz5FA5NWdrMfnrAnz4l538Ze3HJKUkkNOvF5qm0YqUQSs5frSCdX/YxDsrN1F91ssXFARzu1L5/dFUT87FyoRvDGP85KGsX1fM8hfXcPRgGSLC58dO8eP5L/PiohVc952JzLxxAr0zu9MaDFpIKcXBfcfZvH4XG9/bzpHSMkSELyjwj8rgzK0j8YzNBEVMRISpM0czZcYoPtq4h9d/vY4dRQcQEc6eruGVF9ew/IXVDLwyi0nTRjLhG8Ppf0UGCC1iEKNoNMqxwyfYs/0TSj4uZXvRAWrO1SIimEQEUyTZSc2MQZyd9TUCmZ1AAYq4iQjjJw9l/OShfHr4BKt+/wHvrt5CrcePiHBo/2cc2v8ZL//sv+nSLZWR4/IYPmogw/IHkNm3JyJCLAya8Unp57z09Bvs3naIQH0QEeE8EcEUdTuondiXmin98Y7JQmlCE8VXqo1GiEd2bi8efvJ2Fvz4Vor+uof164rZtL4Ef10AEeFclZf31hTx3poilFIkJrkYmj+Aex+ezYC8TKwYWAjUB5k3+ym8NT5MIkITpQjmdKVubBbe8dnUDeuNEmK2xF9JgT2JBNGIh2HTKZg6nIKpw4k0RigpPsiWD3ax9cO/8enhk4gIIkK9r4GijXv4W8lh3i1eijspgYsxsFBSXIq3xocp3D0ZX34GvhG9qR2VQaiLG5SiJf4a9pF5di/9dCeCYBLAEP5BZzGY60pjhiOVC+mGTv64PPLH5fHDhXCmsprizfvYufUAO7aWcrriHD5vPTu3ljLx6hFcjIGFqsoazit7Yhq1I3rzBaW4FFXRCFVRP7FYHfSwPLkPd7q6cjHdunfmmm8XcM23C9j5cSl33fhTTGcqa7CiYcHr8XFeJMVJRyr0nSJWKalulKJJrdeHFQ0Lfl8DTaKKcKcEOtKpaJhGFLHo3CWZaDSKyVdbjxUNC746PyZRikiKk46Ub0vAQIhFUkoiIjTx+xuwomGhIRDCpOwGEYdBR+mmGSxLyiBWdrsNh9OOKRgIYcXAQsAfxKQS7CACKOI1yeZmiiOZJNFpic6aznR7KqmaTjwS3S481XUE6huwYmAhEGjA1JhoB6WIR4JovJmSxUxHKh0h0e3CU11HQ0MIKxoWQsFGTMppgFLE49dJfZjpSKWj2OwGpnAwjBUNC4H6BkzKaQNFzHJ0O7e40uhIDocdUyAQxIqGBb+/AVPEZSMeo2xuhI6V6HZiqvc3YEXDQjAQwhR12vj/xuGyYwo2hLGiYaEhEMQUddmIR3HYh6JjOZ0OTIH6IFY0LAQCQUxRp0E8jkVC/FfgHB0pIdGJKRBowIqGhXCoEZOyG8Tr7roy3gnW0FHsdgNTONSIFQMLkcYoJmVoxKteRbnO8ykFNjdTHckki855OvBdVxdcotFWdEPHFI1EsWJgQSmFKaoLLbUp7GNT2MeFbnd25p6EbrQlTdcwKYUlDQsiNNGiitY00HDR1qLRKCYRLGlY0G06JglFaE1/CnqI0rYawxFMuk3HioEFl8tBqCGMVh+iNW0J+7nec5Q7XF1wi8bFuEVnmC0BAyFefl8AU0KCEysGFpJT3XhrfOjeBlrb2qCXtUEvzemr23krNYfBRgLx8Hp8mJJTErGiYaFzWjIme5UPhA5xNBLiW55jNKKIR1VlDaa0rilY0bDQPb0LJvsJD4LQUY5GQuwO1xMrpRQV5VWYuqd3wYqGhcycHjQJNeIo99CRFLE7WX6GQH0DpozsHljRsNA/L5MmIiTuq6CjZOt2htkSiNW+kqNomoYpd1AGVjQsfG1Ef5RSmJJ2lNERsjQ7q1NyMBBitWPrAUxKKYaMyMWKgYXUzknkXpHBkYNlJG8+iqirUUJcrrYnMceZRrKmc56GIPwfAYR/lCQ6I+2J2BBiFY0qNm/YhanfwD506pyMFYNmFEwdzpGDZeg1AZI/Po53TBaxusOVxvLkTIT2U7xlL+fOeBGBgqnDaY5GM6bfMA6lFKZuK3aBEBMBFrnTEdrXG6/8GRFQSjH9hnE0R6MZmTk9GTF2ECZ30XHce08RC7do/JNmoz3tLTlM0cY9mEaMHURW33SaoxGDO+dfj1IKBHr9fCOxqFNRDjU20G4UPPfE64gISinu+sENxEIjBleNy2NUwWBMrv2n6LLuALG4p/Zz/CpKe/jjqs3s23UU0+iJgxk5dhCxMIjRQ0/MYfaUR4g0Run5/Id4x+cQTnFi5cOwj4Fn9/MtZydSRScWugiDDRffdKSgI8TCU13H80++jkk3NB4snEOsDGKU3a8Xc+6ZyWtL30H3Buiz6H2OLbkWlMJKeTTMC/VniFe+4eLdTrmkaQbNWfSjV/DW+DDddvcMsvv1IlYacZj3wCyy+/fClLzhMF3X7KWtbG8McG9tGc1Zs2IjG9Ztw5TVL515P5xFPDTiYLMbLH55PnaHDQTSn91A4qEztJXVwRrqVZSLKd37Kc8+/ltEBJvD4JmX/xW73UY8NOLUt39vHnv2TpRSSChC9v1vYT/toy2EUdSpCF+lsuIc989dQigYRinFj57+HrkDM4iXRgvMnDWB2+bNwGRU+ek3byW26npaW2/NTjfNxpdVn/Uy76anOHvag+mmO6dx3exJtIRGCz3w+C1MuXYUJntZDbnfW4HjVB2tRYBnk9IR/l5FeRVzry+k7Fglpq9PH8mDC+fQUhotJCI8/eJ9TJgyDJO9vIb+t/2O5F0niJ0CFKAAhQAacKXhZFVKNjc507jQjq0HuHXGY5Qfr8Q0umAwz/xyPpomtJTBJdANneeWL+DR+b9g/dpi9JoAOXe9SdXtV1ExbyxRm8ZXydBsrEjNZoiRgPC/BLCJAILO3wuFwvzq53/gd8vWoaIKU8HVw/nZsvux2QwuhcEl0g2dxb+cT1bfdJb/+2qUUnT97TZSNnzCyYe+jmd8DijFhZ5ypzPa5iYWWz7YzZKF/8mJz07TRGDuvddw78PfQdOES2XQCkSEeQtmkT92ED954FdUlFVhP+Eha/5q/CN6c+q+8dQN6QmKJr10O83Zt/sIv1i8ku0f7UdEMHVPT6Pw+Xnkj82jteiFhYULAaEV9OjVlRtunkxjJMKB3ceIKoX9VC2d395L8p4Kwj2SCaan8l1nGpm6g69SUnyQpx55haVPr6CivAoRQdc1bvn+NJb8ZgGZOT1pRcqglTlddn7w6M1cf9Mknn/y92x6vwQRIXH75+Rs+4zAlT2xLVsAmUlc6PSpczx89wvsLTmCiCAiKKUYN3koC35yK1l902kLBm2kT1YPXnjtIXZvP8TSZ95k9/ZDiAiu/adwVHghsxcXqjx5jn27jiIiKKUYPDyX+/5tNiPHDKItGbSxofkDeHVNIds+2s+rS9/G6/HRf1AmX9ZvQG/652XidruYe9+1jJk4hPZg0E6uGpfHVePyuJgEt4sV7z1De9O4zGlc5gxAAVEuT+p/ABopEAN9AKm/AAAAAElFTkSuQmCC",universalLink:"https://wallet.airgap.it",deepLink:"airgap-wallet://"},{key:"naan_ios",name:"Naan Wallet",shortName:"Naan",color:"rgb(129, 100, 100)",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAZfElEQVR4Ad3Be5BeZ33Y8e/veZ5zznvd+0VaaVfWfSVLtiUbY4PBBsaUy0CCE0JDadopCdBJ2iQ0w0ynSSedyaQzzaTJtJlJ/oBShoRJS2nTlNImxNg4gSBsLNuydZdWu5J2tau9vfvezznP8yuvPLJLhtYr22khn4/8yscarpnG0mitStluiBYsJndS8GUsDRmoWsltJB2vSCYikZOO74gJGVEwIlJGoiAejw9G0IjUd6XolSiyaAyZ74giCJkJmsWCxuCcqjGqKmLwqM8QzVSjrrVOjQhWYiWFPFc6BpxxKsYjJqgYi+0mGvwGIQkaJMJqot0cjeNMS5GobadstFAvJbxLteva6tsBDVZL1XGNRdWVvJWosyJ5XhdfNQwSiwYrmW8QF61keZCcTDyR5KISdz1YFQTJrGAUcagR1oYNy3uQ9Z2xWZnE1Cdy0xhT3xwRbQ4IaT/4kiU4UAMYBIPQExACSEBsRjBNpVDLKa6JGbgurrQYU5lHhufQgUtWRy8E37+ekStO9LtE8SqpR1wQsJrnuUqwGseWTrtOREIICWnS0aTVpVhflzjpx+WtZVkLHcn7DP2dWJJiJKHUFtOxmDQzrWIQkyLQhciKqhHj1ajMH4rszNuU2ftDWLgDOlsEhO+yhhuU71I2wwAGFMhjoAzpGGygLIIBw8tU8UL5qpitz2J2HAvhtsfVbzuptqPGBBUfyL2RzJlQ7AqmXNZ2pyUmcwxKzHoJ1jttKu0Wbt2komVhsB3LUB5LppkQCmKDiisUJc86YiIrGlKh2xzAPfX3nXvm70J9F98lwv8PFppTRs5PoeffZwTUVi8qd/2+Zvd8TszAauLikGapwUVK16uLihqHNqVugjhYL2Xa7Hix9x38eVeQRExuxcuGaDkRUSvWOOlKR8RYwQWH/OXHnP3i50Vm3gXpID9ghHRQmHvQmqf/HiKp2sln1IvmWYq1ESY2SEFIsxa5dwiO3Cv2wYO/FEU4CT6VXIxEhViMFfHWS+pVMCtbhD/4A+GZj4Iv8gPPF+DiO5TTDwRue8yHcoPIY50B4+mmHXwOTmJciDHGODGSSqVUoiAFcZmVXHNJQ26cub7XyGe/Clffwg8bXXiTMZ/5qomX9ucGyTQVmxlxGkmxkGBCWwTERFEqSbGAEKRbSqRl2uKDiNX6DpHP/jE0Jvmh1dpm5LP/1bCy2wcnbRckK1YkUielUh+FomBsFNGVVDpRapzPxKgTtFkVPvcFaG/lh157i+H3vwD1PpMjziOduGtatMVbFSOFSEBE8kysqFhjxPLlX4fVg/yNsbbfyh//KyQXa1UIuSCIOCNONWCMiBgkhFQMFx+Ekx/hr0EpVkZKnoFSoBwHYqv05EFopkKtbbneNDS6htednv7bmNP/KWP/o8aAESNiFae5kUxUjLOEFBeFP/k1EYTXgQDjfZ7psZSdQzlDJY8Rvq+gioiAQq1jmFmNOLMUcaXmUOV1of7Pfi3P9z1hIpMFCRJlRu3bjn4qMV6NEETsifcbOf4xXiMjcGA85T0HW9y/o0NORkeFgQRE4GrLsjZ+gOt5QjWrMev7aN/xdhZDhXh9nv4CbO3zHNqaMj2WogrXmw5VXhORzojYgbOiW05GwWO8weV0RFB8biWKjn2C12jHYM7b97YZKXsutyNmd9zHnqOHERGe+6M/QlD2PPIeqtUSqvDof/4T3vTuBymVCtRLjmfOn+N2U6cYGXqGSoGH97d5w1SXxy8UOXc94rUwfOsTWTjyJZWAulQc4kUtAkt7hWv38ipFVnloT5s7J1JCUE7LBHsfeQ+VSpGe4ANh6iBH7t6PtQZQLp+b5fCb7qZUKhDSBtUdQ+w9vI/nvvU0924H4WUDxcCPHmpyeiniq2dKdHLh1RCuHxUWDoiZOGmswbjcYiQRZ0+/FxBehb5C4MNHG9w1keK9crayjzsfeYRKpUhPSOucPD3DXUf3Ya0BFN9Zop5njG8dADJMlAEZW+67nYnJbZxd5fuaHsv4yD11hsueV0ki98J7rcQkPhIDiYRgQWce4FUYLnk+fLTBWMXjg3KmtIcj734TRjaADmiTuSvzTG4fxNk6mtdAN5idX2fXbSOEdIV0Yx4IvMiz9wMPk/dtpdYJ9NQ7Oaq8ZLAY+PCRBhN9Oa+Ghpm35sFIFgwmSzwqLWdk4Si3aKAY+Im7mlSTgA/Ko9cKTAz3I5KTNWqktUVW11a4+uwM5SgAns7qEqo5Z791Gt1oYSIHQVk9eY50owGqiEk5+uPvZXFkmp4vLTX4xMUVvrlQ56ZCpPzYnU3Gq55bJbJ0REwzyeNMDHgxcm0X5APcgsQpjxxuUkkCPV++CNsiZeJN9wOOqFImb7X56pePs3OkgisN0BOVivzZZ/6Y5PoipS3bQCqYyJHW6pz+91+ktbiM73S5fvwZ9j74VmbbCWvtjM/vGeDHGh3SPHBTwSkfONykEgdujS8Ll6eRIMZ5h2X5MLfo4X1thsuenr+4ooyXChz40feBCEiJkOV8/avPsa1TY2DvHsABRRC41nbsPbSHFyXU5xZ49rc/Q2nLKMngALY4zvgbpimVEkr3P8w+tQwuNPjHxvBfZtb4rUtrNLs5PdUk8N6DLYxwS0SvHbZeMCE4VBenuQX7xzIOjKf0zG5A3Q6w7859lCe28iJDbXmd1fWMidE+Slu2cINEXHj0W+jqOuP3voGe9tIi/bunuOuffIzb3v8wttAPdifY3YDjO8sZXyj0ccfcBt9R5R9MlvmiBkqx46apwZwj27rcCtWlg0ENJs0zUV3ewyZFVnnbnjY9rTRwKt7JgSHLtoce5KaNi6c4/vwieyqw6wM/So+GQP3SOdaLgxy8707EWsBQHBvDxIOM3fshbDIJlAADMgxmhPv27eXJkHFxaIChZsb+uQ1+I4r4zVNLzK93yHyg5807O5RjZfNWd3fTTOz9Rz5ZjM3jPy/S3sIm3DOZsm80o+d4e4i9D9zPvgfvB7Hc1LU5Fy5ucPTuaQqDgyCCiJD0x5w4s8K9D91LUh4CuwPIgYC4YcQOg+kHIkBAClTLFT75lh9heeYiP1V1/POJAlN9CXOdnN+9vM7PtboMNDPu7k9wBmZWIzYnaObv+7SLTBCR+nY2wRq4e3uXnit10Klpdu+eAATsTtAGhEVmLtTYtXs7/XumwAwDBQgLQIF2SygWE9AuEMBsgTAPYQ3MVsACyssSen7hPR8mdGb40qd/j1+sKKVWxtpIkf5mRrko5D5weCLlL2cLtDPhlYi0txqXOxO7ZgXSPjZhz3BGJQn0rAzsZmxsgBcpICD9BE24PLfC1I4xXmRBymDGaLXBZi3ai4tAgLDIDWYrkIHWAEVDG/V1NO9w0+joVsa3T/O5sTGWp/rY4ZWP1lI+UYh4uL9AElliqxwYT9mcvBhH3X4j1AeAiE2YHk/puVpX0uooleU5XqItemYudeiPQOo1btAaN0gfy6s5w31F2svL3KBNCEuAAbMNiOgJ7Q2az38NcY7vIUOsA4dfqPN7oxU+v7XML+/o4/NXa9w0PZaxSUZCbdiEkA6xCdbAjsGcno3KBGZjjUK1yku0Rk+7sUF+fZG4WuUG7YJu0NNNqxT6qnRWV3mJ1iAsARakBAimOELljr8FOP6qr3zoUzz2s7/A9Y6llXrwgScqMTdt7cspRspmCO0BY0yjj00YLXsSp/To8HY6iwv0793DS7QJ2sWnDXyzQWd5hZeE64CnUCghxrF25Ro3qW9AuARhnpvEOJAC3ysHXWN0ZIDhsWkm3/k+HrUxX1/u8pZmRlClxwhM9OVshtCpmuBDiU0Yq3p6luoZwxNbac9fRYzhe+gKPmuTtzvE/X28zENYZGxsBOscC0s11HtAERMAD2EWXz9L6Db5/jyE6+DnQOtsHR9C+7ZzZGuVT06PYkS4aazq2RwtGkQSNmGg6Omp5Y5yKaGybYK4r4+XaJvglzHGI9Zg4piXhA6EJZK4DbbIyJvfglgLuoHvNNi4OMflP30CW6hjYsv3l4CUQdtofoFkoMjOvTv59kwXVb7HYDGwGSI+MYJ1bEI5VnokijHGEPX1oSHwooD6BkKDEHJsqUxrYYGbVFtAG/x5kvIg/eUC8/MrIBVsoZ/lZ09Rn5tHyYCM/yMziu/Wqc9eIWQ1hu+4nZ2HDnJ8xaHKS0qxshkhdKxRhM2IjNIjqhgjDB85ihgBrZG3ryHWICIYA6NHj9K3axeQ4tuLiFFelLLztiK15VUW5pZQNSBltr/9rez5ifciUuL/Lka5jdn/8ThiDC6B2971TqYOHOSkjqO8KLbKZhgTYwRhU4QbXN7B+wBBAQEEV0hYfvYUs195jJC2KESOer0FCLYQUTt/idr5S8x+5TEKSZOkuoXRcsSJ5y7SEw/dRTx4F5hBkBLgQRtA4K9ypTFu//jPYhOHiRTjYOK+e7nrkQ9wymxDlU1TVYwS2Iw0F3rGyobFxVXSTsoN0oeGmOXjL9CcX8RFgdHhPi7PLQERSD/liW089Wv/lsLQAEjO9NEjXDy1QNxqcvnyEmgdZBTMJGAhrKD5BfCnQFt8D3GI2wlEgAetYZMOLhLu/JH3c9pM0M3ZpKDGSMjZhGZq6CnGhu7KIs4I7XaXnrztGZzezdg9d7D70E6uXV+n2+ygqoAFIu755X/E0OH9IP0ICW94/09y+TvPszq7wOrKMoRlXiIxIinoBvjnydYv8bIMsRakyMs8i8f+HPEph97/Pk6mQ2xOITci2mUTVluGmzonvs1wIszNLtITVScYv/8BBg/soVweotPoMlYwnDt3lR5X2Un/vjcSlctABBJRLpe448d/ho0TJ7j4/AWajQXQNW6QhKzZYO3MBdZOncHEV0HbgII/Tb5xjNXnj5Oub/DtX/0tVJXxew9j4xZxLLzjI+9GEuEVCV2jSItNWGpYbhofjLj27HN0mh1ukCLY27HFKZA+Jg+8mYXT52iuNfA+AApmF9g7wU4BBvCMb9vC9oc/TNTY4NSJGdrNqxCWgISoMsn814+R1hvYuAS6yA1mJ65UpjK1lSuPfZO+XVO0FpZ4kQGEoaEqD77/Tl6JYJoGqnU2YaVpaWdCz0S/49qZM5TjiNXVOmgbsGB2gtnO6Pg4zbzIiEk5c3oOtAHkIEUgAQL4GfBn2blvC9UDDzFYLXPy2QvUNxbAzwLC/p/6EKNHDoEUQVMISyAVcIeJ+yZoLVynvbRMeWIcpAoyCFh64sTySpS+dQNujU0ICjOrETcNlpX8haeZv3wdtA14XqItjr7vPl74b/+d0O7SaLQgrPKyAORovgr+LLt2D2GruykXi8ycnuPKlXnA44qjmHgIMNygNdAVICZrDHDwp3+SI7/0cfJ2B4i46blnZvjT//g0ryRovOqC9q0ZyAHHKzi1GHFwPKVn//YK37m6xOCWNdI0Iy7UQIZ4UUalBGMPvRF78RRng3L03hJoFaQICD6tYyMDePDnmNyym5XyEebOPU1nvcHxa2sMlSwDsWLjhOLYGLaQoH4ZsULUvw18HXQDVyzRbLZ5/vhZXjg2w6VzGzhjeQVZO+9bd3lIGrFEDcgGeAWXViNqbUN/MZBEhmrVsXWwzPlzVzh4ewK2HzCErIXQ5q4H7+Bbf/oCkwMVZmYW2LnTgp0EBBuXqJ19jrXT55l690NktROMbXmQkZGHOXPqSUJ6meXUsdCo07k2T3txger4GJVtE/Tv3kWeWzqtBldm50nnZyltLHD7WMxjswM4Y3ll8QYhaZg82KBamWcTgsKTlxNu2lFssZ4qWatLlnUhLNFjIkdr4RrNK/P0s0G706WxusHGxgb4K4CCDFCfvcrKc6cJWU5hpATawBjDgQOjHJqusGNvBRtqDO6fIh4YoO/QNL4Yc+35F8i6TbqdDrevPMU7h1Z54LaE00tF0lzYDNX+OaNGnVELDM7A2kE24bmFhLsnuwwWA30Fy5Uzx9n50MOcPjnL4TsdaAGIMUmJZ/7lv+HOX/woV+odhsuDnD15iTvv3k/ELKCMv/FuRo4cxJUGgRLoOkgfmAmSwVXikJL3C0k1x2bXOXRkKy8rgpQ4sTLLaOM8rUx46nLC5g1cEmsxzhRVZPQ8m+QDPHq2iPKiXWaZufMzJCIsL29AuA5hCVcosvuD76G8dSvTB3dzbXWDqa3DHH/qDHmeAUrUN05heAxw3KAd0DpQALsfkZi80eLb/+K3KY4N015a4WWBnsn73sxiC75+vkgnFzZNhs85Z9WI7aKMnuYWzKxGPHs1oacQGQozT1GIHbMXrpJlOaBE1WHG7z0KJgEKHLlnP3NLGZPjgxx/8gz1RhvUgvQBMS8J1wEPUgU7RfW2Sfp3TTF4YA/FsRGQEkgVpEzPwGCVk34HL1yLuTXjp6woxpucYLac4BY9dr7AwoalZ0clcP3YY2wbG+DpJ8/ifQAixA4hpkyPiHDPvXew0u6nv1zi0unLfOOLX2H+L77B2slTvCyHcJ2etJZTnhjnvl//FNWpCSABikAMCD0hKKfmuii3RsOW57zmah+8+1MFQqlm+ObHISRsUlDhwkrEnpGMYqSMRCnnLsyzbd80585fpXP6BP3bt2Gc42UpY1unCW6A9fUVqiP9rHaFuROnmf/qnxCL0rh8hcrkGIjDFkcwrgmk2DgGHEhMjyrMzi7yh595nLXLdUSEzUuWg3/Pr2sguDiLNHVJFsL400auPsQtaKaG//BMhQ/e1WS45DlcrHH+G1+hdOB+asURvv67n2PX7gmG77yD6tQU4EFrjI6OUMkmaDKLv2awt+9nbXWK2a4jSSLWTs5io6tYm5DEEDQn7bao11dYurpEtbuGWV/hiWeVTh4hItyaiackSnziRe3Db/ilAiZDdX1cmH0btyj1wumlmPGqZ6AYGIo9ZmmG9VZG9dBR1rxj7vEnMGvLiDEUBktg+okqfZRKNcbGKwwmGVP7d5CZBBPHoErIA51Wi4vPvkB44Rj+4mkGF89w0F7HbDT4sxcSmqnj1Tn6GTE7noqNUfvAG34hCT6X3JeXnHnqZwDhFuVBOLUY0zPRn1OMhDFpoAsX6KY5fmI3jdIwXZuQq6dcApEU8ECGKxVwUYmhoUFGRvsZHRtgdGwAayA5/yT7yl1GikI5thy/mvDlkyXameHVEd/17/skEm14k6nTPAf1KoxeUt3+dZErb+NVCArfmClw7nrE2/e2mRzIGSlbRlgmtJa5cs3TvjrEeSlzrGuQSh/FaoVCKSaODWkGeZoyFAcKeRvWl6g2rrGjKPRcq1seO1fkSs3xWiiTXxMduCoh16CKM7lVNV6c8Rrkgd+x/OHbeA2WGpY/PF5hx2DOvVMddgzmGIGpfgvUgBrE3NBdD3SuB1TBWaEUG4wIN2lRuFJzPHU54fxyhCqvWeCB3zE2qISA8bG6NIrUWFX1OeT7Hjdu4hvC/Jt5jWbXHLNrFfqLgf2jGTuHM7ZWPZFVbkqcIXGG/13mhaWGZWbVcXYpYqVleb0o254I+d4/x+WaR0atWHWxQ0UjNZojUeS9ffc/Jf93XwN1vA5qbcO35xK+PZfgDAwUPQPFQDlWIqv0ZF5opcJ6x7DeNmReeP1JFty7/llB4mAwmmNVrcdJJ+CjoMbEiE8Q3XYiyBv/tei3PsXrLA+w3LQsNy3/r6m86TeN3/a8CZHiRH0IaluRGu2gVq1aE2kWcjSLlPDO30B2PMrfGJNfE33Hb4pPtJvngFHrUc1EjbiCOhWVbqreoFnuFV/MNPydj8L40/yQU8aeCeGDH8VHmVev3gY13UxtEMXkatLcabPZIojRKN1QrNU8dDTvROvB//QjysQ3+CGluuWY6scf8d2+tSzLVcVolDU0F9V2u0EnL6i9f/oTzpiEPG2KjRPEe2IMkYswlLvK9JfEtEswfzdg+OEQxNzxGfUf/LjTaj0S1OBVQlutLWq3mxE01jxLsXcf/Dnri4aiTyiQgYoaY8RaIdWAaOKtmX5Mza7HNVzdJ9Lczg8w1dFnxT3yCRPe+mkJSRYQtRLUaa4iRk3mVUxJu7HXXLtq7zryD61FiSNDKY3IrRfvIRglOKcGwYqgoXI14+gXVLc/oXhrZG07hAI/EEwz6K7/qfLwr3h9169aHZ2JcBrEahBFQ1tDMEowWgixdqJMWzbTTHN1cZqDFV0vQh5HmLxA0EwrxknikW7iCZmi0kGsDSa77Zve7/qmtxpF9spRYf6NhJmjyOLtUJ8ETfjrlUH5KrrlpMrkMyKTxzK//Um8a1sXwAbNQ6oSvJpiokkH9a6krbyr3id0krbWXa5R6snzgGvHQRPvJaqjjSoUxRB1E9qdDkkxIU0NNvKI6SNkKcZ3lDiIkyS1ZvpYnh865vO2GOvF2k5RdWWb92s7nDYmRGrjSmcU1x5CW/3QrYKWoFmEPAZ13CA5uBTKHZAmxHWkVCMU1yQUl4X+axnleTGDl0WGrvhQauKtii1q5FKiONc0bWOCaG4SIh+r913NWmhANUu7hBChcVdrLle3kdOWTH3JqxsobdN6tkLa6Uo1Q9MiqDqpypCa3FPqNggVq92QiwYrVkviQ1vFBokDquolt5mKtSKm1Ay+cC5w27mcgCMT5wwSRWR5JkE9AhgDISggCKCioAbVgAgY47DGachyvCpeHCpWjaYYa9RaJZcM52ONg9GuCSBGNU1ArHoJWiBWWp48LmspGtQNU6dJW5NGpq0oI6r0acVV9X8BXChrJiNQKxUAAAAASUVORK5CYII=",universalLink:"https://naanwallet.com",deepLink:"naan://"},{key:"autonomy-app",name:"Autonomy: Digital Art Wallet",shortName:"Autonomy",color:"",logo:"data:image/;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAIPElEQVR4AeXBe2yNdwPA8e/vdw5VdGmxJsV0SiKaLC5L3GLuySLZTObSLKOtS8XQHdritNWn+lTbHWXVRlyaoUhZOtFISJhLJAhxi6nJrOJadVDM5XC0nOd9+4dkked3ejunXu/5fITxXwQwSYCTBDhJgJMEOEmAkwQ4SYCTBDgrrejWrVtUVVVRzzAMDMPgXd26daNnz560FiutpLa2lhkzZvDq1StiY2ORUmJm1apVlJSUEBoaSmuw0kqKiopITU3lt99+48svvyQyMhIzgwcPJicnh/z8fFqDpBXcu3ePiooKxo0bh6Zp6LqOymeffUZdXR1//fUXrUHSCrKzs9E0jXrdunUjKiqKY8eOoZKRkUF2djatQeJn58+f56OPPqJXr168lZyczJo1a/B4PJjp3LkzQ4cOZe/evfibxI8Mw+Cnn34iNTWVf2vXrh3fffcdmzdvRmXu3Lls3ryZ2tpa/EniR2VlZYwfP56QkBDeNXnyZA4ePMiTJ08wY7VamT9/PoWFhfiTxE9evnxJWVkZcXFxqKSlpZGbm4vK2LFj+fPPP3E6nfiLxE/y8/NJTk5GSolKv379ePnyJX///Tcqmqah6zr+IvGD27dvc/v2bYYNG0ZDMjIyyM7ORiUqKopOnTpx9uxZ/EHiB7quo2kajfHxxx8zcOBADhw4gIrdbsfhcGAYBr4m8bETJ07Qo0cPPvnkExprwYIFbNy4kbq6Osx07NiRCRMmsGPHDnxN4kMej4eff/6ZlJQUmqJNmzYkJCSwbt06VKZNm0Z5eTkulwtfkvhQSUkJMTExBAcH01Tjx4/nzJkz1NTUYEYIwZIlS3A4HPiSxEeePn3K/v37mTJlCiqHDx+muLgYlYyMDLKzs1EZNGgQDx484Pr16/iKxEfy8vJITU1FCIGZuro65s+fT1JSElVVVZjp06cPQUFBXLx4ERVN08jKysJXJD5w9epVnj17xoABA1BZu3YtV65cweVysXTpUlTS0tLIzc1FJSIigujoaI4cOYIvSHxA13U0TUPlwYMH6LrOWzt37uTEiROYCQ0NZcyYMezevRsVm83G2rVref36NS0laaGDBw/Sr18/wsPDUcnIyOCff/7hLcMwsNlseDwezMyaNYvS0lLcbjdmgoKCiI+Pp7i4mJaStMDr169Zv349iYmJqFy4cIFffvmFd507d44tW7ZgxmKx8OOPP1JQUIDKhAkTOH78OI8ePaIlJC2wYcMGZs6cSdu2bVFZtGgRb968wUxaWhpPnjzBzMiRI6msrKS6uhqVZcuWsWLFClpC0kwPHz7k5MmTfPXVV6js2rWLo0ePonL//n10XUdF0zR0XUclOjoaKSWXLl2iuSTNtGLFCpYtW4aK2+1m8eLFeNOhQwfu3r3LlStXMPPpp58SHh7O6dOnUUlPTycnJ4fmkjTDpUuXsFgs9O3bF5XVq1dz48YNvLHb7RQVFaHrOipLly5l5cqVGIaBmbCwMEaNGkV5eTnNIWmGnJwc0tPTUblz5w55eXl4ExkZSXJyMl26dGHIkCHs27cPMx06dGDixImUlpaiMnv2bLZv347b7aapJE20Z88eRowYQVhYGCp2ux2Xy4U3DoeD4OBg6v3www9s2rSJ2tpazHz//ffs2bMHl8uFGYvFgs1mo6CggKaSNMGrV6/YunUrc+bMQeXUqVOUlpbizfDhw5k6dSpvWa1W5s2bR1FREWaEECxevBiHw4HKyJEjqayspLq6mqaQNEFhYSGJiYlYLBbMGIaBzWbDMAxUpJSsWbMGIQT/Nm7cOCoqKnA6nZgZNGgQ9+/f58aNG6hkZmaSlZVFU0gayel0cvnyZUaPHo3Ktm3bOH36NN7ExcXx+eefYyYzMxNd11HJzMwkKysLlcjISCIiIjh16hSNZaWRdF0nMzMTlefPn5OWloY3UkrGjBnDoUOHqOfxeHjL4/FQ7+bNm5SUlBAeHk49j8fDWx6Ph0ePHnHs2DG++OILzCxZsoTY2FjKysqQUtIQK41w9uxZOnXqRM+ePVHJzc2luroabxISEqjndDoRQiCEoJ4QAiEE9WJjYxFC8Pz5c4QQCCGoJ4RACEFcXBx9+vRBpX379kyePJlt27YRHx9PQ6w0wDAMHA4HW7ZsQeXatWsUFBTgTVRUFIWFhQQFBeFvMTExxMTEMGnSJEJCQvBG0oCdO3fy9ddf07FjR1RSUlJwu914k5+fT1BQEK1BCIHdbicvL4+GSLx48eIFu3fvZvr06agcOXKE8vJyvBk1ahTffvstrWngwIE8ffqUq1ev4o3Ei5UrV5KSkoIQAjNv3rxh4cKFeGOxWCgoKOB90DQNXdfxRqJw8+ZN7t69y5AhQ1ApLi6moqICb2bNmkX//v15H8LDw+nfvz+///47KlYUdF1H13VUHj9+jKZpeBMSEkJ6ejput5v3JSEhgWnTpjF69GjatGnDu6yY8Hg8OJ1Ounbtisry5cupqanBm2fPnhEZGcn7FhYWhsvlIjQ0lHdJTEgpiY+PZ+PGjZi5fPky69ev50Nht9sJDQ3FjERhypQpnDx5kqqqKt6VlJREXV0dH4Lu3buTmJiIisSLvLw8UlNT+be9e/dy4MABPhTLly8nODgYFYkXXbt2ZcSIEfz666/Uq62tJSkpiQ9FdHQ08fHxeCNpwOzZsykvL6empoaioiIqKyv5UOTm5mKxWPDGSgOEEOTk5LBgwQL279/Ph2LYsGF88803NMRKI/Tu3ZuhQ4fyxx9/EBERwf86IQSrVq2iMaw0ks1mw2az8f9GEuAkAU4S4CQBThLgJAFOEuAkAe4/IW7lge8FkmkAAAAASUVORK5CYII=",universalLink:"https://autonomy.io/apps/tezos",deepLink:"autonomy-tezos://"},{key:"temple_ios",name:"Temple Wallet",shortName:"Temple",color:"",logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAIAElEQVR4AeXB3W9b9RnA8e/znHOcOGliO3aiUkLfCyNDLdIkShtKIu2GiwlVbNP2d3C7m11Mu9jlNG2X7AJpm5i0MSGtEpu0ZKhMoxUVsJVBm5emaUtI7DiB+Pjl93uGXRzaDBGGT10kfz4CGD1M6XFKj1N6nNLjlB6n9Dilxyk9LiRBx8cizn7nARChRQAREED4hIAAAiJCiwAiIIAILQKIgHCbCAgg8KtfL7KyWiUpIQk5MRpy7uwQheceQIZSoAICqCAqIAIKiIAKCKACIqACAqICKiACCoiACoiAAipcXdjixd9fJylKAk6Mhpz7boaRwQBWt9jJjN0JX8Bomz6dJ0lKh06MhZz7fpaRwQBUsLUKX4mxO4OpyQJJUjo09VCKkYEAVCBQKMZ8FSLsTuDIwUHG96VJSkiHZpbqEAiI0GQ1B1t12JOipdLA1ipsEz4htAi3CRhNAsJnhNsCRR8fAwMEpifzvPjSdZIQ0qG3P6xTqsFIWkBosWKM7EnRUnP4vyyAN3AG3sAZeA/OwBt4A2eYN3AG3sAZeAPvkbFBZHwIGR2gafp0gRdfuk4SQjrkDV5brvHsI2laRGA9hv3DtGT60FMPghmfy/hixRj/zofY3DoyNkDT1GSepIQkYPZajWcfHQABRLD1KsJn5NE8IgIKiIAKCKACIqACAqICKiACCohApYG/eAt7rwgn94HAkUODjO9Lc/1GhU4pCZhZqEEgoAoqUHdQabDN+D8Z2wYjJNePv7xGmwDTkwWSoCTg7Q9qlKpAIBAIqGLlmG3C7oTbzADhTvLICNQ9rFVom57MkwQlAd7g79eqEAioQCBQrrHN+FL8Wyu4VxfZKTh7jOhn05BP0zY1WSAJSkJm52NQgUBBBdussk3YnYfGC+9gl1f5Mo4eGmR8X5pOKQmZmY8hEFCBQKDhoepoMXanIAeG8XPr4DxfxLht+qkCnQpJyNs3apRiIzeotHjD/3kOUgEEAoFAoBAI9AXot/YiuX7upA+P4K6UsMUN5GiWJlvdwr9xE8IAIkUihVCxSHGlmE6FJMQbvDZf5dnjg+ANf2kF26xCoBApEiqECn0BcjQHqxXI9bPNQI7lQMC/XyQ4mqVJ9qTw7xYhpUgqwFIhpJTnXynxm9l1OqUkaOZqBQz8GzexYkyL8JlAkENZJBVgxZid5FAGUgH2folt/SEyNgAIIBjw/Mtr/GJ2nSSEJOiv727x5qvLUIohUAiA0CDw9KeFb0zkoC/AnEG5CnUPqYA2CRU9lMXPl8EZhELTan4Py//5CCLHC29V+OU/NklKSIL+dbPKE6/wKc+dBlPKyiklcgZmYGDFGNk7SIvQIsdycLWELW4gR7I0/TPo5+wLq9wLSpd8XPNcWIzBeXAGzmOrW2wzWuRYDkTwV0q0nTk5gqpwLyhdNHOlAs7AGTiDlS3aRGjRAxlIKXalRFsuE3FiYph7Qemi2asVcB6cB2dYMYa6o8n4VKTowSy2UAZntE2fznMvKF10frFKrebBeXAenMdWtthJjmWxuseWNmibOpXnXlC6aKtuXFiqgjNwBg2PffAxLcY2OZIDAX+lRNuZkyOoCklTumx2PsacYc5jzrAbH7GTHsggqQCbW6ctl404MTFM0pQum1mogfPgDLxhqxWoOu4SCnIwgy2UwXnapk7nSZrSZa8v16jVPDgPzkPDYzc/AuEOghzJQt1jS5u0TZ/OkzSly7bqxoUbNXAGzsB5bHmTnfRIFlSwuXXazjyZR1VIUkiXjaaV0eMFgskxEAEB6QvBAGGb7B+GSPFz6+i3D9CUy0ScmBjmzXfKJEXpotG0cu57WR5OeSSfRgpppDAAmT4Q7hYqciCDLW6AN9qmJvMkSemS0QHl3A9yPLY3wkoxeGM3cjgLDYdd36Rt+nSBJCldoALnfjjCY3tTECkiYMWYuxj/Qw9nQQSbW6ftzJMjqApJUbrAG6T6FIkUCRVCxVYr7EYeGoJI8fNl2nLZFMcnhkmK0iWzS3UIFcIAQoVSzK5CRfZnsKUNcAZCy/RknqQoXTJzrQaRQqQQKbZRBW9sEz6XHs5A3WPLm7RNTRZISkiXzM7HECqIgADlKo2fX4RIIQogHRJMjqMTee4kh7Lwt2vYQhk5kAGBp5/Moyp4b3RK6ZJbm473Sg6JFDZq+H+vYeUqtlGDrTqST2NrW+wk40MQBfiFMggtI7mI498cJglKF83Mx1gpxl/6ALzRJKEih7MQCFaMsZrjLqEi+4expU1wRpMB05MFkhAAP6ZL1jcbVK6WuVgyLm7AxXXj8ZMFgv4QvIEzNJ9GhlMgAiIgAuUqNreOPpxDMv2IQFwzfveHZToV0kXnF6ucp83T9PgTDU7tD8AbGNitj5EHh7iTHMzArGALZWR/hqanT+VRFbw3OqHcZzPvV6DuoeGh4fA3NtlJxocgUmxxg7aRbMTxiWE6pdxnM3MxNBw0PDQ8rGxh1QZ3CQR5aAh/fRO80Tb1VIFOhdxnry9VqVU9kQBmsFGj/qNZCBVCRUKFVAD9AThP/afnIVRKVWPmj2U6pdxnW3XjwlIVGh5KMbZQhqqDqoOqw6oOnIe4AXUPdU9xo8EzL61z6VadTilfAzMLVSjG2HwZvLGT1R3W8DQVY+OZlze49GGDJIR8Dfz2ckz9lgcMFFAPaqAeVEAFVECFPy3WeWvNkZSQr4HLJcdPSnzKAKNblB6n9Dilxyk9TulxSo9TepzS4/4Lz8MqhS9ENeQAAAAASUVORK5CYII=",universalLink:"https://templewallet.com",deepLink:"temple://"}];const UM=()=>NM,zM=()=>kM,FM=()=>DM,HM=()=>BM,GM=new ES,VM=["ookjlbkiijinhpmnjffcofjonbfbgaoc","gpfndedineagiepkpinficbcbbgjoenn"];var jM,WM;!function(t){t[t.DESKTOP=0]="DESKTOP",t[t.IOS=1]="IOS",t[t.ANDROID=2]="ANDROID"}(jM||(jM={})),function(t){t.IOS="ios",t.ANDROID="android",t.EXTENSION="extension",t.DESKTOP="desktop",t.WEB="web"}(WM||(WM={}));class qM{static getPlatfrom(){return OM(this,void 0,void 0,(function*(){return LM(window)?jM.ANDROID:RM(window)?jM.IOS:jM.DESKTOP}))}static getPairingInfo(t,e,n,r){return OM(this,void 0,void 0,(function*(){const i=null!=r?r:yield qM.getPlatfrom(),o=t.p2pSyncCode,s=t.postmessageSyncCode,a=t.preferredNetwork;switch(i){case jM.DESKTOP:return qM.getDesktopPairingAlert(o,e,s,n,a);case jM.IOS:return qM.getIOSPairingAlert(o,e,a);case jM.ANDROID:return qM.getAndroidPairingAlert(o,e,a);default:throw new Error("platform unknown")}}))}static getDesktopPairingAlert(t,e,n,r,i){return OM(this,void 0,void 0,(function*(){const o=yield EM.getAvailableExtensions();o.forEach((t=>{const e=VM.indexOf(t.id);e>=0&&VM.splice(e,1)}));const s=[];return zM().length>0&&s.push({title:"Browser Extensions",type:WM.EXTENSION,wallets:[...o.map((t=>{var r,i,o,s,a;const l=zM().find((e=>e.id===t.id));return{key:null!==(r=null==l?void 0:l.key)&&void 0!==r?r:t.id,name:null!==(i=t.name)&&void 0!==i?i:null==l?void 0:l.name,logo:null!==(o=t.iconUrl)&&void 0!==o?o:null==l?void 0:l.logo,shortName:null!==(s=t.shortName)&&void 0!==s?s:null==l?void 0:l.shortName,color:null!==(a=t.color)&&void 0!==a?a:null==l?void 0:l.color,enabled:!0,clicked:!1,clickHandler(){return OM(this,void 0,void 0,(function*(){if(!this.clicked){if(this.clicked=!0,n){const e=yield GM.serialize(yield n()),r={target:CE.EXTENSION,payload:e,targetId:t.id};WE.postMessage(r,WE.location.origin)}e(WM.EXTENSION,this)}}))}}})),...zM().filter((t=>VM.some((e=>e===t.id)))).map((t=>({key:t.key,name:t.name,shortName:t.shortName,color:t.color,logo:t.logo,enabled:!1,clickHandler:()=>{window.open(t.link,"_blank")}})))].sort(((t,e)=>t.key.localeCompare(e.key)))}),UM().length>0&&s.push({title:"Desktop & Web Wallets",type:WM.DESKTOP,wallets:[...UM().map((n=>({key:n.key,name:n.name,shortName:n.shortName,color:n.color,logo:n.logo,enabled:!0,clicked:!1,clickHandler(){return OM(this,void 0,void 0,(function*(){if(this.clicked)return;this.clicked=!0;const r=yield GM.serialize(yield t()),i=IM(n.deepLink,r);window.open(i,"_blank"),e(WM.DESKTOP,this,!0)}))}}))),...yield qM.getWebList(t,e,i)].sort(((t,e)=>t.key.localeCompare(e.key)))}),HM().length>0&&s.push({title:"Mobile Wallets",type:WM.IOS,wallets:[...HM().map((n=>({key:n.key,name:n.name,shortName:n.shortName,color:n.color,logo:n.logo,enabled:!0,clicked:!1,clickHandler(){return OM(this,void 0,void 0,(function*(){if(this.clicked)return;this.clicked=!0;const n=yield GM.serialize(yield t());r(n),e(WM.IOS,this,!0)}))}})))].sort(((t,e)=>t.key.localeCompare(e.key)))}),{walletLists:s,buttons:[]}}))}static getIOSPairingAlert(t,e,n){return OM(this,void 0,void 0,(function*(){return{walletLists:[{title:"Mobile Wallets",type:WM.IOS,wallets:HM().map((n=>({key:n.key,name:n.name,shortName:n.shortName,color:n.color,logo:n.logo,enabled:!0,clicked:!1,clickHandler(){var r;return OM(this,void 0,void 0,(function*(){if(this.clicked)return;this.clicked=!0;const i=yield GM.serialize(yield t()),o=IM(null!==(r=n.deepLink)&&void 0!==r?r:n.universalLink,i),s=document.createElement("a");s.setAttribute("href",o),s.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})),e(WM.IOS,this,!0)}))}}))).sort(((t,e)=>t.key.localeCompare(e.key)))},{title:"Web Wallets",type:WM.WEB,wallets:[...yield qM.getWebList(t,e,n)].sort(((t,e)=>t.key.localeCompare(e.key)))}],buttons:[]}}))}static getAndroidPairingAlert(t,e,n){return OM(this,void 0,void 0,(function*(){return{walletLists:[{title:"Web Wallets",type:WM.WEB,wallets:[...yield qM.getWebList(t,e,n)].sort(((t,e)=>t.key.localeCompare(e.key)))}],buttons:[{title:"Mobile Wallets",text:"Connect Wallet",clickHandler:()=>OM(this,void 0,void 0,(function*(){const n=yield GM.serialize(yield t()),r=IM("tezos://",n);window.open(r,"_blank"),e(WM.ANDROID)}))}]}}))}static getWebList(t,e,n){return OM(this,void 0,void 0,(function*(){return FM().map((r=>({key:r.key,name:r.name,shortName:r.shortName,color:r.color,logo:r.logo,enabled:!0,clicked:!1,clickHandler(){if(this.clicked)return;this.clicked=!0;const i=window.open("","_blank");t().then((t=>GM.serialize(t))).then((t=>{var o;const s=IM(null!==(o=r.links[n])&&void 0!==o?o:r.links[AE.MAINNET],t);i?i.location.href=s:window.open(s,"_blank"),e(WM.WEB,this,!0)})).catch((t=>{console.error(t)}))}}))).sort(((t,e)=>t.key.localeCompare(e.key)))}))}}const KM=(t,e,n,r)=>{const i=document.createElement(t);return e.length>0&&i.classList.add(...e.filter((t=>!!t)).map((t=>ZM(t)))),n.forEach((t=>{i.setAttribute(ZM(t[0]),ZM(t[1]))})),"object"==typeof r&&Array.isArray(r)?r.filter((t=>!!t)).forEach((t=>{i.appendChild(t)})):"string"==typeof r&&(i.innerText=r),i},XM=(t,e,n)=>{const r=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.length>0&&r.classList.add(...t.filter((t=>!!t))),e.forEach((t=>{r.setAttribute(ZM(t[0]),ZM(t[1]))})),"object"==typeof n&&Array.isArray(n)&&n.filter((t=>!!t)).forEach((t=>{r.appendChild(t)})),r},YM=t=>{const e=document.createElementNS("http://www.w3.org/2000/svg","path");return t.forEach((t=>{e.setAttribute(ZM(t[0]),ZM(t[1]))})),e},JM=t=>{const e=document.createElementNS("http://www.w3.org/2000/svg","g");return t.filter((t=>!!t)).forEach((t=>{e.appendChild(t)})),e},ZM=t=>{const e=document.createElement("div");return e.innerText=t,e.innerHTML},QM=t=>{t.innerHTML=""};var $M=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const tT=new nS("Alert"),eT=new ES,nT=(t,e,n)=>$M(void 0,void 0,void 0,(function*(){const r=()=>$M(void 0,void 0,void 0,(function*(){return qM.getPairingInfo(n,((t,e,n)=>$M(void 0,void 0,void 0,(function*(){n||(yield dT())}))),(()=>$M(void 0,void 0,void 0,(function*(){b()}))))})),i=yield r(),o=e.getElementById("pairing-container");if(!o)throw new Error("container not found");const s=document.createElement("span");o.appendChild(s),i.buttons.forEach((t=>$M(void 0,void 0,void 0,(function*(){const n=yield FE(),r=KM("div",["beacon-list__title"],[],t.title),i=KM("button",["beacon-modal__button","connect__btn"],[],t.text),o=document.createElement("a");o.id=`button_${n}`,o.appendChild(r),o.appendChild(i),s.appendChild(o);const a=e.getElementById(o.id);a&&a.addEventListener("click",(()=>$M(void 0,void 0,void 0,(function*(){t.clickHandler()}))))}))));const a=document.createElement("span");o.appendChild(a);const l=t=>{QM(a),t.forEach((t=>{const n=document.createElement("div");n.classList.add("beacon-list__wrapper"),a.appendChild(n),n.appendChild(KM("div",["beacon-list__title"],[],t.title));const r=document.createElement("span");n.appendChild(r),t.wallets.forEach((n=>$M(void 0,void 0,void 0,(function*(){((t,n,r)=>{const i=`Open in ${r.name}`,o=r.key,s=r.logo?KM("div",[],[],[KM("img",["beacon-selection__img"],[["src",r.logo]],"")]):XM(["beacon-selection__img","svg-inline--fa","fa-wallet","fa-w-16"],[["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","wallet"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 512 512"],["style","enable-background:new 0 0 512 512;"],["xml:space","preserve"]],[YM([["d","M376.2,181H152.9c-5.2,0-9.4-4.2-9.4-9.4s4.2-9.4,9.4-9.4h225c5.2,0,9.4-4.2,9.4-9.4c0-15.5-12.6-28.1-28.1-28.1H143.5c-20.7,0-37.5,16.8-37.5,37.5v187.5c0,20.7,16.8,37.5,37.5,37.5h232.7c16.4,0,29.8-12.6,29.8-28.1v-150C406,193.6,392.7,181,376.2,181z M349.8,302.9c-10.4,0-18.8-8.4-18.8-18.8s8.4-18.8,18.8-18.8s18.8,8.4,18.8,18.8S360.1,302.9,349.8,302.9z"]])]),a=KM("div",["beacon-selection__name"],[],[KM("span",[],[],r.name),r.enabled?void 0:KM("p",[],[],"Not installed")]),l=KM("a",["beacon-selection__list",r.enabled?"":"disabled"],[["tabindex","0"],["id",`wallet_${o}`],["alt",i],["target","_blank"]],[a,s]),c=document.createElement("span");c.appendChild(l),t.appendChild(c);const u=e.getElementById(`wallet_${o}`),h=t=>$M(void 0,void 0,void 0,(function*(){if(t&&"Enter"!==t.key)return;r.clickHandler();const i=e.getElementById("beacon-modal__content");i&&n!==WM.EXTENSION&&n!==WM.IOS&&(QM(i),i.appendChild(KM("p",["beacon-alert__title"],[],"Establishing Connection..")),i.appendChild(KM("div",["progress-line"],[["id","beacon-toast-loader"]],"")),i.appendChild(KM("div",["beacon--selected__container"],[],[...r.logo?[KM("img",["beacon-selection__img"],[["src",r.logo]],""),KM("img",["beacon--selection__name__lg"],[],r.name)]:[]])))}));u&&(u.addEventListener("click",(()=>h())),u.addEventListener("keydown",h))})(r,t.type,n)}))))}))};l(i.walletLists);const c=t=>$M(void 0,void 0,void 0,(function*(){if("extensionsUpdated"===t.data){const t=yield r();l(t.walletLists)}}));let u;u=e=>{e.data===`closeAlert-${t}`&&(WE.removeEventListener("message",c),WE.removeEventListener("message",u))},WE.addEventListener("message",c),WE.addEventListener("message",u);const h=e.getElementById("beacon--qr__container"),d=e.getElementById("beacon--qr__copy"),p=e.getElementById("beacon-title"),f=LM(window)?"android":RM(window)?"ios":"desktop",m=e.getElementById("beacon-main-text"),g=e.getElementById("pairing-container"),y=e.getElementById("beacon--switch__container"),v=()=>$M(void 0,void 0,void 0,(function*(){const t=n?yield eT.serialize(yield n.p2pSyncCode()):"";navigator.clipboard.writeText(t).then((()=>{d&&(d.innerText="Copied"),tT.log("Copying to clipboard was successful!")}),(t=>{tT.error("Could not copy text to clipboard: ",t)}))}));let _=!1;let w=!1;const b=()=>{(t=>{$M(void 0,void 0,void 0,(function*(){const r=e.getElementById("beacon-switch");if(r&&(r.innerText="none"===t?"Pair wallet on same device":"Pair wallet on another device"),m&&g&&y&&d&&h&&p)switch(m.style.display="none",p.style.textAlign="center",g.style.display="none",y.style.display="initial",t){case"ios":case"android":g.style.display="initial";break;case"desktop":g.style.display="initial",p.style.textAlign="left",m.style.display="none",y.style.display="initial";break;default:if(!_){_=!0;const t=yield eT.serialize(yield n.p2pSyncCode()),e=((t,e)=>{const n=CM(0,"L");t.length>500&&PM.warn("getQrData",'The size of the payload in the QR code is quite long and some devices might not be able to scan it anymore. To reduce the QR size, try using a shorter "name", "appUrl" and "iconUrl"');try{return n.addData(t),n.make(),n.createSvgTag()}catch(t){throw console.error("error",t),t}})(IM("tezos://",t)),r=e.replace("<svg",'<svg class="beacon-alert__image"');h.insertAdjacentHTML("afterbegin",r),d&&d.addEventListener("click",v),h&&h.addEventListener("click",v)}m.style.display="initial"}}))})(w?"none":f),w=!w};b();{const t=e.getElementById("beacon-switch");t&&t.addEventListener("click",b)}}));let rT=VE.LIGHT;const iT=t=>{rT=t},oT=()=>rT,sT=(t,e,n,r)=>KM("div",["beacon-alert__base","animated","fadeIn"],[["id",`beacon-alert-modal-${t}`]],[KM("div",["beacon-modal__wrapper"],[],[KM("div",["beacon-modal__header"],[],[XM([],[["xmlns","http://www.w3.org/2000/svg"],["id","Guides"],["x","0"],["y","0"],["version","1.1"],["viewBox","0 0 179.2 43"],["xml:space","preserve"],["width","140"],["height","40"]],[KM("style",[],[],".st0 {\n                    fill: #3880ff;\n                  }\n                  .st1 {\n                    fill: #fff;\n                  }"),YM([["d","M45 19v.9c0 .3-.2 7.5-3.4 13.2-3.3 5.6-9.4 9.3-9.7 9.5l-.8.4-1.3-.8-7.6-4.4c-.5-.3-.9-.6-1.4-.9-.4-.3-.7-.5-1.1-.8-.8-.7-1.5-1.4-2.1-2.2-.9-1.1-1.6-2.4-2.1-3.7-.9-2.3-1.3-4.8-1.2-7.5.8-.4 1.6-.6 2.4-.6h.6c-.2 2.4.1 4.6.8 6.6 1 2.8 2.9 5.1 5.5 6.6l7.4 4.3c.2-.1.4-.2.6-.4 1.9-1.3 5.3-4.1 7.3-7.6 2.2-3.9 2.8-8.9 3-10.8L38.8 19c.3-1 .4-2.1.5-3.2L45 19z"],["class","st0"]]),YM([["d","M36.3 4.1v10.3c0 .5 0 1.1-.1 1.6s-.1.9-.2 1.3c-.2 1-.5 2-.9 3-.5 1.3-1.3 2.6-2.2 3.7-1.5 1.9-3.5 3.6-5.9 4.8-.9-.6-1.6-1.3-2-2.4 2.1-1 3.9-2.3 5.2-4 1.9-2.3 3-5.1 3-8.1V5.9l-.6-.3c-2-1-6.1-2.6-10.1-2.6-4.5 0-9.1 2-10.9 2.9v3.6c-1 .3-2 .7-3 1.1V4.1l.8-.4C9.7 3.5 16 0 22.5 0s12.8 3.5 13.1 3.6l.7.5z"],["class","st0"]]),YM([["d","M10.5 16.5l-7.4 4.3v.7c.2 2.1.9 6.5 2.9 10 2.2 3.9 6.2 6.9 7.9 8l3.1-1.8c.8.7 1.6 1.4 2.5 2L13.8 43l-.8-.5c-.3-.2-6.4-3.9-9.7-9.5C.1 27.4 0 20.2 0 19.9V19l1.3-.8L9 13.9c.5-.3.9-.5 1.4-.7.4-.2.8-.4 1.3-.5 1-.4 2-.6 3-.7 1.4-.2 2.9-.2 4.3 0 2.4.3 4.8 1.2 7.1 2.7 0 1-.4 2-1 2.9-1.9-1.3-4-2.2-6-2.5-3.1-.6-6-.1-8.6 1.4z"],["class","st0"]]),JM([YM([["d","M73.9 23c.9 1 1.3 2.3 1.3 3.7 0 1.9-.6 3.4-1.9 4.5-1.3 1.1-3.1 1.7-5.5 1.7h-8.6v-23h8.4c2.3 0 4.1.5 5.3 1.5 1.2 1 1.8 2.4 1.8 4.2 0 1.5-.4 2.7-1.2 3.6-.8.9-1.8 1.5-3.1 1.8 1.5.3 2.6 1 3.5 2zm-11.7-3h5c1.5 0 2.6-.3 3.4-1 .8-.7 1.2-1.6 1.2-2.8 0-1.2-.4-2.1-1.1-2.8-.8-.7-1.9-1-3.5-1h-4.8V20zm8.7 9.4c.9-.7 1.3-1.7 1.3-3s-.4-2.3-1.3-3c-.9-.7-2.1-1.1-3.7-1.1h-5v8.2h5c1.6-.1 2.8-.4 3.7-1.1zM95.3 24.6H81c.1 2.1.6 3.6 1.7 4.6s2.4 1.5 4 1.5c1.4 0 2.6-.4 3.6-1.1 1-.7 1.6-1.7 1.8-2.9h3.2c-.2 1.2-.7 2.4-1.5 3.3-.8 1-1.7 1.7-2.9 2.3-1.2.5-2.6.8-4.1.8-1.7 0-3.2-.4-4.6-1.1-1.3-.7-2.4-1.8-3.1-3.2-.8-1.4-1.1-3-1.1-4.9 0-1.9.4-3.5 1.1-4.9.8-1.4 1.8-2.5 3.1-3.2 1.3-.7 2.9-1.1 4.6-1.1 1.7 0 3.3.4 4.6 1.1 1.3.7 2.3 1.7 3 3 .7 1.2 1 2.6 1 4.1.1.7 0 1.2-.1 1.7zm-3.5-4.8c-.5-.9-1.2-1.6-2.1-2-.9-.4-1.8-.7-2.8-.7-1.6 0-3 .5-4.1 1.5-1.1 1-1.7 2.5-1.8 4.5h11.5c0-1.3-.2-2.4-.7-3.3zM111.2 16c1.2.9 2.1 2 2.5 3.5V15h3v18h-3v-4.6c-.5 1.5-1.3 2.6-2.5 3.5-1.2.9-2.7 1.3-4.4 1.3-1.6 0-3-.4-4.3-1.1-1.2-.7-2.2-1.8-2.9-3.2-.7-1.4-1.1-3-1.1-4.9 0-1.9.4-3.5 1.1-4.9.7-1.4 1.7-2.5 2.9-3.2 1.2-.7 2.7-1.1 4.3-1.1 1.7-.1 3.1.4 4.4 1.2zm-8 3.1c-1.1 1.2-1.7 2.8-1.7 4.8 0 2.1.5 3.7 1.7 4.8 1.1 1.2 2.6 1.8 4.4 1.8 1.2 0 2.2-.3 3.2-.8.9-.5 1.7-1.3 2.2-2.3.5-1 .8-2.1.8-3.5 0-1.3-.3-2.5-.8-3.5s-1.2-1.8-2.2-2.3c-.9-.5-2-.8-3.2-.8-1.9.1-3.3.7-4.4 1.8zM135 16.6c1.5 1.2 2.4 2.9 2.8 4.9h-3.1c-.2-1.3-.8-2.3-1.8-3-1-.7-2.2-1.1-3.6-1.1-1 0-2 .2-2.9.7-.9.5-1.6 1.2-2.1 2.2-.5 1-.8 2.2-.8 3.7s.3 2.7.8 3.7 1.2 1.7 2.1 2.2c.9.5 1.8.7 2.9.7 1.4 0 2.6-.4 3.6-1.1 1-.7 1.6-1.8 1.8-3h3.1c-.3 2.1-1.3 3.7-2.8 4.9-1.5 1.2-3.4 1.8-5.7 1.8-1.7 0-3.2-.4-4.6-1.1-1.3-.7-2.4-1.8-3.1-3.2-.8-1.4-1.1-3-1.1-4.9 0-1.9.4-3.5 1.1-4.9.8-1.4 1.8-2.5 3.1-3.2 1.3-.7 2.9-1.1 4.6-1.1 2.3-.1 4.2.6 5.7 1.8zM154.5 15.9c1.4.7 2.4 1.8 3.2 3.2.8 1.4 1.2 3 1.2 4.9 0 1.9-.4 3.5-1.2 4.9-.8 1.4-1.8 2.4-3.2 3.2-1.4.7-2.9 1.1-4.6 1.1-1.7 0-3.3-.4-4.6-1.1-1.4-.7-2.4-1.8-3.2-3.2-.8-1.4-1.2-3-1.2-4.9 0-1.9.4-3.5 1.2-4.9.8-1.4 1.9-2.5 3.2-3.2 1.4-.7 2.9-1.1 4.6-1.1 1.7-.1 3.2.3 4.6 1.1zm-7.6 2.2c-.9.5-1.6 1.2-2.2 2.2-.6 1-.8 2.2-.8 3.7 0 1.4.3 2.7.8 3.6.6 1 1.3 1.7 2.2 2.2.9.5 1.9.7 3 .7s2.1-.2 3-.7c.9-.5 1.6-1.2 2.2-2.2.6-1 .8-2.2.8-3.6 0-1.5-.3-2.7-.8-3.7-.6-1-1.3-1.7-2.2-2.2-.9-.5-1.9-.7-3-.7s-2.1.2-3 .7zM177.3 16.7c1.3 1.3 1.9 3.3 1.9 5.8v10.4h-3V22.8c0-1.8-.5-3.2-1.4-4.1-.9-1-2.2-1.4-3.7-1.4-1.6 0-2.9.5-3.9 1.6s-1.5 2.6-1.5 4.6V33h-3V15h3v4.3c.5-1.5 1.3-2.6 2.4-3.4 1.2-.8 2.5-1.2 4-1.2 2.2 0 3.9.6 5.2 2z"],["class","st1"]])])]),KM("div",["beacon-modal__close__wrapper"],[["id",`beacon-alert-${t}-close`]],[KM("div",["beacon-modal__close__icon"],[],[KM("div",["beacon-modal__close__line1"],[],[]),KM("div",["beacon-modal__close__line2"],[],[])])])]),KM("div",["beacon-modal__base"],[],[KM("div",[],[["id","beacon-modal__content"]],[KM("div",[],[],[KM("p",["beacon-alert__title"],[],e),...r,KM("div",["beacon-action__container"],[],n)])])])])]);var aT=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};let lT,cT;"undefined"!=typeof window&&void 0!==window.document&&(cT=window.document);const uT={},hT=t=>(WE.postMessage(`closeAlert-${t}`),new Promise((e=>{var n;const r=cT.getElementById(`beacon-alert-wrapper-${t}`);if(!r)return e();const i=null===(n=r.shadowRoot)||void 0===n?void 0:n.getElementById(`beacon-alert-modal-${t}`);if(i){const n=300,o=uT[t];o&&(clearTimeout(o),uT[t]=void 0),i.className=i.className.replace("fadeIn","fadeOut"),window.setTimeout((()=>{const t=r.parentNode;t&&t.removeChild(r),lT&&lT.focus(),e()}),n)}else e()}))),dT=()=>aT(void 0,void 0,void 0,(function*(){return new Promise((t=>aT(void 0,void 0,void 0,(function*(){const e=cT.querySelectorAll('[id^="beacon-alert-wrapper-"]');if(e.length>0){const n=[];e.forEach((t=>aT(void 0,void 0,void 0,(function*(){n.push(t.id.split("-")[3])})))),yield Promise.all(n.map(hT)),t()}else t()}))))})),pT=t=>aT(void 0,void 0,void 0,(function*(){var e,n;const r=t.body,i=t.data,o=t.title,s=t.timer,a=t.pairingPayload,l=t.disclaimerText,c=t.closeButtonCallback;yield dT();const u=(yield FE()).split("-").join(""),h=cT.createElement("div");h.setAttribute("id",`beacon-alert-wrapper-${u}`);const d=h.attachShadow({mode:"open"}),p=cT.createElement("div");p.setAttribute("tabindex","0"),d.appendChild(p);const f=[...null!==(n=null===(e=t.buttons)||void 0===e?void 0:e.map((t=>{var e,n;return{text:t.text,actionCallback:null!==(e=t.actionCallback)&&void 0!==e?e:()=>Promise.resolve(),style:null!==(n=t.style)&&void 0!==n?n:"outline"}})))&&void 0!==n?n:[]];let m=a?"string"==typeof r?KM("div",[],[["id","beacon--qr__container"]],[KM("div",[],[["id","beacon--qr__copy__container"]],[KM("button",["beacon-modal__button--outline"],[["id","beacon--qr__copy"]],"Copy")])]):KM("span",[],[],""):KM("span",[],[],null!=r?r:"");i&&(m=KM("span",[],[],[m,KM("pre",[],[["style","text-align: left"]],i)]));const{style:g,html:y}=((t,e,n,r,i)=>{const o=n,s=r.map(((e,n)=>KM("button",["beacon-modal__button"+("outline"===e.style?"--outline":"")],[["id",`beacon-alert-${t}-${n}`]],e.text)));let a=SM;i&&(a+=MM);const l=KM("span",[],[],o),c=i?((t,e,n,r)=>sT(t,e,n,[KM("span",[],[["id","pairing-container"]],""),KM("div",["beacon-alert__text"],[["id","beacon-main-text"]],[KM("p",["beacon-list__title"],[["id","beacon-title"]],[document.createTextNode("Scan QR code with a Beacon-compatible wallet. "),KM("a",[],[["href","https://docs.walletbeacon.io/supported-wallets"],["target","_blank"]],"Learn more"),...r])]),KM("div",[],[["id","beacon--switch__container"]],[KM("button",["beacon-modal__button--outline"],[["id","beacon-switch"]],"")]),KM("div",[],[["id","beacon--disclaimer"]],"")]))(t,[l],s,[e]):((t,e,n,r)=>sT(t,e,n,[KM("div",["beacon-alert__text"],[["id","beacon-main-text"]],r)]))(t,[l],s,[e]);return{style:a,html:c}})(u,m,o,f,!!(null==a?void 0:a.p2pSyncCode));p.appendChild(y);const v=cT.createElement("style");v.textContent=g,d.appendChild(v),s&&(uT[u]=window.setTimeout((()=>aT(void 0,void 0,void 0,(function*(){yield hT(u)}))),s)),cT.body.prepend(h);const _=d.getElementById(`beacon-alert-${u}-close`),w=()=>aT(void 0,void 0,void 0,(function*(){c&&c(),yield hT(u)}));if(l){const t=d.getElementById("beacon--disclaimer");t&&(t.innerText=l)}const b=oT(),x=d.getElementById(`beacon-alert-modal-${u}`);x&&(x.classList.add(`theme__${b}`),x.addEventListener("click",w));const E=d.querySelectorAll(".beacon-modal__wrapper");return E.length>0&&E[0].addEventListener("click",(t=>{t.stopPropagation()})),lT=cT.activeElement,p.focus(),f.forEach(((t,e)=>{const n=d.getElementById(`beacon-alert-${u}-${e}`);n&&n.addEventListener("click",(()=>aT(void 0,void 0,void 0,(function*(){yield hT(u),t.actionCallback&&(yield t.actionCallback())}))))})),_&&_.addEventListener("click",(()=>aT(void 0,void 0,void 0,(function*(){yield w()})))),window.addEventListener("keydown",(t=>aT(void 0,void 0,void 0,(function*(){"Escape"===t.key&&(yield w())})))),a&&(yield nT(u,d,a)),u})),fT=":host {\n  --animation-duration: 300ms;\n  all: initial;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes fadeOut {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n\n.animated {\n  animation-duration: var(--animation-duration);\n  animation-fill-mode: both;\n}\n\n.fadeIn {\n  animation-name: fadeIn;\n}\n\n.fadeOut {\n  animation-name: fadeOut;\n}\n\n.beacon-toast__base {\n  position: fixed;\n  top: 16px;\n  right: 16px;\n  z-index: 2147483000;\n  margin: 0 auto;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.1);\n  flex-direction: column;\n}\n@media (max-width: 576px) {\n  .beacon-toast__base {\n    top: 8px;\n    right: 8px;\n    left: 8px;\n  }\n  .beacon-toast__wallet__outer {\n    flex-wrap: wrap;\n  }\n  .beacon-toast__wallet__link {\n    display: flex;\n    margin-left: 12px !important;\n  }\n}\n\n.theme__light.beacon-toast__base {\n  background: #fff;\n}\n\n.theme__dark.beacon-toast__base {\n  background: #27334c;\n}\n\n.theme__dark p {\n  color: #6183ff;\n}\n\na {\n  text-decoration: none;\n  color: #3880ff;\n}\n\na svg {\n  width: 12px;\n  margin-left: 2px;\n}\n\na:visited {\n  color: #3880ff;\n}\n\nhr {\n  height: 1px;\n  color: rgba(0, 0, 0, 0.12);\n  background-color: rgba(0, 0, 0, 0.12);\n  border: none;\n  width: 100%;\n  margin: 0;\n  display: none;\n}\n\n.show {\n  display: block !important;\n}\n\n.hide {\n  display: none !important;\n}\n\n#beacon-toast-list {\n  display: none;\n}\n\n.beacon-toast__upside_down {\n  transform: rotate(180deg);\n}\n\n.beacon-toast__content {\n  justify-content: space-between;\n  min-height: 56px;\n  height: 0;\n}\n\n.beacon-toast__action__item,\n.beacon-toast__powered a,\n.beacon-toast__wallet__container,\n#beacon-text,\n.beacon-toast__action__item p,\n.beacon-toast__wallet__outer {\n  align-items: center;\n}\n\n.beacon-toast__content,\n.beacon-toast__base,\n.beacon-toast__action__item,\n.beacon-toast__powered a,\n#beacon-text,\n.beacon-toast__wallet__container,\n.beacon-toast__wallet__outer {\n  display: flex;\n}\n\n.beacon-toast__content,\n.beacon-toast__action__item,\n.beacon-toast__powered a {\n  padding: 0 16px;\n  font-family: Roboto, Helvetica, sans-serif;\n}\n\n#beacon-text strong {\n  display: contents;\n}\n.beacon-toast__wallet__link {\n  margin-left: 8px;\n}\n.beacon-toast__wallet__link svg {\n  margin-left: 4px;\n}\n.beacon-toast__powered a {\n  margin: 4px 0 12px;\n  font-size: 12px;\n  opacity: 0.64;\n}\n\n.beacon-toast__powered svg {\n  width: 20px;\n  height: 20px;\n  margin: 0 2px 0 4px;\n}\n\n.beacon-toast__action__item {\n  font-size: 14px;\n  max-width: 40ch;\n}\n\n.beacon-toast__action__item p {\n  margin-right: 8px;\n}\n\n.beacon-toast__action__item__subtitle,\n.beacon-toast__powered a {\n  min-width: 88px;\n  color: rgba(0, 0, 0, 0.54);\n}\n\n.theme__dark .beacon-toast__powered a {\n  color: #7c99d6;\n}\n\n.beacon-toast__content__img {\n  width: 24px;\n  height: 24px;\n  margin-right: 4px;\n  image-rendering: -moz-crisp-edges; /* Firefox */\n  image-rendering: -o-crisp-edges; /* Opera */\n  image-rendering: -webkit-optimize-contrast; /* Webkit (non-standard naming) */\n  image-rendering: crisp-edges;\n  -ms-interpolation-mode: nearest-neighbor; /* IE (non-standard property) */\n}\n\n.beacon-toast__more {\n  width: 14px;\n  transition: transform 0.5s;\n}\n\na,\n.beacon-toast__more {\n  cursor: pointer;\n}\n\na:hover {\n  opacity: 0.64;\n}\n\n.theme__dark .beacon-toast__more {\n  color: #7c99d6;\n}\n\n.beacon-toast__more--action {\n  margin: 8px 0;\n}\n\n#beacon-text {\n  padding-right: 24px;\n}\n\n#beacon-text-content {\n  display: flex;\n  align-items: center;\n}\n\n.progress-line,\n.progress-line:before {\n  height: 3px;\n  width: 100%;\n  margin: 0;\n}\n.progress-line {\n  background-color: #a7c4f7;\n  display: -webkit-flex;\n  display: flex;\n}\n.progress-line:before {\n  background-color: #3880ff;\n  content: '';\n  -webkit-animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n  animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n}\n@-webkit-keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n@keyframes running-progress {\n  0% {\n    margin-left: 0px;\n    margin-right: 100%;\n  }\n  50% {\n    margin-left: 25%;\n    margin-right: 0%;\n  }\n  100% {\n    margin-left: 100%;\n    margin-right: 0;\n  }\n}\n";var mT=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};let gT,yT,vT,_T;"undefined"!=typeof window&&void 0!==window.document&&(gT=window.document);const wT=t=>{for(;t.firstChild;)t.removeChild(t.firstChild)},bT=t=>{var e,n;const r=null===(e=null==_T?void 0:_T.walletInfo)||void 0===e?void 0:e.icon,i=null===(n=null==_T?void 0:_T.walletInfo)||void 0===n?void 0:n.name;let o;const s=KM("strong",[],[],null!=i?i:"Wallet");o=r?KM("span",["beacon-toast__wallet__container"],[],[KM("img",["beacon-toast__content__img"],[["src",r]],""),s]):s;const a=t.split("{{wallet}}");if(1===a.length)return[KM("span",[],[],t)];{const t=[];for(let e=0;e<a.length;e++)t.push(KM("span",[],[],a[e])),e<a.length-1&&t.push(o);return t}},xT=()=>new Promise((t=>{var e;_T=void 0;const n=gT.getElementById("beacon-toast-wrapper");if(!n)return t();const r=null===(e=n.shadowRoot)||void 0===e?void 0:e.getElementById("beacon-toast");if(r){const e=300;yT&&(clearTimeout(yT),yT=void 0),r.className=r.className.replace("fadeIn","fadeOut"),window.setTimeout((()=>{const e=n.parentNode;e&&e.removeChild(n),t()}),e)}else t()})),ET=(t,e,n)=>{const r=t.getElementById(e);return r&&r.addEventListener("click",(()=>mT(void 0,void 0,void 0,(function*(){yield n(r)})))),r},ST=(t,e)=>{const n=t.getElementById(e);n&&(n.classList.remove("hide"),n.classList.add("show"))},MT=(t,e)=>{const n=t.getElementById(e);n&&(n.classList.add("hide"),n.classList.remove("show"))},TT=t=>{ST(t,"beacon-toast-button-close"),MT(t,"beacon-toast-button-expand")},AT=t=>{const e=t.getElementById("beacon-toast-button-expand"),n=t.getElementById("beacon-toast-list");e&&n&&(e.classList.remove("beacon-toast__upside_down"),n.classList.add("hide"),n.classList.remove("show"))},RT=t=>{const e=t.getElementById("beacon-toast-button-expand"),n=t.getElementById("beacon-toast-list");e&&n&&(e.classList.add("beacon-toast__upside_down"),n.classList.remove("hide"),n.classList.add("show"))},LT=t=>{const e=t.getElementById("beacon-toast-button-expand"),n=t.getElementById("beacon-toast-list");e&&n&&(e.classList.contains("beacon-toast__upside_down")?AT(t):RT(t))},CT=(t,e,n)=>mT(void 0,void 0,void 0,(function*(){const r=e.actions;if(r&&r.length>0){const e=r.map((t=>mT(void 0,void 0,void 0,(function*(){return e=t,mT(void 0,void 0,void 0,(function*(){const{text:t,isBold:n,actionText:r,actionLogo:i,actionCallback:o}=e,s=yield FE(),a=gT.createElement("div");a.classList.add("beacon-toast__action__item"),wT(a);const l=t=>KM("strong",[],[],t);if(o){t.length>0&&a.appendChild(KM("p",[],[],t));const e=KM("span",[],[],[KM("span",[],[],r),i&&"external"===i?XM(["svg-inline--fa","fa-external-link-alt","fa-w-16"],[["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","external-link-alt"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 512 512"]],[YM([["fill","currentColor"],["d","M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"]])]):void 0]);a.appendChild(KM("p",[],[],[KM("a",[],[["id",s]],[n?l([e]):e])]))}else if(r){t.length>0&&a.appendChild(KM("p",["beacon-toast__action__item__subtitle"],[],t));const e=KM("span",[],[],r);a.appendChild(KM("p",[],[],[n?l([e]):e]))}else{const e=KM("p",[],[],t);a.appendChild(n?l([e]):e)}return o&&a.addEventListener("click",o),a}));var e}))));(yield Promise.all(e)).forEach((t=>n.appendChild(t)));const i=gT.createElement("small");i.classList.add("beacon-toast__powered"),i.appendChild(KM("a",[],[["href","https://walletbeacon.io"],["target","_blank"]],[document.createTextNode("powered by"),XM([],[["id","f63e95a9-fd19-4487-bc1a-09eb2f066704"],["data-name","Guides"],["xmlns","http://www.w3.org/2000/svg"],["width","65"],["height","65"],["viewBox","0 0 65 65"]],[KM("title",[],[],"beacon_logo"),YM([["fill","currentColor"],["d","M59.66,29.52v1.06c0,.37-.18,9.07-4.11,15.88S44.16,57.75,43.84,57.93l-.91.54-1.61-.93-9.19-5.3a14.68,14.68,0,0,1-1.63-1.06h0a14.09,14.09,0,0,1-1.29-1,17.63,17.63,0,0,1-2.56-2.7,18.58,18.58,0,0,1-2.56-4.51,21.53,21.53,0,0,1-1.5-9,6.21,6.21,0,0,1,2.93-.73c.25,0,.49,0,.74,0a18.29,18.29,0,0,0,1,7.93,15.06,15.06,0,0,0,6.67,8l8.93,5.16c.2-.13.43-.3.68-.48,2.26-1.6,6.42-4.92,8.86-9.13C55.12,39.94,55.8,34,56,31.57l-3.79-2.19a23,23,0,0,0,.6-3.83Z"]]),YM([["fill","currentColor"],["d","M49.22,11.43V23.89c0,.65,0,1.3-.1,1.94v0c-.06.55-.13,1.1-.24,1.63A18,18,0,0,1,47.82,31a19.11,19.11,0,0,1-2.62,4.49,21.37,21.37,0,0,1-7.07,5.8,6.08,6.08,0,0,1-2.42-2.84A18.1,18.1,0,0,0,42,33.7h0a15.12,15.12,0,0,0,3.58-9.81V13.6c-.21-.11-.47-.21-.74-.35-2.52-1.16-7.47-3.1-12.36-3.1-5.42,0-11,2.4-13.08,3.45V18a22.54,22.54,0,0,0-3.63,1.38V11.43l.92-.52c.33-.18,8-4.38,15.79-4.38s15.48,4.2,15.8,4.38Z"]]),YM([["fill","currentColor"],["d","M18,26.4,9,31.55q0,.35.06.78a31.63,31.63,0,0,0,3.49,12.28c2.71,4.71,7.55,8.3,9.53,9.64l3.79-2.19a23.33,23.33,0,0,0,3,2.44l-6.88,4-.92-.54c-.31-.18-7.75-4.69-11.68-11.5S5.36,30.92,5.35,30.56V29.49L7,28.55l9.17-5.29c.57-.32,1.14-.61,1.72-.87a13.46,13.46,0,0,1,1.55-.61A17.52,17.52,0,0,1,23,20.91a19.2,19.2,0,0,1,5.19,0,21.49,21.49,0,0,1,8.55,3.24,6.29,6.29,0,0,1-1.25,3.51,17.9,17.9,0,0,0-7.3-3.06A15.14,15.14,0,0,0,18,26.4Z"]])]),document.createTextNode("Beacon")])),n.appendChild(i),(t=>{ST(t,"beacon-toast-button-expand"),MT(t,"beacon-toast-button-close")})(t)}else TT(t),AT(t)})),PT=t=>mT(void 0,void 0,void 0,(function*(){_T=t;const e=t.timer,n=gT.createElement("div");n.setAttribute("id","beacon-toast-wrapper");const r=n.attachShadow({mode:"open"}),i=gT.createElement("div"),{style:o,html:s}=(t=>{const e=t.body,n=bT(e),r=(t=>KM("div",["beacon-toast__base","animated","fadeIn"],[["id","beacon-toast"]],[KM("div",["beacon-toast__content"],[],[KM("span",[],[["id","beacon-text"]],[KM("p",[],[["id","beacon-text-content"]],t),KM("a",["beacon-toast__wallet__link"],[["id","beacon-open-wallet"]],[KM("span",[],[],"Open"),XM(["svg-inline--fa","fa-external-link-alt","fa-w-16"],[["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","external-link-alt"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 512 512"]],[YM([["fill","currentColor"],["d","M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"]])])])]),XM(["beacon-toast__more","svg-inline--fa","fa-angle-down","fa-w-10"],[["id","beacon-toast-button-expand"],["aria-hidden","true"],["focusable","false"],["data-prefix","fas"],["data-icon","angle-down"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 320 512"]],[YM([["fill","currentColor"],["d","M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"]])]),XM(["beacon-toast__more","svg-inline--fa","fa-times","fa-w-10"],[["id","beacon-toast-button-close"],["aria-hidden","true"],["focusable","false"],["data-prefix","fal"],["data-icon","times"],["role","img"],["xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 320 512"]],[YM([["fill","currentColor"],["d","M193.94 256L296.5 153.44l21.15-21.15c3.12-3.12 3.12-8.19 0-11.31l-22.63-22.63c-3.12-3.12-8.19-3.12-11.31 0L160 222.06 36.29 98.34c-3.12-3.12-8.19-3.12-11.31 0L2.34 120.97c-3.12 3.12-3.12 8.19 0 11.31L126.06 256 2.34 379.71c-3.12 3.12-3.12 8.19 0 11.31l22.63 22.63c3.12 3.12 8.19 3.12 11.31 0L160 289.94 262.56 392.5l21.15 21.15c3.12 3.12 8.19 3.12 11.31 0l22.63-22.63c3.12-3.12 3.12-8.19 0-11.31L193.94 256z"]])])]),KM("div",["progress-line"],[["id","beacon-toast-loader"]],""),KM("hr",["hide"],[["id","beacon-toast-loader-placeholder"]],""),KM("div",["beacon-toast__more--action"],[["id","beacon-toast-list"]],"")]))([KM("span",["beacon-toast__wallet__outer"],[],n)]);return{style:fT,html:r}})(t);i.appendChild(s);const a=gT.createElement("style");a.textContent=o,r.appendChild(i),r.appendChild(a),e&&(yT=window.setTimeout((()=>mT(void 0,void 0,void 0,(function*(){yield xT()}))),e)),gT.body.prepend(n);const l=oT(),c=r.getElementById("beacon-toast");c&&c.classList.add(`theme__${l}`);const u=r.getElementById("beacon-toast-list");u&&(yield CT(r,t,u));const h=r.getElementById("beacon-open-wallet");h&&(t.openWalletAction?h.addEventListener("click",(()=>{t.openWalletAction&&t.openWalletAction()})):h.classList.add("hide")),"loading"===_T.state&&(vT=window.setTimeout((()=>mT(void 0,void 0,void 0,(function*(){const t=r.getElementById("beacon-toast-button-expand");t&&!t.classList.contains("beacon-toast__upside_down")&&LT(r)}))),5e3)),ET(r,"beacon-toast-button-done",(()=>mT(void 0,void 0,void 0,(function*(){yield xT()}))));const d=ET(r,"beacon-toast-button-close",(()=>mT(void 0,void 0,void 0,(function*(){yield xT()}))));d&&"loading"===_T.state&&d.classList.add("hide"),ET(r,"beacon-toast-button-expand",(()=>mT(void 0,void 0,void 0,(function*(){LT(r)}))))})),IT=t=>mT(void 0,void 0,void 0,(function*(){var e;if(vT&&clearTimeout(vT),gT.getElementById("beacon-toast-wrapper")?t.forceNew?(yield xT(),yield PT(t)):yield(t=>mT(void 0,void 0,void 0,(function*(){_T=Object.assign(Object.assign({},_T),t);const e=t.timer,n=gT.getElementById("beacon-toast-wrapper");if(!n)return;const r=n.shadowRoot;if(!r)return;const i=r.getElementById("beacon-toast-list");i&&(wT(i),yield CT(r,t,i)),"loading"===_T.state&&(vT=window.setTimeout((()=>mT(void 0,void 0,void 0,(function*(){const t=r.getElementById("beacon-toast-button-expand");t&&!t.classList.contains("beacon-toast__upside_down")&&LT(r)}))),5e3));const o=r.getElementById("beacon-text-content");o&&(wT(o),o.appendChild(KM("span",["beacon-toast__wallet__outer"],[],bT(t.body))));const s=r.getElementById("beacon-open-wallet");s&&(t.openWalletAction?(s.classList.remove("hide"),s.addEventListener("click",(()=>{t.openWalletAction&&t.openWalletAction()}))):s.classList.add("hide")),e&&(yT=window.setTimeout((()=>mT(void 0,void 0,void 0,(function*(){yield xT()}))),e));const a=r.getElementById("beacon-toast-button-done");a&&a.addEventListener("click",(()=>mT(void 0,void 0,void 0,(function*(){yield xT()}))))})))(t):yield PT(t),_T&&"finished"===_T.state){const t=null===(e=gT.getElementById("beacon-toast-wrapper"))||void 0===e?void 0:e.shadowRoot;t&&((t=>{MT(t,"beacon-toast-loader"),ST(t,"beacon-toast-loader-placeholder")})(t),TT(t),RT(t))}})),OT=t=>t.length>=12?`${t.substr(0,5)}...${t.substr(-5)}`:t;var NT=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const kT=new nS("BeaconEvents"),DT=5e3;var BT;!function(t){t.PERMISSION_REQUEST_SENT="PERMISSION_REQUEST_SENT",t.PERMISSION_REQUEST_SUCCESS="PERMISSION_REQUEST_SUCCESS",t.PERMISSION_REQUEST_ERROR="PERMISSION_REQUEST_ERROR",t.OPERATION_REQUEST_SENT="OPERATION_REQUEST_SENT",t.OPERATION_REQUEST_SUCCESS="OPERATION_REQUEST_SUCCESS",t.OPERATION_REQUEST_ERROR="OPERATION_REQUEST_ERROR",t.SIGN_REQUEST_SENT="SIGN_REQUEST_SENT",t.SIGN_REQUEST_SUCCESS="SIGN_REQUEST_SUCCESS",t.SIGN_REQUEST_ERROR="SIGN_REQUEST_ERROR",t.BROADCAST_REQUEST_SENT="BROADCAST_REQUEST_SENT",t.BROADCAST_REQUEST_SUCCESS="BROADCAST_REQUEST_SUCCESS",t.BROADCAST_REQUEST_ERROR="BROADCAST_REQUEST_ERROR",t.ACKNOWLEDGE_RECEIVED="ACKNOWLEDGE_RECEIVED",t.LOCAL_RATE_LIMIT_REACHED="LOCAL_RATE_LIMIT_REACHED",t.NO_PERMISSIONS="NO_PERMISSIONS",t.ACTIVE_ACCOUNT_SET="ACTIVE_ACCOUNT_SET",t.ACTIVE_TRANSPORT_SET="ACTIVE_TRANSPORT_SET",t.SHOW_PREPARE="SHOW_PREPARE",t.HIDE_UI="HIDE_UI",t.PAIR_INIT="PAIR_INIT",t.PAIR_SUCCESS="PAIR_SUCCESS",t.CHANNEL_CLOSED="CHANNEL_CLOSED",t.INTERNAL_ERROR="INTERNAL_ERROR",t.UNKNOWN="UNKNOWN"}(BT||(BT={}));const UT=t=>NT(void 0,void 0,void 0,(function*(){let e;const n=[];if(t.walletInfo.deeplink&&("web"===t.walletInfo.type||"mobile"===t.walletInfo.type&&AM(window)||"desktop"===t.walletInfo.type&&!AM(window))){const n=t.walletInfo.deeplink;e=()=>NT(void 0,void 0,void 0,(function*(){const t=document.createElement("a");t.setAttribute("href",n),t.setAttribute("target","_blank"),t.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))}))}n.push({text:"No answer from your wallet received yet. Please make sure the wallet is open.",isBold:!0}),n.push({text:"Did you make a mistake?",actionText:"Cancel Request",actionCallback:()=>NT(void 0,void 0,void 0,(function*(){yield xT()}))}),n.push({text:"Wallet not receiving request?",actionText:"Reset Connection",actionCallback:()=>NT(void 0,void 0,void 0,(function*(){yield xT();const e=t.extraInfo.resetCallback;e&&(kT.log("showSentToast","resetCallback invoked"),yield e())}))}),IT({body:"Request sent to  {{wallet}}",walletInfo:t.walletInfo,state:"loading",actions:n,openWalletAction:e}).catch((t=>console.error(t)))})),zT=(t,e)=>NT(void 0,void 0,void 0,(function*(){const n=t.errorResponse.errorType?sS.getError(t.errorResponse.errorType,t.errorResponse.errorData):new mS,r=[{text:n.title,isBold:!0},{text:n.description}];t.errorResponse.errorType===PE.TRANSACTION_INVALID_ERROR&&t.errorResponse.errorData&&r.push({text:"",actionText:"Show Details",actionCallback:()=>NT(void 0,void 0,void 0,(function*(){yield xT(),yield pT({title:n.title,body:n.fullDescription.description,data:n.fullDescription.data,buttons:e})}))}),yield IT({body:"{{wallet}}  has returned an error",timer:t.errorResponse.errorType===PE.ABORTED_ERROR?DT:void 0,state:"finished",walletInfo:t.walletInfo,actions:r})})),FT=()=>()=>NT(void 0,void 0,void 0,(function*(){})),HT={[BT.PERMISSION_REQUEST_SENT]:UT,[BT.PERMISSION_REQUEST_SUCCESS]:t=>NT(void 0,void 0,void 0,(function*(){const{output:e}=t;yield IT({body:"{{wallet}}  has granted permission",timer:DT,walletInfo:t.walletInfo,state:"finished",actions:[{text:"Address",actionText:OT(e.address),isBold:!0},{text:"Network",actionText:`${e.network.type}`},{text:"Permissions",actionText:e.scopes.join(", ")}]})})),[BT.PERMISSION_REQUEST_ERROR]:zT,[BT.OPERATION_REQUEST_SENT]:UT,[BT.OPERATION_REQUEST_SUCCESS]:t=>NT(void 0,void 0,void 0,(function*(){const{account:e,output:n,blockExplorer:r}=t;yield IT({body:"{{wallet}}  successfully submitted operation",timer:DT,state:"finished",walletInfo:t.walletInfo,actions:[{text:OT(n.transactionHash),isBold:!0,actionText:"Open Blockexplorer",actionLogo:"external",actionCallback:()=>NT(void 0,void 0,void 0,(function*(){const t=yield r.getTransactionLink(n.transactionHash,e.network);window.open(t,"_blank"),yield xT()}))}]})})),[BT.OPERATION_REQUEST_ERROR]:zT,[BT.SIGN_REQUEST_SENT]:UT,[BT.SIGN_REQUEST_SUCCESS]:t=>NT(void 0,void 0,void 0,(function*(){const e=t.output;yield IT({body:"{{wallet}}  successfully signed payload",timer:DT,state:"finished",walletInfo:t.walletInfo,actions:[{text:`Signature: ${OT(e.signature)}`,actionText:"Copy to clipboard",actionCallback:()=>NT(void 0,void 0,void 0,(function*(){navigator.clipboard.writeText(e.signature).then((()=>{kT.log("showSignSuccessAlert","Copying to clipboard was successful!")}),(t=>{kT.error("showSignSuccessAlert","Could not copy text to clipboard: ",t)})),yield xT()}))}]})})),[BT.SIGN_REQUEST_ERROR]:zT,[BT.BROADCAST_REQUEST_SENT]:UT,[BT.BROADCAST_REQUEST_SUCCESS]:t=>NT(void 0,void 0,void 0,(function*(){const{network:e,output:n,blockExplorer:r}=t;yield IT({body:"{{wallet}}  successfully injected operation",timer:DT,state:"finished",walletInfo:t.walletInfo,actions:[{text:OT(n.transactionHash),isBold:!0,actionText:"Open Blockexplorer",actionLogo:"external",actionCallback:()=>NT(void 0,void 0,void 0,(function*(){const t=yield r.getTransactionLink(n.transactionHash,e);window.open(t,"_blank"),yield xT()}))}]})})),[BT.BROADCAST_REQUEST_ERROR]:zT,[BT.ACKNOWLEDGE_RECEIVED]:t=>NT(void 0,void 0,void 0,(function*(){IT({body:"Awaiting confirmation in  {{wallet}}",state:"acknowledge",walletInfo:t.walletInfo}).catch((t=>console.error(t)))})),[BT.LOCAL_RATE_LIMIT_REACHED]:()=>NT(void 0,void 0,void 0,(function*(){pT({title:"Error",body:"Rate limit reached. Please slow down",buttons:[{text:"Done",style:"outline"}],timer:3e3}).catch((t=>console.error(t)))})),[BT.NO_PERMISSIONS]:()=>NT(void 0,void 0,void 0,(function*(){yield pT({title:"No Permission",body:"Please allow the wallet to handle this type of request."})})),[BT.ACTIVE_ACCOUNT_SET]:FT(),[BT.ACTIVE_TRANSPORT_SET]:FT(),[BT.SHOW_PREPARE]:t=>NT(void 0,void 0,void 0,(function*(){const e=t.walletInfo?"Preparing Request for  {{wallet}}...":"Preparing Request...";IT({body:e,state:"prepare",walletInfo:t.walletInfo}).catch((t=>console.error(t)))})),[BT.HIDE_UI]:t=>NT(void 0,void 0,void 0,(function*(){t?(t.includes("alert")&&dT(),t.includes("toast")&&xT()):xT()})),[BT.PAIR_INIT]:t=>NT(void 0,void 0,void 0,(function*(){const e={title:"Choose your preferred wallet",body:"<p></p>",pairingPayload:{p2pSyncCode:t.p2pPeerInfo,postmessageSyncCode:t.postmessagePeerInfo,preferredNetwork:t.preferredNetwork},closeButtonCallback:t.abortedHandler,disclaimerText:t.disclaimerText};yield pT(e)})),[BT.PAIR_SUCCESS]:()=>NT(void 0,void 0,void 0,(function*(){yield dT()})),[BT.CHANNEL_CLOSED]:()=>NT(void 0,void 0,void 0,(function*(){yield pT({title:"Channel closed",body:"Your peer has closed the connection.",buttons:[{text:"Done",style:"outline"}],timer:1500})})),[BT.INTERNAL_ERROR]:t=>NT(void 0,void 0,void 0,(function*(){var e;const n=[...null!==(e=t.buttons)&&void 0!==e?e:[]];n.push({text:"Done",style:"outline"});const r={title:"Internal Error",body:t.text,buttons:n};yield pT(r)})),[BT.UNKNOWN]:FT()};class GT{constructor(t={},e){this.callbackMap={[BT.PERMISSION_REQUEST_SENT]:[HT.PERMISSION_REQUEST_SENT],[BT.PERMISSION_REQUEST_SUCCESS]:[HT.PERMISSION_REQUEST_SUCCESS],[BT.PERMISSION_REQUEST_ERROR]:[HT.PERMISSION_REQUEST_ERROR],[BT.OPERATION_REQUEST_SENT]:[HT.OPERATION_REQUEST_SENT],[BT.OPERATION_REQUEST_SUCCESS]:[HT.OPERATION_REQUEST_SUCCESS],[BT.OPERATION_REQUEST_ERROR]:[HT.OPERATION_REQUEST_ERROR],[BT.SIGN_REQUEST_SENT]:[HT.SIGN_REQUEST_SENT],[BT.SIGN_REQUEST_SUCCESS]:[HT.SIGN_REQUEST_SUCCESS],[BT.SIGN_REQUEST_ERROR]:[HT.SIGN_REQUEST_ERROR],[BT.BROADCAST_REQUEST_SENT]:[HT.BROADCAST_REQUEST_SENT],[BT.BROADCAST_REQUEST_SUCCESS]:[HT.BROADCAST_REQUEST_SUCCESS],[BT.BROADCAST_REQUEST_ERROR]:[HT.BROADCAST_REQUEST_ERROR],[BT.ACKNOWLEDGE_RECEIVED]:[HT.ACKNOWLEDGE_RECEIVED],[BT.LOCAL_RATE_LIMIT_REACHED]:[HT.LOCAL_RATE_LIMIT_REACHED],[BT.NO_PERMISSIONS]:[HT.NO_PERMISSIONS],[BT.ACTIVE_ACCOUNT_SET]:[HT.ACTIVE_ACCOUNT_SET],[BT.ACTIVE_TRANSPORT_SET]:[HT.ACTIVE_TRANSPORT_SET],[BT.SHOW_PREPARE]:[HT.SHOW_PREPARE],[BT.HIDE_UI]:[HT.HIDE_UI],[BT.PAIR_INIT]:[HT.PAIR_INIT],[BT.PAIR_SUCCESS]:[HT.PAIR_SUCCESS],[BT.CHANNEL_CLOSED]:[HT.CHANNEL_CLOSED],[BT.INTERNAL_ERROR]:[HT.INTERNAL_ERROR],[BT.UNKNOWN]:[HT.UNKNOWN]},e&&this.setAllHandlers(),this.overrideDefaults(t)}on(t,e){return NT(this,void 0,void 0,(function*(){const n=this.callbackMap[t]||[];n.push(e),this.callbackMap[t]=n}))}emit(t,e,n){return NT(this,void 0,void 0,(function*(){const r=this.callbackMap[t];r&&r.length>0&&r.forEach((r=>NT(this,void 0,void 0,(function*(){try{yield r(e,n)}catch(e){kT.error(`error handling event ${t}`,e)}}))))}))}overrideDefaults(t){Object.keys(t).forEach((e=>{const n=e,r=t[n];r&&(this.callbackMap[n]=[r.handler])}))}setAllHandlers(t){Object.keys(this.callbackMap).forEach((e=>{const n=e;this.callbackMap[n]=[],t?this.callbackMap[n].push(t):this.callbackMap[n].push(((...t)=>{kT.log(e,...t)}))}))}}const VT={[ME.BlockchainRequest]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.BlockchainResponse]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.PermissionRequest]:{sent:BT.PERMISSION_REQUEST_SENT,success:BT.PERMISSION_REQUEST_SUCCESS,error:BT.PERMISSION_REQUEST_ERROR},[ME.PermissionResponse]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.OperationRequest]:{sent:BT.OPERATION_REQUEST_SENT,success:BT.OPERATION_REQUEST_SUCCESS,error:BT.OPERATION_REQUEST_ERROR},[ME.OperationResponse]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.SignPayloadRequest]:{sent:BT.SIGN_REQUEST_SENT,success:BT.SIGN_REQUEST_SUCCESS,error:BT.SIGN_REQUEST_ERROR},[ME.SignPayloadResponse]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.BroadcastRequest]:{sent:BT.BROADCAST_REQUEST_SENT,success:BT.BROADCAST_REQUEST_SUCCESS,error:BT.BROADCAST_REQUEST_ERROR},[ME.BroadcastResponse]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.Acknowledge]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.Disconnect]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN},[ME.Error]:{sent:BT.UNKNOWN,success:BT.UNKNOWN,error:BT.UNKNOWN}};var jT=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};class WT extends class{constructor(t){this.rpcUrls=t}getLinkForNetwork(t){return e=this,n=void 0,i=function*(){return this.rpcUrls[t.type]},new((r=void 0)||(r=Promise))((function(t,o){function s(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(s,a)}l((i=i.apply(e,n||[])).next())}));var e,n,r,i}}{constructor(t={[AE.MAINNET]:"https://tzkt.io",[AE.GHOSTNET]:"https://ghostnet.tzkt.io",[AE.MONDAYNET]:"https://mondaynet.tzkt.io",[AE.DAILYNET]:"https://dailynet.tzkt.io",[AE.DELPHINET]:"https://delphinet.tzkt.io",[AE.EDONET]:"https://edonet.tzkt.io",[AE.FLORENCENET]:"https://florencenet.tzkt.io",[AE.GRANADANET]:"https://granadanet.tzkt.io",[AE.HANGZHOUNET]:"https://hangzhounet.tzkt.io",[AE.ITHACANET]:"https://ithacanet.tzkt.io",[AE.JAKARTANET]:"https://jakartanet.tzkt.io",[AE.KATHMANDUNET]:"https://kathmandunet.tzkt.io",[AE.CUSTOM]:"https://kathmandunet.tzkt.io"}){super(t),this.rpcUrls=t}getAddressLink(t,e){return jT(this,void 0,void 0,(function*(){return`${yield this.getLinkForNetwork(e)}/${t}`}))}getTransactionLink(t,e){return jT(this,void 0,void 0,(function*(){return`${yield this.getLinkForNetwork(e)}/${t}`}))}}var qT=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const KT=new nS("DappPostMessageTransport");class XT extends EM{constructor(t,e,n){super(t,e,n,NE.TRANSPORT_POSTMESSAGE_PEERS_DAPP)}startOpenChannelListener(){return qT(this,void 0,void 0,(function*(){return this.client.listenForChannelOpening((t=>qT(this,void 0,void 0,(function*(){KT.log("connect","received PostMessagePairingResponse",t),yield this.addPeer(t),this._isConnected=IE.CONNECTED,this.newPeerListener&&(this.newPeerListener(t),this.newPeerListener=void 0)}))))}))}listenForNewPeer(t){return qT(this,void 0,void 0,(function*(){KT.log("listenForNewPeer"),this.newPeerListener=t}))}stopListeningForNewPeers(){return qT(this,void 0,void 0,(function*(){KT.log("stopListeningForNewPeers"),this.newPeerListener=void 0}))}}var YT=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const JT=new nS("DappP2PTransport");class ZT extends fM{constructor(t,e,n,r,i,o){super(t,e,n,r,NE.TRANSPORT_P2P_PEERS_DAPP,i,o)}startOpenChannelListener(){return YT(this,void 0,void 0,(function*(){return this.client.listenForChannelOpening((t=>YT(this,void 0,void 0,(function*(){JT.log("listenForNewPeer","new publicKey",t.publicKey),yield this.addPeer(t),this._isConnected=IE.CONNECTED,this.newPeerListener&&(this.newPeerListener(t),this.newPeerListener=void 0)}))))}))}listenForNewPeer(t){return YT(this,void 0,void 0,(function*(){JT.log("listenForNewPeer"),this.newPeerListener=t}))}stopListeningForNewPeers(){return YT(this,void 0,void 0,(function*(){JT.log("stopListeningForNewPeers"),this.newPeerListener=void 0}))}}var QT=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const $T=new nS("DAppClient");class tA extends class extends class{constructor(t){if(this._beaconId=new lE,this._keyPair=new lE,!t.name)throw new Error("Name not set");if(!t.storage)throw new Error("Storage not set");this.name=t.name,this.iconUrl=t.iconUrl,this.appUrl=t.appUrl,this.storage=t.storage,WE.beaconCreatedClientInstance?console.error("[BEACON] It looks like you created multiple Beacon SDK Client instances. This can lead to problems. Only create one instance and re-use it everywhere."):WE.beaconCreatedClientInstance=!0,this.initSDK().catch(console.error)}get beaconId(){return this._beaconId.promise}get keyPair(){return this._keyPair.promise}destroy(){return qE(this,void 0,void 0,(function*(){yield this.removeBeaconEntriesFromStorage(),WE.beaconCreatedClientInstance=!1}))}initSDK(){return qE(this,void 0,void 0,(function*(){return this.storage.set(NE.BEACON_SDK_VERSION,"3.2.0").catch(console.error),this.loadOrCreateBeaconSecret().catch(console.error),this.keyPair.then((t=>{this._beaconId.resolve(vE(t.publicKey))}))}))}removeBeaconEntriesFromStorage(){return qE(this,void 0,void 0,(function*(){const t=Object.values(NE);yield Promise.all(t.map((t=>this.storage.delete(t))))}))}loadOrCreateBeaconSecret(){return qE(this,void 0,void 0,(function*(){const t=yield this.storage.get(NE.BEACON_SDK_SECRET_SEED);if(t&&"string"==typeof t)this._keyPair.resolve(yield wE(t));else{const t=yield FE();yield this.storage.set(NE.BEACON_SDK_SECRET_SEED,t),this._keyPair.resolve(yield wE(t))}}))}}{constructor(t){var e;super(t),this.rateLimit=2,this.rateLimitWindowInSeconds=5,this.requestCounter=[],this._transport=new lE,this.accountManager=new QE(t.storage),this.matrixNodes=null!==(e=t.matrixNodes)&&void 0!==e?e:[],this.handleResponse=(t,e)=>{throw new Error(`not overwritten${JSON.stringify(t)} - ${JSON.stringify(e)}`)}}get transport(){return this._transport.promise}get connectionStatus(){var t,e;return null!==(e=null===(t=this._transport.promiseResult)||void 0===t?void 0:t.connectionStatus)&&void 0!==e?e:IE.NOT_CONNECTED}get ready(){return this.transport.then((()=>{}))}getAccounts(){return iS(this,void 0,void 0,(function*(){return this.accountManager.getAccounts()}))}getAccount(t){return iS(this,void 0,void 0,(function*(){return this.accountManager.getAccount(t)}))}removeAccount(t){return iS(this,void 0,void 0,(function*(){return this.accountManager.removeAccount(t)}))}removeAllAccounts(){return iS(this,void 0,void 0,(function*(){return this.accountManager.removeAllAccounts()}))}addRequestAndCheckIfRateLimited(){return iS(this,void 0,void 0,(function*(){const t=(new Date).getTime();return this.requestCounter=this.requestCounter.filter((e=>e+1e3*this.rateLimitWindowInSeconds>t)),this.requestCounter.push(t),this.requestCounter.length>this.rateLimit}))}init(t){return iS(this,void 0,void 0,(function*(){return this._transport.status===oE.RESOLVED?(yield this.transport).type:(yield this.setTransport(t),t.type)}))}getOwnAppMetadata(){return iS(this,void 0,void 0,(function*(){return{senderId:yield tS(yield this.beaconId),name:this.name,icon:this.iconUrl}}))}getPeers(){return iS(this,void 0,void 0,(function*(){return(yield this.transport).getPeers()}))}addPeer(t){return iS(this,void 0,void 0,(function*(){return(yield this.transport).addPeer(t)}))}destroy(){const t=Object.create(null,{destroy:{get:()=>super.destroy}});return iS(this,void 0,void 0,(function*(){this._transport.status===oE.RESOLVED&&(yield(yield this.transport).disconnect()),yield t.destroy.call(this)}))}setTransport(t){return iS(this,void 0,void 0,(function*(){t?this._transport.isSettled()?this._transport=lE.resolve(t):this._transport.resolve(t):this._transport.isSettled()&&(this._transport=new lE)}))}addListener(t){return iS(this,void 0,void 0,(function*(){t.addListener(((t,e)=>iS(this,void 0,void 0,(function*(){if("string"==typeof t){const n=yield(new ES).deserialize(t);this.handleResponse(n,e)}})))).catch((t=>oS.error("addListener",t)))}))}sendDisconnectToPeer(t,e){return iS(this,void 0,void 0,(function*(){const n={id:yield FE(),version:t.version,senderId:yield tS(yield this.beaconId),type:ME.Disconnect},r=yield(new ES).serialize(n),i=null!=e?e:yield this.transport;yield i.send(r,t)}))}}{constructor(t){var e,n,r,i;super(Object.assign({storage:t&&t.storage?t.storage:new wS},t)),this.events=new GT,this.openRequests=new Map,this._activeAccount=new lE,this._activePeer=new lE,this.blockchains=new Map,this.events=new GT(t.eventHandlers,null!==(e=t.disableDefaultEvents)&&void 0!==e&&e),this.blockExplorer=null!==(n=t.blockExplorer)&&void 0!==n?n:new WT,this.preferredNetwork=null!==(r=t.preferredNetwork)&&void 0!==r?r:AE.MAINNET,iT(null!==(i=t.colorMode)&&void 0!==i?i:VE.LIGHT),this.disclaimerText=t.disclaimerText,this.appMetadataManager=new MS(this.storage),this.activeAccountLoaded=this.storage.get(NE.ACTIVE_ACCOUNT).then((t=>QT(this,void 0,void 0,(function*(){t?yield this.setActiveAccount(yield this.accountManager.getAccount(t)):yield this.setActiveAccount(void 0)})))).catch((t=>QT(this,void 0,void 0,(function*(){yield this.setActiveAccount(void 0),console.error(t)})))),this.handleResponse=(t,e)=>QT(this,void 0,void 0,(function*(){var n,r;const i=this.openRequests.get(t.id);if($T.log("handleResponse","Received message",t,e),"3"===t.version){const r=t;if(i&&r.message.type===ME.Acknowledge)$T.log(`acknowledge message received for ${t.id}`),console.timeLog(t.id,"acknowledge"),this.events.emit(BT.ACKNOWLEDGE_RECEIVED,{message:r.message,extraInfo:{},walletInfo:yield this.getWalletInfo()}).catch(console.error);else if(i){const n=r.message.blockchainData.appMetadata;r.message.type===ME.PermissionResponse&&n&&(yield this.appMetadataManager.addAppMetadata(n)),console.timeLog(r.id,"response"),console.timeEnd(r.id),r.message.type===ME.Error?i.reject(r.message):i.resolve({message:t,connectionInfo:e}),this.openRequests.delete(r.id)}else if(r.message.type===ME.Disconnect){const r=e.origin===LE.P2P?this.p2pTransport:null!==(n=this.postMessageTransport)&&void 0!==n?n:yield this.transport;if(r){const e=(yield r.getPeers()).find((e=>e.senderId===t.senderId));e?(yield r.removePeer(e),yield this.removeAccountsForPeers([e]),yield this.events.emit(BT.CHANNEL_CLOSED)):$T.error("handleDisconnect","cannot find peer for sender ID",t.senderId)}}else $T.error("handleResponse","no request found for id ",t.id)}else{const n=t;if(i&&n.type===ME.Acknowledge)$T.log(`acknowledge message received for ${t.id}`),console.timeLog(t.id,"acknowledge"),this.events.emit(BT.ACKNOWLEDGE_RECEIVED,{message:n,extraInfo:{},walletInfo:yield this.getWalletInfo()}).catch(console.error);else if(i)n.type===ME.PermissionResponse&&n.appMetadata&&(yield this.appMetadataManager.addAppMetadata(n.appMetadata)),console.timeLog(n.id,"response"),console.timeEnd(n.id),n.type===ME.Error||t.errorType?i.reject(n):i.resolve({message:t,connectionInfo:e}),this.openRequests.delete(n.id);else if(n.type===ME.Disconnect||t.typedMessage.type===ME.Disconnect){const n=e.origin===LE.P2P?this.p2pTransport:null!==(r=this.postMessageTransport)&&void 0!==r?r:yield this.transport;if(n){const e=(yield n.getPeers()).find((e=>e.senderId===t.senderId));e?(yield n.removePeer(e),yield this.removeAccountsForPeers([e]),yield this.events.emit(BT.CHANNEL_CLOSED)):$T.error("handleDisconnect","cannot find peer for sender ID",t.senderId)}}else $T.error("handleResponse","no request found for id ",t.id)}}))}initInternalTransports(){return QT(this,void 0,void 0,(function*(){const t=yield this.keyPair;this.postMessageTransport||this.p2pTransport||(this.postMessageTransport=new XT(this.name,t,this.storage),yield this.addListener(this.postMessageTransport),this.p2pTransport=new ZT(this.name,t,this.storage,this.matrixNodes,this.iconUrl,this.appUrl),yield this.addListener(this.p2pTransport))}))}init(t){const e=Object.create(null,{init:{get:()=>super.init}});return QT(this,void 0,void 0,(function*(){if(this._initPromise)return this._initPromise;try{yield this.activeAccountLoaded}catch(t){}return this._initPromise=new Promise((n=>QT(this,void 0,void 0,(function*(){if(t)yield this.addListener(t),n(yield e.init.call(this,t));else if(this._transport.isSettled())yield(yield this.transport).connect(),n(yield e.init.call(this,yield this.transport));else{const t=yield this.getActiveAccount(),r=()=>{this.postMessageTransport&&this.postMessageTransport.stopListeningForNewPeers().catch(console.error),this.p2pTransport&&this.p2pTransport.stopListeningForNewPeers().catch(console.error)};if(yield this.initInternalTransports(),!this.postMessageTransport||!this.p2pTransport)return;if(this.postMessageTransport.connect().then().catch(console.error),t&&t.origin){const r=t.origin.type;r===LE.EXTENSION?n(yield e.init.call(this,this.postMessageTransport)):r===LE.P2P&&n(yield e.init.call(this,this.p2pTransport))}else{const t=this.p2pTransport,e=this.postMessageTransport;e.listenForNewPeer((t=>{$T.log("init","postmessage transport peer connected",t),this.events.emit(BT.PAIR_SUCCESS,t).catch((t=>console.warn(t))),this.setActivePeer(t).catch(console.error),this.setTransport(this.postMessageTransport).catch(console.error),r(),n(OE.POST_MESSAGE)})).catch(console.error),t.listenForNewPeer((t=>{$T.log("init","p2p transport peer connected",t),this.events.emit(BT.PAIR_SUCCESS,t).catch((t=>console.warn(t))),this.setActivePeer(t).catch(console.error),this.setTransport(this.p2pTransport).catch(console.error),r(),n(OE.P2P)})).catch(console.error),EM.getAvailableExtensions().then((()=>QT(this,void 0,void 0,(function*(){this.events.emit(BT.PAIR_INIT,{p2pPeerInfo:()=>(t.connect().then().catch(console.error),t.getPairingRequestInfo()),postmessagePeerInfo:()=>e.getPairingRequestInfo(),preferredNetwork:this.preferredNetwork,abortedHandler:()=>{this._initPromise=void 0},disclaimerText:this.disclaimerText}).catch((t=>console.warn(t)))})))).catch((t=>{this._initPromise=void 0,console.error(t)}))}}})))),this._initPromise}))}getActiveAccount(){return QT(this,void 0,void 0,(function*(){return this._activeAccount.promise}))}setActiveAccount(t){return QT(this,void 0,void 0,(function*(){if(this._activeAccount.isSettled()?this._activeAccount=lE.resolve(t):this._activeAccount.resolve(t),t){const e=t.origin.type;yield this.initInternalTransports(),e===LE.EXTENSION?yield this.setTransport(this.postMessageTransport):e===LE.P2P&&(yield this.setTransport(this.p2pTransport));const n=yield this.getPeer(t);yield this.setActivePeer(n)}else yield this.setActivePeer(void 0),yield this.setTransport(void 0);yield this.storage.set(NE.ACTIVE_ACCOUNT,t?t.accountIdentifier:void 0),yield this.events.emit(BT.ACTIVE_ACCOUNT_SET,t)}))}clearActiveAccount(){return this.setActiveAccount()}setColorMode(t){return QT(this,void 0,void 0,(function*(){return iT(t)}))}getColorMode(){return QT(this,void 0,void 0,(function*(){return oT()}))}getAppMetadata(){return QT(this,void 0,void 0,(function*(){return this.getOwnAppMetadata()}))}showPrepare(){return QT(this,void 0,void 0,(function*(){const t=yield(()=>QT(this,void 0,void 0,(function*(){try{return yield this.getWalletInfo()}catch(t){return}})))();yield this.events.emit(BT.SHOW_PREPARE,{walletInfo:t})}))}hideUI(t){return QT(this,void 0,void 0,(function*(){yield this.events.emit(BT.HIDE_UI,t)}))}removeAccount(t){const e=Object.create(null,{removeAccount:{get:()=>super.removeAccount}});return QT(this,void 0,void 0,(function*(){const n=e.removeAccount.call(this,t),r=yield this.getActiveAccount();return r&&r.accountIdentifier===t&&(yield this.setActiveAccount(void 0)),n}))}removeAllAccounts(){const t=Object.create(null,{removeAllAccounts:{get:()=>super.removeAllAccounts}});return QT(this,void 0,void 0,(function*(){yield t.removeAllAccounts.call(this),yield this.setActiveAccount(void 0)}))}removePeer(t,e=!1){return QT(this,void 0,void 0,(function*(){const n=yield this.transport,r=n.removePeer(t);return yield this.removeAccountsForPeers([t]),e&&(yield this.sendDisconnectToPeer(t,n)),r}))}removeAllPeers(t=!1){return QT(this,void 0,void 0,(function*(){const e=yield this.transport,n=yield e.getPeers(),r=e.removeAllPeers();if(yield this.removeAccountsForPeers(n),t){const t=n.map((t=>this.sendDisconnectToPeer(t,e)));yield Promise.all(t)}return r}))}subscribeToEvent(t,e){return QT(this,void 0,void 0,(function*(){yield this.events.on(t,e)}))}checkPermissions(t){return QT(this,void 0,void 0,(function*(){if(t===ME.PermissionRequest)return!0;const e=yield this.getActiveAccount();if(!e)throw yield this.sendInternalError("No active account set!");const n=e.scopes;switch(t){case ME.OperationRequest:return n.includes(TE.OPERATION_REQUEST);case ME.SignPayloadRequest:return n.includes(TE.SIGN);case ME.BroadcastRequest:return!0;default:return!1}}))}addBlockchain(t){this.blockchains.set(t.identifier,t),t.getWalletLists().then((t=>{var e,n,r,i;i=t.desktopList,NM=i,r=t.extensionList,kM=r,n=t.webList,DM=n,e=t.iOSList,BM=e}))}removeBlockchain(t){this.blockchains.delete(t)}permissionRequest(t){return QT(this,void 0,void 0,(function*(){console.log("PERMISSION REQUEST");const e=this.blockchains.get(t.blockchainIdentifier);if(!e)throw new Error(`Blockchain "${t.blockchainIdentifier}" not supported by dAppClient`);const n=Object.assign(Object.assign({},t),{type:ME.PermissionRequest,blockchainData:Object.assign(Object.assign({},t.blockchainData),{appMetadata:yield this.getOwnAppMetadata()})});console.log("REQUESTION PERMIMISSION V3","xxx",n);const{message:r,connectionInfo:i}=yield this.makeRequestV3(n).catch((t=>QT(this,void 0,void 0,(function*(){throw new Error("TODO")}))));console.log("RESPONSE V3",r,i);const o=yield e.getAccountInfosFromPermissionResponse(r.message),s={accountIdentifier:o[0].accountId,senderId:r.senderId,origin:{type:i.origin,id:i.id},address:o[0].address,publicKey:o[0].publicKey,scopes:r.message.blockchainData.scopes,connectedAt:(new Date).getTime(),chainData:r.message.blockchainData};return yield this.accountManager.addAccount(s),yield this.setActiveAccount(s),yield e.handleResponse({request:n,account:s,output:r,blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),yield this.notifySuccess(n,{account:s,output:{address:o[0].address,network:{type:AE.MAINNET},scopes:[TE.OPERATION_REQUEST]},blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),r.message}))}request(t){return QT(this,void 0,void 0,(function*(){console.log("REQUEST",t);const e=this.blockchains.get(t.blockchainIdentifier);if(!e)throw new Error(`Blockchain "${e}" not supported by dAppClient`);yield e.validateRequest(t);const n=yield this.getActiveAccount();if(!n)throw yield this.sendInternalError("No active account!");const r=Object.assign(Object.assign({},t),{type:ME.BlockchainRequest,accountId:n.accountIdentifier}),{message:i,connectionInfo:o}=yield this.makeRequestV3(r).catch((t=>QT(this,void 0,void 0,(function*(){throw console.error(t),new Error("TODO")}))));return yield e.handleResponse({request:r,account:n,output:i,blockExplorer:this.blockExplorer,connectionContext:o,walletInfo:yield this.getWalletInfo()}),i.message}))}requestPermissions(t){return QT(this,void 0,void 0,(function*(){const e={appMetadata:yield this.getOwnAppMetadata(),type:ME.PermissionRequest,network:t&&t.network?t.network:{type:AE.MAINNET},scopes:t&&t.scopes?t.scopes:[TE.OPERATION_REQUEST,TE.SIGN]},{message:n,connectionInfo:r}=yield this.makeRequest(e).catch((t=>QT(this,void 0,void 0,(function*(){throw yield this.handleRequestError(e,t)})))),i=n.publicKey||n.pubkey||n.pubKey,o=yield function(t){return yE(this,void 0,void 0,(function*(){const e={edpk:{length:54,prefix:gE.from(new Uint8Array([6,161,159]))},sppk:{length:55,prefix:gE.from(new Uint8Array([6,161,161]))},p2pk:{length:55,prefix:gE.from(new Uint8Array([6,161,164]))}};let n,r;if(64===t.length)n=e.edpk.prefix,r=t;else{const i=Object.entries(e);for(let e=0;e<i.length;e++){const[o,s]=i[e];if(t.startsWith(o)&&t.length===s.length){n=s.prefix;const e=cE.decode(t);r=e.slice(o.length,e.length).toString("hex");break}}}if(!n||!r)throw new Error(`invalid publicKey: ${t}`);const i=(0,pE.hash)(gE.from(r,"hex"),20);return cE.encode(gE.concat([n,gE.from(i)]))}))}(i),s={accountIdentifier:yield JE(o,n.network),senderId:n.senderId,origin:{type:r.origin,id:r.id},address:o,publicKey:i,network:n.network,scopes:n.scopes,threshold:n.threshold,connectedAt:(new Date).getTime()};yield this.accountManager.addAccount(s),yield this.setActiveAccount(s);const a=Object.assign(Object.assign({},n),{address:o,accountInfo:s});return yield this.notifySuccess(e,{account:s,output:a,blockExplorer:this.blockExplorer,connectionContext:r,walletInfo:yield this.getWalletInfo()}),a}))}requestSignPayload(t){return QT(this,void 0,void 0,(function*(){if(!t.payload)throw yield this.sendInternalError("Payload must be provided");const e=yield this.getActiveAccount();if(!e)throw yield this.sendInternalError("No active account!");const n=t.payload;if("string"!=typeof n)throw new Error("Payload must be a string");const r=(()=>{switch(t.signingType){case GE.OPERATION:if(!n.startsWith("03"))throw new Error('When using signing type "OPERATION", the payload must start with prefix "03"');return GE.OPERATION;case GE.MICHELINE:if(!n.startsWith("05"))throw new Error('When using signing type "MICHELINE", the payload must start with prefix "05"');return GE.MICHELINE;case GE.RAW:default:return GE.RAW}})(),i={type:ME.SignPayloadRequest,signingType:r,payload:n,sourceAddress:t.sourceAddress||e.address},{message:o,connectionInfo:s}=yield this.makeRequest(i).catch((t=>QT(this,void 0,void 0,(function*(){throw yield this.handleRequestError(i,t)}))));return yield this.notifySuccess(i,{account:e,output:o,connectionContext:s,walletInfo:yield this.getWalletInfo()}),o}))}requestOperation(t){return QT(this,void 0,void 0,(function*(){if(!t.operationDetails)throw yield this.sendInternalError("Operation details must be provided");const e=yield this.getActiveAccount();if(!e)throw yield this.sendInternalError("No active account!");const n={type:ME.OperationRequest,network:e.network||{type:AE.MAINNET},operationDetails:t.operationDetails,sourceAddress:e.address||""},{message:r,connectionInfo:i}=yield this.makeRequest(n).catch((t=>QT(this,void 0,void 0,(function*(){throw yield this.handleRequestError(n,t)}))));return yield this.notifySuccess(n,{account:e,output:r,blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),r}))}requestBroadcast(t){return QT(this,void 0,void 0,(function*(){if(!t.signedTransaction)throw yield this.sendInternalError("Signed transaction must be provided");const e=t.network||{type:AE.MAINNET},n={type:ME.BroadcastRequest,network:e,signedTransaction:t.signedTransaction},{message:r,connectionInfo:i}=yield this.makeRequest(n).catch((t=>QT(this,void 0,void 0,(function*(){throw yield this.handleRequestError(n,t)}))));return yield this.notifySuccess(n,{network:e,output:r,blockExplorer:this.blockExplorer,connectionContext:i,walletInfo:yield this.getWalletInfo()}),r}))}setActivePeer(t){return QT(this,void 0,void 0,(function*(){this._activePeer.isSettled()?this._activePeer=lE.resolve(t):this._activePeer.resolve(t),t&&(yield this.initInternalTransports(),"postmessage-pairing-response"===t.type?yield this.setTransport(this.postMessageTransport):"p2p-pairing-response"===t.type&&(yield this.setTransport(this.p2pTransport)))}))}setTransport(t){const e=Object.create(null,{setTransport:{get:()=>super.setTransport}});return QT(this,void 0,void 0,(function*(){t||(this._initPromise=void 0);const n=e.setTransport.call(this,t);return yield this.events.emit(BT.ACTIVE_TRANSPORT_SET,t),n}))}sendInternalError(t){return QT(this,void 0,void 0,(function*(){throw yield this.events.emit(BT.INTERNAL_ERROR,{text:t}),new Error(t)}))}removeAccountsForPeers(t){return QT(this,void 0,void 0,(function*(){const e=yield this.accountManager.getAccounts(),n=t.map((t=>t.senderId)),r=e.filter((t=>n.includes(t.senderId))).map((t=>t.accountIdentifier));yield this.accountManager.removeAccounts(r);const i=yield this.getActiveAccount();i&&r.includes(i.accountIdentifier)&&(yield this.setActiveAccount(void 0))}))}handleRequestError(t,e){return QT(this,void 0,void 0,(function*(){if($T.error("handleRequestError","error response",e),e.errorType){const n=[];if(e.errorType===PE.NO_PRIVATE_KEY_FOUND_ERROR){const e=()=>QT(this,void 0,void 0,(function*(){const e=t;let n;if(e.sourceAddress&&e.network){const t=yield JE(e.sourceAddress,e.network);n=yield this.getAccount(t),n&&(yield this.removeAccount(n.accountIdentifier))}}));n.push({text:"Remove account",actionCallback:e})}const r=yield this.getPeer(),i=yield this.getActiveAccount();throw t.type===ME.PermissionRequest&&void 0===(yield this.getActiveAccount())&&(this._initPromise=void 0,this.postMessageTransport=void 0,this.p2pTransport=void 0,yield this.setTransport(),yield this.setActivePeer()),this.events.emit(VT[t.type].error,{errorResponse:e,walletInfo:yield this.getWalletInfo(r,i)},n).catch((t=>$T.error("handleRequestError",t))),sS.getError(e.errorType,e.errorData)}throw e}))}notifySuccess(t,e){return QT(this,void 0,void 0,(function*(){this.events.emit(VT[t.type].success,e).catch((t=>console.warn(t)))}))}getWalletInfo(t,e){var n,r;return QT(this,void 0,void 0,(function*(){const i=e||(yield this.getActiveAccount()),o=t||(yield this.getPeer(i));let s;i&&(s=yield this.appMetadataManager.getAppMetadata(i.senderId));const a=o;s||(s={name:a.name,icon:a.icon});const l=(t,e)=>!(!t||!e)&&t.toLowerCase()===e.toLowerCase();let c,u;if(HM().find((t=>l(t.name,null==s?void 0:s.name)))?(c=HM().find((t=>l(t.name,null==s?void 0:s.name))),u="mobile"):FM().find((t=>l(t.name,null==s?void 0:s.name)))?(c=FM().find((t=>l(t.name,null==s?void 0:s.name))),u="web"):UM().find((t=>l(t.name,null==s?void 0:s.name)))?(c=UM().find((t=>l(t.name,null==s?void 0:s.name))),u="desktop"):zM().find((t=>l(t.name,null==s?void 0:s.name)))&&(c=zM().find((t=>l(t.name,null==s?void 0:s.name))),u="extension"),c){let t;return c.hasOwnProperty("links")?t=c.links[null!==(n=null==i?void 0:i.network.type)&&void 0!==n?n:this.preferredNetwork]:c.hasOwnProperty("deepLink")&&(t=c.deepLink),{name:s.name,icon:null!==(r=s.icon)&&void 0!==r?r:c.logo,deeplink:t,type:u}}return s}))}getPeer(t){var e,n,r,i;return QT(this,void 0,void 0,(function*(){let o;if(t){$T.log("getPeer","We have an account",t);const s=[...null!==(n=yield null===(e=this.postMessageTransport)||void 0===e?void 0:e.getPeers())&&void 0!==n?n:[],...null!==(i=yield null===(r=this.p2pTransport)||void 0===r?void 0:r.getPeers())&&void 0!==i?i:[]];$T.log("getPeer","Found peers",s,t),o=s.find((e=>e.senderId===t.senderId)),o||(o=s.find((e=>e.extensionId===t.origin.id)))}else o=yield this._activePeer.promise,$T.log("getPeer","Active peer",o);if(!o)throw new Error("No matching peer found.");return o}))}makeRequest(t){var e;return QT(this,void 0,void 0,(function*(){const n=yield FE();if(console.time(n),$T.log("makeRequest","starting"),yield this.init(),console.timeLog(n,"init done"),$T.log("makeRequest","after init"),yield this.addRequestAndCheckIfRateLimited())throw this.events.emit(BT.LOCAL_RATE_LIMIT_REACHED).catch((t=>console.warn(t))),new Error("rate limit reached");if(!(yield this.checkPermissions(t.type)))throw this.events.emit(BT.NO_PERMISSIONS).catch((t=>console.warn(t))),new Error("No permissions to send this request to wallet!");if(!this.beaconId)throw yield this.sendInternalError("BeaconID not defined");const r=Object.assign({id:n,version:"2",senderId:yield tS(yield this.beaconId)},t),i=new lE;this.addOpenRequest(r.id,i);const o=yield(new ES).serialize(r),s=yield this.getActiveAccount(),a=yield this.getPeer(s),l=yield this.getWalletInfo(a,s);$T.log("makeRequest","sending message",r),console.timeLog(n,"sending");try{yield(yield this.transport).send(o,a)}catch(t){throw this.events.emit(BT.INTERNAL_ERROR,{text:"Unable to send message. If this problem persists, please reset the connection and pair your wallet again.",buttons:[{text:"Reset Connection",actionCallback:()=>QT(this,void 0,void 0,(function*(){yield xT(),this.disconnect()}))}]}),console.timeLog(n,"send error"),t}return console.timeLog(n,"sent"),this.events.emit(VT[t.type].sent,{walletInfo:Object.assign(Object.assign({},l),{name:null!==(e=l.name)&&void 0!==e?e:"Wallet"}),extraInfo:{resetCallback:()=>QT(this,void 0,void 0,(function*(){this.disconnect()}))}}).catch((t=>console.warn(t))),i.promise}))}makeRequestV3(t){var e;return QT(this,void 0,void 0,(function*(){const n=yield FE();if(console.time(n),$T.log("makeRequest","starting"),yield this.init(),console.timeLog(n,"init done"),$T.log("makeRequest","after init"),yield this.addRequestAndCheckIfRateLimited())throw this.events.emit(BT.LOCAL_RATE_LIMIT_REACHED).catch((t=>console.warn(t))),new Error("rate limit reached");if(!this.beaconId)throw yield this.sendInternalError("BeaconID not defined");const r={id:n,version:"3",senderId:yield tS(yield this.beaconId),message:t},i=new lE;this.addOpenRequest(r.id,i);const o=yield(new ES).serialize(r),s=yield this.getActiveAccount(),a=yield this.getPeer(s),l=yield this.getWalletInfo(a,s);$T.log("makeRequest","sending message",r),console.timeLog(n,"sending");try{yield(yield this.transport).send(o,a)}catch(t){throw this.events.emit(BT.INTERNAL_ERROR,{text:"Unable to send message. If this problem persists, please reset the connection and pair your wallet again.",buttons:[{text:"Reset Connection",actionCallback:()=>QT(this,void 0,void 0,(function*(){yield xT(),this.disconnect()}))}]}),console.timeLog(n,"send error"),t}console.timeLog(n,"sent");const c=t.type;return this.events.emit(VT[c].sent,{walletInfo:Object.assign(Object.assign({},l),{name:null!==(e=l.name)&&void 0!==e?e:"Wallet"}),extraInfo:{resetCallback:()=>QT(this,void 0,void 0,(function*(){this.disconnect()}))}}).catch((t=>console.warn(t))),i.promise}))}disconnect(){return QT(this,void 0,void 0,(function*(){this.postMessageTransport=void 0,this.p2pTransport=void 0,yield Promise.all([this.clearActiveAccount(),(yield this.transport).disconnect()])}))}addOpenRequest(t,e){$T.log("addOpenRequest",this.name,`adding request ${t} and waiting for answer`),this.openRequests.set(t,e)}}new nS("IncomingRequestInterceptor"),new nS("OutgoingResponseInterceptor"),new nS("WalletClient");const eA=()=>{let t="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";return"oo"+Array(49).fill(0).map((e=>t[Math.random()*t.length|0])).join("")},nA=()=>(window.testBox=iA,window.testRoom=oA,window.testFirstPerson=aA,window.testItem=sA,console.log("No wallet synced. Testing enabled.")),rA=()=>{window.testBox=null,window.testBox=()=>console.log("Unsync your wallet to enable testing"),window.testRoom=null,window.testRoom=()=>console.log("Unsync your wallet to enable testing"),window.testFirstPerson=null,window.testFirstPerson=()=>console.log("Unsync your wallet to enable testing"),window.testItem=null,window.testItem=()=>console.log("Unsync your wallet to enable testing")},iA=(t,e)=>{e||(e=eA());var n=1.75*window.innerHeight;return jL.postMessage({side:n,skyurl:t,hash:e}),console.info("Loading test skybox")},oA=(t,e,n)=>{e||(e=eA()),VL.postMessage({figuresUrl:t,hash:e,type:"world",tag:{room:!0},name:n})},sA=(t,e,n)=>{e||(e=eA()),VL.postMessage({figuresUrl:t,hash:e,type:"world",tag:{item:!0},name:n})},aA=(t,e,n)=>{e||(e=eA()),VL.postMessage({figuresUrl:t,hash:e,type:"firstPerson",tag:{firstPerson:!0},name:n})};var lA,cA=document.getElementById("walletSync"),uA=document.getElementById("walletDetail"),hA=document.getElementById("tezWallet"),dA=document.getElementById("ethWallet"),pA="";window.localStorage,uA.style.display="none";const fA=()=>{var t=document.getElementById("walletDetail");"none"===t.style.display?(t.style.display="grid",t.style.zIndex=9999):(t.style.display="none",t.style.zIndex=-50)};document.getElementById("signin").addEventListener("click",fA);const mA=t=>{document.getElementById("helper").style.display="none",Ux([t]).then((()=>{var n=Bx[t];if(n){n.prevLoad="{}",cA.innerHTML=`<div id="alias">${n.alias}</div><div class="profilePic" style="background-image: url('${n.logo}');" ></div>`,hA.innerHTML=`<div class="walletPics" style="background-image: url('${n.logo}'); min-width:${.08*window.innerHeight}px;min-height:${.08*window.innerHeight}px;max-width:100px;max-height:100px;" ></div><br><div style="1px solid rgb(200 200 200);border-radius: 5%;">${n.alias}</div><br><br>`;const t=document.createElement("div");t.style="font-family:monospace;border:1px solid red;passing:2px;",t.innerText="Unsync Tezos wallet",t.addEventListener("click",yA),hA.appendChild(t),window.location.search||fC(n.alias)}else cA.innerHTML="<div style='font-size:12px'>CONNECTION ERROR</div>";e["Identité"].fin=window.performance.now()}))};async function gA(){rA(),cA.innerHTML="<div style='font-size:12px'>LOADING PROFILE...</div>";const t=await lA.requestPermissions();pA=t.address,fA(),mA(t.address),_L(),wL(t.address),hA.removeEventListener("click",gA),hA.addEventListener("click",yA)}async function yA(){window.confirm("Unsynchronize your Tezos wallet?")&&(await lA.clearActiveAccount(),cA.innerHTML="<div style='font-size:12px;font-family: Arial, Helvetica, sans-serif;border:1px solid black;    display: flex;align-items: center;padding:5px;'>WALLET SYNC</div>",hA.innerText="Click here to sync your Tezos wallet",hA.removeEventListener("click",yA),fA(),nA(),setTimeout((()=>{hA.addEventListener("click",gA)}),250))}var vA=localStorage.getItem("ethGalleryAccount");vA&&(dA.innerHTML="<div style='padding:10%'>Your Ethereum gallery wallet is "+vA+"</div>",nE(vA));const _A=async()=>{try{var t=0;if(await ethereum.request({method:"eth_requestAccounts"}),(t=await ethereum.request({method:"eth_accounts"}))&&rA(),dA.removeEventListener("click",_A),1===t.length)dA.innerHTML="<div style='padding:10%'>Your Ethereum gallery wallet is "+t[0]+"</div>",vA=t[0],localStorage.setItem("ethGalleryAccount",t[0]),nE(vA);else if(t.length>1){const e=document.createElement("div");e.innerText="Please choose an Ethereum gallery wallet in the list below",dA.style.overflow="auto",dA.appendChild(e),t.forEach((t=>{var e=document.createElement("div");e.innerText=t,e.style="font-size:9px;border:1px solid red",e.addEventListener("click",(()=>{vA=t,dA.innerHTML="",dA.innerHTML="<div style='padding:10%'>Your Ethereum gallery wallet is "+t+"</div>",nE(t),localStorage.setItem("ethGalleryAccount",t)})),dA.appendChild(e)}))}}catch(t){console.error(t)}};document.getElementById("synclessnotif").addEventListener("click",(()=>window.open("https://observablehq.com/@anaglyph-ic/personalised-anaver-se-entry-generator?collection=@anaglyph-ic/starting-with-the-anaver-se","_blank"))),dA.addEventListener("click",_A);const wA=1.25,bA=65535,xA=Math.pow(2,-24);class EA{constructor(){}}function SA(t,e,n){return n.min.x=e[t],n.min.y=e[t+1],n.min.z=e[t+2],n.max.x=e[t+3],n.max.y=e[t+4],n.max.z=e[t+5],n}function MA(t){let e=-1,n=-1/0;for(let r=0;r<3;r++){const i=t[r+3]-t[r];i>n&&(n=i,e=r)}return e}function TA(t,e){e.set(t)}function AA(t,e,n){let r,i;for(let o=0;o<3;o++){const s=o+3;r=t[o],i=e[o],n[o]=r<i?r:i,r=t[s],i=e[s],n[s]=r>i?r:i}}function RA(t,e,n){for(let r=0;r<3;r++){const i=e[t+2*r],o=e[t+2*r+1],s=i-o,a=i+o;s<n[r]&&(n[r]=s),a>n[r+3]&&(n[r+3]=a)}}function LA(t){const e=t[3]-t[0],n=t[4]-t[1],r=t[5]-t[2];return 2*(e*n+n*r+r*e)}function CA(t,e,n,r,i=null){let o=1/0,s=1/0,a=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0;const y=null!==i;for(let r=6*e,i=6*(e+n);r<i;r+=6){const e=t[r+0],n=t[r+1],i=e-n,v=e+n;i<o&&(o=i),v>l&&(l=v),y&&e<h&&(h=e),y&&e>f&&(f=e);const _=t[r+2],w=t[r+3],b=_-w,x=_+w;b<s&&(s=b),x>c&&(c=x),y&&_<d&&(d=_),y&&_>m&&(m=_);const E=t[r+4],S=t[r+5],M=E-S,T=E+S;M<a&&(a=M),T>u&&(u=T),y&&E<p&&(p=E),y&&E>g&&(g=E)}r[0]=o,r[1]=s,r[2]=a,r[3]=l,r[4]=c,r[5]=u,y&&(i[0]=h,i[1]=d,i[2]=p,i[3]=f,i[4]=m,i[5]=g)}const PA=(t,e)=>t.candidate-e.candidate,IA=new Array(32).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),OA=new Float32Array(6);class NA{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let n=1/0,r=-1/0;for(let i=0,o=t.length;i<o;i++){const o=t[i][e];n=o<n?o:n,r=o>r?o:r}this.min=n,this.max=r}setFromPoints(t,e){let n=1/0,r=-1/0;for(let i=0,o=e.length;i<o;i++){const o=e[i],s=t.dot(o);n=s<n?s:n,r=s>r?s:r}this.min=n,this.max=r}isSeparated(t){return this.min>t.max||t.min>this.max}}NA.prototype.setFromBox=function(){const t=new Ns;return function(e,n){const r=n.min,i=n.max;let o=1/0,s=-1/0;for(let n=0;n<=1;n++)for(let a=0;a<=1;a++)for(let l=0;l<=1;l++){t.x=r.x*n+i.x*(1-n),t.y=r.y*a+i.y*(1-a),t.z=r.z*l+i.z*(1-l);const c=e.dot(t);o=Math.min(c,o),s=Math.max(c,s)}this.min=o,this.max=s}}(),new NA;const kA=function(){const t=new Ns,e=new Ns,n=new Ns;return function(r,i,o){const s=r.start,a=t,l=i.start,c=e;n.subVectors(s,l),t.subVectors(r.end,i.start),e.subVectors(i.end,i.start);const u=n.dot(c),h=c.dot(a),d=c.dot(c),p=n.dot(a),f=a.dot(a)*d-h*h;let m,g;m=0!==f?(u*h-p*d)/f:0,g=(u+m*h)/d,o.x=m,o.y=g}}(),DA=function(){const t=new hs,e=new Ns,n=new Ns;return function(r,i,o,s){kA(r,i,t);let a=t.x,l=t.y;if(a>=0&&a<=1&&l>=0&&l<=1)return r.at(a,o),void i.at(l,s);if(a>=0&&a<=1)return l<0?i.at(0,s):i.at(1,s),void r.closestPointToPoint(s,!0,o);if(l>=0&&l<=1)return a<0?r.at(0,o):r.at(1,o),void i.closestPointToPoint(o,!0,s);{let t,c;t=a<0?r.start:r.end,c=l<0?i.start:i.end;const u=e,h=n;return r.closestPointToPoint(c,!0,e),i.closestPointToPoint(t,!0,n),u.distanceToSquared(c)<=h.distanceToSquared(t)?(o.copy(u),void s.copy(c)):(o.copy(t),void s.copy(h))}}}(),BA=function(){const t=new Ns,e=new Ns,n=new Zl,r=new Ag;return function(i,o){const{radius:s,center:a}=i,{a:l,b:c,c:u}=o;if(r.start=l,r.end=c,r.closestPointToPoint(a,!0,t).distanceTo(a)<=s)return!0;if(r.start=l,r.end=u,r.closestPointToPoint(a,!0,t).distanceTo(a)<=s)return!0;if(r.start=c,r.end=u,r.closestPointToPoint(a,!0,t).distanceTo(a)<=s)return!0;const h=o.getPlane(n);if(Math.abs(h.distanceToPoint(a))<=s){const t=h.projectPoint(a,e);if(o.containsPoint(t))return!0}return!1}}();class UA extends Ka{constructor(...t){super(...t),this.isSeparatingAxisTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new Ns)),this.satBounds=new Array(4).fill().map((()=>new NA)),this.points=[this.a,this.b,this.c],this.sphere=new na,this.plane=new Zl,this.needsUpdate=!1}intersectsSphere(t){return BA(t,this)}update(){const t=this.a,e=this.b,n=this.c,r=this.points,i=this.satAxes,o=this.satBounds,s=i[0],a=o[0];this.getNormal(s),a.setFromPoints(s,r);const l=i[1],c=o[1];l.subVectors(t,e),c.setFromPoints(l,r);const u=i[2],h=o[2];u.subVectors(e,n),h.setFromPoints(u,r);const d=i[3],p=o[3];d.subVectors(n,t),p.setFromPoints(d,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(s,t),this.needsUpdate=!1}}UA.prototype.closestPointToSegment=function(){const t=new Ns,e=new Ns,n=new Ag;return function(r,i=null,o=null){const{start:s,end:a}=r,l=this.points;let c,u=1/0;for(let s=0;s<3;s++){const a=(s+1)%3;n.start.copy(l[s]),n.end.copy(l[a]),DA(n,r,t,e),c=t.distanceToSquared(e),c<u&&(u=c,i&&i.copy(t),o&&o.copy(e))}return this.closestPointToPoint(s,t),c=s.distanceToSquared(t),c<u&&(u=c,i&&i.copy(t),o&&o.copy(s)),this.closestPointToPoint(a,t),c=a.distanceToSquared(t),c<u&&(u=c,i&&i.copy(t),o&&o.copy(a)),Math.sqrt(u)}}(),UA.prototype.intersectsTriangle=function(){const t=new UA,e=new Array(3),n=new Array(3),r=new NA,i=new NA,o=new Ns,s=new Ns,a=new Ns,l=new Ns,c=new Ag,u=new Ag,h=new Ag;return function(d,p=null){this.needsUpdate&&this.update(),d.isSeparatingAxisTriangle?d.needsUpdate&&d.update():(t.copy(d),t.update(),d=t);const f=this.satBounds,m=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(let t=0;t<4;t++){const e=f[t],i=m[t];if(r.setFromPoints(i,n),e.isSeparated(r))return!1}const g=d.satBounds,y=d.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let t=0;t<4;t++){const n=g[t],i=y[t];if(r.setFromPoints(i,e),n.isSeparated(r))return!1}for(let t=0;t<4;t++){const s=m[t];for(let t=0;t<4;t++){const a=y[t];if(o.crossVectors(s,a),r.setFromPoints(o,e),i.setFromPoints(o,n),r.isSeparated(i))return!1}}if(p){const t=this.plane,e=d.plane;if(Math.abs(t.normal.dot(e.normal))>1-1e-10)console.warn("SeparatingAxisTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0);else{const n=this.points;let r=!1;for(let t=0;t<3;t++){const i=n[t],o=n[(t+1)%3];if(c.start.copy(i),c.end.copy(o),e.intersectLine(c,r?u.start:u.end)){if(r)break;r=!0}}const i=d.points;let o=!1;for(let e=0;e<3;e++){const n=i[e],r=i[(e+1)%3];if(c.start.copy(n),c.end.copy(r),t.intersectLine(c,o?h.start:h.end)){if(o)break;o=!0}}if(u.delta(s),h.delta(a),s.dot(a)<0){let t=h.start;h.start=h.end,h.end=t}l.subVectors(u.start,h.start),l.dot(s)>0?p.start.copy(u.start):p.start.copy(h.start),l.subVectors(u.end,h.end),l.dot(s)<0?p.end.copy(u.end):p.end.copy(h.end)}}return!0}}(),UA.prototype.distanceToPoint=function(){const t=new Ns;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}(),UA.prototype.distanceToTriangle=function(){const t=new Ns,e=new Ns,n=["a","b","c"],r=new Ag,i=new Ag;return function(o,s=null,a=null){const l=s||a?r:null;if(this.intersectsTriangle(o,l))return(s||a)&&(s&&l.getCenter(s),a&&l.getCenter(a)),0;let c=1/0;for(let e=0;e<3;e++){let r;const i=n[e],l=o[i];this.closestPointToPoint(l,t),r=l.distanceToSquared(t),r<c&&(c=r,s&&s.copy(t),a&&a.copy(l));const u=this[i];o.closestPointToPoint(u,t),r=u.distanceToSquared(t),r<c&&(c=r,s&&s.copy(u),a&&a.copy(t))}for(let l=0;l<3;l++){const u=n[l],h=n[(l+1)%3];r.set(this[u],this[h]);for(let l=0;l<3;l++){const u=n[l],h=n[(l+1)%3];i.set(o[u],o[h]),DA(r,i,t,e);const d=t.distanceToSquared(e);d<c&&(c=d,s&&s.copy(t),a&&a.copy(e))}}return Math.sqrt(c)}}();class zA extends Bs{constructor(...t){super(...t),this.isOrientedBox=!0,this.matrix=new ha,this.invMatrix=new ha,this.points=new Array(8).fill().map((()=>new Ns)),this.satAxes=new Array(3).fill().map((()=>new Ns)),this.satBounds=new Array(3).fill().map((()=>new NA)),this.alignedSatBounds=new Array(3).fill().map((()=>new NA)),this.needsUpdate=!1}set(t,e,n){super.set(t,e),this.matrix=n,this.needsUpdate=!0}copy(t){super.copy(t),this.matrix.copy(t.matrix),this.needsUpdate=!0}}zA.prototype.update=function(){const t=this.matrix,e=this.min,n=this.max,r=this.points;for(let i=0;i<=1;i++)for(let o=0;o<=1;o++)for(let s=0;s<=1;s++){const a=r[1*i|2*o|4*s];a.x=i?n.x:e.x,a.y=o?n.y:e.y,a.z=s?n.z:e.z,a.applyMatrix4(t)}const i=this.satBounds,o=this.satAxes,s=r[0];for(let t=0;t<3;t++){const e=o[t],n=i[t],a=r[1<<t];e.subVectors(s,a),n.setFromPoints(e,r)}const a=this.alignedSatBounds;a[0].setFromPointsField(r,"x"),a[1].setFromPointsField(r,"y"),a[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},zA.prototype.intersectsBox=function(){const t=new NA;return function(e){this.needsUpdate&&this.update();const n=e.min,r=e.max,i=this.satBounds,o=this.satAxes,s=this.alignedSatBounds;if(t.min=n.x,t.max=r.x,s[0].isSeparated(t))return!1;if(t.min=n.y,t.max=r.y,s[1].isSeparated(t))return!1;if(t.min=n.z,t.max=r.z,s[2].isSeparated(t))return!1;for(let n=0;n<3;n++){const r=o[n],s=i[n];if(t.setFromBox(r,e),s.isSeparated(t))return!1}return!0}}(),zA.prototype.intersectsTriangle=function(){const t=new UA,e=new Array(3),n=new NA,r=new NA,i=new Ns;return function(o){this.needsUpdate&&this.update(),o.isSeparatingAxisTriangle?o.needsUpdate&&o.update():(t.copy(o),t.update(),o=t);const s=this.satBounds,a=this.satAxes;e[0]=o.a,e[1]=o.b,e[2]=o.c;for(let t=0;t<3;t++){const r=s[t],i=a[t];if(n.setFromPoints(i,e),r.isSeparated(n))return!1}const l=o.satBounds,c=o.satAxes,u=this.points;for(let t=0;t<3;t++){const e=l[t],r=c[t];if(n.setFromPoints(r,u),e.isSeparated(n))return!1}for(let t=0;t<3;t++){const o=a[t];for(let t=0;t<4;t++){const s=c[t];if(i.crossVectors(o,s),n.setFromPoints(i,e),r.setFromPoints(i,u),n.isSeparated(r))return!1}}return!0}}(),zA.prototype.closestPointToPoint=function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e},zA.prototype.distanceToPoint=function(){const t=new Ns;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}(),zA.prototype.distanceToBox=function(){const t=["x","y","z"],e=new Array(12).fill().map((()=>new Ag)),n=new Array(12).fill().map((()=>new Ag)),r=new Ns,i=new Ns;return function(o,s=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(a||l)&&(o.getCenter(i),this.closestPointToPoint(i,r),o.closestPointToPoint(r,i),a&&a.copy(r),l&&l.copy(i)),0;const c=s*s,u=o.min,h=o.max,d=this.points;let p=1/0;for(let t=0;t<8;t++){const e=d[t];i.copy(e).clamp(u,h);const n=e.distanceToSquared(i);if(n<p&&(p=n,a&&a.copy(e),l&&l.copy(i),n<c))return Math.sqrt(n)}let f=0;for(let r=0;r<3;r++)for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){const s=(r+1)%3,a=(r+2)%3,l=1<<r|i<<s|o<<a,c=d[i<<s|o<<a],p=d[l];e[f].set(c,p);const m=t[r],g=t[s],y=t[a],v=n[f],_=v.start,w=v.end;_[m]=u[m],_[g]=i?u[g]:h[g],_[y]=o?u[y]:h[g],w[m]=h[m],w[g]=i?u[g]:h[g],w[y]=o?u[y]:h[g],f++}for(let t=0;t<=1;t++)for(let e=0;e<=1;e++)for(let n=0;n<=1;n++){i.x=t?h.x:u.x,i.y=e?h.y:u.y,i.z=n?h.z:u.z,this.closestPointToPoint(i,r);const o=i.distanceToSquared(r);if(o<p&&(p=o,a&&a.copy(r),l&&l.copy(i),o<c))return Math.sqrt(o)}for(let t=0;t<12;t++){const o=e[t];for(let t=0;t<12;t++){const e=n[t];DA(o,e,r,i);const s=r.distanceToSquared(i);if(s<p&&(p=s,a&&a.copy(r),l&&l.copy(i),s<c))return Math.sqrt(s)}}return Math.sqrt(p)}}();const FA=new Ns,HA=new Ns,GA=new Ns,VA=new hs,jA=new hs,WA=new hs,qA=new Ns;function KA(t,e,n,r,i){const o=3*r,s=t.index.getX(o),a=t.index.getX(o+1),l=t.index.getX(o+2),c=function(t,e,n,r,i,o,s){FA.fromBufferAttribute(e,r),HA.fromBufferAttribute(e,i),GA.fromBufferAttribute(e,o);const a=function(t,e,n,r,i,o){let s;return s=o===tr?t.intersectTriangle(r,n,e,!0,i):t.intersectTriangle(e,n,r,o!==er,i),null===s?null:{distance:t.origin.distanceTo(i),point:i.clone()}}(t,FA,HA,GA,qA,s);if(a){n&&(VA.fromBufferAttribute(n,r),jA.fromBufferAttribute(n,i),WA.fromBufferAttribute(n,o),a.uv=Ka.getUV(qA,FA,HA,GA,VA,jA,WA,new hs));const t={a:r,b:i,c:o,normal:new Ns,materialIndex:0};Ka.getNormal(FA,HA,GA,t.normal),a.face=t,a.faceIndex=r}return a}(n,t.attributes.position,t.attributes.uv,s,a,l,e);return c?(c.faceIndex=r,i&&i.push(c),c):null}function XA(t,e,n){return null===t?null:(t.point.applyMatrix4(e.matrixWorld),t.distance=t.point.distanceTo(n.ray.origin),t.object=e,t.distance<n.near||t.distance>n.far?null:t)}function YA(t,e,n,r){const i=t.a,o=t.b,s=t.c;let a=e,l=e+1,c=e+2;n&&(a=n.getX(e),l=n.getX(e+1),c=n.getX(e+2)),i.x=r.getX(a),i.y=r.getY(a),i.z=r.getZ(a),o.x=r.getX(l),o.y=r.getY(l),o.z=r.getZ(l),s.x=r.getX(c),s.y=r.getY(c),s.z=r.getZ(c)}function JA(t,e,n,r,i,o,s){const a=n.index,l=n.attributes.position;for(let n=t,c=e+t;n<c;n++)if(YA(s,3*n,a,l),s.needsUpdate=!0,r(s,n,i,o))return!0;return!1}class ZA{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return 0===t.length?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}function QA(t,e){return 65535===e[t+15]}function $A(t,e){return e[t+6]}function tR(t,e){return e[t+14]}function eR(t){return t+8}function nR(t,e){return e[t+6]}const rR=new Bs,iR=new Ns,oR=["x","y","z"];function sR(t,e,n,r,i){let o=2*t,s=pR,a=fR,l=mR;if(QA(o,a))!function(t,e,n,r,i,o){for(let s=r,a=r+i;s<a;s++)KA(t,e,n,s,o)}(e,n,r,$A(t,l),tR(o,a),i);else{const o=eR(t);uR(o,s,r,iR)&&sR(o,e,n,r,i);const a=nR(t,l);uR(a,s,r,iR)&&sR(a,e,n,r,i)}}function aR(t,e,n,r){let i=2*t,o=pR,s=fR,a=mR;if(QA(i,s))return function(t,e,n,r,i){let o=1/0,s=null;for(let a=r,l=r+i;a<l;a++){const r=KA(t,e,n,a);r&&r.distance<o&&(s=r,o=r.distance)}return s}(e,n,r,$A(t,a),tR(i,s));{const i=function(t,e){return e[t+7]}(t,a),s=oR[i],l=r.direction[s]>=0;let c,u;l?(c=eR(t),u=nR(t,a)):(c=nR(t,a),u=eR(t));const h=uR(c,o,r,iR)?aR(c,e,n,r):null;if(h){const t=h.point[s];if(l?t<=o[u+i]:t>=o[u+i+3])return h}const d=uR(u,o,r,iR)?aR(u,e,n,r):null;return h&&d?h.distance<=d.distance?h:d:h||d||null}}const lR=function(){let t,e;const n=[],r=new ZA((()=>new Bs));return function(...o){t=r.getPrimitive(),e=r.getPrimitive(),n.push(t,e);const s=i(...o);r.releasePrimitive(t),r.releasePrimitive(e),n.pop(),n.pop();const a=n.length;return a>0&&(e=n[a-1],t=n[a-2]),s};function i(n,r,o,s,a=null,l=0,c=0){function u(t){let e=2*t,n=fR,r=mR;for(;!QA(e,n);)e=2*(t=eR(t));return $A(t,r)}function h(t){let e=2*t,n=fR,r=mR;for(;!QA(e,n);)e=2*(t=nR(t,r));return $A(t,r)+tR(e,n)}let d=2*n,p=pR,f=fR,m=mR;if(QA(d,f)){const e=$A(n,m),r=tR(d,f);return SA(n,p,t),s(e,r,!1,c,l+n,t)}{const d=eR(n),g=nR(n,m);let y,v,_,w,b=d,x=g;if(a&&(_=t,w=e,SA(b,p,_),SA(x,p,w),y=a(_),v=a(w),v<y)){b=g,x=d;const t=y;y=v,v=t,_=w}_||(_=t,SA(b,p,_));const E=o(_,QA(2*b,f),y,c+1,l+b);let S;if(2===E){const t=u(b);S=s(t,h(b)-t,!0,c+1,l+b,_)}else S=E&&i(b,r,o,s,a,l,c+1);if(S)return!0;w=e,SA(x,p,w);const M=o(w,QA(2*x,f),v,c+1,l+x);let T;if(2===M){const t=u(x);T=s(t,h(x)-t,!0,c+1,l+x,w)}else T=M&&i(x,r,o,s,a,l,c+1);return!!T}}}(),cR=function(){const t=new UA,e=new UA,n=new ha,r=new zA,i=new zA;return function o(s,a,l,c,u=null){let h=2*s,d=pR,p=fR,f=mR;if(null===u&&(l.boundingBox||l.computeBoundingBox(),r.set(l.boundingBox.min,l.boundingBox.max,c),u=r),!QA(h,p)){const t=s+8,e=f[s+6];return SA(t,d,rR),u.intersectsBox(rR)&&o(t,a,l,c,u)?!0:(SA(e,d,rR),!(!u.intersectsBox(rR)||!o(e,a,l,c,u)))}{const r=a,o=r.index,u=r.attributes.position,m=l.index,g=l.attributes.position,y=$A(s,f),v=tR(h,p);if(n.copy(c).invert(),l.boundsTree)return SA(s,d,i),i.matrix.copy(n),i.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:t=>i.intersectsBox(t),intersectsTriangle:t=>{t.a.applyMatrix4(c),t.b.applyMatrix4(c),t.c.applyMatrix4(c),t.needsUpdate=!0;for(let n=3*y,r=3*(v+y);n<r;n+=3)if(YA(e,n,o,u),e.needsUpdate=!0,t.intersectsTriangle(e))return!0;return!1}});for(let r=3*y,i=v+3*y;r<i;r+=3){YA(t,r,o,u),t.a.applyMatrix4(n),t.b.applyMatrix4(n),t.c.applyMatrix4(n),t.needsUpdate=!0;for(let n=0,r=m.count;n<r;n+=3)if(YA(e,n,m,g),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}}}();function uR(t,e,n,r){return SA(t,e,rR),n.intersectBox(rR,r)}const hR=[];let dR,pR,fR,mR;function gR(t){dR&&hR.push(dR),dR=t,pR=new Float32Array(t),fR=new Uint16Array(t),mR=new Uint32Array(t)}function yR(){dR=null,pR=null,fR=null,mR=null,hR.length&&gR(hR.pop())}const vR=Symbol("skip tree generation"),_R=new Bs,wR=new Bs,bR=new ha,xR=new zA,ER=new zA,SR=new Ns,MR=new Ns,TR=new Ns,AR=new Ns,RR=new Ns,LR=new Bs,CR=new ZA((()=>new UA));class PR{static serialize(t,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),PR.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});e={cloneBuffers:!0,...e};const n=t.geometry,r=t._roots,i=n.getIndex();let o;return o=e.cloneBuffers?{roots:r.map((t=>t.slice())),index:i.array.slice()}:{roots:r,index:i.array},o}static deserialize(t,e,n={}){if("boolean"==typeof n)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),PR.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});n={setIndex:!0,...n};const{index:r,roots:i}=t,o=new PR(e,{...n,[vR]:!0});if(o._roots=i,n.setIndex){const n=e.getIndex();if(null===n){const n=new $a(t.index,1,!1);e.setIndex(n)}else n.array!==r&&(n.array.set(r),n.needsUpdate=!0)}return o}constructor(t,e={}){if(!t.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[vR]:!1},e)).useSharedArrayBuffer&&"undefined"==typeof SharedArrayBuffer)throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[vR]||(this._roots=function(t,e){const n=function(t,e){function n(t){d&&d(t/p)}function r(e,i,d,p=null,m=0){if(!f&&m>=l&&(f=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),d<=u||m>=l)return n(i),e.offset=i,e.count=d,e;const g=function(t,e,n,r,i,o){let s=-1,a=0;if(0===o)s=MA(e),-1!==s&&(a=(e[s]+e[s+3])/2);else if(1===o)s=MA(t),-1!==s&&(a=function(t,e,n,r){let i=0;for(let o=e,s=e+n;o<s;o++)i+=t[6*o+2*r];return i/n}(n,r,i,s));else if(2===o){const o=LA(t);let l=wA*i;const c=6*r,u=6*(r+i);for(let t=0;t<3;t++){const r=e[t],h=(e[t+3]-r)/32;if(i<8){const e=[...IA];e.length=i;let r=0;for(let i=c;i<u;i+=6,r++){const o=e[r];o.candidate=n[i+2*t],o.count=0;const{bounds:s,leftCacheBounds:a,rightCacheBounds:l}=o;for(let t=0;t<3;t++)l[t]=1/0,l[t+3]=-1/0,a[t]=1/0,a[t+3]=-1/0,s[t]=1/0,s[t+3]=-1/0;RA(i,n,s)}e.sort(PA);let h=i;for(let t=0;t<h;t++){const n=e[t];for(;t+1<h&&e[t+1].candidate===n.candidate;)e.splice(t+1,1),h--}for(let r=c;r<u;r+=6){const i=n[r+2*t];for(let t=0;t<h;t++){const o=e[t];i>=o.candidate?RA(r,n,o.rightCacheBounds):(RA(r,n,o.leftCacheBounds),o.count++)}}for(let n=0;n<h;n++){const r=e[n],c=r.count,u=i-r.count,h=r.leftCacheBounds,d=r.rightCacheBounds;let p=0;0!==c&&(p=LA(h)/o);let f=0;0!==u&&(f=LA(d)/o);const m=1+wA*(p*c+f*u);m<l&&(s=t,l=m,a=r.candidate)}}else{for(let t=0;t<32;t++){const e=IA[t];e.count=0,e.candidate=r+h+t*h;const n=e.bounds;for(let t=0;t<3;t++)n[t]=1/0,n[t+3]=-1/0}for(let e=c;e<u;e+=6){let i=~~((n[e+2*t]-r)/h);i>=32&&(i=31);const o=IA[i];o.count++,RA(e,n,o.bounds)}const e=IA[31];TA(e.bounds,e.rightCacheBounds);for(let t=30;t>=0;t--){const e=IA[t],n=IA[t+1];AA(e.bounds,n.rightCacheBounds,e.rightCacheBounds)}let d=0;for(let e=0;e<31;e++){const n=IA[e],r=n.count,c=n.bounds,u=IA[e+1].rightCacheBounds;0!==r&&(0===d?TA(c,OA):AA(c,OA,OA)),d+=r;let h=0,p=0;0!==d&&(h=LA(OA)/o);const f=i-d;0!==f&&(p=LA(u)/o);const m=1+wA*(h*d+p*f);m<l&&(s=t,l=m,a=n.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${o} used.`);return{axis:s,pos:a}}(e.boundingData,p,s,i,d,h);if(-1===g.axis)return n(i),e.offset=i,e.count=d,e;const y=function(t,e,n,r,i){let o=n,s=n+r-1;const a=i.pos,l=2*i.axis;for(;;){for(;o<=s&&e[6*o+l]<a;)o++;for(;o<=s&&e[6*s+l]>=a;)s--;if(!(o<s))return o;for(let n=0;n<3;n++){let r=t[3*o+n];t[3*o+n]=t[3*s+n],t[3*s+n]=r;let i=e[6*o+2*n+0];e[6*o+2*n+0]=e[6*s+2*n+0],e[6*s+2*n+0]=i;let a=e[6*o+2*n+1];e[6*o+2*n+1]=e[6*s+2*n+1],e[6*s+2*n+1]=a}o++,s--}}(a,s,i,d,g);if(y===i||y===i+d)n(i),e.offset=i,e.count=d;else{e.splitAxis=g.axis;const t=new EA,n=i,a=y-i;e.left=t,t.boundingData=new Float32Array(6),CA(s,n,a,t.boundingData,o),r(t,n,a,o,m+1);const l=new EA,c=y,u=d-a;e.right=l,l.boundingData=new Float32Array(6),CA(s,c,u,l.boundingData,o),r(l,c,u,o,m+1)}return e}!function(t,e){if(!t.index){const n=t.attributes.position.count,r=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;let i;i=n>65535?new Uint32Array(new r(4*n)):new Uint16Array(new r(2*n)),t.setIndex(new $a(i,1));for(let t=0;t<n;t++)i[t]=t}}(t,e);const i=new Float32Array(6),o=new Float32Array(6),s=function(t,e){const n=t.attributes.position,r=n.array,i=t.index.array,o=i.length/3,s=new Float32Array(6*o),a=n.offset||0;let l=3;n.isInterleavedBufferAttribute&&(l=n.data.stride);for(let t=0;t<o;t++){const n=3*t,o=6*t,c=i[n+0]*l+a,u=i[n+1]*l+a,h=i[n+2]*l+a;for(let t=0;t<3;t++){const n=r[c+t],i=r[u+t],a=r[h+t];let l=n;i<l&&(l=i),a<l&&(l=a);let d=n;i>d&&(d=i),a>d&&(d=a);const p=(d-l)/2,f=2*t;s[o+f+0]=l+p,s[o+f+1]=p+(Math.abs(l)+p)*xA,l<e[t]&&(e[t]=l),d>e[t+3]&&(e[t+3]=d)}}return s}(t,i),a=t.index.array,l=e.maxDepth,c=e.verbose,u=e.maxLeafTris,h=e.strategy,d=e.onProgress,p=t.index.count/3;let f=!1;const m=[],g=function(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];const e=[],n=new Set;for(const e of t.groups)n.add(e.start),n.add(e.start+e.count);const r=Array.from(n.values()).sort(((t,e)=>t-e));for(let t=0;t<r.length-1;t++){const n=r[t],i=r[t+1];e.push({offset:n/3,count:(i-n)/3})}return e}(t);if(1===g.length){const t=g[0],e=new EA;e.boundingData=i,function(t,e,n,r){let i=1/0,o=1/0,s=1/0,a=-1/0,l=-1/0,c=-1/0;for(let r=6*e,u=6*(e+n);r<u;r+=6){const e=t[r+0];e<i&&(i=e),e>a&&(a=e);const n=t[r+2];n<o&&(o=n),n>l&&(l=n);const u=t[r+4];u<s&&(s=u),u>c&&(c=u)}r[0]=i,r[1]=o,r[2]=s,r[3]=a,r[4]=l,r[5]=c}(s,t.offset,t.count,o),r(e,t.offset,t.count,o),m.push(e)}else for(let t of g){const e=new EA;e.boundingData=new Float32Array(6),CA(s,t.offset,t.count,e.boundingData,o),r(e,t.offset,t.count,o),m.push(e)}return m}(t,e);let r,i,o;const s=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let t=0;t<n.length;t++){const e=n[t],u=new a(32*l(e));r=new Float32Array(u),i=new Uint32Array(u),o=new Uint16Array(u),c(0,e),s.push(u)}return s;function l(t){return t.count?1:1+l(t.left)+l(t.right)}function c(t,e){const n=t/4,s=t/2,a=!!e.count,l=e.boundingData;for(let t=0;t<6;t++)r[n+t]=l[t];if(a){const r=e.offset,a=e.count;return i[n+6]=r,o[s+14]=a,o[s+15]=bA,t+32}{const r=e.left,o=e.right,s=e.splitAxis;let a;if(a=c(t+32,r),a/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return i[n+6]=a/4,a=c(a,o),i[n+7]=s,a}}}(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Bs))),this.geometry=t}refit(t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=this.geometry,n=e.index.array,r=e.attributes.position,i=r.array,o=r.offset||0;let s,a,l,c,u=3;r.isInterleavedBufferAttribute&&(u=r.data.stride);let h=0;const d=this._roots;for(let t=0,e=d.length;t<e;t++)s=d[t],a=new Uint32Array(s),l=new Uint16Array(s),c=new Float32Array(s),p(0,h),h+=s.byteLength;function p(e,r,s=!1){const h=2*e;if(l[h+15]===bA){const t=a[e+6];let r=1/0,s=1/0,d=1/0,p=-1/0,f=-1/0,m=-1/0;for(let e=3*t,a=3*(t+l[h+14]);e<a;e++){const t=n[e]*u+o,a=i[t+0],l=i[t+1],c=i[t+2];a<r&&(r=a),a>p&&(p=a),l<s&&(s=l),l>f&&(f=l),c<d&&(d=c),c>m&&(m=c)}return(c[e+0]!==r||c[e+1]!==s||c[e+2]!==d||c[e+3]!==p||c[e+4]!==f||c[e+5]!==m)&&(c[e+0]=r,c[e+1]=s,c[e+2]=d,c[e+3]=p,c[e+4]=f,c[e+5]=m,!0)}{const n=e+8,i=a[e+6],o=n+r,l=i+r;let u=s,h=!1,d=!1;t?u||(h=t.has(o),d=t.has(l),u=!h&&!d):(h=!0,d=!0);const f=u||d;let m=!1;(u||h)&&(m=p(n,r,u));let g=!1;f&&(g=p(i,r,u));const y=m||g;if(y)for(let t=0;t<3;t++){const r=n+t,o=i+t,s=c[r],a=c[r+3],l=c[o],u=c[o+3];c[e+t]=s<l?s:l,c[e+t+3]=a>u?a:u}return y}}}traverse(t,e=0){const n=this._roots[e],r=new Uint32Array(n),i=new Uint16Array(n);!function e(o,s=0){const a=2*o,l=i[a+15]===bA;if(l){const e=r[o+6],c=i[a+14];t(s,l,new Float32Array(n,4*o,6),e,c)}else{const i=o+8,a=r[o+6],c=r[o+7];t(s,l,new Float32Array(n,4*o,6),c)||(e(i,s+1),e(a,s+1))}}(0)}raycast(t,e=$n){const n=this._roots,r=this.geometry,i=[],o=e.isMaterial,s=Array.isArray(e),a=r.groups,l=o?e.side:e;for(let o=0,c=n.length;o<c;o++){const c=s?e[a[o].materialIndex].side:l,u=i.length;if(gR(n[o]),sR(0,r,c,t,i),yR(),s){const t=a[o].materialIndex;for(let e=u,n=i.length;e<n;e++)i[e].face.materialIndex=t}}return i}raycastFirst(t,e=$n){const n=this._roots,r=this.geometry,i=e.isMaterial,o=Array.isArray(e);let s=null;const a=r.groups,l=i?e.side:e;for(let i=0,c=n.length;i<c;i++){const c=o?e[a[i].materialIndex].side:l;gR(n[i]);const u=aR(0,r,c,t);yR(),null!=u&&(null==s||u.distance<s.distance)&&(s=u,o&&(u.face.materialIndex=a[i].materialIndex))}return s}intersectsGeometry(t,e){const n=this.geometry;let r=!1;for(const i of this._roots)if(gR(i),r=cR(0,n,t,e),yR(),r)break;return r}shapecast(t,e,n){const r=this.geometry;if(t instanceof Function){if(e){const t=e;e=(e,n,r,i)=>{const o=3*n;return t(e,o,o+1,o+2,r,i)}}t={boundsTraverseOrder:n,intersectsBounds:t,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}const i=CR.getPrimitive();let{boundsTraverseOrder:o,intersectsBounds:s,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){const t=a;a=(e,n,o,s,a)=>!!t(e,n,o,s,a)||JA(e,n,r,l,o,s,i)}else a||(a=l?(t,e,n,o)=>JA(t,e,r,l,n,o,i):(t,e,n)=>n);let c=!1,u=0;for(const t of this._roots){if(gR(t),c=lR(0,r,s,a,o,u),yR(),c)break;u+=t.byteLength}return CR.releasePrimitive(i),c}bvhcast(t,e,n){let{intersectsRanges:r,intersectsTriangles:i}=n;const o=this.geometry.index,s=this.geometry.attributes.position,a=t.geometry.index,l=t.geometry.attributes.position;bR.copy(e).invert();const c=CR.getPrimitive(),u=CR.getPrimitive();if(i){function t(t,n,r,h,d,p,f,m){for(let g=r,y=r+h;g<y;g++){YA(u,3*g,a,l),u.a.applyMatrix4(e),u.b.applyMatrix4(e),u.c.applyMatrix4(e),u.needsUpdate=!0;for(let e=t,r=t+n;e<r;e++)if(YA(c,3*e,o,s),c.needsUpdate=!0,i(c,u,e,g,d,p,f,m))return!0}return!1}if(r){const e=r;r=function(n,r,i,o,s,a,l,c){return!!e(n,r,i,o,s,a,l,c)||t(n,r,i,o,s,a,l,c)}}else r=t}this.getBoundingBox(wR),wR.applyMatrix4(e);const h=this.shapecast({intersectsBounds:t=>wR.intersectsBox(t),intersectsRange:(e,n,i,o,s,a)=>(_R.copy(a),_R.applyMatrix4(bR),t.shapecast({intersectsBounds:t=>_R.intersectsBox(t),intersectsRange:(t,i,a,l,c)=>r(e,n,t,i,o,s,l,c)}))});return CR.releasePrimitive(c),CR.releasePrimitive(u),h}intersectsBox(t,e){return xR.set(t.min,t.max,e),xR.needsUpdate=!0,this.shapecast({intersectsBounds:t=>xR.intersectsBox(t),intersectsTriangle:t=>xR.intersectsTriangle(t)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,n={},r={},i=0,o=1/0){t.boundingBox||t.computeBoundingBox(),xR.set(t.boundingBox.min,t.boundingBox.max,e),xR.needsUpdate=!0;const s=this.geometry,a=s.attributes.position,l=s.index,c=t.attributes.position,u=t.index,h=CR.getPrimitive(),d=CR.getPrimitive();let p=MR,f=TR,m=null,g=null;r&&(m=AR,g=RR);let y=1/0,v=null,_=null;return bR.copy(e).invert(),ER.matrix.copy(bR),this.shapecast({boundsTraverseOrder:t=>xR.distanceToBox(t,Math.min(y,o)),intersectsBounds:(t,e,n)=>n<y&&n<o&&(e&&(ER.min.copy(t.min),ER.max.copy(t.max),ER.needsUpdate=!0),!0),intersectsRange:(n,r)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:t=>ER.distanceToBox(t,Math.min(y,o)),intersectsBounds:(t,e,n)=>n<y&&n<o,intersectsRange:(t,o)=>{for(let s=3*t,w=3*(t+o);s<w;s+=3){YA(d,s,u,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let t=3*n,e=3*(n+r);t<e;t+=3){YA(h,t,l,a),h.needsUpdate=!0;const e=h.distanceToTriangle(d,p,m);if(e<y&&(f.copy(p),g&&g.copy(m),y=e,v=t/3,_=s/3),e<i)return!0}}}});for(let t=0,o=u?u.count:c.count;t<o;t+=3){YA(d,t,u,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let e=3*n,o=3*(n+r);e<o;e+=3){YA(h,e,l,a),h.needsUpdate=!0;const n=h.distanceToTriangle(d,p,m);if(n<y&&(f.copy(p),g&&g.copy(m),y=n,v=e/3,_=t/3),n<i)return!0}}}}),CR.releasePrimitive(h),CR.releasePrimitive(d),y===1/0?null:(n.point?n.point.copy(f):n.point=f.clone(),n.distance=y,n.faceIndex=v,r&&(r.point?r.point.copy(g):r.point=g.clone(),r.point.applyMatrix4(bR),f.applyMatrix4(bR),r.distance=f.sub(r.point).length(),r.faceIndex=_),n)}closestPointToPoint(t,e={},n=0,r=1/0){const i=n*n,o=r*r;let s=1/0,a=null;if(this.shapecast({boundsTraverseOrder:e=>(SR.copy(t).clamp(e.min,e.max),SR.distanceToSquared(t)),intersectsBounds:(t,e,n)=>n<s&&n<o,intersectsTriangle:(e,n)=>{e.closestPointToPoint(t,SR);const r=t.distanceToSquared(SR);return r<s&&(MR.copy(SR),s=r,a=n),r<i}}),s===1/0)return null;const l=Math.sqrt(s);return e.point?e.point.copy(MR):e.point=MR.clone(),e.distance=l,e.faceIndex=a,e}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach((e=>{SA(0,new Float32Array(e),LR),t.union(LR)})),t}}const IR=PR.prototype.raycast;PR.prototype.raycast=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');const[e,n,r,i]=t;return IR.call(this,r,e.material).forEach((t=>{(t=XA(t,e,n))&&i.push(t)})),i}return IR.apply(this,t)};const OR=PR.prototype.raycastFirst;PR.prototype.raycastFirst=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');const[e,n,r]=t;return XA(OR.call(this,r,e.material),e,n)}return OR.apply(this,t)};const NR=PR.prototype.closestPointToPoint;PR.prototype.closestPointToPoint=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),t.unshift();const e=t[1],n={};return t[1]=n,NR.apply(this,t),e&&e.copy(n.point),n.distance}return NR.apply(this,t)};const kR=PR.prototype.closestPointToGeometry;PR.prototype.closestPointToGeometry=function(...t){const e=t[2],n=t[3];if(e&&e.isVector3||n&&n.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');const r={},i={},o=t[1];return t[2]=r,t[3]=i,kR.apply(this,t),e&&e.copy(r.point),n&&n.copy(i.point).applyMatrix4(o),r.distance}return kR.apply(this,t)};const DR=PR.prototype.refit;var BR,UR;PR.prototype.refit=function(...t){const e=t[0],n=t[1];if(n&&(n instanceof Set||Array.isArray(n))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');const t=new Set;n.forEach((e=>t.add(e))),e&&e.forEach((e=>t.add(e))),DR.call(this,t)}else DR.apply(this,t)},["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach((t=>{const e=PR.prototype[t];PR.prototype[t]=function(...n){return(null===n[0]||n[0].isMesh)&&(n.shift(),console.warn(`MeshBVH: The function signature for "${t}" has changed and no longer takes Mesh. See docs for new signature.`)),e.apply(this,n)}}));const zR=()=>{if(BR){const e=[];var t=[];if(FP.children.forEach((e=>{e.children.forEach((e=>{if(e.material===Px.whiteFull){e.updateMatrixWorld(!0);var n=e.geometry.clone();n.applyMatrix4(e.matrixWorld);for(const t in n.attributes)"position"!==t&&n.deleteAttribute(t);n.index&&(n=n.toNonIndexed()),n.userData.groupMerged=!0,t.push(n)}}))})),t.length>0){const n=dx(t,!1);n.userData.groupMerged=!0,e.push(n)}e.push(UR.geometry),e.forEach((t=>{for(const e in t.attributes)"position"!==e&&t.deleteAttribute(e);t.index=null}));const n=dx(e,!1);n.boundsTree=new PR(n,{lazyGeneration:!0}),(BR=new kl(n,Px.whiteFull)).name="collider",BR.visible=!1}},FR={},HR={};(()=>{const t=[];[[1,1],[1,2],[1,3],[1,4],[1,6],[1,8],[1,10],[1,12],[1,16],[2,2],[2,3],[2,4],[2,6],[2,8],[2,10]].forEach((e=>{const n=`B${e[0]}x${e[1]}`;FR[n]={geometry:{type:"BoxGeometry",args:[e[0],e[1],1.25]},name:n,lines:!0,hatch:!0};var r=document.createElement("div");r.innerText=n,r.style=`width:${20*e[0]}px;height:${20*e[1]}px;padding:5px;border:1px solid black;margin:10px`,r.addEventListener("click",(()=>{GR([FR[n]]),sP()})),t.push(r)})),HR.Blocks=t})(),(()=>{const t=[];for(let n=1;n<=10;n+=1){const r=`T${n}x${n}`;FR[r]={geometry:{type:"BoxGeometry",args:[n,n,.1]},name:r,lines:!0,hatch:!0},(e=document.createElement("div")).innerText=r,e.style=`width:${20*n}px;height:${20*n}px;padding:5px;border:1px solid black;margin:10px`,e.addEventListener("click",(()=>{GR([FR[r]]),sP()})),t.push(e)}for(let n=1;n<=12;n+=1){const r=`T1x${n}`;FR[r]={geometry:{type:"BoxGeometry",args:[n,1,.1]},name:r,lines:!0,hatch:!0},(e=document.createElement("div")).innerText=r,e.style=`width:${20*n}px;height:20px;padding:5px;border:1px solid black;margin:10px`,e.addEventListener("click",(()=>{GR([FR[r]]),sP()})),t.push(e)}for(let n=1;n<=16;n+=1){const r=`T2x${n}`;var e;FR[r]={geometry:{type:"BoxGeometry",args:[n,2,.1]},name:r,lines:!0,hatch:!0},(e=document.createElement("div")).innerText=r,e.style=`width:${20*n}px;height:40px;padding:5px;border:1px solid black;margin:10px`,e.addEventListener("click",(()=>{GR([FR[r]]),sP()})),t.push(e)}[6,8,10,12].forEach((e=>{const n=`T4x${e}`;FR[n]={geometry:{type:"BoxGeometry",args:[e,4,.1]},name:n,lines:!0,hatch:!0};var r=document.createElement("div");r.innerText=n,r.style=`width:${20*e}px;height:80px;padding:5px;border:1px solid black;margin:10px`,r.addEventListener("click",(()=>{GR([FR[n]]),sP()})),t.push(r)})),[8,10,12,14,16].forEach((e=>{const n=`T6x${e}`;FR[n]={geometry:{type:"BoxGeometry",args:[e,6,.1]},name:n,lines:!0,hatch:!0};var r=document.createElement("div");r.innerText=n,r.style=`width:${20*e}px;height:120px;padding:5px;border:1px solid black;margin:10px`,r.addEventListener("click",(()=>{GR([FR[n]]),sP()})),t.push(r)})),HR.Tiles=t})();const GR=e=>{const n=new kh;n.position.y+=.5,n.position.z-=4,e.forEach((e=>{const r=new t[e.geometry.type](...e.geometry.args),i=new kl(r,Px.ghost),o=new lp(r),s=new Fd(o,Px.blackLineLone);e.tokenType="block",n.userData=e,n.add(i,s)})),HP.add(n)},VR={metadata:"https://broadcast.modular-station.com/api/live/nowplaying/modular_station",stream:"https://broadcast.modular-station.com/radio/8000/radio.aac"},jR=new Audio,WR=document.getElementById("audio-radio");WR.addEventListener("touchstart",(()=>{WR.style.display="none"}));const qR=document.getElementById("radio-name"),KR=document.getElementById("track-name"),XR=document.getElementById("radio-play");var YR=!1;XR.addEventListener("click",(()=>{YR?(jR.pause(),YR=!1,XR.innerHTML='<img  style="width:15px;height:15px" src="play.svg">'):(jR.play(),YR=!0,XR.innerHTML='<img  style="width:15px;height:15px" src="stop.svg">')}));const JR=t=>{fetch(t.metadata).then((t=>t.json())).then((e=>{qR.innerText=e.station.name+" - ",KR.innerText=" "+e.now_playing.song.text,t.src!=t.stream&&(YR||(jR.src=t.stream))})).catch((t=>{}))};var ZR,QR=!1,$R=0,tL=0;const eL=window.localStorage,nL=t=>{(0,Ix.request)("https://api.fxhash.xyz/graphql","query checkRoom($objktId: Float) {\n        room:objkt(id: $objktId) {\n          metadata\n          owner {\n            id\n            name\n          }\n          issuer {\n            author {\n              id\n              name\n            }\n          }\n        }\n      }",{objktId:parseInt(t.room)}).then((e=>{SL(),tL=0,GL.gallery=[],t.gallery.forEach((t=>{"block"!=t.tokenType&&"sculpture"!=t.tokenType&&tL++})),t.hasOwnProperty("DOMthumb")&&(document.querySelector('meta[name="og:image"]').setAttribute("content",t.DOMthumb.src),document.querySelector('meta[name="twitter:image"]').setAttribute("content",t.DOMthumb.src)),JP(!0);var n=e.room;FP.clear(),n.issuer.author.id;var r="";n.owner.name&&(r=n.owner.name.toUpperCase()+"'S "),n.metadata.hasOwnProperty("attributes")&&Array.isArray(n.metadata.attributes)&&n.metadata.attributes.forEach((t=>{"name"===t.name.toLowerCase()&&(r+=t.value)}));var i=n.metadata.artifactUri.slice(7,n.metadata.artifactUri.indexOf("?fxhash="));n.type="world",n.tag={room:!0},n.figuresUrl="https://gateway.fxhash.xyz/ipfs/"+i+"/figures.js",JL(n,t.room,n.metadata.iterationHash,r),kx("Gallery room retrieval","🟢"),rL(t),t.hasOwnProperty("collection")&&t.collection&&($R=t.collection,Ux([t.collection]).then((()=>{$R=Bx[t.collection].alias})).catch((t=>{console.log(t)})))})).catch((t=>{console.log(t),kx("Gallery room retrieval","🔴")}))},rL=t=>{(0,Ix.request)("https://api.fxhash.xyz/graphql","query checkRoom($objktId: Float) {\n      skybox:objkt(id: $objktId) {\n          metadata\n          owner {\n            id\n            name\n          }\n          issuer {\n            author {\n              id\n              name\n            }\n          }\n        }\n      }",{objktId:parseInt(t.skybox)}).then((e=>{var n=e.skybox;if(e.skybox){n.issuer.author.id;{var r="https://gateway.fxhash.xyz/ipfs/"+n.metadata.artifactUri.slice(7,n.metadata.artifactUri.indexOf("?fxhash="))+"/skybox.js",i=1.75*window.innerHeight;const t=n.metadata.iterationHash;jL.postMessage({side:i,skyurl:r,hash:t})}}t.gallery.length>0&&iL(t),kx("Gallery skybox retrieval","🟢")})).catch((e=>{kx("Gallery skybox retrieval","🔴"),t.gallery.length>0&&iL(t)}))},iL=e=>{const n={objkt:[],openSea:[],block:[],sculpture:[]};e.gallery.forEach((t=>n[t.tokenType].push(t))),n.objkt.length>0&&(t=>{const e={};var n=0;t.forEach((t=>{if(n++,"number"==typeof t.objktMetaData.token_id&&(t.objktMetaData.token_id=JSON.stringify(t.objktMetaData.token_id)),n<500){var r=t.objktMetaData.contract+t.objktMetaData.token_id;e.hasOwnProperty(r)||(e[r]=`{\n          token_id: { _eq: ${JSON.stringify(t.objktMetaData.token_id)} },\n          fa_contract: { _eq: ${JSON.stringify(t.objktMetaData.contract)} },\n        }`)}}));const r=[];for(const t in e)r.push(e[t]);const i=`query{\n    token(where: {_or:[${r}]}) {\n      description\n      display_uri\n      metadata\n      mime\n      name\n      thumbnail_uri\n      timestamp\n      creators{\n        creator_address\n      }\n      fa{\n        contract\n      }\n      token_id\n    }\n  }`;(0,Ix.request)("https://data.objkt.com/v3/graphql",i).then((e=>{var n=[];t.forEach((t=>{e.token.forEach((e=>{if(e.fa.contract===t.objktMetaData.contract&&e.token_id===t.objktMetaData.token_id)if(e.hasOwnProperty("creators")&&e.creators[0]&&n.push(e.creators[0].creator_address),e.display_uri){const n="https://assets.objkt.media/file/assets-003/"+e.display_uri.replace("ipfs://","")+"/display",r={position:t.position,rotation:t.rotation,scale:t.scale},i="https://objkt.com/asset/"+e.fa.contract+"/"+e.token_id;e.url=i,"Versum Items"===e.fa.name&&(e.url="https://versum.xyz/token/versum/"+e.token_id);const o=e.fa.contract+JSON.stringify(e.token_id);yL[o]=e,yx(n,{id:o},"objkt",r)}else console.log("%c [objkt.com] The token ["+e.name+"] was minted without a proper metadata capture.","font-weight:bold;")}))})),Ux(n)})).catch((t=>{console.log(t)}))})(n.objkt),n.block.length>0&&(e=>{e.forEach((e=>{var n=new kh;const r=new t[e.block.geometry.type](...e.block.geometry.args),i=new kl(r,Px.whiteFull),o=new lp(r),s=new Fd(o,Px.blackLineLone);n.add(i,s),n.position.set(PL(e.position.x),PL(e.position.y),PL(e.position.z)),n.rotation.set(PL(e.rotation.x),PL(e.rotation.y),PL(e.rotation.z)),n.scale.set(PL(e.scale.x),PL(e.scale.y),PL(e.scale.z)),FP.attach(n),zR()}))})(n.block),n.sculpture.length>0&&oL(n.sculpture);for(let t=0;t<n.openSea.length;t++)setTimeout((()=>{var e;e=n.openSea[t],fetch(`https://api.opensea.io/api/v1/asset/${e.openSeaMetaData.asset_contract_address}/${e.openSeaMetaData.token_id}/?include_orders=false`,{method:"GET"}).then((t=>t.json())).then((t=>{const n=t.image_url;yL[t.id]=t;const r={position:e.position,rotation:e.rotation,scale:e.scale};var i={id:t.id,objkt:{asset_contract:{address:""},token_id:""}};i.objkt.asset_contract.address=e.openSeaMetaData.asset_contract_address,i.objkt.token_id=e.openSeaMetaData.token_id,yx(n,i,"openSea",r)})).catch((t=>console.error(t)))}),600*t);if(e.hasOwnProperty("audioguide")){r="https://assets.objkt.media/file/assets-003/"+e.artifact.replace("ipfs://","")+"/artifact/"+e.audioguide.mainTrack,i=e.name,jR.pause(),clearInterval(ZR),jR.src=r,qR.innerText=i,KR.innerText="Gallery audioguide",QR=!0,setTimeout((()=>{YR=!0,XR.innerHTML='<img  style="width:15px;height:15px" src="stop.svg">',jR.play().catch((t=>{YR=!1,XR.innerHTML='<img  style="width:15px;height:15px" src="play.svg">'}))}),1500)}var r,i},oL=t=>{t.forEach((t=>{(0,Ix.request)("https://api.fxhash.xyz/graphql",`query {\n        objkt(id: ${t.fxMetaData.objktid}) {\n          metadata\n          owner {\n            id\n            name\n          }\n          issuer {\n            author {\n              id\n              name\n            }\n          }\n        }\n      }`).then((e=>{const n=e.objkt;n.type="world",n.tag={world:!0,item:!0};var r=n.metadata.artifactUri.slice(7,n.metadata.artifactUri.indexOf("?fxhash="));n.figuresUrl="https://gateway.fxhash.xyz/ipfs/"+r+"/figures.js";const i={position:t.position,rotation:t.rotation,scale:t.scale};JL(n,t.fxMetaData.objktid,n.metadata.iterationHash,n.metadata.name,i)}))}))},sL={room:540571,skybox:527345,gallery:[{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"2"},position:{x:"-30.0000",y:"1.5000",z:"2.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"3"},position:{x:"-30.0000",y:"1.5000",z:"-1.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"1"},position:{x:"-32.0000",y:"8.5000",z:"0.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"3.8000",y:"3.8000",z:"3.8000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"4"},position:{x:"-30.0000",y:"1.5000",z:"-4.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"0"},position:{x:"-30.0000",y:"1.5000",z:"5.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"1.0000",y:"1.0000",z:"1.0000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"5"},position:{x:"-19.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"6"},position:{x:"-15.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"7"},position:{x:"-11.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1D868VUoMPJpvRqsP9aLpFAne16bT1nL3g",token_id:"8"},position:{x:"-7.0000",y:"1.5000",z:"-27.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"1.4000",y:"1.4000",z:"1.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"27435"},position:{x:"-42.0000",y:"8.5000",z:"38.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"3.1000",y:"3.1000",z:"3.1000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"1043411"},position:{x:"38.0000",y:"15.5000",z:"0.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"2.6000",y:"2.6000",z:"2.6000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1CUPoajzwiYQN8gfueuktNbAQS5jJ4Jf7V",token_id:"6"},position:{x:"0.0000",y:"5.5000",z:"-85.0000"},rotation:{x:"0.0000",y:"0.0000",z:"0.0000"},scale:{x:"6.4000",y:"6.4000",z:"6.4000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"926697"},position:{x:"-90.0025",y:"1.4774",z:"36.0496"},rotation:{x:"-2.7139",y:"1.5572",z:"2.7139"},scale:{x:"2.1000",y:"2.1000",z:"2.1000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW",token_id:"25128"},position:{x:"-71.0000",y:"15.5000",z:"-60.0000"},rotation:{x:"0.0000",y:"1.5708",z:"0.0000"},scale:{x:"2.9000",y:"2.9000",z:"2.9000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi",token_id:"669579"},position:{x:"110.0000",y:"32.5000",z:"-9.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"1.5000",y:"1.5000",z:"1.5000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1C3dCG9XMnP7iT7tUDs55ebr43wfF3TV7k",token_id:"0"},position:{x:"116.0000",y:"7.5000",z:"-29.0000"},rotation:{x:"0.0000",y:"-1.5708",z:"0.0000"},scale:{x:"6.8000",y:"6.8000",z:"6.8000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1RncKS9P56FhSDradukH9SjMSobqE8zpLV",token_id:"1"},position:{x:"97.0000",y:"15.5000",z:"38.0000"},rotation:{x:"-3.1416",y:"0.0000",z:"-3.1416"},scale:{x:"3.9000",y:"3.9000",z:"3.9000"}},{tokenType:"objkt",objktMetaData:{contract:"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE",token_id:"541252"},position:{x:"-3.3699",y:"15.4139",z:"103.5790"},rotation:{x:"-3.0723",y:"1.1603",z:"3.0780"},scale:{x:"2.6000",y:"2.6000",z:"2.6000"}}],name:"ANAVER.SE TUTORIAL",collection:"tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"};var aL=!1;const lL=window.localStorage,cL=()=>{aL=!0,setTimeout((()=>{lL.setItem("finishedTutorial",!0)}),18e4,5)},uL={},hL={getUserTokens:Ix.gql`
    query UserCollection(
      $id: String!
      $take: Int
      $skip: Int
      $sort: ObjktsSortInput
      $filters: ObjktFilter
    ) {
      user(id: $id) {
        id
        name
        objkts(take: $take, skip: $skip, sort: $sort, filters: $filters) {
          id
          slug
          metadata
          createdAt
          __typename
        }
        __typename
      }
    }
  `,generateGallery:Ix.gql`
    query generateGallery($generativeTokenId: Float) {
      generativeToken(id: $generativeTokenId) {
        entireCollection {
          metadata
          owner {
            name
          }
          id
          generationHash
        }
        author {
          id
        }
      }
    }
  `,getAllTokens:Ix.gql`
    {
      user(id: "tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9") {
        generativeTokens(take: 50) {
          id
          name
          balance
          slug
          tags
          metadata
          author {
            id
          }
        }
      }
    }
  `},dL=()=>{const t={room:[],fp:[],sky:[]};for(const e in uL)uL[e].tag.hasOwnProperty("room")&&t.room.push(uL[e]),uL[e].tag.hasOwnProperty("skybox")&&t.sky.push(uL[e]);if(t.room.length>0){const n=t.room[parseInt(Math.random()*t.room.length)];e["Choix aléatoire"].fin=performance.now(),JL(n,0,eA(),"")}t.sky.length>0&&t.sky.forEach((t=>{9574===t.id&&JL(t,0,eA(),"",!0,!1)}))},pL=()=>{const t=document.getElementsByClassName("galleryFilterCheckbox"),e=[];var n,r=document.getElementsByClassName("gentkCell");for(let n=0;n<t.length;n++)t[n].checked&&e.push(t[n]["data-name"]);if(e.length>0){n=t[0]["data-name"].slug;for(let t=0;t<r.length;t++)r[t].style.display="none"}else for(let t=0;t<r.length;t++)r[t].style.display="inline-block";var i={};uL[n].collection.forEach((t=>i[t.completeName]={})),e.forEach((t=>{"Owner"===t.feature?uL[n].collection.forEach((e=>{e.owner.name===t.key&&(document.getElementById(e.completeName).style.display="inline-block")})):uL[n].collection.forEach((e=>{e.metadata.attributes.forEach((n=>{n.name===t.feature&&("string"==typeof n.value?n.value:JSON.stringify(n.value))===t.key&&Array.isArray(e.metadata.attributes)&&e.metadata.attributes.forEach((t=>{"Name"!==t.name&&"name"!==t.name||(document.getElementById(e.completeName).style.display="inline-block")}))}))}))}))},fL=t=>{t.DOMelements.gallery.length>0?rP(t):(t=>{eP(t),(0,Ix.request)("https://api.fxhash.xyz/graphql",hL.generateGallery,{generativeTokenId:t.id}).then((e=>{t.collection=e.generativeToken.entireCollection,t.collection.forEach((e=>((t,e)=>{const n=e.generationHash,r=e.id,i=document.createElement("li");i.className="gentkCell";const o=document.createElement("div");var s="";e.owner.name&&(s=e.owner.name.toUpperCase()+"'S "),o.className="iterNameDiv",e.metadata.hasOwnProperty("attributes")&&Array.isArray(e.metadata.attributes)&&e.metadata.attributes.forEach((t=>{"name"===t.name.toLowerCase()&&(s+=t.value)}));const a="<div style='font-size:10px'>Check gentk on <a target='_blank' href='https://www.fxhash.xyz/gentk/slug/"+t.slug+"-"+e.metadata.name.slice(e.metadata.name.lastIndexOf("#")+1)+"'>fxhash</a></div>";var l="<div style='font-size:10px;font-style: italic;' id='"+(t.slug+e.metadata.iterationHash)+"'></div>";o.innerHTML=s+"<br>"+a+l,e.completeName=s;const c=new Image;c.className="thumbnail",c.src="https://gateway.fxhash.xyz/ipfs/"+e.metadata.thumbnailUri.replace("ipfs://",""),c.onerror=t=>{c.src="/notfound.png"},c.style.cursor="pointer",c.addEventListener("click",(()=>{sP(),JL(t,r,n,s)})),i.id=s,i.appendChild(c),i.appendChild(o),t.DOMelements.gallery.push(i),((t,e,n)=>{t.hasOwnProperty("filters")||(t.filters={}),e&&(t.filters.hasOwnProperty("Owner")?t.filters.Owner.hasOwnProperty(e)?t.filters.Owner[e]++:t.filters.Owner[e]=1:t.filters.Owner={}),n&&n.length>0&&n.forEach((e=>{t.filters.hasOwnProperty(e.name)?t.filters[e.name].hasOwnProperty(e.value)?t.filters[e.name][e.value]++:t.filters[e.name][e.value]=1:t.filters[e.name]={}}))})(t,e.owner.name,e.metadata.attributes)})(t,e))),(t=>{const e=[],n=t.slug;for(const i in t.filters){var r=document.createElement("div");r.innerHTML="<hr>"+i+" ("+Object.keys(t.filters[i]).length+")",r.style.cursor="pointer";const o=document.createElement("ul");o.style.display="none",o.style.listStyle="none";for(const e in t.filters[i]){const r=document.createElement("li"),s=document.createElement("input");s.type="checkbox",s.className="galleryFilterCheckbox",s["data-name"]={feature:i,key:e,slug:n},s.name=e+" ("+t.filters[i][e]+")";const a=document.createElement("label");a.innerText=e+" ("+t.filters[i][e]+")",a.for=e+" ("+t.filters[i][e]+")",s.addEventListener("change",pL),r.appendChild(s),r.appendChild(a),o.appendChild(r)}r.addEventListener("click",(()=>{"none"===o.style.display?o.style.display="block":o.style.display="none"})),e.push(r,o)}t.DOMelements.filters=e})(t),rP(t)}))})(t)},mL={},gL=[],yL={};var vL=[];const _L=()=>vL=[],wL=t=>{qx(t),Yx(0,t),(t=>{(0,Ix.request)("https://api.fxhash.xyz/graphql",zx,{userId:t,take:50}).then((t=>{t.user.generativeTokens.forEach((t=>{t.fa={},t.fa.contract=t.id<=10964?"KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE":"KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi";const e=document.createElement("div");e.className="gentkProfiles";const n=new Image;n.className="thumbnail",n.src="https://gateway.fxhash.xyz/ipfs/"+t.thumbnailUri.replace("ipfs://",""),n.style.cursor="pointer",n.addEventListener("click",(()=>{var e;document.getElementById("galleryMainWindow").innerHTML="Loading collection...",e=t,(0,Ix.request)("https://api.fxhash.xyz/graphql",Hx,{generativeTokenId:e.id}).then((t=>{var n=[];t.generativeToken.entireCollection.forEach((t=>{const r=t.id;t.fa={contract:e.fa.contract},t.token_id=r;const i=document.createElement("li");i.className="gentkCell";const o=document.createElement("div");var s=t.metadata.name;o.className="thumbTitle";const a=new Image;a.className="thumbnail",a.src="https://gateway.fxhash.xyz/ipfs/"+t.metadata.thumbnailUri.replace("ipfs://",""),a.style.cursor="pointer",o.innerHTML=s,a.addEventListener("click",(()=>{yL[JSON.stringify(t.id)]=t;const e="https://gateway.fxhash.xyz/ipfs/"+t.metadata.displayUri.replace("ipfs://","");sP(),yx(e,{id:r},"objkt")})),i.appendChild(a),i.appendChild(o),n.push(i)})),e.DOMelements={gallery:n},rP(e)}))})),n&&e.appendChild(n);const r=document.createElement("div");r.className="artThumbTitle";const i=document.createElement("div");i.className="artistNames",i.innerText=t.name,r.appendChild(i),e.appendChild(r),Xx.push(e)}))}))})(t),t&&(0,Ix.request)("https://api.fxhash.xyz/graphql",hL.getUserTokens,{id:t,take:50,skip:0,filters:{searchQuery_eq:"anaverse anaglyphic"}}).then((t=>{if(t.user){var e="";t.user.name&&(e=t.user.name,document.title=e.toUpperCase()+"'S ANAVER.SE"),t.user.objkts.forEach((t=>{t.metadata.hasOwnProperty("tags")&&t.metadata.tags.forEach((e=>{"anaverse"===e&&(mL[t.slug]=t),"skybox"===e&&(mL[t.slug].type="skybox")}))}));for(const t in mL){const e=mL[t];e.generatorSlug=e.slug.substring(0,e.slug.lastIndexOf("-")),uL.hasOwnProperty(e.generatorSlug)&&(e.generatorID=uL[e.generatorSlug].id)}((t,e,n,r)=>{for(const r in t){const a=t[r],l=a.hasOwnProperty("fa")?a.fa.contract+a.token_id:a.id,c=document.createElement("li");c.className="gentkCell",c.style.marginTop="10px";const u=document.createElement("div");var i="";u.className="thumbTitle";const h=new Image;var o;h.className="thumbnail",a.hasOwnProperty("metadata")&&(a.metadata.hasOwnProperty("attributes")&&Array.isArray(a.metadata.attributes)&&a.metadata.attributes.forEach((t=>{"name"===t.name.toLowerCase()&&(i=n.toUpperCase()+"'s "+t.value)})),h.src="https://gateway.fxhash.xyz/ipfs/"+a.metadata.thumbnailUri.replace("ipfs://",""),h.style.cursor="pointer",a.metadata.displayUri.replace("ipfs://","")),""===i&&(i=a.metadata.name),a.hasOwnProperty("name")&&(i=n.toUpperCase()+"'s "+a.name,o="https://objkt.com/asset/"+a.fa.contract+"/"+a.token_id,a.url=o,"fxhash: Genesis"===a.fa.name?(h.src="https://gateway.fxhash.xyz/ipfs/"+a.thumbnail_uri.replace("ipfs://",""),h.onerror=t=>{h.src="/notfound.png"},h.style.cursor="pointer"):"Versum Items"===a.fa.name?o="https://versum.xyz/token/versum/"+a.token_id:a.thumbnail_uri&&(h.src="https://cloudflare-ipfs.com/ipfs/"+a.thumbnail_uri.replace("ipfs://",""),h.onerror=t=>{h.src="/notfound.png"}),h.style.cursor="pointer");var s="<div style='font-size:10px'>Check token on <a target='_blank' href='"+o+"'>OBJKT</a> </div>";a.hasOwnProperty("generatorID")&&(s="<div style='font-size:10px'>Check token on <a target='_blank' href='"+(o="https://www.fxhash.xyz/gentk/"+a.id)+"'>fx(hash)</a> </div>"),a.slug,a.metadata.iterationHash,u.innerHTML=i+"<br>"+s,a.completeName=i;const d=()=>{sP(),JL(uL[r.slice(0,r.lastIndexOf("-"))],l,a.metadata.iterationHash,t[r].completeName)};h.addEventListener("click",d),c.appendChild(h),c.appendChild(u),e.push(c)}})(mL,gL,e),kx("personal native anaver.se tokens retrieval","🟢")}})).catch((t=>{kx("personal native anaver.se tokens retrieval","🔴"),console.log("Error : the request to retrieve your native anaver.se tokens failed"),console.log(t)}))},bL=t=>{if(xL.innerHTML="",t){var e=.05*window.innerWidth;let n=e,r=e,i="multiply";const o=zn("svg").attr("width",n*t.length).attr("height",r).attr("viewBox",`0 0 ${n*t.length} ${r}`).attr("xmlns","http://www.w3.org/2000/svg").style("cursor","pointer");o.append("text").attr("font-family","sans-serif").attr("x",n*t.length*.5+.1*n).attr("y",.95*r).attr("fill","rgb(0,255,235)").attr("font-size",1.2*n).attr("font-weight","bolder").attr("text-anchor","middle").style("mix-blend-mode",i).text(t),o.append("text").attr("font-family","sans-serif").attr("x",n*t.length*.5+.05*n).attr("y",.95*r).attr("fill","rgb(255,0,0)").attr("font-size",1.2*n).attr("font-weight","bolder").attr("text-anchor","middle").style("mix-blend-mode",i).text(t),xL.style.left=window.innerWidth/2-n*t.length/2+"px",xL.style.top=window.innerHeight/2-e/2+"px",xL.appendChild(o.node())}},xL=document.getElementById("info");var EL=0,SL=()=>EL=0,ML=2.5,TL=new rc(ML,ML),AL=new Bl(2.6,2.6,.05),RL=new lp(new Bl(2.65,2.65,.15)),LL=new Bl(2.65,.05,.15),CL=new Bl(.05,2.65,.15);const PL=t=>Number(t)?Number(t):Number("-"+t.substring(1));var IL;gx.onmessage=t=>{t.data[1].hasOwnProperty("id")&&((t,e,n,r)=>{EL++,bL("LOADING PIECE "+EL+(tL>0?"/"+tL:""));var i=new kh;_x(t).then((t=>{t.magFilter=$r;var o,s,a,l,c,u,h=new Ja({map:t,transparent:!0,opacity:.45});if(t.image.height===t.image.width)o=new kl(TL,h),(s=new kl(AL,Px.ghost)).position.set(0,0,-.05),(RL=new Fd(RL,Px.blackLineLone)).position.set(0,0,0),(l=new kl(LL,Px.ghost)).position.set(0,1.3,0),(a=new kl(LL,Px.ghost)).position.set(0,-1.3,0),(c=new kl(CL,Px.ghost)).position.set(-1.3,0,0),(u=new kl(CL,Px.ghost)).position.set(1.3,0,0);else if(t.image.height>t.image.width){var d=ML*(t.image.width/t.image.height);o=new kl(new rc(d,ML),h),(s=new kl(new Bl(d+.1,2.6,.05),Px.ghost)).position.set(0,0,-.05),(RL=new Fd(new lp(new Bl(d+.15,2.65,.15)),Px.blackLineLone)).position.set(0,0,0),(l=new kl(new Bl(d+.15,.05,.15),Px.ghost)).position.set(0,1.3,0),(a=new kl(new Bl(d+.15,.05,.15),Px.ghost)).position.set(0,-1.3,0),(c=new kl(CL,Px.ghost)).position.set(-(d/2+.05),0,0),(u=new kl(CL,Px.ghost)).position.set(d/2+.05,0,0)}else{var p=ML*(t.image.height/t.image.width);o=new kl(new rc(ML,p),h),(s=new kl(new Bl(2.6,p+.1,.05),Px.hatchingMaterial)).position.set(0,0,-.05),(RL=new Fd(new lp(new Bl(2.65,p+.15,.15)),Px.blackLineLone)).position.set(0,0,0),(l=new kl(LL,Px.ghost)).position.set(0,p/2+.05,0),(a=new kl(LL,Px.ghost)).position.set(0,-(p/2+.05),0),(c=new kl(new Bl(.05,p+.15,.15),Px.ghost)).position.set(-1.3,0,0),(u=new kl(new Bl(.05,p+.15,.15),Px.ghost)).position.set(1.3,0,0)}switch(o.position.set(0,0,0),i.add(s,l,a,c,u,o),i.position.z=-4,o.userData.isWorldItem=!0,e&&(o.userData.objktID=e.id),i.position.y+=.5,e&&(i.userData.tokenType=n,i.userData.id=e.id),n){case"openSea":i.userData.openSeaMetaData={asset_contract_address:e.objkt.asset_contract.address,token_id:e.objkt.token_id};break;case"objkt":i.userData.objktMetaData={contract:yL[e.id].fa.contract,token_id:yL[e.id].token_id}}r?(i.children.forEach((t=>{"Mesh"===t.type&&("PlaneGeometry"===t.geometry.type?(t.material.opacity=1,t.material.transparent=!1):t.material=Px.whiteFull)})),i.position.set(PL(r.position.x),PL(r.position.y),PL(r.position.z)),i.rotation.set(PL(r.rotation.x),PL(r.rotation.y),PL(r.rotation.z)),i.scale.set(PL(r.scale.x),PL(r.scale.y),PL(r.scale.z)),FP.attach(i),zR()):HP.add(i),setTimeout((()=>{bL()}),2e3)}))})(...t.data)};var OL,NL,kL,DL,BL=0,UL=0;const zL=(t,e)=>{fx={},t.forEach((t=>mx(t.geometry))),UL=0;for(const t in fx)fx[t].forEach((t=>{if("BoxGeometry"===t.geometry.type)t.count++,aC||(t.count=Math.floor(2*t.count)),UL+=t.count,t.instanceNum=0,t.instancedMesh={isBox:!0,parameters:t.args};else if(t.count>1){t.count++,aC||(t.count=Math.floor(2*t.count+2)),t.instancedMesh=new Cd(t.geometry,Px.whiteFull,t.count),t.instancedMesh.geometry.center(),t.instancedMesh.instanceMatrix.needsUpdate=!0,t.instancedMesh.userData,e.push(t.instancedMesh),t.instanceNum=0;var n=new lp(t.instancedMesh.geometry),r=(new Mm).copy(n);r.center(),r.instanceCount=1/0;var i=aC?Px.blackLine:Px.redLine;if(i.needsUpdate=!0,t.instanceEdges=new Fd(r,i),t.instanceEdges.frustumCulled=!1,t.instanceEdges.userData.Params={pos:[],rot:[],scale:[]},!aC){var o=new lp(t.instancedMesh.geometry),s=(new Mm).copy(o);s.center(),s.instanceCount=1/0,t.instanceEdgesCyan=new Fd(s,Px.cyanLine),Px.cyanLine.needsUpdate=!0,t.instanceEdges.frustumCulled=!1,t.instanceEdges.userData.ParamsCyan={pos:[],rot:[],scale:[]}}}else t.instanceNum=-1}));if(UL>0){IL=new Cd(new Bl(1,1,1),Px.whiteFull,UL);var n=new lp(IL.geometry),r=(new Mm).copy(n);r.center(),r.instanceCount=1/0;var i,o=aC?Px.blackLine:Px.redLine;(OL=new Fd(r,o)).frustumCulled=!1,kL={pos:[],rot:[],scale:[]},aC||((i=(new Mm).copy(n)).center(),i.instanceCount=1/0,(NL=new Fd(i,Px.cyanLine)).frustumCulled=!1,DL={pos:[],rot:[],scale:[]}),BL=0}t.forEach((t=>{var n=mx(t.geometry);if(t.hasOwnProperty("parentGroup")&&(n.instanceNum=-1),t.hasOwnProperty("position")&&(t.pos=t.position),t.hasOwnProperty("rotation")&&(t.rot=t.position),t.attributes){const e=new yl;e.setAttribute("position",new $a(t.attributes.positions,3)),n.geometry=e,n.edges=new lp(e),n.instanceNum=-1}n.instanceNum>-1||"BoxGeometry"===n.geometry.type&&!t.hasOwnProperty("parentGroup")?((({pos:t,rot:e,scale:n,mesh:r,i,fig:o,lines:s,count:a})=>{r.hasOwnProperty("isBox")&&(kL.pos.push(t.x,t.y,t.z),aC||(a=UL,DL.pos.push(t.x-.35,t.y-.05,t.z+.35)),n?(n.x=n.x*r.parameters[0],n.y=n.y*r.parameters[1],n.z=n.z*r.parameters[2]):((n=new Ns(1,1,1)).x=r.parameters[0],n.y=r.parameters[1],n.z=r.parameters[2]),kL.scale.push(n.x,n.y,n.z),aC||DL.scale.push(n.x,n.y,n.z),(r=IL).isBox=!0,i=++BL);var l=new Ns(t.x,t.y,t.z);const c=new ba(0,0,0,"XYZ"),u=new Os;var h=new Ns(1,1,1);n&&(h=new Ns(n.x,n.y,n.z)),e&&c.set(e.x,e.y,e.z);const d=new ha;var p;(u.setFromEuler(c),d.compose(l,u,h),o.hatch||o.full)&&(r.setMatrixAt(i,d),o.hatch&&(r.setColorAt(i,Px.whiteColor),aC||(l.x-=.35,l.y-=.05,l.z+=.35,(p=new ha).compose(l,u,h),r.setMatrixAt(Math.floor(a/2+i),p),r.setColorAt(Math.floor(a/2+i),Px.whiteColor))),o.full&&(aC?r.setColorAt(i,Px.blackColor):(r.setColorAt(i,Px.redColor),l.x-=.35,l.y-=.05,l.z+=.35,(p=new ha).compose(l,u,h),r.setMatrixAt(a/2+i,p),r.setColorAt(a/2+i,Px.cyanColor))));r.hasOwnProperty("isBox")||(s.userData.Params.pos.push(t.x,t.y,t.z),s.userData.Params.rot.push(u.x,u.y,u.z,u.w),s.userData.Params.scale.push(h.x,h.y,h.z),aC||(s.userData.ParamsCyan.pos.push(t.x-.35,t.y-.05,t.z+.35),s.userData.ParamsCyan.rot.push(u.x,u.y,u.z,u.w),s.userData.ParamsCyan.scale.push(h.x,h.y,h.z))),r.hasOwnProperty("isBox")&&(kL.rot.push(u.x,u.y,u.z,u.w),aC||DL.rot.push(u.x,u.y,u.z,u.w))})({pos:t.pos,rot:t.rot,scale:t.scale,mesh:n.instancedMesh,i:n.instanceNum,fig:t,lines:n.instanceEdges,count:n.count}),n.instanceNum++):((t,e,n)=>{var r;(t.hatch||t.full||t.lines)&&(n&&(r=function(t,e,n,r){var i=[],o=!!e&&Px.whiteFull;if(aC){if(o=n?Px.blackFull:o,n||e){var s=new kl(t.geometry,o);s.userData.color="black",i.push(s)}r&&((r=new Fd(t.edges,Px.blackLineLone)).userData.color="black",i.push(r))}else{if(n||e){o=n?Px.redFull:o;var a=new kl(t.geometry,o);a.userData.color="red",o=n?Px.cyanFull:o;var l=new kl(t.geometry,o);l.userData.color="cyan",i.push(a,l)}if(r){var c=new Fd(t.edges,Px.redLineLone);c.userData.color="red";var u=new Fd(t.edges,Px.cyanLineLone);u.userData.color="cyan",i.push(c,u)}}return i}(n,t.hatch,t.full,t.lines)),r.forEach((n=>{t.hasOwnProperty("uncentered")&&t.uncentered||n.geometry.center(),n.position.set(t.pos.x,t.pos.y,t.pos.z),"cyan"===n.userData.color&&(n.position.x-=.35,n.position.y-=.05,n.position.z+=.35),t.hasOwnProperty("rot")&&n.rotation.set(t.rot.x,t.rot.y,t.rot.z),t.hasOwnProperty("scale")&&n.scale.set(t.scale.x,t.scale.y,t.scale.z),t.hasOwnProperty("parentGroup")?FL[t.parentGroup].add(n):e.push(n)})))})(t,e,n)})),IL&&r&&(r.setAttribute("instT",new Md(new Float32Array(kL.pos),3)),r.setAttribute("instR",new Md(new Float32Array(kL.rot),4)),r.setAttribute("instS",new Md(new Float32Array(kL.scale),3)),e.push(IL,OL),aC||(i.setAttribute("instT",new Md(new Float32Array(DL.pos),3)),i.setAttribute("instR",new Md(new Float32Array(DL.rot),4)),i.setAttribute("instS",new Md(new Float32Array(DL.scale),3)),e.push(NL)),IL.instanceColor&&(IL.instanceColor.needsUpdate=!0));for(const t in fx)fx[t].forEach((t=>{t.hasOwnProperty("instanceMesh")&&(t.instanceMesh.instanceColor.needsUpdate=!0),t.hasOwnProperty("instanceEdges")&&(t.instanceEdges.geometry.setAttribute("instT",new Md(new Float32Array(t.instanceEdges.userData.Params.pos),3)),t.instanceEdges.geometry.setAttribute("instR",new Md(new Float32Array(t.instanceEdges.userData.Params.rot),4)),t.instanceEdges.geometry.setAttribute("instS",new Md(new Float32Array(t.instanceEdges.userData.Params.scale),3)),e.push(t.instanceEdges),aC||(t.instanceEdgesCyan.geometry.setAttribute("instT",new Md(new Float32Array(t.instanceEdges.userData.ParamsCyan.pos),3)),t.instanceEdgesCyan.geometry.setAttribute("instR",new Md(new Float32Array(t.instanceEdges.userData.ParamsCyan.rot),4)),t.instanceEdgesCyan.geometry.setAttribute("instS",new Md(new Float32Array(t.instanceEdges.userData.ParamsCyan.scale),3)),e.push(t.instanceEdgesCyan)))}))};var FL={};const HL=(t,e,n,r,i)=>{const o=[];var s=[];(t=>{if(FL={},t)for(const n in t){var e=t[n];FL[n]=new kh,e.hasOwnProperty("pos")&&FL[n].position.set(e.pos.x,e.pos.y,e.pos.z),e.hasOwnProperty("rot")&&FL[n].rotation.set(e.rot.x,e.rot.y,e.rot.z)}})(r),zL(e,o);for(const t in FL){var a=FL[t];(new Bs).setFromObject(a).getCenter(a.position).multiplyScalar(-1),o.push(a)}var l=new kh;l.userData.color="red","roomGroup"===t.name?(function(){for(let n=0;n<o.length;n++)if("roomGroup"===t.name){if(o[n].isGroup||o[n].isLineSegments){if(o[n].isGroup){var e=[];o[n].updateWorldMatrix(!1,!0),o[n].children.forEach((t=>{if(t.material===Px.whiteFull){t.updateMatrixWorld(!0);var n=t.geometry.clone();n.applyMatrix4(t.matrixWorld);for(const t in n.attributes)"position"!==t&&n.deleteAttribute(t);(n=n.toNonIndexed()).index=null,e.push(n)}}));const t=dx(e,!1);t.userData.groupMerged=!0,s.push(t)}}else o[n].userData.groupMerged=!1,s.push(o[n]);l.add(o[n])}}(),(t=>{const e=[];t.forEach((t=>{if(t.userData.groupMerged)e.push(t);else if(t.isInstancedMesh){var n=aC?t.instanceMatrix.count:Math.floor(t.instanceMatrix.count/2);for(let o=0;o<n;o++){i=t.geometry.clone();var r=new ha;t.getMatrixAt(o,r),i.applyMatrix4(r);for(const t in i.attributes)"position"!==t&&i.deleteAttribute(t);(i=i.toNonIndexed()).index=null,e.push(i)}}else{var i;t.updateMatrixWorld(!0),(i=t.geometry.clone()).applyMatrix4(t.matrixWorld);for(const t in i.attributes)"position"!==t&&i.deleteAttribute(t);(i=i.toNonIndexed()).index=null,e.push(i)}}));const n=dx(e,!1);n.boundsTree=new PR(n,{lazyGeneration:!0}),UR=new kl(n,Px.whiteFull),(BR=new kl(n,Px.cyanFull)).name="collider",BR.material.wireframe=!1,BR.visible=!1})(s),gC()):o.forEach((t=>l.add(t)));var c=!1;if(l.userData.fxMetaData={genid:i.genid,hash:i.hash,objktid:i.objktid},"movingGroup"===t.name)if(i.loc){t=FP;const e=i.loc;l.position.set(PL(e.position.x),PL(e.position.y),PL(e.position.z)),l.rotation.set(PL(e.rotation.x),PL(e.rotation.y),PL(e.rotation.z)),l.scale.set(PL(e.scale.x),PL(e.scale.y),PL(e.scale.z)),c=!0,FP.attach(l),zR()}else l.userData.tokenType="sculpture",l.position.z-=4;c||t.add(l),setTimeout((()=>{bL()}),1500),console.log("%cLoading new anaver.se native content.","font-weight:bolder;text-decoration:underline")};var GL={room:0,skybox:0,gallery:[]};const VL=new Worker(new URL(n.p+n.u(861),n.b)),jL=new Worker(new URL(n.p+n.u(608),n.b));var WL=!0;const qL=["PAINTING THE SKIES","CALLING THE UNIVERSE","SHUFFLING THE COSMOS","GENERATING INFINITY"],KL=["CHANGING LOCATION","GOING SOMEWHERE ELSE","PLANNING ESCAPE","BEAM ME UP SCOTTY","VERSING ANA","GENERATING VERTICES","INSTANCIATING MESHES","UNFRIENDING GPU"],XL=t=>t[Math.floor(Math.random()*t.length)],YL=(t,e)=>{const n=e.toUpperCase();"firstPerson"===t?(document.getElementById("firstPersonLegendR").innerText=n,document.getElementById("firstPersonLegendG").innerText=n):"room"===t&&(document.getElementById("roomLegendR").innerText=n,document.getElementById("roomLegendG").innerText=n)},JL=(t,n,r,i,o)=>{if(t)if(t.hasOwnProperty("tag")&&t.tag.room&&(GL.room=n,GL.gallery=[]),"skybox"===t.type){GL.skybox=n;var s=1.75*window.innerHeight,a=t.skyboxUrl;bL(XL(qL)),jL.postMessage({side:s,skyurl:a,hash:r})}else{var l;t.hasOwnProperty("tag")&&(l=t.tag),0===e["Téléchargement premier espace"]["début"]&&(e["Téléchargement premier espace"]["début"]=performance.now()),l.room&&bL(XL(KL)),VL.postMessage({figuresUrl:t.figuresUrl,hash:r,type:t.type,tag:l,name:i,loc:o,genid:t.id,objktid:n})}};var ZL={},QL=0;jL.onmessage=t=>{6==++QL?(ZL[t.data.pos]=t.data.imagedata,tI(ZL,t.data.side),ZL={},QL=0):ZL[t.data.pos]=t.data.imagedata},VL.onmessage=function(t){const n=t.data;switch(n.type){case"firstPerson":if(BP.clear(),HL(BP,n.figures,0,n.groups,n),BP.children[0].scale.set(.1,.1,.1),aC||(BP.children[1].scale.set(.1,.1,.1),BP.children[0].position.z=.01),n.features.hasOwnProperty("fpLoc")){const t=n.features.fpLoc;BP.rotation.set(t.rot.x,t.rot.y,t.rot.z),BP.position.set(t.pos.x,t.pos.y,t.pos.z)}else BP.position.set(.1,-.11,-.1),BP.rotation.y=-Math.PI/2;"string"==typeof t.data.name&&YL(n.type,t.data.name);break;case"world":n.tag.room?(qP&&(qP.moveSpeed=100),FP.clear(),zP.clear(),WL&&(WL=!1,e["Téléchargement premier espace"].fin=performance.now(),e["Création Monde"]["début"]=performance.now()),WP.position.x=0,WP.position.y=100,WP.position.z=0,n.features,"string"==typeof t.data.name&&YL("room",t.data.name),zP.clear(),HL(zP,n.figures,0,n.groups,n),aC||(zP.children[0].position.z=.1)):n.tag.item&&HL(HP,n.figures,0,n.groups,n)}};const $L=document.getElementById("titleG"),tC=document.getElementById("titleR"),eC=document.getElementById("landingTitle"),nC=document.getElementById("hider"),rC=(document.getElementById("titleG"),document.getElementById("titleG"),document.getElementById("enter")),iC=document.getElementById("enterG"),oC=document.getElementById("enterR"),sC=document.getElementById("tips");var aC=!0,lC=document.getElementById("perfMode"),cC="";const uC=window.localStorage;document.getElementById("tutorial").addEventListener("click",(()=>{nL(sL),setTimeout((()=>{hC()}),400)})),sC.children[0].innerText="Use the Chrome web browser (or another chromium-based user agent) to get the best results.";const hC=()=>{iC.innerText="ENTER TUTORIAL",oC.innerText="ENTER TUTORIAL",rC.addEventListener("click",cL),gC()};uC.getItem("mode")?"monochrome"===uC.getItem("mode")?aC=!0:(aC=!1,lC.innerText="anaglyphic mode activated"):uC.setItem("mode","monochrome"),lC.addEventListener("click",(()=>{aC?(uC.setItem("mode","anaglyphic"),aC=!1,lC.innerText="anaglyphic mode activated",BP.clear(),zP.clear(),nL(GL),lC.style.pointerEvents="none",lC.style.cursor="none"):(uC.setItem("mode","monochrome"),aC=!0,lC.innerText="monochrome mode activated")}));const dC=()=>{QR&&(jR.play(),YR=!0,XR.innerHTML='<img  style="width:15px;height:15px" src="stop.svg">');const t=window.location.search,e=new URLSearchParams(t);0!==pA.length||e.has("wallet")||wL("tz1hkKqGk3fPPYroNagWpWsxxV3x8P8jqwp9"),qP.lock(),GP(),nC.style.animation="hide .8s linear forwards",setTimeout((()=>{nC.style.display="none"}),1e3)};rC.addEventListener("click",dC);var pC=!1;document.body.addEventListener("touchstart",(()=>{document.body.requestFullscreen(),document.getElementById("barcode").addEventListener("click",QP)})),document.getElementById("helper").addEventListener("touchstart",(()=>{document.getElementById("helper").style.display="none"})),rC.addEventListener("touchstart",(()=>{pC||(pC=!0,vC(),setTimeout((()=>{dC()}),2e3))}));const fC=(t,e)=>{cC=t,document.getElementById("walletSync").style.animation="reveal .8s linear forwards",t&&(e?($L.innerHTML=t+"<br>x<br>ANAVER.SE",tC.innerHTML=t+"<br>x<br>ANAVER.SE",document.title=t+" x ANAVER.SE"):($L.innerHTML=t.toUpperCase()+"'S<br>ANAVER.SE",tC.innerHTML=t.toUpperCase()+"'S<br>ANAVER.SE",document.title=t.toUpperCase()+"'S ANAVER.SE")),document.getElementById("barcode").style.animation="reveal .8s linear forwards",eC.style.animation="reveal .8s linear forwards"};var mC=!1;const gC=()=>{mC||(mC=!0,yC()||(rC.style.display="flex",rC.style.animation="reveal .5s linear forwards"),rC.style.pointerEvents="all",Un("#barrouge").transition().duration(500).attr("transform","translate(-2,0)"),Un("#barcyan").transition().duration(500).attr("transform","translate(2,0)"),$L.style.animation="shift .5s linear forwards",tC.style.animation="unshift .5s linear forwards",document.getElementById("enterR").style.animation="unshift .5s linear forwards",document.getElementById("enterG").style.animation="shift .5s linear forwards",e["Création Monde"].fin=performance.now(),e["Total ANAVER.SE"].fin=performance.now(),setTimeout((()=>{horlogesLog()}),2500))},yC=()=>{if(window.innerWidth<window.innerHeight)return!0},vC=()=>{"landscape-primary"===screen.orientation.type&&screen.orientation.lock("landscape-primary"),eC.style.display="flex",rC.style.display="flex",document.getElementById("mobile-control").style.display="block";const t=document.getElementById("loader-button"),e=document.getElementById("gallery-button"),n=document.getElementById("hang-button");t.style.width=.05*window.innerWidth+"px",t.style.height=.05*window.innerWidth+"px",e.style.width=.05*window.innerWidth+"px",e.style.height=.05*window.innerWidth+"px",n.style.width=.05*window.innerWidth+"px",n.style.height=.05*window.innerWidth+"px"},_C={KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi19:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi18:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi17:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi16:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi15:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi14:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi13:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi12:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi11:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi10:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi9:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi8:!0,KT1NesjBBrgx1iDneL4FVDVcgjQei2ZPo2wi7:!0,KT1QxtxxoXwvVEPFhe4CaSrdj1DCaLYYrxuU0:!0};var wC=Ix.gql`
  {
    token_tag(where: { tag: { name: { _eq: "anaverse-gallery" } } }) {
      token {
        creators {
          creator_address
        }
        fa_contract
        token_id
        artifact_uri
        thumbnail_uri
        holders {
          holder_address
        }
      }
    }
  }
`;const bC=[],xC=window.location.search,EC=new URLSearchParams(xC),SC=t=>{let e,n=t.length;for(;0!=n;)e=Math.floor(Math.random()*n),n--,[t[n],t[e]]=[t[e],t[n]];return t},MC=new Worker(new URL(n.p+n.u(321),n.b));var TC=[];const AC={},RC=t=>{Ux(t).then((()=>{for(const n in AC){var t=Bx[n];if(t){if(t.twitter||t.alias||t.logo){const n=document.createElement("div");n.className="artThumbTitle";const r=t.twitter?`@${t.twitter}`:"",i=document.createElement("div");i.className="artistNames";var e="";if(t.alias&&(e=t.alias.length<50?t.alias:t.alias.substring(0,50)+"…"),i.innerHTML=`<span>${e}</span>\n      <span><a href="${t.twitter}" target="_blank">${r.replace("https://twitter.com/","")}</a></span>`,t.logo){if(t.logo.indexOf("ipfs")>-1){const e=document.createElement("img");e.className="profilePic",e.src=t.logo,e.addEventListener("error",(()=>e.style.display="none")),n.appendChild(e)}n.appendChild(i),t.DOM=n}}AC[n]=t}}}))};var LC=!0;const CC=window.localStorage;MC.onmessage=t=>{switch(t.data.type){case"remote":!function(t){var e=0,n=t.data,r=new Image(200);r.src="https://assets.objkt.media/file/assets-003/"+n.thumbnail.replace("ipfs://","")+"/thumbnail",r.className="thumbnail",r.onerror=()=>{n.DOMthumb=""},n.DOMthumb=r,_C.hasOwnProperty(n.contract+n.id)?n.template=!0:n.template=!1,bC.push(n),EC.get("gallery")&&EC.get("galc")===n.contract&&EC.get("galid")===n.id&&(e=n),e?(nL(e),fC()):LC&&EC.get("autogalgen")&&(LC=!1,NC(EC.get("autogalgen"),EC.get("autogalid"))),function(){bC.forEach((t=>{AC.hasOwnProperty(t.curator)||(AC[t.curator]=!0)}));var t=[];for(const e in AC)t.push(e);RC(t)}()}(t);break;case"local":!function(t){var e=JSON.parse(CC.getItem("localGalleries"));e?(e.push(t.data),CC.setItem("localGalleries",JSON.stringify(e))):CC.setItem("localGalleries",JSON.stringify([t.data])),sP(),iP(uL),sP()}(t)}e["Galleries Natives"].fin=window.performance.now()};var PC=[];function IC(t,e,n){1===e&&(PC=[]),fetch(t+"/"+e).then((t=>t.json())).then((r=>{if(r.curatedTokens.forEach((t=>PC.push(t))),PC.length<r.curatedTokensConnection.aggregate.count)IC(t,e+1,n);else{var i=[];bC.forEach((t=>{t.gallery.length>9&&t.template&&i.push(t)}));var o=i[Math.floor(Math.random()*i.length)];const t={};Object.assign(t,o);for(let e=0;e<t.gallery.length;e++)"block"!=t.gallery[e].tokenType&&"sculpture"!=t.gallery[e].tokenType&&(PC[e]?(t.gallery[e].tokenType="objkt",t.gallery[e].objktMetaData={contract:PC[e].contract,token_id:JSON.stringify(PC[e].tokenId)}):t.gallery[e]=!1);var s=[];t.gallery.forEach((t=>t?s.push(t):0)),t.gallery=s,t.collection="OBJKT's Gems - "+n,t.contract="",t.curator="tz1LaqjdBZvJ2drBq8Zp9jF3HGhfqjHZm9Ny",nL(t)}}))}var OC=[];const NC=(t,e)=>{switch(t){case"objkt":fC("objkt.com",!0),IC(n="https://back.objkt.com/api/v1/cms/curation/tokens/"+e,1,e);break;case"versum":fC("versum",!0);var n="https://versum.xyz/api/anaverse/boards/"+e;fetch(n).then((t=>t.json())).then((t=>{OC=[...t.tokens];var e=[];bC.forEach((t=>{t.gallery.length>=OC.length&&t.template&&e.push(t)}));var n=e[Math.floor(Math.random()*e.length)];const r={};Object.assign(r,n),r.gallery.forEach((t=>{t.hasOwnProperty("objktMetaData")&&(t.objktMetaData={})}));for(let t=0;t<r.gallery.length;t++)"block"!=r.gallery[t].tokenType&&"sculpture"!=r.gallery[t].tokenType&&(OC[t]?(r.gallery[t].tokenType="objkt",r.gallery[t].objktMetaData={contract:OC[t].contract,token_id:JSON.stringify(OC[t].tokenId)}):r.gallery[t]=!1);var i=[];r.gallery.forEach((t=>t?i.push(t):0)),r.gallery=i,r.collection="Versum boards - "+t.info.title,r.contract="",r.curator=t.info.user.name,nL(r)}))}},kC=[];var DC=[];const BC=new Worker(new URL(n.p+n.u(600),n.b));var UC=new Map,zC=!0,FC=999999999999;const HC=(t,e,n)=>{var r=0;zC&&(JP(!0),FP.add(WC),WC.position.set(t.x-2.5*e.size+5,t.y+.5,t.z),zC=!1),e.forEach(((e,i)=>{if(UC.has(i)){const t=UC.get(i);t.size!=e.size&&e.forEach(((e,n)=>{t.has(n)||(t.set(n,e),BC.postMessage(e))}))}else{if(i<FC&&(FC=i),UC.set(i,e),KC(i,r),WC.children.length>5){const e=WC.children[0],n=WC.children[1];n.children.forEach((t=>{t.children.forEach((t=>{t.material.map&&t.material.dispose()}))})),hx.to(e.position,{duration:2,y:t.y+100}),hx.to(n.position,{duration:2,y:t.y+100}),setTimeout((()=>{WC.remove(e),WC.remove(n)}),2e3)}e.forEach(((t,e)=>{BC.postMessage({operation:t,feedType:n})}))}r++}))},GC=new Bl(1.5,.3,.75),VC=new lp(GC),jC=new rc(1.5,.3),WC=new kh,qC={},KC=(t,e)=>{hx.to(WC.position,{duration:2,x:WC.position.x-2.51});const n=new kh;var r=JSON.stringify(2.5*e);r=parseFloat(r),n.position.set(r,0,-5);var i=t;"number"==typeof t&&(i=JSON.stringify(i)),n.name=JSON.stringify(i),qC[n.name]=n;var o=(t=>{const e=t,n=document.createElement("canvas"),r=n.getContext("2d");n.width=100,n.height=100*e.length,r.fillStyle="white",r.fillRect(0,0,100,100*e.length),r.textAlign="center",r.font="bolder 90px monospace";for(let t=0;t<e.length;t++)r.fillStyle="black",t>3&&(r.fillStyle="red"),r.strokeRect(0,100*t,100,100),r.fillText(e[t],50,100*(t+1)-25);return n.toDataURL()})(i);_x(o).then((t=>{const e=new kh;e.position.x=-1;var o=new Ja({map:t}),s=i.length/10;const a=new Bl(.1,s,.1),l=new lp(a),c=new rc(.1,s),u=new kl(c,o),h=new kl(a,Px.whiteFull);h.position.z=-.051;const d=new Fd(l,Px.blackLineLone);d.position.z=-.051,e.add(u,h,d),e.position.set(r-1,0,-5),WC.add(e),WC.add(n)}))};BC.onmessage=t=>function(t){var e=new kh;const n=new kl(GC,Px.whiteFull),r=new Fd(VC,Px.blackLineLone);n.position.set(0,0,-.3751),r.position.set(0,0,-.3751);const i=new bd(t.img.data,1e3,200);i.generateMipmaps=!0,i.flipY=!0,i.needsUpdate=!0;var o=new Ja({map:i});const s=new kl(jC,o);t.seller_address!==pA&&t.artist_address!==pA&&t.buyer_address!==pA||(n.scale.set(1.02,1.1,1),r.scale.set(1.02,1.1,1),n.material=Px.redFull),e.userData.item=t,e.userData.focused=!1,e.add(s,n,r),e.userData.isBlockDisplay=!0,qC[JSON.stringify(t.level)].add(e),bL(""),e.position.y=50;var a=e.parent.children.length;hx.to(e.position,{duration:2,y:.35*a-2.5})}(t.data);var XC=0;function YC(t){fetch("https://livefeed-proxy.teztok.com/feed").then((t=>t.json())).then((e=>{if(XC)for(let t=0;t<250;t++){const n=e.events[t];if(!XC.has(n.level)){const t=new Map;XC.set(n.level,t)}const r=XC.get(n.level);r.set(n.id,n),XC.set(n.level,r)}else{const t=new Map;for(let n=0;n<250;n++){const r=e.events[n];if(!t.has(r.level)){const e=new Map;t.set(r.level,e)}const i=t.get(r.level);i.set(r.id,r),t.set(r.level,i)}XC=t}const n=[...XC].sort((([t,e],[n,r])=>t-n));XC=new Map(n),HC(t,XC,"teztok")}))}const JC=new Map,ZC=[],QC=(t,e)=>{var n=document.createElement("div");n.className="galLoaderButton";var r=document.createElement("div");r.style.padding="10px",r.innerText=t;const i=document.createElement("div");e.forEach((t=>i.appendChild(t))),n.addEventListener("click",(()=>{document.getElementById("galleryMainWindow").innerHTML="",document.getElementById("galleryMainWindow").append(i)})),n.appendChild(r),ZC.push(n)};QC("TezTok",function(){const t=[];var e=document.createElement("div");e.className="galLoaderButton";var n=document.createElement("div");return n.style.padding="10px",n.innerText="Live NFT transactions feed",n.addEventListener("click",(()=>{var t;YC(t={x:WP.position.x,y:WP.position.y,z:WP.position.z}),bL("CALLING TEZTOK"),setInterval((()=>{YC(t)}),2e4),sP()})),e.append(n),t.push(e),t}()),QC("Reddit",function(){const t=[];var e=document.createElement("div");e.className="galLoaderButton";var n=document.createElement("div"),r=document.createElement("input");r.type="text",r.addEventListener("focusin",(()=>mP(!0))),r.addEventListener("focusout",(()=>mP(!1)));var i=document.createElement("button");return i.innerText="Load subreddit",n.style.padding="10px",n.append(r,i),i.addEventListener("click",(()=>{var t,e;t={x:WP.position.x,y:WP.position.y,z:WP.position.z},e=r.value,bL("CALLING REDDIT"),((t,e)=>{fetch(`https://api.reddit.com/r/${e}?limit=100&sort=hot`).then((t=>t.json())).then((n=>{const r=n.data.children,i=[];r.forEach((t=>i.push({title:t.data.title,score:t.data.score,author:t.data.author,img:t.data.url,display_uri:t.data.url,permalink:"https://www.reddit.com/"+t.data.permalink,thumbnail:t.data.thumbnail,flair:t.data.link_flair_text,level:e})));const o=i.sort(((t,e)=>e.score-t.score)),s=new Map;o.forEach((t=>s.set(t.permalink,t))),JC.set(e,s),HC(t,JC,"reddit")}))})(t,e),sP()})),e.append(n),t.push(e),t}());const $C=window.localStorage;var tP=document.getElementById("itemMetaData");const eP=t=>{const e=document.getElementById("tokens");e.innerHTML="",e.style.gridTemplateColumns="",e.appendChild(t.DOMelements.profile),e.appendChild(t.DOMelements.description);var n=document.createElement("div");n.innerText="LOADING COLLECTION ...",n.id="loadingCollection",e.appendChild(n)},nP=document.getElementById("toolback"),rP=t=>{const e=document.getElementById("tokens");if(e.style.overflow="hidden auto",e.innerHTML="",nP.innerHTML="",nP.style.display="none",nP.onclick=()=>{sP(),sP(!0)},e.style.gridTemplateColumns="",t.DOMelements.hasOwnProperty("profile")){var n=document.createElement("div");n.style.display="flex",n.appendChild(t.DOMelements.profile),n.appendChild(t.DOMelements.description),e.appendChild(n)}const r=document.createElement("DIV");r.id="filter",r.innerText="FILTER TOKENS";const i=document.createElement("ul");var o;i.style="margin: 50px;padding: 0;list-style : none",pA&&(o=JSON.parse($C.getItem(pA)))&&JSON.parse(o.prevLoad),t.DOMelements.gallery.forEach((t=>i.appendChild(t)));var s=document.createElement("div");if(s.style="display: grid;grid-template-columns: 20% 80%;",t.DOMelements.hasOwnProperty("filters"))t.DOMelements.filters.forEach((t=>{r.appendChild(t)})),s.appendChild(r);else{var a=document.createElement("div");s.appendChild(a),nP.onclick=()=>{sP(),iP(),sP()}}s.appendChild(i),e.appendChild(s)},iP=()=>{const t=document.getElementById("tokens");t.innerHTML="",t.style.gridTemplateColumns="",t.style="overflow:hidden hidden;display:grid;justify-content: left;grid-template-columns: 200px 2fr;",nP.innerHTML="";const e=document.createElement("div");e.id="galleryLeftMenu",e.style.borderRight="1px solid black";const n=document.createElement("div");n.id="galleryMainWindow",n.style.overflow="hidden auto";var r={"Your collection":{},"Your creations":{},"Local galleries":{},"Public galleries":{},"Data visualisation":{},"Objkt Gems":{},"Versum Boards":{},"SuperRare Spaces":{}};for(const t in r){r[t].DOM={},r[t].DOM.title=document.createElement("div"),r[t].DOM.content=document.createElement("div");const i=document.createElement("div");i.innerText=t,i.id=t,i.className="gallerieMenuButton",i.addEventListener("click",(()=>{var e=document.getElementsByClassName("gallerieMenuButton");for(let t=0;t<e.length;t++)e[t].style.backgroundColor="transparent",e[t].style.color="black";i.style.backgroundColor="rgba(0,0,0,.8)",i.style.color="white",n.innerHTML="",n.appendChild(r[t].DOM.title),n.appendChild(r[t].DOM.content)})),e.appendChild(i)}t.append(e,n);var i=document.createElement("div");i.className="artistList";var o=document.createElement("div");o.className="artistList";var s=document.createElement("div");s.className="artistList";var a=document.createElement("div");a.className="artistList";var l=document.createElement("div");l.className="artistList",document.createElement("div").className="artistList";var c=document.createElement("div");c.className="artistList";var u=document.createElement("div");u.className="artistList";var h=document.createElement("div");h.className="artistList",ZC.length>0&&(ZC.forEach((t=>h.appendChild(t))),r["Data visualisation"].DOM.content=h),DC.length>0&&(DC.forEach((t=>{const e=document.createElement("div");e.className="galLoaderButton",e.style.paddingTop="40px",e.style.paddingBottom="40px",e.innerHTML=t.title+`<br><a target="_blank" style="font-size: 12px;" href="${t.connect}">Open on SuperRare</a>`,e.addEventListener("click",(()=>{n.innerHTML="";const e=document.createElement("div");e.className="artistList",t.tokens.forEach((t=>{const n=document.createElement("div");n.className="gentkProfiles";const r=new Image(198,198);r.className="thumbnail",r.src=t.thumbnailImage,r.onerror=()=>{r.src="/notfound.png"},r.style.cursor="pointer",r.addEventListener("click",(()=>{const e=t.contractAddress+t.tokenID;t.id=e,yL[e]=t;const n=t.standardImage;sP();const r={id:e,objkt:{token_id:t.tokenId,asset_contract:{address:t.contractAddress}}};yx(n,r,"openSea")})),r&&n.appendChild(r);const i=document.createElement("div");i.className="artThumbTitle";const o=document.createElement("div");o.className="artistNames",o.innerText=t.creator.username,i.appendChild(o),n.appendChild(i),e.appendChild(n)})),n.appendChild(e)})),l.appendChild(e)})),r["SuperRare Spaces"].DOM.content=l),Xx.length>0?(Xx.forEach((t=>u.appendChild(t))),r["Your creations"].DOM.content=u):document.getElementById("Your creations").style.display="none";const d=document.createElement("input");d.innerText="Import a gallery file by dropping it here",d.style.border="1px dashed cyan",d.style.padding="10px",d.style.backgroundColor="white",d.type="file",d.addEventListener("change",(t=>{MC.postMessage({type:"local",path:t.target.files[0]})})),i.appendChild(d);var p=JSON.parse($C.getItem("localGalleries"));if(p&&p.length>0&&p.forEach((t=>{var e=document.createElement("div");e.className="galLoaderButton";var n=document.createElement("div");n.style.border="1px dashed cyan",n.style.padding="10px",n.innerText=t.name,n.addEventListener("click",(()=>{sP(),nL(t)})),e.appendChild(n),e.appendChild((t=>{const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});var n=document.createElement("a");return n.href=URL.createObjectURL(e),n.download="gallery",n.innerText="Export gallery",n})(t)),e.appendChild(((t,e)=>{var n=document.createElement("div");n.innerText="X";var r=JSON.parse(eL.getItem("localGalleries")),i=[];return n.addEventListener("click",(()=>{r.forEach((n=>{if(n.name===t.name&&n.skybox===t.skybox&&n.room===t.room){var r=!0;for(let e=0;e<t.gallery.length;e++)t.gallery[e].objktMetaData.contract===n.gallery[e].objktMetaData.contract&&t.gallery[e].objktMetaData.token_id===n.gallery[e].objktMetaData.token_id||(r=!1);r?e&&e.remove():i.push(n)}})),eL.setItem("localGalleries",JSON.stringify(i))})),n})(t,e)),i.appendChild(e)})),r["Local galleries"].DOM.content=i,bC.length>0&&(bC.forEach((t=>{var e=document.createElement("div");e.className="galLoaderButton";var n=document.createElement("div");n.style.padding="10px",n.innerText=t.name,e.addEventListener("click",(()=>{sP(),nL(t)})),t.hasOwnProperty("audioguide")&&(e.style.border="2px solid cyan"),t.DOMthumb&&(t.DOMthumb.style.width="196px",e.appendChild(t.DOMthumb)),e.appendChild(n);const r=document.createElement("div");r.className="artThumbTitle",AC.hasOwnProperty(t.curator)&&AC[t.curator]&&AC[t.curator].DOM&&(r.innerHTML=AC[t.curator].DOM.innerHTML,r.style.top="0px",e.appendChild(r)),o.appendChild(e)})),r["Public galleries"].DOM.content=o),TC.length>0&&(TC.forEach((t=>{var e=document.createElement("div");e.className="galLoaderButton";var n=document.createElement("div");n.style.padding="10px",n.innerText=t.name,e.addEventListener("click",(()=>{sP(),NC("objkt",t.category)})),t.DOMthumb?e.appendChild(t.DOMthumb):e.appendChild(document.createElement("div")),e.appendChild(n),s.appendChild(e)})),r["Objkt Gems"].DOM.content=s),kC.length>0&&(kC.forEach((t=>{var e=document.createElement("div");e.className="galLoaderButton";var n=document.createElement("div");n.style.padding="10px",n.innerText=t.title,e.addEventListener("click",(()=>{sP(),NC("versum",t.id)})),t.DOMthumb&&e.appendChild(t.DOMthumb),e.appendChild(n);const r=document.createElement("div");r.className="artThumbTitle",AC.hasOwnProperty(t.curator)&&AC[t.curator]&&AC[t.curator].DOM&&(r.innerHTML=AC[t.curator].DOM.innerHTML,r.style.top="0px",e.appendChild(r)),a.appendChild(e)})),r["Versum Boards"].DOM.content=a),vL.length>0){let t=0;vL.forEach((e=>{t++,t<30&&c.appendChild(e)}));var f=document.createElement("button");f.innerText="Display the whole collection",f.addEventListener("click",(()=>{c.innerHTML="",vL.forEach((t=>c.appendChild(t)))})),c.appendChild(f),r["Your collection"].DOM.content=c}n.innerHTML="",n.appendChild(r["Your collection"].DOM.title),n.appendChild(r["Your collection"].DOM.content)};var oP=!1;const sP=t=>{var e=document.getElementById("anavTooltip"),n=document.getElementById("tokens");oP?(window.innerWidth>window.innerHeight&&qP.lock(),n.innerHTML="",e.style.zIndex=0,e.style.display="none",oP=!1):(window.innerWidth>window.innerHeight&&qP.unlock(),t&&(nP.style.display="none",nP.innerHTML="",(()=>{const t=document.getElementById("tokens");t.innerHTML="";var e=document.createElement("div"),n=document.createElement("ul");if(n.style.listStyle="none",t.style.gridTemplateColumns="",t.style.overflow="hidden auto",t.style.display="block",pA){n.className="tokensDiv";var r=document.createElement("div");r.innerText="Personal tokens",r.className="tokenCatTitle",r.style.cursor="pointer",r.addEventListener("click",(()=>{"block"===n.style.display?(n.style.display="inline-flex",n.style.height="220px",n.style.alignItems="flex-start",n.style.flexWrap="nowrap"):(n.style.display="block",n.style.height="",n.style.alignItems="")})),e.appendChild(r);const t=JSON.parse($C.getItem(pA));t&&JSON.parse(t.prevLoad),n.style.height="220px",n.style.alignItems="flex-start",n.style.flexWrap="nowrap",gL.forEach((t=>{n.append(t)}))}var i=[];for(const t in uL)i.push(uL[t]);const o=i[parseInt(Math.random()*i.length)];var s=o.metadata.childrenDescription;s.length>500&&(s=s.substring(0,500)+"...");var a=document.createElement("div");a.id="highlight",a.innerHTML=`<div id='highlightImg'><img style="height:250px;max-width: 250px;max-height: 250px;" src="https://gateway.fxhash.xyz/ipfs/${o.metadata.displayUri.replace("ipfs://","")}"</img></div>\n      <div id='highlightDesc'>\n      <h2>${o.title}</h2><br>\n      ${s}<br><br>\n      <a style="cursor:pointer" href="https://www.fxhash.xyz/generative/${o.id}" target="_blank">Open generator on fx(hash)</a></div>\n      `;var l=document.createElement("div");l.innerHTML="<div class='tokenCatTitle'>First Person - Handeld Items</div>";var c=document.createElement("div");c.className="tokensDiv";var u=document.createElement("div");u.innerHTML="<div class='tokenCatTitle'>Rooms & spaces</div>";var h=document.createElement("div");h.className="tokensDiv";var d=document.createElement("div");d.innerHTML="<div class='tokenCatTitle'>Skies and environments</div>";var p=document.createElement("div");p.className="tokensDiv";var f=document.createElement("div");f.innerHTML="<div class='tokenCatTitle'>Sculptures</div>";var m=document.createElement("div");m.className="tokensDiv";for(const t in uL){const e=uL[t];"firstPerson"===e.type?c.appendChild(e.DOMelements.profile):"world"===e.type&&e.tag.room?h.appendChild(e.DOMelements.profile):"skybox"===e.type?aL?9574===e.id&&p.appendChild(e.DOMelements.profile):p.appendChild(e.DOMelements.profile):"world"===e.type&&e.tag.item&&m.appendChild(e.DOMelements.profile)}(aL?[p]:[e,n,u,h,d,p,f,m,l,c]).forEach((e=>t.appendChild(e)))})()),e.style.display="grid",e.style.zIndex=48,oP=!0)},aP=new class{parse(t,e={}){const n=void 0!==e.binary&&e.binary,r=[];let i,o=0;t.traverse((function(t){if(t.isMesh){const e=t.geometry;if(!0!==e.isBufferGeometry)throw new Error("THREE.STLExporter: Geometry is not of type THREE.BufferGeometry.");const n=e.index,i=e.getAttribute("position");o+=null!==n?n.count/3:i.count/3,r.push({object3d:t,geometry:e})}}));let s=80;if(!0===n){const t=new ArrayBuffer(2*o+3*o*4*4+80+4);i=new DataView(t),i.setUint32(s,o,!0),s+=4}else i="",i+="solid exported\n";const a=new Ns,l=new Ns,c=new Ns,u=new Ns,h=new Ns,d=new Ns;for(let t=0,e=r.length;t<e;t++){const e=r[t].object3d,n=r[t].geometry,i=n.index,o=n.getAttribute("position");if(null!==i)for(let t=0;t<i.count;t+=3)p(i.getX(t+0),i.getX(t+1),i.getX(t+2),o,e);else for(let t=0;t<o.count;t+=3)p(t+0,t+1,t+2,o,e)}return!1===n&&(i+="endsolid exported\n"),i;function p(t,e,r,o,p){a.fromBufferAttribute(o,t),l.fromBufferAttribute(o,e),c.fromBufferAttribute(o,r),!0===p.isSkinnedMesh&&(p.boneTransform(t,a),p.boneTransform(e,l),p.boneTransform(r,c)),a.applyMatrix4(p.matrixWorld),l.applyMatrix4(p.matrixWorld),c.applyMatrix4(p.matrixWorld),function(t,e,r){u.subVectors(r,e),h.subVectors(t,e),u.cross(h).normalize(),d.copy(u).normalize(),!0===n?(i.setFloat32(s,d.x,!0),s+=4,i.setFloat32(s,d.y,!0),s+=4,i.setFloat32(s,d.z,!0),s+=4):(i+="\tfacet normal "+d.x+" "+d.y+" "+d.z+"\n",i+="\t\touter loop\n")}(a,l,c),f(a),f(l),f(c),!0===n?(i.setUint16(s,0,!0),s+=2):(i+="\t\tendloop\n",i+="\tendfacet\n")}function f(t){!0===n?(i.setFloat32(s,t.x,!0),s+=4,i.setFloat32(s,t.y,!0),s+=4,i.setFloat32(s,t.z,!0),s+=4):i+="\t\t\tvertex "+t.x+" "+t.y+" "+t.z+"\n"}}},lP=document.createElement("a");lP.style.display="none",document.body.appendChild(lP);var cP,uP=0,hP=!1,dP=!0,pP=!1,fP=0;const mP=t=>uP=t;function gP(){if(HP.children.length>0){var t=HP.children[0];t.children.forEach((t=>{("Mesh"===t.type||t.isLineSegments)&&("PlaneGeometry"===t.geometry.type?(t.material.opacity=1,t.material.transparent=!1):t.isLineSegments||(t.material=Px.whiteFull))})),FP.attach(t),zR(),HP.clear(),JP(!0)}}const yP=document.getElementById("objktViewer");yP.style.border="1x solid black";const vP=()=>{Bn({minus:"-"});const t=document.getElementById("audio-radio");t.style.display="flex",document.getElementById("galleryClose").addEventListener("click",(()=>{const t=document.getElementById("galleryCreator");uP=0,qP.lock(),t.style.display="none",t.style.zIndex=-5,document.getElementById("galleryMetaData").innerHTML=""}));const e=window.localStorage,n=document.getElementById("galleryCreator");n.style.display="none",document.getElementById("saveGallery").addEventListener("click",(()=>{GL.name=document.getElementById("galleryName").value,FP.children.forEach((t=>{var e={};t.userData.hasOwnProperty("tokenType")&&(e.tokenType=t.userData.tokenType,"block"===t.userData.tokenType&&(e.block=t.userData),"sculpture"===t.userData.tokenType&&(e.fxMetaData=t.userData.fxMetaData)),t.userData.hasOwnProperty("openSeaMetaData")&&(e.openSeaMetaData=t.userData.openSeaMetaData),t.userData.hasOwnProperty("objktMetaData")&&(e.objktMetaData=t.userData.objktMetaData),e.position={x:Nn(".4f")(t.position.x),y:Nn(".4f")(t.position.y),z:Nn(".4f")(t.position.z)},e.rotation={x:Nn(".4f")(t.rotation.x),y:Nn(".4f")(t.rotation.y),z:Nn(".4f")(t.rotation.z)},e.scale={x:Nn(".4f")(t.scale.x),y:Nn(".4f")(t.scale.y),z:Nn(".4f")(t.scale.z)},GL.gallery.push(e),n.style.display="none",n.style.zIndex=-5,document.getElementById("galleryMetaData").innerHTML="",document.addEventListener("keydown",i),qP.lock()}));const t=window.location.search,r=new URLSearchParams(t);r.has("wallet")?GL.collection=r.get("wallet"):GL.collection=pA,document.addEventListener("keydown",i);var o=JSON.parse(e.getItem("localGalleries"));o?(o.push(GL),e.setItem("localGalleries",JSON.stringify(o))):e.setItem("localGalleries",JSON.stringify([GL])),uP=0}));var r=document.getElementById("helper");r.style.display="block",r.addEventListener("touchstart",(()=>{r.style.display="none"}));const i=e=>{if(!uP)switch(e.code){case"ShiftLeft":pP?pP=!1:fP||(pP=!0,setTimeout((()=>{pP=!1}),7e3),fP=!0,setTimeout((()=>{fP=!1}),2e4));break;case"KeyB":"block"===r.style.display?r.style.display="none":r.style.display="block";break;case"KeyX":(()=>{const t=new Wh;var e,n;zP.children[0].children.forEach((e=>{if("Mesh"===e.type){const n=e.clone();t.add(n)}else"Group"===e.type&&e.children.forEach((n=>{if("Mesh"===n.type){const n=e.clone();t.add(n)}}))})),e=aP.parse(t),n="anaverse.stl",function(t,e){lP.href=URL.createObjectURL(t),lP.download=e,lP.click()}(new Blob([e],{type:"text/plain"}),n)})();break;case"KeyL":sP(!0);break;case"KeyC":FP.children.length>0&&GL.room>0&&("none"===n.style.display?(uP=1,qP.unlock(),n.style.display="flex",n.style.zIndex=40,document.getElementById("galleryMetaData").innerHTML="<br>Room: "+GL.room+"<br>Skybox: "+GL.skybox+"<br>Number of pieces: "+FP.children.length):(uP=0,qP.lock(),n.style.display="none",n.style.zIndex=-5,document.getElementById("galleryMetaData").innerHTML=""));break;case"KeyK":document.body.requestFullscreen();break;case"KeyG":0===HP.children.length&&(iP(uL),sP());break;case"KeyN":hP=!hP;break;case"KeyH":gP();break;case"KeyI":var i;for(const t in yL)yL[t].focused&&(i=yL[t]);i&&(cP?(qP.lock(),yP.src="",yP.style.zIndex=0,yP.style.display="none",cP=0):(qP.unlock(),i.hasOwnProperty("permalink")?window.open(i.permalink,"_blank"):i.hasOwnProperty("fa")&&("KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW"===i.fa.contract?window.open("https://versum.xyz/token/versum/"+i.token_id,"_blank"):(yP.src=i.url,yP.style.zIndex=150,yP.style.display="block",yP.style.left="10%",yP.style.top="10%",yP.width=.8*window.innerWidth,yP.height=.8*window.innerHeight,cP=1))));break;case"KeyP":FP.children.forEach((t=>{t.userData.focused&&(FP.remove(t),zR()),t.userData.hasOwnProperty("id")&&yL[t.userData.id].focused&&(FP.remove(t),zR())}));break;case"KeyY":"flex"===t.style.display?t.style.display="none":t.style.display="flex";break;case"KeyV":dP=!dP;break;case"KeyU":0===HP.children.length&&((()=>{const t=document.getElementById("tokens");t.innerHTML="",t.style.gridTemplateColumns="",t.style="overflow:hidden hidden;display:grid;justify-content: left;grid-template-columns: 200px 2fr;",nP.innerHTML="";const e=document.createElement("div");e.id="galleryLeftMenu",e.style.borderRight="1px solid black";const n=document.createElement("div");n.id="galleryMainWindow",n.style.overflow="hidden auto";for(const t in HR){HR[t].DOM={},HR[t].DOM.title=document.createElement("div"),HR[t].DOM.content=document.createElement("div");const i=document.createElement("div");i.innerText=t,i.id=t,i.className="gallerieMenuButton",i.addEventListener("click",(()=>{var e=document.getElementsByClassName("gallerieMenuButton");for(let t=0;t<e.length;t++)e[t].style.backgroundColor="transparent",e[t].style.color="black";i.style.backgroundColor="rgba(0,0,0,.8)",i.style.color="white",n.innerHTML="",n.appendChild(HR[t].DOM.title),n.appendChild(HR[t].DOM.content)})),e.appendChild(i);var r=document.createElement("div");r.className="tokensDiv",HR[t].forEach((t=>r.appendChild(t))),HR[t].DOM.content=r}t.append(e,n)})(),sP())}};document.addEventListener("keydown",i),document.getElementById("loader-button").addEventListener("click",(()=>{sP(!0)})),document.getElementById("gallery-button").addEventListener("click",(()=>{0===HP.children.length&&(iP(uL),sP())})),document.getElementById("hang-button").addEventListener("click",gP)},_P=new ba(0,0,0,"YXZ"),wP=new Ns,bP={type:"change"},xP={type:"lock"},EP={type:"unlock"},SP=Math.PI/2;function MP(t){return t>-3*SP/2&&t<-SP/2?-SP:t>-SP/2&&t<SP/2?0:t>SP/2&&t<1.5*SP?SP:t>1.5*SP||t<-3*SP/2?2*SP:void 0}var TP,AP;class RP extends Qo{constructor(t,e){function n(){TP.domElement.ownerDocument.pointerLockElement===TP.domElement?(TP.dispatchEvent(xP),TP.isLocked=!0):(TP.dispatchEvent(EP),TP.isLocked=!1)}function r(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}super(),void 0===e&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),e=document.body),this.domElement=e,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,TP=this,AP=e=>{if(!1===TP.isLocked)return;const n=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;if(_P.setFromQuaternion(t.quaternion),_P.y-=.002*n,_P.x-=.002*r,_P.x=Math.max(SP-TP.maxPolarAngle,Math.min(SP-TP.minPolarAngle,_P.x)),t.quaternion.setFromEuler(_P),hP){var i=new ba(MP(_P._x),MP(_P._y),MP(_P._z),"YXZ");HP.quaternion.setFromEuler(i)}else HP.quaternion.setFromEuler(_P);TP.dispatchEvent(bP)},this.connect=function(){TP.domElement.ownerDocument.addEventListener("mousemove",AP),TP.domElement.ownerDocument.addEventListener("pointerlockchange",n),TP.domElement.ownerDocument.addEventListener("pointerlockerror",r)},this.disconnect=function(){TP.domElement.ownerDocument.removeEventListener("mousemove",AP),TP.domElement.ownerDocument.removeEventListener("pointerlockchange",n),TP.domElement.ownerDocument.removeEventListener("pointerlockerror",r)},this.dispose=function(){this.disconnect()},this.getObject=function(){return t},this.getDirection=function(){const e=new Ns(0,0,-1);return function(n){return n.copy(e).applyQuaternion(t.quaternion)}}(),this.moveForward=function(e){wP.setFromMatrixColumn(t.matrix,0),wP.crossVectors(t.up,wP),t.position.addScaledVector(wP,e)},this.moveRight=function(e){wP.setFromMatrixColumn(t.matrix,0),t.position.addScaledVector(wP,e)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){TP.domElement.ownerDocument.exitPointerLock()},this.connect()}}const LP=new Audio("/sound/jetpack/jetpack_start.mp3");LP.volume=1;const CP=new Audio("/sound/jetpack/jetpack_croisiere.mp3");CP.volume=1,CP.loop=!0;var PP=!0;const IP=()=>{LP.play(),PP=!0,setTimeout((()=>{PP&&CP.play()}),2e3)},OP=()=>{LP.pause(),CP.pause(),PP=!1},NP=new Audio("/sound/steps/steps.mp3");NP.volume=.1;const kP=t=>t?NP.play():NP.pause();var DP;const BP=new kh;BP.name="fpGroup";const UP=new kh;UP.name="worldGroup";const zP=new kh;zP.name="roomGroup";const FP=new kh;FP.name="itemGroup";const HP=new kh;var GP;HP.name="movingGroup",UP.add(zP,FP,HP);const VP=new Ns;var jP,WP,qP;const KP=new vg,XP=new hs;var YP=!1;const JP=t=>YP=t;var ZP=1;const QP=()=>{VP.y=0,WP.position.set(0,4,0)},$P=new em,tI=(t,e)=>{let n=[];for(const i in t){var r=document.createElement("canvas");r.width=e,r.height=e,r.getContext("2d").putImageData(t[i],0,0),n.push(r.toDataURL())}const i=$P.load(n);i.needsUpdate=!0,i.mapping=Wr,DP.background=i,setTimeout((()=>{bL()}),1200)},eI=[];for(let t=0;t<10;t++)eI.push(new hs(4*Math.cos(.4*t)+5+2*Math.random(),3*(t-1)));const nI=new cf(eI,32,Math.PI/5,2*Math.PI-Math.PI/5),rI=(new lp(nI),new Ja({side:er,color:"white"}),[]);for(let t=0;t<10;t++)rI.push(new hs(3*Math.sin(t*Math.random()*5)+Math.random(),4*(t-1)));new cf(rI,32),new Ja({side:er,color:"black"}),e["Total ANAVER.SE"]["début"]=window.performance.now(),console.info("\n _______ _______ _______ _______ _______ _______     _______ _______ \n|  _  | |   | | |  _  | |  |  | |   __|_| __  | |   |   __|_|   __|_|\n|     | | | | | |     | |  |  | |   __|_|    -|-|_ _|__   | |   __|_|\n|__|__|_|_|___|_|__|__|_|____/_/|_____|_|__|__|_|_|_|_____|_|_____|_|\n                                                  \nWelcome to the anaver.se\nIf you want to learn more -> twitter.com/anaglyph_ic"),(()=>{e["Code Barre"]["début"]=window.performance.now();const t=document.getElementById("cont");document.getElementById("barcode")&&document.getElementById("barcode").remove();const n=.05*window.innerHeight,r=zn("svg").attr("width",5*n).attr("height",n).attr("id","barcode");r.style("left","10px"),r.style("top","0px"),r.style("position","absolute");var i=r.append("g").attr("id","barrouge"),o=r.append("g").attr("id","barcyan");for(let t=0;t<30;t++)o.append("rect").style("mix-blend-mode","multiply").attr("x",5*t).attr("y",.01*window.innerHeight).attr("width",Hn[t]).attr("height",n).attr("fill","rgb(0,255,235)"),i.append("rect").style("mix-blend-mode","multiply").attr("x",5*t).attr("y",.01*window.innerHeight).attr("width",Hn[t]).attr("height",n).attr("fill","rgb(255,0,0)");t.append(r.node()),e["Code Barre"].fin=window.performance.now()})(),async function(){e["Identité"]["début"]=window.performance.now(),lA=new tA({name:"anaverse"});const t=await lA.getActiveAccount();t?(rA(),cA.innerHTML="<div style='font-size:12px'>LOADING PROFILE...</div>",pA=t.address,mA(t.address)):(async function(){cA.innerHTML="",hA.addEventListener("click",gA)}(),nA(),fC())}(),e["Liste des Jetons Natifs"]["début"]=window.performance.now(),(0,Ix.request)("https://api.fxhash.xyz/graphql",hL.getAllTokens).then((t=>{t.user.generativeTokens.forEach((t=>{t.author.id,t.tags.forEach((e=>{"anaverse"===e&&(uL[t.slug]=t),"skybox"===e&&(uL[t.slug].type="skybox")}));var e=t.metadata.artifactUri.slice(7,t.metadata.artifactUri.indexOf("?fxhash=")),n="https://gateway.fxhash.xyz/ipfs/"+e+"/figures.js",r="https://gateway.fxhash.xyz/ipfs/"+e+"/skybox.js";t.skyboxUrl=r,t.figuresUrl=n})),kx("anaver.se native tokens retrieval","🟢"),e["Liste des Jetons Natifs"].fin=window.performance.now(),(()=>{for(const e in uL){const i=uL[e];i.tag={},i.tags.forEach((t=>{i.tag[t]=!0,("firstPerson"===t||"world"===t||"skybox"===t)&&(i.type=t)})),i.title=i.metadata.name.replace("anaverse - ","");const o=document.createElement("DIV");o.className="gentkProfiles";const s="https://gateway.fxhash.xyz/ipfs/"+i.metadata.thumbnailUri.replace("ipfs://","");i.metadata.imgURI=s;const a=new Image;a.src=s,a.onerror=t=>{thb.src="/notfound.png"},a.className="thumbnail",a.addEventListener("click",(()=>fL(i))),o.appendChild(a);var t=document.createElement("div");t.className="thumbTitle";var n=document.createElement("A");n.href="https://www.fxhash.xyz/marketplace/generative/"+i.id,n.target="_blank",n.innerText=i.title,n.style="font-style: italic;font-weight: 100;",t.appendChild(n),o.appendChild(t);var r=document.createElement("div");r.className="gentkDesc",r.innerText=i.metadata.childrenDescription,i.filters={},i.DOMelements={profile:o,description:r,gallery:[]}}e["Choix aléatoire"]["début"]=performance.now(),pA&&wL(pA),window.location.search?(()=>{fC();const t=window.location.search,e=new URLSearchParams(t);var n=!e.get("gallery")&&!e.has("autogalgen");if(e.has("tutorial"))nL(sL),setTimeout((()=>{hC()}),400);else{if(e.has("wallet")){const t=e.get("wallet");Ux([t],!0),wL(t)}e.has("ethwallet")&&nE(e.get("ethwallet"))}n&&dL()})():dL()})(),kx("anaver.se native tokens manual retrieval","🟢")})).catch((t=>{console.log(t),kx("anaver.se native tokens retrieval","🔴")})),(()=>{var t=window.innerHeight,e=window.innerWidth;const n=document.getElementById("cont"),r=new Hm,i=e/t,o=new Ns;vP();const s=new Wh;(jP=new Vl(60,i,1e-4,1e4)).position.set(0,0,.1);const a=new Hh({antialias:!0,alpha:!0});a.setClearColor(0,0),a.setSize(e,t),a.setPixelRatio(devicePixelRatio),s.background=null,BP.position.set(.1,-.11,-.1),BP.rotation.y=-Math.PI/2,s.add(BP);const l=new Hh({antialias:!0});l.setSize(e,t),l.setPixelRatio(devicePixelRatio),(WP=new Vl(60,i,.1,1e4)).position.set(0,1,2),WP.lookAt(new Ns(0,0,0)),DP=new Wh,UP.name="World",DP.add(UP),n.appendChild(l.domElement),l.domElement.style.position="absolute",l.domElement.style.top="0px",l.domElement.style.left="0px";var c=`rgb(${Math.floor(255*Math.random())},${Math.floor(120*Math.random())},${Math.floor(255*Math.random())})`,u=new Es(c);DP.background=u,n.appendChild(a.domElement),a.domElement.style.position="absolute",a.domElement.style.top="0px",a.domElement.style.left="0px",a.domElement.style.pointerEvents="none",qP=new RP(WP,l.domElement);let h=!1,d=!1,p=!1,f=!1;var m,g,y;DP.add(qP.getObject()),n.addEventListener("wheel",(t=>{if(HP.children[0])t.deltaY>0?ZP+=.1:ZP>1&&(ZP-=.1),HP.children[0].scale.set(ZP,ZP,ZP);else if(A){const n=A.object.parent;if(n.userData.hasOwnProperty("isBlockDisplay")){var e=t.deltaY/700;hx.to(n.parent.position,{duration:.4,y:n.parent.position.y+e})}}})),n.addEventListener("click",(function(){if(A){const e=A.object.parent;if(e.userData.hasOwnProperty("isBlockDisplay")&&!e.userData.focused)if(hx.to(e.position,{duration:2,z:e.position.z+.3}),e.userData.focused=!0,e.userData.item.hasOwnProperty("token")){var t=e.userData.item.token;const n="https://assets.objkt.media/file/assets-003/"+t.display_uri.replace("ipfs://","")+"/display";t.fa={contract:t.fa2_address};const r={id:t.fa2_address+t.token_id};t.url="https://objkt.com/asset/"+t.fa2_address+"/"+t.token_id,yL[r.id]=t,yx(n,r,"objkt")}else{const t=e.userData.item,n=t.display_uri;t.fa=0;const r={id:t.permalink};t.url=t.permalink,yL[r.id]=t,yx(n,r)}}qP.lock(),R.src="",R.style.zIndex=0,R.style.display="none"})),document.getElementById("mobile-jetpack").addEventListener("touchstart",(t=>{m=setInterval((()=>{IP(),VP.y+=3}),40)})),document.getElementById("mobile-jetpack").addEventListener("touchend",(t=>{clearInterval(m),OP()}));const v=new ba(0,0,0,"YXZ");l.domElement.addEventListener("touchstart",(t=>{for(let e=0;e<t.touches.length;e++){const n=t.touches[e];n.clientX<window.innerWidth/2&&(y=n)}})),l.domElement.addEventListener("touchmove",(t=>{for(let e=0;e<t.touches.length;e++){const n=t.touches[e];if(n.clientY>.3*window.innerHeight)if(n.clientX>window.innerWidth/2){t.preventDefault(),g&&(t.movementX=15*(n.pageX-g.pageX),t.movementY=3*(n.pageY-g.pageY));const e=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;v.setFromQuaternion(WP.quaternion),v.y-=.002*e,v.x-=.002*r,WP.quaternion.setFromEuler(v),HP.quaternion.setFromEuler(v),g=n}else t.preventDefault(),y&&(t.movementX=n.pageX-y.pageX,t.movementY=n.pageY-y.pageY),_&&(h=!1,p=!1,f=!1,d=!1,window.innerHeight,Math.abs(t.movementX)<Math.abs(t.movementY)?t.movementY>0?(h=!1,p=!1,f=!1,d=!0):(h=!0,p=!1,f=!1,d=!1):Math.abs(t.movementX)>Math.abs(t.movementY)&&(t.movementX>0?(h=!1,p=!1,f=!0,d=!1):(h=!1,p=!0,f=!1,d=!1)),y=n,_=!1)}})),l.domElement.addEventListener("touchend",(()=>{y=!1}));var _=!0;l.domElement.addEventListener("touchend",(t=>{h=!1,d=!1,p=!1,f=!1,g=!1,_=!0})),document.addEventListener("keydown",(function(t){if(!uP)switch(t.code){case"ArrowUp":case"KeyW":h=!0;break;case"ArrowLeft":case"KeyA":p=!0;break;case"ArrowDown":case"KeyS":d=!0;break;case"ArrowRight":case"KeyD":f=!0;break;case"Space":VP.y<.5&&qP.getObject().position.y>-20?VP.y+=30:(VP.y+=2,IP());break;case"KeyR":QP()}})),document.addEventListener("keyup",(function(t){switch(t.code){case"ArrowUp":case"KeyW":h=!1;break;case"ArrowLeft":case"KeyA":p=!1;break;case"ArrowDown":case"KeyS":d=!1;break;case"ArrowRight":case"KeyD":f=!1;break;case"Space":OP()}})),qP.moveSpeed=0;let w=new Ns,b=new Ns,x=new Bs,E=new ha,S=new Ag,M=new Ag(new Ns,new Ns(0,-1,0));var T=!1;let A;new Ja({color:"pink",side:er}),GP=function(){if(YP){KP.setFromCamera(XP,WP);const t=KP.intersectObjects(FP.children);t&&(t.length>1?(A=t[0],A.object.hasOwnProperty("userData")&&(A.object.userData.isWorldItem&&A.distance<20?yL.hasOwnProperty(A.object.userData.objktID)&&(t=>{if(dP){for(const t in yL)yL[t].focused=!1;if(t.focused=!0,t.hasOwnProperty("seaport_sell_orders")){var e="";t.hasOwnProperty("creator")&&t.creator.hasOwnProperty("user")&&t.creator.user&&t.creator.user.hasOwnProperty("username")&&(e="by "+t.creator.user.username);var n="";n=(n=$R||cC)?`From ${n}'s collection`:"",tP.style.display="block",tP.innerHTML=`<strong>${t.name}</strong> ${e}<br> <br><br><em>${t.description}</em><br><br>\n  <span style="font-size:9px;font-family:monospace;font-weight:bolder">PUSH P TO PULL THIS TOKEN - PUSH V TO HIDE THIS PANEL</span>`}else{e="","KT1LjmAdYQCLBjwv4S2oFkEzyHVkomAf5MrW"===t.fa.contract&&(t.url="https://versum.xyz/token/versum/"+t.token_id),t.hasOwnProperty("creators")&&t.creators[0]&&Bx.hasOwnProperty(t.creators[0].creator_address)&&Bx[t.creators[0].creator_address].alias&&(e=" by "+Bx[t.creators[0].creator_address].alias),n="",$R&&(n=$R),n=n?`From ${n}'s collection`:"";var r="";t.description&&(r=t.description),tP.style.display="block",tP.innerHTML=`<strong>${t.name}</strong> ${e}<br> ${n}<br><br><em>${r}</em><br><br>\n  <span style="font-size:9px;font-family:monospace;font-weight:bolder">PUSH I TO INSPECT THIS TOKEN - PUSH P TO PULL THIS TOKEN - PUSH V TO HIDE THIS PANEL</span>`}}else tP.style.display="block",tP.style.width="auto",tP.innerHTML="<span style='font-size:10px;font-family:monospace;min-width:90px;'>Push V to toggle metadata</span>"})(yL[A.object.userData.objktID]):document.getElementById("itemMetaData").style.display="none")):(document.getElementById("itemMetaData").style.display="none",A=null))}if(aC)T||(zP.children.forEach((t=>{"green"===t.userData.color&&(t.clear(),zP.remove(t))})),l.renderLists.dispose(),T=!0);else{var t=WP.getWorldDirection(new Ns),e=t.z>0?-1:1,n=t.x>0?1:-1;zP.children.forEach((r=>{"green"===r.userData.color&&(r.position.x=Math.abs(.2*t.x)*e,r.position.z=Math.abs(.2*t.z)*n)}))}function i(t){if(pP||(qP.getObject().position.y<8&&VP.y<0&&qP.getObject().position.y>3?VP.y=-30:VP.y-=50*t),VP.x-=10*VP.x*t,VP.z-=10*VP.z*t,o.z=Number(h)-Number(d),o.x=Number(f)-Number(p),o.normalize(),qP.getObject().updateMatrixWorld(),(h||d)&&(VP.z-=o.z*qP.moveSpeed*t),(p||f)&&(VP.x-=o.x*qP.moveSpeed*t),qP.moveRight(-VP.x*t),qP.moveForward(-VP.z*t),qP.getObject().position.y+=VP.y*t,BR){x.makeEmpty(),E.copy(BR.matrixWorld).invert(),S.copy(M),S.start.applyMatrix4(qP.getObject().matrixWorld).applyMatrix4(E),S.end.applyMatrix4(qP.getObject().matrixWorld).applyMatrix4(E),x.expandByPoint(S.start),x.expandByPoint(S.end),x.min.addScalar(-1),x.max.addScalar(1);var e=!1;BR.geometry.boundsTree.shapecast({intersectsBounds:t=>t.intersectsBox(x),intersectsTriangle:t=>{const n=w,r=b,i=t.closestPointToSegment(S,n,r);if(i<1){e=!0;const t=1-i,o=r.sub(n).normalize();S.start.addScaledVector(o,t),S.end.addScaledVector(o,t)}}});const t=w;t.copy(S.start).applyMatrix4(BR.matrixWorld);const n=b;n.subVectors(t,qP.getObject().position);const r=Math.max(0,n.length()-.1);n.normalize().multiplyScalar(r),e?(qP.getObject().position.add(n),kP(!!(d||h||p||f)),n.y<1&&n.y>0&&(VP.y=.01)):kP(!1)}qP.getObject().position.y<-25&&QP()}l.render(DP,WP),a.render(s,jP),requestAnimationFrame(GP);const c=Math.min(r.getDelta(),.1);for(let t=0;t<2;t++)i(c/2);hP?HP.position.set(Math.floor(qP.getObject().position.x),Math.floor(qP.getObject().position.y),Math.floor(qP.getObject().position.z)):HP.position.set(qP.getObject().position.x,qP.getObject().position.y,qP.getObject().position.z)};const R=document.getElementById("objktViewer");window.addEventListener("resize",(()=>{t=window.innerHeight,e=window.innerWidth,WP.aspect=e/t,WP.updateProjectionMatrix(),l.setSize(e,t),l.setPixelRatio(devicePixelRatio),jP.aspect=e/t,jP.updateProjectionMatrix(),a.setSize(e,t),a.setPixelRatio(devicePixelRatio),R.style.left="10%",R.style.top="10%",R.width=.8*e,R.height=.8*t}))})(),e["Galleries OBJKT"]["début"]=window.performance.now(),fetch("https://back.objkt.com/api/v1/cms/curation/categories").then((t=>t.json())).then((t=>{t.tokenCategories.forEach((t=>{var e=t.firstTokens[Math.floor(Math.random()*t.firstTokens.length)],n=new Image(200);n.src="https://assets.objkt.media/file/assets-003/"+e.contract+"/"+e.tokenId+"/thumb288",n.className="thumbnail",n.onerror=()=>{t.DOMthumb=""},t.DOMthumb=n,TC.push(t)})),TC=SC(TC),e["Galleries OBJKT"].fin=window.performance.now()})),e["Galleries VERSUM"]["début"]=window.performance.now(),(t=>{for(let t=0;t<3;t++)fetch("https://versum.xyz/api/anaverse/boards?offset="+parseInt(10*t)).then((t=>t.json())).then((t=>{var n=[];t.token_lists.forEach((t=>{var e=new Image(200);t.curator=t.user.id,AC.hasOwnProperty(t.curator)||(AC[t.curator]=!0),n.push(t.user.id),t.cover_uri?e.src="https://ipfs.io/ipfs/"+t.cover_uri.replace("ipfs://",""):t.tokens.length>0&&t.tokens[0].token.formats.forEach((t=>{"preview_image_480w.jpg"===t.fileName&&(e.src="https://ipfs.io/ipfs/"+t.uri.replace("ipfs://",""))})),e.className="thumbnail",e.onerror=()=>{t.DOMthumb=""},t.DOMthumb=e,kC.push(t)})),RC(n),e["Galleries VERSUM"].fin=window.performance.now()}))})(),e["Galleries SuperRare"]={},fetch("https://superrare.com/api/v2/spaces").then((t=>t.json())).then((t=>{(DC=t.result).forEach((t=>{const e=`https://superrare.com/api/v2/spaces/${t.slug}/gallery`;t.connect=`https://superrare.com/spaces/${t.slug}/lobby`,fetch(e).then((t=>t.json())).then((e=>{t.tokens=[],e.result.galleries.forEach((e=>{e.tokens.forEach((e=>{e.fa={contract:null},e.permalink=`https://opensea.io/assets/ethereum/${e.contractAddress}/${e.tokenId}`,t.tokens.push(e)}))}))})).catch((t=>console.log("error fetching a superrare gallery")))})),SC(DC),e["Galleries SuperRare"].fin=window.performance.now()})),e["Galleries Natives"]["début"]=window.performance.now(),(0,Ix.request)("https://data.objkt.com/v3/graphql",wC).then((t=>{var e=[];t.token_tag.forEach((t=>{const n="https://assets.objkt.media/file/assets-003/"+t.token.artifact_uri.replace("ipfs://","")+"/artifact/gallery.json";var r=!0;t.token.holders.forEach((t=>{"tz1burnburnburnburnburnburnburjAYjjX"===t.holder_address&&(r=!1)})),r&&e.push({galurl:n,contract:t.token.fa_contract,id:t.token.token_id,curator:t.token.creators[0].creator_address,thumbnail:t.token.thumbnail_uri,artifact:t.token.artifact_uri})})),MC.postMessage({type:"remote",galleryURLs:e})})),JR(VR),XR.innerHTML='<img  style="width:15px;height:15px" src="play.svg">',ZR=setInterval((()=>{JR(VR)}),5e3)})()})();