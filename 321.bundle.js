(()=>{function e(e,a,t,o,c,s){var n={room:e.room,skybox:e.skybox,name:JSON.stringify(e.name),artifact:s,contract:a,collection:e.collection,id:t,curator:o,gallery:[],thumbnail:c,type:"remote"};e.hasOwnProperty("gallery")&&(e.gallery.forEach((e=>{for(const a in e)switch(a){case"position":case"rotation":case"scale":for(const t in e[a])"x"===t||"y"===t||"z"===t||delete e[a][t];break;case"objktMetaData":case"tezosMetaData":case"ethereumMetaData":case"openSeaMetaData":case"solanaMetaData":case"fxMetaData":case"tokenType":case"block":case"sculpture":case"IIIFdata":case"datavis":break;default:delete e[a]}})),e.gallery.forEach((e=>{var a=!1;if(e.hasOwnProperty("objktMetaData")){var t=!1;for(const a in e.objktMetaData)"contract"===a||"token_id"===a?t=!0:delete e.objktMetaData[a];t&&(a=!0)}else"block"!==e.tokenType&&"sculpture"!==e.tokenType&&"datavis"!==e.tokenType&&"openSea"!==e.tokenType&&"tezos"!==e.tokenType&&"ethereum"!==e.tokenType&&"solana"!==e.tokenType&&"IIIF"!==e.tokenType||(a=!0);a&&n.gallery.push(e)}))),e.hasOwnProperty("audioguide")&&(n.audioguide={mainTrack:e.audioguide.mainTrack}),n.gallery.length>0&&postMessage(n)}const a=new FileReader;a.onload=function(e){const a=JSON.parse(e.target.result),t={collection:a.collection,gallery:[],name:a.name,room:a.room,skybox:a.skybox,type:"local"};a.gallery.forEach((e=>{for(const a in e)switch(a){case"position":case"rotation":case"scale":for(const t in e[a])"x"===t||"y"===t||"z"===t||delete e[a][t];break;case"objktMetaData":case"openSeaMetaData":case"fxMetaData":case"tokenType":case"solana":case"block":case"sculpture":case"IIIFdata":case"datavis":break;default:delete e[a]}})),a.gallery.forEach((e=>{var a=!1;if(e.hasOwnProperty("objktMetaData")){var o=!1;for(const a in e.objktMetaData)"contract"===a||"token_id"===a?o=!0:delete e.objktMetaData[a];o&&(a=!0)}else"block"!==e.tokenType&&"sculpture"!==e.tokenType&&"datavis"!==e.tokenType&&"openSea"!==e.tokenType&&"IIIF"!==e.tokenType||(a=!0);a&&t.gallery.push(e)})),t.gallery.length>0&&postMessage(t)},onmessage=function(t){switch(t.data.type){case"remote":(a=>{a.data.galleryURLs.forEach((a=>{fetch(a.galurl).then((e=>e.json())).then((t=>{404===t.status?fetch(a.galurl+"/gallery.json").then((e=>e.json())).then((t=>e(t,a.contract,a.id,a.curator,a.thumbnail,a.artifact))):e(t,a.contract,a.id,a.curator,a.thumbnail,a.artifact)}))}))})(t);break;case"local":(e=>{a.readAsText(e.data.path)})(t)}}})();